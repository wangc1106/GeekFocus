<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ã€CHLOROBOXã€‘</title>
    <link href="/GeekFocus/2022/08/29/2022-0829-Chloro-anno/"/>
    <url>/GeekFocus/2022/08/29/2022-0829-Chloro-anno/</url>
    
    <content type="html"><![CDATA[<h1 id="Chloro-amp-Mito-web-annotation"><a href="#Chloro-amp-Mito-web-annotation" class="headerlink" title="Chloro&amp;Mito web annotation"></a>Chloro&amp;Mito web annotation</h1><span id="more"></span><p>NCBI download GeneBank <a href="https://www.ncbi.nlm.nih.gov/nuccore/MF459662.1?report=genbank&log$=seqview">gb format</a></p><p><a href="https://chlorobox.mpimp-golm.mpg.de/">https://chlorobox.mpimp-golm.mpg.de</a></p><p><a href="https://chlorobox.mpimp-golm.mpg.de/OGDraw.html">https://chlorobox.mpimp-golm.mpg.de/OGDraw.html</a></p><p>upload File(s) -&gt; submit</p><p>save pdf</p><hr><h1 id="BLASTï¼ŒCPGAVAS2ï¼ŒOGDRAW"><a href="#BLASTï¼ŒCPGAVAS2ï¼ŒOGDRAW" class="headerlink" title="BLASTï¼ŒCPGAVAS2ï¼ŒOGDRAW"></a>BLASTï¼ŒCPGAVAS2ï¼ŒOGDRAW</h1><p>æ¤ç‰©è´¨ä½“åºåˆ—ä¸ºå‚è€ƒï¼ŒBLASTnå¯¹ç»†èƒå™¨åŸºå› ç»„é‰´å®š(<a href="https://www.ncbi.nlm.nih.gov/genome/organelle/)%E3%80%82**%E6%9C%80%E5%8F%AF%E4%BF%A1%E7%BB%93%E6%9E%9C%E7%8E%AF%E5%8C%96**%EF%BC%9F%E9%87%8D%E5%BB%BA%E5%AE%8C%E6%95%B4%E7%8E%AF%E7%8A%B6%E5%9F%BA%E5%9B%A0%E7%BB%84%E3%80%82CHLOROBOX%E8%87%AA%E5%8A%A8%E6%B3%A8%E9%87%8A%E5%92%8C%E5%8F%AF%E8%A7%86%E5%8C%96%E3%80%82">https://www.ncbi.nlm.nih.gov/genome/organelle/)ã€‚**æœ€å¯ä¿¡ç»“æœç¯åŒ–**ï¼Ÿé‡å»ºå®Œæ•´ç¯çŠ¶åŸºå› ç»„ã€‚CHLOROBOXè‡ªåŠ¨æ³¨é‡Šå’Œå¯è§†åŒ–ã€‚</a></p><p><a href="https://zhuanlan.zhihu.com/p/464278724">https://zhuanlan.zhihu.com/p/464278724</a></p><p>å¶ç»¿ä½“åŸºå› ç»„ï¼ˆcpDNAï¼‰ç¯çŠ¶ï¼Œå¤§å°ã€ç»“æ„å’ŒåŸºå› å«é‡æ–¹é¢éƒ½ç›¸å¯¹ä¿å®ˆï¼Œç›®å‰å¸¸è¢«ç”¨äºå±æ°´å¹³çš„è¿›åŒ–ç ”ç©¶ä»¥åŠåˆ†å­é‰´å®šã€‚å¶ç»¿ä½“åŸºå› çš„æ³¨é‡Šæ˜¯ç›®å‰å¯¹åŸºå› ç»„æœ€å¸¸è§ã€æœ€åŸºç¡€çš„åˆ†æã€‚</p><h2 id="é¦–å…ˆå¯»æ‰¾æœ€ä½³å‚è€ƒåŸºå› ç»„BLAST"><a href="#é¦–å…ˆå¯»æ‰¾æœ€ä½³å‚è€ƒåŸºå› ç»„BLAST" class="headerlink" title="é¦–å…ˆå¯»æ‰¾æœ€ä½³å‚è€ƒåŸºå› ç»„BLAST"></a>é¦–å…ˆå¯»æ‰¾æœ€ä½³å‚è€ƒåŸºå› ç»„BLAST</h2><p>NCBI BLASTã€‚ç‚¹å‡»ç¬¬ä¸€ä¸ªç»“æœçš„å¯¹åº”ç¼–å·ï¼Œä¸‹è½½ç›¸åº”Genbankæ–‡ä»¶</p><h2 id="CPGAVAS2"><a href="#CPGAVAS2" class="headerlink" title="CPGAVAS2"></a>CPGAVAS2</h2><p><a href="http://47.96.249.172:16019/analyzer/annotate">http://47.96.249.172:16019/analyzer/annotate</a></p><p>æäº¤ç›®æ ‡ç‰©ç§çš„åŸºå› åºåˆ—ï¼ˆfasta.ï¼‰ï¼Œé€‰æ‹©3æ•°æ®åº“ï¼Œç„¶åæäº¤åœ¨NCBIä¸ŠBLASTåä¸‹è½½çš„æœ€ä½³åºåˆ—çš„Genbankæ–‡ä»¶ï¼Œå‚æ•°ä¸åšæ”¹å˜ï¼Œsubmit</p><p>æäº¤åç­‰å¾…ï¼Œè®°å½•project idï¼Œæ–¹ä¾¿åç»­æŸ¥è¯¢</p><p>ç­‰å¾…5-10minåï¼Œæ‰“å¼€ViewResultsï¼Œæœç´¢ç›¸åº”project idã€‚æ ¹æ®éœ€æ±‚ä¸‹è½½æ–‡ä»¶ï¼Œå¦‚gbæ–‡ä»¶ï¼ŒCDSæ–‡ä»¶ï¼Œåœˆå›¾ç­‰</p><h2 id="OGDRAW"><a href="#OGDRAW" class="headerlink" title="OGDRAW"></a>OGDRAW</h2><p>uploadç‰©ç§åºåˆ—gbæ–‡ä»¶ï¼ˆç”±CPGAVAS2æ³¨é‡Šå¾—åˆ°ï¼Œæˆ–NCBIä¸‹è½½ï¼‰ï¼Œé€‰æ‹©PSï¼ŒSubmit</p><p>ä¸‹è½½åå¯¼å…¥AIï¼Œå°†åœˆå›¾ä¸­å¤®çš„ç‰©ç§åç§°æ”¹æˆç‰©ç§æ‹‰ä¸æ–‡</p><h1 id="Chloroplotæ–°å·¥å…·"><a href="#Chloroplotæ–°å·¥å…·" class="headerlink" title="Chloroplotæ–°å·¥å…·"></a>Chloroplotæ–°å·¥å…·</h1><blockquote><p>Chloroplot: An Online Program for the versatile plotting of organelle genomes</p><p>frontiers in Genetics<br>25 September 2020<br>University of Helsinki</p></blockquote><p>è¯¥å·¥å…·æ˜¯ä¸€ä¸ªshinyåº”ç”¨  <a href="https://links.jianshu.com/go?to=https://irscope.shinyapps.io/chloroplot/">https://irscope.shinyapps.io/chloroplot/</a> ï¼ŒIRscopeç ”å‘ç»„</p><p>ä¸»è¦åŠŸèƒ½æ˜¯ä¸Šä¼ GBæ–‡ä»¶ï¼Œç”»ç»†èƒå™¨åŸºå› ç»„çš„åœˆå›¾</p><p>å¶ç»¿ä½“åŸºå› ç»„ï¼Œè¿˜å¯åœ¨å›¾ä¸Šæ˜¾ç¤ºåå‘é‡å¤åŒºçš„ä¿¡æ¯</p><p>è¿˜å¯æ·»åŠ é¢å¤–çš„æ³¨é‡Šä¿¡æ¯ï¼Œé¢å¤–ä¿¡æ¯å¦‚åŸºå› è¡¨è¾¾é‡</p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ChloroAnno</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€PGA æœ‰å‚ç»„è£…ã€‘</title>
    <link href="/GeekFocus/2022/08/29/2023-0216-PGA/"/>
    <url>/GeekFocus/2022/08/29/2023-0216-PGA/</url>
    
    <content type="html"><![CDATA[<p><strong>PGA</strong> is not an independent assembly software, it <strong>relies on the output of hifiasm</strong> and technologies that can anchor contigs to chromosomes,such as genetic maps, <strong>HIC</strong>, or <strong>alignment with genome sequences of related species</strong> to achieve a gapless genome.</p><span id="more"></span><p>githubï¼š<a href="https://github.com/likui345/PGA">https://github.com/likui345/PGA</a></p><h1 id="Dependencies"><a href="#Dependencies" class="headerlink" title="Dependencies"></a>Dependencies</h1><p>python3</p><p>mummer</p><p>networkx</p><h1 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h1><p>conda install -c bioconda mummer</p><p>conda install -c conda-forge networkx</p><p>git clone <a href="https://github.com/likui345/PGA.git">https://github.com/likui345/PGA.git</a></p><p>python setup.py install</p><h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><h3 id="1-Using-reference-genomes-to-anchor-scaffolds"><a href="#1-Using-reference-genomes-to-anchor-scaffolds" class="headerlink" title="1.Using reference genomes to anchor scaffolds."></a>1.Using reference genomes to anchor scaffolds.</h3><p>usage: </p><p><code>rbsa.py --type nucmer --ref REF --scf SCF</code></p><p>rbsa.py â€“type mcscan â€“A_bed A_BED â€“B_bed B_BED â€“anchor ANCHOR â€“scf SCF</p><p>optional arguments: </p><p>-h, â€“help show this help message and exit </p><p>â€“type {nucmer,mcscan} nucmer or mcscan anchor </p><p>â€“ref REF This is reference genome sequences which has anchored to the chromosomal level </p><p>â€“scf SCF This is the scaffold sequences </p><p>â€“A_bed A_BED species_a bed file </p><p>â€“B_bed B_BED species_b bed file </p><p>â€“anchor ANCHOR anchor.simple files of species_a and species_b</p><h3 id="2-Filtering-overlap-data"><a href="#2-Filtering-overlap-data" class="headerlink" title="2.Filtering overlap data ."></a>2.Filtering overlap data .</h3><p>usage: </p><p><code>filter.py --paf_fn PAF --bestn NUM --output OUTPUT</code></p><p>optional arguments: </p><p>-h, â€“help show this help message and exit </p><p>â€“paf_fn PAF_FN Input. reads alignment file </p><p>â€“bestn BESTN output at least best n overlaps on 5â€™ or 3â€™ ends if possible. </p><p>â€“output OUTPUT Output filename</p><h3 id="3-Get-chr-paths-using-agp-file-and-gfa-file"><a href="#3-Get-chr-paths-using-agp-file-and-gfa-file" class="headerlink" title="3.Get chr_paths using agp file and gfa file."></a>3.Get chr_paths using agp file and gfa file.</h3><p>usage: </p><p><code>chr_paths.py --agp AGP --gfa GFA</code></p><p>optional arguments: </p><p>-h, â€“help show this help message and exit </p><p>â€“agp AGP agp file form contig anchoring </p><p>â€“gfa GFA gfa from hifiasm</p><h3 id="4-Building-string-graph"><a href="#4-Building-string-graph" class="headerlink" title="4.Building string graph."></a>4.Building string graph.</h3><p>usage: </p><p><code>ovlp2graph.py [-h] --overlap-file OVERLAP_FILE</code></p><p>optional arguments: </p><p>-h, â€“help show this help message and exit </p><p>â€“overlap-file OVERLAP_FILE a file that contains the overlap information. (default: None)</p><p>Outputs: - sg_edges_list - chimer_nodes</p><h3 id="5-Generate-the-final-assembly"><a href="#5-Generate-the-final-assembly" class="headerlink" title="5.Generate the final assembly."></a>5.Generate the final assembly.</h3><p>usage: </p><p><code>graph2chr.py [-h] --reads-fasta-fn READS_FASTA_FN --paf-fn PAF_FN --sg-edges-list-fn SG_EDGES_LIST_FN --ctg-paths-fn CTG_PATHS_FN</code></p><p>optional arguments: </p><p>-h, â€“help show this help message and exit </p><p>â€“reads-fasta-fn READS_FASTA_FN Input. reads file generated by hifiasm. (default: None) </p><p>â€“paf-fn PAF_FN Input. reads alignment file generated by hifiasm. (default: None) </p><p>â€“sg-edges-list-fn SG_EDGES_LIST_FN Input. File containing string graph edges, produced by ovlp2graph.py. (default: None) </p><p>â€“ctg-paths-fn CTG_PATHS_FN Input. File containing contig paths. (default: None)</p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PGA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€FuncAnnoã€‘ã€KAASã€‘</title>
    <link href="/GeekFocus/2022/06/08/2022-06-08-KAAS/"/>
    <url>/GeekFocus/2022/06/08/2022-06-08-KAAS/</url>
    
    <content type="html"><![CDATA[<h1 id="KEGG-Automatic-Annotation-Server"><a href="#KEGG-Automatic-Annotation-Server" class="headerlink" title="KEGG Automatic Annotation Server"></a>KEGG Automatic Annotation Server</h1><span id="more"></span><p>KEGG Automatic Annotation Server for ortholog assignment and pathway mapping</p><p><a href="https://www.genome.jp/tools/kaas/">https://www.genome.jp/tools/kaas/</a></p><p>Jianshu.com&#x2F;p&#x2F;48716fa7321b</p><p><strong>KAAS</strong> (KEGG Automatic Annotation Server) provides functional annotation of genes by <strong>BLAST</strong> or <strong>GHOST</strong> comparisons against the <strong>manually curated <font color="green">KEGG GENES database</font></strong>. The result contains <font color="green"><strong>KO (KEGG Orthology) assignments</strong></font> and automatically generated <strong>KEGG pathways</strong>.</p><p><strong>KAAS</strong> (KEGG Automatic Annotation Server) provides functional annotations of genes in a genome by <strong>amino acid sequence comparisons</strong> against a manually curated set of ortholog groups in <a href="https://www.genome.jp/kegg/genes.html">KEGG GENES</a>. The result contains <a href="https://www.genome.jp/kegg/ko.html">KO</a> (<strong>KEGG Orthology</strong>) assignments and automatically generated <strong>KEGG pathways</strong> and <strong>functional classification</strong>s. This server is used internally to annotate query genes for the <a href="https://www.genome.jp/tools/maple/">MAPLE</a> functional evaluator.</p><hr><h2 id="QUery-form"><a href="#QUery-form" class="headerlink" title="QUery form"></a>QUery form</h2><h3 id="Search-program"><a href="#Search-program" class="headerlink" title="Search program"></a>Search program</h3><p>four homology search programs are available for the initial screening to obtain similar sequences from the target database.</p><p>- BLAST<br>- GHOSTX<br>- GHOSTZ</p><p>In general, <a href="http://www.bi.cs.titech.ac.jp/ghostx/">GHOSTX</a> is much faster than BLAST using a suffix array indexing, but is <strong>less accurate</strong>. <a href="http://www.bi.cs.titech.ac.jp/ghostz/">GHOSTZ</a> uses a compressed database and is further faster, but is <strong>much less accurate</strong>. We recommend to use GHOSTX when you have a large number of query sequences or use a large target data set.</p><h3 id="Query-sequences"><a href="#Query-sequences" class="headerlink" title="Query sequences"></a>Query sequences</h3><p>Pro seq for all search program. DNA seq(EST) using BLAST(TBLASTN)</p><p><strong>unique IDs , not include tab characters</strong>.</p><h3 id="E-mail-address"><a href="#E-mail-address" class="headerlink" title="E-mail address"></a>E-mail address</h3><p>Creat; submit; cancel; result</p><h3 id="GENES-data-set"><a href="#GENES-data-set" class="headerlink" title="GENES data set"></a>GENES data set</h3><p> The accuracy will be improved if closely related species of the query are included in the data set.</p><p>Only close species or 40?</p><h3 id="KO-assignment"><a href="#KO-assignment" class="headerlink" title="KO assignment"></a>KO assignment</h3><p>KO assignment methods may be performed based on the <strong>bi-directional best hit (BBH, default)</strong> or <strong>single-directional best hit (SBH)</strong>.</p><p>The computation of the BBH-based method takes about twice as much as that of SBH-based one. However, the <strong>BBH-based</strong> method will be <strong>more accurate</strong> than SBH-based one, if the query sequences is from a <strong>complete or draft genome</strong>. If the number of query sequences is <strong>very large</strong> such as those from <strong>metagenomes</strong>, then the <strong>SBH-based</strong> method should suffice (and save time).</p><h3 id="Limitations"><a href="#Limitations" class="headerlink" title="Limitations"></a>Limitations</h3><p>Number of the query sequences are limited by the following conditions depending on the query type and selected databases.</p><p>For amino acid sequence queries:<br>(<strong>the number of query sequences</strong>) * (<strong>the total number of sequences in selected organisms</strong>) &lt; 135,000,000,000. <strong>Square:367,423</strong>, query decrease, target increase</p><p>For nucleotide sequence queries:<br>(the number of query sequences) * (the total number of sequences in selected organisms) &lt; 135,000,000,000 &#x2F; 3</p><h2 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h2><ul><li>Users query list</li></ul><p>â€˜Failedâ€™ means abnormal process termination by a server or network trouble. You can retry the computation with the same file and parameters.</p><ul><li>KO list</li><li>BRITE hierarchies (changed from â€œKO hierarchyâ€)</li></ul><p>The <strong>hierarchical list of annotated genes</strong>, which is categorized according to the BRITE database.</p><ul><li>Pathway map</li></ul><p>The list of pathways with linkes to <strong>graphical pathway maps</strong>.</p><p>1: downloda txt</p><p>2: Html -&gt; BRITE hierarchies -&gt; KEGG Orthology -&gt; Download text</p><h2 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h2><p><a href="https://www.genome.jp/tools/kaas/help.html">https://www.genome.jp/tools/kaas/help.html</a></p><p>First, the bit scores between a <strong>query</strong> sequence and the <strong>reference</strong> sequence set (taken from the KEGG GENES database) are computed by a <strong>homology search</strong> tool, and homologs are found in the reference set. Next, homologs ranked <strong>above the threshold are selected as ortholog candidates</strong> based on the <strong>bit score</strong> and the <strong>bi-directional hit rate (<em>BHR</em>)</strong> defined below. <strong>Ortholog candidates</strong> are divided into <strong>KO groups</strong> according to the annotation of the KEGG GENES database. Finally, the a<strong>ssignment score</strong> is calculated based on the <strong>likelihood and heuristics for each KO group</strong>. Then, the K number of the <strong>KO group with the highest score</strong> is <strong>assigned</strong> to the query sequence.</p><h3 id="Bi-directional-hit-rate"><a href="#Bi-directional-hit-rate" class="headerlink" title="Bi-directional hit rate"></a><font color="green">Bi-directional hit rate</font></h3><p>Given a genome to be annotated, it is compared against each genome in the reference set of the KEGG GENES database by the homology searches in both forward and reverse directions, taking each gene in genome A as a query compared against all genes in genome B, and vice versa. Those hits with <strong>bit scores less than 60 are removed</strong>. </p><p>Because the <strong>bit scores</strong> of a gene pair <em>a</em> and <em>b</em> from two genomes <em>A</em> and <em>B</em>, respectively, can be <strong>different in forward and reverse directions</strong>, and because the <strong>top scores do not necessarily reflect</strong> the order of the rigorous Smith-Waterman scores, we define the <em>BHR</em> as:</p><p><em>BHR</em> &#x3D; <em>Rf</em> * <em>Rr</em></p><p>Here, <em>R</em> &#x3D; <em>Sâ€™</em>&#x2F;<em>Sb</em> where <em>Sâ€™</em> is the bit score of <em>a</em> against <em>b</em>, and <em>Sb</em> is the score of <em>a</em> against the best-hit gene in genome <em>B</em> (which may not necessarily be <em>b</em>). <em>Rf</em> refers to the score from the forward hit (<em>A</em> against <em>B</em>), and <em>Rr</em> refers to the score from the reverse hit (<em>B</em> against <em>A</em>). We select those genes whose <strong>BHR is greater than 0.95 in BBH method,</strong> and <em>Rf</em> is greater than 0.95 in SBH method.</p><h3 id="Assignment-score"><a href="#Assignment-score" class="headerlink" title=" Assignment Â score"></a><font color="green"> Assignment Â score</font></h3><p>We define a score for each ortholog group in order to assign the best fitting K numbers to the query gene:</p><p><img src="/GeekFocus/img/2022-06-08-KAAS/method2.png" alt="formula"></p><p><img src="/GeekFocus/2022-06-08-KAAS/method2.png" alt="formula"></p><p> <strong>Sh</strong> is the highest score among all ortholog candidates in the ortholog group</p><p><strong>m</strong> and <strong>n</strong> are the sequence lengths of the query and the target of BLAST, respectively</p><p><strong>N</strong> is the number of organisms in ortholog group</p><p><strong>x</strong> is the number of organisms in the original ortholog group from which this group is derived</p><p> <strong>p</strong> is the ratio of the size of the original ortholog group versus the size of the entire GENES database</p><p>The second term is for the normalization of the first term by sequence lengths, and the third term is a weighting factor to consider the number of ortholog candidates that are found in the original.</p><h2 id="Complete-or-Draft-Genome"><a href="#Complete-or-Draft-Genome" class="headerlink" title="Complete or Draft Genome"></a>Complete or Draft Genome</h2><p>KAAS works best when a <strong>complete set of genes</strong> in a genome is known. Prepare query amino acid sequences and use the <strong>BBH (bi-directional best hit) method</strong> to assign orthologs.</p><ul><li>- <a href="https://www.genome.jp/kaas-bin/kaas_main">KAAS job request (BBH method)</a></li></ul><h2 id="Partial-Genome"><a href="#Partial-Genome" class="headerlink" title="Partial Genome"></a>Partial Genome</h2><p>KAAS can also be used for <strong>a limited number of genes</strong>. Prepare query amino acid sequences and use the SBH (single-directional best hit) method to assign orthologs.</p><ul><li>- <a href="https://www.genome.jp/kaas-bin/kaas_main?mode=partial">KAAS job request (SBH method)</a></li></ul><h2 id="Metagenomes"><a href="#Metagenomes" class="headerlink" title="Metagenomes"></a>Metagenomes</h2><p>When the query consisits of large numbers of sequences and &#x2F; or sequences from mixture of species such as those from metagenome sequencing project, we recommend the GHOSTX search and SBH method.</p><p><font color="green"><strong>50M pro data need 8 hours in KEGG web server.</strong></font></p><hr><h2 id="KEGG-GENES-Database"><a href="#KEGG-GENES-Database" class="headerlink" title="KEGG GENES Database"></a>KEGG GENES Database</h2><p><a href="https://www.genome.jp/kegg/genes.html">https://www.genome.jp/kegg/genes.html</a></p><p><strong>KEGG GENES</strong> is a collection of <strong>genes and proteins</strong> in <strong>complete genomes</strong> of <strong>cellular organisms</strong> and <strong>viruses</strong> generated from publicly available resources, mostly from <strong>NCBI RefSeq and GenBank</strong>, and annotated by KEGG in the form of KO (KEGG Orthology) assignment. The collection is supplemented with a KEGG original collection of functionally characterized proteins from published literature. Protein sequences and RNA sequences of all GENES entries are subject to SSDB computation and KO assignment by <strong><font color="green">KOALA tools</font></strong></p><table><thead><tr><th>Category</th><th>Content</th><th>Data source</th><th>Organism code</th><th>Gene identifier</th></tr></thead><tbody><tr><td><a href="https://www.genome.jp/brite/br08610">KEGG organisms</a> (Complete genomes)</td><td>Genes and proteins in cellular organisms</td><td>RefSeq or GenBank</td><td>org</td><td>GeneID or Locus_tag</td></tr><tr><td><a href="https://www.genome.jp/brite/br08620">Viruses</a></td><td>Genes and proteins in viruses</td><td>RefSeq</td><td>vg</td><td>GeneID</td></tr><tr><td>Viruses</td><td>Mature peptides in viruses</td><td>RefSeq</td><td>vp</td><td>GeneID+no</td></tr><tr><td>Addendum</td><td>Functionally characterized proteins</td><td>KEGG</td><td>ag</td><td>ProteinID, etc</td></tr></tbody></table><p>org is three- or four-letter organism code for cellular organisms</p><p>The Addendum category is a <strong>PubMed-based collection of protein sequences</strong> whose functions are <strong>experimentally characterized</strong>. They are used to <strong>define new KOs</strong> that are not covered by complete genomes (see <a href="https://www.genome.jp/kegg/ko.html">KO database</a><br>The viral peptide (vp) category is a collection of mature peptides processed from genome-encoded polyproteins, which are not usually found as separate entries in the public databases such as NCBI and UniProt. Viral mature peptides appear in KEGG pathway maps and as drug targets and are given KOs. </p><ul><li>org:gene</li></ul><p>such as <a href="https://www.genome.jp/entry/hsa:351">hsa:351</a></p><h3 id="SSDB-db"><a href="#SSDB-db" class="headerlink" title="SSDB db"></a>SSDB db</h3><p><strong>KEGG SSDB</strong> (<strong>Sequence Similarity DataBase</strong>) is a computationally generated database of <strong>sequence similarity scores for all protein pairs</strong> (and for all RNA pairs as well) in the GENES database, together with the information of best hits and bidirectional best hits (best-best hits) in pairwise genome comparisons. The computation is performed using the SSEARCH program. </p><p>For the purpose of gene annotation, SSDB is organized as a collection of â€œGFIT tablesâ€ that are useful for identifying possible orthologs and paralogs. </p><p>Search: Oryholog; Paralog; Gene cluster; Pfam domain</p><h3 id="Gene-Annotation-Tools"><a href="#Gene-Annotation-Tools" class="headerlink" title="Gene Annotation Tools"></a>Gene Annotation Tools</h3><p>The annotation of KEGG GENES involves assignment of KO identifiers (K numbers). Internally, this is done using the <strong>KOALA&#x2F;KoAnn</strong> and <strong>GFIT annotation tools</strong> (see: <a href="https://www.genome.jp/kegg/ko.html">KO Database</a>). For outside users, the following automatic annotation servers are made available.</p><ul><li><p><a href="https://www.kegg.jp/blastkoala/">BlastKOALA</a></p><p>automatic KO assignment by <strong>BLASTP</strong> sequence similarity search</p></li><li><p><a href="https://www.kegg.jp/ghostkoala/">GhostKOALA</a></p><p>automatic KO assignment by <strong>GHOSTX</strong> sequence similarity search</p></li><li><p><a href="https://www.genome.jp/tools/kofamkoala/">KofamKOALA</a></p><p>automatic KO assignment by <strong>HMM</strong> profile search</p></li></ul><p>For a <strong>single sequence</strong>, the following standard programs may be used to find matching sequences with assigned KOs.</p><ul><li><p><a href="https://www.genome.jp/tools/blast/">BLAST</a></p><p>sequence similarity search by BLAST</p></li><li><p><a href="https://www.genome.jp/tools/fasta/">FASTA</a></p><p>sequence similarity search by FASTA</p></li></ul><h3 id="KO-db"><a href="#KO-db" class="headerlink" title="KO db"></a>KO db</h3><p><a href="https://www.genome.jp/kegg/ko.html">https://www.genome.jp/kegg/ko.html</a></p><h4 id="KO-Database-of-Molecular-Functions"><a href="#KO-Database-of-Molecular-Functions" class="headerlink" title="KO Database of Molecular Functions"></a>KO Database of Molecular Functions</h4><p>The <strong>KO (KEGG Orthology)</strong> database is a <strong>database of molecular functions</strong> represented in terms of functional orthologs. <strong>A functional ortholog</strong> is manually defined in the context of <strong>KEGG molecular networks,</strong> namely, <strong>KEGG pathway maps</strong>, <strong>BRITE hierarchies</strong> and <strong>KEGG modules</strong>. Each <strong>node</strong> of the network, such as a box in the KEGG pathway map, is given a KO identifier (called K number) as a functional ortholog defined from <strong>experimentally characterized genes and proteins in specific organisms</strong>, which are then used to assign orthologous genes in other organisms based on <strong>sequence similarity</strong>. The granularity of â€œfunctionâ€ is context-dependent, and the resulting KO grouping may correspond to a group of highly similar sequences within a limited organism group or it may be a more divergent group. </p><h4 id="Genome-Annotation-in-KEGG"><a href="#Genome-Annotation-in-KEGG" class="headerlink" title="Genome Annotation in KEGG"></a>Genome Annotation in KEGG</h4><p>Genome annotation in KEGG contains two unique aspects, <strong>KO assignment</strong> and <strong>KEGG mapping</strong></p><ul><li><p>KO assignment</p><ul><li><strong>Molecular functions</strong> are stored in the KO (KEGG Orthology) db containing <strong>orthologs of experimentally characterized genes&#x2F;proteins</strong>.</li><li>Genome annotation in KEGG is to <strong>assign KO identifiers</strong> (or K numbers) to <strong>individual genes</strong> in the genome, <strong>rather than giving text description</strong> of functions.</li></ul></li><li><p>KEGG mapping</p><ul><li><strong>Cellular and organism-level functions</strong> are stored in the <strong>PATHWAY</strong>, <strong>BRITE</strong> and <strong>MODULE</strong> db in terms of the molecular networks, which are all created as networks of K number nodes.</li><li>The KO assignment procedure <strong>converts a gene set in the genome to a K number set</strong> and leads to automatic <strong>reconstruction of KEGG pathways</strong> and other networks by the process called KEGG mapping, enabling interpretation of high-level functions.</li></ul></li></ul><h4 id="KO-Assignment-Tools"><a href="#KO-Assignment-Tools" class="headerlink" title="KO Assignment Tools"></a>KO Assignment Tools</h4><p>The KO assignment of the GENES database is performed by the previously developed <strong>KOALA (KEGG Orthology And Links Annotation) tool</strong> and the newly developed <strong>KoAnn (KO Annotation) tool</strong>, both of which process GFIT tables generated from the SSDB database of SSEARCH computation results for all pairwise genome comparisons. <strong>KOALA</strong> is now used only for the initial automatic KO assignment of <strong>new genomes</strong>. Both automatic and manual versions of KoAnn are used for <strong>all other annotations</strong>. <a href="https://www.kegg.jp/blastkoala/">BlastKOALA</a> is a web server for <strong>automatic KO assignment</strong> using a KOALA-like algorithm for BLAST search against a reduced database. </p><table><thead><tr><th>-</th><th>KOALA &#x2F; KoAnn</th><th>BlastKOALA</th></tr></thead><tbody><tr><td>Purpose</td><td>Internal GENES annotation</td><td>Genome annotation service</td></tr><tr><td>Search program</td><td>SSEARCH</td><td>BLASTP</td></tr><tr><td>Scoring</td><td>Weighted sum of SW scores (KOALA scoring)<br/>or identity scores (KoAnn scoring)</td><td>Weighted sum of BLAST bit scores<br/>(modified KOALA scoring)</td></tr><tr><td>Database</td><td>Entire GENES database sequences</td><td><strong>Non-redundant pangenome sequences</strong></td></tr></tbody></table><p><strong>KOALA scoring</strong> includes: SW (Smith-Waterman) score, best-best flag, overlap of alignment, ratio of query and DB sequences, taxonomic category and Pfam domains.<br><strong>KoAnn scoring</strong> includes: identify score, sequence length and best-best flag.</p><h3 id="Gene-ID-Conversion"><a href="#Gene-ID-Conversion" class="headerlink" title="Gene ID Conversion"></a>Gene ID Conversion</h3><p><strong>KEGG GENES</strong> can be retrieved by giving identifiers of outside databases: <strong>NCBI-ProteinID</strong> (INSDC accession), NCBI-GeneID (<strong>Entrez Gene ID</strong>) and <strong>UniProt accession numbers</strong>.</p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>FuncAnno</tag>
      
      <tag>KAAS</tag>
      
      <tag>KEGGgeneDB</tag>
      
      <tag>KOdb</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Diamond</title>
    <link href="/GeekFocus/2022/06/07/2022-06-08-DIAMOND/"/>
    <url>/GeekFocus/2022/06/07/2022-06-08-DIAMOND/</url>
    
    <content type="html"><![CDATA[<p>Accelerated BLAST compatible local sequence aligner</p><p><a href="https://doi.org/10.1038/s41592-021-01101-x">2021-Sensitive protein alignments at tree-of-life scale using DIAMOND</a></p><p><a href="https://doi.org/10.1038/nmeth.3176">2015-Fast and sensitive protein alignment using DIAMOND</a></p><span id="more"></span><h1 id="Quick-startğŸ’"><a href="#Quick-startğŸ’" class="headerlink" title="Quick startğŸ’"></a>Quick startğŸ’</h1><p><a href="https://github.com/bbuchfink/diamond">https://github.com/bbuchfink/diamond</a></p><p>DIAMOND is a sequence aligner for <font color="green"><strong>protein and translated DNA searches</strong></font>, designed for high performance analysis of big sequence data. The key features are:</p><ul><li>Pairwise alignment of proteins and translated DNA at <strong>100x-10,000x speed of BLAST</strong>.</li><li>Frameshift alignments for long read analysis.</li><li><strong>Low resource requirements</strong> and suitable for running on standard desktops or laptops.</li><li>Various <strong>output</strong> formats, including BLAST <strong>pairwise</strong>, <strong>tabular</strong> and <strong>XML</strong>, as well as taxonomic classification.</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># downloading the tool</span><br><span class="hljs-comment">#A precompiled binary is available for recent Linux systems and may be downloaded for immediate use</span><br>wget http://github.com/bbuchfink/diamond/releases/download/v2.0.14/diamond-linux64.tar.gz<br>tar xzf diamond-linux64.tar.gz<br><span class="hljs-comment"># creating a diamond-formatted database file</span><br>./diamond makedb --<span class="hljs-keyword">in</span> reference.fasta -d reference<br><span class="hljs-comment">#A binary file **.dmnd will be created</span><br><span class="hljs-comment"># running a search in blastp mode</span><br>./diamond blastp -d reference -q queries.fasta -o matches.tsv<br><span class="hljs-comment"># running a search in blastx mode</span><br>./diamond blastx -d reference -q reads.fasta -o matches.tsv<br><span class="hljs-comment"># downloading and using a BLAST database</span><br>update_blastdb.pl --decompress --blastdb_version 5 swissprot<br>./diamond prepdb -d swissprot<br>./diamond blastp -d swissprot -q queries.fasta -o matches.tsv<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sh">--<span class="hljs-keyword">in</span><br>--db/-d<br>--query/-q<br>--out/-o <span class="hljs-comment">#output</span><br>-threads/-p<br>--sensitive(default fast)<br>--outfmt/-f<br>5 XML<br>6 tab<br>100 Diamond alignment archive(DAA)<br>101 SAM<br>-max-target-seqs/--top<span class="hljs-comment"># default 25</span><br>--<span class="hljs-built_in">id</span> <span class="hljs-comment">#min identity, not recommend </span><br>--evalue/-e<br>--block-size(-b) (default 2.0)<br>--index-chunks(-c) <span class="hljs-comment"># number of chunks for index processing</span><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">diamond blastp \<br>--db /path/to/protein.dmnd \<br>--query /path/to/genome.faa <br>-e 1e-5 --outfmt 6 --more-sensitive --max-target-seqs 1 --threads 20 --quiet \<br>--out /path/to/anno.txt<br></code></pre></td></tr></table></figure><h1 id="Attention-please"><a href="#Attention-please" class="headerlink" title="Attention please"></a>Attention please</h1><ul><li><p><font color="green"><strong>Repeat masking is applied to the query and reference sequences by default</strong></font>. To disable it, use <code>--masking 0</code>.</p></li><li><p><strong>DIAMOND is optimized for <font color="green">large input</font> files of &gt;1 million proteins.</strong> Naturally the tool can be used for smaller files as well, but the algorithm will not reach its full efficiency.</p></li><li><p>The program may use quite a lot of <font color="green"><strong>memory</strong></font> and also <font color="green"><strong>temporary disk space</strong></font>. Should the program fail due to running out of either one, you need to set a lower value for the<font color="red"> <a href="https://github.com/bbuchfink/diamond/wiki/3.-Command-line-options#memory--performance-options">block size parameter</a> <code>-b</code>.</font></p></li><li><p>The sensitivity can be adjusted using the options </p><ul><li><code>--fast</code></li><li><code>--mid-sensitive</code></li><li><code>--sensitive</code></li><li><code>--more-sensitive</code></li><li><code>--very-sensitive</code> </li><li><code>--ultra-sensitive</code></li></ul><p>The <strong>default mode is the fastest</strong> and tailored towards finding homologies of <font color="green"><strong>&gt;70% sequence identity</strong></font>, the <code>--sensitive</code> mode is tailored to hits of <font color="green"><strong>&gt;40% identity</strong></font>, while the <code>--very-sensitive</code> and <code>--ultra-sensitive</code> modes provide sensitivity accross the <font color="green"><strong>whole range</strong></font> of pairwise alignments.</p></li></ul><h1 id="Command"><a href="#Command" class="headerlink" title="Command"></a>Command</h1><ul><li><p><strong>makedb</strong></p><p>Create a <strong>DIAMOND formatted reference database</strong> from a FASTA input file.</p></li><li><p><strong>prepdb</strong></p><p><font color="green"><strong>Prepare BLAST database for use with Diamond</strong></font>. This call requires <strong>the path to the BLAST database</strong> (option <code>-d</code>) and will write a number of <strong>small auxiliary files into</strong> the database directory.</p></li><li><p><strong>blastp</strong></p><p>Align protein query sequences against a protein reference database.</p></li><li><p><strong>blastx</strong></p><p>Align translated DNA query sequences against a protein reference database.</p></li><li><p><code>view</code></p><p>Generate formatted output from DAA files.</p></li><li><p><code>version</code></p><p>Print version information.</p></li><li><p><code>dbinfo</code></p><p>Print information about a database file.</p></li><li><p><code>help</code></p><p>Print help message.</p></li><li><p><code>test</code></p><p>Run a series of test cases and verify the output against reference hashes. This command will exit with code <code>0</code> if all tests have passed and <code>1</code> otherwise. Running this command requires write access to the current working directory.</p></li></ul><p>#Command make db</p><ul><li><p><code>--in &lt;file&gt;</code></p><p> <strong>input</strong> protein <strong>reference</strong> database file in FASTA (may be gzip compressed)</p></li><li><p><code>--db/-d &lt;file&gt;</code></p><p><strong>Path</strong> to the output DIAMOND database file.</p></li><li><p><code>--taxonmap &lt;file&gt;</code></p><p>Path to mapping file that maps NCBI protein accession numbers to taxon ids (gzip compressed). This parameter is optional and needs to be supplied in order to <strong>provide taxonomy features</strong>. The file can be downloaded from NCBI:<a href="ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/accession2taxid/prot.accession2taxid.FULL.gz">ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/accession2taxid/prot.accession2taxid.FULL.gz</a></p><p>Versions older than v2.0.7 only support the reduced mapping file:<a href="ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/accession2taxid/prot.accession2taxid.gz">ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/accession2taxid/prot.accession2taxid.gz</a></p><p>A custom file following the same format may be supplied here. Note that the first line of this file is assumed to contain headings and will be ignored.</p></li><li><p><code>--taxonnodes &lt;file&gt;</code></p><p>Path to the <code>nodes.dmp</code> file from the NCBI taxonomy. This parameter is optional and needs to be supplied in order to <strong>provide taxonomy features</strong>. The file is contained within this archive downloadable at NCBI: <a href="ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/taxdmp.zip">ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/taxdmp.zip</a>.</p></li><li><p><code>--taxonnames &lt;file&gt;</code></p><p>Path to the <code>names.dmp</code> file from the NCBI taxonomy. This parameter is optional and needs to be supplied in order to <strong>provide taxonomy features</strong>. The file is contained within this archive downloadable at NCBI: <a href="ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/taxdmp.zip">ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/taxdmp.zip</a>.</p></li></ul><h1 id="General-options"><a href="#General-options" class="headerlink" title="General options"></a>General options</h1><ul><li><p><code>--threads/-p </code></p><p><font color="red"><strong>CPU threads</strong></font></p></li><li><p><code>--quiet</code></p><p>Disable all terminal output.</p></li><li><p><code>--verbose/-v</code></p><p>Enable more verbose terminal output.</p></li><li><p><code>--log</code></p><p>written to a file named <code>diamond.log</code> is the current working directory.</p></li></ul><h1 id="Input-options"><a href="#Input-options" class="headerlink" title="Input options"></a>Input options</h1><ul><li><p><code>--db/-d &lt;file&gt;</code></p><p>Path to the <strong>DIAMOND db</strong> file. </p><p>Since v2.0.10, BLAST db have to be prepared using the <code>prepdb</code>command. </p><p><strong>Note that for <font color="green">self-made</font> BLAST db, makeblastdb should be used with the <font color="green">-parse_seqids</font> option.</strong></p></li><li><p><code>--query/-q &lt;file&gt;</code></p><p>Path to the <strong>query input file</strong> in FASTA or FASTQ format (may be gzip compressed)</p></li><li><p><code>--taxonlist &lt;list&gt;</code></p><p>Comma-separated list of NCBI taxonomic IDs to filter the database by. </p><p>Any taxonomic rank can be used, and <strong>only reference sequences matching one of the specified taxon ids will be searched</strong> against. </p><p>Using this option requires setting the <code>--taxonmap</code> and <code>--taxonnodes</code> parameters for <code>makedb</code>.</p></li><li><p><code>--seqidlist &lt;filename&gt;</code></p><p>Filter the database by a list of accessions provided as a text file. <em>Only supported when using a BLAST database.</em></p></li><li><p><code>--query-gencode </code></p><p>Genetic code used for translation of query in BLASTX mode. A list of possible values can be found at the <a href="https://www.ncbi.nlm.nih.gov/Taxonomy/Utils/wprintgc.cgi">NCBI website</a>. <strong>By default, the Standard Code is used</strong>. Note: changing the genetic code is currently not fully supported for the DAA format.</p></li><li><p><code>--strand &#123;both, plus, minus&#125;</code></p><p>Set strand of query to align for translated searches. <strong>By default both strands</strong> are searched.</p></li><li><p><code>--min-orf/-l #</code></p><p>Ignore translated sequences that do not contain an <strong>open reading frame</strong> of at least this <strong>length</strong>. By <strong>default</strong> this feature is disabled for sequences of length below <strong>30</strong>, set to 20 for sequences of length below 100, and set to 40 otherwise. Setting this option to <code>1</code> will disable this feature.</p></li></ul><h1 id="Sensitivity-modes"><a href="#Sensitivity-modes" class="headerlink" title="Sensitivity modes"></a>Sensitivity modes</h1><p>the default sensitivity mode will run which is designed for finding hits of <strong>&gt;60% identity</strong> and short read alignment. [&gt;70%??]</p><ul><li><p><code>--fast</code></p><p>faster than default, &gt;90% identity. </p></li><li><p><code>--mid-sensitive</code></p><p>between the <strong>default mode</strong> and the <strong>sensitive mode</strong> .  [40-60?]</p></li><li><p><code>--sensitive</code></p><p>full sensitivity for hits of &gt;40% identity.</p></li><li><p><code>--more-sensitive</code></p><p>This mode is equivalent to the <code>--sensitive</code> mode <strong>except for soft-masking of certain motifs being disabled</strong> (same as setting <code>--motif-masking 0</code>).</p></li><li><p><code>--very-sensitive</code></p><p>Enable the very-sensitive mode designed for best sensitivity including the twilight?? zone range of &lt;40% identity.</p></li><li><p><code>--ultra-sensitive</code></p><p>more sensitive than the <code>--very-sensitive</code> mode.</p></li></ul><h1 id="Alignment-options"><a href="#Alignment-options" class="headerlink" title="Alignment options"></a>Alignment options</h1><ul><li><p><code>--iterate</code></p><p>Run <strong>multiple rounds</strong> of searches with <strong>increasing sensitivity</strong>. </p><p>This option may improve performance by a lot if only a single best alignment is required for each query.</p><p>The sensitivity modes of the earlier rounds prior to the target sensitivity are set automatically, but can also be specified using a space-separated list following <code>--iterate sensitive</code> </p></li><li><p><code>--global-ranking/-g #</code></p><p>! Set a hard limit on the number of Smith Waterman extensions that will be computed for each query. Target sequences will be ranked according to their ungapped extension scores at seed hits, and gapped extensions will only be computed for the best N targets for each query. Note that this option increases memory use. </p></li><li><p><code>--frameshift/-F #</code></p><p><strong>Penalty for frameshifts in DNA-vs-protein alignments</strong>. Values around 15 are reasonable for this parameter. Enabling this feature will have the aligner tolerate missing bases in DNA sequences and is most recommended for long, error-prone sequences like MinION reads.<br>In the pairwise output format, frameshifts will be indicated by <code>\</code> and <code>/</code> for a shift by +1 and -1 nucleotide in the direction of translation respectively. Note that this feature is disabled by default.</p></li><li><p><code>--gapopen #</code></p><p>Gap <strong>open</strong> penalty.</p></li><li><p><code>--gapextend #</code></p><p>Gap <strong>extension</strong> penalty.</p></li><li><p><code>--matrix &lt;matrix name&gt;</code></p><p>Scoring matrix.  default  <strong>BLOSUM62</strong>.</p></li><li><p><code>--custom-matrix &lt;file&gt;</code></p><p>Use a custom scoring matrix</p></li><li><p><code>--masking (0,1,seg)</code></p><p><strong>DIAMOND by default applies the tantan repeat masking algorithm</strong> to the query and target sequences as described in (Frith, 2011). This masking procedure increases the specificity of alignments and serves to filter out spurious hits. If this is not desired, repeat masking can be disabled using <code>--masking 0</code>, or the default BLASTP SEG masking can be used instead by setting <code>--masking seg</code> (<em>supported since v2.0.12</em>). Note that when using <code>--comp-based-stats (2,3,4)</code>, tantan masking is disabled by default.</p></li><li><p><code>--comp-based-stats (0,1,2,3,4)</code></p><p>Enable composition based statistics. These algorithms adjust alignment scores based on sequence composition in order to improve search specificity. The following modes are supported:</p><ul><li><code>0</code> Disable composition based statistics.</li><li><code>1</code> Compositional correction as described in (Hauser, 2016). <em>This mode is the default.</em></li><li><code>2</code> Compositional matrix adjust as described in (Yu, 2005), conditioned on sequence properties. An adjusted matrix is used if the compositional angle (Altschul, 2005) between the sequence pairs is less than 50 degrees, otherwise falling back on the (Hauser, 2016) method. This mode also uses a simplified version of the algorithm that runs faster, but produces slightly less accurate scores. <em>Supported since v2.0.6.</em></li><li><code>3</code> Compositional matrix adjust as described in (Yu, 2005), conditioned on sequence properties. An adjusted matrix is used if the compositional angle (Altschul, 2005) between the sequence pairs is less than 50 degrees, otherwise falling back on the (Hauser, 2016) method. <em>Supported since v2.0.6.</em></li><li><code>4</code> Compositional matrix adjust as described in (Yu, 2005), unconditionally. An adjusted matrix is computed for all alignments, which substantially reduces performance, but provides the highest accuracy. <em>Supported since v2.0.6.</em></li></ul><p>The (Yu, 2005) method is the same algorithm also used by NCBI BLAST.</p><p>Modes <code>0</code> and <code>1</code> use tantan repeat masking by default, while modes <code>2</code>, <code>3</code> and <code>4</code> do <em>not</em> use tantan repeat masking by default. These modes will instead apply a more conservative SEG masking to only the target sequences (parameters: window&#x3D;10, locut&#x3D;1.8, hicut&#x3D;2.1). This is the same masking that is also used by BLASTP by default, and these modes will therefore produce scores and alignments that are more similar to those of BLAST.</p><p>Modes 2-4 are not yet supported for translated searches (blastx mode).</p></li><li><p><code>--algo (0,1,ctg)</code></p><p>Algorithm for seed search. <code>0</code> means double-indexed and is the main algorithm of the program, <strong>designed for large input files but less efficient for small query files</strong> .</p><p><code>1</code> means query-indexed and improves performance for <strong>small query files</strong>. This mode will be <strong>automatically triggered based on the input</strong>.</p><p><code>ctg</code> means contiguous-seed mode and further improves performance for <strong>small query files</strong>. This mode needs to be <strong>manually set by the user</strong> (<em>available since v2.0.10</em>).</p><p>The modes <strong>differ slightly</strong> in their sensitivity, so results are not guaranteed to be 100% identical for different settings of this option.</p></li></ul><h1 id="Output-options"><a href="#Output-options" class="headerlink" title="Output options"></a>Output options</h1><ul><li><p><code>--out/-o &lt;file&gt;</code></p><p>Path to the output file. </p></li><li><p><code>--outfmt/-f #</code></p><p>Format of the output file. The following values are accepted:</p><ul><li><p><code>0</code><br>BLAST <strong>pairwise</strong> format.</p></li><li><p><code>5</code><br>BLAST <strong>XML</strong> format.</p></li><li><p><code>6</code><br>BLAST <strong>tabular</strong> format (<strong>default</strong>). This format can be customized, the <code>6</code> may be <strong>followed by a space-separated list of the following keywords,</strong> each specifying a field of the output.</p><ul><li><code>qseqid</code> Query Seq - id</li><li><code>qlen</code> Query sequence length</li><li><code>sseqid</code> Subject Seq - id</li><li><code>sallseqid</code> All subject Seq - id(s), separated by a â€™;â€™</li><li><code>slen</code> Subject sequence length</li><li><code>qstart</code> Start of alignment in query*</li><li><code>qend</code> End of alignment in query*</li><li><code>sstart</code> Start of alignment in subject*</li><li><code>send</code> End of alignment in subject*</li><li><code>qseq</code> Aligned part of query sequence*</li><li><code>qseq_translated</code> Aligned part of query sequence (translated)* <em>Supported since v2.0.7.</em></li><li><code>full_qseq</code> Full query sequence</li><li><code>full_qseq_mate</code> Query sequence of the mate (requires two files for <code>--query</code>) <em>Supported since v2.0.7.</em></li><li><code>sseq</code> Aligned part of subject sequence*</li><li><code>full_sseq</code> Full subject sequence</li><li><code>evalue</code> Expect value</li><li><code>bitscore</code> Bit score</li><li><code>score</code> Raw score</li><li><code>length</code> Alignment length*</li><li><code>pident</code> Percentage of identical matches*</li><li><code>nident</code> Number of identical matches*</li><li><code>mismatch</code> Number of mismatches*</li><li><code>positive</code> Number of positive - scoring matches*</li><li><code>gapopen</code> Number of gap openings*</li><li><code>gaps</code> Total number of gaps*</li><li><code>ppos</code> Percentage of positive - scoring matches*</li><li><code>qframe</code> Query frame</li><li><code>btop</code> Blast traceback operations(BTOP)*</li><li><code>cigar</code> CIGAR string*</li><li><code>staxids</code> Unique Subject Taxonomy ID(s), separated by a â€™;â€™ (in numerical order). This field requires setting the <code>--taxonmap</code> parameter for <code>makedb</code>.</li><li><code>sscinames</code> Unique Subject Scientific Name(s), separated by a â€˜;â€™. This field requires setting the <code>--taxonmap</code>and <code>--taxonnames</code> parameters for <code>makedb</code>.</li><li><code>sskingdoms</code> Unique Subject Super Kingdom(s), separated by a â€˜;â€™. This field requires setting the <code>--taxonmap</code>, <code>--taxonnodes</code> and <code>--taxonnames</code> parameters for <code>makedb</code>.</li><li><code>skingdoms</code> Unique Subject Kingdom(s), separated by a â€˜;â€™. This field requires setting the <code>--taxonmap</code>, <code>--taxonnodes</code> and <code>--taxonnames</code> parameters for <code>makedb</code>.</li><li><code>sphylums</code> Unique Subject Phylums(s), separated by a â€˜;â€™. This field requires setting the <code>--taxonmap</code>, <code>--taxonnodes</code> and <code>--taxonnames</code> parameters for <code>makedb</code>.</li><li><code>stitle</code> Subject Title</li><li><code>salltitles</code> All Subject Title(s), separated by a â€™&lt;&gt;â€™</li><li><code>qcovhsp</code> Query Coverage Per HSP*</li><li><code>scovhsp</code> Subject Coverage Per HSP*</li><li><code>qtitle</code> Query title</li><li><code>qqual</code> Query quality values for the aligned part of the query*</li><li><code>full_qqual</code> Query quality values</li><li><code>qstrand</code> Query strand</li></ul><p>By default, <strong>12 preconfigured fields</strong>: <code>qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue bitscore</code>.</p><p><strong>These fields require alignment traceback. If none of these fields are selected, traceback computation will be disabled, which improves performance and reduces use of temporary disk space.</strong></p></li><li><p><code>100</code><br>DIAMOND alignment archive (DAA). The DAA format is a proprietary binary format that can subsequently be used to generate other output formats using the <code>view</code> command. It is also supported by MEGAN and allows a quick import of results. <em>Note that this format does not support streaming output or taxonomy features. It is considered a legacy format at this time.</em></p></li><li><p><code>101</code><br><strong>SAM</strong> format.</p></li><li><p><code>102</code><br><strong>Taxonomic classification</strong>. This format will not print alignments but <strong>only a taxonomic classification for each query</strong> using the LCA algorithm. The output lines consist of 3 tab-delimited fields:</p><ol><li>Query ID</li><li>NCBI taxonomy ID (0 if unclassified)</li><li>E-value of the best alignment with a known taxonomic ID found for the query (0 if unclassified)</li></ol><p>The score range for the LCA algorithm is set by the <code>--top</code> parameter. The default value is 10 which means that all alignments whose score is at most 10% lower than the best score are considered for the LCA computation.</p><p>Using this format requires setting the <code>--taxonmap</code> and <code>--taxonnodes</code> parameters for <code>makedb</code>.</p></li><li><p><code>103</code><br><a href="https://github.com/lh3/miniasm/blob/master/PAF.md">PAF format</a>. The custom fields in the format are AS (bit score), ZR (raw score) and ZE (e-value).</p></li></ul></li><li><p><code>--salltitles</code></p><p>Include full length subject titles into the <strong>DAA</strong> format. By default, DAA files contain only the shortened sequence id (up to the first blank character).</p></li><li><p><code>--sallseqid</code></p><p>Include all subject ids into the <strong>DAA</strong> file. By default only the first id of each subject is included. As the subject ids are much shorter than the full titles this option will save space compared to the <code>--salltitles</code> option.</p></li><li><p><code>--compress (0,1,zstd)</code></p><p><strong>Enable compression of the output file</strong>. <code>0</code> (default) means no compression, <code>1</code> means gzip compression, <code>zstd</code> means zstd compression (executable is required to have been compiled with zstd support).</p></li><li><p><code>--max-target-seqs/-k #</code></p><p>The <strong>maximum number of target sequences</strong> per query to report alignments for (<strong>default&#x3D;25</strong>). Setting this to <code>-k0</code> will report <strong>all targets</strong> for which alignments were found.</p><p><em>Note that this parameter does not only affect the reporting, but also the algorithm as it is taken into account for heuristics that eliminate hits prior to full gapped extension.</em></p></li><li><p><code>--top #</code></p><p>Report alignments within the given percentage range of the top alignment score for a query (overrides <code>--max-target-seqs</code> option). For example, setting <code>--top 10</code> will report all alignments whose <strong>score is at most 10% lower than the best alignment score</strong> for a query. Using this option will cause targets to be <strong>sorted by bit score instead of e-evalue</strong> in the output.</p><p><em>Note that this parameter does not only affect the reporting, but also the algorithm as it is taken into account for heuristics that eliminate hits prior to full gapped extension.</em></p></li><li><p><code>--max-hsps #</code></p><p><strong>The maximum number of HSPs (High-Scoring Segment Pairs) per target</strong> sequence to report for each query. The <strong>default</strong> policy is to report <strong>only the highest-scoring HSP</strong> for each target, while disregarding alternative, lower-scoring HSPs that are contained in the same target. <strong>This is not to be confused with the â€“max-target-seqs option.</strong></p><p>This parameter can be increased to report an alternative HSP if its query and subject ranges are not enveloped by a higher scoring HSP and if it meets the e-value threshold. Setting this option to <code>--max-hsps 0</code> will <strong>report all alternative HSPs</strong>.</p><p>A non-default setting will always recompute a full-matrix Smith Waterman alignment with the range of the best HSP masked in the target (<em>since v2.0.12</em>). Therefore using this setting will reduce performance substantially.</p></li><li><p><code>--range-culling</code></p><p>Enable hit culling with respect to the query range. This feature is designed for <strong>long query DNA sequences</strong> that may <strong>span several genes</strong>. In these cases, reporting the overall top N hits can cause hits to a lower-scoring gene to be superseded by a higher-scoring gene. Using this option, hit culling will be performed locally with respect to a hitâ€™s query range, thus reporting the locally top N hits while allowing more hits that span a different region of the query.</p><p>Using this feature along with <code>-k 25</code> (default), a hit will only be deleted if at least 50% of its query range is spanned by at least 25 higher or equal scoring hits.</p><p>Using this feature along with <code>--top 10</code>, a hit will only be deleted if its score is more than 10% lower than that of a higher scoring hit over at least 50% of its query range.</p><p>The overlap percentage is configurable using <code>--range-cover</code>. Note that this feature is currently only available in frameshift alignment mode.</p></li><li><p><font color="red"><strong>â€“evalue&#x2F;-e #</strong></font></p><p>Maximum expected value to report an alignment (<strong>default&#x3D;0.001</strong>).</p></li><li><p><code>--min-score #</code></p><p><strong>Minimum bit score</strong> to report an alignment. Setting this option will <strong>override</strong> the <code>--evalue</code> parameter.</p></li><li><p><code>--id #</code></p><p>Report <strong>only</strong> alignments above the <strong>given percentage of sequence identity</strong>.</p><p><em>Note that using this option reduces performance.</em></p></li><li><p><code>--query-cover #</code></p><p>Report <strong>only</strong> alignments <strong>above</strong> the given percentage of <strong>query cover</strong>.</p><p><em>Note that using this option reduces performance.</em></p></li><li><p><code>--subject-cover #</code></p><p>Report <strong>only</strong> alignments above the <strong>given percentage of subject cove</strong>r.</p><p><em>Note that using this option reduces performance.</em></p></li><li><p><code>--unal (0,1)</code></p><p>Report unaligned queries (0&#x3D;no, 1&#x3D;yes). By default, <strong>unaligned queries</strong> are reported for the BLAST pairwise, BLAST XML and SAM format.</p></li><li><p><code>--no-self-hits</code></p><p>Suppress reporting of identical self-hits between sequences. The FASTA sequence identifiers as well as the sequences of query and target need to be identical for a hit to be deleted.</p></li></ul><h1 id="Memory-options"><a href="#Memory-options" class="headerlink" title="Memory options"></a>Memory options</h1><ul><li><p><code>--block-size/-b #</code></p><p>Block size in billions of sequence letters to be processed at a time. This is the main parameter for controlling the programâ€™s <strong>memory and disk space usage</strong>. </p><p>The default value is <code>-b2.0</code>. The parameter can be decreased for reducing memory use, as well as increased for better performance ( <strong>&gt;20  not recommended</strong>).</p><p>The very-sensitive and ultra-sensitive modes use <code>-b0.4</code> as a default. Note that these two modes benefit only slightly from increasing this parameter.</p><p>Note that this parameter affects the algorithm and <strong>results will not be completely identical</strong> for <strong>different values of the block size</strong>.</p></li><li><p><code>--tmpdir/-t &lt;directory&gt;</code></p><p>This is <strong>set to the output directory by defau</strong>lt. &gt;100 GB available </p><p><font color="red">If the program is being run in a <strong>cluster environment</strong>, and disk space is mounted over a <strong>network based file system</strong>, it is recommended to <strong>set this parameter to a fast local disk</strong> or to <code>/dev/shm</code> to <strong>avoid any I&#x2F;O bottlenecks</strong>.</font></p></li><li><p><code>--index-chunks/-c #</code></p><p>The number of chunks for processing the seed index. This option can be additionally used to tune the performance. The default value is <code>-c4</code>, while setting this parameter to <code>-c1</code> instead will improve the performance at the cost of increased memory use. Note that the <strong>very-sensitive and ultra-sensitive</strong> modes use <strong>-c1 by default</strong>.</p></li></ul><h1 id="View-options"><a href="#View-options" class="headerlink" title="View options"></a>View options</h1><ul><li><p><code>--daa/-a &lt;file&gt;</code></p><p>Path to input file in DAA format.</p></li><li><p><code>--out/-o &lt;file&gt;</code></p><p><strong>Path to output file.</strong></p></li></ul><p>These aligner parameters apply to the view command as well and work in the same way: <code>--outfmt</code>, <code>--compress</code>, <code>--max-target-seqs</code>, <code>--top</code>. Note that taxonomy features are currently not available for the DAA format.</p><h1 id="Success-symbol"><a href="#Success-symbol" class="headerlink" title="Success symbol"></a>Success symbol</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Total</span> time = <span class="hljs-number">5</span>.<span class="hljs-number">494</span>s<br><span class="hljs-attribute">Reported</span> <span class="hljs-number">74440</span> pairwise alignments, <span class="hljs-number">74440</span> HSPs.<br><span class="hljs-attribute">14323</span> queries aligned.<br></code></pre></td></tr></table></figure><h1 id="Output-tsv"><a href="#Output-tsv" class="headerlink" title="Output tsv"></a>Output tsv</h1><p>tabular-separated (TSV) format composed of 12 fields, equal to BLAST  -outfmt 6</p><ol><li><strong>Query accession</strong></li><li><strong>Target accession</strong></li><li><strong>Sequence identity</strong></li><li><strong>Length</strong>: The total length of the local alignment, which <strong>including matching</strong> and <strong>mismatching</strong> positions of query and subject, as well as <strong>gap positions</strong> in the query and subject.</li><li><strong>Mismatches</strong></li><li><strong>Gap openings</strong></li><li><strong>Query start</strong>:  (1-based).</li><li><strong>Query end</strong>: (1-based).</li><li><strong>Target start</strong>:  (1-based).</li><li><strong>Target end</strong>:  (1-based).</li><li><strong>E-value</strong>: The expected value of the hit quantifies the number of alignments of similar or better quality that you expect to find searching this query against a database of random sequences the same size as the actual target database. This number is most useful for measuring the significance of a hit. By <strong>default</strong>, DIAMOND will report all alignments with <strong>e-value &lt; 0.001</strong>, meaning that a hit of this quality will be found by chance on average once per 1,000 queries.</li><li><strong>Bit score</strong>: The bit score is a scoring matrix independent measure of the (local) similarity of the two aligned sequences, with higher numbers meaning more similar. It is <strong>always &gt;&#x3D; 0</strong> for <strong>local Smith Waterman alignments</strong>.</li></ol><p>Other available non-default fields </p><h1 id="Using-blast-database"><a href="#Using-blast-database" class="headerlink" title="Using blast database?"></a>Using blast database?</h1><p><strong>Since version 2.0.8, this binary also includes support for using BLAST databases.</strong></p><p><strong>Support for using BLAST databases in not included by default and needs to be enabled by linking against the libraries from the NCBI toolkit. This can either be done by using shared libraries provided by the operating system, or by using self-compiled libraries. The zstd library is required for compilation (see above).</strong></p><h1 id="Q"><a href="#Q" class="headerlink" title="Q"></a>Q</h1><p><strong>How to run the program on multiple input files?</strong></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">zcat</span> <span class="hljs-regexp">*.fasta.gz</span> | diamond makedb -d diamond_db<br></code></pre></td></tr></table></figure><p><a href="https://github.com/bbuchfink/diamond/wiki/4.-Support-&amp;-FAQ">https://github.com/bbuchfink/diamond/wiki/4.-Support-&amp;-FAQ</a></p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>blast</tag>
      
      <tag>diamond</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux Note</title>
    <link href="/GeekFocus/2022/06/07/2022-06-07-Linux/"/>
    <url>/GeekFocus/2022/06/07/2022-06-07-Linux/</url>
    
    <content type="html"><![CDATA[<h1 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h1><span id="more"></span><h4 id="Linuxä¸‹æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶"><a href="#Linuxä¸‹æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶" class="headerlink" title="Linuxä¸‹æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶"></a><a href="https://www.yisu.com/zixun/669303.html#:~:text=%E5%A6%82%E6%9E%9C%E4%BD%A0%E9%9C%80%E8%A6%81%E5%88%86%E6%9E%90%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%EF%BC%8C%E5%8F%AF%E4%BB%A5%E9%A6%96%E5%85%88%E4%BD%BF%E7%94%A8%20file%20%E5%91%BD%E4%BB%A4%E6%9D%A5%E5%88%87%E5%85%A5%E3%80%82%20%E6%88%91%E4%BB%AC%E7%9F%A5%E9%81%93%EF%BC%8C%E5%9C%A8%20Linux%20%E4%B8%8B%EF%BC%8C,%E4%B8%80%E5%88%87%E7%9A%86%E6%96%87%E4%BB%B6%20%EF%BC%8C%E4%BD%86%E5%B9%B6%E4%B8%8D%E6%98%AF%E6%89%80%E6%9C%89%E7%9A%84%E6%96%87%E4%BB%B6%E9%83%BD%E5%85%B7%E6%9C%89%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%80%A7%EF%BC%8C%E6%88%91%E4%BB%AC%E8%BF%98%E6%9C%89%E5%90%84%E7%A7%8D%E5%90%84%E6%A0%B7%E7%9A%84%E6%96%87%E4%BB%B6%EF%BC%8C%E6%AF%94%E5%A6%82%EF%BC%9A%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6%EF%BC%8C%E7%AE%A1%E9%81%93%E6%96%87%E4%BB%B6%EF%BC%8C%E9%93%BE%E6%8E%A5%E6%96%87%E4%BB%B6%EF%BC%8Csocket%E6%96%87%E4%BB%B6%EF%BC%8C%E7%AD%89%E7%AD%89%E3%80%82%20%E5%9C%A8%E5%AF%B9%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E8%BF%9B%E8%A1%8C%E5%88%86%E6%9E%90%E4%B9%8B%E5%89%8D%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E9%A6%96%E5%85%88%E4%BD%BF%E7%94%A8%20file%20%E5%91%BD%E4%BB%A4%E6%9D%A5%E5%88%86%E6%9E%90%E5%AE%83%E4%BB%AC%E7%9A%84%E7%B1%BB%E5%9E%8B%E3%80%82%20%E5%BD%93%E7%84%B6%E9%99%A4%E6%AD%A4%E4%B9%8B%E5%A4%96%EF%BC%8C%E6%88%91%E4%BB%AC%E8%BF%98%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E4%B8%80%E4%BA%9B%E5%85%B6%E5%AE%83%E4%BF%A1%E6%81%AF%E3%80%82">Linuxä¸‹æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶</a></h4><ul><li><p>å¦‚Linuxå‘½ä»¤å’Œä¸€äº›è½¯ä»¶å†…çš„å¯æ‰§è¡Œç¨‹åºï¼Œæ˜¯å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶</p></li><li><p>å…¶ä»–æ–‡ä»¶å¦‚æ–‡æœ¬æ–‡ä»¶ï¼Œç®¡é“æ–‡ä»¶ï¼Œé“¾æ¥æ–‡ä»¶ï¼Œsocketæ–‡ä»¶ï¼Œç­‰</p></li></ul><h5 id="file-å‘½ä»¤"><a href="#file-å‘½ä»¤" class="headerlink" title="file å‘½ä»¤"></a>file å‘½ä»¤</h5><blockquote><p>file å‘½ä»¤åˆ†ææ–‡ä»¶ç±»å‹</p></blockquote><h5 id="lddå‘½ä»¤"><a href="#lddå‘½ä»¤" class="headerlink" title="lddå‘½ä»¤"></a>lddå‘½ä»¤</h5><blockquote><p> ldd å‘½ä»¤å¯ä»¥ç”¨äºåˆ†æå¯æ‰§è¡Œæ–‡ä»¶çš„ä¾èµ–</p></blockquote><p>å¤§éƒ¨åˆ†ç¨‹åºï¼Œéƒ½ä¼šä½¿ç”¨åˆ°ç¬¬ä¸‰æ–¹åº“ï¼Œä¸é‡å¤é€ è½®å­èŠ‚çº¦å¤§é‡æ—¶é—´ã€‚æœ€ç®€å•çš„ä¾‹å­å¦‚Cç¨‹åºä¼šä½¿ç”¨ <code>libc</code> æˆ–è€… <code>glibc</code> åº“ã€‚å½“ç„¶è¿˜å¯èƒ½ä½¿ç”¨å…¶å®ƒåº“</p><p>what is your linux distribution and version?<br>what is the GLIBC version when you issue the command â€˜ldd â€“versionâ€™</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cat</span> /etc/*-release<br></code></pre></td></tr></table></figure><blockquote><p>CentOS Linux release 7.2.1511 (Core)<br>NAME&#x3D;â€CentOS Linuxâ€<br>VERSION&#x3D;â€7 (Core)â€<br>ID&#x3D;â€centosâ€<br>ID_LIKE&#x3D;â€rhel fedoraâ€<br>VERSION_ID&#x3D;â€7â€<br>PRETTY_NAME&#x3D;â€CentOS Linux 7 (Core)â€<br>ANSI_COLOR&#x3D;â€0;31â€<br>CPE_NAME&#x3D;â€cpe:&#x2F;o:centos:centos:7â€<br>HOME_URL&#x3D;â€<a href="https://www.centos.org/&quot;">https://www.centos.org/&quot;</a><br>BUG_REPORT_URL&#x3D;â€<a href="https://bugs.centos.org/&quot;">https://bugs.centos.org/&quot;</a></p><p>CENTOS_MANTISBT_PROJECT&#x3D;â€CentOS-7â€<br>CENTOS_MANTISBT_PROJECT_VERSION&#x3D;â€7â€<br>REDHAT_SUPPORT_PRODUCT&#x3D;â€centosâ€<br>REDHAT_SUPPORT_PRODUCT_VERSION&#x3D;â€7â€</p><p>CentOS Linux release 7.2.1511 (Core)<br>CentOS Linux release 7.2.1511 (Core)</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">uname</span> -a<br></code></pre></td></tr></table></figure><blockquote><p>Linux logina1 3.10.0-327.el7.x86_64 #1 SMP Thu Nov 19 22:10:57 UTC 2015 x86_64 x86_64 x86_64 GNU&#x2F;Linux</p></blockquote><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">ldd <span class="hljs-comment">--version</span><br></code></pre></td></tr></table></figure><blockquote><p>ldd (GNU libc) 2.17<br>Copyright (C) 2012 Free Software Foundation, Inc.<br>This is free software; see the source for copying conditions.  There is NO<br>warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.<br>Written by Roland McGrath and Ulrich Drepper.</p></blockquote><hr><p>other</p><h5 id="ltrace"><a href="#ltrace" class="headerlink" title="ltrace"></a>ltrace</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">ltraceçš„åŠŸèƒ½æ˜¯èƒ½å¤Ÿè·Ÿè¸ªè¿›ç¨‹çš„åº“å‡½æ•°è°ƒç”¨ã€‚<br></code></pre></td></tr></table></figure><h5 id="strace"><a href="#strace" class="headerlink" title="strace"></a>strace</h5><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">strace</span> å‘½ä»¤å¯ä»¥ç”¨äºè¿½è¸ªç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­çš„ç³»ç»Ÿè°ƒç”¨åŠä¿¡å·<br></code></pre></td></tr></table></figure><h5 id="hexdump"><a href="#hexdump" class="headerlink" title="hexdump"></a>hexdump</h5><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">hexdump</span> å‘½ä»¤ç”¨æ¥æŸ¥çœ‹äºŒè¿›åˆ¶æ–‡ä»¶çš„ <span class="hljs-number">16</span> è¿›åˆ¶ç¼–ç ï¼Œä½†å®é™…å®ƒèƒ½æŸ¥çœ‹ä»»ä½•æ–‡ä»¶ï¼Œè€Œä¸é™äºäºŒè¿›åˆ¶æ–‡ä»¶<br></code></pre></td></tr></table></figure><h5 id="strings"><a href="#strings" class="headerlink" title="strings"></a>strings</h5><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-built_in">string</span>s å‘½ä»¤å¯ä»¥ç”¨æ¥æ‰“å°äºŒè¿›åˆ¶æ–‡ä»¶ä¸­å¯æ˜¾ç¤ºçš„å­—ç¬¦<br></code></pre></td></tr></table></figure><h5 id="readelf"><a href="#readelf" class="headerlink" title="readelf"></a>readelf</h5><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fortran">readelf ä¸€èˆ¬ç”¨äºæŸ¥çœ‹ ELF æ ¼å¼çš„æ–‡ä»¶ä¿¡æ¯ã€‚ELFï¼ˆExecutable and Linkable <span class="hljs-keyword">Format</span>ï¼‰å³å¯æ‰§è¡Œè¿æ¥æ–‡ä»¶æ ¼å¼ï¼Œæ˜¯ä¸€ç§æ¯”è¾ƒå¤æ‚çš„æ–‡ä»¶æ ¼å¼ï¼Œä½†å…¶åº”ç”¨å¹¿æ³›ã€‚å½“ä½¿ç”¨ <span class="hljs-keyword">file</span> å‘½ä»¤å‘ç°æŸä¸ªæ–‡ä»¶æ˜¯ ELF æ–‡ä»¶æ—¶ï¼Œå°±å¯ä½¿ç”¨ readelf å‘½ä»¤æ¥è¯»å–è¿™ä¸ªæ–‡ä»¶çš„ä¿¡æ¯<br></code></pre></td></tr></table></figure><h5 id="objdump"><a href="#objdump" class="headerlink" title="objdump"></a>objdump</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">objdumpæ˜¯ç”¨æŸ¥çœ‹ç›®æ ‡æ–‡ä»¶æˆ–è€…å¯æ‰§è¡Œçš„ç›®æ ‡æ–‡ä»¶çš„æ„æˆçš„GCCå·¥å…·<br></code></pre></td></tr></table></figure><h5 id="nm"><a href="#nm" class="headerlink" title="nm"></a>nm</h5><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima"><span class="hljs-built_in">nm</span>å‘½ä»¤ä¸»è¦æ˜¯åˆ—å‡ºç›®æ ‡æ–‡ä»¶çš„ç¬¦å·ï¼ˆè¯´ç™½äº†å°±æ˜¯ä¸€äº›å‡½æ•°å’Œå…¨å±€å˜é‡ç­‰ï¼‰<br></code></pre></td></tr></table></figure><h5 id="gdb"><a href="#gdb" class="headerlink" title="gdb"></a>gdb</h5><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">gdb å°±æ˜¯æ‰€è°“çš„ GNU <span class="hljs-keyword">debugger</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>ldd</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AUGUSTUS</title>
    <link href="/GeekFocus/2022/06/05/2022-06-05-RunningAugustus/"/>
    <url>/GeekFocus/2022/06/05/2022-06-05-RunningAugustus/</url>
    
    <content type="html"><![CDATA[<p>AUGUSTUS Guidline</p><span id="more"></span><h2 id="RUNNING-AUGUSTUS"><a href="#RUNNING-AUGUSTUS" class="headerlink" title="RUNNING AUGUSTUS"></a>RUNNING AUGUSTUS</h2><ol><li><a href="https://github.com/Gaius-Augustus/Augustus/blob/master/docs/RUNNING-AUGUSTUS.md#basic-usage">BASIC USAGE</a></li><li><a href="https://github.com/Gaius-Augustus/Augustus/blob/master/docs/RUNNING-AUGUSTUS.md#sampling-alternative-transcripts-and-posterior-probabilities">SAMPLING: ALTERNATIVE TRANSCRIPTS AND POSTERIOR PROBABILITIES</a></li><li><a href="https://github.com/Gaius-Augustus/Augustus/blob/master/docs/RUNNING-AUGUSTUS.md#using-hints">USING HINTS</a></li><li><a href="https://github.com/Gaius-Augustus/Augustus/blob/master/docs/RUNNING-AUGUSTUS.md#predictions-using-cdna">PREDICTIONS USING CDNA</a></li><li><a href="https://github.com/Gaius-Augustus/Augustus/blob/master/docs/RUNNING-AUGUSTUS.md#ppx">AUGUSTUS-PPX: PREDICTIONS USING PROTEIN PROFILES</a></li><li><a href="https://github.com/Gaius-Augustus/Augustus/blob/master/docs/RUNNING-AUGUSTUS.md#retraining-augustus">RETRAINING AUGUSTUS</a></li><li><a href="https://github.com/Gaius-Augustus/Augustus/blob/master/docs/RUNNING-AUGUSTUS.md#mea-using-the-maximum-expected-accuracy-approach">MEA: USING THE MAXIMUM EXPECTED ACCURACY APPROACH</a></li></ol><h1 id="BASIC-USAGE"><a href="#BASIC-USAGE" class="headerlink" title="BASIC USAGE"></a>BASIC USAGE</h1><p>AUGUSTUS has 2 mandatory arguments. The <font color="blue">query file and the species</font>. The query file contains the DNA input sequence and must be in uncompressed (multiple) fasta format, e.g. the file may look like this:</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gcode">&gt;<span class="hljs-symbol">name_of_sequence_1</span><br>agtgctgcatgctagctagct<br>&gt;<span class="hljs-symbol">name_of_sequence_2</span><br>gtgct<span class="hljs-symbol">ngcatgctagctagctggtgtnntgaaaaatt</span><br></code></pre></td></tr></table></figure><p>Every letter other than a,c,g,t,A,C,G and T is interpreted as an unknown base. Digits and white spaces are ignored. The number of characters per line is not restricted.</p><p>To execute augustus, run the following command with the appropriate <a href="https://github.com/Gaius-Augustus/Augustus/blob/master/docs/RUNNING-AUGUSTUS.md#important-parameters">parameters</a>.</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">augustus [<span class="hljs-keyword">parameters</span>] --species=SPECIES <span class="hljs-comment">queryfilename</span><br></code></pre></td></tr></table></figure><p>If you want to output to be redirected to a file (see also outfile parameter), you can use pipe operators, for example:</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">augustus [<span class="hljs-keyword">parameters</span>] --species=SPECIES <span class="hljs-comment">queryfilename &gt; output.gff</span><br></code></pre></td></tr></table></figure><p>SPECIES is one of the following identifiers. The directory names under config&#x2F;species constitutes the complete list. The identifiers in parentheses denote older versions for that species. â€˜queryfilenameâ€™ is the filename (including relative path) to the file containing the query sequence(s) in fasta format.</p><table><thead><tr><th>identifier</th><th>species</th></tr></thead><tbody><tr><td>human</td><td>Homo sapiens</td></tr><tr><td>fly</td><td>Drosophila melanogaster</td></tr><tr><td>arabidopsis</td><td>Arabidopsis thaliana</td></tr><tr><td>brugia</td><td>Brugia malayi</td></tr><tr><td>aedes</td><td>Aedes aegypti</td></tr><tr><td>tribolium</td><td>Tribolium castaneum</td></tr><tr><td>schistosoma</td><td>Schistosoma mansoni</td></tr><tr><td>tetrahymena</td><td>Tetrahymena thermophila</td></tr><tr><td>galdieria</td><td>Galdieria sulphuraria</td></tr><tr><td>maize</td><td>Zea mays</td></tr><tr><td>toxoplasma</td><td>Toxoplasma gondii</td></tr><tr><td>caenorhabditis</td><td>Caenorhabditis elegans</td></tr><tr><td>(elegans)</td><td>Caenorhabditis elegans</td></tr><tr><td>aspergillus_fumigatus</td><td>Aspergillus fumigatus</td></tr><tr><td>aspergillus_nidulans</td><td>Aspergillus nidulans</td></tr><tr><td>(anidulans)</td><td>Aspergillus nidulans</td></tr><tr><td>aspergillus_oryzae</td><td>Aspergillus oryzae</td></tr><tr><td>aspergillus_terreus</td><td>Aspergillus terreus</td></tr><tr><td>botrytis_cinerea</td><td>Botrytis cinerea</td></tr><tr><td>candida_albicans</td><td>Candida albicans</td></tr><tr><td>candida_guilliermondii</td><td>Candida guilliermondii</td></tr><tr><td>candida_tropicalis</td><td>Candida tropicalis</td></tr><tr><td>chaetomium_globosum</td><td>Chaetomium globosum</td></tr><tr><td>coccidioides_immitis</td><td>Coccidioides immitis</td></tr><tr><td>coprinus</td><td>Coprinus cinereus</td></tr><tr><td>coprinus_cinereus</td><td>Coprinus cinereus</td></tr><tr><td>coyote_tobacco</td><td>Nicotiana attenuata</td></tr><tr><td>cryptococcus_neoformans_gattii</td><td>Cryptococcus neoformans gattii</td></tr><tr><td>cryptococcus_neoformans_neoformans_B</td><td>Cryptococcus neoformans neoformans</td></tr><tr><td>cryptococcus_neoformans_neoformans_JEC21</td><td>Cryptococcus neoformans neoformans</td></tr><tr><td>(cryptococcus)</td><td>Cryptococcus neoformans</td></tr><tr><td>debaryomyces_hansenii</td><td>Debaryomyces hansenii</td></tr><tr><td>encephalitozoon_cuniculi_GB</td><td>Encephalitozoon cuniculi</td></tr><tr><td>eremothecium_gossypii</td><td>Eremothecium gossypii</td></tr><tr><td>fusarium_graminearum</td><td>Fusarium graminearum</td></tr><tr><td>(fusarium)</td><td>Fusarium graminearum</td></tr><tr><td>histoplasma_capsulatum</td><td>Histoplasma capsulatum</td></tr><tr><td>(histoplasma)</td><td>Histoplasma capsulatum</td></tr><tr><td>kluyveromyces_lactis</td><td>Kluyveromyces lactis</td></tr><tr><td>laccaria_bicolor</td><td>Laccaria bicolor</td></tr><tr><td>lamprey</td><td>Petromyzon marinus</td></tr><tr><td>leishmania_tarentolae</td><td>Leishmania tarentolae</td></tr><tr><td>lodderomyces_elongisporus</td><td>Lodderomyces elongisporus</td></tr><tr><td>magnaporthe_grisea</td><td>Magnaporthe grisea</td></tr><tr><td>neurospora_crassa</td><td>Neurospora crassa</td></tr><tr><td>(neurospora)</td><td>Neurospora crassa</td></tr><tr><td>phanerochaete_chrysosporium</td><td>Phanerochaete chrysosporium</td></tr><tr><td>(pchrysosporium)</td><td>Phanerochaete chrysosporium</td></tr><tr><td>pichia_stipitis</td><td>Pichia stipitis</td></tr><tr><td>rhizopus_oryzae</td><td>Rhizopus oryzae</td></tr><tr><td>saccharomyces_cerevisiae_S288C</td><td>Saccharomyces cerevisiae</td></tr><tr><td>saccharomyces_cerevisiae_rm11-1a_1</td><td>Saccharomyces cerevisiae</td></tr><tr><td>(saccharomyces)</td><td>Saccharomyces cerevisiae</td></tr><tr><td>schizosaccharomyces_pombe</td><td>Schizosaccharomyces pombe</td></tr><tr><td>thermoanaerobacter_tengcongensis</td><td>Thermoanaerobacter tengcongensis</td></tr><tr><td>trichinella</td><td>Trichinella spiralis</td></tr><tr><td>ustilago_maydis</td><td>Ustilago maydis</td></tr><tr><td>(ustilago)</td><td>Ustilago maydis</td></tr><tr><td>yarrowia_lipolytica</td><td>Yarrowia lipolytica</td></tr><tr><td>nasonia</td><td>Nasonia vitripennis</td></tr><tr><td>tomato</td><td>Solanum lycopersicum</td></tr><tr><td>chlamydomonas</td><td>Chlamydomonas reinhardtii</td></tr><tr><td>amphimedon</td><td>Amphimedon queenslandica</td></tr><tr><td>pneumocystis</td><td>Pneumocystis jirovecii</td></tr><tr><td>wheat</td><td>Triticum aestivum</td></tr><tr><td>chicken</td><td>Gallus gallus</td></tr><tr><td>zebrafish</td><td>Danio rerio</td></tr><tr><td>E_coli_K12</td><td>Escherichia coli</td></tr><tr><td>s_aureus</td><td>Staphylococcus aureus</td></tr><tr><td>volvox</td><td>Volvox carteri</td></tr></tbody></table><h2 id="Important-Parameters"><a href="#Important-Parameters" class="headerlink" title="Important Parameters"></a>Important Parameters</h2><ul><li><font color="red">â€“strand&#x3D;both</font>, â€“strand&#x3D;forward or â€“strand&#x3D;backward report <font color="blue">predicted genes on both strands</font>, just the forward or just the backward strand. <font color="blue">default is â€˜bothâ€™</font></li><li><font color="red">â€“genemodel</font>&#x3D;partial, â€“genemodel&#x3D;intronless, â€“genemodel&#x3D;complete, â€“genemodel&#x3D;atleastone or â€“genemodel&#x3D;exactlyone <ul><li>partial : <font color="blue">allow prediction of incomplete genes at the sequence boundaries <strong>(default)</strong> </font></li><li>intronless : <font color="blue">only predict single-exon genes</font> like in prokaryotes and some eukaryotes </li><li>complete : <font color="blue"><strong>only predict complete</strong> genes </font></li><li>atleastone : predict <font color="blue"><strong>at least one</strong> complete gene </font></li><li>exactlyone : predict <font color="blue"><strong>exactly one</strong> complete gene</font></li></ul></li><li>â€“singlestrand&#x3D;true <font color="blue">predict genes independently on each strand</font>, <font color="blue">allow overlapping genes on opposite strands</font> This option is <font color="blue"><strong>turned off by default</strong></font>.</li><li>â€“hintsfile&#x3D;hintsfilename When this option is used the prediction considering hints (extrinsic information) is turned on. hintsfile name contains the hints in gff format.</li><li>â€“extrinsicCfgFile&#x3D;cfgfilename Optional. This file contains the list of used sources for the hints and their boni and mali. If not specified the file â€œextrinsic.cfgâ€ in the config directory $AUGUSTUS_CONFIG_PATH is used.</li><li>â€“maxDNAPieceSize&#x3D;n This value specifies the maximal length of the pieces that the sequence is cut into for the core algorithm (Viterbi) to be run. Default is â€“maxDNAPieceSize&#x3D;200000. AUGUSTUS tries to place the boundaries of these pieces in the intergenic region, which is inferred by a preliminary prediction. GC-content dependent parameters are chosen for each piece of DNA if &#x2F;Constant&#x2F;decomp_num_steps &gt; 1 for that species. This is why this value should not be set very large, even if you have plenty of memory.</li><li>â€“protein&#x3D;on&#x2F;off</li><li>â€“codingseq&#x3D;on&#x2F;off</li><li>â€“introns&#x3D;on&#x2F;off</li><li>â€“start&#x3D;on&#x2F;off</li><li>â€“stop&#x3D;on&#x2F;off</li><li>â€“cds&#x3D;on&#x2F;off</li><li>â€“exonnames&#x3D;on&#x2F;off<br>Output options. Output predicted amino acid sequences or coding sequences. Or toggle the display of the GFF features&#x2F;lines of type intron, start codon, stop codon, CDS or â€˜initialâ€™, â€˜internalâ€™, â€˜terminalâ€™ and â€˜singleâ€™ exon type names. <font color="blue">The CDS excludes the stop codon</font> (unless <font color="red">stopCodonExcludedFromCDS&#x3D;false</font>) <font color="blue">whereas the terminal and single exon include the stop codon</font>.</li><li>â€“AUGUSTUS_CONFIG_PATH&#x3D;path path to config directory (if not specified as environment variable)</li><li><font color="red">ã€â€“alternatives-from-evidenceã€‘&#x3D;true&#x2F;false</font> report alternative transcripts when they are suggested by hints</li><li>â€“alternatives-from-sampling&#x3D;true&#x2F;false report alternative transcripts generated through probabilistic sampling</li><li>â€“sample&#x3D;n</li><li>â€“minexonintronprob&#x3D;p</li><li>â€“minmeanexonintronprob&#x3D;p</li><li>â€“maxtracks&#x3D;n For a description of these parameters see section 4 below.</li><li>â€“proteinprofile&#x3D;filename Read a protein profile from file filename. See <a href="https://github.com/Gaius-Augustus/Augustus/blob/master/docs/RUNNING-AUGUSTUS.md#ppx">section on PPX</a> below.</li><li>â€“predictionStart&#x3D;A, â€“predictionEnd&#x3D;B A and B define the range of the sequence for which predictions should be found. Quicker if you need predictions only for a small part.</li><li>â€“gff3&#x3D;on&#x2F;off output in gff3 format</li><li>â€“UTR&#x3D;on&#x2F;off predict the untranslated regions in addition to the coding sequence. <font color="blue">This currently works only for human, galdieria, toxoplasma and caenorhabditis.</font></li><li>â€“outfile&#x3D;filename print output to filename instead to standard output. This is useful for computing environments, e.g. parasol jobs, which do not allow shell redirection.</li><li><font color="red">ã€â€“noInFrameStop&#x3D;true&#x2F;falseã€‘ </font>Donâ€™t report transcripts with in-frame stop codons. Otherwise, intron-spanning stop codons could occur. Default: false</li><li>â€“noprediction&#x3D;true&#x2F;false If true and input is in genbank format, no prediction is made. Useful for getting the annotated protein sequences.</li><li>â€“contentmodels&#x3D;on&#x2F;off If â€˜offâ€™ the content models are disabled (all emissions uniformly 1&#x2F;4). The content models are; coding region Markov chain (emiprobs), initial k-mers in coding region (Pls), intron and intergenic regin Markov chain. This option is intended for special applications that require judging gene structures from the signal models only, e.g. for predicting the effect of SNPs or mutations on splicing. For all typical gene predictions, this should be true. Default: on</li></ul><p>For example you may type</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">augustus <span class="hljs-attribute">--species</span>=human <span class="hljs-attribute">--UTR</span>=on <span class="hljs-built_in">..</span>/examples/example.fa<br></code></pre></td></tr></table></figure><p>The output format is gtf similar to General Feature Format (gff), see <a href="http://www.sanger.ac.uk/Software/formats/GFF/">http://www.sanger.ac.uk/Software/formats/GFF/</a>. It contains one line per predicted exon. Example:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">HS04636</span>   AUGUSTUS   initial    <span class="hljs-number">966</span>     <span class="hljs-number">1017</span>    .       +       <span class="hljs-number">0</span>       transcript_id <span class="hljs-string">&quot;g1.1&quot;</span>; gene_id <span class="hljs-string">&quot;g1&quot;</span>;<br><span class="hljs-attribute">HS04636</span>   AUGUSTUS   internal   <span class="hljs-number">1818</span>    <span class="hljs-number">1934</span>    .       +       <span class="hljs-number">2</span>       transcript_id <span class="hljs-string">&quot;g1.1&quot;</span>; gene_id <span class="hljs-string">&quot;g1&quot;</span>;<br></code></pre></td></tr></table></figure><p>The columns (fields) contain:</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">seqname   source     feature    <span class="hljs-keyword">start</span>   <span class="hljs-keyword">end</span>   score   strand   frame    transcript <span class="hljs-keyword">and</span> gene <span class="hljs-type">name</span><br></code></pre></td></tr></table></figure><p>AUGUSTUS also accepts files in annotated <strong>GENBANK format as input</strong>. This is needed for training. Also when predicting on a genbank file AUGUSTUS compares its prediction to the annotation and prints out a statistic. Example genbank file format accepted by AUGUSTUS:</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs dns">LOCUS       HS04636   <span class="hljs-number">9453</span> bp  DNA<br>FEATURES             Location/Qualifiers<br>     source          <span class="hljs-number">1</span>..<span class="hljs-number">9453</span><br>     <span class="hljs-keyword">CDS</span>             join(<span class="hljs-number">966</span>..<span class="hljs-number">1017,1818</span>..<span class="hljs-number">1934,2055</span>..<span class="hljs-number">2198,2852</span>..<span class="hljs-number">2995,3426</span>..<span class="hljs-number">3607</span>,<br>                     <span class="hljs-number">4340</span>..<span class="hljs-number">4423,4543</span>..<span class="hljs-number">4789,5072</span>..<span class="hljs-number">5358,5860</span>..<span class="hljs-number">6007,6494</span>..<span class="hljs-number">6903</span>)<br>BASE COUNT     <span class="hljs-number">2937</span> a   <span class="hljs-number">1716</span> c  <span class="hljs-number">1710</span> g   <span class="hljs-number">3090</span> t<br>ORIGIN<br>        <span class="hljs-number">1</span> gagctcacat taactattta cagggtaact gcttaggacc agtattatga ggagaattta<br>       <span class="hljs-number">61</span> cctttcccgc ctctctttcc aagaaacaag gagggggtga aggtacggag aacagtattt<br>      <span class="hljs-number">121</span> cttctgttga aagcaactta gctacaaaga taaattacag ctatgtacac tgaaggtagc<br>      ...<br>     <span class="hljs-number">9421</span> aaaaaaaaaa aaaaatcgat gtcgactcga gtc<br>//<br></code></pre></td></tr></table></figure><p>Another example that is important for training the UTR models. The following genbank file will be interpreted as having three genes. One gene (â€˜Aâ€™) with both 5â€™ and 3â€™ UTR and two single UTRs without matching coding sequence. Gene â€˜Bâ€™ consists just of the 5â€™UTR, gene â€˜Câ€™ just of the 3â€™ UTR.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">LOCUS       example2   9453 bp  DNA<br>FEATURES             Location/Qualifiers<br>     <span class="hljs-built_in">source</span>          1..9453<br>     mRNA            <span class="hljs-built_in">join</span>(100..200,900..1017,1818..2000,2100..2200)<br>                     /gene=<span class="hljs-string">&quot;A&quot;</span><br>     CDS             <span class="hljs-built_in">join</span>(966..1017,1818..1934)<br>                     /gene=<span class="hljs-string">&quot;A&quot;</span><br>     mRNA            <span class="hljs-built_in">join</span>(3100..3200,3500..&gt;3600)<br>                     /gene=<span class="hljs-string">&quot;B&quot;</span><br>     mRNA            <span class="hljs-built_in">join</span>(&lt;4100..4200,4500..4600)<br>                     /gene=<span class="hljs-string">&quot;C&quot;</span><br><br>BASE COUNT     2937 a   1716 c  1710 g   3090 t<br>ORIGIN<br>        1 gagctcacat taactattta cagggtaact gcttaggacc agtattatga ggagaattta<br>       61 cctttcccgc ctctctttcc aagaaacaag gagggggtga aggtacggag aacagtattt<br>      121 cttctgttga aagcaactta gctacaaaga taaattacag ctatgtacac tgaaggtagc<br>      ...<br>     9421 aaaaaaaaaa aaaaatcgat gtcgactcga gtc<br>//<br></code></pre></td></tr></table></figure><h1 id="SAMPLING-ALTERNATIVE-TRANSCRIPTS-AND-POSTERIOR-PROBABILITIES"><a href="#SAMPLING-ALTERNATIVE-TRANSCRIPTS-AND-POSTERIOR-PROBABILITIES" class="headerlink" title="SAMPLING: ALTERNATIVE TRANSCRIPTS AND POSTERIOR PROBABILITIES"></a>SAMPLING: ALTERNATIVE TRANSCRIPTS AND POSTERIOR PROBABILITIES</h1><p>Note that for the prediction of alternative splicing there is another method described in 5. below.</p><h2 id="Alternative-transcripts-from-sampling"><a href="#Alternative-transcripts-from-sampling" class="headerlink" title="Alternative transcripts (from sampling)"></a>Alternative transcripts (from sampling)</h2><p>When you say on the command line</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">--alternatives-from-sampling</span>=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>or edit the appropriate line in the configuration file for your species to <font color="blue">alternatives true then AUGUSTUS may report multiple transcripts per gene</font>. A gene is then defined as a set of transcripts, whose coding sequences (indirectly) overlap. The number of alternatives AUGUSTUS reports for a gene depends on which ones are likely alternatives. If just one transcript is likely in that region then also just one transcript is reported. The behavior of AUGUSTUS can be adjusted with the parameters</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">--minexonintronprob</span>=p<br><span class="hljs-attr">--minmeanexonintronprob</span>=p<br><span class="hljs-attr">--maxtracks</span>=n (default -<span class="hljs-number">1</span>, <span class="hljs-literal">no</span> limit)<br></code></pre></td></tr></table></figure><p>The posterior probability of every exon and every intron in a transcript must be at least â€˜minexonintronprobâ€™, otherwise the transcript is not reported. minexonintronprob&#x3D;0.1 is a reasonable value. In addition the geometric mean of the probabilities of all exons and introns must be at least â€˜minmeanexonintronprobâ€™. minmeanexonintronprob&#x3D;0.4 is a reasonable value. The maximum number of tracks when displayed in a genome browser is â€˜maxtracksâ€™ (unless maxtracks&#x3D;-1, then it is unbounded). In cases where all transcripts of a gene overlap at some position this is also the maximal number of transcripts for that gene. I recommend increasing the parameter â€˜maxtracksâ€™ for improving sensitivity and setting â€˜maxtracksâ€™ to 1 and increasing minmeanexonintronprob and&#x2F;or minexonintronprob in order to improve specificity.</p><h2 id="Posterior-probabilities"><a href="#Posterior-probabilities" class="headerlink" title="Posterior probabilities"></a>Posterior probabilities</h2><p>AUGUSTUS reports the posterior probabilities of exons, introns, transcripts and genes. The <font color="blue">posterior probability of an exon is the conditional probability that the random gene structure has some exon with these coordinates on this strand given the input sequence</font>. It not only depends on the sequence in the range of the exon itself like an exon score but is influenced for example by the possibilities of compatible neighboring exons. The intron score is similar. The reported probability of a transcript is the probability that a splice variant is exactly like in the given transcript. The reported probability of a gene is the probability that SOME coding sequence is in the reported range on the reported strand, regardless of the exact transcript.</p><p>The posterior probabilities are estimated using a sampling algorithm. The parameter â€“sample&#x3D;&#x3D;n adjusts the number of sampling iterations. The higher â€˜nâ€™ is the more accurate is the estimation but it usually isnâ€™t important that the posterior probability is very accurate. Every 30 sample iterations take about the same time as one run without sampling, e.g. â€“sample&#x3D;60 takes about 3 times as much time as â€“sample&#x3D;0 (which was standard up to version 1.6). The <font color="blue">default is</font></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">--sample</span>=<span class="hljs-number">100</span><br></code></pre></td></tr></table></figure><p>If you do not need the posterior probabilities or alternative transcripts, say</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">--sample</span>=<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>There are 3 common scenarios for above parameters, depending on what you want:</p><ol><li><font color="blue">Just output the <strong>most likely gene structure</strong> as in previous versions. No posterior probabilities, no alternatives:</font></li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">--sample=0 --alternatives=<span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><ol><li><font color="blue">Output the <strong>most likely gene structure</strong> and report posterior probabilities:</font></li></ol><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">--sample</span>=100 <span class="hljs-attribute">--alternatives</span>=<span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><ol><li><font color="blue">Output <strong>alternative transcripts</strong> and report posterior probabilities:</font></li></ol><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">--sample</span>=100 <span class="hljs-attribute">--alternatives</span>=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>Be aware that sampling is pseudorandom and that the results may vary from machine to machine.</p><h2 id="Heating"><a href="#Heating" class="headerlink" title="Heating?"></a>Heating?</h2><p>The probabilistic model of AUGUSTUS can be seen as a rough approximation to reality. A consequence is that the posterior probabilities for the strong exons (e.g. the ones called by the Viterbi algorithm) tend to be larger than the actually measured precision (specificity) values. For example, in human, only 94.5% of the exons with predicted posterior probability &gt;&#x3D; 98% (under the default â€“sample&#x3D;100) are actually correct. See docs&#x2F;CDS.sp.{pdf,README} for more data and an explanation. If the aim of the sampling is to produce a diverse, sensitive (including) set of gene structures, you can use this parameter</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">--temperature</span>=t<br></code></pre></td></tr></table></figure><p>where t is one of 0,1,2,3,4,5,6,7. All probabilities of the model are then taken to the power of (8-t)&#x2F;8, i.e. <font color="blue">t&#x3D;0 (the default) does nothing</font>. The larger t the more alternatives are sampled. <font color="blue">t&#x3D;3 is a good compromise between getting a high sensitivity but not getting too many exons sampled in total</font>. For t&#x3D;3, 96.1% of human exons with posterior probability &gt;&#x3D; 98% are correct.</p><h1 id="USING-HINTS"><a href="#USING-HINTS" class="headerlink" title="USING HINTS"></a>USING HINTS</h1><p>AUGUSTUS can take hints on the gene structure. Previously, this was also called AUGUSTUS+. It currently accepts 16 types of hints:<br>start, stop, tss, tts, ass, dss, exonpart, exon, intronpart, intron, CDSpart, CDS, UTRpart, UTR, irpart, nonexonpart. The hints must be stored in a file in gff format containing one hint per line. Below is an example of a hintsfile:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">HS04636</span>mario   exonpart   <span class="hljs-number">500</span>   <span class="hljs-number">506</span>     .-.source=M<br><span class="hljs-attribute">HS04636</span>mario   exon       <span class="hljs-number">966</span>  <span class="hljs-number">1017</span>     .+<span class="hljs-number">0</span>source=P<br><span class="hljs-attribute">HS04636</span>AGRIPPA start      <span class="hljs-number">966</span>   <span class="hljs-number">968</span>  <span class="hljs-number">6</span>.<span class="hljs-number">3</span>e-<span class="hljs-number">239</span>+<span class="hljs-number">0</span>group=gb|AAA35803.<span class="hljs-number">1</span>;source=P<br><span class="hljs-attribute">HS04636</span>AGRIPPA dss       <span class="hljs-number">2199</span>  <span class="hljs-number">2199</span>  <span class="hljs-number">1</span>.<span class="hljs-number">3</span>e-<span class="hljs-number">216</span>+.group=gb|AAA35803.<span class="hljs-number">1</span>;source=P<br><span class="hljs-attribute">HS04636</span>mario   stop      <span class="hljs-number">7631</span>  <span class="hljs-number">7633</span>     .+<span class="hljs-number">0</span>source=M<br><span class="hljs-attribute">HS08198</span>AGRIPPA intron    <span class="hljs-number">2000</span>  <span class="hljs-number">2000</span>     <span class="hljs-number">0</span>+.group=ref|NP_000597.<span class="hljs-number">1</span>;source=E<br><span class="hljs-attribute">HS08198</span>AGRIPPA ass        <span class="hljs-number">757</span>   <span class="hljs-number">757</span>   <span class="hljs-number">1</span>.<span class="hljs-number">4</span>e-<span class="hljs-number">52</span>+.group=ref|NP_000597.<span class="hljs-number">1</span>;source=E<br></code></pre></td></tr></table></figure><p>The fields must be separated by a tabulator. In the first column (field) the sequence name is given. In this case the hints are together about two sequences. The second field is the name of the program that produced the hint. It is ignored here. The third column specifies the type of the hint. The 4th and 5th column specify the begin and end position of the hint. Positions start at 1. The 6th colum gives a score. The 7th the strand. The 8th the reading frame as defined in the GFF standard. The 9th column contains arbitrary extra information but it must contain a string â€˜source&#x3D;Xâ€™ where X is the source identifier of the hint. Which values for X are possible is specified in the file augustus&#x2F;config&#x2F;extrinsic.cfg, e.g. X&#x3D;M, E, or P.</p><p>AUGUSTUS can follow a hint, i.e. predict a gene structure that is compatible with it, or AUGUSTUS can ignore a hint, i.e. predict a gene structure that is not compatible with it. The probability that AUGUSTUS ignores a hint is the smaller the more reliable the hints of this type are.</p><p>Below in an example to run AUGUSTUS using the â€“hintsfile option:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">augustus --species=human --hintsfile=..<span class="hljs-regexp">/examples/</span>hints.gff --extrinsicCfgFile=..<span class="hljs-regexp">/config/</span>extrinsic<span class="hljs-regexp">/extrinsic.MPE.cfg ../</span>examples/example.fa<br></code></pre></td></tr></table></figure><p>As an alternative to giving the option â€“extrinsicCfgFile you can replace augustus&#x2F;config&#x2F;extrinsic.cfg with the appropriate file, as this file is read by default when the option â€“extrinsicCfgFile is not given.</p><p>The preferable way to use repeat information is via softmasking in which the bases in repeat regions are lower case (a,c,g,t instead of A,C,G,T) in the input. Running augustus could look like this:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">augustus <span class="hljs-attribute">--species</span>=human <span class="hljs-attribute">--softmasking</span>=1<br></code></pre></td></tr></table></figure><p>will interpret masked regions as evidence against exons (nonexonparts hints with a default bonus of 1.15). This is slightly more accurate than hard masking (with Nâ€™s), which looses information. On human augustus is also more than twice as fast with softmasking&#x3D;1 than on hard masked sequence.</p><h2 id="Explanation-of-the-file-format-of-the-extrinsic-cfg-file"><a href="#Explanation-of-the-file-format-of-the-extrinsic-cfg-file" class="headerlink" title="Explanation of the file format of the extrinsic.cfg file."></a>Explanation of the file format of the extrinsic.cfg file.</h2><p>The gff&#x2F;gtf file containint the hints must contain somewhere in the last column an entry source&#x3D;?, where ? is one of the source characters listed in the line after [SOURCES] above. You can use different sources when you have hints of different reliability of the same type, e.g. exon hints from ESTs and exon hints from evolutionary conservation information.</p><p>In the [GENERAL] section the entries second column specify a bonus for obeying a hint and the entry in the third column specify a malus (penalty) for predicting a feature that is not supported by any hint. The bonus and the malus is a factor that is multiplied to the posterior probability of gene structures. Example:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">CDS</span>     <span class="hljs-number">1000</span>  <span class="hljs-number">0</span>.<span class="hljs-number">7</span>  ....<br></code></pre></td></tr></table></figure><p>means that, when AUGUSTUS is searching for the most likely gene structure, every gene structure that has a CDS exactly as given in a hint gets a bonus factor of 1000. Also, for every CDS that is not supported the probability of the gene structure gets a malus of 0.7. Increase the bonus to make AUGUSTUS obey more hints, decrease the malus to make AUGUSTUS predict few features that are not supported by hints. The malus helps increasing specificity, e.g. when the exons predicted by AUGUSTUS are suspicious because there is no evidence from ESTs, mRNAs, protein databases, sequence conservation, transMapped expressed sequences. Setting the malus to 1.0 disables those penalties. Setting the bonus to 1.0 disables the boni.</p><ul><li>start: translation start (start codon), specifies an interval that contains the start codon. The interval can be larger than 3bp, in which case every ATG in the interval gets a bonus. The highest bonus is given to ATGs in the middle of the interval, the bonus fades off towards the ends.</li><li>stop: translation end (stop codon), see â€˜startâ€™</li><li>tss: transcription start site, see â€˜startâ€™</li><li>tts: transcription termination site, see â€˜startâ€™</li><li>ass: acceptor (3â€™) splice site, the last intron position, for only approximately known ass an interval can be specified</li><li>dss: donor (5â€™) splice site, the first intron position, for only approximately known dss an interval can be specified</li><li>exonpart: part of an exon in the biological sense. The bonus applies only to exons that contain the interval from the hint. Just overlapping means no bonus at all. The malus applies to every base of an exon. Therefore the malus for an exon is exponential in the length of an exon: malus&#x3D;exonpartmalus^length. Therefore the malus should be close to 1, e.g. 0.99.</li><li>exon: exon in the biological sense. Only exons that exactly match the hint get a bonus. Exception: The exons that contain the start codon and stop codon. This malus applies to a complete exon independent of its length.</li><li>intronpart: introns both between coding and non-coding exons. The bonus applies to every intronic base in the interval of the hint.</li><li>intron: An intron gets the bonus if and only if it is exactly as in the hint.</li><li>CDSpart: part of the coding part of an exon. (CDS &#x3D; coding sequence)</li><li>CDS: coding part of an exon with exact boundaries. For internal exons of a multi exon gene this is identical to the biological boundaries of the exon. For the first and the last coding exon the boundaries are the boundaries of the coding sequence (start, stop).</li><li>UTR: exact boundaries of a UTR exon or the untranslated part of a partially coding exon.</li><li>UTRpart: The hint interval must be included in the UTR part of an exon.</li><li>irpart: The bonus applies to every base of the intergenic region. If UTR prediction is turned on (â€“UTR&#x3D;on) then UTR is considered genic. If you choose against the usual meaning the bonus of irparts to be much smaller than 1 in the configuration file you can force AUGUSTUS to not predict an intergenic region in the specified interval. This is useful if you want to tell AUGUSTUS that two distant exons belong to the same gene, when AUGUSTUS tends to split that gene into smaller genes.</li><li>nonexonpart: intergenic region or intron. The bonus applies to very non-exon base that overlaps with the interval from the hint. It is geometric in the length of that overlap, so choose it close to 1.0. This is useful as a weak kind of masking, e.g. when it is unlikely that a retroposed gene contains a coding region but you do not want to completely forbid exons.</li><li>genicpart: everything that is not intergenic region, i.e. intron or exon or UTR if applicable. The bonus applies to every genic base that overlaps with the interval from the hint. This can be used in particular to make Augustus predict one gene between positions a and b if a and b are experimentally confirmed to be part of the same gene, e.g. through ESTs from the same clone. alias: nonirpart</li></ul><p>Any hints of types dss, intron, exon, CDS, UTR that (implicitly) suggest a donor splice site allow AUGUSTUS to predict a donor splice site that has a GC instead of the much more common GT. AUGUSTUS does not predict a GC donor splice site unless there is a hint for one.</p><p>Starting in column number 4 you can tell AUGUSTUS how to modify the bonus depending on the source of the hint and the score of the hint. The score of the hints is specified in the 6th column of the hint gff&#x2F;gtf. If the score is used at all, the score is not used directly through some conversion formula but by distinguishing different classes of scores, e.g. low score, medium score, high score. The format is the following: First, you specify the source character, then the number of classes (say n), then you specify the score boundaries that separate the classes (n-1 thresholds) and then you specify for each score class the multiplicative modifier to the bonus (n factors).</p><h3 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">M</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span>e+<span class="hljs-number">100</span><br></code></pre></td></tr></table></figure><p>means for the manual hint there is only one score class, the bonus for this type of hint is multiplied by 10^100. This practically forces AUGUSTUS to obey all manual hints.</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">T</span>    <span class="hljs-number">2</span>       <span class="hljs-number">1</span>.<span class="hljs-number">5</span> <span class="hljs-number">1</span> <span class="hljs-number">5</span>e29<br></code></pre></td></tr></table></figure><p>For the transMap hints distinguish 2 classes. Those with a score below 1.5 and with a score above 1.5. The bonus if the lower score hints is unchanged and the bonus of the higher score hints is multiplied by 5x10^29.</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">D</span>    <span class="hljs-number">8</span>     <span class="hljs-number">1</span>.<span class="hljs-number">5</span>  <span class="hljs-number">2</span>.<span class="hljs-number">5</span>  <span class="hljs-number">3</span>.<span class="hljs-number">5</span>  <span class="hljs-number">4</span>.<span class="hljs-number">5</span>  <span class="hljs-number">5</span>.<span class="hljs-number">5</span>  <span class="hljs-number">6</span>.<span class="hljs-number">5</span>  <span class="hljs-number">7</span>.<span class="hljs-number">5</span>  <span class="hljs-number">0</span>.<span class="hljs-number">58</span>  <span class="hljs-number">0</span>.<span class="hljs-number">4</span>  <span class="hljs-number">0</span>.<span class="hljs-number">2</span>  <span class="hljs-number">2</span>.<span class="hljs-number">9</span>  <span class="hljs-number">0</span>.<span class="hljs-number">87</span>  <span class="hljs-number">0</span>.<span class="hljs-number">44</span> <span class="hljs-number">0</span>.<span class="hljs-number">31</span>  <span class="hljs-number">7</span>.<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>Use 8 score classes for the DIALIGN hints. DIALIGN hints give a score, a strand and reading frame information for CDSpart hints. The strand and reading frame are often correct but not often enough to rely on them. To account for that I generated hints for all 6 combinations of a strand and reading frame and then used 2x2x2&#x3D;8 different score classes: {low score, high score} x {DIALIGN strand, opposite strand} x {DIALIGN reading frame, other reading frame} This example shows that scores donâ€™t have to be monotonous. A higher score does not have to mean a higher bonus. They are merely a way of classifying the hints into categories as you wish. In particular, you could get the effect of having different sources by having just hints of one source and then distinguishing more scores classes.</p><h2 id="Alternative-Transcripts-x2F-Alternative-Splicing-evidence-based"><a href="#Alternative-Transcripts-x2F-Alternative-Splicing-evidence-based" class="headerlink" title="Alternative Transcripts &#x2F; Alternative Splicing (evidence based)"></a>Alternative Transcripts &#x2F; Alternative Splicing (evidence based)</h2><p>AUGUSTUS can predict alternative splicing or - more general - alternative transcripts that are suggested by evidence given in hints. The method is very general. But to give an example: If two EST alignments to the same genomic area cannot be explained by a single transcript then AUGUSTUS can predict a gene with two different splice forms, one splice form compatible with each of the EST alignments.</p><h3 id="Grouping-hints"><a href="#Grouping-hints" class="headerlink" title="Grouping hints"></a>Grouping hints</h3><p>Each hint can be given a group name, by specifying â€˜group&#x3D;goupname;â€™ or â€˜grp&#x3D;goupname;â€™ in the last column for the hint in the gff file. This should be used to group all the hints coming from the alignment of the same sequence to the genome. For example, if an EST with the name est_xyz aligns to the genome with one gap suggesting an intron then the hints resulting from that alignment could look like this</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">HS04636blat2hintsexonpart   500599.+.<span class="hljs-attribute">group</span>=est_xyz; <span class="hljs-attribute">source</span>=E<br>HS04636blat2hintsintron     600700.+.<span class="hljs-attribute">group</span>=est_xyz; <span class="hljs-attribute">source</span>=E<br>HS04636blat2hintsexonpart   701900.+.<span class="hljs-attribute">group</span>=est_xyz; <span class="hljs-attribute">source</span>=E<br></code></pre></td></tr></table></figure><p>Grouping tells AUGUSTUS that hints belong together. Ideally, all hints of a group are obeyed by a predicted transcript or the whole group of hints is ignored when making the prediction.</p><h3 id="Prioritizing-groups"><a href="#Prioritizing-groups" class="headerlink" title="Prioritizing groups:"></a>Prioritizing groups:</h3><p>Hints or hint groups can be given a priority by specifying â€˜priority&#x3D;n;â€™ or â€˜pri&#x3D;nâ€™ in the last column for the hint in the gff file. For example</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">HS04636blat2hintsexonpart   500599.+.<span class="hljs-attribute">priority</span>=2; <span class="hljs-attribute">source</span>=E<br>HS04636blat2hintsintron     550650.+.<span class="hljs-attribute">priority</span>=5; <span class="hljs-attribute">source</span>=mRNA<br></code></pre></td></tr></table></figure><p>When two hints or hint groups contradict each other then the hints with the lower priority number are ignored. This is especially useful if for a genome several sources of hints are available, where one source should be trusted when in doubt. For example, the rhesus macaque currently has few native ESTs but human ESTs often also align to rhesus. Giving the hints from native ESTs a higher priority means that AUGUSTUS uses only them for genes with support by native ESTs and uses the alien EST alignments when native ESTs alignments are not available for a gene. When the priority is not specified, it is internally set to -1.</p><p>When AUGUSTUS is run with â€“alternatives-from-evidence&#x3D;false then all hints are given to AUGUSTUS at the same time no whether they can be explained with a single transcript per gene. AUGUSTUS will then choose the most likely transcript variant.</p><p>When AUGUSTUS is run with â€“alternatives-from-evidence&#x3D;true then AUGUSTUS will predict alternative transcripts based on the alternatives the hints suggest. This can be any form of alternative splicing, including nested genes contained in introns of other genes, overlapping genes, alternative translation starts and variation in UTR.</p><h1 id="PREDICTIONS-USING-CDNA"><a href="#PREDICTIONS-USING-CDNA" class="headerlink" title="PREDICTIONS USING CDNA"></a>PREDICTIONS USING CDNA</h1><p>Improving the predictions by integrating ESTs or mRNA data is fairly simple. Let cdna.fa be a fasta file with ESTs and&#x2F;or mRNAs. Here is the list of commands that will do the trick:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">blat -minIdentity=<span class="hljs-number">92</span> genome<span class="hljs-selector-class">.fa</span> cdna<span class="hljs-selector-class">.fa</span> cdna<span class="hljs-selector-class">.psl</span><br>blat2hints<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--in</span>=cdna<span class="hljs-selector-class">.psl</span> <span class="hljs-attr">--out</span>=hints<span class="hljs-selector-class">.E</span><span class="hljs-selector-class">.gff</span><br>augustus <span class="hljs-attr">--species</span>=human <span class="hljs-attr">--hintsfile</span>=hints<span class="hljs-selector-class">.E</span><span class="hljs-selector-class">.gff</span> <span class="hljs-attr">--extrinsicCfgFile</span>=extrinsic<span class="hljs-selector-class">.ME</span><span class="hljs-selector-class">.cfg</span> genome.fa<br></code></pre></td></tr></table></figure><h2 id="Explanation-and-possible-improvements"><a href="#Explanation-and-possible-improvements" class="headerlink" title="Explanation and possible improvements"></a>Explanation and possible improvements</h2><p>BLAT is a fast spliced alignment program from Jim Kent. blat2hints.pl is a script from the AUGUSTUS scripts directory. The file extrinsic.ME.cfg states the parameters for the inclusion of the hints. You can manually adjust the few parameters for your genome. I recommend adjusting the bonuses and maluses in extrinsic.ME.cfg after a visual inspection of the predictions. For example, if it looks as if AUGUSTUS is trying to fit too many spurious EST alignments then reduce the bonuses. From experience, some ESTs often align to very many places in the genome. Most of those matches do not correspond to real protein coding gene structures. It is therefore better to add another step after the BLAT run. The command</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">pslCDnaFilter <span class="hljs-attribute">-maxAligns</span>=1 cdna.psl cdna.f.psl<br></code></pre></td></tr></table></figure><p>will filter the cDNA alignments and report only the highest-scoring spliced alignment(s) for each cDNA. Then use the filtered file cdna.f.psl to create hints. The program pslCDnaFilter is part of the Kent source tree (but not in the BLAT distribution).</p><p>For RNA-Seq integration please refer to the documentation in doc&#x2F;readme.rnaseq.html.</p><h1 id="AUGUSTUS-PPX-PREDICTIONS-USING-PROTEIN-PROFILES"><a href="#AUGUSTUS-PPX-PREDICTIONS-USING-PROTEIN-PROFILES" class="headerlink" title="AUGUSTUS-PPX: PREDICTIONS USING PROTEIN PROFILES"></a>AUGUSTUS-PPX: PREDICTIONS USING PROTEIN PROFILES</h1><p>AUGUSTUS can make its prediction based on a protein profile that can be generated from a Multiple Sequence Alignment. The protein profile is passed to AUGUSTUS by specifying the parameter â€“proteinprofile as in the following example:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">msa2prfl<span class="hljs-selector-class">.pl</span> fam<span class="hljs-selector-class">.aln</span> &gt; fam<span class="hljs-selector-class">.prfl</span> <br>augustus <span class="hljs-attr">--proteinprofile</span> fam<span class="hljs-selector-class">.prfl</span> genome.fa<br></code></pre></td></tr></table></figure><p>The profile consists of a set of position-specific frequency matrices that model conserved regions in a MSA, without deletions or insertions. When equipped with a profile, AUGUSTUS will make extra effort to predict genes that are similar to the profile, for example members of a specific protein family of interest. Prediction accuracy for these genes is generally enhanced by the extra information from the protein model, while other genes are predicted identically to the ab-initio version.</p><h2 id="Creating-protein-profiles-from-Multiple-Sequence-Alignments"><a href="#Creating-protein-profiles-from-Multiple-Sequence-Alignments" class="headerlink" title="Creating protein profiles from Multiple Sequence Alignments"></a>Creating protein profiles from Multiple Sequence Alignments</h2><p>The script msa2prfl.pl converts a Multiple Sequence Alignment given in FASTA or CLUSTAL format to a protein profile, by computing frequencies from all blocks of at least 6 gapless columns in the alignment. Minimal block width can be changed with the parameter â€“width. The script blocks2prfl.pl converts a flat file from the BLOCKS database to a protein profile</p><h2 id="Preparing-Core-Alignments"><a href="#Preparing-Core-Alignments" class="headerlink" title="Preparing Core Alignments"></a>Preparing Core Alignments</h2><p>Large alignments may not be represented by a block profile, if they do not have sufficiently many gapless columns. It is then recommended to cluster the sequences according to similarity, or to discard sequences from the alignment that do not cover most of the blocks. The program prepareAlign can do that with an MSA in FASTA format. Usage:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">prepareAlign &lt; <span class="hljs-built_in">input</span>.fa &gt; <span class="hljs-built_in">output</span>.fa<br></code></pre></td></tr></table></figure><p>The environment variables PA_FULL_COL_WEIGHT, PA_SKIP_COL_WEIGHT, PA_MINSIZE, PA_MIN_COL_COUNT control the behaviour of the program. See the source file for details.</p><h2 id="Format-of-the-protein-profile-inputfile"><a href="#Format-of-the-protein-profile-inputfile" class="headerlink" title="Format of the protein profile inputfile"></a>Format of the protein profile inputfile</h2><p>A section â€œ[name]â€, followed by the name of the family. Alternating sections â€œ[dist]â€, and â€œ[block]â€; each â€œ[dist]â€ section contains a line with minimum and maximum distance between blocks. can be specified as â€œ*â€ to indicate unbounded distance.</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs processing">[<span class="hljs-built_in">dist</span>]<br>&lt;<span class="hljs-built_in">min</span>&gt; &lt;<span class="hljs-built_in">max</span>&gt;<br></code></pre></td></tr></table></figure><p>Each â€œ[block]â€ section contains a frequency matrix, one line in the section corresponding to a column in the alignment. Each line contains 21 tab-separated values, the first is the column index in the block (0,1,2,â€¦), the other 20 values are the frequencies (adding up to 1), given in the order G,D,E,R,K,N,Q,S,T,A,V,L,I,F,Y,W,H,M,C,P</p><p>Example protein profiles are in the directory examples&#x2F;profile&#x2F;</p><h2 id="Running-AUGUSTUS-PPX"><a href="#Running-AUGUSTUS-PPX" class="headerlink" title="Running AUGUSTUS-PPX"></a>Running AUGUSTUS-PPX</h2><p>The running time of AUGUSTUS-PPX is proportional to the size of the profile; as a rule of thumb, the factor compared to AUGUSTUS is approximately the number of blocks in the profile. For large profiles, it is recommended to restrict the prediction with â€“predictionStart and â€“predictionEnd. On standard intel machines, running times of about one hour for a large profile on a region of 1 Mbps size, were observed. To determine regions where a profile is relevant, run a fastBlockSearch (see below). Important parameters for running AUGUSTUS-PPX are:</p><ul><li>&#x2F;ProteinModel&#x2F;allow_truncated: Enables having profile hits in right-truncated genes (default: yes)</li><li>&#x2F;ProteinModel&#x2F;block_threshold_spec: Control the specificity (default: spec&#x3D;4.0)</li><li>&#x2F;ProteinModel&#x2F;block_threshold_sens: Control the sensitivity when determining block hits (default: sens&#x3D;0.4)</li></ul><p>Increasing â€¦_sens and decreasing â€¦_spec will both result in more block hits found (and possibly more genes with profile hits), at the expense of more false positive hits. When the requirements cannot be both met, a block is discarded from the profile used for the prediction. Specificity and Sensitivity are given in units of standard deviation from the expected block score (Percentages can be calculated by applying the Gaussian distribution function; e.g., the default value of 2.5 corresponds to an estimated specificity of 99.3%: 7 FP hits in 1000bps). Note that filtering block hits is mainly a performance issue, and it is very unlikely that a false positive block hit affects the prediction if its score is low. To prevent blocks from being discarded from the profile, decrease either of the parameters.</p><ul><li>&#x2F;ProteinModel&#x2F;blockpart_threshold_spec: specificity for block prefixes or suffixes (4.5)</li><li>&#x2F;ProteinModel&#x2F;blockpart_threshold_sens: sensitivity for block prefixes or suffixes (2.0)</li></ul><p>The same for the case that a block is disconnected by an intron.</p><ul><li>&#x2F;ProteinModel&#x2F;weight:influence of the protein model to the combined score, can be weighted (default: 1, equal contribution) A higher value will result in more gene structures closer the protein model if there are.</li></ul><h2 id="Output-of-AUGUSTUS-PPX"><a href="#Output-of-AUGUSTUS-PPX" class="headerlink" title="Output of AUGUSTUS-PPX"></a>Output of AUGUSTUS-PPX</h2><p>If a gene is a profile hit, the following lines are added to the gff output:</p><ul><li>a protein_match feature for every block mapped to the DNA (or block part, if the block was disconnected by an intron). If â€“gff3&#x3D;on is specified, then target block and protein location are given in the attributes column:</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">chr1</span>    AUGUSTUS        protein_match   <span class="hljs-number">161494506</span>       <span class="hljs-number">161494595</span>       <span class="hljs-number">7</span>.<span class="hljs-number">54</span>    +       <span class="hljs-number">0</span>       ID=pp.g2.t1.PF00012.<span class="hljs-number">13</span>_A;Target=PF00012.<span class="hljs-number">13</span>_A <span class="hljs-number">1</span> <span class="hljs-number">30</span>;Target_start=<span class="hljs-number">19</span>;<br></code></pre></td></tr></table></figure><ul><li>a interblock_region feature for every exon part in the gene that is not mapped to a block</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">chr1</span>    AUGUSTUS        interblock_region       <span class="hljs-number">161494449</span>       <span class="hljs-number">161494505</span>       .       +       <span class="hljs-number">0</span>       ID=pp.g2.t1.iBR0<br></code></pre></td></tr></table></figure><ul><li>each translated protein sequence of a block match, as a comment (if â€“protein&#x3D;on is specified)</li></ul><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fortran"># <span class="hljs-keyword">sequence</span> of <span class="hljs-keyword">block</span> PF00012<span class="hljs-number">.13_A</span>   <span class="hljs-number">19</span> [VGVFQQGRVEILANDQGNRTTPSYVAFTDT] <span class="hljs-number">49</span><br></code></pre></td></tr></table></figure><h2 id="Fast-block-search-to-determine-regions-for-the-gene-prediction"><a href="#Fast-block-search-to-determine-regions-for-the-gene-prediction" class="headerlink" title="Fast block search to determine regions for the gene prediction"></a>Fast block search to determine regions for the gene prediction</h2><p>If a protein profile and a genome are given, a preliminary search can be performed with the program fastBlockSearch. It will output the locations of profile hits. An AUGUSTUS-PPX run can then be restricted to regions containing these locations. It should be run with the same parameters as the AUGUSTUS-PPX run. In addition, a threshold can be specified with the parameter â€“cutoff that controls the number of profile hits shown.</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">fastBlockSearch</span> --cutoff=<span class="hljs-number">0</span>.<span class="hljs-number">5</span> genome.fa fam.prfl<br></code></pre></td></tr></table></figure><p>The profile hits found by the fastBlockSearch may not contain always all blocks. In this case, it may improve the prediction to modify the profile with the following command</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">del_from_prfl</span>.pl fam.prfl <span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span><br></code></pre></td></tr></table></figure><p>where 2,3,5 is to be replaced with the list of blocks to be deleted from the profile.</p><h1 id="RETRAINING-AUGUSTUS"><a href="#RETRAINING-AUGUSTUS" class="headerlink" title="RETRAINING AUGUSTUS"></a>RETRAINING AUGUSTUS</h1><p>Please see the file README.autoAug for documentation for the automatic training script autoAug.pl. See also the file retraining.html. Here is some background:</p><p>AUGUSTUS uses parameters which are species specific like the Markov chain transition probability of coding and non-coding regions. These parameters can be trained on training sets of annotated genes in genbank format. They are stored in the config directory in 3 files containing the parameters for the exon-related, intron-related and intergenic-region-related parameters, e.g. human_exon_probs.pbl, human_intron_probs.pbl, human_igenic_probs.pbl. For each species there are also parameters like the order of the markov chain or the size of the window used for the splice site models. Letâ€™s call these meta parameters. These meta parameters are stored in a separate file, e.g. human_parameters.cfg. Which meta parameters work best depends on the species and on the training set, in particular on the size of the training set. Using the meta parameters of another species or for another training set is likely to result in poor prediction performance. The meta parameters are not documented sufficiently. However, when optimizing the meta parameters for a new species it helps to know their meaning. Please contact me in case you want me to do the training. The program â€˜etrainingâ€™ reads the meta parameters from the .cfg file and a genbank file with annotated genes and writes the other species specific parameters into the 3 .pbl files.</p><p>usage:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">etraining <span class="hljs-attribute">--species</span>=SPECIES trainfilename<br></code></pre></td></tr></table></figure><p>â€˜trainfilenameâ€™ is the filename (including relative path) to the file in genbank format containing the training sequences. These can be multi-gene sequences and genes on the reverse strand. However, the genes must not overlap.</p><h1 id="MEA-USING-THE-MAXIMUM-EXPECTED-ACCURACY-APPROACH"><a href="#MEA-USING-THE-MAXIMUM-EXPECTED-ACCURACY-APPROACH" class="headerlink" title="MEA: USING THE MAXIMUM EXPECTED ACCURACY APPROACH"></a>MEA: USING THE MAXIMUM EXPECTED ACCURACY APPROACH</h1><p>MEA is an alternative decoding approach and is described in the Poster found in <a href="https://github.com/Gaius-Augustus/Augustus/blob/master/docs/MEAposter.pdf">MEAposter.pdf</a>. For predictions using MEA the corresponding AUGUSTUS parameter has to be turned on: â€“mea&#x3D;1</p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>annotation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€FuncAnnoã€‘ã€InterProScanã€‘</title>
    <link href="/GeekFocus/2022/06/05/2022-06-05-FuncAnno-InterPro/"/>
    <url>/GeekFocus/2022/06/05/2022-06-05-FuncAnno-InterPro/</url>
    
    <content type="html"><![CDATA[<h1 id="é‰´å®šè›‹ç™½è´¨ç»“æ„åŸŸä¿å®ˆä½ç‚¹ï¼Œå¹¶è¿›è¡Œå®¶æ—åˆ†ç±»"><a href="#é‰´å®šè›‹ç™½è´¨ç»“æ„åŸŸä¿å®ˆä½ç‚¹ï¼Œå¹¶è¿›è¡Œå®¶æ—åˆ†ç±»" class="headerlink" title="é‰´å®šè›‹ç™½è´¨ç»“æ„åŸŸä¿å®ˆä½ç‚¹ï¼Œå¹¶è¿›è¡Œå®¶æ—åˆ†ç±»"></a>é‰´å®šè›‹ç™½è´¨ç»“æ„åŸŸä¿å®ˆä½ç‚¹ï¼Œå¹¶è¿›è¡Œå®¶æ—åˆ†ç±»</h1><span id="more"></span><p><a href="https://interproscan-docs.readthedocs.io/en/latest/HowToRun.html">https://interproscan-docs.readthedocs.io/en/latest/HowToRun.html</a></p><p><a href="https://www.jianshu.com/p/9d832ea9904f">https://www.jianshu.com/p/9d832ea9904f</a></p><p><a href="https://sr-c.github.io/2018/09/13/interproscan-config/">https://sr-c.github.io/2018/09/13/interproscan-config/</a></p><h2 id="0-ä»‹ç»"><a href="#0-ä»‹ç»" class="headerlink" title="0. ä»‹ç»"></a>0. ä»‹ç»</h2><p>ä¸»è¦åŠŸèƒ½ï¼š</p><ol><li>é¢„æµ‹è›‹ç™½è´¨çš„ç»“æ„åŸŸå’ŒåŠŸèƒ½ä½ç‚¹</li><li>æ ¹æ®è›‹ç™½è´¨å«æœ‰çš„ç»“æ„åŸŸå’Œç‰¹æ®Šä½ç‚¹è¿›è¡Œåˆ†ç±»</li></ol><p>é»˜è®¤åŒ…å«æ‰€æœ‰çš„æ•°æ®åº“ï¼Œ<font color="blue">ç»“æ„åŸŸï¼Œç‰¹å¾åºåˆ—ï¼Œå’Œä¿¡å·è‚½</font>ï¼Œå¯ä»¥é€‰æ‹©éƒ¨åˆ†æ•°æ®åº“</p><h3 id="Familys-domains-sites-amp-repeats"><a href="#Familys-domains-sites-amp-repeats" class="headerlink" title="Familys, domains, sites &amp; repeats"></a>Familys, domains, sites &amp; repeats</h3><p>TIGRFAMS</p><p>SFLD</p><p>PANTHER</p><p>HAMAP</p><p>PROSITE profiles?fail</p><p>PROSITE patterns?</p><p>SMART</p><p>CDD</p><p>PRINTS</p><p>Pfam</p><p>PIRSF</p><h3 id="Structual-domains"><a href="#Structual-domains" class="headerlink" title="Structual domains"></a>Structual domains</h3><p>SUPERFAMILY</p><p>Gene3D</p><h3 id="Other-sequence-features"><a href="#Other-sequence-features" class="headerlink" title="Other sequence features"></a>Other sequence features</h3><p>SignalP</p><p>Coils</p><p>TMHMM</p><p>MobiDBLite</p><p>Phobius</p><h3 id="other-category"><a href="#other-category" class="headerlink" title="other category"></a>other category</h3><p>SIngnalP_EUK; Signal_GRAM_POSITIVE; </p><h3 id="å•ç‹¬é…ç½®åˆ†æ"><a href="#å•ç‹¬é…ç½®åˆ†æ" class="headerlink" title="å•ç‹¬é…ç½®åˆ†æ"></a>å•ç‹¬é…ç½®åˆ†æ</h3><p>åˆ†æä¿¡å·è‚½ï¼ŒçœŸæ ¸ï¼ŒGram+ç»†èŒï¼ŒGram-ç»†èŒï¼Œè·¨è†œç»“æ„ï¼Œè¿™éƒ¨åˆ†è½¯ä»¶éœ€è¦è‡ªè¡Œé…ç½®</p><p>SignalP, TMHMM, ä¸¥æ ¼æŒ‰ç…§ç‰ˆæœ¬ï¼Œ deactivated æç¤º</p><h2 id="1-ä¸‹è½½å®‰è£…"><a href="#1-ä¸‹è½½å®‰è£…" class="headerlink" title="1. ä¸‹è½½å®‰è£…"></a>1. ä¸‹è½½å®‰è£…</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># æ­¤å¤„ä¸ºæœ€æ–°ç‰ˆæœ¬5.52-86.0ï¼Œ64ä½ï¼Œä¸‹è½½MD5æ–‡ä»¶ç”¨æ¥æ£€éªŒä¸‹è½½çš„å®Œæ•´æ€§</span><br>wget https://ftp.ebi.ac.uk/pub/software/unix/iprscan/5/5.52-86.0/interproscan-5.52-86.0-64-bit.tar.gz<br>wget https://ftp.ebi.ac.uk/pub/software/unix/iprscan/5/5.52-86.0/interproscan-5.52-86.0-64-bit.tar.gz.md5<br><span class="hljs-built_in">md5sum</span> -c interproscan-5.52-86.0-64-bit.tar.gz.md5<br><span class="hljs-comment"># è¿”å›okåˆ™è¯´æ˜ä¸‹è½½å®Œæ•´</span><br>tar -pxvzf interproscan-5.52-86.0-*-bit.tar.gz<br><br><span class="hljs-comment">###Latest version 5.56-89.0</span><br>https://github.com/ebi-pf-team/interproscan/releases<br>interproscan-5.56-89.0 Latest<br>release: interproscan-5.56-89.0<br>md5: f3288327a6c7be1ff42220c3b7a1de43<br>cpu: 64 bit<br>os: Linux<br>size: 7.5GB compressed<br><br>https://ftp.ebi.ac.uk/pub/software/unix/iprscan/5/5.56-89.0/interproscan-5.56-89.0-64-bit.tar.gz<br>https://ftp.ebi.ac.uk/pub/software/unix/iprscan/5/5.56-89.0/interproscan-5.56-89.0-64-bit.tar.gz.md5<br><span class="hljs-built_in">md5sum</span> -c interproscan-5.56-89.0-64-bit.tar.gz.md5<br>interproscan-5.56-89.0-64-bit.tar.gz: OK<br><span class="hljs-comment">#è§£å‹</span><br>tar -pxvzf interproscan-5.56-89.0-64-bit.tar.gz<br><br><span class="hljs-comment"># è§£å‹å®Œåï¼Œè¿›å…¥ç›®å½•ï¼ŒæŸ¥çœ‹æ˜¯å¦å®‰è£…å®Œå¥½ï¼Œè‹¥æœ‰ç”¨æ³•è¯´æ˜å¼¹å‡ºåˆ™è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚</span><br>./interproscan.sh<br><br>Java version 11 is required to run InterProScan.<br>download jdk-11.0.15.1[https://www.oracle.com/java/technologies/downloads/<span class="hljs-comment">#java11]</span><br>jdk-11.0.15.1_linux-x64_bin.tar.gz<br><br><span class="hljs-comment">#export JAVA_HOME=/usr/local/jdk-11.0.8</span><br><span class="hljs-comment">#export CLASSPATH=.:$JAVA_HOME/jre/lib:$JAVA_HOME/lib:$JAVA_HOME/lib/tools.jar</span><br><span class="hljs-comment">#export PATH=$PATH:$JAVA_HOME/bin:$JAVA_HOME/jre/bin</span><br><br><span class="hljs-built_in">export</span> JAVA_HOME=/path/jdk-11.0.15.1<br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$JAVA_HOME</span>/bin<br>failedï¼Œstill /usr/bin/java<br>vi ./interproscan.sh<br><span class="hljs-comment"># old JAVA=$(type -p java)</span><br>JAVA=$(<span class="hljs-built_in">type</span> -p /path/jdk-11.0.15.1/bin/java)<br><span class="hljs-comment">#https://blog.csdn.net/weixin_43484846/article/details/121400487</span><br><span class="hljs-comment">#æ­¤blog ç”¨ln -s /path/jdk-11.0.15.1/bin/java  /usr/bin/java æœªå°è¯•æ­¤æ³•</span><br>./interproscan.sh <br>Checking any hmm models that need indexing ... this may take a few minutes<br>Working...    <span class="hljs-keyword">done</span>.<br>Pressed and indexed 263 HMMs (263 names and 263 accessions).<br>Models pressed into binary file:   data/antifam/7.0/AntiFam.hmm.h3m<br>SSI index <span class="hljs-keyword">for</span> binary model file:   data/antifam/7.0/AntiFam.hmm.h3i<br>Profiles (MSV part) pressed into:  data/antifam/7.0/AntiFam.hmm.h3f<br>Profiles (remainder) pressed into: data/antifam/7.0/AntiFam.hmm.h3p<br>Working...    <span class="hljs-keyword">done</span>.<br>Pressed and indexed 66720 HMMs (66720 names).<br>Models pressed into binary file:   data/gene3d/4.3.0/gene3d_main.hmm.h3m<br>SSI index <span class="hljs-keyword">for</span> binary model file:   data/gene3d/4.3.0/gene3d_main.hmm.h3i<br>Profiles (MSV part) pressed into:  data/gene3d/4.3.0/gene3d_main.hmm.h3f<br>Profiles (remainder) pressed into: data/gene3d/4.3.0/gene3d_main.hmm.h3p<br>Working...    <span class="hljs-keyword">done</span>.<br>Pressed and indexed 2383 HMMs (2383 names).<br>Models pressed into binary file:   data/hamap/2021_04/hamap.hmm.lib.h3m<br>SSI index <span class="hljs-keyword">for</span> binary model file:   data/hamap/2021_04/hamap.hmm.lib.h3i<br>Profiles (MSV part) pressed into:  data/hamap/2021_04/hamap.hmm.lib.h3f<br>Profiles (remainder) pressed into: data/hamap/2021_04/hamap.hmm.lib.h3p<br>Working...    <span class="hljs-keyword">done</span>.<br>Pressed and indexed 134000 HMMs (134000 names).<br>Models pressed into binary file:   data/panther/15.0/panther.hmm.h3m<br>SSI index <span class="hljs-keyword">for</span> binary model file:   data/panther/15.0/panther.hmm.h3i<br>Profiles (MSV part) pressed into:  data/panther/15.0/panther.hmm.h3f<br>Profiles (remainder) pressed into: data/panther/15.0/panther.hmm.h3p<br>Working...    <span class="hljs-keyword">done</span>.<br>Pressed and indexed 19179 HMMs (19179 names and 19179 accessions).<br>Models pressed into binary file:   data/pfam/34.0/pfam_a.hmm.h3m<br>SSI index <span class="hljs-keyword">for</span> binary model file:   data/pfam/34.0/pfam_a.hmm.h3i<br>Profiles (MSV part) pressed into:  data/pfam/34.0/pfam_a.hmm.h3f<br>Profiles (remainder) pressed into: data/pfam/34.0/pfam_a.hmm.h3p<br>Working...    <span class="hljs-keyword">done</span>.<br>Pressed and indexed 3283 HMMs (3283 names and 3283 accessions).<br>Models pressed into binary file:   data/pirsf/3.10/sf_hmm_all.h3m<br>SSI index <span class="hljs-keyword">for</span> binary model file:   data/pirsf/3.10/sf_hmm_all.h3i<br>Profiles (MSV part) pressed into:  data/pirsf/3.10/sf_hmm_all.h3f<br>Profiles (remainder) pressed into: data/pirsf/3.10/sf_hmm_all.h3p<br>Working...    <span class="hljs-keyword">done</span>.<br>Pressed and indexed 1510 HMMs (1510 names and 1510 accessions).<br>Models pressed into binary file:   data/pirsr/2021_05/sr_hmm_all.h3m<br>SSI index <span class="hljs-keyword">for</span> binary model file:   data/pirsr/2021_05/sr_hmm_all.h3i<br>Profiles (MSV part) pressed into:  data/pirsr/2021_05/sr_hmm_all.h3f<br>Profiles (remainder) pressed into: data/pirsr/2021_05/sr_hmm_all.h3p<br>Working...    <span class="hljs-keyword">done</span>.<br>Pressed and indexed 299 HMMs (299 names and 299 accessions).<br>Models pressed into binary file:   data/sfld/4/sfld.hmm.h3m<br>SSI index <span class="hljs-keyword">for</span> binary model file:   data/sfld/4/sfld.hmm.h3i<br>Profiles (MSV part) pressed into:  data/sfld/4/sfld.hmm.h3f<br>Profiles (remainder) pressed into: data/sfld/4/sfld.hmm.h3p<br>Working...    <span class="hljs-keyword">done</span>.<br>Pressed and indexed 15438 HMMs (15438 names and 15438 accessions).<br>Models pressed into binary file:   data/superfamily/1.75/hmmlib_1.75.h3m<br>SSI index <span class="hljs-keyword">for</span> binary model file:   data/superfamily/1.75/hmmlib_1.75.h3i<br>Profiles (MSV part) pressed into:  data/superfamily/1.75/hmmlib_1.75.h3f<br>Profiles (remainder) pressed into: data/superfamily/1.75/hmmlib_1.75.h3p<br>Working...    <span class="hljs-keyword">done</span>.<br>Pressed and indexed 4488 HMMs (4488 names and 4488 accessions).<br>Models pressed into binary file:   data/tigrfam/15.0/TIGRFAMs_HMM.LIB.h3m<br>SSI index <span class="hljs-keyword">for</span> binary model file:   data/tigrfam/15.0/TIGRFAMs_HMM.LIB.h3i<br>Profiles (MSV part) pressed into:  data/tigrfam/15.0/TIGRFAMs_HMM.LIB.h3f<br>Profiles (remainder) pressed into: data/tigrfam/15.0/TIGRFAMs_HMM.LIB.h3p<br>Completed indexing the hmm models.<br>30/05/2022 22:41:20:513 Welcome to InterProScan-5.56-89.0<br>30/05/2022 22:41:20:516 Running InterProScan v5 <span class="hljs-keyword">in</span> STANDALONE mode... on Linux<br>usage: java -XX:+UseParallelGC -XX:ParallelGCThreads=2 -XX:+AggressiveOpts -XX:+UseFastAccessorMethods -Xms128M<br>            -Xmx2048M -jar interproscan-5.jar<br><br><span class="hljs-comment"># è¿›è¡Œåˆå§‹åŒ–ï¼Œæ­¤å‘½ä»¤å¤§è‡´æ˜¯å‡†å¤‡å¥½HMMæ¨¡å‹ä»¥ä¾›hmmscanä½¿ç”¨</span><br>python3 initial_setup.py<br><span class="hljs-comment"># no fat local</span><br>python3 initial_setup.py<br></code></pre></td></tr></table></figure><h2 id="2-æµ‹è¯•ä¸å‚æ•°"><a href="#2-æµ‹è¯•ä¸å‚æ•°" class="headerlink" title="2. æµ‹è¯•ä¸å‚æ•°"></a>2. æµ‹è¯•ä¸å‚æ•°</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">./interproscan.sh<br><span class="hljs-comment"># çŸ­æš‚ç­‰å¾…åï¼Œå³ä¼šè¾“å‡ºå¸®åŠ©ä¿¡æ¯</span><br>30/05/2022 22:44:40:746 Welcome to InterProScan-5.56-89.0<br>30/05/2022 22:44:40:747 Running InterProScan v5 <span class="hljs-keyword">in</span> STANDALONE mode... on Linux<br>usage: java -XX:+UseParallelGC -XX:ParallelGCThreads=2 -XX:+AggressiveOpts -XX:+UseFastAccessorMethods -Xms128M<br>            -Xmx2048M -jar interproscan-5.jar<br><br><span class="hljs-comment">#å®Œæˆä¸Šé¢çš„æ­¥éª¤åï¼Œå³å¯è¿›è¡Œæµ‹è¯•ï¼ˆä»¥ä¸‹ä¸¤æ¡å‘½ä»¤é€‰ä¸€å³å¯ï¼‰</span><br><span class="hljs-comment"># ç¨‹åºä¸è”ç½‘ï¼Œä½¿ç”¨æœ¬åœ°çš„Lookup Service</span><br>./interproscan.sh -i test_all_appl.fasta -f tsv -dp<br><span class="hljs-comment"># ä½¿ç”¨ç¨‹åºè‡ªå¸¦çš„æµ‹è¯•æ•°æ®è¿›è¡Œæµ‹è¯•</span><br>./interproscan.sh -i test_all_appl.fasta -f tsv<br>    <span class="hljs-comment"># -dpå‚æ•°çš„å«ä¹‰ï¼šå«æœ‰-dpåˆ™æ˜¯å…³é—­äº†è¿æ¥EBIè”ç½‘æœç´¢çš„æƒé™è€Œä½¿ç”¨æœ¬åœ°åŒ–æœç´¢ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯æ”¯æŒEBIè”ç½‘æœç´¢ï¼Œè‹¥åªéœ€æœ¬åœ°åˆ™ä½¿ç”¨-dpã€‚ï¼ˆå¯èƒ½ä¸æ­£ç¡®ï¼‰</span><br>    -dp,--disable-precalc Optional.  Disables use of the precalculated match lookup service.  All match calculations will be run locally.<br></code></pre></td></tr></table></figure><ul><li>-appl &#x2F; -applications æœç´¢åº”ç”¨çš„åå­—(å¯é€‰)<ul><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿è¡Œæ‰€æœ‰çš„åˆ†æï¼Œä¹Ÿå¯ä»¥è‡ªå·±æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªã€‚</li></ul></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æŒ‡å®špfamæœç´¢</span><br>./interproscan.sh -appl Pfam -i /path/to/sequences.fasta<br><span class="hljs-comment">#åŒæ—¶æŒ‡å®šå¤šä¸ªè¿›è¡Œæœç´¢</span><br>./interproscan.sh -appl CDD,COILS,Gene3D,HAMAP,MobiDBLite,PANTHER,Pfam,PIRSF,PRINTS,PROSITEPATTERNS,PROSITEPROFILES,SFLD,SMART,SUPERFAMILY,TIGRFAM -i /path/to/sequences.fasta<br></code></pre></td></tr></table></figure><ul><li>-i &#x2F;-fasta åºåˆ—æ–‡ä»¶<ul><li>è¾“å…¥çš„æ˜¯è›‹ç™½æˆ–è€…æ ¸é…¸çš„fastaæ–‡ä»¶ï¼Œå°†ä¼šè¿”å›TSV,XML,Gff3ä¸‰ä¸ªè¾“å‡ºç»“æœ</li></ul></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">./interproscan.sh -i /path/to/sequences.fasta<br><span class="hljs-comment"># è¾“å‡ºç»“æœä¸ºsequences.tsv, sequence.xml, sequences.gff3</span><br></code></pre></td></tr></table></figure><ul><li>-t &#x2F; åºåˆ—ç±»å‹<ul><li>é»˜è®¤æ˜¯è›‹ç™½åºåˆ—ï¼Œè‹¥ä¸ºæ ¸è‹·é…¸åºåˆ—ï¼Œåˆ™éœ€è¦åŠ ä¸Šæ­¤å‚æ•°</li></ul></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">./interproscan.sh -t n -i /path/to/sequences.fasta<br></code></pre></td></tr></table></figure><p>å…¶ä»–å‚æ•°</p><h2 id="3-åŒ…å«åˆ†æ"><a href="#3-åŒ…å«åˆ†æ" class="headerlink" title="3. åŒ…å«åˆ†æ"></a>3. åŒ…å«åˆ†æ</h2><blockquote><ul><li>CDD</li><li>COLIS</li><li>Gene3D</li><li>HAMAP</li><li>MOBIDB</li><li>PANTHER</li><li>Pfam</li><li>PIRSF</li><li>SMART</li><li>â€¦</li></ul></blockquote><h2 id="4-çº¿ç¨‹"><a href="#4-çº¿ç¨‹" class="headerlink" title="4. çº¿ç¨‹"></a>4. çº¿ç¨‹</h2><p>åœ¨å•æœºè¿è¡ŒInterProScanæ—¶ï¼Œå¯åœ¨é…ç½®æ–‡ä»¶<code>interproscan.properties</code>ä¸­è®¾ç½®çº¿ç¨‹ï¼Œå…¶é»˜è®¤è®¾ç½®å¦‚ä¸‹</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># Set the number of embedded workers to the number of processors that you would like to employ</span><br><span class="hljs-comment"># on the machine you are using to run InterProScan.</span><br><span class="hljs-comment">#number of embedded workers  a master process can have</span><br>number.of.embedded.workers=6<br>maxnumber.of.embedded.workers=8<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#å¯¹äºä¸€ä¸ª40æ ¸çš„æœºå™¨ï¼Œæ¨èçš„è®¾ç½®å¦‚ä¸‹</span><br><span class="hljs-comment">#Number of embedded workers at start time</span><br>number.of.embedded.workers=1<br><span class="hljs-comment">#Maximum number of embedded workers</span><br>maxnumber.of.embedded.workers=35<br></code></pre></td></tr></table></figure><p>æ¨èå•æ¬¡è¾“å…¥è›‹ç™½åºåˆ—10000æ¡ï¼Œæ ¸é…¸åºåˆ—1000æ¡ã€‚è‹¥è¾“å…¥æ•°æ®è¿‡å¤šï¼Œå»ºè®®å°†å…¶åˆ†ç»„è¿è¡Œã€‚</p><p>ä½¿ç”¨<code>-appl</code>å‚æ•°è®¾ç½®æ¯”å¯¹çš„é¡¹ç›®ï¼Œå‡å°‘ç¨‹åºè€—æ—¶</p><p>è¿›è¡Œæ¯”å¯¹çš„è›‹ç™½åºåˆ—ä¸­ä¸åº”å«æœ‰æ˜Ÿå·ï¼Œå¦åˆ™å°†æœ‰å¦‚ä¸‹æŠ¥é”™ã€‚å°†åºåˆ—ä¸­çš„æ˜Ÿå·åˆ é™¤å³å¯ã€‚</p><p>InterProScanè‡ªå¸¦çš„blast+ä¸­rpsblastçš„ç¼–è¯‘ç¯å¢ƒä¸æœ¬æœºç¯å¢ƒä¸åŒã€‚é€šè¿‡æ›¿æ¢è¿™æ”¯ç¨‹åºæ¥è§£å†³ã€‚ä¸‹è½½ncbiæä¾›çš„å·²ç¼–è¯‘ç‰ˆæœ¬ï¼Œä½¿ç”¨å…¶ä¸­çš„rpsblastæ›¿æ¢InterProScanè‡ªå¸¦çš„rpsblastå³å¯ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># backup original version</span><br><span class="hljs-built_in">cp</span> bin/blast/ncbi-blast-2.6.0+/rpsblast bin/blast/ncbi-blast-2.6.0+/rpsblast.bak<br><br><span class="hljs-comment"># copy the new version to the binary folder</span><br><span class="hljs-built_in">cp</span> ncbi-blast-2.6.0+/bin/rpsblast bin/blast/ncbi-blast-2.6.0+/rpsblast<br></code></pre></td></tr></table></figure><h2 id="5-è¿è¡Œ"><a href="#5-è¿è¡Œ" class="headerlink" title="5. è¿è¡Œ"></a>5. è¿è¡Œ</h2><p>ä¸€æ¬¡è¿è¡ŒåŒæ—¶å®ç°å¤šä¸ªä¿¡æ¯æ³¨é‡Š</p><ul><li>InterProæ³¨é‡Š</li><li>Pfamæ•°æ®åº“æ³¨é‡Š(å¯ä»¥é€šè¿‡hmmscanæœç´¢pfamæ•°æ®åº“å®Œæˆ)</li><li>GOæ³¨é‡Š(å¯ä»¥åŸºäºNRå’ŒPfamç­‰æ•°æ®åº“ï¼Œç„¶åBLAST2GOå®Œæˆ,)</li><li>Reactomeé€šè·¯æ³¨é‡Šï¼Œä¸åŒäºKEGG</li></ul><p>å‘½ä»¤å¦‚ä¸‹</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">./interproscan-<span class="hljs-number">5.29</span>-<span class="hljs-number">68.0</span>/interproscan<span class="hljs-selector-class">.sh</span> -appl Pfam  -f TSV -<span class="hljs-selector-tag">i</span> sample<span class="hljs-selector-class">.fa</span> -cpu <span class="hljs-number">50</span> -<span class="hljs-selector-tag">b</span> sample -goterms -iprlookup -pa<br></code></pre></td></tr></table></figure><p><code>-appl</code>å‘Šè¯‰è½¯ä»¶è¦æ‰§è¡Œå“ªäº›æ•°æ®åˆ†æï¼Œå‹¾é€‰çš„è¶Šå¤šï¼Œåˆ†æé€Ÿåº¦è¶Šæ…¢ï¼ŒPfamå°±è¡Œã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><code class="hljs sh">software/interproscan-5.56-89.0/interproscan.sh<br>31/05/2022 11:39:27:267 Welcome to InterProScan-5.56-89.0<br>31/05/2022 11:39:27:269 Running InterProScan v5 <span class="hljs-keyword">in</span> STANDALONE mode... on Linux<br>usage: java -XX:+UseParallelGC -XX:ParallelGCThreads=2 -XX:+AggressiveOpts -XX:+UseFastAccessorMethods -Xms128M<br>            -Xmx2048M -jar interproscan-5.jar<br><br><br>Please give us your feedback by sending an email to<br><br>interhelp@ebi.ac.uk<br><br>-appl,--applications &lt;ANALYSES&gt;     Optional, <span class="hljs-string">&#x27;comma separated list&#x27;</span> of analyses.  Default: all available analysis<br><br>-b,--output-file-base &lt;OUTPUT-FILE-BASE&gt;     Optional, <span class="hljs-string">&#x27;base output filename&#x27;</span> (relative or absolute path). Note that this option, the --output-dir (-d) option and the --outfile (-o) option are mutually exclusive.  The appropriate file extension <span class="hljs-keyword">for</span> the output format(s) will be appended automatically. By default the input file path/name will be used.<br><br>-d,--output-dir &lt;OUTPUT-DIR&gt;     Optional, output directory.  Note that this option, the --outfile (-o) option and the --output-file-base (-b) option are mutually exclusive. The output filename(s) are the same as the input filename, with the appropriate file extension(s) <span class="hljs-keyword">for</span> the output format(s) appended automatically .<br><br>-o,--outfile &lt;EXPLICIT_OUTPUT_FILENAME&gt; Optional explicit output file name (relative or absolute path).  Note that this option, the --output-dir (-d) option and the --output-file-base (-b) option are mutually exclusive. If this option is given, you MUST specify a single output format using the -f option.  The output file name will not be modified. Note that specifying an output file name using this option OVERWRITES ANY EXISTING FILE.<br><br>-cpu,--cpu &lt;CPU&gt;     Optional, number of cores <span class="hljs-keyword">for</span> inteproscan.<br><br>-dp,--disable-precalc     Optional.  Disables use of the precalculated match lookup service.  All match calculations will be <span class="hljs-string">&#x27;run locally&#x27;</span>.<br><br>-dra,--disable-residue-annot     Optional, excludes sites from the XML, JSON output<br><br>-etra,--enable-tsv-residue-annot     Optional, includes sites <span class="hljs-keyword">in</span> TSV output<br><br>-exclappl,--excl-applications &lt;EXC-ANALYSES&gt;     Optional, comma separated list of <span class="hljs-string">&#x27;analyses you want to exclude&#x27;</span>.<br><br>-f,--formats &lt;OUTPUT-FORMATS&gt;     Optional, case-insensitive, comma separated <span class="hljs-string">&#x27;list of output formats&#x27;</span>. Supported formats are <span class="hljs-string">&#x27;TSV, XML, JSON, GFF3, HTML and SVG&#x27;</span>. <span class="hljs-string">&#x27;Default for protein sequences are TSV, XML and GFF3&#x27;</span>, or <span class="hljs-string">&#x27;for nucleotide sequences GFF3 and XML&#x27;</span>.<br><br>-iprlookup,--iprlookup     Also include <span class="hljs-string">&#x27;lookup of corresponding InterPro annotation in the TSV and GFF3 output formats&#x27;</span>.<br><br>-goterms,--goterms     Optional, <span class="hljs-string">&#x27;switch on lookup of corresponding Gene Ontology annotation (IMPLIES -iprlookup option)&#x27;</span><br><br>-pa,--pathways Optional, switch on <span class="hljs-string">&#x27;lookup of corresponding Pathway annotation (IMPLIES -iprlookup option)&#x27;</span><br><br>-<span class="hljs-built_in">help</span>,--<span class="hljs-built_in">help</span>     Optional, display <span class="hljs-built_in">help</span> information<br><br>-i,--input &lt;INPUT-FILE-PATH&gt;     Optional, path to fasta file that should be loaded on Master startup. Alternatively, <span class="hljs-keyword">in</span> CONVERT mode, the InterProScan 5 XML file to convert.<br><br>-incldepappl,--incl-dep-applications &lt;INC-DEP-ANALYSES&gt;   Optional, comma separated list of deprecated analyses that you want included.  If this option is not <span class="hljs-built_in">set</span>, deprecated analyses will not run.<br><br>-ms,--minsize &lt;MINIMUM-SIZE&gt;     Optional, <span class="hljs-string">&#x27;minimum nucleotide size of ORF to report[100aa?]&#x27;</span>. Will only be considered <span class="hljs-keyword">if</span> n is specified as a sequence <span class="hljs-built_in">type</span>. Please be aware of the fact that <span class="hljs-keyword">if</span> you specify a too short value it might be that the analysis takes a very long time!<br><br>-t,--seqtype &lt;SEQUENCE-TYPE&gt;     Optional, the <span class="hljs-built_in">type</span> of the input sequences (dna/rna (n) or protein (p)).  The <span class="hljs-string">&#x27;default sequence type is protein&#x27;</span>. Optional, specify temporary file directory (relative or absolute path). The <span class="hljs-string">&#x27;default location is temp/&#x27;</span>.<br><br>-verbose,--verbose Optional, display more â€˜verboseå†—é•¿â€™ <span class="hljs-built_in">log</span> output<br><br>-version,--version     Optional, display version number<br><br>-vl,--verbose-level &lt;VERBOSE-LEVEL&gt;     Optional, display <span class="hljs-string">&#x27;verbose log output at level specified&#x27;</span>.<br><br>-vtsv,--output-tsv-version     Optional, includes a TSV version file along with any TSV <br>output (when TSV output requested)<br><br>Copyright Â© EMBL European Bioinformatics Institute, Hinxton, Cambridge, UK. (http://www.ebi.ac.uk) The InterProScan software itself is provided under the Apache License, Version 2.0 (http://www.apache.org/licenses/LICENSE-2.0.html). Third party components (e.g. member database binaries and models) are subject to separate licensing - please see the individual member database websites <span class="hljs-keyword">for</span> details.<br><br><span class="hljs-string">&#x27;Available analyses&#x27;</span>:<br><span class="hljs-string">&#x27;TIGRFAM (15.0)&#x27;</span> : TIGRFAMs are <span class="hljs-string">&#x27;protein families&#x27;</span> based on <span class="hljs-string">&#x27;hidden Markov models (HMMs)&#x27;</span>.<br><br><span class="hljs-string">&#x27;SFLD (4)&#x27;</span> : SFLD is a database of <span class="hljs-string">&#x27;protein families&#x27;</span> based on <span class="hljs-string">&#x27;hidden Markov models (HMMs)&#x27;</span>.<br><br><span class="hljs-string">&#x27;âˆšSUPERFAMILY (1.75)&#x27;</span> : SUPERFAMILY is a database of <span class="hljs-string">&#x27;structural and functional annotations&#x27;</span> <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;all proteins and genomes&#x27;</span>.<br><br><span class="hljs-string">&#x27;âˆšPANTHER (15.0)&#x27;</span> : The PANTHER (<span class="hljs-string">&#x27;Protein ANalysis THrough Evolutionary Relationships&#x27;</span>) Classification System is a unique resource that <span class="hljs-string">&#x27;classifies genes by their functions, using published scientific experimental evidence and evolutionary relationships to predict function&#x27;</span> even <span class="hljs-keyword">in</span> the absence of direct experimental evidence.<br><br><span class="hljs-string">&#x27;âˆšGene3D (4.3.0)&#x27;</span> : <span class="hljs-string">&#x27;Structural assignment&#x27;</span> <span class="hljs-keyword">for</span> whole genes and genomes using the <span class="hljs-string">&#x27;CATH domain structure database&#x27;</span>.<br><br>Hamap (2021_04) : High-quality Automated and Manual Annotation of <span class="hljs-string">&#x27;Microbial Proteomes&#x27;</span>.<br><br>Coils (2.2.1) : Prediction of coiled coil regions? <span class="hljs-keyword">in</span> proteins.<br><br><span class="hljs-string">&#x27;ProSiteProfiles (2022_01)&#x27;</span>: PROSITE consists of documentation entries describing <span class="hljs-string">&#x27;protein domains, families and functional sites&#x27;</span> as well as <span class="hljs-string">&#x27;associated patterns and profiles&#x27;</span> to identify them.<br><br><span class="hljs-string">&#x27;âˆšSMART (7.1)&#x27;</span> : SMART allows the identification and analysis of <span class="hljs-string">&#x27;domain architectures&#x27;</span> based on <span class="hljs-string">&#x27;hidden Markov models&#x27;</span> (HMMs). <br><br><span class="hljs-string">&#x27;CDD (3.18)&#x27;</span> : CDD predicts protein <span class="hljs-string">&#x27;domains and families&#x27;</span> based on <span class="hljs-string">&#x27;a collection of well-annotated multiple sequence alignment models&#x27;</span>.<br><br><span class="hljs-string">&#x27;âˆšPRINTS (42.0)&#x27;</span> : A compendium of <span class="hljs-string">&#x27;protein fingerprints&#x27;</span> - a fingerprint is a group of <span class="hljs-string">&#x27;conserved motifs&#x27;</span> used to characterise a protein family.<br><br>PIRSR (2021_05) : PIRSR is a database of protein families based on hidden Markov models (HMMs) and Site Rules.<br><br>ProSitePatterns (2022_01) : PROSITE consists of documentation entries describing <span class="hljs-string">&#x27;protein domains, families and functional&#x27;</span> sites as well as associated patterns and profiles to identify them.<br><br>AntiFam (7.0) : AntiFam is a resource of profile-HMMs designed to identify spurious protein predictions.<br><br><span class="hljs-string">&#x27;âˆšPfam (34.0)&#x27;</span> : A <span class="hljs-string">&#x27;large collection of protein families&#x27;</span>, each represented by <span class="hljs-string">&#x27;multiple sequence alignments and hidden Markov models (HMMs)&#x27;</span>.<br><br>MobiDBLite (2.0) : Prediction of intrinsically disordered regions <span class="hljs-keyword">in</span> proteins.<br><br><span class="hljs-string">&#x27;PIRSF (3.10)&#x27;</span> : The PIRSF concept is used as a guiding principle to <span class="hljs-string">&#x27;provide comprehensive and non-overlapping clustering of UniProtKB sequences into a hierarchical order&#x27;</span> to reflect their evolutionary relationships.<br><br><span class="hljs-string">&#x27;Deactivated analyses&#x27;</span>:<br>SignalP_GRAM_NEGATIVE (4.1) : Analysis SignalP_GRAM_NEGATIVE is deactivated, because the resources expected at the following paths <span class="hljs-keyword">do</span> not exist: bin/signalp/4.1/signalp<br><br>TMHMM (2.0c) : Analysis TMHMM is deactivated, because the resources expected at the following paths <span class="hljs-keyword">do</span> not exist: bin/tmhmm/2.0c/decodeanhmm, data/tmhmm/2.0c/TMHMM2.0c.model<br><br>SignalP_EUK (4.1) : Analysis SignalP_EUK is deactivated, because the resources expected at the following paths <span class="hljs-keyword">do</span> not exist: bin/signalp/4.1/signalp<br><br>Phobius (1.01) : Analysis Phobius is deactivated, because the resources expected at the following paths <span class="hljs-keyword">do</span> not exist: bin/phobius/1.01/phobius.pl<br><br>SignalP_GRAM_POSITIVE (4.1) : Analysis SignalP_GRAM_POSITIVE is deactivated, because the resources expected at the following paths <span class="hljs-keyword">do</span> not exist: bin/signalp/4.1/signalp<br></code></pre></td></tr></table></figure><p>IF8-PlantBio æœé¹ƒå±å’Œæµ·å—å†€é¹ç§‘æ¤ç‰©ï¼š<strong>Pfam</strong>, <strong>PRINTS</strong>, <strong>SMART</strong>, ProDom and PROSITE</p><p>IF8-PlantBio å¸¸ç»¿æœé¹ƒåŸºå› ç»„ï¼šTIGRFAM, Phobius, SignalP, <strong>SUPERFAMILY</strong>, <strong>PANTHER</strong>, <strong>Gene3D</strong>, ProSite, Coils, <strong>PRINTS</strong>, <strong>SMART</strong>, <strong>Pfam</strong>, PIRSF, TMHMM and GO. </p><p>IF3.6-frontierInPlantSci ç‰›æ²¹æœæ ‘ï¼š<strong>PFAM</strong>, <strong>Gene3D</strong>, <strong>PANTHER</strong>, <strong>CDD</strong>, <strong>SUPERFAMILY</strong>, ProSite, and GO</p><p>IF3.4-GBE å¶è‰åŸºå› ç»„ï¼š<strong>Pfam</strong>,  <strong>Superfamily</strong> , <strong>Gene3D</strong>, <strong>SMART</strong>, <strong>CDD</strong></p><p>ProSiteProfiles, ProSitePatterns</p><p>-iprlookup,â€“iprlookup     Also include â€˜lookup of corresponding <strong>InterPro</strong> annotation in the TSV and GFF3 output formatsâ€™.</p><p>-goterms,â€“goterms     Optional, â€˜switch on lookup of corresponding <strong>Gene Ontology</strong> annotation (IMPLIES -iprlookup option)â€™</p><p>-pa,â€“pathways Optional, switch on â€˜lookup of corresponding <strong>Pathway</strong> annotation (IMPLIES -iprlookup option)â€™</p><p>-vl</p><p>Pfam,PRINTS,SMART,SUPERFAMILY,PANTHER,Gene3D,CDD,ProSiteProfiles?ProSitePatterns?</p><h2 id="ProSite-bug"><a href="#ProSite-bug" class="headerlink" title="ProSite-bug"></a>ProSite-bug</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#ProSitePatterns </span><br><span class="hljs-comment">#ProSiteProfiles</span><br>Error output from binary:<br>bin/prosite/pfscanV3: error <span class="hljs-keyword">while</span> loading shared libraries: libpcre.so: cannot open shared object file: No such file or directory<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/ebi-pf-team/i</span>nterproscan/issues?q=pfscanV3<br>https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/ebi-pf-team/i</span>nterproscan<span class="hljs-regexp">/issues/</span><span class="hljs-number">143</span><br>âˆšâˆšâˆšhttps:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/ebi-pf-team/i</span>nterproscan<span class="hljs-regexp">/issues/</span><span class="hljs-number">235</span><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#pfscanV3 äºŒè¿›åˆ¶æ–‡ä»¶ æ— æ³•æŸ¥çœ‹</span><br><span class="hljs-comment">#/usr/lib64æœ‰libpcre.so</span><br><span class="hljs-comment">#dont need to set &#x27;ln -s libpcre.so.1.2.0 libpcre.so&#x27;</span><br><span class="hljs-comment">#After appending /usr/lib64 to LD_LIBRARY_PATH environmental variable in user .bashrc, The two test runs finished successfully??</span><br><span class="hljs-comment">#before run, check LD_LIBRARY_PATH</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$LD_LIBRARY_PATH</span> &amp;&amp; ldd bin/prosite/pfscanV3<br><span class="hljs-comment">#ldd å‘½ä»¤å¯ä»¥ç”¨äºåˆ†æå¯æ‰§è¡Œæ–‡ä»¶çš„ä¾èµ–</span><br></code></pre></td></tr></table></figure><p><strong>NOTICE: different node have different LD_LIBRARY_PATH, fat or loginal or diff cluster node</strong></p><p><strong>check â€˜ldd bin&#x2F;prosite&#x2F;pfscanV3â€™ always!</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">[loginal]$ ldd bin/prosite/pfscanV3<br>linux-vdso.so.1 =&gt;  (0x00007fff61fbb000)<br>libpcre.so =&gt; /usr/lib64/libpcre.so (0x00007f91d65b4000)<br>libm.so.6 =&gt; /usr/lib64/libm.so.6 (0x00007f91d62b1000)<br>libpthread.so.0 =&gt; /usr/lib64/libpthread.so.0 (0x00007f91d6095000)<br>libc.so.6 =&gt; /usr/lib64/libc.so.6 (0x00007f91d5cd4000)<br>/lib64/ld-linux-x86-64.so.2 (0x00007f91d6816000)<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">[fat]$ ldd /xtdisk/xueyb_group/wangchenA/software/interproscan-5.56-89.0/bin/prosite/test<br>linux-vdso.so.1 =&gt;  (0x00007ffeac1d6000)<br>libpcre.so =&gt; not found<br>libm.so.6 =&gt; /lib64/libm.so.6 (0x00007f5c4a10c000)<br>libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007f5c49ef0000)<br>libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f5c49b2f000)<br>/lib64/ld-linux-x86-64.so.2 (0x00007f5c4a42d000)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>FuncAnno</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€FuncAnnoã€‘ã€BLASTã€‘</title>
    <link href="/GeekFocus/2022/06/05/2022-06-05-FuncAnno-BLASTP/"/>
    <url>/GeekFocus/2022/06/05/2022-06-05-FuncAnno-BLASTP/</url>
    
    <content type="html"><![CDATA[<p>NCBI BLAST+</p><span id="more"></span><h1 id="BLAST"><a href="#BLAST" class="headerlink" title="BLAST"></a>BLAST</h1><h2 id="nr-nt"><a href="#nr-nt" class="headerlink" title="nr nt"></a>nr nt</h2><p><font color="green"><strong>pre constructed blastdb</strong></font></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">wget -c ftp:<span class="hljs-regexp">//</span>ftp.ncbi.nlm.nih.gov<span class="hljs-regexp">/blast/</span>db/nt*<br>wget -c ftp:<span class="hljs-regexp">//</span>ftp.ncbi.nlm.nih.gov<span class="hljs-regexp">/blast/</span>db/nr*<br></code></pre></td></tr></table></figure><p><font color="green"><strong>Download nr.gz for self-build db(blasts or diamond)</strong> </font></p><p>GOOD: <a href="https://blog.csdn.net/weixin_44616693/article/details/121508156">https://blog.csdn.net/weixin_44616693/article/details/121508156</a></p><blockquote><p><a href="https://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/nr.gz">https://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/nr.gz</a></p><p><a href="https://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/nt.gz">https://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/nt.gz</a></p></blockquote><p><a href="ftp://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/nt.gz">ftp://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/nt.gz</a> get part compressed gz file, and can not use.</p><p><a href="https://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/nt.gz">https://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/nt.gz</a> is perfect, why???</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#â‘ wgetæ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œè‹¥å› ä¸ºç½‘ç»œé—®é¢˜ä¸­æ–­ä¸‹è½½ï¼Œæ‰§è¡Œ</span><br><span class="hljs-built_in">nohup</span> wget -c https://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/nt.gz 2&gt;&amp;1 &amp;<br><span class="hljs-comment"># error download</span><br><span class="hljs-built_in">nohup</span> wget ftp://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/nt.gz 2&gt;&amp;1 &amp;<br><span class="hljs-comment">#å³ä½¿ä¸‹è½½å®Œæˆï¼Œä½†æ˜¯ä¸‹è½½çš„nt.gzæ–‡ä»¶ä¸èƒ½è¿›è¡Œè§£å‹ï¼ˆæ— æ³•ä½¿ç”¨ï¼Œç­‰äºç™½å¹²äº†~~è¡€æ³ªæ•™è®­ï¼‰</span><br><br><span class="hljs-built_in">nohup</span> gunzip -c ./nt.gz &gt; ./nt.fa 2&gt;&amp;1 &amp;<span class="hljs-comment">#ï¼ˆä¿ç•™åŸæ–‡ä»¶ï¼Œä»¥ä¾¿å‡ºç°é—®é¢˜é‡å¤ä¸‹è½½ï¼‰</span><br></code></pre></td></tr></table></figure><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stata">awk &#x27;&#123;<span class="hljs-keyword">if</span>(NR%4 == 1)&#123;<span class="hljs-keyword">print</span> <span class="hljs-string">&quot;&gt;&quot;</span> <span class="hljs-built_in">substr</span>(<span class="hljs-variable">$0</span>, 2)&#125;&#125;&#123;<span class="hljs-keyword">if</span>(NR%4 == 2)&#123;<span class="hljs-keyword">print</span>&#125;&#125;&#x27; <span class="hljs-keyword">test</span>.fastq &gt; <span class="hljs-keyword">test</span>.fasta<br>blastn -<span class="hljs-keyword">query</span> <span class="hljs-keyword">test</span>.fasta -<span class="hljs-keyword">out</span> <span class="hljs-keyword">test</span>.result -<span class="hljs-keyword">db</span> ./nt_db/nt <br>## è¾“å‡ºä¸€æ¡æœ€ä¼˜æ¯”å¯¹ç»“æœ<br>blastn -<span class="hljs-keyword">query</span> test1.fa -<span class="hljs-keyword">out</span> test1.align -<span class="hljs-keyword">db</span> ./nt_db_NCBI/nt -outfmt 6 -subject_besthit -num_threads 4<br></code></pre></td></tr></table></figure><h2 id="BLASTP-Functional-Annotation"><a href="#BLASTP-Functional-Annotation" class="headerlink" title="BLASTP Functional Annotation"></a>BLASTP Functional Annotation</h2><p>ç”¨BLASTPæ£€ç´¢ç›¸å…³æ•°æ®åº“ï¼Œå››æ­¥ï¼šä¸‹è½½æ•°æ®åº“ï¼Œæ„å»ºBLASTPç´¢å¼•ï¼Œæ•°æ®åº“æ£€ç´¢ï¼Œç»“æœæ•´ç†ã€‚å…¶ä¸­ç»“æœæ•´ç†éœ€è¦æ ¹æ®BLASTPçš„è¾“å‡ºæ ¼å¼è°ƒæ•´ã€‚</p><p>Nrçš„NCBIæ”¶é›†çš„æœ€å…¨çš„è›‹ç™½åºåˆ—æ•°æ®åº“ï¼Œä½†æ˜¯æ— è®ºæ˜¯ç”¨NCBIçš„BLASTè¿˜æ˜¯ç”¨é€Ÿåº¦æ¯”è¾ƒå¿«DIAMONDå¯¹nrè¿›è¡Œæœç´¢ï¼Œæ²¡æœ‰åˆ©ç”¨å¥½ç‰©ç§æœ¬èº«çš„ä¿¡æ¯ã€‚å› æ­¤åœ¨RefSeqä¸Šä¸‹è½½å¯¹åº”ç‰©ç§çš„è›‹ç™½åºåˆ—, ç”¨BLASTPè¿›è¡Œæ³¨é‡Šå³å¯ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># download</span><br>wget -4  -nd -np -r 1 -A *.faa.gz ftp://ftp.ncbi.nlm.nih.gov/refseq/release/plant/<br><span class="hljs-comment">#mkdir -p ~/db/RefSeq</span><br><span class="hljs-comment">#zcat *.gz &gt; ~/db/RefSeq/plant.protein.faa</span><br>zcat *.gz &gt; plant.protein.faa<br><br><span class="hljs-comment"># build index</span><br><span class="hljs-comment">#~/opt/biosoft/ncbi-blast-2.7.1+/bin/makeblastdb -in plant.protein.faa -dbtype prot -parse_seqids -title RefSeq_plant -out plant</span><br>makeblastdb -<span class="hljs-keyword">in</span> plant.protein.faa -dbtype prot -parse_seqids -title RefSeq_plant -out RefSeq_plant_blastpdb/RefSeq_plant &gt; RefSeq_plant-builddb.log 2&gt;&amp;1 &amp;<br><span class="hljs-comment">#-out database_name</span><br><span class="hljs-comment">#-title database_title</span><br><br><span class="hljs-comment"># search</span><br>~/opt/biosoft/ncbi-blast-2.7.1+/bin/blastp -query protein.fa -out RefSeq_plant_blastp.xml -db ~/db/RefSeq/uniprot_sprot.fasta -evalue 1e-5 -outfmt 5 -num_threads 50 &amp;<br></code></pre></td></tr></table></figure><p><a href="http://www.uniprot.org/downloads">Swiss-Prot</a>é‡Œæ”¶é›†äº†ç›®å‰å¯ä¿¡åº¦æœ€é«˜çš„è›‹ç™½åºåˆ—ï¼Œä¸€å…±æœ‰55wæ¡è®°å½•ï¼Œæ•°æ®é‡è¾ƒå°</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># download</span><br><span class="hljs-comment">#wget -4 -q ftp://ftp.uniprot.org/pub/databases/uniprot/current_release/knowledgebase/complete/uniprot_sprot.fasta.gz</span><br>gzip -d uniprot_sprot.fasta.gz<br><span class="hljs-comment"># builid index</span><br><span class="hljs-comment">#~/opt/biosoft/ncbi-blast-2.7.1+/bin/makeblastdb -in uniprot_sprot.fasta -dbtype prot -title swiss_prot -parse_seqids</span><br>makeblastdb -<span class="hljs-keyword">in</span> uniprot-reviewed_yes.fasta -dbtype prot -title swiss_prot -parse_seqids -out swiss_prot_blastpdb/swiss_prot &gt; uniprot-swiss-builddb.log 2&gt;&amp;1 &amp;<br><br><span class="hljs-comment"># search</span><br>~/opt/biosoft/ncbi-blast-2.7.1+/bin/blastp -query protein.fa -out swiss_prot.xml -db ~/db/swiss_prot/uniprot_sprot.fasta -evalue 1e-5 -outfmt 5 -num_threads 50 &amp;<br></code></pre></td></tr></table></figure><p>å…³äºç»“æœæ•´ç†ï¼Œå·²ç»æœ‰å¾ˆå¤šäººå†™äº†è„šæœ¬ï¼Œæ¯”å¦‚è¯´æˆ‘æœç´¢BLAST XML to tabï¼Œæ‰¾åˆ°<a href="https://github.com/peterjc/galaxy_blast/blob/master/tools/ncbi_blast_plus/blastxml_to_tabular.py">https://github.com/peterjc/galaxy_blast/blob/master/tools/ncbi_blast_plus/blastxml_to_tabular.py</a></p><h2 id="BLAST-è¾“å‡º"><a href="#BLAST-è¾“å‡º" class="headerlink" title="BLAST è¾“å‡º"></a>BLAST è¾“å‡º</h2><h3 id="1-pairwiseæ ¼å¼"><a href="#1-pairwiseæ ¼å¼" class="headerlink" title="1. pairwiseæ ¼å¼"></a>1. pairwiseæ ¼å¼</h3><p>é»˜è®¤ï¼Œä¼šè¾“å‡ºæŸ¥è¯¢åºåˆ—IDï¼›åº“åºåˆ—æ¦‚å†µï¼›å…·ä½“é…å¯¹ä¿¡æ¯pairwiseã€‚é€‚åˆqueryåºåˆ—è¾ƒå°‘</p><h3 id="2-blast-tab-ourfmt-6"><a href="#2-blast-tab-ourfmt-6" class="headerlink" title="2. blast tab, -ourfmt 6"></a>2. blast tab, -ourfmt 6</h3><p>blast+ ä¸€èˆ¬è®¾ç½®è¾“å‡ºæ ¼å¼ä¸º -outfmt 6 æˆ–è€… 7 ï¼ˆåè€…åŒ…å«è¡¨å¤´ï¼‰</p><p>å¯åœ¨excelä¸­æŸ¥çœ‹ï¼Œä»¥HSPï¼ˆé«˜åº¦ç›¸ä¼¼ç‰‡æ®µï¼‰ä¸ºå•ä½ï¼Œæ¯”å¯¹ç»“æœä¸ç›´è§‚ã€‚</p><h3 id="3-ASN"><a href="#3-ASN" class="headerlink" title="3. ASN"></a>3. ASN</h3><p>ASNæ ¼å¼ç±»ä¼¼JSONï¼Œæ˜¯NCBIè‡ªå®šä¹‰æ ¼å¼ï¼Œå­˜å‚¨ä¿¡æ¯å…¨é¢ï¼Œå¯ç›´æ¥ä½¿ç”¨Blastè½¯ä»¶è½¬æ¢ä¸ºå…¶ä»–æ ¼å¼ã€‚</p><h3 id="4-XML"><a href="#4-XML" class="headerlink" title="4. XML"></a>4. XML</h3><ul><li>ç›¸æ¯”äºPairwiseå’ŒASNï¼ŒXMLæ›´å®¹æ˜“ä½¿ç”¨ç¨‹åºè§£æ</li><li>ç›¸æ¯”äºTabï¼ŒXMLä¿¡æ¯æ›´å…¨é¢</li></ul><blockquote><p>åºåˆ—å°‘å»ºè®®Pairwiseï¼Œå…¶ä»–å»ºè®®XMLï¼Ÿ</p></blockquote><h3 id="5-XMLè½¬åŒ–BLAST-Tab"><a href="#5-XMLè½¬åŒ–BLAST-Tab" class="headerlink" title="5. XMLè½¬åŒ–BLAST Tab"></a>5. XMLè½¬åŒ–BLAST Tab</h3><p>TBtools</p><h3 id="6-scripts"><a href="#6-scripts" class="headerlink" title="6. scripts"></a>6. scripts</h3><p>blast xml to table</p><p><a href="https://github.com/peterjc/galaxy_blast/tree/master/tools">https://github.com/peterjc/galaxy_blast/tree/master/tools</a>  58stars</p><p><a href="https://github.com/peterjc/galaxy_blast/blob/master/tools/ncbi_blast_plus/blastxml_to_tabular.py">https://github.com/peterjc/galaxy_blast/blob/master/tools/ncbi_blast_plus/blastxml_to_tabular.py</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-string">&quot;&quot;&quot;Convert a BLAST XML file to tabular output.</span><br><span class="hljs-string">Designed to convert BLAST XML files into tabular BLAST output (either</span><br><span class="hljs-string">std for standard 12 columns, or ext for the extended 25 columns offered</span><br><span class="hljs-string">in the Galaxy BLAST+ wrappers).</span><br><span class="hljs-string">The 12 columns output are &#x27;qseqid sseqid pident length mismatch gapopen qstart</span><br><span class="hljs-string">qend sstart send evalue bitscore&#x27; or &#x27;std&#x27; at the BLAST+ command line, which</span><br><span class="hljs-string">mean:</span><br><span class="hljs-string">====== ========= ============================================</span><br><span class="hljs-string">Column NCBI name Description</span><br><span class="hljs-string">------ --------- --------------------------------------------</span><br><span class="hljs-string">     1 qseqid    Query Seq-id (ID of your sequence)</span><br><span class="hljs-string">     2 sseqid    Subject Seq-id (ID of the database hit)</span><br><span class="hljs-string">     3 pident    Percentage of identical matches</span><br><span class="hljs-string">     4 length    Alignment length</span><br><span class="hljs-string">     5 mismatch  Number of mismatches</span><br><span class="hljs-string">     6 gapopen   Number of gap openings</span><br><span class="hljs-string">     7 qstart    Start of alignment in query</span><br><span class="hljs-string">     8 qend      End of alignment in query</span><br><span class="hljs-string">     9 sstart    Start of alignment in subject (database hit)</span><br><span class="hljs-string">    10 send      End of alignment in subject (database hit)</span><br><span class="hljs-string">    11 evalue    Expectation value (E-value)</span><br><span class="hljs-string">    12 bitscore  Bit score</span><br><span class="hljs-string">====== ========= ============================================</span><br><span class="hljs-string">The additional columns offered in the Galaxy BLAST+ wrappers are:</span><br><span class="hljs-string">====== ============= ===========================================</span><br><span class="hljs-string">Column NCBI name     Description</span><br><span class="hljs-string">------ ------------- -------------------------------------------</span><br><span class="hljs-string">    13 sallseqid     All subject Seq-id(s), separated by &#x27;;&#x27;</span><br><span class="hljs-string">    14 score         Raw score</span><br><span class="hljs-string">    15 nident        Number of identical matches</span><br><span class="hljs-string">    16 positive      Number of positive-scoring matches</span><br><span class="hljs-string">    17 gaps          Total number of gaps</span><br><span class="hljs-string">    18 ppos          Percentage of positive-scoring matches</span><br><span class="hljs-string">    19 qframe        Query frame</span><br><span class="hljs-string">    20 sframe        Subject frame</span><br><span class="hljs-string">    21 qseq          Aligned part of query sequence</span><br><span class="hljs-string">    22 sseq          Aligned part of subject sequence</span><br><span class="hljs-string">    23 qlen          Query sequence length</span><br><span class="hljs-string">    24 slen          Subject sequence length</span><br><span class="hljs-string">    25 salltitles    All subject titles, separated by &#x27;&amp;lt;&amp;gt;&#x27;</span><br><span class="hljs-string">====== ============= ===========================================</span><br><span class="hljs-string">Most of these fields are given explicitly in the XML file, others some like</span><br><span class="hljs-string">the percentage identity and the number of gap openings must be calculated.</span><br><span class="hljs-string">Be aware that the sequence in the extended tabular output or XML direct from</span><br><span class="hljs-string">BLAST+ may or may not use XXXX masking on regions of low complexity. This</span><br><span class="hljs-string">can throw the off the calculation of percentage identity and gap openings.</span><br><span class="hljs-string">[In fact, both BLAST 2.2.24+ and 2.2.25+ have a subtle bug in this regard,</span><br><span class="hljs-string">with these numbers changing depending on whether or not the low complexity</span><br><span class="hljs-string">filter is used.]</span><br><span class="hljs-string">This script attempts to produce identical output to what BLAST+ would have done.</span><br><span class="hljs-string">However, check this with &quot;diff -b ...&quot; since BLAST+ sometimes includes an extra</span><br><span class="hljs-string">space character (probably a bug).</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> print_function<br><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">from</span> optparse <span class="hljs-keyword">import</span> OptionParser<br><br><span class="hljs-keyword">if</span> <span class="hljs-string">&quot;-v&quot;</span> <span class="hljs-keyword">in</span> sys.argv <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;--version&quot;</span> <span class="hljs-keyword">in</span> sys.argv:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;v0.2.01&quot;</span>)<br>    sys.exit(<span class="hljs-number">0</span>)<br><br><span class="hljs-keyword">if</span> sys.version_info[:<span class="hljs-number">2</span>] &gt;= (<span class="hljs-number">2</span>, <span class="hljs-number">5</span>):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">from</span> xml.etree <span class="hljs-keyword">import</span> cElementTree <span class="hljs-keyword">as</span> ElementTree<br>    <span class="hljs-keyword">except</span> ImportError:<br>        <span class="hljs-keyword">from</span> xml.etree <span class="hljs-keyword">import</span> ElementTree <span class="hljs-keyword">as</span> ElementTree<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">from</span> galaxy <span class="hljs-keyword">import</span> eggs  <span class="hljs-comment"># noqa - ignore flake8 F401</span><br>    <span class="hljs-keyword">import</span> pkg_resources<br><br>    pkg_resources.require(<span class="hljs-string">&quot;elementtree&quot;</span>)<br>    <span class="hljs-keyword">from</span> elementtree <span class="hljs-keyword">import</span> ElementTree<br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) == <span class="hljs-number">4</span> <span class="hljs-keyword">and</span> sys.argv[<span class="hljs-number">3</span>] <span class="hljs-keyword">in</span> [<span class="hljs-string">&quot;std&quot;</span>, <span class="hljs-string">&quot;x22&quot;</span>, <span class="hljs-string">&quot;ext&quot;</span>]:<br>    <span class="hljs-comment"># False positive if user really has a BLAST XML file called &#x27;std&#x27; or &#x27;ext&#x27;...</span><br>    sys.exit(<br>        <span class="hljs-string">&quot;&quot;&quot;ERROR: The script API has changed, sorry.</span><br><span class="hljs-string">Instead of the old style:</span><br><span class="hljs-string">$ python blastxml_to_tabular.py input.xml output.tabular std</span><br><span class="hljs-string">Please use:</span><br><span class="hljs-string">$ python blastxml_to_tabular.py -o output.tabular -c std input.xml</span><br><span class="hljs-string">For more information, use:</span><br><span class="hljs-string">$ python blastxml_to_tabular.py -h</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>    )<br><br>usage = <span class="hljs-string">&quot;&quot;&quot;usage: %prog [options] blastxml[,...]</span><br><span class="hljs-string">Convert one (or more) BLAST XML files into a single tabular file.</span><br><span class="hljs-string">The columns option can be &#x27;std&#x27; (standard 12 columns), &#x27;ext&#x27;</span><br><span class="hljs-string">(extended 25 columns), or a list of BLAST+ column names like</span><br><span class="hljs-string">&#x27;qseqid,sseqid,pident&#x27; (space or comma separated).</span><br><span class="hljs-string">Note if using a list of column names, currently ONLY the 25</span><br><span class="hljs-string">extended column names are supported.</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>parser = OptionParser(usage=usage)<br>parser.add_option(<br>    <span class="hljs-string">&quot;-o&quot;</span>,<br>    <span class="hljs-string">&quot;--output&quot;</span>,<br>    dest=<span class="hljs-string">&quot;output&quot;</span>,<br>    default=<span class="hljs-literal">None</span>,<br>    <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;output filename (defaults to stdout)&quot;</span>,<br>    metavar=<span class="hljs-string">&quot;FILE&quot;</span>,<br>)<br>parser.add_option(<br>    <span class="hljs-string">&quot;-c&quot;</span>,<br>    <span class="hljs-string">&quot;--columns&quot;</span>,<br>    dest=<span class="hljs-string">&quot;columns&quot;</span>,<br>    default=<span class="hljs-string">&quot;std&quot;</span>,<br>    <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;[std|ext|col1,col2,...] standard 12 columns, &quot;</span><br>    <span class="hljs-string">&quot;extended 25 columns, or list of column names&quot;</span>,<br>)<br>(options, args) = parser.parse_args()<br><br>colnames = (<br>    <span class="hljs-string">&quot;qseqid,sseqid,pident,length,mismatch,gapopen,qstart,qend,&quot;</span><br>    <span class="hljs-string">&quot;sstart,send,evalue,bitscore,sallseqid,score,nident,positive,&quot;</span><br>    <span class="hljs-string">&quot;gaps,ppos,qframe,sframe,qseq,sseq,qlen,slen,salltitles&quot;</span><br>).split(<span class="hljs-string">&quot;,&quot;</span>)<br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(args) &lt; <span class="hljs-number">1</span>:<br>    sys.exit(<span class="hljs-string">&quot;ERROR: No BLASTXML input files given; run with --help to see options.&quot;</span>)<br><br>out_fmt = options.columns<br><span class="hljs-keyword">if</span> out_fmt == <span class="hljs-string">&quot;std&quot;</span>:<br>    extended = <span class="hljs-literal">False</span><br>    cols = <span class="hljs-literal">None</span><br><span class="hljs-keyword">elif</span> out_fmt == <span class="hljs-string">&quot;x22&quot;</span>:<br>    sys.exit(<span class="hljs-string">&quot;Format argument x22 has been replaced with ext (extended 25 columns)&quot;</span>)<br><span class="hljs-keyword">elif</span> out_fmt == <span class="hljs-string">&quot;ext&quot;</span>:<br>    extended = <span class="hljs-literal">True</span><br>    cols = <span class="hljs-literal">None</span><br><span class="hljs-keyword">else</span>:<br>    cols = out_fmt.replace(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;,&quot;</span>).split(<span class="hljs-string">&quot;,&quot;</span>)  <span class="hljs-comment"># Allow space or comma separated</span><br>    <span class="hljs-comment"># Remove any blank entries due to trailing comma,</span><br>    <span class="hljs-comment"># or annoying &quot;None&quot; dummy value from Galaxy if no columns</span><br>    cols = [c <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> cols <span class="hljs-keyword">if</span> c <span class="hljs-keyword">and</span> c != <span class="hljs-string">&quot;None&quot;</span>]<br>    extra = <span class="hljs-built_in">set</span>(cols).difference(colnames)<br>    <span class="hljs-keyword">if</span> extra:<br>        sys.exit(<span class="hljs-string">&quot;These are not recognised column names: %s&quot;</span> % <span class="hljs-string">&quot;,&quot;</span>.join(<span class="hljs-built_in">sorted</span>(extra)))<br>    <span class="hljs-keyword">del</span> extra<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">set</span>(colnames).issuperset(cols), cols<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cols:<br>        sys.exit(<span class="hljs-string">&quot;No columns selected!&quot;</span>)<br>    extended = (<br>        <span class="hljs-built_in">max</span>(colnames.index(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> cols) &gt;= <span class="hljs-number">12</span><br>    )  <span class="hljs-comment"># Do we need any higher columns?</span><br><span class="hljs-keyword">del</span> out_fmt<br><br><span class="hljs-keyword">for</span> in_file <span class="hljs-keyword">in</span> args:<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.isfile(in_file):<br>        sys.exit(<span class="hljs-string">&quot;Input BLAST XML file not found: %s&quot;</span> % in_file)<br><br><br>re_default_query_id = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&quot;^Query_\d+$&quot;</span>)<br><span class="hljs-keyword">assert</span> re_default_query_id.match(<span class="hljs-string">r&quot;Query_101&quot;</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-keyword">not</span> re_default_query_id.match(<span class="hljs-string">r&quot;Query_101a&quot;</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-keyword">not</span> re_default_query_id.match(<span class="hljs-string">r&quot;MyQuery_101&quot;</span>)<br>re_default_subject_id = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&quot;^Subject_\d+$&quot;</span>)<br><span class="hljs-keyword">assert</span> re_default_subject_id.match(<span class="hljs-string">r&quot;Subject_1&quot;</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-keyword">not</span> re_default_subject_id.match(<span class="hljs-string">r&quot;Subject_&quot;</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-keyword">not</span> re_default_subject_id.match(<span class="hljs-string">r&quot;Subject_12a&quot;</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-keyword">not</span> re_default_subject_id.match(<span class="hljs-string">r&quot;TheSubject_1&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">convert</span>(<span class="hljs-params">blastxml_filename, output_handle</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Convert BLAST XML input from a file to tabular on given handle.&quot;&quot;&quot;</span><br>    blast_program = <span class="hljs-literal">None</span><br>    <span class="hljs-comment"># get an iterable</span><br>    <span class="hljs-keyword">try</span>:<br>        context = ElementTree.iterparse(blastxml_filename, events=(<span class="hljs-string">&quot;start&quot;</span>, <span class="hljs-string">&quot;end&quot;</span>))<br>    <span class="hljs-keyword">except</span> Exception:<br>        sys.exit(<span class="hljs-string">&quot;Invalid data format.&quot;</span>)<br>    <span class="hljs-comment"># turn it into an iterator</span><br>    context = <span class="hljs-built_in">iter</span>(context)<br>    <span class="hljs-comment"># get the root element</span><br>    <span class="hljs-keyword">try</span>:<br>        event, root = <span class="hljs-built_in">next</span>(context)<br>    <span class="hljs-keyword">except</span> Exception:<br>        sys.exit(<span class="hljs-string">&quot;Invalid data format.&quot;</span>)<br>    <span class="hljs-keyword">for</span> event, elem <span class="hljs-keyword">in</span> context:<br>        <span class="hljs-keyword">if</span> event == <span class="hljs-string">&quot;end&quot;</span> <span class="hljs-keyword">and</span> elem.tag == <span class="hljs-string">&quot;BlastOutput_program&quot;</span>:<br>            blast_program = elem.text<br>        <span class="hljs-comment"># for every &lt;Iteration&gt; tag</span><br>        <span class="hljs-keyword">if</span> event == <span class="hljs-string">&quot;end&quot;</span> <span class="hljs-keyword">and</span> elem.tag == <span class="hljs-string">&quot;Iteration&quot;</span>:<br>            <span class="hljs-comment"># Expecting either this, from BLAST 2.2.25+ using FASTA vs FASTA</span><br>            <span class="hljs-comment"># &lt;Iteration_query-ID&gt;sp|Q9BS26|ERP44_HUMAN&lt;/Iteration_query-ID&gt;</span><br>            <span class="hljs-comment"># &lt;Iteration_query-def&gt;Endoplasmic reticulum resident protein 44</span><br>            <span class="hljs-comment"># OS=Homo sapiens GN=ERP44 PE=1 SV=1&lt;/Iteration_query-def&gt;</span><br>            <span class="hljs-comment"># &lt;Iteration_query-len&gt;406&lt;/Iteration_query-len&gt;</span><br>            <span class="hljs-comment"># &lt;Iteration_hits&gt;&lt;/Iteration_hits&gt;</span><br>            <span class="hljs-comment">#</span><br>            <span class="hljs-comment"># Or, from BLAST 2.2.24+ run online</span><br>            <span class="hljs-comment"># &lt;Iteration_query-ID&gt;Query_1&lt;/Iteration_query-ID&gt;</span><br>            <span class="hljs-comment"># &lt;Iteration_query-def&gt;Sample&lt;/Iteration_query-def&gt;</span><br>            <span class="hljs-comment"># &lt;Iteration_query-len&gt;516&lt;/Iteration_query-len&gt;</span><br>            <span class="hljs-comment"># &lt;Iteration_hits&gt;...</span><br>            qseqid = elem.findtext(<span class="hljs-string">&quot;Iteration_query-ID&quot;</span>)<br>            <span class="hljs-keyword">if</span> re_default_query_id.match(qseqid):<br>                <span class="hljs-comment"># Place holder ID, take the first word of the query definition</span><br>                qseqid = elem.findtext(<span class="hljs-string">&quot;Iteration_query-def&quot;</span>).split(<span class="hljs-literal">None</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>]<br>            qlen = <span class="hljs-built_in">int</span>(elem.findtext(<span class="hljs-string">&quot;Iteration_query-len&quot;</span>))<br><br>            <span class="hljs-comment"># for every &lt;Hit&gt; within &lt;Iteration&gt;</span><br>            <span class="hljs-keyword">for</span> hit <span class="hljs-keyword">in</span> elem.findall(<span class="hljs-string">&quot;Iteration_hits/Hit&quot;</span>):<br>                <span class="hljs-comment"># Expecting either this,</span><br>                <span class="hljs-comment"># &lt;Hit_id&gt;gi|3024260|sp|P56514.1|OPSD_BUFBU&lt;/Hit_id&gt;</span><br>                <span class="hljs-comment"># &lt;Hit_def&gt;RecName: Full=Rhodopsin&lt;/Hit_def&gt;</span><br>                <span class="hljs-comment"># &lt;Hit_accession&gt;P56514&lt;/Hit_accession&gt;</span><br>                <span class="hljs-comment"># or,</span><br>                <span class="hljs-comment"># &lt;Hit_id&gt;Subject_1&lt;/Hit_id&gt;</span><br>                <span class="hljs-comment"># &lt;Hit_def&gt;gi|57163783|ref|NP_001009242.1|</span><br>                <span class="hljs-comment"># rhodopsin [Felis catus]&lt;/Hit_def&gt;</span><br>                <span class="hljs-comment"># &lt;Hit_accession&gt;Subject_1&lt;/Hit_accession&gt;</span><br>                <span class="hljs-comment">#</span><br>                <span class="hljs-comment"># apparently depending on the parse_deflines switch</span><br>                <span class="hljs-comment">#</span><br>                <span class="hljs-comment"># Or, with a local database not using -parse_seqids can get this,</span><br>                <span class="hljs-comment"># &lt;Hit_id&gt;gnl|BL_ORD_ID|2&lt;/Hit_id&gt;</span><br>                <span class="hljs-comment"># &lt;Hit_def&gt;chrIII gi|240255695|ref|NC_003074.8| Arabidopsis</span><br>                <span class="hljs-comment"># thaliana chromosome 3, complete sequence&lt;/Hit_def&gt;</span><br>                <span class="hljs-comment"># &lt;Hit_accession&gt;2&lt;/Hit_accession&gt;</span><br>                sseqid = hit.findtext(<span class="hljs-string">&quot;Hit_id&quot;</span>).split(<span class="hljs-literal">None</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>]<br>                hit_def = sseqid + <span class="hljs-string">&quot; &quot;</span> + hit.findtext(<span class="hljs-string">&quot;Hit_def&quot;</span>)<br>                <span class="hljs-keyword">if</span> re_default_subject_id.match(sseqid) <span class="hljs-keyword">and</span> sseqid == hit.findtext(<br>                    <span class="hljs-string">&quot;Hit_accession&quot;</span><br>                ):<br>                    <span class="hljs-comment"># Place holder ID, take the first word of the subject definition</span><br>                    hit_def = hit.findtext(<span class="hljs-string">&quot;Hit_def&quot;</span>)<br>                    sseqid = hit_def.split(<span class="hljs-literal">None</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>]<br>                <span class="hljs-keyword">if</span> sseqid.startswith(<br>                    <span class="hljs-string">&quot;gnl|BL_ORD_ID|&quot;</span><br>                ) <span class="hljs-keyword">and</span> sseqid == <span class="hljs-string">&quot;gnl|BL_ORD_ID|&quot;</span> + hit.findtext(<span class="hljs-string">&quot;Hit_accession&quot;</span>):<br>                    <span class="hljs-comment"># Alternative place holder ID, again take the first word of hit_def</span><br>                    hit_def = hit.findtext(<span class="hljs-string">&quot;Hit_def&quot;</span>)<br>                    sseqid = hit_def.split(<span class="hljs-literal">None</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>]<br>                <span class="hljs-comment"># for every &lt;Hsp&gt; within &lt;Hit&gt;</span><br>                <span class="hljs-keyword">for</span> hsp <span class="hljs-keyword">in</span> hit.findall(<span class="hljs-string">&quot;Hit_hsps/Hsp&quot;</span>):<br>                    nident = hsp.findtext(<span class="hljs-string">&quot;Hsp_identity&quot;</span>)<br>                    length = hsp.findtext(<span class="hljs-string">&quot;Hsp_align-len&quot;</span>)<br>                    <span class="hljs-comment"># As of NCBI BLAST+ 2.4.0 this is given to 3dp (not 2dp)</span><br>                    pident = <span class="hljs-string">&quot;%0.3f&quot;</span> % (<span class="hljs-number">100</span> * <span class="hljs-built_in">float</span>(nident) / <span class="hljs-built_in">float</span>(length))<br><br>                    q_seq = hsp.findtext(<span class="hljs-string">&quot;Hsp_qseq&quot;</span>)<br>                    h_seq = hsp.findtext(<span class="hljs-string">&quot;Hsp_hseq&quot;</span>)<br>                    m_seq = hsp.findtext(<span class="hljs-string">&quot;Hsp_midline&quot;</span>)<br>                    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(q_seq) == <span class="hljs-built_in">len</span>(h_seq) == <span class="hljs-built_in">len</span>(m_seq) == <span class="hljs-built_in">int</span>(length)<br>                    gapopen = <span class="hljs-built_in">str</span>(<br>                        <span class="hljs-built_in">len</span>(q_seq.replace(<span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot; &quot;</span>).split())<br>                        - <span class="hljs-number">1</span><br>                        + <span class="hljs-built_in">len</span>(h_seq.replace(<span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot; &quot;</span>).split())<br>                        - <span class="hljs-number">1</span><br>                    )<br><br>                    mismatch = (<br>                        m_seq.count(<span class="hljs-string">&quot; &quot;</span>)<br>                        + m_seq.count(<span class="hljs-string">&quot;+&quot;</span>)<br>                        - q_seq.count(<span class="hljs-string">&quot;-&quot;</span>)<br>                        - h_seq.count(<span class="hljs-string">&quot;-&quot;</span>)<br>                    )<br>                    <span class="hljs-comment"># TODO - Remove this alternative mismatch calculation and test</span><br>                    <span class="hljs-comment"># once satisifed there are no problems</span><br>                    expected_mismatch = <span class="hljs-built_in">len</span>(q_seq) - <span class="hljs-built_in">sum</span>(<br>                        <span class="hljs-number">1</span><br>                        <span class="hljs-keyword">for</span> q, h <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(q_seq, h_seq)<br>                        <span class="hljs-keyword">if</span> q == h <span class="hljs-keyword">or</span> q == <span class="hljs-string">&quot;-&quot;</span> <span class="hljs-keyword">or</span> h == <span class="hljs-string">&quot;-&quot;</span><br>                    )<br>                    xx = <span class="hljs-built_in">sum</span>(<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> q, h <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(q_seq, h_seq) <span class="hljs-keyword">if</span> q == <span class="hljs-string">&quot;X&quot;</span> <span class="hljs-keyword">and</span> h == <span class="hljs-string">&quot;X&quot;</span>)<br>                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (<br>                        expected_mismatch - q_seq.count(<span class="hljs-string">&quot;X&quot;</span>)<br>                        &lt;= <span class="hljs-built_in">int</span>(mismatch)<br>                        &lt;= expected_mismatch + xx<br>                    ):<br>                        sys.exit(<br>                            <span class="hljs-string">&quot;%s vs %s mismatches, expected %i &lt;= %i &lt;= %i&quot;</span><br>                            % (<br>                                qseqid,<br>                                sseqid,<br>                                expected_mismatch - q_seq.count(<span class="hljs-string">&quot;X&quot;</span>),<br>                                <span class="hljs-built_in">int</span>(mismatch),<br>                                expected_mismatch,<br>                            )<br>                        )<br><br>                    <span class="hljs-comment"># TODO - Remove this alternative identity calculation and test</span><br>                    <span class="hljs-comment"># once satisifed there are no problems</span><br>                    expected_identity = <span class="hljs-built_in">sum</span>(<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> q, h <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(q_seq, h_seq) <span class="hljs-keyword">if</span> q == h)<br>                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (<br>                        expected_identity - xx<br>                        &lt;= <span class="hljs-built_in">int</span>(nident)<br>                        &lt;= expected_identity + q_seq.count(<span class="hljs-string">&quot;X&quot;</span>)<br>                    ):<br>                        sys.exit(<br>                            <span class="hljs-string">&quot;%s vs %s identities, expected %i &lt;= %i &lt;= %i&quot;</span><br>                            % (<br>                                qseqid,<br>                                sseqid,<br>                                expected_identity,<br>                                <span class="hljs-built_in">int</span>(nident),<br>                                expected_identity + q_seq.count(<span class="hljs-string">&quot;X&quot;</span>),<br>                            )<br>                        )<br><br>                    evalue = hsp.findtext(<span class="hljs-string">&quot;Hsp_evalue&quot;</span>)<br>                    <span class="hljs-keyword">if</span> evalue == <span class="hljs-string">&quot;0&quot;</span>:<br>                        evalue = <span class="hljs-string">&quot;0.0&quot;</span><br>                    <span class="hljs-keyword">else</span>:<br>                        evalue = <span class="hljs-string">&quot;%0.0e&quot;</span> % <span class="hljs-built_in">float</span>(evalue)<br><br>                    bitscore = <span class="hljs-built_in">float</span>(hsp.findtext(<span class="hljs-string">&quot;Hsp_bit-score&quot;</span>))<br>                    <span class="hljs-keyword">if</span> bitscore &lt; <span class="hljs-number">100</span>:<br>                        <span class="hljs-comment"># Seems to show one decimal place for lower scores</span><br>                        bitscore = <span class="hljs-string">&quot;%0.1f&quot;</span> % bitscore<br>                    <span class="hljs-keyword">else</span>:<br>                        <span class="hljs-comment"># Note BLAST does not round to nearest int, it truncates</span><br>                        bitscore = <span class="hljs-string">&quot;%i&quot;</span> % bitscore<br><br>                    values = [<br>                        qseqid,<br>                        sseqid,<br>                        pident,<br>                        length,  <span class="hljs-comment"># hsp.findtext(&quot;Hsp_align-len&quot;)</span><br>                        <span class="hljs-built_in">str</span>(mismatch),<br>                        gapopen,<br>                        hsp.findtext(<span class="hljs-string">&quot;Hsp_query-from&quot;</span>),  <span class="hljs-comment"># qstart,</span><br>                        hsp.findtext(<span class="hljs-string">&quot;Hsp_query-to&quot;</span>),  <span class="hljs-comment"># qend,</span><br>                        hsp.findtext(<span class="hljs-string">&quot;Hsp_hit-from&quot;</span>),  <span class="hljs-comment"># sstart,</span><br>                        hsp.findtext(<span class="hljs-string">&quot;Hsp_hit-to&quot;</span>),  <span class="hljs-comment"># send,</span><br>                        evalue,  <span class="hljs-comment"># hsp.findtext(&quot;Hsp_evalue&quot;) in scientific notation</span><br>                        bitscore,  <span class="hljs-comment"># hsp.findtext(&quot;Hsp_bit-score&quot;) rounded</span><br>                    ]<br><br>                    <span class="hljs-keyword">if</span> extended:<br>                        <span class="hljs-keyword">try</span>:<br>                            sallseqid = <span class="hljs-string">&quot;;&quot;</span>.join(<br>                                name.split(<span class="hljs-literal">None</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> hit_def.split(<span class="hljs-string">&quot; &gt;&quot;</span>)<br>                            )<br>                            salltitles = <span class="hljs-string">&quot;&lt;&gt;&quot;</span>.join(<br>                                name.split(<span class="hljs-literal">None</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> hit_def.split(<span class="hljs-string">&quot; &gt;&quot;</span>)<br>                            )<br>                        <span class="hljs-keyword">except</span> IndexError <span class="hljs-keyword">as</span> e:<br>                            sys.exit(<br>                                <span class="hljs-string">&quot;Problem splitting multuple hits?\n%r\n--&gt; %s&quot;</span><br>                                % (hit_def, e)<br>                            )<br>                        <span class="hljs-comment"># print(hit_def, &quot;--&gt;&quot;, sallseqid)</span><br>                        positive = hsp.findtext(<span class="hljs-string">&quot;Hsp_positive&quot;</span>)<br>                        ppos = <span class="hljs-string">&quot;%0.2f&quot;</span> % (<span class="hljs-number">100</span> * <span class="hljs-built_in">float</span>(positive) / <span class="hljs-built_in">float</span>(length))<br>                        qframe = hsp.findtext(<span class="hljs-string">&quot;Hsp_query-frame&quot;</span>)<br>                        sframe = hsp.findtext(<span class="hljs-string">&quot;Hsp_hit-frame&quot;</span>)<br>                        <span class="hljs-keyword">if</span> blast_program == <span class="hljs-string">&quot;blastp&quot;</span>:<br>                            <span class="hljs-comment"># Probably a bug in BLASTP that they use 0 or 1</span><br>                            <span class="hljs-comment"># depending on format</span><br>                            <span class="hljs-keyword">if</span> qframe == <span class="hljs-string">&quot;0&quot;</span>:<br>                                qframe = <span class="hljs-string">&quot;1&quot;</span><br>                            <span class="hljs-keyword">if</span> sframe == <span class="hljs-string">&quot;0&quot;</span>:<br>                                sframe = <span class="hljs-string">&quot;1&quot;</span><br>                        slen = <span class="hljs-built_in">int</span>(hit.findtext(<span class="hljs-string">&quot;Hit_len&quot;</span>))<br>                        values.extend(<br>                            [<br>                                sallseqid,<br>                                hsp.findtext(<span class="hljs-string">&quot;Hsp_score&quot;</span>),  <span class="hljs-comment"># score,</span><br>                                nident,<br>                                positive,<br>                                hsp.findtext(<span class="hljs-string">&quot;Hsp_gaps&quot;</span>),  <span class="hljs-comment"># gaps,</span><br>                                ppos,<br>                                qframe,<br>                                sframe,<br>                                <span class="hljs-comment"># NOTE - for blastp, XML shows original seq,</span><br>                                <span class="hljs-comment"># tabular uses XXX masking</span><br>                                q_seq,<br>                                h_seq,<br>                                <span class="hljs-built_in">str</span>(qlen),<br>                                <span class="hljs-built_in">str</span>(slen),<br>                                salltitles,<br>                            ]<br>                        )<br>                    <span class="hljs-keyword">if</span> cols:<br>                        <span class="hljs-comment"># Only a subset of the columns are needed</span><br>                        values = [values[colnames.index(c)] <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> cols]<br>                    <span class="hljs-comment"># print(&quot;\t&quot;.join(values))</span><br>                    output_handle.write(<span class="hljs-string">&quot;\t&quot;</span>.join(values) + <span class="hljs-string">&quot;\n&quot;</span>)<br>            <span class="hljs-comment"># prevents ElementTree from growing large datastructure</span><br>            root.clear()<br>            elem.clear()<br><br><br><span class="hljs-keyword">if</span> options.output:<br>    outfile = <span class="hljs-built_in">open</span>(options.output, <span class="hljs-string">&quot;w&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    outfile = sys.stdout<br><br><span class="hljs-keyword">for</span> in_file <span class="hljs-keyword">in</span> args:<br>    blast_program = <span class="hljs-literal">None</span><br>    convert(in_file, outfile)<br><br><span class="hljs-keyword">if</span> options.output:<br>    outfile.close()<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-comment"># Using stdout</span><br>    <span class="hljs-keyword">pass</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>FuncAnno</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€FuncAnnoã€‘ã€eggNOG-mapperã€‘</title>
    <link href="/GeekFocus/2022/06/05/2022-06-05-FuncAnno-eggNOG/"/>
    <url>/GeekFocus/2022/06/05/2022-06-05-FuncAnno-eggNOG/</url>
    
    <content type="html"><![CDATA[<p>eggNOG(evolutionary genealogy of genes: Non-supervised Orthologous Groups)</p><span id="more"></span><h1 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs sh">github download<br>Download error on https://pypi.org/simple/: [Errno -3] Temporary failure <span class="hljs-keyword">in</span> name resolution -- Some packages may not be found!<br>No <span class="hljs-built_in">local</span> packages or working download links found <span class="hljs-keyword">for</span> xlsxwriter==1.4.3<br>error: Could not find suitable distribution <span class="hljs-keyword">for</span> Requirement.parse(<span class="hljs-string">&#x27;xlsxwriter==1.4.3&#x27;</span>)<br><br>loginal1 (loginal2 no internet)<br><span class="hljs-comment">#pip install xlsxwriter failed</span><br>pip install xlsxwriter==1.4.3<br>eggnog-mapper 2.1.7 requires biopython==1.76, <span class="hljs-built_in">which</span> is not installed.<br>eggnog-mapper 2.1.7 requires psutil==5.7.0, but you have psutil 5.8.0 <span class="hljs-built_in">which</span> is incompatible.<br><br>error: Could not find suitable distribution <span class="hljs-keyword">for</span> Requirement.parse(<span class="hljs-string">&#x27;psutil==5.7.0&#x27;</span>)<br>pip install psutil==5.7.0<br>pip install biopython==1.76<br><br>fat<br>python setup.py install<br>Using ~/miniconda3/lib/python3.9/site-packages<br>Finished processing dependencies <span class="hljs-keyword">for</span> eggnog-mapper==2.1.7<br><br>download db <br>http://eggnog5.embl.de/download/emapperdb-5.0.2/<br>http://eggnog5.embl.de/<span class="hljs-comment">#/app/downloads</span><br><span class="hljs-built_in">mv</span> to data<br>unzip<br><br><span class="hljs-built_in">export</span> PATH=/home/user/eggnog-mapper:/home/user/eggnog-mapper/eggnogmapper/bin:<span class="hljs-string">&quot;<span class="hljs-variable">$PATH</span>&quot;</span><br><span class="hljs-built_in">export</span> EGGNOG_DATA_DIR=/home/user/eggnog-mapper-data<br></code></pre></td></tr></table></figure><h1 id="github"><a href="#github" class="headerlink" title="github"></a>github</h1><h2 id="eggNOG-mapper-v2-1-5-to-v2-1-7"><a href="#eggNOG-mapper-v2-1-5-to-v2-1-7" class="headerlink" title="eggNOG mapper v2.1.5 to v2.1.7"></a>eggNOG mapper v2.1.5 to v2.1.7</h2><p><a href="https://github.com/eggnogdb/eggnog-mapper/wiki/eggNOG-mapper-v2.1.5-to-v2.1.7#Installation">https://github.com/eggnogdb/eggnog-mapper/wiki/eggNOG-mapper-v2.1.5-to-v2.1.7#Installation</a></p><p>overview</p><p><strong>EggNOG-mapper</strong> (a.k.a. <code>emapper.py</code> ) is a tool for fast functional annotation of novel sequences. It uses <font color="blue">precomputed orthologous groups (OGs)</font> and <font color="blue">phylogenies</font> from the <font color="blue">eggNOG db</font> (<a href="http://eggnogdb.embl.de/">http://eggnogdb.embl.de/</a>) to transfer functional information from fine-grained orthologs only. </p><p>Common uses of eggNOG-mapper include the annotation of <strong>novel genomes</strong>, <strong>transcriptomes</strong> or even <strong>metagenomic</strong> gene catalogs. </p><p>The use of orthology predictions for functional annotation permits a <font color="blue">higher precision[fewer results]</font> than <font color="blue">traditional homology searches</font> (i.e. BLAST searches), as it avoids transferring annotations from close paralogs (duplicate genes with a higher chance of being involved in functional divergence). </p><p>Benchmarks comparing <font color="red"><strong>different</strong></font> eggNOG-mapper options against <font color="red"><strong>BLAST and InterProScan</strong></font> are available at <a href="https://github.com/jhcepas/emapper-benchmark/blob/master/benchmark_analysis.ipynb">https://github.com/jhcepas/emapper-benchmark/blob/master/benchmark_analysis.ipynb</a>. </p><p>EggNOG-mapper is also available as a public online resource: <a href="http://eggnog-mapper.embl.de/">http://eggnog-mapper.embl.de</a></p><h2 id="storage-requirements"><a href="#storage-requirements" class="headerlink" title="storage requirements"></a>storage requirements</h2><ul><li>~40 GB for the eggNOG annotation databases (<em>eggnog.db</em> and <em>eggnog.taxa.db</em>)</li><li>~9 GB for Diamond database of eggNOG sequences (required if using <font color="red"><strong>-m diamond, which is the default search mode</strong></font>).</li><li><del>11 GB for MMseqs2 database of eggNOG sequences (</del>86 GB if MMseqs2 index is created) (required if using <code>-m mmseqs</code>).</li><li>~3 GB for PFAM database (required if using <code>--pfam_realign</code> options for realignment of queries to <font color="red">PFAM domains</font>).</li><li>The size of eggNOG diamond&#x2F;mmseqs databases created with <code>create_dbs.py</code> is highly variable, depending on the size of the chosen taxonomic groups.</li></ul><p>Databases for specific taxonomic ranges can be downloaded (for HMMER) or created (for Diamond and MMseqs2). The size of these databases is highly variable. For the size of HMMER databases, check <a href="http://eggnog5.embl.de/#/app/downloads">http://eggnog5.embl.de/#/app/downloads</a>. For Diamond and MMseqs2 databases, DB size will depend on the number of proteins which are from those taxonomic ranges. Also, these proteins need to be downloaded to create the databases, and can be removed afterwards.</p><h2 id="download-eggnog-data-py"><a href="#download-eggnog-data-py" class="headerlink" title="download_eggnog_data.py"></a>download_eggnog_data.py</h2><ul><li>The <code>-P</code> flag is required to download the PFAM database. you may wish to download the PFAM database to be able to run PFAM realignemnts with <code>--pfam_realign realign</code> or <code>--pfam_realign denovo</code>.</li><li>The <code>-M</code> flag is required to download the MMseqs2 database. The whole MMseqs2 database includes eggNOG proteins which do not belong to any eggNOG Orthologous Group (OG), whereas the Diamond database only includes those which belong to an OG. Also, note that no MMseqs2 index is provided. To create it, you could use the <code>mmseqs createindex &quot;$EGGNOG_DATA_DIR&quot;/mmseqs tmp</code> command (see <a href="https://mmseqs.com/latest/userguide.pdf">https://mmseqs.com/latest/userguide.pdf</a> for more details).</li><li>The <code>-H -d taxID</code> flag is required to download a HMMER database for a given <em>taxID</em> (check list of databases at <a href="http://eggnog5.embl.de/#/app/downloads">http://eggnog5.embl.de/#/app/downloads</a>).</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">./download_eggnog_data.py -H -d euk<br>Skipping eggnog.db database (already present). Use -f to force download<br>Skipping eggnog.taxa.db database (already present). Use -f to force download<br>Skipping diamond database (or already present). Use -f to force download<br>Skipping Pfam database (or already present). Use -P and -f to force download<br>Skipping MMseqs2 database (or already present). Use -M and -f to force download<br>Download HMMER database of tax ID euk? [y,n] <br><br></code></pre></td></tr></table></figure><h2 id="option-tools"><a href="#option-tools" class="headerlink" title="option tools"></a>option tools</h2><p>all of them are actually included, bundled, along with eggNOG-mapper. </p><ul><li>Prodigal: required if using <code>--itype genome</code> or <code>--itype metagenome</code> along with the option <code>--genepred prodigal</code>. Current bundled version is V2.6.3: February, 2016.</li><li>Diamond: required to run the search steps with <code>-m diamond</code>. Current bundled version is 2.0.11.</li><li>MMseqs2: required to run the search steps with <code>-m mmseqs</code>. </li><li>HMMER: required to run the search steps with <code>-m hmmer</code>, to run the HMMER based scripts (<code>hmm_mapper.py</code>, <code>hmm_server.py</code>, <code>hmm_worker.py</code>), and to perform realignments to PFAM with <code>--pfam_realign realign</code> or <code>--pfam_realign denovo</code>. Current bundled version is HMMER 3.1b2 (February 2015).</li></ul><p>first search in PATH, then use bundled ones.</p><h2 id="Basic-usage"><a href="#Basic-usage" class="headerlink" title="Basic usage"></a>Basic usage</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">emapper.py -i FASTA_FILE_PROTEINS -o <span class="hljs-built_in">test</span><br></code></pre></td></tr></table></figure><p>This basic example will run a <font color="red"><strong>diamond blastp search</strong></font>, and for those queries with hits to eggNOG proteins, will carry out functional annotation.</p><p>- Run <font color="blue">search and annotation</font>, using <font color="blue">Diamond in blastx</font> mode</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">emapper<span class="hljs-selector-class">.py</span> -m diamond <span class="hljs-attr">--itype</span> CDS -<span class="hljs-selector-tag">i</span> FASTA_FILE_NTS -o test<br></code></pre></td></tr></table></figure><p>- Run<font color="blue"> search and annotation</font>, using <font color="blue">MMseqs after translating input CDS to proteins</font>. Add the search and annotation results to the attributes of an existing GFF file (<em>GFF decoration</em>), using the <em>GeneID</em> field to link features from the GFF to the annotation results.</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">emapper<span class="hljs-selector-class">.py</span> -m mmseqs <span class="hljs-attr">--itype</span> CDS <span class="hljs-attr">--translate</span> -<span class="hljs-selector-tag">i</span> FASTA_FILE_CDS -o test \<br><span class="hljs-attr">--decorate_gff</span> MY_GFF_FILE <span class="hljs-attr">--decorate_gff_ID_field</span> GeneID<br></code></pre></td></tr></table></figure><p>- Run <strong>search</strong> and <strong>annotation</strong> for <strong>assembled contigs</strong>, using <strong>MMseqs2 â€œblastxâ€</strong> hits for <strong>gene prediction</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">emapper<span class="hljs-selector-class">.py</span> -m mmseqs <span class="hljs-attr">--itype</span> metagenome -<span class="hljs-selector-tag">i</span> FASTA_FILE_NTS -o test<br></code></pre></td></tr></table></figure><p>- Run <strong>search</strong> and <strong>annotation</strong> for a <strong>genome</strong>, using <strong>Diamond search</strong> on proteins <strong>predicted by Prodigal</strong>, changing the output directory.</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">emapper<span class="hljs-selector-class">.py</span> -m diamond <span class="hljs-attr">--itype</span> genome <span class="hljs-attr">--genepred</span> prodigal \<br>-<span class="hljs-selector-tag">i</span> FASTA_FILE_NTS -o test <span class="hljs-attr">--output_dir</span> /home/me/mydir<br></code></pre></td></tr></table></figure><p>- Run gene prediction using a genome to train Prodigal</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">emapper<span class="hljs-selector-class">.py</span> -m mmseqs <span class="hljs-attr">--itype</span> genome <span class="hljs-attr">--genepred</span> prodigal -<span class="hljs-selector-tag">i</span> FASTA_FILE_NTS -o test \<br><span class="hljs-attr">--training_genome</span> FASTA_FILE <span class="hljs-attr">--training_file</span> OUT_TRAIN_FILE<br></code></pre></td></tr></table></figure><p>- Perform a 2-step (search + annotation) run, using Diamond in <em>more-sensitive</em> mode and loading the annotation DB into memory (â€“dbmem; requires ~44 GB free mem)</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">emapper<span class="hljs-selector-class">.py</span> -m diamond <span class="hljs-attr">--sensmode</span> more-sensitive <span class="hljs-attr">--no_annot</span> -<span class="hljs-selector-tag">i</span> FASTA_FILE_PROTS -o test<br><br>emapper<span class="hljs-selector-class">.py</span> -m no_search <span class="hljs-attr">--annotate_hits_file</span> test<span class="hljs-selector-class">.emapper</span><span class="hljs-selector-class">.seed_orthologs</span> -o test_annot_1 <span class="hljs-attr">--dbmem</span><br></code></pre></td></tr></table></figure><p>- Repeat the annotation step, using specific taxa as target and reporting the one-to-one orthologs found</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">emapper<span class="hljs-selector-class">.py</span> -m no_search <span class="hljs-attr">--annotate_hits_file</span> test<span class="hljs-selector-class">.emapper</span><span class="hljs-selector-class">.seed_orthologs</span> -o test_annot_2 <span class="hljs-attr">--dbmem</span> \<br><span class="hljs-attr">--report_orthologs</span> <span class="hljs-attr">--target_orthologs</span> one2one <span class="hljs-attr">--target_taxa</span> <span class="hljs-number">72274</span>,<span class="hljs-number">1123487</span><br></code></pre></td></tr></table></figure><p>- Use <strong>HMMER</strong> to search a database of bacterial proteins, using current directory for temporary files, and using a â€œscratchâ€ directory to write output on a different hard drive than the one used to read. Once emapper.py finishes, output files in the scratch dir will be moved to the actual output dir, and the scratch dir will be removed.</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">emapper<span class="hljs-selector-class">.py</span> -m hmmer -d bact -<span class="hljs-selector-tag">i</span> FASTA_FILE_PROTS -o test <span class="hljs-attr">--scratch_dir</span> /scratch/test <span class="hljs-attr">--temp_dir</span> .<br></code></pre></td></tr></table></figure><p>- Perform a <strong>Diamond search,</strong> and annotation also realigning queries to the <strong>PFAM domains found on the Orthologous Groups</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">emapper<span class="hljs-selector-class">.py</span> -<span class="hljs-selector-tag">i</span> FASTA_FILE_PROTS -o test <span class="hljs-attr">--pfam_realign</span> realign<br></code></pre></td></tr></table></figure><p>- Perform a <strong>Diamond search</strong>, and annotation also realigning queries to the whole PFAM database</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">emapper<span class="hljs-selector-class">.py</span> -<span class="hljs-selector-tag">i</span> FASTA_FILE_PROTS -o test <span class="hljs-attr">--pfam_realign</span> denovo<br></code></pre></td></tr></table></figure><p>- Perform a Diamond search and annotation, constraining the Orthologous Groups from which to retrieve annotations to the <em>Bacteria</em> taxon:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">emapper<span class="hljs-selector-class">.py</span> -<span class="hljs-selector-tag">i</span> FASTA_FILE_PROTS -o test <span class="hljs-attr">--tax_scope</span> Bacteria<br></code></pre></td></tr></table></figure><p>- Perform a Diamond search and annotation, constraining the Orthologous Groups from which to retrieve annotations to a predefined tax scope (defined in the file <code>eggnogmapper/annotation/tax_scopes/bacteria</code>) for Bacteria and its descendants. The difference with the previous example is that here the <em>bacteria</em> file used as tax scope contains a list of taxa instead of only <em>Bacteria</em>. If several OGs intersect with the scope, for a given protein, the narrowest will be used to transfer annotations to the query:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">emapper<span class="hljs-selector-class">.py</span> -<span class="hljs-selector-tag">i</span> FASTA_FILE_PROTS -o test <span class="hljs-attr">--tax_scope</span> bacteria<br></code></pre></td></tr></table></figure><p>- Perform a Diamond search and annotation, constraining the Orthologous Groups from which to retrieve annotations to the <em>Gammaproteobacteria</em> tax scope. Also, from those OGs, force to retrieve annotations at the <em>Bacteria</em> level:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">emapper<span class="hljs-selector-class">.py</span> -<span class="hljs-selector-tag">i</span> FASTA_FILE_PROTS -o test <span class="hljs-attr">--tax_scope</span> Gammaproteobacteria <span class="hljs-attr">--tax_scope_mode</span> Bacteria<br></code></pre></td></tr></table></figure><h1 id="æ–‡æ¡£1"><a href="#æ–‡æ¡£1" class="headerlink" title="æ–‡æ¡£1"></a>æ–‡æ¡£1</h1><h2 id="åŒæº"><a href="#åŒæº" class="headerlink" title="åŒæº"></a>åŒæº</h2><p><strong>åŒæºï¼ˆHomologs</strong>ï¼‰ï¼šæ¥æºäºå…±åŒç¥–å…ˆçš„ç›¸ä¼¼åºåˆ—ä¸ºåŒæºåºåˆ—ã€‚ç›¸ä¼¼åºåˆ—æœ‰ä¸¤ç§ï¼Œæ¥æºäºå…±åŒç¥–å…ˆå¯ä»¥å«åŒæºï¼Œä¸æ¥æºäºå…±åŒç¥–å…ˆå°½ç®¡ç›¸ä¼¼ä¹Ÿä¸èƒ½å«åŒæºã€‚ç¬¬äºŒç§æƒ…å†µæ¦‚ç‡è™½ä½ä½†å­˜åœ¨ï¼Œæ‰€ä»¥<strong>ç›¸ä¼¼åºåˆ—å¹¶ä¸ä¸€å®šæ˜¯åŒæºåºåˆ—</strong>ã€‚åŒæºåˆåˆ†ä¸ºä¸‰ç§ï¼Œ<strong>ç›´ç³»åŒæº</strong>ï¼Œ<strong>æ—ç³»åŒæº</strong>å’Œ<strong>å¼‚åŒæº</strong>ã€‚åŒæºåªæ˜¯å¯¹æ€§è´¨çš„ä¸€ç§åˆ¤å®šï¼Œåªèƒ½å®šæ€§æè¿°ï¼Œä¸èƒ½å®šé‡ã€‚</p><p><strong>ç›´ç³»åŒæºï¼ˆOrthologsï¼‰</strong>æ˜¯æŒ‡æ¥è‡ªäºä¸åŒç‰©ç§çš„ç”±å‚ç›´å®¶ç³»ï¼Œä¹Ÿå°±æ˜¯ç‰©ç§å½¢æˆï¼Œè¿›åŒ–è€Œæ¥çš„åŸºå› ï¼Œå¹¶ä¸”å…¸å‹çš„ä¿ç•™ä¸åŸå§‹åŸºå› ç›¸åŒçš„åŠŸèƒ½ã€‚éšç€è¿›åŒ–åˆ†æ”¯ï¼Œä¸€ä¸ªåŸºå› è¿›å…¥äº†ä¸åŒçš„ç‰©ç§ï¼Œå¹¶ä¿ç•™äº†åŸæœ‰åŠŸèƒ½ã€‚è¿™æ—¶ï¼Œä¸åŒç‰©ç§ä¸­çš„è¿™ä¸ªåŸºå› å°±å±äºç›´ç³»åŒæºã€‚ <strong>Orthologous genes</strong> <em>(or orthologs) are a particular class of homologous genes. They are found in different species and have diverged following the speciation of the species hosting them. Therefore, orthologous genes in different species derive from a common ancestral gene found in the ancestor of those species.</em></p><p><strong>æ—ç³»åŒæºï¼ˆParalogsï¼‰</strong>æ˜¯æŒ‡åœ¨åŒä¸€ç‰©ç§ä¸­çš„æ¥æºäº<strong>åŸºå› å¤åˆ¶</strong>çš„åŸºå› ï¼Œå¯èƒ½ä¼šè¿›åŒ–å‡ºæ–°çš„ä½†ä¸åŸåŠŸèƒ½ç›¸å…³çš„åŠŸèƒ½ã€‚</p><p><strong>å¼‚åŒæºï¼ˆXenologsï¼‰</strong>æ˜¯æŒ‡é€šè¿‡æ°´å¹³åŸºå› è½¬ç§»ï¼Œæ¥æºäº<strong>å…±ç”Ÿæˆ–ç—…æ¯’ä¾µæŸ“</strong>æ‰€äº§ç”Ÿçš„ç›¸ä¼¼åŸºå› ã€‚å¼‚åŒæºçš„äº§ç”Ÿä¸æ˜¯å‚ç›´è¿›åŒ–è€Œæ¥çš„ï¼Œä¹Ÿä¸æ˜¯å¹³è¡Œå¤åˆ¶äº§ç”Ÿçš„ï¼Œè€Œæ˜¯ç”±äº<strong>åŸæ ¸ç”Ÿç‰©ä¸çœŸæ ¸ç”Ÿç‰©çš„æ¥è§¦</strong>ï¼Œæ¯”å¦‚ç—…æ¯’æ„ŸæŸ“ï¼Œåœ¨è·¨åº¦å·¨å¤§çš„ç‰©ç§é—´è·³è·ƒè½¬ç§»äº§ç”Ÿçš„ã€‚</p><p><strong>ä¸ºä»€ä¹ˆè¯´æ—ç³»åŒæºæ²¡æœ‰å…±è¿›åŒ–ä¿¡æ¯å‘¢</strong>ï¼Œåœ¨è¿›åŒ–èµ·æºä¸Šï¼Œç›´ç³»åŒæºæ˜¯å¼ºè°ƒåœ¨ä¸åŒåŸºå› ç»„ä¸­çš„å‚ç›´ä¼ é€’ï¼Œæ—ç³»åŒæºåˆ™æ˜¯åœ¨åŒä¸€åŸºå› ç»„ä¸­çš„æ¨ªå‘åŠ å€ï¼›åœ¨åŠŸèƒ½ä¸Šï¼Œ<strong>ç›´ç³»åŒæºè¦æ±‚åŠŸèƒ½é«˜åº¦ç›¸ä¼¼</strong>ï¼Œè€Œ<strong>æ—ç³»åŒæºåœ¨å®šä¹‰ä¸Šå¯¹åŠŸèƒ½ä¸Šæ²¡æœ‰ä¸¥æ ¼è¦æ±‚ï¼Œå¯èƒ½ç›¸ä¼¼ï¼Œä½†ä¹Ÿå¯èƒ½å¹¶ä¸ç›¸ä¼¼</strong>(å°½ç®¡ç»“æ„ä¸Šå…·ä¸€å®šç¨‹åº¦çš„ç›¸ä¼¼)ï¼Œç”šè‡³äºæ²¡æœ‰åŠŸèƒ½(å¦‚åŸºå› å®¶æ—ä¸­çš„å‡åŸºå› )ã€‚</p><p>å³ <strong>co-evolution æ˜¯åœ¨ä¸åŒç‰©ç§çš„åŒæºåºåˆ—ï¼ŒæŸä¸€ä¸ªä½ç‚¹å‘ç”Ÿäº†æŸç§å˜åŒ–ï¼Œä¸ºäº†ç»´æŒä¹‹å‰çš„å½¢çŠ¶å’ŒåŠŸèƒ½ï¼Œç›¸åº”çš„ä½ç‚¹ä¹Ÿå‘ç”Ÿäº†ç›¸åº”çš„å˜åŒ–ï¼Œè¿™å°±æ˜¯å…±è¿›åŒ–ã€‚å³ç›´ç³»åŒæºå¯ä»¥å¾—åˆ°å…±è¿›åŒ–ä¿¡æ¯ï¼Œä½†æ˜¯æ—ç³»åŒæºç›´æ¥è¿åŸå§‹çš„å½¢çŠ¶å’ŒåŠŸèƒ½éƒ½ä¸åœ¨ä¹äº†ï¼Œå¤±å»äº†æˆ–è€…è¯´æ²¡æœ‰é‚£ä¹ˆä¿å®ˆï¼Œé‚£ä¹ˆæ—ç³»åŒæºåºåˆ—è‡ªç„¶å°±ä½“ç°ä¸å‡ºæ¥å…±è¿›åŒ–ä¿¡æ¯ã€‚</strong></p><h2 id="eggNOG-Mapperä»‹ç»"><a href="#eggNOG-Mapperä»‹ç»" class="headerlink" title="eggNOG-Mapperä»‹ç»"></a>eggNOG-Mapperä»‹ç»</h2><p>é€šå¸¸åŠŸèƒ½æ³¨é‡Šçš„æ€è·¯éƒ½æ˜¯åŸºäºåºåˆ—ç›¸ä¼¼æ€§æ‰¾ç›´ç³»åŒæºåŸºå› ï¼Œå¸¸ç”¨æ–¹æ³•æ˜¯BLAST+BLAST2GOï¼Œ æˆ–InterProScanã€‚eggNOG-mapperè®¤ä¸ºè¿™ç§æ–¹æ³•ä¸å¤Ÿå¯é ï¼Œæ¯•ç«Ÿæœ‰å¯èƒ½æ‰¾åˆ°çš„æ˜¯æ—ç³»åŒæºåŸºå› ã€‚å¯¹å¤šä¸ªå·¥å…·çš„æ•´ä½“è¯„ä¼°å‘ç°<font color="red">eggNOG(evolutionary genealogy of genes: Non-supervised Orthologous Groups)</font>åœ¨åŒºåˆ†æ—ç³»åŒæºåŸºå› å’Œç›´ç³»åŒæºåŸºå› ä¸Šè¾ƒä¼˜ï¼ŒåŸºäºeggNOGæ•°æ®åº“å¼€å‘<code>eggNOG-mapper</code>å·¥å…·ï¼Œç”¨äºå¯¹æ–°åºåˆ—åŠŸèƒ½æ³¨é‡Šã€‚</p><p><code>eggNOG-mapper</code>ç®—æ³•ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼š<font color="red">åºåˆ—æ¯”å¯¹</font>ã€‚é¦–å…ˆï¼Œæ¯æ¡è›‹ç™½åºåˆ—ç”¨HMMER3åœ¨æ•´ç†çš„eggNOGåº“ä¸­æœç´¢ã€‚ç”±äºæ¯ä¸ªHMMåŒ¹é…éƒ½å’Œä¸€ä¸ªåŠŸèƒ½æ³¨é‡Šçš„eggNOG OGå¯¹åº”ï¼Œè¿™ä¸€æ­¥å°±æä¾›åˆæ­¥çš„æ³¨é‡Šä¿¡æ¯ã€‚ä¹‹åï¼Œæ¯æ¡è›‹ç™½åºåˆ—ç”¨<code>phmmer</code>åœ¨æœ€ä½³åŒ¹é…çš„HMMå¯¹åº”çš„ä¸€ç»„eggNOGè›‹ç™½ä¸­è¿›ä¸€æ­¥æœç´¢ã€‚æœ€åï¼Œæ¯æ¡åºåˆ—çš„<font color="red">æœ€ä½³åŒ¹é…ç»“æœä»¥ <strong>seed ortholog</strong> å½¢å¼å­˜æ”¾</font>ï¼Œç”¨äºè·å–å…¶ä»–ç›´ç³»åŒæºåŸºå› ã€‚ç›®å‰eggNOG HMMæ•°æ®åº“ä¸­æ‹¥æœ‰1,911,745ä¸ªOGï¼Œè¦†ç›–äº†1,678ç§ç»†èŒ,115ç§å¤ç»†èŒï¼Œ238ç§çœŸæ ¸ç‰©ç§ä»¥åŠ352ç§ç—…æ¯’ã€‚é™¤HMMER3å¤–ï¼Œè¿˜å¯ç”¨DIAMONDç›´æ¥å¯¹æ‰€æœ‰çš„eggNOGè›‹ç™½åºåˆ—è¿›è¡Œæœç´¢ï¼Œå®ƒçš„é€Ÿåº¦æ›´å¿«ï¼Œé€‚åˆç±»ä¼¼äºå®åŸºå› ç»„è¿™ç±»å¤§æ•°æ®é›†ï¼Œæˆ–è€…æ˜¯å·²æœ‰ç‰©ç§å’ŒeggNOGæ‰€æ”¶é›†çš„ç‰©ç§æ¯”è¾ƒè¿‘ã€‚å½“ç„¶æœåŠ¡å™¨æ€§èƒ½å¼ºå¤§çš„è¯ï¼Œè¿˜æ˜¯æœ‰é™é€‰æ‹©HMMER3.</p><p><img src="/GeekFocus/2022-06-05-FuncAnno-eggNOG/1.png" alt="2"></p><p><img src="/GeekFocus/img/2022-06-05-FuncAnno-eggNOG/1.png" alt="2"></p><p><strong>step1: åºåˆ—æ¯”å¯¹</strong></p><p>ç¬¬äºŒæ­¥ï¼šæ¨æµ‹ç›´ç³»åŒæºåŸºå› ã€‚æ¯ä¸ªç”¨äºæ£€ç´¢çš„è›‹ç™½åºåˆ—çš„æœ€ä½³åŒ¹é…åºåˆ—ä¼šå¯¹åº”eggNOGçš„ä¸€ä¸ªè›‹ç™½, è¿™äº›è›‹ç™½åŸºäºé¢„åˆ†æçš„eggNOGè¿›åŒ–æ ‘æ•°æ®åº“ä¼šæå–ä¸€ç»„æ›´åŠ ç²¾ç»†çš„ç›´ç³»åŒæºåŸºå› ã€‚è¿™ä¸€æ­¥è¿˜ä¼šæ ¹æ®bit-screoæˆ–E-valueå¯¹ç»“æœè¿›è¡Œä¸€æ¬¡è¿‡æ¥ï¼Œ<strong>å‰”é™¤</strong>åŒæºæ€§ä¸é«˜çš„ç»“æœ</p><p><img src="/GeekFocus/2022-06-05-FuncAnno-eggNOG/2.png" alt="2"></p><p><img src="/GeekFocus/img/2022-06-05-FuncAnno-eggNOG/2.png" alt="2"></p><p><strong>step2: æ¨æµ‹ç›´ç³»åŒæºåŸºå› </strong></p><p>ç¬¬ä¸‰æ­¥ï¼šåŠŸèƒ½æ³¨é‡Šã€‚ç”¨äºæœç´¢çš„è›‹ç™½åºåˆ—å¯¹åº”çš„ç›´ç³»åŒæºåŸºå› çš„åŠŸèƒ½æè¿°å°±æ˜¯æœ€ç»ˆçš„æ³¨é‡Šç»“æœã€‚æ¯”å¦‚è¯´GO, KEGG, COGç­‰ã€‚</p><p><img src="/GeekFocus/2022-06-05-FuncAnno-eggNOG/3.png" alt="2"></p><p><img src="/GeekFocus/img/2022-06-05-FuncAnno-eggNOG/3.png" alt="2"></p><p><strong>step3: åŠŸèƒ½æ³¨é‡Š</strong></p><h2 id="å…·ä½“ç”¨æ³•"><a href="#å…·ä½“ç”¨æ³•" class="headerlink" title="å…·ä½“ç”¨æ³•"></a>å…·ä½“ç”¨æ³•</h2><p><code>eggnog-mapper</code>ç”¨æ³•ç®€å•ï¼Œéœ€æä¾›è›‹ç™½åºåˆ—ä½œä¸ºè¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">python emapper.py -i <span class="hljs-built_in">test</span>/p53.fa --output p53_maNOG -d euk<br>python emapper.py -i <span class="hljs-built_in">test</span>/p53.fa --output p53_maNOG -d maNOG<br>python emapper.py -i <span class="hljs-built_in">test</span>/p53.fa --output p53_maNOG -d maNOG --usemem --cpu 10<br></code></pre></td></tr></table></figure><p><code>eggnog-mapper</code>é»˜è®¤æ˜¯ä»¥HMMERè¿›è¡Œåºåˆ—æœç´¢ï¼Œå°½ç®¡å¯ä»¥é€šè¿‡<code>-m diamond</code>æ›´æ”¹æˆDIAMONDï¼Œä½†ç»“æœä¸­å°±ä¼šç¼ºå°‘ä¸€äº›ä¿¡æ¯åˆ—ã€‚HMMçš„æœç´¢å‚æ•°ï¼Œæœ‰<code>--hmm_maxhits</code>, <code>--hmm_evalue</code>, <code>--hmm_score</code>, <code>--hmm_qcov</code>å’Œ<code>--Z</code>, ä¸€èˆ¬é»˜è®¤ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">-d/--database <span class="hljs-comment">#`è¡¨ç¤ºæœç´¢æ•°æ®åº“çš„ç±»å‹ï¼Œæ—¢å¯ä»¥æ˜¯&quot;euk, bact, arch&quot; ä¸‰å¤§ç±»çš„å…¶ä¸­ä¸€ç§ï¼Œä¹Ÿå¯ä»¥æ˜¯&quot;eggnog-mapper/data/OG_fasta&quot;ä¸­çš„å°ç±»ï¼Œä¾‹å¦‚&quot;maNOG&quot;è¡¨ç¤ºçš„å°±æ˜¯å“ºä¹³åŠ¨ç‰©çš„NOGã€‚æ­¤å¤–ä¹Ÿå¯ä»¥æ˜¯è‡ªå®šä¹‰HMMæ•°æ®åº“ï¼Œ `-d /path/to/pfam.hmm</span><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh">-m MODE <span class="hljs-comment">#how input queries will be searched against eggNOG sequences. Default is -m diamond</span><br><span class="hljs-comment">#diamond, hmmer(HMMER), mmseqs(MMseqs2), diff options</span><br>--usemem <span class="hljs-comment">#å†…å­˜</span><br>--cpu <span class="hljs-comment">#çº¿ç¨‹</span><br>--output <span class="hljs-comment"># è¾“å‡ºæ–‡ä»¶å‰ç¼€,é»˜è®¤è¾“å‡ºåœ¨å½“å‰æ–‡ä»¶å¤¹</span><br>--output_dir <span class="hljs-comment"># è¾“å‡ºæ–‡ä»¶è·¯å¾„</span><br>--resume <span class="hljs-comment">#ä»»åŠ¡é‡å¯åè·³è¿‡ä¹‹å‰å·²ç»å®Œæˆéƒ¨åˆ†</span><br>--override <span class="hljs-comment"># è¦†ç›–åŸå…ˆè¾“å‡ºç»“æœ</span><br><span class="hljs-comment">#--other</span><br>--list_taxa <span class="hljs-comment">#List available taxonomic names and IDs for OGs and exitï¼ŒThese are valid tax names and IDs for --tax_scope/--tax_scope_mode</span><br>--itype INPUT_TYPE <span class="hljs-comment">#Type of sequences in the input (-i) file. Default is --itype proteins. All INPUT_TYPE options are shown the next table:CDSï¼Œgenomeï¼Œmetagenome</span><br><br></code></pre></td></tr></table></figure><ul><li><code>-m MODE</code></li><li>how input queries will be searched against eggNOG sequences. Default is -m diamond. All MODE options are shown in the next table:</li></ul><table><thead><tr><th><em>MODE</em></th><th>description</th><th>Notes</th></tr></thead><tbody><tr><td><em>diamond</em></td><td>search queries against eggNOG sequences using Diamond.</td><td>Requires <code>-i FILE</code>.</td></tr><tr><td><em>hmmer</em></td><td>search sequences&#x2F;hmm against sequences&#x2F;hmm using HMMER.</td><td>Requires <code>-i FILE</code> and <code>-d DB_NAME</code>.</td></tr><tr><td><em>mmseqs</em></td><td>search queries against eggNOG sequences using MMseqs2.</td><td>Requires <code>-i FILE</code>.</td></tr><tr><td><em>cache</em></td><td>annotate queries using a previously annotated file (<code>-c</code>) which includes md5 hashes of the annotated sequences.</td><td>Requires <code>-i FILE</code> and <code>-c FILE</code>.</td></tr><tr><td><em>no_search</em></td><td>skip search stage. Annotate an existing <em>emapper.seed_orthologs</em> file.</td><td>Requires <code>--annotate_hits_table FILE</code>, unless <code>--no_annot</code> is used.</td></tr></tbody></table><ul><li>Common search options; diamond search options; MMseqs2 search options; HMMER search options</li></ul><h2 id="ç»“æœè§£è¯»"><a href="#ç»“æœè§£è¯»" class="headerlink" title="ç»“æœè§£è¯»"></a>ç»“æœè§£è¯»</h2><p>eggnog-mapperä¼šç”Ÿæˆä¸‰ä¸ªæ–‡ä»¶ï¼Œ</p><ul><li><code>[project_name].emapper.hmm_hits</code>: è®°å½•æ¯ä¸ªç”¨äºæœç´¢åºåˆ—å¯¹åº”çš„æ‰€æœ‰çš„æ˜¾è‘—æ€§çš„eggNOG Orthologous Groups(OG). æ‰€æœ‰æ ‡è®°ä¸ºâ€-â€œåˆ™è¡¨æ˜è¯¥åºåˆ—æœªæ‰¾åˆ°å¯èƒ½çš„OG . A file with the results from the search phase, from HMMER, Diamond or MMseqs2.</li><li><code>[project_name].emapper.seed_orthologs</code>: è®°å½•æ¯ä¸ªç”¨äºæœç´¢åºåˆ—å¯¹çš„çš„æœ€ä½³çš„OGï¼Œä¹Ÿå°±æ˜¯<code>[project_name].emapper.hmm_hits</code>é‡Œé€‰æ‹©å¾—åˆ†æœ€é«˜çš„ç»“æœã€‚ä¹‹åä¼šä»eggNOGä¸­æå–æ›´ç²¾ç»†çš„ç›´ç³»åŒæºå…³ç³»(orthology relationships). A file with the results from parsing the hits. Each row links a query with a seed ortholog. This file has the same format independently of which searcher was used, except that it can be in short format (4 fields), or full.</li><li><code>[project_name].emapper.annotations</code>: è¯¥æ–‡ä»¶æä¾›äº†æœ€ç»ˆçš„æ³¨é‡Šç»“æœã€‚å¤§éƒ¨åˆ†éœ€è¦çš„å†…å®¹éƒ½å¯ä»¥é€šè¿‡å†™è„šæœ¬ä»ä»æå–ï¼Œä¸€å…±æœ‰13åˆ—ã€‚A file with the results from the annotation phase. Therefore, each row represents the annotation reported  for a given query.</li></ul><h2 id="annotation-files"><a href="#annotation-files" class="headerlink" title="annotation files"></a>annotation files</h2><p><code>[project_name].emapper.annotations</code>æ¯ä¸€åˆ—å¯¹åº”çš„è®°å½•å¦‚ä¸‹ï¼š</p><ol><li><code>query_name</code>: æ£€ç´¢çš„åŸºå› åæˆ–è€…å…¶ä»–ID</li><li><code>sedd_eggNOG_ortholog</code>: eggNOGä¸­æœ€ä½³çš„è›‹ç™½åŒ¹é…</li><li><code>seed_orholog_evalue</code>: æœ€ä½³åŒ¹é…çš„e-value</li><li><code>seed_ortolog_evalu</code>: æœ€ä½³åŒ¹é…çš„bit-score</li><li><code>predicted_gene_name</code>: é¢„æµ‹çš„åŸºå› åï¼Œç‰¹åˆ«æŒ‡çš„æ˜¯ç±»ä¼¼AP2æœ‰ä¸€å®šå«ä¹‰çš„åŸºå› åï¼Œè€Œä¸æ˜¯AT2G17950è¿™ç±»ç¼–å·</li><li><code>GO_term</code>: æ¨æµ‹çš„GOçš„è¯æ¡ï¼Œ æœªå¿…æœ€æ–°</li><li><code>KEGG_KO</code>: æ¨æµ‹çš„KEGG KOè¯æ¡ï¼Œ æœªå¿…æœ€æ–°</li><li><code>BiGG_Reactions</code>: BiGGä»£è°¢ååº”çš„é¢„æµ‹ç»“æœ</li><li><code>Annotation_tax_scope</code>: å¯¹è¯¥åºåˆ—åœ¨åˆ†ç±»èŒƒå›´çš„æ³¨é‡Š</li><li><code>Matching_OGs</code>: åŒ¹é…çš„eggNOG Orthologous Groups</li><li><code>best_OG|evalue|score</code>: æœ€ä½³åŒ¹é…çš„OG(HMMæ¨¡å¼æ‰æœ‰)</li><li><code>COG functional categories</code>: ä»æœ€ä½³åŒ¹é…çš„OGä¸­æ¨æµ‹å‡ºçš„COGåŠŸèƒ½åˆ†ç±»</li><li><code>eggNOG_HMM_model_annotation</code>: ä»æœ€ä½³åŒ¹é…çš„OGä¸­æ¨æµ‹å‡ºeggNOGåŠŸèƒ½æè¿°</li></ol><p>å¦‚æœæ‰“ç®—åšå¯Œé›†åˆ†æï¼Œç”¨å‘½ä»¤è¡Œçš„cut&#x2F;awkæå–å¯¹åº”çš„åˆ—ï¼Œè¿‡æ»¤æ‰å…¶ä¸­æœªæ³¨é‡Šçš„éƒ¨åˆ†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>FuncAnno</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/GeekFocus/2022/06/05/hello-world/"/>
    <url>/GeekFocus/2022/06/05/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Database</title>
    <link href="/GeekFocus/2022/05/29/2022-05-29-BioDatabase/"/>
    <url>/GeekFocus/2022/05/29/2022-05-29-BioDatabase/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="ä¸€ã€æ ¸é…¸æ•°æ®åº“"><a href="#ä¸€ã€æ ¸é…¸æ•°æ®åº“" class="headerlink" title="ä¸€ã€æ ¸é…¸æ•°æ®åº“"></a>ä¸€ã€æ ¸é…¸æ•°æ®åº“</h1><h2 id="NCBI"><a href="#NCBI" class="headerlink" title="NCBI"></a><strong>NCBI</strong></h2><p>NCBI (National Center for Biotechnology Informationï¼‰æ˜¯ç¾å›½å›½ç«‹ç”Ÿç‰©æŠ€æœ¯ä¿¡æ¯ä¸­å¿ƒæ„å»ºçš„ç”Ÿä¿¡æ•°æ®åº“ï¼Œç›®å‰æœ€å…¨é¢çš„æ•°æ®åº“ã€‚</p><h2 id="EMBL"><a href="#EMBL" class="headerlink" title="EMBL"></a>EMBL</h2><p>æ¬§æ´²åˆ†å­ç”Ÿç‰©å­¦å®éªŒå®¤EMBLï¼ˆThe European Molecular Biology Laboratoryï¼‰ï¼Œç›®å‰è›‹ç™½è´¨ä¿¡æ¯æœ€å…¨éƒ¨çš„æ•°æ®åº“UniProtå°±æ˜¯ä»–å®¶å¼€å‘çš„ã€‚ </p><h2 id="DDBJ"><a href="#DDBJ" class="headerlink" title="DDBJ"></a>DDBJ</h2><p>DDBJ (DNA Data Bank of Japan)ï¼Œäº1984å¹´å»ºç«‹ï¼Œæ˜¯ä¸–ç•Œä¸‰å¤§DNA æ•°æ®åº“ä¹‹ä¸€ï¼Œä¸NCBIçš„GenBankï¼ŒEMBLçš„EBIæ•°æ®åº“å…±åŒç»„æˆå›½é™…DNAæ•°æ®åº“ ã€‚è¯¥æ•°æ®åº“æœ€ä¸ºå¸¸ç”¨çš„å°±æ˜¯ä»–å®¶çš„KEGGé€šè·¯æ•°æ®åº“ã€‚</p><h2 id="CNGB"><a href="#CNGB" class="headerlink" title="CNGB"></a>CNGB</h2><p>ä¸­å›½å›½å®¶æ•°æ®åº“ï¼ˆChina National GeneBankï¼‰ä½äºæ·±åœ³å¤§é¹æ–°åŒºï¼Œæ˜¯ç»§ä¸–ç•Œä¸‰å¤§æ•°æ®åº“ä¹‹åçš„å…¨çƒç¬¬å››å¤§å›½å®¶çº§æ•°æ®åº“ã€‚å®ƒæ˜¯ä¸­å›½é¦–ä¸ªï¼Œä¹Ÿæ˜¯å”¯ä¸€ä¸€ä¸ªå›½å®¶åŸºå› åº“ï¼Œç›¸å¯¹äºå…¨çƒå¦å¤–ä¸‰ä¸ªåŸºå› åº“è€Œè¨€ï¼Œå›½å®¶åŸºå› åº“æ ·å“ä¿å­˜çš„è§„æ¨¡ã€å­˜å‚¨é‡å’Œå¯è®¿é—®çš„æ•°æ®é‡çš†æ˜¯å…¨çƒæœ€å¤§ã€‚ </p><h2 id="BIGD"><a href="#BIGD" class="headerlink" title="BIGD"></a>BIGD</h2><p>ä¸­å›½å›½å®¶åŸºå› ç»„ç§‘å­¦æ•°æ®ä¸­å¿ƒ ç”Ÿå‘½ä¸å¥åº·å¤§æ•°æ®ä¸­å¿ƒ (National Genomics Data Center BIG Data Center)ï¼Œç”±åŒ—äº¬åŸºå› ç»„ç ”ç©¶æ‰€ç®¡ç†ã€‚</p><h1 id="äºŒã€è›‹ç™½è´¨æ•°æ®åº“"><a href="#äºŒã€è›‹ç™½è´¨æ•°æ®åº“" class="headerlink" title="äºŒã€è›‹ç™½è´¨æ•°æ®åº“"></a>äºŒã€è›‹ç™½è´¨æ•°æ®åº“</h1><h2 id="nr"><a href="#nr" class="headerlink" title="nr"></a>nr</h2><p>ç›®å‰æœ‰å¾ˆå¤šæ•°æ®åº“éƒ½å­˜å‚¨è›‹ç™½åºåˆ—ï¼Œæ¯”å¦‚NCBI Refseq, protein, swissprot ç­‰ï¼Œåœ¨å„ä¸ªæ•°æ®åº“ä¹‹é—´ï¼Œæˆ–åœ¨æŸä¸ªæ•°æ®åº“å†…ï¼Œè›‹ç™½åºåˆ—æœ‰å¤§é‡å†—ä½™ï¼›ä¸ºæ–¹ä¾¿ä½¿ç”¨ï¼Œncbi æ„å»ºnr åº“ï¼Œ å…¨ç§°æ˜¯ <font color="red"><strong>RefSeq non-redundant proteins</strong></font></p><p>Non-redundant protein sequences from  <font color="red"><strong>GenPept,  Swissprot, PIR, PDF, PDB, and NCBI RefSeq</strong></font></p><p>å®Œæ•´çš„nr æ•°æ®åº“çš„è›‹ç™½åºåˆ—å’Œé¢„å…ˆæ„å»ºå¥½çš„blast ç´¢å¼•å¯ä»¥ä»ncbi çš„ftp æœåŠ¡å™¨ä¸Šä¸‹è½½å¾—åˆ°ï¼Œåœ°å€å¦‚ä¸‹ï¼š</p><p><a href="https://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/">https://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/</a></p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œç›´æ¥ä¸‹è½½æ„å»ºå¥½çš„blast ç´¢å¼•ï¼Œå› ä¸º</p><ol><li>æ•´ä¸ªnr çš„è›‹ç™½åºåˆ—éå¸¸å¤§ï¼Œå¤§æ¦‚30G å·¦å³ï¼Œ<strong>æ„å»ºç´¢å¼•è´¹æ—¶</strong>ï¼›</li></ol><p>2ï¼‰ncbi çš„blastç´¢å¼•ï¼ŒåŠ å…¥æ¯æ¡åºåˆ—çš„ç§æ°´å¹³taxidï¼Œä¾¿äºå¾—åˆ°åºåˆ—å¯¹åº”çš„ç‰©ç§æ³¨é‡Šä¿¡æ¯ï¼›<strong>å®˜æ–¹ç´¢å¼•æ›´ä¼˜</strong></p><p>3ï¼‰ ä½¿ç”¨blastdbcmd å‘½ä»¤å¯ä»¥ä»ç´¢å¼•ä¸­è¿˜åŸå‡ºåŸå§‹çš„nr åºåˆ—ï¼›</p><p>å¯¹äºNCBI ftp çš„æ•°æ®ï¼Œå¯ä»¥ç”¨aspera  è¿›è¡Œä¸‹è½½ï¼Œ é€Ÿåº¦éå¸¸å¿«</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">ascp -i ~/asperaweb_id_dsa.openssh  -QTr -l6000m  anonftp@ftp-private.ncbi.nlm.nih.gov:/blast/db/FASTA/nr..tar.gz ./<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">wget -c ftp://ftp.ncbi.nlm.nih.gov/blast/db/nt*<br>wget -c ftp://ftp.ncbi.nlm.nih.gov/blast/db/nr*<br></code></pre></td></tr></table></figure><p>ç”±äºnr åº“è¾ƒå¤§ï¼Œæ‰€ä»¥ ncbi æŠŠ nr åº“åˆ†æˆäº†å¾ˆå¤šå°ä»½çš„fasta åºåˆ—ï¼Œå»ºç«‹ç´¢å¼•</p><p>å¯¹äºnr çš„åºåˆ—è€Œè¨€ï¼Œå…¶æ ‡è¯†ç¬¦ä¸­åŒ…å«äº†å¾ˆå¤šçš„ä¿¡æ¯</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">&gt;XP_642131.1 hypothetical protein DDB_G0277827 [Dictyostelium discoideum AX4]P54670.1 RecName: Full=Calfumirin-1; Short=CAF-1BAA06266.1 calfumirin-1 [Dictyostelium discoideum AX2]EAL68086.1 hypothetical protein DDB_G0277827 [Dictyostelium discoideum AX4]<br></code></pre></td></tr></table></figure><p>é¦–å…ˆæ˜¯1ä¸ªè›‹ç™½åºåˆ—çš„ç¼–å·ï¼Œåé¢æ˜¯è¿™æ¡åºåˆ—å¯¹åº”çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ–¹æ‹¬å·å†…æ˜¯ç‰©ç§åç§°ï¼› ç”±äºnr åº“æ˜¯éå†—ä½™çš„ï¼Œè¿™é‡Œçš„ <font color="red">æ¯ä¸€æ¡è›‹ç™½åºåˆ—å¯ä»¥ç†è§£ä¸º ä¸€ä¸ªèšç±»çš„group ä¸­çš„ä»£è¡¨åºåˆ—ï¼Œç¬¬ä¸€æ¡æ˜¯è¯¥ä»£è¡¨åºåˆ—æœ¬èº«çš„ä¿¡æ¯ï¼Œåé¢å‡ æ¡æ˜¯å±äºè¿™ä¸ªgroup ä¸‹çš„å…¶ä»–åºåˆ—çš„ä¿¡æ¯</font>ï¼›</p><p>è¿™é‡Œæœ‰ä¸¤ç§æƒ…å†µï¼Œ</p><p>1ï¼‰ è¿™ä¸€ä¸ªgroup ä¸­æ‰€æœ‰çš„è›‹ç™½åºåˆ—éƒ½æ¥æºäºåŒä¸€ä¸ªç‰©ç§ï¼›</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">WP_003131952</span>.<span class="hljs-number">1</span> <span class="hljs-number">30</span>S ribosomal protein S18<span class="hljs-meta"> [Lactococcus lactis]</span><br></code></pre></td></tr></table></figure><p>2ï¼‰ è¿™ä¸€ä¸ªgroup ä¸­æ‰€æœ‰çš„è›‹ç™½åºåˆ—éƒ½æ¥æºäºå¤šä¸ªç‰©ç§ï¼›</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">WP_000184067</span>.<span class="hljs-number">1</span> MULTISPECIES: MbtH family protein<span class="hljs-meta"> [Bacillus]</span><br></code></pre></td></tr></table></figure><p> <font color="red"><strong>å”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå½“æ¥æºäºå¤šä¸ªç‰©ç§æ—¶ï¼Œä¼šåœ¨å‰é¢åŠ ä¸Š MULTISPECIES å…³é”®å­—</strong></font></p><p>å¯¹äºnr ä¸­çš„åºåˆ—ï¼Œå…¶æ ‡è¯†ç¬¦æœ‰ä¸¤ç§ï¼š</p><p>1ï¼‰  <font color="red"><strong>WP å¼€å¤´ ï¼šçœŸå®å­˜åœ¨çš„è›‹ç™½åºåˆ—</strong></font></p><p>2ï¼‰ <font color="red"><strong>XP å¼€å¤´ï¼š ç†è®ºä¸Šçš„è›‹ç™½åºåˆ—ï¼ˆè®¡ç®—æœºè½¯ä»¶é¢„æµ‹çš„ç»“æœï¼‰</strong></font></p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæ¯”å¯¹nr åº“æœ‰ä¸¤ç§ç”¨é€”ï¼š</p><p>1ï¼‰<strong>è›‹ç™½è´¨åŠŸèƒ½æ³¨é‡Š</strong>ï¼š éœ€è¦è¾“å‡ºè›‹ç™½è´¨çš„æè¿°ä¿¡æ¯</p><p>å¯¹äºè¿™ä¸ªéœ€æ±‚ï¼Œnr åº“é‡ŒåŒ…å«äº†è¿™äº›ä¿¡æ¯ï¼Œæ‰€ä»¥æ¯”è¾ƒç®€å•ï¼Œç›´æ¥blast æ¯”å¯¹ï¼Œåœ¨è¾“å‡ºç»“æœä¸­è¾“å‡ºè¿™ä¸ªä¿¡æ¯å°±å¯ä»¥äº†</p><p>2ï¼‰ <strong>ç‰©ç§æ³¨é‡Š</strong>ï¼šè¾“å‡ºè›‹ç™½å¯¹åº”çš„ç‰©ç§ä¿¡æ¯</p><p>åœ¨åºåˆ—ä¸­æœ‰æ˜ç¡®çš„ species æ°´å¹³çš„æ³¨é‡Šï¼Œä½†æ˜¯è¿˜éœ€è¦phylum ç­‰æ°´å¹³çš„æ³¨é‡Šï¼Œè¿™æ—¶å€™å°±éœ€è¦å€ŸåŠ©Taxonomy æ•°æ®åº“ï¼ŒæŠŠç‰©ç§æ³¨é‡Šä¿¡æ¯è¡¥å……å®Œæ•´ã€‚</p><h2 id="Transporter-Classfication-DBè½¬è¿è›‹ç™½åˆ†ç±»åº“"><a href="#Transporter-Classfication-DBè½¬è¿è›‹ç™½åˆ†ç±»åº“" class="headerlink" title="Transporter Classfication DBè½¬è¿è›‹ç™½åˆ†ç±»åº“"></a>Transporter Classfication DBè½¬è¿è›‹ç™½åˆ†ç±»åº“</h2><p><a href="https://www.tcdb.org/">https://www.tcdb.org</a></p><p><a href="http://www.tcdb.org/download.php">http://www.tcdb.org/download.php</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh">makeblastdb error<br><span class="hljs-comment">#error</span><br><span class="hljs-comment">#No volumes were created.</span><br><span class="hljs-comment">#BLAST Database creation error: Could not construct seq-id from &#x27;gnl|TC-DB|1CN3_F|1.A.83.1.5&#x27;</span><br><br><br><span class="hljs-built_in">cat</span> TCDB_transport.pro.fasta | seqkit <span class="hljs-built_in">seq</span> -m 100 &gt; TCDB_transport.100aa.fasta<br><span class="hljs-comment">#[WARN] you may switch on flag -g/--remove-gaps to remove spaces</span><br><span class="hljs-comment">#still error</span><br><br><span class="hljs-comment">#BLAST Database creation error: Near line 6001, the local id is too long. Its length is 51 but the maximum allowed local id length is 50. Please find and correct all local ids that are too long</span><br><span class="hljs-comment">#parse_seqids is the id lenth parameter</span><br><span class="hljs-comment">#remove parse_seqids</span><br></code></pre></td></tr></table></figure><p>TCDBæ˜¯å¯¹è†œè½¬è¿è›‹ç™½ï¼ˆMembrane Transport Proteinï¼‰è¿›è¡Œåˆ†ç±»çš„ä¸€ä¸ªæ•°æ®åº“ï¼Œå®ƒåˆ¶å®šäº†ä¸€å¥—è½¬è¿è›‹ç™½åˆ†ç±»ç³»ç»Ÿï¼ˆTransporter Classificationï¼‰, ç®€ç§°TC System, ç±»ä¼¼äºå¯¹é…¶è¿›è¡Œåˆ†ç±»çš„ECç³»ç»Ÿï¼Œåªä¸è¿‡TCç³»ç»ŸåŒæ—¶æä¾›äº†åŠŸèƒ½å’Œè¿›åŒ–ä¿¡æ¯ï¼›</p><p>TCDBå¯¹äºæ¯ä¸€ä¸ªè½¬è¿è›‹ç™½å®¶æ—ï¼Œæä¾›äº†ä¸€ä¸ªTC Nmuber, TC Number ç”±å°æ•°ç‚¹åˆ†éš”çš„5ä¸ºæ•°å­—æˆ–è€…å­—æ¯æ„æˆ</p><p><a href="http://www.tcdb.org/browse.php">http://www.tcdb.org/browse.php</a>  ç¬¬ä¸€çº§åˆ†ç±»</p><ul><li><strong>Channels&#x2F;Proes</strong></li><li><strong>Electrochemical Potential-driven Transporters</strong></li><li><strong>Primary Active Transporters</strong></li><li><strong>Group Translocators</strong></li><li><strong>Transmembrane Electron Carriers</strong></li><li><strong>Accessory Factors Involved in Transport</strong></li><li><strong>Incompletely Characterized Transport Systems</strong></li></ul><p>ç‚¹å‡» TCDB FsatA Sequences è¶…é“¾æ¥ï¼Œä¸‹è½½æ‰€æœ‰çš„åºåˆ—ï¼Œä¸‹è½½ä¸‹æ¥çš„åºåˆ—å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs coq">&gt;gnl|<span class="hljs-type">TC</span>-DB|<span class="hljs-type">1001796365</span>|<span class="hljs-type">4</span>.F<span class="hljs-number">.1</span><span class="hljs-number">.1</span><span class="hljs-number">.5</span> CDP-alcohol phosphatidyltransferase [Marinobacter excellens]<br>MDSIRPATFQIPAAVRELGWAALLLFFVLLSVHEWFSPPGWFGLLAILIFATQGALILTR<br>WPARQNFGWANRTTLLRSILVVSLVAWAPFLPAADSSALWIYGVACLIALILDGVDGKVA<br>RATNSNSEFGARFDMELDALFIFGLCVATMAIGKAGPWVLMLALMRYAFLAASHFLTWLN<br>QPLPDSFRRKTVCVWQVVTLMIAILPPTPTGFAGTTLAMALALLGWSFALDVRWLYQRRH<br>YHEN<br></code></pre></td></tr></table></figure><p>åºåˆ—æ ‡è¯†ç¬¦ä¸­ï¼Œ</p><ul><li>1001796365 ä»£è¡¨è¯¥è›‹ç™½è´¨åºåˆ—åœ¨GeneBank æ•°æ®åº“ä¸­çš„ç¼–å·</li><li>4.F.1.1.5 æ˜¯TC Number, ä»£è¡¨è¯¥è›‹ç™½è´¨æ‰€å±çš„è½¬è¿è›‹ç™½å®¶æ—</li><li>CDP-alcohol phosphatidyltransferase æ˜¯å¯¹è¯¥è½¬è¿è›‹ç™½å®¶æ—åŠŸèƒ½çš„å…·ä½“æè¿°</li><li>[Marinobacter excellens] æ˜¯è¯¥è›‹ç™½åºåˆ—çš„æ¥æºç‰©ç§</li></ul><p>æœ‰äº†fastaåºåˆ—ä¹‹åï¼Œå¯¹åºåˆ—è¿›è¡ŒTCDBçš„åŠŸèƒ½æ³¨é‡Š</p><p>TCDBè¿˜æä¾›äº†TCID ä¸å…¶ä»–æ•°æ®åº“çš„å…³è”</p><h2 id="è›‹ç™½è´¨ä¿¡æ¯åº“Human-protein-atlas"><a href="#è›‹ç™½è´¨ä¿¡æ¯åº“Human-protein-atlas" class="headerlink" title="è›‹ç™½è´¨ä¿¡æ¯åº“Human protein atlas"></a>è›‹ç™½è´¨ä¿¡æ¯åº“Human protein atlas</h2><ul><li><a href="https://link.zhihu.com/?target=http://www.proteinatlas.org/">Human protein atlas</a><br>äººä½“è›‹ç™½åœ¨ç»†èƒã€ç»„ç»‡ã€ç—…ç†æ¡ä»¶ä¸‹çš„è¡¨è¾¾ ï¼Œè§å…‰æŸ“è‰²å’Œè¡¨è¾¾ä¿¡æ¯ä½¿å¾—ç½‘ç«™å¾ˆç‚«ä¹Ÿå¾ˆå®ç”¨ã€‚</li></ul><h2 id="è›‹ç™½åºåˆ—æ•°æ®åº“"><a href="#è›‹ç™½åºåˆ—æ•°æ®åº“" class="headerlink" title="è›‹ç™½åºåˆ—æ•°æ®åº“"></a>è›‹ç™½åºåˆ—æ•°æ®åº“</h2><h3 id="Pfam"><a href="#Pfam" class="headerlink" title="Pfam"></a>Pfam</h3><p>Pfamæ˜¯è›‹ç™½è´¨å®¶æ—çš„æ•°æ®åº“ï¼ŒåŒ…æ‹¬ä½¿ç”¨éšé©¬å°”å¯å¤«æ¨¡å‹ç”Ÿæˆçš„æ³¨é‡Šå’Œå¤šåºåˆ—æ¯”å¯¹ã€‚ </p><hr><h3 id="SwissProt"><a href="#SwissProt" class="headerlink" title="SwissProt"></a>SwissProt</h3><p>æ‰‹åŠ¨æ³¨é‡Šçš„éå†—ä½™è›‹ç™½åºåˆ—æ•°æ®åº“</p><hr><h3 id="UniProt"><a href="#UniProt" class="headerlink" title="UniProt"></a>UniProt</h3><p>Uniprot ï¼ˆ<em>Universal Protein</em> ï¼‰æ˜¯åŒ…å«è›‹ç™½è´¨åºåˆ—ï¼ŒåŠŸèƒ½ä¿¡æ¯ï¼Œç ”ç©¶è®ºæ–‡ç´¢å¼•çš„è›‹ç™½è´¨æ•°æ®åº“ï¼Œæ•´åˆäº†åŒ…æ‹¬EBIï¼ˆ European Bioinformatics Instituteï¼‰ï¼ŒSIBï¼ˆthe Swiss Institute of Bioinformaticsï¼‰ï¼ŒPIRï¼ˆProtein Information Resourceï¼‰ä¸‰å¤§æ•°æ®åº“çš„èµ„æºã€‚</p><ul><li><p>EBIï¼ˆ European Bioinformatics Instituteï¼‰ï¼šæ¬§æ´²ç”Ÿç‰©ä¿¡æ¯å­¦ç ”ç©¶æ‰€ï¼ˆEMBL-EBIï¼‰æ˜¯æ¬§æ´²ç”Ÿå‘½ç§‘å­¦æ——èˆ°å®éªŒå®¤EMBLçš„ä¸€éƒ¨åˆ†ã€‚ä½äºè‹±å›½å‰‘æ¡¥æ¬£å…‹æ–¯é¡¿çš„æƒ åº·åŸºå› ç»„æ ¡å›­å†…ï¼Œæ˜¯ä¸–ç•Œä¸ŠåŸºå› ç»„å­¦é¢†åŸŸæœ€å¼ºåœ°å¸¦ä¹‹ä¸€ã€‚</p></li><li><p>SIBï¼ˆthe Swiss Institute of Bioinformaticsï¼‰ï¼šç‘å£«æ—¥å†…ç“¦çš„SIBç»´æŠ¤ç€ExPASyï¼ˆä¸“å®¶è›‹ç™½è´¨åˆ†æç³»ç»Ÿï¼‰æœåŠ¡å™¨ï¼Œè¿™é‡ŒåŒ…å«æœ‰è›‹ç™½è´¨ç»„å­¦å·¥å…·å’Œæ•°æ®åº“çš„ä¸»è¦èµ„æºã€‚</p></li><li><p>PIRï¼ˆProtein Information Resourceï¼‰ï¼šPIRç”±ç¾å›½å›½å®¶ç”Ÿç‰©åŒ»å­¦ç ”ç©¶åŸºé‡‘ä¼šï¼ˆNBRFï¼‰äº1984å¹´æˆç«‹ï¼Œæ—¨åœ¨ååŠ©ç ”ç©¶äººå‘˜è¯†åˆ«å’Œè§£é‡Šè›‹ç™½è´¨åºåˆ—ä¿¡æ¯ã€‚</p></li></ul><p>UniProtä¸»è¦å­åº“</p><table><thead><tr><th>æ•°æ®åº“å</th><th>å…¨å</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>UniProtKB&#x2F;Swiss-Prot</td><td>protein knowledgebasï¼ˆreviewï¼‰</td><td>é«˜è´¨é‡ï¼Œæ‰‹å·¥æ³¨é‡Šï¼Œéå†—ä½™</td></tr><tr><td>UniProtKB&#x2F;TrEMBL</td><td>protein knowledgebasï¼ˆunreviewï¼‰</td><td>è‡ªåŠ¨ç¿»è¯‘è›‹ç™½åºåˆ—ï¼Œé¢„æµ‹åºåˆ—ï¼ŒæœªéªŒè¯çš„æ•°æ®åº“</td></tr><tr><td>UniParc</td><td>Sequence</td><td>éå†—ä½™è›‹ç™½è´¨åºåˆ—æ•°æ®åº“</td></tr><tr><td>UniRef</td><td>Sequence cluster</td><td>èšç±»åºåˆ—å‡å°‘æ•°æ®åº“ï¼ŒåŠ å¿«æœç´¢çš„é€Ÿåº¦</td></tr><tr><td>Proteomes</td><td>Protein sets from fully sequenced genomes</td><td>ä¸ºå…¨æµ‹åºåŸºå› ç»„ç‰©ç§æä¾›è›‹ç™½è´¨ä¿¡æ¯</td></tr></tbody></table><p>é€šè¿‡EMBLï¼ŒGenBankï¼ŒDDBJç­‰å…¬å…±æ•°æ®åº“å¾—åˆ°åŸå§‹æ•°æ®ï¼Œå¤„ç†åå­˜å…¥UniParcçš„éå†—ä½™è›‹ç™½è´¨åºåˆ—æ•°æ®åº“ã€‚UniProtä½œä¸ºæ•°æ®ä»“åº“ï¼Œå†åˆ†åˆ«ç»™UniProtKBï¼ŒProteomesï¼ŒUNIRefæä¾›å¯é çš„æ•°æ®é›†ã€‚å…¶ä¸­åœ¨UniProtKBæ•°æ®åº“ä¸­Swiss-Protæ˜¯ç”±TrEMBLç»è¿‡æ‰‹åŠ¨æ³¨é‡Šåå¾—åˆ°çš„é«˜è´¨é‡éå†—ä½™æ•°æ®åº“ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ä»Šåå¸¸ç”¨çš„è›‹ç™½è´¨æ•°æ®åº“ä¹‹ä¸€ã€‚</p><p><img src="/GeekFocus/2022-05-29-BioDatabase/1.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-29-BioDatabase/1.png" alt="img"></p><p><strong>UniProtKB&#x2F;Swiss-Prot</strong></p><p>é«˜è´¨é‡çš„ã€æ‰‹å·¥æ³¨é‡Šçš„ã€éå†—ä½™çš„æ•°æ®é›†</p><p>Swiss-Protæ—¨åœ¨æä¾›ä¸é«˜æ°´å¹³æ³¨é‡Šï¼ˆä¾‹å¦‚ï¼Œè›‹ç™½è´¨åŠŸèƒ½ï¼Œå…¶åŸŸç»“æ„ï¼Œç¿»è¯‘åä¿®é¥°ï¼Œå˜ä½“ç­‰çš„æè¿°ï¼‰ç›¸å…³çš„å¯é è›‹ç™½è´¨åºåˆ—ï¼Œæœ€å°ç¨‹åº¦çš„å†—ä½™å’Œé«˜æ°´å¹³ä¸å…¶ä»–æ•°æ®åº“çš„é›†æˆçº§åˆ«ã€‚æ³¨é‡Šä¸»è¦æ¥è‡ªæ–‡çŒ®ä¸­çš„ç ”ç©¶æˆæœå’ŒE-valueæ ¡éªŒè¿‡è®¡ç®—åˆ†æç»“æœï¼Œæœ‰è´¨é‡ä¿è¯çš„æ•°æ®æ‰è¢«åŠ å…¥è¯¥æ•°æ®åº“ ã€‚</p><p>Swiss-Protç”±Amos Bairochåšå£«åœ¨1986å¹´åˆ›å»ºï¼Œç”±ç‘å£«ç”Ÿç‰©ä¿¡æ¯å­¦ç ”ç©¶æ‰€å¼€å‘ï¼Œéšåç”±æ¬§æ´²ç”Ÿç‰©ä¿¡æ¯å­¦ç ”ç©¶æ‰€çš„Rolf Apweilerå¼€å‘ã€‚ä¹Ÿæ˜¯è¯´EBIå’ŒSIBå…±åŒåˆ¶ä½œäº†Swiss-Protå’ŒTrEMBLæ•°æ®åº“ã€‚</p><p>Swiss-Protæ¡ç›®çš„æ³¨é‡Šä¸­ä½¿ç”¨äº†ä¸€ç³»åˆ—åºåˆ—åˆ†æå·¥å…·ã€‚åŒ…æ‹¬æ‰‹åŠ¨è¯„ä¼°ï¼Œè®¡ç®—æœºé¢„æµ‹ï¼Œå¹¶é€‰æ‹©ç»“æœåŒ…å«åœ¨ç›¸åº”çš„æ¡ç›®ä¸­ã€‚è¿™äº›é¢„æµ‹åŒ…æ‹¬ç¿»è¯‘åä¿®é¥°ï¼Œè·¨è†œç»“æ„åŸŸå’Œæ‹“æ‰‘ï¼Œä¿¡å·è‚½ï¼Œç»“æ„åŸŸè¯†åˆ«å’Œè›‹ç™½è´¨å®¶æ—åˆ†ç±»ã€‚</p><p>æ¥è‡ªç›¸åŒåŸºå› å’Œç›¸åŒç‰©ç§çš„åºåˆ—åˆå¹¶åˆ°ç›¸åŒçš„æ•°æ®åº“æ¡ç›®ä¸­ã€‚ç¡®å®šåºåˆ—ä¹‹é—´çš„å·®å¼‚åŒ…å«ï¼šå¯å˜å‰ªæ¥ï¼Œè‡ªç„¶å˜å¼‚ï¼Œé”™è¯¯çš„èµ·å§‹ä½ç‚¹ï¼Œé”™è¯¯çš„å¤–æ˜¾å­è¾¹ç•Œï¼Œç§»ç ï¼Œæœªè¯†åˆ«çš„å†²çªã€‚</p><p>æ³¨é‡Šä¼šç”¨ç›¸å…³å‡ºç‰ˆç‰©é€šè¿‡æœç´¢æ•°æ®åº“ï¼ˆä¾‹å¦‚PubMedï¼‰è¿›è¡Œè¯†åˆ«ã€‚é˜…è¯»æ¯ç¯‡è®ºæ–‡çš„å…¨æ–‡ï¼Œç„¶åæå–ä¿¡æ¯å¹¶å°†å…¶æ·»åŠ åˆ°æ¡ç›®ä¸­ã€‚ç§‘å­¦æ–‡çŒ®ä¸­çš„æ³¨é‡ŠåŒ…æ‹¬ä½†ä¸é™äºï¼š</p><ul><li>è›‹ç™½è´¨å’ŒåŸºå› åç§°</li><li>åŠŸèƒ½</li><li>ç‰¹å®šäºé…¶çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å‚¬åŒ–æ´»æ€§ï¼Œè¾…å› å­å’Œå‚¬åŒ–æ®‹åŸº</li><li>äºšç»†èƒå®šä½</li><li>è›‹ç™½è´¨ç›¸äº’ä½œç”¨</li><li>è¡¨è¾¾æ–¹å¼</li><li>é‡è¦åŸŸå’Œç«™ç‚¹çš„ä½ç½®å’Œè§’è‰²</li><li>ç¦»å­ï¼Œåº•ç‰©å’Œè¾…å› å­ç»“åˆä½ç‚¹</li><li>é€šè¿‡è‡ªç„¶é—ä¼ å˜å¼‚ï¼ŒRNAç¼–è¾‘ï¼Œæ›¿ä»£å‰ªæ¥ï¼Œè›‹ç™½æ°´è§£åŠ å·¥å’Œç¿»è¯‘åä¿®é¥°äº§ç”Ÿçš„è›‹ç™½è´¨å˜å¼‚å½¢å¼</li></ul><p><img src="/GeekFocus/2022-05-29-BioDatabase/2.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-29-BioDatabase/2.png" alt="img"></p><p>&lt;1&gt;ï¼šè¿™é‡Œè¾“å…¥åŸºå› åï¼ŒUniProt IDï¼Œæˆ–è€…æ„Ÿå…´è¶£çš„å…³é”®å­—</p><p>&lt;2&gt;ï¼šç­›é€‰ï¼š<strong>Reviewed</strong>ï¼šå­˜å‚¨åœ¨Swiss-Protæ•°æ®åº“ä¸­ç»è¿‡éªŒè¯çš„è›‹ç™½æ•°æ®ï¼Œ<strong>Unreviewed</strong>ï¼šå­˜å‚¨åœ¨TrEMBLæ•°æ®åº“ä¸­æ²¡æœ‰ç»è¿‡éªŒè¯çš„è›‹ç™½æ•°æ®</p><p>&lt;3&gt;ï¼šç­›é€‰æŸä¸ªç‰©ç§ï¼Œç‚¹å‡»å°±å¥½åˆ‡æ¢åˆ°è¯¥ç‰©ç§</p><p>&lt;4&gt;ï¼šé€šè¿‡åŸºå› åæˆ–è›‹ç™½åæ¥ç­›é€‰</p><p>&lt;5&gt;ï¼šä¾æ¬¡æ˜¯Unprot IDï¼Œè¯¥è›‹ç™½æ•°æ®åº“å‘½åï¼Œè›‹ç™½è´¨åï¼ŒåŸºå› åï¼Œç‰©ç§ï¼Œåºåˆ—é•¿</p><p>&lt;6&gt;ï¼šå¦‚æœéœ€è¦Blastæ¥æŸ¥çœ‹æŸä¸ªè›‹ç™½æœ‰å“ªäº›åºåˆ—ç›¸ä¼¼çš„è›‹ç™½åºåˆ—ï¼Œå…ˆé€‰ä¸­æ„Ÿå…´è¶£è›‹ç™½å‰çš„æ–¹æ¡†ï¼Œç‚¹å‡»<code>Blast</code></p><p>&lt;7&gt;ï¼šå¦‚æœéœ€è¦å¤šåºåˆ—æ¯”å¯¹ï¼Œå…ˆé€‰ä¸­æ„Ÿå…´è¶£è›‹ç™½å‰çš„æ–¹æ¡†ï¼Œç‚¹å‡»<code>Align</code></p><p>&lt;8&gt;ï¼šå¦‚æœè¦ä¸‹è½½ä¿¡æ¯ï¼Œå…ˆé€‰ä¸­æ„Ÿå…´è¶£è›‹ç™½å‰çš„æ–¹æ¡†ï¼Œç‚¹å‡»<code>Download</code>ä¸‹è½½ã€‚è¿™é‡Œä¸é€‰æ‹©åºåˆ—ï¼Œé»˜è®¤ä¼šä¸‹è½½å…¨éƒ¨åºåˆ—</p><p>ä¸‹è½½åˆ°çš„åºåˆ—ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sh"> &gt;sp|Q01860|PO5F1_HUMAN POU domain, class 5, transcription <span class="hljs-built_in">factor</span> 1 OS=Homo sapiens OX=9606 GN=POU5F1 PE=1 SV=1<br>  MAGHLASDFAFSPPPGGGGDGPGGPEPGWVDPRTWLSFQGPPGGPGIGPGVGPGSEVWGI<br><span class="hljs-comment">#spï¼šSwiss-Protæ•°æ®åº“çš„ç®€ç§°ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢è¯´çš„éªŒè¯åçš„è›‹ç™½æ•°æ®åº“</span><br><span class="hljs-comment">#Q01860ï¼šUniProt IDå·</span><br><span class="hljs-comment">#PO5F1_HUMANï¼šæ˜¯UniProt çš„ç™»å½•å</span><br><span class="hljs-comment">#POU domain, class 5, transcription factor 1ï¼šè›‹ç™½è´¨åç§°</span><br><span class="hljs-comment">#OS=Homo sapiensï¼šOSæ˜¯Organismç®€ç§°ï¼ŒHomo sapiensä¸ºäººçš„æ‹‰ä¸æ–‡åˆ†ç±»å‘½åï¼Œä¹Ÿå°±æ˜¯è¿™æ˜¯äººçš„è›‹ç™½è´¨</span><br><span class="hljs-comment">#OX=9606ï¼šOrganism Taxonomyï¼Œä¹Ÿå°±æ˜¯ç‰©ç§åˆ†ç±»æ•°æ®åº“Taxonomy ID</span><br><span class="hljs-comment">#GN=POU5F1ï¼šGene nameï¼ŒåŸºå› åä¸ºPOU5F1</span><br><span class="hljs-comment">#PE=1ï¼šProtein Existenceï¼Œè›‹ç™½è´¨å¯é æ€§ï¼Œå¯¹åº”5ä¸ªæ•°å­—ï¼Œæ•°å­—è¶Šå°è¶Šå¯é ï¼š</span><br><span class="hljs-comment">#1ï¼šExperimental evidence at protein level</span><br><span class="hljs-comment">#2ï¼šExperimental evidence at tranlevel</span><br><span class="hljs-comment">#3ï¼šProtein inferred from homology</span><br><span class="hljs-comment">#4ï¼šProtein predicted</span><br><span class="hljs-comment">#5ï¼šProtein uncertain</span><br><span class="hljs-comment">#SV=1ï¼šSequence Versionï¼Œåºåˆ—ç‰ˆæœ¬å·</span><br></code></pre></td></tr></table></figure><p><strong>UniProtKB&#x2F;TrEMBL</strong></p><p>åœ¨è®¤è¯†åˆ°åºåˆ—æ•°æ®çš„ç”Ÿæˆé€Ÿåº¦è¶…è¿‡äº†Swiss-Protçš„æ³¨é‡Šèƒ½åŠ›æ—¶ï¼Œä¸ºäº†ç»™ä¸åœ¨Swiss-Protä¸­çš„é‚£äº›è›‹ç™½è´¨æä¾›è‡ªåŠ¨æ³¨é‡Šï¼ŒUniProtåˆ›å»ºäº†TrEMBLï¼ˆç¿»è¯‘çš„EMBLæ ¸è‹·é…¸åºåˆ—æ•°æ®åº“ï¼‰ã€‚åœ¨ä¸‰å¤§æ ¸é…¸æ•°æ®åº“ï¼ˆEMBL-Bank&#x2F;GenBank&#x2F;DDBJï¼‰ä¸­æ³¨é‡Šçš„ç¼–ç åºåˆ—éƒ½ä¼šè¢«è‡ªåŠ¨ç¿»è¯‘å¹¶åŠ å…¥è¯¥æ•°æ®åº“ä¸­ã€‚å®ƒä¹Ÿæœ‰æ¥è‡ªPDBæ•°æ®åº“çš„åºåˆ—ï¼Œä»¥åŠEnsemblã€Refeqå’ŒCCDSåŸºå› é¢„æµ‹çš„åºåˆ—ã€‚ä¹‹å‰æåˆ°çš„PIRç»„ç»‡åˆ¶ä½œäº†è›‹ç™½è´¨åºåˆ—æ•°æ®åº“ï¼ˆPIR-PSDï¼‰ã€‚</p><p><strong>UniParc</strong></p><p>UniProt Archiveï¼ˆUniParcï¼‰åŒ…å«æ¥è‡ªä¸»è¦å…¬å…±å¯ç”¨è›‹ç™½è´¨åºåˆ—æ•°æ®åº“çš„æ‰€æœ‰è›‹ç™½è´¨åºåˆ—çš„éå†—ä½™æ•°æ®é›†ã€‚è›‹ç™½è´¨å¯èƒ½å­˜åœ¨äºå‡ ä¸ªä¸åŒçš„æ¥æºæ•°æ®åº“ä¸­ï¼Œå¹¶ä¸”åœ¨åŒä¸€æ•°æ®åº“ä¸­å­˜åœ¨å¤šä¸ªå‰¯æœ¬ã€‚ ä¸ºäº†é¿å…å†—ä½™ï¼ŒUniParcä»…å°†æ¯ä¸ªå”¯ä¸€åºåˆ—å­˜å‚¨ä¸€æ¬¡ã€‚ ç›¸åŒåºåˆ—è¢«åˆå¹¶ï¼Œæ— è®ºå®ƒä»¬æ¥è‡ªç›¸åŒè¿˜æ˜¯ä¸åŒç‰©ç§ã€‚ æ¯ä¸ªåºåˆ—éƒ½æœ‰ä¸€ä¸ªç¨³å®šä¸”å”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼ˆUPIï¼‰ï¼Œä»è€Œå¯ä»¥ä»ä¸åŒçš„æ¥æºæ•°æ®åº“ä¸­è¯†åˆ«ç›¸åŒçš„è›‹ç™½è´¨ã€‚</p><p>UniParcä»…åŒ…å«è›‹ç™½è´¨åºåˆ—ï¼Œæ²¡æœ‰æ³¨é‡Šã€‚ UniParcæ¡ç›®ä¸­çš„æ•°æ®åº“äº¤å‰å¼•ç”¨å…è®¸ä»æºæ•°æ®åº“æ£€ç´¢æœ‰å…³è¯¥è›‹ç™½è´¨çš„æ›´å¤šä¿¡æ¯ã€‚ å½“æºæ•°æ®åº“ä¸­çš„åºåˆ—å‘ç”Ÿæ›´æ”¹æ—¶ï¼ŒUniParcå°†è·Ÿè¸ªè¿™äº›æ›´æ”¹ï¼Œå¹¶è®°å½•æ‰€æœ‰æ›´æ”¹çš„å†å²è®°å½•ã€‚</p><p><strong>UniRef</strong></p><p>UniProt Reference Clustersï¼ˆUniRefï¼‰ï¼šèšç±»åºåˆ—å¯æ˜¾è‘—å‡å°æ•°æ®åº“å¤§å°ï¼Œä»è€ŒåŠ å¿«åºåˆ—æœç´¢çš„é€Ÿåº¦ã€‚ç”¨äºè®¡ç®—çš„è›‹ç™½è´¨åºåˆ—æ¥è‡ªUniProtKBå’Œéƒ¨åˆ†UniParcè®°å½•çš„åºåˆ—ã€‚UniRef100åºåˆ—å°†ç›¸åŒçš„åºåˆ—å’Œåºåˆ—ç‰‡æ®µï¼ˆæ¥è‡ªä»»ä½•ç”Ÿç‰©ï¼‰åˆå¹¶åˆ°ä¸€ä¸ªUniRefæ¡ç›®ä¸­ï¼Œç”¨äºæ˜¾ç¤ºä»£è¡¨æ€§è›‹ç™½è´¨çš„åºåˆ—ã€‚ ä½¿ç”¨CD-HITç®—æ³•å¯¹UniRef100åºåˆ—è¿›è¡Œèšç±»ï¼Œå¹¶æ„å»ºUniRef90å’ŒUniRef50ã€‚UniRef90å’ŒUniRef50åˆ†åˆ«ä»£è¡¨æ¯ä¸ªç°‡ç”±ä¸æœ€é•¿åºåˆ—åˆ†åˆ«å…·æœ‰è‡³å°‘90ï¼…æˆ–50ï¼…åºåˆ—åŒä¸€æ€§çš„åºåˆ—ç»„æˆã€‚</p><hr><h3 id="InterPro"><a href="#InterPro" class="headerlink" title="InterPro"></a>InterPro</h3><p><a href="http://www.ebi.ac.uk/interpro/">http://www.ebi.ac.uk/interpro/</a></p><p>é€šè¿‡æ•´åˆå¤šä¸ªè›‹ç™½ç›¸å…³æ•°æ®åº“ï¼Œæä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„å¯¹è›‹ç™½åºåˆ—è¿›è¡ŒåŠŸèƒ½æ³¨é‡Šçš„å¹³å°ï¼ŒåŒ…æ‹¬å¯¹è›‹ç™½è´¨å®¶æ—ã€ç»“æ„åŸŸã€åŠŸèƒ½ä½ç‚¹çš„é¢„æµ‹ </p><p>ä»¥ä¸Šè¿™äº›æ•°æ®åº“æ˜¯æ•´åˆåœ¨ä¸€ä¸ªç½‘ç«™ä¸­çš„ï¼Œä»–ä»¬é—´çš„å…³ç³»å¯ä»¥å‚è€ƒè¿™ç¯‡ï¼š</p><hr><h3 id="PIR"><a href="#PIR" class="headerlink" title="PIR"></a>PIR</h3><p><a href="http://www.proteininformationresource.org/">www.proteininformationresource.org/</a></p><hr><h3 id="Antibodies"><a href="#Antibodies" class="headerlink" title="Antibodies"></a>Antibodies</h3><p><a href="http://www.bioinf.org.uk/abs/">www.bioinf.org.uk/abs/</a></p><hr><h3 id="BRENDA"><a href="#BRENDA" class="headerlink" title="BRENDA"></a>BRENDA</h3><hr><h3 id="HPRD"><a href="#HPRD" class="headerlink" title="HPRD"></a>HPRD</h3><p><a href="http://www.hprd.org/">www.hprd.org/</a></p><hr><h3 id="iProClass"><a href="#iProClass" class="headerlink" title="iProClass"></a>iProClass</h3><p>pir.georgetown.edu&#x2F;iproclass&#x2F;</p><hr><h3 id="PRF"><a href="#PRF" class="headerlink" title="PRF"></a>PRF</h3><p><a href="http://www.prf.or.jp/">www.prf.or.jp/</a></p><hr><h3 id="REBASE"><a href="#REBASE" class="headerlink" title="REBASE"></a>REBASE</h3><p>rebase.neb.com&#x2F;rebase&#x2F;rebase.html</p><hr><h2 id="è›‹ç™½è´¨ç»“æ„æ•°æ®åº“"><a href="#è›‹ç™½è´¨ç»“æ„æ•°æ®åº“" class="headerlink" title="è›‹ç™½è´¨ç»“æ„æ•°æ®åº“"></a>è›‹ç™½è´¨ç»“æ„æ•°æ®åº“</h2><h3 id="PDB"><a href="#PDB" class="headerlink" title="PDB"></a>PDB</h3><p><a href="http://www.rcsb.org/">www.rcsb.org/</a><br>é€šè¿‡å®éªŒæµ‹å®šçš„ç»“æ„ï¼Œæœ€å¸¸ç”¨çš„è›‹ç™½è´¨ä¸‰ç»´ç»“æ„æ•°æ®åº“</p><hr><h3 id="SCOP"><a href="#SCOP" class="headerlink" title="SCOP"></a>SCOP</h3><p>scop.mrc-lmb.cam.ac.uk&#x2F;scop&#x2F;</p><hr><h3 id="CATH"><a href="#CATH" class="headerlink" title="CATH"></a>CATH</h3><p><a href="http://www.cathdb.info/">www.cathdb.info/</a></p><hr><h3 id="PSI"><a href="#PSI" class="headerlink" title="PSI"></a>PSI</h3><p><a href="http://www.uwstructuralgenomics.org/">www.uwstructuralgenomics.org/</a></p><hr><h2 id="è›‹ç™½ç»„æ•°æ®åº“"><a href="#è›‹ç™½ç»„æ•°æ®åº“" class="headerlink" title="è›‹ç™½ç»„æ•°æ®åº“"></a>è›‹ç™½ç»„æ•°æ®åº“</h2><h3 id="PRIDE"><a href="#PRIDE" class="headerlink" title="PRIDE"></a>PRIDE</h3><p><a href="http://www.ebi.ac.uk/pride/archive/">www.ebi.ac.uk/pride/archive/</a></p><h2 id="è›‹ç™½è´¨åŠŸèƒ½åŸŸæ•°æ®åº“"><a href="#è›‹ç™½è´¨åŠŸèƒ½åŸŸæ•°æ®åº“" class="headerlink" title="è›‹ç™½è´¨åŠŸèƒ½åŸŸæ•°æ®åº“"></a><strong>è›‹ç™½è´¨åŠŸèƒ½åŸŸæ•°æ®åº“</strong></h2><h3 id="PROSITEæœ€å…¨é¢"><a href="#PROSITEæœ€å…¨é¢" class="headerlink" title="PROSITEæœ€å…¨é¢"></a>PROSITEæœ€å…¨é¢</h3><p>prosite.expasy.org</p><hr><h3 id="Pfamæœ€ä¸“ä¸š"><a href="#Pfamæœ€ä¸“ä¸š" class="headerlink" title="Pfamæœ€ä¸“ä¸š"></a>Pfamæœ€ä¸“ä¸š</h3><p>pfam.xfam.org</p><hr><h3 id="ProDom"><a href="#ProDom" class="headerlink" title="ProDom"></a>ProDom</h3><p>prodom.prabi.fr</p><hr><h3 id="CCD"><a href="#CCD" class="headerlink" title="CCD"></a>CCD</h3><p><a href="http://www.ncbi.nlm.nih.gov/Structure/cdd/cdd.shtm">www.ncbi.nlm.nih.gov/Structure/cdd/cdd.shtm</a></p><hr><h3 id="Prints"><a href="#Prints" class="headerlink" title="Prints"></a>Prints</h3><p><a href="http://www.bioinf.man.ac.uk/dbbrowser/PRINTS/index.php">www.bioinf.man.ac.uk/dbbrowser/PRINTS/index.php</a></p><hr><h3 id="SMART"><a href="#SMART" class="headerlink" title="SMART"></a>SMART</h3><hr><h3 id="TIGRFAM"><a href="#TIGRFAM" class="headerlink" title="TIGRFAM"></a>TIGRFAM</h3><p><a href="http://www.tigr.org/TIGRFAMs/">www.tigr.org/TIGRFAMs/</a></p><hr><h2 id="è›‹ç™½äº’ä½œæ•°æ®åº“"><a href="#è›‹ç™½äº’ä½œæ•°æ®åº“" class="headerlink" title="è›‹ç™½äº’ä½œæ•°æ®åº“"></a><strong>è›‹ç™½äº’ä½œæ•°æ®åº“</strong></h2><h3 id="STRING"><a href="#STRING" class="headerlink" title="STRING"></a>STRING</h3><p>string-db.org</p><h3 id="DIP"><a href="#DIP" class="headerlink" title="DIP"></a>DIP</h3><p>dip.doe-mbi.ucla.edu&#x2F;dip&#x2F;Main.cgi å®éªŒéªŒè¯çš„è›‹ç™½ç›¸äº’ä½œç”¨æ•°æ®åº“</p><h3 id="BioGRID"><a href="#BioGRID" class="headerlink" title="BioGRID"></a>BioGRID</h3><p>thebiogrid.org</p><h3 id="IntAct"><a href="#IntAct" class="headerlink" title="IntAct"></a>IntAct</h3><h1 id="ä¸‰-éç¼–ç RNAæ•°æ®åº“"><a href="#ä¸‰-éç¼–ç RNAæ•°æ®åº“" class="headerlink" title="ä¸‰. éç¼–ç RNAæ•°æ®åº“"></a>ä¸‰. éç¼–ç RNAæ•°æ®åº“</h1><h2 id="éç¼–ç å°RNAæ•°æ®åº“"><a href="#éç¼–ç å°RNAæ•°æ®åº“" class="headerlink" title="éç¼–ç å°RNAæ•°æ®åº“"></a><strong>éç¼–ç å°RNAæ•°æ®åº“</strong></h2><h3 id="miRBase"><a href="#miRBase" class="headerlink" title="miRBase"></a>miRBase</h3><p><a href="http://www.mirbase.org/">www.mirbase.org/</a></p><h3 id="piRNAbank"><a href="#piRNAbank" class="headerlink" title="piRNAbank"></a>piRNAbank</h3><p>pirnabank.ibab.ac.in&#x2F;</p><h3 id="piRNAbank-1"><a href="#piRNAbank-1" class="headerlink" title="piRNAbank"></a>piRNAbank</h3><p>gtrnadb.ucsc.edu&#x2F;</p><h3 id="SILVA"><a href="#SILVA" class="headerlink" title="SILVA"></a>SILVA</h3><p><a href="http://www.arb-silva.de/">www.arb-silva.de/</a></p><h2 id="é•¿éç¼–ç RNAæ•°æ®åº“"><a href="#é•¿éç¼–ç RNAæ•°æ®åº“" class="headerlink" title="é•¿éç¼–ç RNAæ•°æ®åº“"></a><strong>é•¿éç¼–ç RNAæ•°æ®åº“</strong></h2><ul><li><a href="https://link.zhihu.com/?target=http://www.lncrnadb.org/">LncRNAdb</a> çœŸæ ¸ç”Ÿç‰©é•¿éç¼–ç RNAæ•°æ®åº“</li><li><a href="https://link.zhihu.com/?target=http://lncrna.big.ac.cn/index.php/Main_Page">LncRNAwiki</a> äººç±»é•¿éç¼–ç RNAæ•°æ®åº“</li></ul><h2 id="éç¼–ç RNAå®¶æ—æ•°æ®åº“"><a href="#éç¼–ç RNAå®¶æ—æ•°æ®åº“" class="headerlink" title="éç¼–ç RNAå®¶æ—æ•°æ®åº“"></a><strong>éç¼–ç RNAå®¶æ—æ•°æ®åº“</strong></h2><h3 id="Rfam"><a href="#Rfam" class="headerlink" title="Rfam"></a>Rfam</h3><p>rfam.xfam.org  ç±»ä¼¼äºPfamçš„RNAå®¶æ—æ³¨é‡Šæ•°æ®åº“</p><h2 id="éç¼–ç RNAåºåˆ—æ•°æ®åº“"><a href="#éç¼–ç RNAåºåˆ—æ•°æ®åº“" class="headerlink" title="éç¼–ç RNAåºåˆ—æ•°æ®åº“"></a><strong>éç¼–ç RNAåºåˆ—æ•°æ®åº“</strong></h2><p>RNAcentral</p><h1 id="å››-ä»£è°¢æ•°æ®åº“"><a href="#å››-ä»£è°¢æ•°æ®åº“" class="headerlink" title="å››. ä»£è°¢æ•°æ®åº“"></a>å››. <strong>ä»£è°¢æ•°æ®åº“</strong></h1><h3 id="MapMan"><a href="#MapMan" class="headerlink" title="MapMan"></a>MapMan</h3><p>mapman.gabipd.org ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ä»£è°¢é€”å¾„æŸ¥çœ‹å’Œç¼–è¾‘è½¯ä»¶</p><h2 id="ä»£è°¢é€šè·¯æ•°æ®åº“"><a href="#ä»£è°¢é€šè·¯æ•°æ®åº“" class="headerlink" title="ä»£è°¢é€šè·¯æ•°æ®åº“"></a>ä»£è°¢é€šè·¯æ•°æ®åº“</h2><h3 id="KEGG"><a href="#KEGG" class="headerlink" title="KEGG"></a>KEGG</h3><p><a href="https://zhuanlan.zhihu.com/p/96008506">https://zhuanlan.zhihu.com/p/96008506</a></p><p><strong>1. ä»‹ç»</strong></p><p>1995å¹´å¼€å‘çš„KEGGæ•°æ®åº“ï¼Œå…¨ç§°ä¸º Kyoto Encyclopedia of Genes and Genomesï¼ˆäº¬éƒ½åŸºå› ä¸åŸºå› ç»„ç™¾ç§‘å…¨ä¹¦ï¼‰ã€‚æ‹¥æœ‰å¤šä¸ªå­æ•°æ®åº“ï¼ŒåŒ…å«åŸºå› ç»„ï¼Œç”ŸåŒ–ååº”ï¼Œç”ŸåŒ–ç‰©è´¨ï¼Œç–¾ç—…ä¸è¯ç‰©ï¼Œä»¥åŠæœ€å¸¸ç”¨PATHWAYé€šè·¯ä¿¡æ¯ã€‚</p><p><img src="/GeekFocus/2022-05-29-BioDatabase/3.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-29-BioDatabase/3.png" alt="img"></p><p><strong>2. KEGGçš„æ•°æ®åº“æ„æˆ</strong></p><p><img src="/GeekFocus/2022-05-29-BioDatabase/4.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-29-BioDatabase/4.png" alt="img"></p><p><font color="red"><strong>3. KEGG PATHWAY æ•°æ®åº“</strong></font></p><p>æ‰€æœ‰å­æ•°æ®åº“ä¸­æœ€é‡è¦ä¹Ÿæœ€å¸¸ç”¨çš„æ˜¯<strong>KEGG PATHWAY</strong>ï¼ŒåŒ…æ‹¬å¤§é‡ç”±ç§‘ç ”äººå‘˜æ ¹æ®å·²æœ‰æ–‡çŒ®ï¼Œæ‰‹åŠ¨ç»˜åˆ¶çš„KEGGé€šè·¯å›¾ï¼Œä»£è¡¨ä»£è°¢è¿‡ç¨‹ï¼Œç¯å¢ƒä¿¡æ¯è¿‡ç¨‹ï¼Œç»†èƒè¿‡ç¨‹ï¼Œç”Ÿç‰©ç³»ç»Ÿï¼Œäººç±»ç–¾ç—…å’Œè¯ç‰©å¼€å‘ã€‚</p><p>æ¯ä¸ªé€šè·¯éƒ½ç”±ä¸€ä¸ªäº”ä½æ•°å­—æ ‡è¯†ï¼Œåè·Ÿä»¥ä¸‹ä»»æ„ä¸€ä¸ªï¼šmapï¼Œkoï¼Œecï¼Œrnå’Œä¸‰å­—æ¯æˆ–å››å­—æ¯ç”Ÿç‰©ä»£ç ï¼Œå®ƒä»¬åˆ†åˆ«ä»£è¡¨äº”ç§é€šè·¯ç±»å‹ï¼š</p><ul><li><strong>mapç¼–å·</strong>ï¼šä»£è¡¨reference pathwayï¼Œæ ¹æ®å·²æœ‰çš„çŸ¥è¯†ç»˜åˆ¶çš„ã€æ¦‚æ‹¬çš„ã€è¯¦å°½çš„å…·æœ‰ä¸€èˆ¬å‚è€ƒæ„ä¹‰çš„ä»£è°¢å›¾ã€‚ <font color="blue">ä¸€ä¸ªç‚¹</font>åŒæ—¶è¡¨ç¤ºä¸€ä¸ªåŸºå› ï¼Œè¿™ä¸ªåŸºå› ç¼–ç çš„é…¶æˆ–è¿™ä¸ªé…¶å‚åŠ çš„ååº” </li><li><strong>orgç¼–å·</strong>ï¼š<font color="blue">ç‰©ç§ç‰¹å¼‚æ€§é€šè·¯</font>ï¼Œè¿™é‡Œå°±æ˜¯å°†Kç¼–å·åŸºå› ï¼ˆç›´ç³»åŒæºåŸºå› ï¼Œåé¢ä»‹ç»ï¼‰æ¢ä¸ºæ¯ä¸ªç‰©ç§ä¸­å¯¹åº”çš„åŸºå› </li><li><strong>koç¼–å·</strong>ï¼šKOé€šè·¯ä¸­çš„ç‚¹è¡¨ç¤º<font color="blue">ç›´ç³»åŒæºåŸºå›  </font></li><li><strong>ecç¼–å·</strong>ï¼šECé€šè·¯ä¸­çš„<font color="blue">ç‚¹è¡¨ç¤ºç›¸å…³çš„é…¶ </font></li><li><strong>rnç¼–å·</strong>ï¼šåŒ–å­¦ååº”é€šè·¯ä¸­çš„ç‚¹åªè¡¨ç¤ºè¯¥ç‚¹å‚ä¸çš„æŸä¸ªååº”ã€ååº”ç‰©åŠååº”ç±»å‹</li></ul><p>åœ¨äº†è§£æ¯ç§é€šè·¯ä¹‹å‰å…ˆå­¦ä¼šåœ¨KEGGä¸­åˆ‡æ¢æ¯ç§é€šè·¯ç±»å‹</p><p><a href="https://www.kegg.jp/kegg-bin/show_pathway?org_name=map&amp;mapno=00020&amp;mapscale=&amp;show_description=hide">https://www.kegg.jp/kegg-bin/show_pathway?org_name=map&amp;mapno=00020&amp;mapscale=&amp;show_description=hide</a></p><p>è¿›å…¥<a href="https://www.kegg.jp/kegg-bin/show_pathway?org_name=map&mapno=00020&mapscale=&show_description=hide">TCAå¾ªç¯</a> ï¼Œç‚¹å‡»<code>change pathway type</code> æŒ‰é’®ï¼š</p><p><img src="/GeekFocus/2022-05-29-BioDatabase/5.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-29-BioDatabase/5.png" alt="img"></p><p><strong>3.1 å‚è€ƒé€šè·¯å›¾ (map)</strong></p><p>ä»¥ <a href="https://link.zhihu.com/?target=https://www.kegg.jp/kegg-bin/show_pathway?org_name=map&mapno=00020&mapscale=&show_description=hide">TCAå¾ªç¯</a> çš„é€šè·¯å›¾ä¸ºä¾‹ï¼Œè¿›å…¥å‚è€ƒé€šè·¯å›¾(Reference pathway)ã€‚è¿™æ˜¯åŸå§‹ç‰ˆæœ¬çš„é€šè·¯ï¼Œä¹Ÿæ˜¯åç»­å‡ ç§é€šè·¯å›¾çš„â€æ¨¡æ¿â€ã€‚æ¯ä¸ªç™½æ¡†å¯ä»¥ä»£è¡¨ç›´ç³»åŒæºåŸºå› ï¼Œé…¶ï¼Œååº”ï¼Œä¹Ÿå¯ä»¥ç‚¹å‡»é“¾æ¥è‡³KOï¼ŒENZYMEå’ŒREACTIONè¯¦ç»†ä¿¡æ¯ã€‚</p><p>å½¢çŠ¶ï¼Œç®­å¤´ï¼Œçº¿æ®µçš„æ„ä¹‰</p><p><img src="/GeekFocus/2022-05-29-BioDatabase/6.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-29-BioDatabase/6.png" alt="img"></p><p><strong>3.2 ç‰©ç§ç‰¹å¼‚æ€§é€šè·¯ (org)</strong></p><p>é€‰æ‹©äººçš„ç‰©ç§å<code>Homo sapiens (human)</code>ï¼Œç‚¹å‡»<code>Go</code>ã€‚å¯ä»¥çœ‹åˆ°ä¸Reference pathway å›¾ï¼ˆmap00020ï¼‰ä¸åŒçš„æ˜¯æœ‰ç‰©ç§ç‰¹å¼‚æ€§åŸºå› è¢«æ ‡æ³¨ä¸ºç»¿è‰²ï¼Œè€Œä¸”é€šè·¯ç¼–å·ä¸º<code>hsa00020</code></p><p>ç‚¹å‡»ç»¿è‰²åŸºå› ï¼Œä¼šè¿›å…¥<code>Gene</code>è¯¦ç»†ä¿¡æ¯</p><p><strong>3.3 ç›´ç³»åŒæºç‰©é€šè·¯ (ko)</strong></p><p>é€‰æ‹©koï¼Œè“è‰²æ¡†è¶…é“¾æ¥åˆ°ä»åŸå§‹ç‰ˆæœ¬ä¸­é€‰æ‹©çš„KOæ¡ç›®</p><p>è¿›å…¥<code>PCK</code>çš„ç›´ç³»åŒæºåŸºå› ä¿¡æ¯</p><p><strong>3.4 é…¶é€šè·¯ (ec)</strong></p><p>é€‰æ‹©ecï¼Œè“è‰²æ¡†è¶…é“¾æ¥åˆ°ä»åŸå§‹ç‰ˆæœ¬ä¸­é€‰æ‹©çš„ENZYMEæ¡ç›®</p><p><strong>3.5 ååº”é€šè·¯ (reaction)</strong></p><p>é€‰æ‹©rnï¼Œè“è‰²æ¡†è¶…é“¾æ¥åˆ°ä»åŸå§‹ç‰ˆæœ¬ä¸­é€‰æ‹©çš„ååº”æ¡ç›®</p><p><strong>4. KEGG ORTHOLOGYï¼ˆKOï¼‰æ•°æ®åº“</strong></p><p>KEGG ORTHOLOGY ï¼ˆKOï¼‰æ•°æ®åº“æ˜¯æ„å»ºPathwayå’ŒModuleçš„åŸºç¡€ï¼Œç›¸å½“äºKEGGæ•°æ®åº“æ„å»ºçš„åŸºçŸ³ï¼Œç†è§£KOæ•°æ®åº“çš„æ„æˆå¯¹äºä½¿ç”¨åŠäº†è§£KEGGè‡³å…³é‡è¦ã€‚</p><p>KEGGçš„å¼€å‘è€…æ ¹æ®ä¸åŒç”Ÿç‰©ä¹‹é—´åŸºå› å’ŒåŸºå› ç»„çš„ä¿å®ˆå’Œå˜å¼‚ï¼Œå¼•å…¥<font color="blue">ç›´ç³»åŒæºç‰©ï¼ˆKOï¼‰</font>çš„æ¦‚å¿µï¼Œä½¿å¾—KEGGé€šè·¯å›¾ï¼ŒBRITEå±‚æ¬¡ç»“æ„å’ŒKEGGæ¨¡å—çš„å‚è€ƒæ•°æ®é›†å¯ä»¥å¹¿æ³›åº”ç”¨äºä»»ä½•ç»†èƒç”Ÿç‰©ã€‚</p><p><strong>4.1 KOå·</strong>ï¼šè¡¨ç¤º<strong>ä¸åˆ†ç‰©ç§çš„é€šè·¯</strong>ï¼Œç›¸å½“äºæ‰€æœ‰ç‰©ç§çš„è¿™ä¸€é€šè·¯çš„å¹¶é›†ï¼Œæ¯”å¦‚<code>ko00020</code>ä»£è¡¨çš„ <a href="https://link.zhihu.com/?target=https://www.kegg.jp/kegg-bin/show_pathway?ko00020">TCA å¾ªç¯</a> (ä¸‹å›¾æ‰€ç¤º)ï¼Œä¸‹å›¾çš„æ¯ä¸ªåœ†è§’çŸ©å½¢ä¹Ÿä»£è¡¨ç€ä¸€ä¸ªKOé€šè·¯ã€‚</p><p><strong>4.2 Kå·</strong>ï¼šè¡¨ç¤º<strong>åŸºå› </strong>ï¼Œæ¯ä¸ªå·ä»£è¡¨çš„æ˜¯æ‰€æœ‰ç‰©ç§çš„ä¸€ä¸ªåŒæºåŸºå› ï¼Œæ¯”å¦‚ä¸Šå›¾ä¸­çš„<code>K01596</code>ä»£è¡¨çš„æ˜¯ <a href="https://link.zhihu.com/?target=https://www.kegg.jp/dbget-bin/www_bget?K01596">PCK</a>ã€‚</p><p>è¿›å…¥K01596çš„<a href="https://link.zhihu.com/?target=https://www.kegg.jp/dbget-bin/www_bget?K01596">è¯¦ç»†é¡µé¢</a>ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å®ƒä»£è¡¨çš„æ˜¯ä¸€ä¸ªåŸºå› åˆ—è¡¨ï¼Œè¿™äº›åŸºå› å…·æœ‰ä¸€ä¸ªåŠŸèƒ½å´æ¥è‡ªäºä¸åŒçš„ç‰©ç§ã€‚</p><p><strong>4.3 Cå·</strong>ï¼šè¡¨ç¤º<strong>åŒ–åˆç‰©</strong></p><hr><h3 id="GO"><a href="#GO" class="headerlink" title="GO"></a>GO</h3><p><a href="https://zhuanlan.zhihu.com/p/99789859">https://zhuanlan.zhihu.com/p/99789859</a></p><p><strong>1. ä»‹ç»</strong></p><p>è¯»æ‡‚åŸºå› æœ¬ä½“è®ºï¼ˆGene Ontologyï¼‰å‰ï¼Œå…ˆçœ‹çœ‹ä»€ä¹ˆæ˜¯æœ¬ä½“è®ºï¼š</p><p>æœ¬ä½“è®ºï¼ˆOntology ï¼‰æ˜¯æ¢ç©¶ä¸–ç•Œçš„æœ¬åŸæˆ–åŸºè´¨çš„å“²å­¦ç†è®º ã€‚</p><p>æœ¬ä½“è®ºé€šå¸¸å¤„ç†çš„é—®é¢˜ï¼šå­˜åœ¨å“ªäº›æœ¬è´¨ï¼Œå¦‚ä½•å°†è¿™äº›æœ¬è´¨åˆ†ç»„ï¼Œåœ¨å±‚æ¬¡ç»“æ„å†…å…³è”ä»¥åŠå¦‚ä½•æ ¹æ®ç›¸ä¼¼æ€§å’Œå·®å¼‚è¿›è¡Œç»†åˆ† ã€‚</p><p>åŸºå› æœ¬ä½“è®ºï¼ˆGene Ontologyï¼‰åŒ…å«ç”Ÿç‰©å­¦é¢†åŸŸçŸ¥è¯†ä½“ç³»æœ¬è´¨çš„è¡¨ç¤ºå½¢å¼ï¼Œæœ¬ä½“é€šå¸¸ç”±ä¸€ç»„ç±»ï¼ˆæˆ–æœ¯è¯­æˆ–æ¦‚å¿µï¼‰ç»„æˆï¼Œå®ƒä»¬ä¹‹é—´å…·æœ‰å…³ç³»ã€‚ åŸºå› æœ¬ä½“è®ºï¼ˆGOï¼‰ä»ä¸‰ä¸ªæ–¹é¢ï¼ˆGO domainsï¼‰æè¿°äº†æˆ‘ä»¬å¯¹ç”Ÿç‰©å­¦é¢†åŸŸçš„äº†è§£ï¼š</p><p><strong>1.1 åˆ†å­åŠŸèƒ½ï¼ˆMolecular Functionï¼ŒMF ï¼‰</strong></p><p><strong>å•ä¸ªçš„åŸºå› äº§ç‰©ï¼ˆåŒ…æ‹¬è›‹ç™½è´¨å’ŒRNAï¼‰æˆ–å¤šä¸ªåŸºå› äº§ç‰©çš„å¤åˆç‰©åœ¨åˆ†å­æ°´å¹³ä¸Šçš„æ´»åŠ¨</strong>ï¼Œæ¯”å¦‚<font color="red"><strong>â€œå‚¬åŒ–â€ï¼Œâ€œè½¬è¿â€</strong></font></p><p>æ­¤å¤„æè¿°åªè¡¨ç¤ºæ´»åŠ¨ï¼Œè€Œä¸æŒ‡å®šæ‰§è¡ŒåŠŸèƒ½çš„å®ä½“ï¼ˆåˆ†å­æˆ–å¤åˆç‰©ï¼‰ï¼ŒåŠ¨ä½œå‘ç”Ÿçš„åœ°ç‚¹ï¼Œæ—¶é—´æˆ–èƒŒæ™¯</p><p>å¹¿ä¹‰ä¸Šä¾‹å­æ˜¯<font color="blue">å‚¬åŒ–æ´»æ€§å’Œè½¬è¿è›‹ç™½æ´»æ€§</font>ã€‚å…·ä½“ä¾‹å­æ˜¯<font color="blue">è…ºè‹·é…¸ç¯åŒ–é…¶æ´»æ€§æˆ–Tollæ ·å—ä½“ç»“åˆ</font></p><p><font color="blue">ä¸ºé¿å…åŸºå› äº§ç‰©åä¸å…¶åˆ†å­åŠŸèƒ½æ··æ·†ï¼ŒGOåˆ†å­åŠŸèƒ½é€šå¸¸<strong>é™„åŠ â€œæ´»æ€§ï¼ˆactivityï¼‰â€ä¸€è¯</strong>ã€‚å¦‚è›‹ç™½æ¿€é…¶ï¼ˆprotein kinaseï¼‰å…·æœ‰GOåˆ†å­åŠŸèƒ½ï¼šè›‹ç™½æ¿€é…¶æ´»æ€§ï¼ˆ protein kinase activityï¼‰</font></p><p><strong>1.2. ç»†èƒç»„åˆ†ï¼ˆCellular Component ï¼ŒCCï¼‰</strong>**</p><p><strong>åŸºå› äº§ç‰©åœ¨æ‰§è¡ŒåŠŸèƒ½æ—¶æ‰€å¤„çš„ç»†èƒç»“æ„ä½ç½®</strong>ï¼Œæ¯”å¦‚çº¿ç²’ä½“ï¼Œæ ¸ç³–ä½“</p><p>éœ€è¦æ³¨æ„ï¼šç»†èƒç»„åˆ†æ˜¯<font color="blue">ç»†èƒè§£åˆ¨ç»“æ„</font>ï¼Œä¸æŒ‡ä»£è¿‡ç¨‹</p><p><strong>1.3. ç”Ÿç‰©è¿‡ç¨‹ï¼ˆBiological Process ï¼ŒBPï¼‰</strong>**</p><p><strong>é€šè¿‡å¤šç§åˆ†å­æ´»åŠ¨å®Œæˆçš„ç”Ÿç‰©å­¦è¿‡ç¨‹</strong></p><p>å¹¿ä¹‰ä¸Šçš„ä¾‹å­æ˜¯<font color="red"><strong>DNAä¿®å¤æˆ–ä¿¡å·è½¬å¯¼</strong></font>ã€‚æ›´åŠ å…·ä½“çš„ä¾‹å­æ˜¯<font color="blue">å˜§å•¶æ ¸è‹·ç”Ÿç‰©åˆæˆè¿‡ç¨‹æˆ–è‘¡è„ç³–è·¨è†œè½¬è¿</font></p><p>éœ€è¦æ³¨æ„ï¼š<font color="blue">ç”Ÿç‰©å­¦è¿‡ç¨‹ä¸ç­‰åŒäºé€šè·¯</font>ã€‚ç›®å‰GOæ²¡æœ‰è¡¨ç¤ºå®Œæ•´çš„é€šè·¯ä¿¡æ¯æ‰€éœ€çš„åŠ¨åŠ›å­¦æˆ–ä¾èµ–æ€§çš„æè¿°ä¿¡æ¯</p><p>ä¸¾ä¾‹ï¼Œåœ¨åŸºå› æœ¬ä½“è®ºGOçš„è§’åº¦æ¥è§£é‡Šä¸€ä¸ªåŸºå› ï¼š</p><p>åŸºå› äº§ç‰©ï¼šç»†èƒè‰²ç´ Cï¼ˆcytochrome cï¼‰</p><p>åˆ†å­åŠŸèƒ½ï¼šæ°§åŒ–è¿˜åŸé…¶æ´»æ€§</p><p>ç»†èƒç»„åˆ†ï¼šçº¿ç²’ä½“åŸºè´¨</p><p>ç”Ÿç‰©è¿‡ç¨‹ï¼šæ°§åŒ–ç£·é…¸åŒ–</p><hr><ul><li><a href="https://link.zhihu.com/?target=https://www.ncbi.nlm.nih.gov/biosystems">NCBI BioSystems</a></li><li><a href="https://link.zhihu.com/?target=http://imp.princeton.edu/">IMP</a></li><li><a href="https://link.zhihu.com/?target=https://www.plantcyc.org/">plantCyc</a></li><li><a href="https://zhuanlan.zhihu.com/p/79626339/">MANET</a></li><li><a href="https://zhuanlan.zhihu.com/p/79626339/">MetaNetX</a></li></ul><h2 id="ä»£è°¢ç»„å­¦å¸¸ç”¨æ•°æ®åº“"><a href="#ä»£è°¢ç»„å­¦å¸¸ç”¨æ•°æ®åº“" class="headerlink" title="ä»£è°¢ç»„å­¦å¸¸ç”¨æ•°æ®åº“"></a><strong>ä»£è°¢ç»„å­¦å¸¸ç”¨æ•°æ®åº“</strong></h2><ul><li><a href="https://link.zhihu.com/?target=https://www.ebi.ac.uk/metabolights/">MataboLights</a></li><li><a href="https://link.zhihu.com/?target=http://www.hmdb.ca/">HMDB</a></li><li><a href="https://link.zhihu.com/?target=http://www.ymdb.ca/">YMDB</a></li><li><a href="https://link.zhihu.com/?target=http://ecmdb.ca/">ECMDB</a></li></ul><h2 id="è¡¨å‹æ•°æ®åº“"><a href="#è¡¨å‹æ•°æ®åº“" class="headerlink" title="è¡¨å‹æ•°æ®åº“"></a><strong>è¡¨å‹æ•°æ®åº“</strong></h2><ul><li><a href="https://link.zhihu.com/?target=http://www.planteome.org/">Planteome</a></li><li><a href="https://link.zhihu.com/?target=https://www.ncbi.nlm.nih.gov/gap/">dbGaP</a></li><li><a href="https://link.zhihu.com/?target=https://www.plant-phenotyping.org/">IPPN</a></li></ul><h1 id="äº”-åºåˆ—æ¯”å¯¹"><a href="#äº”-åºåˆ—æ¯”å¯¹" class="headerlink" title="äº”. åºåˆ—æ¯”å¯¹"></a>äº”. åºåˆ—æ¯”å¯¹</h1><h2 id="åºåˆ—ä¸æ•°æ®åº“æ¯”å¯¹"><a href="#åºåˆ—ä¸æ•°æ®åº“æ¯”å¯¹" class="headerlink" title="åºåˆ—ä¸æ•°æ®åº“æ¯”å¯¹"></a><strong>åºåˆ—ä¸æ•°æ®åº“æ¯”å¯¹</strong></h2><h3 id="Blast"><a href="#Blast" class="headerlink" title="Blast"></a>Blast</h3><p>blast.ncbi.nlm.nih.gov&#x2F;Blast.cgi</p><hr><h2 id="å¤šåºåˆ—é—´æ¯”å¯¹"><a href="#å¤šåºåˆ—é—´æ¯”å¯¹" class="headerlink" title="å¤šåºåˆ—é—´æ¯”å¯¹"></a><strong>å¤šåºåˆ—é—´æ¯”å¯¹</strong></h2><h3 id="Clustal"><a href="#Clustal" class="headerlink" title="Clustal"></a>Clustal</h3><h2 id="åºåˆ—è¿›åŒ–æ ‘åˆ†æ"><a href="#åºåˆ—è¿›åŒ–æ ‘åˆ†æ" class="headerlink" title="åºåˆ—è¿›åŒ–æ ‘åˆ†æ"></a><strong>åºåˆ—è¿›åŒ–æ ‘åˆ†æ</strong></h2><h3 id="MEGA"><a href="#MEGA" class="headerlink" title="MEGA"></a>MEGA</h3><p><a href="https://zhuanlan.zhihu.com/p/141835886">https://zhuanlan.zhihu.com/p/141835886</a></p><p><a href="https://zhuanlan.zhihu.com/p/36598434">https://zhuanlan.zhihu.com/p/36598434</a></p><h1 id="å…­-åŸºå› åˆ†æ"><a href="#å…­-åŸºå› åˆ†æ" class="headerlink" title="å…­. åŸºå› åˆ†æ"></a>å…­. åŸºå› åˆ†æ</h1><h2 id="åŸºå› ä¿¡æ¯"><a href="#åŸºå› ä¿¡æ¯" class="headerlink" title="åŸºå› ä¿¡æ¯"></a>åŸºå› ä¿¡æ¯</h2><p><a href="https://link.zhihu.com/?target=https://www.genecards.org/">GeneCard</a></p><p><a href="https://link.zhihu.com/?target=https://en.wikipedia.org/wiki/Wikipedia:Gene_Wiki">Gene Wiki</a></p><h2 id="åŸºå› æ³¨é‡Š"><a href="#åŸºå› æ³¨é‡Š" class="headerlink" title="åŸºå› æ³¨é‡Š"></a><strong>åŸºå› æ³¨é‡Š</strong></h2><ul><li><a href="https://link.zhihu.com/?target=https://blast.ncbi.nlm.nih.gov/Blast.cgi">Blast</a></li><li><a href="https://link.zhihu.com/?target=http://www.ebi.ac.uk/interpro/">Interproscan</a></li><li><a href="https://link.zhihu.com/?target=http://wego.genomics.org.cn/">WEGO</a></li><li><a href="https://link.zhihu.com/?target=https://www.genome.jp/tools/kaas/">KAAS</a></li></ul><h2 id="åŸºå› åŠŸèƒ½é¢„æµ‹"><a href="#åŸºå› åŠŸèƒ½é¢„æµ‹" class="headerlink" title="åŸºå› åŠŸèƒ½é¢„æµ‹"></a><strong>åŸºå› åŠŸèƒ½é¢„æµ‹</strong></h2><ul><li><a href="https://link.zhihu.com/?target=http://linux1.softberry.com/berry.phtml?topic=fgenesh&group=programs&subgroup=gfind">FGENESH</a></li><li><a href="https://link.zhihu.com/?target=http://bioinf.uni-greifswald.de/augustus/submission.php">AUGUSTUS</a></li><li><a href="https://link.zhihu.com/?target=http://argonaute.mit.edu/GENSCAN.html">GENESCAN</a></li><li><a href="https://link.zhihu.com/?target=http://topaz.gatech.edu/GeneMark/">GeneMark</a></li><li><a href="https://link.zhihu.com/?target=http://ccb.jhu.edu/software/glimmer/index.shtml">Glimmer</a></li></ul><h2 id="åŸºå› ç»“æ„é¢„æµ‹"><a href="#åŸºå› ç»“æ„é¢„æµ‹" class="headerlink" title="åŸºå› ç»“æ„é¢„æµ‹"></a><strong>åŸºå› ç»“æ„é¢„æµ‹</strong></h2><ul><li><a href="https://link.zhihu.com/?target=http://wormweb.org/exonintron">Exon-Intron Graphic Maker</a> æ ¹æ®å€™é€‰åŸºå› çš„å¤–æ˜¾å­å’Œå†…å«å­ç­‰ä¿¡æ¯ç»˜åˆ¶åŸºå› ç»“æ„</li><li><a href="https://link.zhihu.com/?target=https://blast.ncbi.nlm.nih.gov/Blast.cgi?PROGRAM=blastp&PAGE_TYPE=BlastSearch&LINK_LOC=blasthome">Blastp</a> å¯åœ¨çº¿è·å–è›‹ç™½ç»“æ„åŸŸçš„æ³¨é‡Šå’Œä½ç½®ä¿¡æ¯</li></ul><h2 id="åŒæºåŸºå› åˆ†æ"><a href="#åŒæºåŸºå› åˆ†æ" class="headerlink" title="åŒæºåŸºå› åˆ†æ"></a><strong>åŒæºåŸºå› åˆ†æ</strong></h2><p>OrthoDBæ˜¯ç›´ç³»åŒæºç‰©çš„ç»¼åˆç›®å½•</p><h2 id="äºšç»†èƒå®šä½é¢„æµ‹"><a href="#äºšç»†èƒå®šä½é¢„æµ‹" class="headerlink" title="äºšç»†èƒå®šä½é¢„æµ‹"></a><strong>äºšç»†èƒå®šä½é¢„æµ‹</strong></h2><p>PSORT Prediction</p><h2 id="å¯åŠ¨å­åˆ†æ"><a href="#å¯åŠ¨å­åˆ†æ" class="headerlink" title="å¯åŠ¨å­åˆ†æ"></a><strong>å¯åŠ¨å­åˆ†æ</strong></h2><p>Plantcare</p><h2 id="è°ƒæ§ç›®çš„åŸºå› çš„miRNAé¢„æµ‹"><a href="#è°ƒæ§ç›®çš„åŸºå› çš„miRNAé¢„æµ‹" class="headerlink" title="è°ƒæ§ç›®çš„åŸºå› çš„miRNAé¢„æµ‹"></a><strong>è°ƒæ§ç›®çš„åŸºå› çš„miRNAé¢„æµ‹</strong></h2><p>psRNAtarget</p><h2 id="è¡¨è¾¾åˆ†æ"><a href="#è¡¨è¾¾åˆ†æ" class="headerlink" title="è¡¨è¾¾åˆ†æ"></a><strong>è¡¨è¾¾åˆ†æ</strong></h2><ul><li><a href="https://link.zhihu.com/?target=https://www.ebi.ac.uk/arrayexpress%3E/">ArrayExpress</a><br>æ•°æ®æ¥è‡ªEMBLçš„é«˜é€šé‡åŠŸèƒ½åŸºå› ç»„å­¦å®éªŒçš„æ•°æ®ï¼›</li><li><a href="https://link.zhihu.com/?target=http://bar.utoronto.ca/">BAR</a><br>åœ¨åˆ†æåŸºå› åŠŸèƒ½æ—¶ï¼Œé€šå¸¸ä¼šå‚è€ƒåŸºå› çš„è¡¨è¾¾æ¨¡å¼ï¼Œå³åŸºå› åœ¨æ¤ç‰©ä¸åŒç»„ç»‡ä¸åŒå‘è‚²æ—¶æœŸçš„è¡¨è¾¾ä¸°åº¦å˜åŒ–ã€‚é€šè¿‡åœ¨çº¿åˆ†æç½‘ç«™BARå¯¹å€™åŸºå› è¿›è¡Œè¡¨è¾¾åˆ†æã€‚ æ˜¯ä¸€ä¸ªæ¤ç‰©ç”Ÿä¿¡åˆ†æèµ„æºç½‘ç«™ï¼Œç”¨è¯¥ç½‘ç«™åˆ†æåŸºå› è¡¨è¾¾æ—¶ï¼Œä¸ä»…å¯ä»¥è·å¾—åŸºå› è¡¨è¾¾æ¨¡å¼çš„çƒ­å›¾ï¼Œè¿˜å¯ä»¥è·å¾—å¯è§†åŒ–çš„ç”µå­è§å…‰å›¾ç‰‡ï¼Œç›´è§‚å‘ˆç°åŸºå› åœ¨æ¤ç‰©ç»„ç»‡ä¸­çš„è¡¨è¾¾ä½ç½®ã€‚</li></ul><h2 id="åŸºå› ç»“æ„ç»˜åˆ¶"><a href="#åŸºå› ç»“æ„ç»˜åˆ¶" class="headerlink" title="åŸºå› ç»“æ„ç»˜åˆ¶"></a><strong>åŸºå› ç»“æ„ç»˜åˆ¶</strong></h2><ul><li><a href="https://link.zhihu.com/?target=http://gsds.cbi.pku.edu.cn/">GSDS</a><br>Gene Structure Display Serverï¼ŒåŸºäºåŸºå› ç»„æ³¨é‡Šæ–‡ä»¶ç»˜åˆ¶åºåˆ—åŸºå› ç»“æ„ç­‰åŠŸèƒ½</li></ul><h1 id="ä¸ƒ-è›‹ç™½è´¨åˆ†æ"><a href="#ä¸ƒ-è›‹ç™½è´¨åˆ†æ" class="headerlink" title="ä¸ƒ. è›‹ç™½è´¨åˆ†æ"></a>ä¸ƒ. <strong>è›‹ç™½è´¨åˆ†æ</strong></h1><h3 id="1-è›‹ç™½äºŒçº§ä¸‰çº§ç»“æ„é¢„æµ‹åŠç»˜å›¾"><a href="#1-è›‹ç™½äºŒçº§ä¸‰çº§ç»“æ„é¢„æµ‹åŠç»˜å›¾" class="headerlink" title="1. è›‹ç™½äºŒçº§ä¸‰çº§ç»“æ„é¢„æµ‹åŠç»˜å›¾"></a><strong>1. è›‹ç™½äºŒçº§ä¸‰çº§ç»“æ„é¢„æµ‹åŠç»˜å›¾</strong></h3><ul><li><a href="https://link.zhihu.com/?target=http://www.biogem.org/tool/chou-fasman/">CFSSP</a></li><li><a href="https://link.zhihu.com/?target=https://npsa-prabi.ibcp.fr/cgi-bin/npsa_automat.pl?page=npsa_sopma.html">SOPMA</a></li><li><a href="https://link.zhihu.com/?target=https://www.predictprotein.org/">PredictProtein</a></li><li><a href="https://link.zhihu.com/?target=https://swissmodel.expasy.org/interactive">SWISS-MODEL</a></li></ul><h3 id="2-è›‹ç™½ç‰¹æ€§åˆ†æ"><a href="#2-è›‹ç™½ç‰¹æ€§åˆ†æ" class="headerlink" title="2.è›‹ç™½ç‰¹æ€§åˆ†æ"></a><strong>2.è›‹ç™½ç‰¹æ€§åˆ†æ</strong></h3><ul><li><a href="https://link.zhihu.com/?target=http://web.expasy.org/protparam/">ProtParam</a><br>è›‹ç™½ç‰¹æ€§åˆ†ææ˜¯æŒ‡è›‹ç™½çš„ä¸€äº›ç‰©ç†å’ŒåŒ–å­¦å‚æ•°ï¼Œå¦‚åˆ†å­é‡ã€ç­‰ç”µç‚¹ã€æ°¨åŸºé…¸å’ŒåŸå­ç»„æˆã€æ¶ˆå…‰ç³»æ•°ã€åŠè¡°æœŸã€ä¸ç¨³å®šç³»æ•°ã€è„‚è‚ªæ—æ°¨åŸºé…¸æŒ‡æ•°ã€äº²æ°´æ€§ã€‚è¿™äº›å‚æ•°ï¼Œæœ‰åŠ©äºè¿›è¡Œè›‹ç™½çš„ç›¸å…³ç”ŸåŒ–å®éªŒã€‚æ¯”å¦‚åœ¨ä½“å¤–ä½“ç³»ï¼ˆå¤§è‚ æ†èŒã€é…µæ¯ç­‰ï¼‰è¡¨è¾¾å’Œçº¯åŒ–ç›®çš„è›‹ç™½æ—¶ï¼Œéœ€è¦è€ƒè™‘è›‹ç™½çš„åˆ†å­é‡ã€ç­‰ç”µç‚¹ã€æ¶ˆå…‰ç³»æ•°ã€ä¸ç¨³å®šç³»æ•°å’Œäº²æ°´æ€§ç­‰ã€‚åœ¨é…¶æ´»å®éªŒä¸­ï¼Œä¹Ÿéœ€è¦æ ¹æ®è¿™äº›å‚æ•°ä¼˜åŒ–å®éªŒä½“ç³»ã€‚</li></ul><h3 id="3-è›‹ç™½äº²ç–æ°´æ€§åˆ†æ"><a href="#3-è›‹ç™½äº²ç–æ°´æ€§åˆ†æ" class="headerlink" title="3.è›‹ç™½äº²ç–æ°´æ€§åˆ†æ"></a><strong>3.è›‹ç™½äº²ç–æ°´æ€§åˆ†æ</strong></h3><ul><li><a href="https://link.zhihu.com/?target=https://web.expasy.org/protscale/">Protscale</a><br>è›‹ç™½æ°¨åŸºé…¸çš„äº²ç–æ°´æ€§ä¸»è¦ç”±å…¶ä¾§é“¾åŸºå›¢Rï¼Œå¦‚æœRåªæ˜¯Hæˆ–æ˜¯Cã€Hä¸¤å…ƒç´ ç»„æˆçš„è¯ï¼Œéƒ½æ˜¯ç–æ°´çš„ï¼Œå¦‚æœå«æœ‰ææ€§ä¾§é“¾åŸºå›¢ï¼Œå¦‚-OHã€-SHã€-COOHã€-NH2 ç­‰ï¼Œåˆ™å°±æ˜¯ææ€§çš„ï¼ˆäº²æ°´çš„ï¼‰ã€‚ç–æ°´æ€§æ°¨åŸºé…¸æœ‰é…ªæ°¨é…¸ã€è‰²æ°¨é…¸ã€è‹¯ä¸™æ°¨é…¸ã€ç¼¬æ°¨é…¸ã€äº®æ°¨é…¸ã€å¼‚äº®æ°¨é…¸ã€ä¸™æ°¨é…¸å’Œè›‹æ°¨é…¸ï¼ˆç”²ç¡«æ°¨é…¸ï¼‰ã€‚ç–æ°´æ€§æ°¨åŸºé…¸åœ¨è›‹ç™½è´¨å†…éƒ¨ï¼Œåœ¨ä¿æŒè›‹ç™½è´¨çš„ä¸‰çº§ç»“æ„ä¸Šï¼Œé…¶å’ŒåŸºè´¨ã€æŠ—ä½“å’ŒæŠ—åŸé—´çš„ç›¸äº’ä½œç”¨ç­‰å„ç§éå…±ä»·é”®çš„åˆ†å­ç»“åˆæ–¹é¢ï¼Œå…·æœ‰é‡è¦ä½œç”¨ã€‚</li></ul><h3 id="4-è·¨è†œç»“æ„åˆ†æ"><a href="#4-è·¨è†œç»“æ„åˆ†æ" class="headerlink" title="4.è·¨è†œç»“æ„åˆ†æ"></a><strong>4.è·¨è†œç»“æ„åˆ†æ</strong></h3><ul><li><a href="https://link.zhihu.com/?target=http://www.cbs.dtu.dk/services/TMHMM/">TMHMM</a><br>è›‹ç™½çš„è·¨è†œç»“æ„åˆ†æå¯¹äºé¢„æµ‹è›‹ç™½çš„äºšç»†èƒå®šä½å¯†åˆ‡ç›¸å…³ã€‚å¦‚æœå…·æœ‰è·¨è†œç»“æ„ï¼Œè›‹ç™½å¾ˆå¯èƒ½å®šä½äºç»†èƒä¸­ä¸è†œç›¸å…³çš„ç»“æ„ï¼Œå¦‚ç»†èƒè´¨è†œã€å¶ç»¿ä½“è†œæˆ–çº¿ç²’ä½“è†œç­‰å†…è†œç³»ç»Ÿã€‚æ­¤å¤–ï¼Œè›‹ç™½è·¨è†œç»“æ„åˆ†æå¯¹äºè›‹ç™½åŠŸèƒ½åˆ†æä¹Ÿæœ‰ä¸€å®šçš„å¸®åŠ©ã€‚æ¯”å¦‚æŸè›‹ç™½æ²¡æœ‰è·¨è†œç»“æ„ï¼Œä½†æ˜¯äºšç»†èƒå®šä½å®éªŒæ˜¾ç¤ºå…¶å¯å®šä½äºè†œç›¸å…³ç»“æ„ï¼Œè¿™è¯´æ˜è¯¥è›‹ç™½å¯èƒ½é€šè¿‡å…¶ä»–è†œå®šä½è›‹ç™½æ‹›å‹Ÿè¿‡å»çš„ã€‚</li></ul><h3 id="5-ä¿¡å·è‚½åˆ†æ"><a href="#5-ä¿¡å·è‚½åˆ†æ" class="headerlink" title="5.ä¿¡å·è‚½åˆ†æ"></a><strong>5.ä¿¡å·è‚½åˆ†æ</strong></h3><ul><li><a href="https://link.zhihu.com/?target=http://www.cbs.dtu.dk/services/SignalP/">SignalP</a><br>å³°ä¿¡å·ä½ç½®ä¸ºä¿¡å·è‚½åˆ‡å‰²ç‚¹ï¼Œå³°ä¹‹å‰çš„åºåˆ—ä¸ºä¿¡å·è‚½ ä¿¡å·è‚½æ˜¯æŒ‡å¼•å¯¼æ–°åˆæˆçš„è›‹ç™½è´¨å‘åˆ†æ³Œé€šè·¯è½¬ç§»çš„çŸ­è‚½é“¾ï¼Œå¸¸ä½äºè›‹ç™½çš„N-æœ«ç«¯ï¼Œè´Ÿè´£æŠŠè›‹ç™½è´¨å¼•å¯¼åˆ°ä¸åŒè†œç»“æ„çš„äºšç»†èƒå™¨å†…ã€‚ç¼–ç åˆ†æ³Œè›‹ç™½çš„mRNAåœ¨ç¿»è¯‘æ—¶é¦–å…ˆåˆæˆNæœ«ç«¯çš„ä¿¡å·è‚½ï¼Œå®ƒè¢«ä¿¡å·è‚½è¯†åˆ«è›‹ç™½(SRP)æ‰€è¯†åˆ«ï¼ŒSRPå°†æ ¸ç³–ä½“æºå¸¦è‡³å†…è´¨ç½‘ä¸Šï¼Œå†…è´¨ç½‘è†œä¸Šçš„ SPR å—ä½“è¯†åˆ«å¹¶ä¸ä¹‹ç»“åˆã€‚æ–°åˆæˆè›‹ç™½åœ¨ä¿¡å·è‚½å¼•å¯¼ä¸‹åˆ°è¾¾å†…è´¨ç½‘å†…è…”ï¼Œè€Œä¿¡å·è‚½åˆ™åœ¨ä¿¡å·è‚½é…¶çš„ä½œç”¨ä¸‹è¢«åˆ‡é™¤ã€‚ç”±äºå®ƒçš„å¼•å¯¼ï¼Œæ–°ç”Ÿçš„å¤šè‚½å°±èƒ½å¤Ÿé€šè¿‡å†…è´¨ç½‘è†œè¿›å…¥è…”å†…ï¼Œæœ€ç»ˆè¢«åˆ†æ³Œåˆ°èƒå¤–ã€‚åœ¨å®¿ä¸»èŒä¸­è¡¨è¾¾å¤–æºè›‹ç™½æ—¶ï¼Œå¯ç”¨ä¿¡å·è‚½å¼•å¯¼å¤–æºè›‹ç™½å®šä½åˆ†æ³Œåˆ°èƒå¤–ï¼Œæé«˜è›‹ç™½å¯æº¶æ€§ï¼Œåœ¨åŸæ ¸è¡¨è¾¾ç³»ç»Ÿï¼ˆå¤§è‚ æ†èŒã€èŠ½å­¢æ†èŒç­‰ï¼‰å’ŒçœŸæ ¸è¡¨è¾¾ç³»ç»Ÿï¼ˆå¦‚æ¯•èµ¤é…µæ¯ï¼‰ä¸­å‡æœ‰åº”ç”¨ã€‚</li></ul><h3 id="6-ç£·é…¸åŒ–ä½ç‚¹åˆ†æ"><a href="#6-ç£·é…¸åŒ–ä½ç‚¹åˆ†æ" class="headerlink" title="6.ç£·é…¸åŒ–ä½ç‚¹åˆ†æ"></a><strong>6.ç£·é…¸åŒ–ä½ç‚¹åˆ†æ</strong></h3><ul><li><a href="https://link.zhihu.com/?target=http://www.cbs.dtu.dk/services/NetPhos/">NetPhos</a></li><li><a href="https://link.zhihu.com/?target=http://kinasephos2.mbc.nctu.edu.tw/">KinasePhos-2.0</a><br>è›‹ç™½è´¨ç£·é…¸åŒ–æŒ‡ç”±è›‹ç™½è´¨æ¿€é…¶å‚¬åŒ–çš„æŠŠ ATP çš„ç£·é…¸åŸºè½¬ç§»åˆ°åº•ç‰©è›‹ç™½è´¨æ°¨åŸºé…¸æ®‹åŸºï¼ˆä¸æ°¨é…¸ã€è‹æ°¨é…¸ã€é…ªæ°¨é…¸ï¼‰ä¸Šçš„è¿‡ç¨‹ï¼Œæˆ–è€…åœ¨ä¿¡å·ä½œç”¨ä¸‹ç»“åˆ GTPï¼ˆé€šå¸¸ä»¥ GTP å–ä»£ GDPï¼‰ï¼Œæ˜¯ç”Ÿç‰©ä½“å†…ä¸€ç§æ™®é€šçš„è°ƒèŠ‚æ–¹å¼ï¼Œåœ¨ç»†èƒä¿¡å·è½¬å¯¼çš„è¿‡ç¨‹ä¸­èµ·é‡è¦ä½œç”¨ã€‚åœ¨ä¿¡å·è¾¾åˆ°æ—¶é€šè¿‡è·å¾—ä¸€ä¸ªæˆ–å‡ ä¸ªç£·é…¸é›†å›¢è€Œè¢«æ¿€æ´»ï¼Œè€Œåœ¨ä¿¡å·å‡å¼±æ—¶èƒ½å»é™¤è¿™äº›é›†å›¢ï¼Œä»è€Œå¤±å»æ´»æ€§ã€‚æœ‰æ—¶æŸä¸ªä¿¡å·è›‹ç™½ç£·é…¸åŒ–é€šå¸¸é€ æˆä¸‹æ¸¸çš„è›‹ç™½ä¾æ¬¡å‘ç”Ÿç£·é…¸åŒ–ï¼Œå½¢æˆç£·é…¸åŒ–çº§è”ååº”ã€‚</li></ul><p>refï¼š <a href="https://zhuanlan.zhihu.com/p/79626339">https://zhuanlan.zhihu.com/p/79626339</a></p>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>database</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ncRNA prediction</title>
    <link href="/GeekFocus/2022/05/29/2022-05-29-ncRNA-prediction/"/>
    <url>/GeekFocus/2022/05/29/2022-05-29-ncRNA-prediction/</url>
    
    <content type="html"><![CDATA[<p>ncRNA prediction</p><span id="more"></span><p><a href="http://www.eilersgenomics.com/annotation/rfam_infernal/">http://www.eilersgenomics.com/annotation/rfam_infernal/</a></p><h1 id="tRNAscanSE-2-0-9"><a href="#tRNAscanSE-2-0-9" class="headerlink" title="tRNAscanSE 2.0.9"></a>tRNAscanSE 2.0.9</h1><p><a href="http://trna.ucsc.edu/tRNAscan-SE/">http://trna.ucsc.edu/tRNAscan-SE/</a></p><h2 id="1-tRNAscan-SE-ç®€ä»‹"><a href="#1-tRNAscan-SE-ç®€ä»‹" class="headerlink" title="1. tRNAscan-SE ç®€ä»‹"></a>1. tRNAscan-SE ç®€ä»‹</h2><p>tRNAscan-SE èƒ½åœ¨åŸºå› ç»„æ°´å¹³è¿›è¡Œ tRNA æ‰«æã€‚è¯¥è½¯ä»¶æ˜¯ä¸€ä¸ª perl è„šæœ¬ï¼Œæ•´åˆ tRNAscanã€ EufindRNA å’Œ Cove è¿™ 3 ä¸ªç‹¬ç«‹çš„ tRNA æ£€æµ‹è½¯ä»¶ã€‚tRNAscan-SE é¦–å…ˆè°ƒç”¨ tRNAscan å’Œ EufindRNA é‰´å®šåŸºå› ç»„åºåˆ—ä¸­çš„ tRNA åŒºåŸŸï¼Œç„¶åè°ƒç”¨ Cove éªŒè¯ã€‚æ—¢ä¿è¯å‰è€…çš„ sensitivitiesï¼Œ åˆä¿è¯åè€…è¾ƒä½çš„å‡é˜³æ€§æ¦‚ç‡ï¼ŒåŒæ—¶æé«˜æœç´¢é€Ÿåº¦ã€‚</p><h2 id="2-tRNAscan-SE-æœ¬åœ°å®‰è£…"><a href="#2-tRNAscan-SE-æœ¬åœ°å®‰è£…" class="headerlink" title="2. tRNAscan-SE æœ¬åœ°å®‰è£…"></a>2. tRNAscan-SE æœ¬åœ°å®‰è£…</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">./configure --prefix=<span class="hljs-built_in">local</span> &amp;&amp;  make &amp;&amp; make insatll<br><span class="hljs-built_in">echo</span>  <span class="hljs-variable">$PERL5LIB</span><br>-bash: /home/user/perl5/lib/perl5<br><span class="hljs-built_in">which</span> perl<br>/usr/bin/perl<br>no conda . fat or loginal. root perl, <span class="hljs-built_in">local</span> lib<br></code></pre></td></tr></table></figure><h2 id="3-ä½¿ç”¨ä¸å‚æ•°"><a href="#3-ä½¿ç”¨ä¸å‚æ•°" class="headerlink" title="3. ä½¿ç”¨ä¸å‚æ•°"></a>3. ä½¿ç”¨ä¸å‚æ•°</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">tRNAscan-SE -o tRNA.out -f rRNA.ss -m tRNA.stats genome.fasta<br><span class="hljs-comment">#-E         : search for eukaryotic tRNAs (default)</span><br><span class="hljs-comment">#  -f &lt;file&gt;  : save tRNA secondary structures to &lt;file&gt;å°† tRNA çš„äºŒçº§ç»“æ„ç»“æœä¿å­˜åˆ°æ–‡ä»¶</span><br><span class="hljs-comment">#  -m &lt;file&gt;  : save statistics summary for run in &lt;file&gt;å°†ç»Ÿè®¡ç»“æœä¿å­˜åˆ°æ–‡ä»¶</span><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">-- default: use Infernal &amp; tRNA covariance models with eukaryotic sequences <br>             (use -B, -A, -M, -O or -G to scan other types of sequences)<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># types of sequences</span><br> -B         : search <span class="hljs-keyword">for</span> bacterial tRNAs<br> -A         : search <span class="hljs-keyword">for</span> archaeal tRNAs. å¤ç»†èŒã€‚è¯¥å‚æ•°é€‰æ‹©å¤ç»†èŒç‰¹å¼‚æ€§çš„åæ–¹å·®æ¨¡å‹ï¼ŒåŒæ—¶ç¨å¾®æ”¾å®½ EufindtRNA çš„ cutoffs<br> -M &lt;model&gt; : search <span class="hljs-keyword">for</span> mitochondrial tRNAs<br>                options: mammal, vert<br> -O         : search <span class="hljs-keyword">for</span> other organellar tRNAs. çº¿ç²’ä½“å’Œå¶ç»¿ä½“ã€‚è¯¥å‚æ•°ä»…ä½¿ç”¨ Cove è¿›è¡Œåˆ†æï¼Œæœç´¢é€Ÿåº¦ä¼šå¾ˆæ…¢ï¼ŒåŒæ—¶ä¸èƒ½ç»™å‡º pseudogenes æ£€æµ‹ã€‚<br> -G         : use general tRNA model (cytoslic tRNAs from all 3 domains included)å¤ç»†èŒï¼Œç»†èŒå’ŒçœŸæ ¸ç”Ÿç‰©çš„æ··åˆåºåˆ—ã€‚ä½¿ç”¨ general tRNA åæ–¹å·®æ¨¡å‹ã€‚<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh">-L         : search using the legacy method (tRNAscan, EufindtRNA, and COVE)<br>               use with -E, -B, -A, -O, or -G<br>-I         : search using Infernal (default)<br>               use with -E, -B, -A, -O, or -G<br>-o &lt;file&gt;  : save final results <span class="hljs-keyword">in</span> &lt;file&gt;ç»“æœæ–‡ä»¶<br>-f &lt;file&gt;  : save tRNA secondary structures to &lt;file&gt;å°† tRNA çš„äºŒçº§ç»“æ„ç»“æœä¿å­˜åˆ°æ–‡ä»¶<br>-m &lt;file&gt;  : save statistics summary <span class="hljs-keyword">for</span> run <span class="hljs-keyword">in</span> &lt;file&gt;å°†ç»Ÿè®¡ç»“æœä¿å­˜åˆ°æ–‡ä»¶<br>             (speed, <span class="hljs-comment"># tRNAs found in each part of search, etc)</span><br>-H         : show both primary and secondary structure components to<br>             covariance model bit scores<br>-q         : quiet mode (credits &amp; run option selections suppressed)<br></code></pre></td></tr></table></figure><h2 id="4-ç»“æœè¯´æ˜"><a href="#4-ç»“æœè¯´æ˜" class="headerlink" title="4. ç»“æœè¯´æ˜"></a>4. ç»“æœè¯´æ˜</h2><p>çœŸæ ¸ç”Ÿç‰©tRNA ç”± RNA èšåˆé…¶III åœ¨æ ¸å†…è½¬å½•ç”Ÿæˆ pre-tRNA, å†è¿›è¡ŒåŠ å·¥ç”Ÿæˆæœ‰åŠŸèƒ½çš„ tRNA åˆ†å­ï¼ˆç‰¹åˆ«æ˜¯ä¸€äº› tRNA åºåˆ—è¿˜å«æœ‰å†…å«å­ï¼‰ã€‚è‹¥ tRNA å­˜åœ¨å†…å«å­ï¼Œåˆ™ç»“æœæ–‡ä»¶ä¸­ç¬¬ 7 8 åˆ—ä¼šç»™å‡ºå†…å«å­åŒºé—´ï¼Œå¦åˆ™å…¶å€¼ä¸º 0 ã€‚<br>tRNAscan-SE çš„ç»“æœä¸­, å¦‚æœ begin æ¯” end çš„å€¼å¤§ï¼Œåˆ™è¡¨ç¤º tRNA åœ¨è´Ÿä¹‰é“¾ã€‚</p><p>æœ‰äº›ç»“æœä¸­ç¬¬ 5 åˆ—ä¸º pseudogeneï¼Œ è¿™è¡¨ç¤ºå…¶ä¸€çº§æˆ–äºŒçº§ç»“æ„æ¯”è¾ƒå·®ã€‚</p><p>æœ€åä¸€åˆ—æ˜¯ Cove Scoreï¼Œè¯¥åˆ†å€¼æœ€ä½é˜ˆå€¼ä¸º 20 ã€‚è¯¥å€¼æ˜¯ä¸€ä¸ª log ratioå€¼ã€‚ratio æ˜¯ç¬¦åˆ tRNA åæ–¹å·®æ¨¡å‹æ¦‚ç‡ä¸éšæœºåºåˆ—æ¨¡å‹æ¦‚ç‡çš„æ¯”å€¼ã€‚</p><p>æœ€åæœ€å¥½æ˜¯å°†è¡¨æ ¼æ ¼å¼ç»“æœè½¬æ¢ä¸º GFF3 ç»“æœï¼Œä»¥åˆ©äºåœ¨åŸºå› ç»„ä¸Šçš„å¯è§†åŒ–ã€‚</p><h2 id="5-è¿‡æ»¤"><a href="#5-è¿‡æ»¤" class="headerlink" title="5. è¿‡æ»¤"></a>5. è¿‡æ»¤</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sh">Usage: EukHighConfidenceFilter [options]<br>Options<br>--result -i &lt;file&gt;         tRNAscan-SE output file used as input<br>--ss -s &lt;file&gt;             tRNAscan-SE secondary structure file used as input<br>--output -o &lt;file path&gt;    Directory <span class="hljs-built_in">where</span> output files will be written<br>--prefix -p &lt;name&gt;         Prefix <span class="hljs-keyword">for</span> output file name<br>--remove -r                Remove filtered tRNA hits (default: filtered tRNA hits are only tagged)<br>--cmscore1 -c1 &lt;num&gt;       Domain-specific model score cutoff <span class="hljs-keyword">for</span> secondary filtering (default = 50; -1 <span class="hljs-keyword">if</span> not used <span class="hljs-keyword">for</span> filtering)<br>--ssscore1 -m1 &lt;num&gt;       Secondary structure score cutoff <span class="hljs-keyword">for</span> secondary filtering (default = 10; -1 <span class="hljs-keyword">if</span> not used <span class="hljs-keyword">for</span> filtering)<br>--isoscore1 -e1 &lt;num&gt;      Isotype-specific model score cutoff <span class="hljs-keyword">for</span> secondary filtering (default = 70; -1 <span class="hljs-keyword">if</span> not used <span class="hljs-keyword">for</span> filtering)<br>--isoscore2 -e2 &lt;num&gt;      Isotype-specific model starting score cutoff <span class="hljs-keyword">for</span> tertiary filtering (default = 70; -1 <span class="hljs-keyword">if</span> not used <span class="hljs-keyword">for</span> filtering)<br>--isomaxscore2 -x &lt;num&gt;    Maximum isotype-specific model score cutoff <span class="hljs-keyword">for</span> tertiary filtering (default = 95)<br>--<span class="hljs-built_in">help</span> -h                  Print this <span class="hljs-built_in">help</span><br><br></code></pre></td></tr></table></figure><h2 id="error"><a href="#error" class="headerlink" title="error"></a>error</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">FATAL: Unable to find ~/software/opt/biosoft/tRNAscan-SE/bin/cmsearch executable<br><span class="hljs-comment">#https://bioinformatics.stackexchange.com/questions/4637/trnascan-se-error-fatal-unable-to-find-usr-local-bin-cmsearch-executable</span><br><br>tRNAscan-SE 2.0 requires separate installation of Infernal 1.1.2. The <span class="hljs-built_in">source</span> code and prebuilt binaries can be obtained at http://eddylab.org/infernal/.<br><br>The installation directory of Infernal should be the same as the one <span class="hljs-built_in">where</span> tRNAscan-SE 2.0 is installed.<br><br>When install infernal, run the configure <span class="hljs-built_in">command</span> with the option --prefix &lt;your tRNAscan-SE-2.0 install path&gt;. If you didn<span class="hljs-string">&#x27;t add option --prefix when installing tRNAscan-SE-2.0, then you should install infernal without option --prefix.</span><br></code></pre></td></tr></table></figure><h2 id="error2-still"><a href="#error2-still" class="headerlink" title="error2 still"></a>error2 still</h2><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs subunit"><span class="hljs-keyword">Error: </span>This filter requires isotype-specific model scan result in the tRNAscan-SE v2 output file.<br><br></code></pre></td></tr></table></figure><h1 id="Infernal"><a href="#Infernal" class="headerlink" title="Infernal"></a>Infernal</h1><p><a href="http://eddylab.org/infernal/">http://eddylab.org/infernal/</a></p><p>User-guide: <a href="http://eddylab.org/infernal/Userguide.pdf">http://eddylab.org/infernal/Userguide.pdf</a></p><h2 id="1-å®‰è£…åœ¨tRNAscanSEæ–‡ä»¶å¤¹å†…"><a href="#1-å®‰è£…åœ¨tRNAscanSEæ–‡ä»¶å¤¹å†…" class="headerlink" title="1. å®‰è£…åœ¨tRNAscanSEæ–‡ä»¶å¤¹å†…"></a>1. å®‰è£…åœ¨tRNAscanSEæ–‡ä»¶å¤¹å†…</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> tRNAscanSE<br><span class="hljs-built_in">cd</span> infernal<br>./configure --prefix=/path/tRNAscan-SE<br>make<br>make install<br></code></pre></td></tr></table></figure><p>å†…éƒ¨å†å®‰è£…</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">cd easel/<br>.<span class="hljs-regexp">/configure --prefix=/</span>path<span class="hljs-regexp">/tRNAscan-SE/</span>bin<br>make<br>make install<br></code></pre></td></tr></table></figure><h2 id="2-æ•°æ®åº“ä¸‹è½½"><a href="#2-æ•°æ®åº“ä¸‹è½½" class="headerlink" title="2. æ•°æ®åº“ä¸‹è½½"></a>2. æ•°æ®åº“ä¸‹è½½</h2><p>Rfamæ•°æ®åº“<a href="https://rfam.xfam.org/">https://rfam.xfam.org</a></p><p>The Rfam database is a collection of RNA families, each represented by <strong>multiple sequence alignments,consensus secondary structures and covariance models</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">mkdir</span> 00.rd6.ncRNA<br><span class="hljs-built_in">cd</span> 00.rd6.ncRNA/<br><span class="hljs-built_in">mkdir</span> Rfam<br><br><span class="hljs-built_in">mkdir</span> Rfam &amp;&amp; <span class="hljs-built_in">cd</span> Rfam  <br>http://ftp.ebi.ac.uk/pub/databases/Rfam/14.8/<br><br>wget ftp://ftp.ebi.ac.uk/pub/databases/Rfam/14.8/Rfam.cm.gz<br>gunzip Rfam.cm.gz<br>wget ftp://ftp.ebi.ac.uk/pub/databases/Rfam/14.8/Rfam.clanin<br><span class="hljs-comment"># ä½¿ç”¨ Infernalçš„ç¨‹åºcmpressç´¢å¼•Rfam.cm # å¤§çº¦éœ€è¦ä¸€åˆ†é’Ÿ</span><br>tRNAscan-SE/bin/cmpress Rfam.cm<br><br><span class="hljs-comment">#my</span><br>Working...    <span class="hljs-keyword">done</span>.<br>Pressed and indexed 4094 CMs and p7 HMM filters (4094 names and 4094 accessions).<br>Covariance models and p7 filters pressed into binary file:  Rfam.cm.i1m<br>SSI index <span class="hljs-keyword">for</span> binary covariance model file:                 Rfam.cm.i1i<br>Optimized p7 filter profiles (MSV part)  pressed into:      Rfam.cm.i1f<br>Optimized p7 filter profiles (remainder) pressed into:      Rfam.cm.i1p<br><br><span class="hljs-comment"># è¾“å‡ºä¸º</span><br>Working...    <span class="hljs-keyword">done</span>.<br>Pressed and indexed 3016 CMs and p7 HMM filters (3016 names and 3016 accessions).<br>Covariance models and p7 filters pressed into binary file:  Rfam14.1.cm.i1m<br>SSI index <span class="hljs-keyword">for</span> binary covariance model file:                 Rfam14.1.cm.i1i<br>Optimized p7 filter profiles (MSV part)  pressed into:      Rfam14.1.cm.i1f<br>Optimized p7 filter profiles (remainder) pressed into:      Rfam14.1.cm.i1p<br></code></pre></td></tr></table></figure><h2 id="3-ç¡®å®šå¾…æŸ¥è¯¢çš„æ ¸è‹·é…¸åºåˆ—æˆ–åŸºå› ç»„çš„å¤§å°ï¼Œä½œä¸ºåç»­å‘½ä»¤çš„å‚æ•°"><a href="#3-ç¡®å®šå¾…æŸ¥è¯¢çš„æ ¸è‹·é…¸åºåˆ—æˆ–åŸºå› ç»„çš„å¤§å°ï¼Œä½œä¸ºåç»­å‘½ä»¤çš„å‚æ•°" class="headerlink" title="3. ç¡®å®šå¾…æŸ¥è¯¢çš„æ ¸è‹·é…¸åºåˆ—æˆ–åŸºå› ç»„çš„å¤§å°ï¼Œä½œä¸ºåç»­å‘½ä»¤çš„å‚æ•°"></a>3. ç¡®å®šå¾…æŸ¥è¯¢çš„æ ¸è‹·é…¸åºåˆ—æˆ–åŸºå› ç»„çš„å¤§å°ï¼Œä½œä¸ºåç»­å‘½ä»¤çš„å‚æ•°</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#esl-seqstat my-genome.fa</span><br>tRNAscan-SE/bin/bin/esl-seqstat my-genome.fa<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sh">Format:              FASTA<br>Alphabet <span class="hljs-built_in">type</span>:       DNA<br>Number of sequences: 7<br>Total <span class="hljs-comment"># residues:    1242924374</span><br>Smallest:            159833148<br>Largest:             221855282<br>Average length:      177560624.0<br>Z=1242924374*2*4094/1000000=10177064<br><br>Format:              FASTA<br>Alphabet <span class="hljs-built_in">type</span>:       DNA<br>Number of sequences: 7<br>Total <span class="hljs-comment"># residues:    1218819104</span><br>Smallest:            156984786<br>Largest:             222281709<br>Average length:      174117008.0<br>Z=1218819104*2*4094/1000000=9979690<br></code></pre></td></tr></table></figure><p>å…¶è¾“å‡ºç»“æœä¸­æœ‰ä¸€è¡Œï¼ŒTotal # of residues: 218502668æ˜¯éœ€è¦çš„ã€‚è€ƒè™‘åˆ°åŸºå› ç»„ä¸ºåŒé“¾å’Œä¸‹ä¸€æ­¥ç”¨åˆ°çš„å‚æ•°çš„å•ä½ä¸ºMillionã€‚<br>è®¡ç®—å…¬å¼ä¸ºï¼šZ &#x3D; total * 2 * CMmumber&#x2F;106<br>å› æ­¤è¿˜è¦è®¡ç®—CM databaseä¸­çš„æ¨¡å‹çš„æ•°é‡ï¼ˆZ&#x3D;2636016ï¼‰<br>åœ¨Rfam14.0ç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨</p><h2 id="4-Some-user-guide"><a href="#4-Some-user-guide" class="headerlink" title="4. Some user guide"></a>4. Some user guide</h2><p><a href="http://eddylab.org/infernal/Userguide.pdf">http://eddylab.org/infernal/Userguide.pdf</a></p><p>Searching the Rfam CM database with a query sequence**</p><p>The Rfam database <a href="http://rfam.xfam.org/">http://rfam.xfam.org/</a> is <font color="blue">a collection of RNA families</font>, each represented by a CM and multiple sequence alignment used to build that CM. As of December 2020, the current release is 14.3, which includes 3446 families[<font color="blue">v14.8 4094</font>]. The Rfam website allows <font color="blue">web-based searches using <strong>cmscan</strong> of the <strong>Rfam CM database</strong> against <strong>query sequences</strong> that the user can upload</font>. Alternatively, you can perform the same searches by running cmscan locally, as shown in this example. <font color="blue">By searching all of Rfam with your sequence dataset</font>, you will <font color="red"><strong>annotate most known types of structural RNAs with a single command</strong></font>.</p><p>To complete this step of the tutorial youâ€™ll need to download the Rfam 14.3 CM file from here:<a href="ftp://ftp.ebi.ac.uk/pub/databases/Rfam/14.3/Rfam.cm.gz">ftp://ftp.ebi.ac.uk/pub/databases/Rfam/14.3/Rfam.cm.gz</a> and gunzipping it, like this:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">wget ftp://ftp.ebi.ac.uk/pub/databases/Rfam/14.3/Rfam.cm.gz<br>gunzip Rfam.cm.gz<br>cmpress Rfam.cm<br></code></pre></td></tr></table></figure><p>The next step is to run cmscan. In order to reproduce how Rfam searches are performed (Nawrocki et al., 2015) several command line options are required. Each of these options is explained below. The full command is :</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">cmscan --rfam --cut_ga --nohmmonly --tblout mrum-genome.tblout --<span class="hljs-built_in">fmt</span> 2 \<br>--clanin tutorial/Rfam.14.3.clanin Rfam.cm tutorial/mrum-genome.fa &gt; mrum-genome.cmscan<br></code></pre></td></tr></table></figure><p>This command will take at least several minutes and possibly up to about 30 minutes depending on the number of cores and speed of your computer. å¯¹500Må¤§å°çš„è¾“å…¥åºåˆ—ï¼Œ48çº¿ç¨‹ï¼Œè¦7å°æ—¶</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh">--rfam Specifies that the filter pipeline run <span class="hljs-keyword">in</span> fast mode, with the same strict filters that are used <span class="hljs-keyword">for</span> Rfam searches and <span class="hljs-keyword">for</span> other sequence databases larger than 20 Gb (see section 4).<br><br>--cutga SpecifiesthatthespecialRfam*GA*(gathering)thresholdsbeusedtodeterminewhichhitsarereported. These thresholds are stored <span class="hljs-keyword">in</span> the Rfam.cm file. Each model has its own GA bit score threshold, <span class="hljs-built_in">which</span> was determined by Rfam curators as the bit score at and above <span class="hljs-built_in">which</span> all hits are believed to be <span class="hljs-literal">true</span> homologs to the model. These determinations were made based on observed hit results against the large Rfamseq database used by Rfam (Nawrocki et al., 2015).<br><br>--nohmmonly All models, even those with zero basepairs, are run <span class="hljs-keyword">in</span> CM mode (not HMM mode). This ensures all GA cutoffs, <span class="hljs-built_in">which</span> were determined <span class="hljs-keyword">in</span> CM mode <span class="hljs-keyword">for</span> each model, are valid.<br><br>--tblout Specifies that a tabular output file should be created, see section 6.<br><br>--<span class="hljs-built_in">fmt</span> 2 The tabular output file will be <span class="hljs-keyword">in</span> format 2, <span class="hljs-built_in">which</span> includes annotation of overlapping hits. See page 61 <span class="hljs-keyword">for</span> a complete description of this format.<br><br>--clanin Clan information should be <span class="hljs-built_in">read</span> from the file tutorial/Rfam.14.3.claninfo. This file lists <span class="hljs-built_in">which</span> models belong to the same clan. Clans are <span class="hljs-built_in">groups</span> of models that are homologous and therefore it is expected that some hits to these models will overlap. For example, the LSU rRNA archaea and LSU rRNA bacteria models are both <span class="hljs-keyword">in</span> the same clan.<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">-g Turn on the glocal alignment algorithm, global with respect to the query model and <span class="hljs-built_in">local</span> with respect to the target database. By default, the <span class="hljs-built_in">local</span> alignment algorithm is used <span class="hljs-built_in">which</span> is <span class="hljs-built_in">local</span> with respect to both the target sequence and the model. In <span class="hljs-built_in">local</span> mode, the alignment to span two or more subsequences <span class="hljs-keyword">if</span> necessary (e.g. <span class="hljs-keyword">if</span> the structures of the query model and target sequence are only partially shared), allowing certain large insertions and deletions <span class="hljs-keyword">in</span> the structure to be penalized differently than normal indels. Local mode performs better on empirical benchmarks and is significantly more sensitive <span class="hljs-keyword">for</span> remote homology detection. Empirically, glocal searches <span class="hljs-built_in">return</span> many fewer hits than <span class="hljs-built_in">local</span> searches, so glocal may be desired <span class="hljs-keyword">for</span> some applications.<br>-Z &lt;x&gt; Calculate E-values as <span class="hljs-keyword">if</span> the search space size was &lt;x&gt; megabases (Mb). Without the use of this option, the search space size changes <span class="hljs-keyword">for</span> each query sequence, it is defined as the length of the current query sequence <span class="hljs-built_in">times</span> 2 (because both strands of the sequence will be searched) <span class="hljs-built_in">times</span> the number of CMs <span class="hljs-keyword">in</span> &lt;cmdb&gt;.<br></code></pre></td></tr></table></figure><p>When the cmscan command finishes running, the file mrum-genome.cmscan will contain the standard output of the program. This file will be similar to what we saw in the earlier example of cmscan. The file mrum-genome.tblout has also been created, which is a tabular representation of all hits, one line per hit. Take a look at this file. The first two lines are comment lines (prefixed with # characters) with the labels of each of the 27 columns of data in the file. Each subsequent line has 27 space delimited tokens. The specific meaning of these tokens is described in detail in section 6. Below Iâ€™m including the first 24 lines of the file, with columns 3-5, 7-9 and 13-16 removed (replaced with â€¦) so that the text will fit on this page:</p><p>This tabular format includes the target model name, sequence name (in column 3, which is omitted above to save space), clan name, sequence coordinates, bit score, E-value and more. Because the â€“fmt 2 option was used, this file includes information on which hits overlap with other hits, starting at the column labelled â€œolpâ€ and ending with â€œwfrct2â€. Hits with the â€œ*â€ character in the â€œolpâ€ column do not overlap with any other hits. Those with â€œË†â€ do overlap with at least one other hit, but none of those overlapping hits have a better score (that occurs higher in the list). Those with â€œ&#x3D;â€ also overlap with at least one other hit that does have a better score, the index of which is given in the â€œanyidxâ€ column. For more detailed explanation of these columns, see page 61.</p><p>The top two hits are both to the LSU rRNA archaea model. These are the two copies of LSU rRNA in the <em>Methanobrevibacter ruminantium</em> genome. Hits number 3 and 4 are to the LSU rRNA bacteria model and over- lap with hits 1 and 2 nearly completely (hit 1 is from sequence positions 762872 to 765862 and hit 3 is from sequence positions 762874 to 765862). This overlap is not surprising because the bacterial and archaeal LSU rRNA models are very similar, and so are assigning high scores to the same subsequences. Further, hit 5 is to LSU rRNA eukarya and also overlaps hits 1 and 3. Because these three LSU models are all expected to produce overlapping hits due to their homology, Rfam has grouped them into the same <em>clan</em>, note the â€œCL00112â€ value in the â€œclan nameâ€ column for all three hits. This clan information was provided in the rfam.14.3.claninfo input file we provided to cmscan by using the â€“clanin option.</p><p>The â€œolpâ€ column indicates that hit 1 is the highest scoring of the three overlapping hits because it contains the â€œË†â€ character. Hits 3 and 5 both have â€œ&#x3D;â€ in the â€œolpâ€ column indicating that there is another hit to another model which overlaps these hits and has a better score.</p><p>If you were using these results to produce annotations for the <em>Methanobrevibacter ruminantium</em> genome, you may want to ignore any hits that have higher scoring overlaps. To do this you can just remove any hits with â€œ&#x3D;â€ in the â€œolpâ€ column. Alternatively, you can have these hits not printed to the tabular output file by additionally providing the â€“oskip option to cmscan. You can also modify the overlap annotation behavior with â€“oclan option which restricts the annotation of overlaps to hits for models within the same clan. Overlapping hits from models that are not in the same clan will not be marked as overlaps, instead they will marked as â€œ*â€ in the â€œolpâ€ field.</p><p>For more information on using Infernal for genome annotation see a similar example in the Rfam documentation (<a href="https://rfam.readthedocs.io/en/latest/genome-annotation.html">https://rfam.readthedocs.io/en/latest/genome-annotation.html</a>)</p><h2 id="5-Parameter-amp-Running"><a href="#5-Parameter-amp-Running" class="headerlink" title="5. Parameter &amp; Running"></a>5. Parameter &amp; Running</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># Rfam14.1.clanin ä¸ºä¸‹è½½çš„claninfoæ–‡ä»¶ï¼Œéœ€æä¾›æ‰€åœ¨è·¯å¾„</span><br><span class="hljs-comment"># Rfam.cm ä¸‹è½½çš„cmæ–‡ä»¶</span><br><span class="hljs-comment">#nep_genome.fa å¾…æŸ¥è¯¢åºåˆ—</span><br><span class="hljs-comment"># nep.cmscan è¾“å‡ºç»“æœ</span><br><span class="hljs-comment"># nep.tblout è¡¨æ ¼å½¢å¼è¾“å‡ºç»“æœ</span><br><span class="hljs-comment"># å¯¹500Må¤§å°çš„è¾“å…¥åºåˆ—ï¼Œ48çº¿ç¨‹ï¼Œéœ€è¦7ä¸ªå°æ—¶ï¼Œæœ€å¥½æ”¾å…¥åå°</span><br>cmscan -Z 2636016 --cut_ga --rfam --nohmmonly --tblout mep_genome.tblout --<span class="hljs-built_in">fmt</span> 2 --cpu 24 --clanin Rfam14.1.clanin Rfam.cm nep_genome.fa &gt; nep.cmscan<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#official</span><br>cmscan --rfam --cut_ga --nohmmonly --tblout mrum-genome.tblout --<span class="hljs-built_in">fmt</span> 2 \<br>--clanin tutorial/Rfam.14.3.clanin Rfam.cm tutorial/mrum-genome.fa &gt; mrum-genome.cmscan<br></code></pre></td></tr></table></figure><h2 id="6-è¾“å‡ºç»“æœ"><a href="#6-è¾“å‡ºç»“æœ" class="headerlink" title="6. è¾“å‡ºç»“æœ"></a>6. è¾“å‡ºç»“æœ</h2><p>nep.tblout</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs tap"><span class="hljs-comment">#idx target name          accession query name           accession clan name mdl mdl from   mdl to seq from   seq to strand trunc pass   gc  bias  score   E-value inc olp anyidx afrct1 afrct2 winidx wfrct1 wfrct2 description of target</span><br><span class="hljs-comment">#--- -------------------- --------- -------------------- --------- --------- --- -------- -------- -------- -------- ------ ----- ---- ---- ----- ------ --------- --- --- ------ ------ ------ ------ ------ ------ ---------------------</span><br>1    mir-7                RF00053   contig_1000          -         -          cm       <span class="hljs-number"> 1 </span>     <span class="hljs-number"> 88 </span>  <span class="hljs-number"> 51272 </span>  <span class="hljs-number"> 51359 </span>     +    no   <span class="hljs-number"> 1 </span>0.38   0.0   58.2   1.9e-06  !   *       -      -      -      -      -      - mir-7 microRNA precursor<br>2    MIR1122              RF00906   contig_1000          -         -          cm       <span class="hljs-number"> 1 </span>    <span class="hljs-number"> 135 </span> <span class="hljs-number"> 137126 </span> <span class="hljs-number"> 137273 </span>     +    no   <span class="hljs-number"> 1 </span>0.20  26.4   37.6       4.1  ?   *       -      -      -      -      -      - microRNA MIR1122<br>1    tRNA                 RF00005   contig_10006         -         CL00001    cm       <span class="hljs-number"> 1 </span>     <span class="hljs-number"> 71 </span>    <span class="hljs-number"> 616 </span>    <span class="hljs-number"> 707 </span>     +    no   <span class="hljs-number"> 1 </span>0.53   0.0   49.7   0.00039  !   *       -      -      -      -      -      - tRNA<br>1    sno_ZL1              RF02723   contig_10010         -         -          cm      <span class="hljs-number"> 36 </span>    <span class="hljs-number"> 107 </span> <span class="hljs-number"> 101457 </span> <span class="hljs-number"> 101528 </span>     +    no   <span class="hljs-number"> 1 </span>0.28   0.1   31.7       3.2  ?   *       -      -      -      -      -      - Small nucleolar RNA ZL1<br>1    Histone3             RF00032   contig_10016         -         -          cm       <span class="hljs-number"> 1 </span>     <span class="hljs-number"> 46 </span> <span class="hljs-number"> 104440 </span> <span class="hljs-number"> 104394 </span>     -    no   <span class="hljs-number"> 1 </span>0.30   0.0   33.2     0.044  ?   *       -      -      -      -      -      - Histone 3&#x27; UTR stem-loop<br>1    LSU_rRNA_bacteria    RF02541   contig_10019         -         CL00112    cm       <span class="hljs-number"> 1 </span>   <span class="hljs-number"> 2925 </span>  <span class="hljs-number"> 51575 </span>  <span class="hljs-number"> 54339 </span>     +    no   <span class="hljs-number"> 1 </span>0.44  53.8 2654.9        <span class="hljs-number"> 0 </span> !   ^       -      -      -      -      -      - Bacterial large subunit ribosomal RNA<br>2    LSU_rRNA_archaea     RF02540   contig_10019         -         CL00112    cm       <span class="hljs-number"> 1 </span>   <span class="hljs-number"> 2990 </span>  <span class="hljs-number"> 51574 </span>  <span class="hljs-number"> 54338 </span>     +    no   <span class="hljs-number"> 1 </span>0.44  54.3 1799.6        <span class="hljs-number"> 0 </span> !   =      <span class="hljs-number"> 1 </span> 1.000  1.000      &quot;      &quot;      &quot; Archaeal large subunit ribosomal RNA<br><span class="hljs-comment">## æ¯ä¸€è¡Œæœ‰27åˆ—ï¼Œæ¯”è¾ƒå…³é”®çš„æ˜¯`target name`, `accession`, `query name`, `seq from`, `seq to`, `strand`, `E-value`, `score`ã€‚</span><br>`olp`åˆ—è¡¨ç¤ºæŸ¥è¯¢åºåˆ—çš„é‡å ä¿¡æ¯ï¼Œ`*`è¡¨ç¤ºåŒä¸€æ¡é“¾ä¸Šï¼Œä¸å­˜åœ¨ä¸æ­¤æŸ¥è¯¢åºåˆ—é‡å çš„åºåˆ—ä¹Ÿåœ¨Rfamæ•°æ®åº“æœ‰åŒ¹é…ï¼Œè¿™æ˜¯éœ€è¦ä¿ç•™çš„æŸ¥è¯¢åºåˆ—ã€‚`^`è¡¨ç¤ºåŒä¸€æ¡é“¾ä¸Šï¼Œä¸å­˜åœ¨æ¯”æ­¤æŸ¥è¯¢åºåˆ—ä¸Rfamæ•°æ®åº“åŒ¹é…æ›´å¥½çš„åºåˆ—ï¼Œä¹Ÿéœ€è¦ä¿ç•™ã€‚`=`è¡¨ç¤ºåŒä¸€æ¡é“¾ä¸Šï¼Œå­˜åœ¨æ¯”æ­¤æŸ¥è¯¢åºåˆ—ä¸Rfamæ•°æ®åº“åŒ¹é…æ›´å¥½çš„åºåˆ—ï¼Œåº”å¿½ç•¥ã€‚<br><span class="hljs-comment">## å¯é€šè¿‡ä¸‹é¢çš„å‘½ä»¤è·å–æœ€ç»ˆç»“æœã€‚</span><br>â€‹```bash<br>grep -v &#x27;=&#x27; nep.tblout &gt;nep .deoverlapped.tblout<br></code></pre></td></tr></table></figure><h2 id="7-ç»“æœè§£æ"><a href="#7-ç»“æœè§£æ" class="headerlink" title="7. ç»“æœè§£æ"></a>7. ç»“æœè§£æ</h2><p>å¾—åˆ°tblout.finalï¼Œ</p><h3 id="1-è½¬æ¢ä¸‹ç»“æœæ ¼å¼"><a href="#1-è½¬æ¢ä¸‹ç»“æœæ ¼å¼" class="headerlink" title="1. è½¬æ¢ä¸‹ç»“æœæ ¼å¼"></a>1. è½¬æ¢ä¸‹ç»“æœæ ¼å¼</h3><p>å¾—åˆ°tblout.finalï¼Œè½¬æ¢ä¸‹ç»“æœæ ¼å¼ï¼Œæå–å¿…é¡»å¾—åˆ—å’Œéé‡å åŒºåŸŸæˆ–é‡å åŒºåŸŸä¸­å¾—åˆ†é«˜çš„åŒºåŸŸã€‚<br>&#x3D;è¡¨ç¤ºåŒä¸€æ¡é“¾ä¸Šï¼Œå­˜åœ¨æ¯”æ­¤æŸ¥è¯¢åºåˆ—ä¸Rfamæ•°æ®åº“åŒ¹é…æ›´å¥½çš„åºåˆ—ï¼Œåº”å¿½ç•¥ã€‚<br>å»æ‰#å¼€å¤´çš„æ³¨é‡Šè¡Œ æå–æ‰€éœ€è¦çš„åˆ—ã€‚åˆå§‹å°†åˆ†éš”ç¬¦è®¾å®šä¸ºåˆ¶è¡¨ç¬¦ã€‚<br>å¦‚æœæ˜¯ç¬¬ä¸€è¡Œï¼Œæ‰“å°è¡Œåç§° ç¬¬3è¡Œå¼€å§‹ï¼Œå¦‚æœ20åˆ—ä¸æ˜¯ç­‰å·ï¼Œä¸”ä¸ä»¥äº•å·å¼€å§‹ï¼Œæ‰“å°2,3,4ç­‰åˆ—è¾“å‡º</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs swift">awk &#x27;<span class="hljs-type">BEGIN</span>&#123;<span class="hljs-type">OFS</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;<span class="hljs-subst">\t</span>&quot;</span>;&#125;&#123;<span class="hljs-keyword">if</span>(<span class="hljs-type">FNR</span><span class="hljs-operator">==</span><span class="hljs-number">1</span>) print <span class="hljs-string">&quot;target_name<span class="hljs-subst">\t</span>accession<span class="hljs-subst">\t</span>query_name<span class="hljs-subst">\t</span>query_start<span class="hljs-subst">\t</span>query_end<span class="hljs-subst">\t</span>strand<span class="hljs-subst">\t</span>score<span class="hljs-subst">\t</span>Evalue&quot;</span>; <span class="hljs-keyword">if</span>(<span class="hljs-type">FNR</span><span class="hljs-operator">&gt;</span><span class="hljs-number">2</span> <span class="hljs-operator">&amp;&amp;</span> <span class="hljs-variable">$20</span><span class="hljs-operator">!=</span><span class="hljs-string">&quot;=&quot;</span> <span class="hljs-operator">&amp;&amp;</span> <span class="hljs-variable">$0</span><span class="hljs-operator">!~/^</span>#<span class="hljs-operator">/</span>) print <span class="hljs-variable">$2</span>,<span class="hljs-variable">$3</span>,<span class="hljs-variable">$4</span>,<span class="hljs-variable">$10</span>,<span class="hljs-variable">$11</span>,<span class="hljs-variable">$12</span>,<span class="hljs-variable">$17</span>,<span class="hljs-variable">$18</span>; &#125;&#x27; nep.tblout <span class="hljs-operator">&gt;</span>nep_genome.tblout.final.xls<br></code></pre></td></tr></table></figure><h3 id="2-ä¸‹è½½Rfamæ³¨é‡Š"><a href="#2-ä¸‹è½½Rfamæ³¨é‡Š" class="headerlink" title="2. ä¸‹è½½Rfamæ³¨é‡Š"></a>2. ä¸‹è½½Rfamæ³¨é‡Š</h3><p><em>é¦–å…ˆä¸‹è½½Rfamå®¶æ—çš„æ³¨é‡Šï¼Œç‚¹å‡»Rfamç½‘å€ï¼Œé€‰æ‹©æ‰€æœ‰å¤é€‰æ¡†ï¼Œæäº¤ï¼ŒæŠŠå¾—åˆ°çš„è¡¨æ ¼æ‹·è´ä¸‹æ¥ï¼Œæ•´ç†æˆTABé”®åˆ†å‰²çš„æ ¼å¼ã€‚å°†ç¬¬ä¸‰åˆ—çš„ç¬¬äºŒä¸ªåˆ†å·ä¿¡æ¯æå–å‡ºæ¥ï¼Œè¿™å°±æ˜¯å„ncRNA class</em></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">cat</span> rfamannotation.txt | awk &#x27;BEGIN &#123;FS=OFS=<span class="hljs-string">&quot;\t&quot;</span>&#125;&#123;split($<span class="hljs-number">3</span>,x,<span class="hljs-string">&quot;;&quot;</span>);class=x[<span class="hljs-number">2</span>];print $<span class="hljs-number">1</span>,$<span class="hljs-number">2</span>,$<span class="hljs-number">3</span>,class&#125;&#x27; &gt; rfam_anno_class.txt<br></code></pre></td></tr></table></figure><h3 id="3-ç»Ÿè®¡ncRNAæ•°é‡"><a href="#3-ç»Ÿè®¡ncRNAæ•°é‡" class="headerlink" title="3. ç»Ÿè®¡ncRNAæ•°é‡"></a>3. ç»Ÿè®¡ncRNAæ•°é‡</h3><p><em>å…ˆè¯»æ–‡ä»¶1ï¼Œå°†åˆ—2å’Œåˆ—4ä¹Ÿå°±æ˜¯åç§°å’ŒclassæŒ‰å…³ç³»å­˜å…¥å­—å…¸aã€‚å†è¯»æ–‡ä»¶2ï¼Œæ¯ä¸€è¡Œï¼Œç”¨è‡ªå·±çš„åˆ—1ä¹Ÿå°±æ˜¯åç§°å»æŸ¥è¯¢å­—å…¸ï¼Œå¾—åˆ°classï¼Œå­˜å…¥typeå˜é‡ï¼Œå¹¶è®¡æ•°</em></p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">awk &#x27;BEGIN&#123;OFS=FS=<span class="hljs-string">&quot;\t&quot;</span>&#125;ARGIND==1&#123;a[<span class="hljs-variable">$2</span>]=<span class="hljs-variable">$4</span>;&#125;ARGIND==2&#123;<span class="hljs-keyword">type</span>=a[<span class="hljs-variable">$1</span>]; <span class="hljs-keyword">if</span>(<span class="hljs-keyword">type</span>==<span class="hljs-string">&quot;&quot;</span>) <span class="hljs-keyword">type</span>=<span class="hljs-string">&quot;Others&quot;</span>; <span class="hljs-keyword">count</span>[<span class="hljs-keyword">type</span>]+=1;&#125;END&#123;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">type</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">count</span>) <span class="hljs-keyword">print</span> <span class="hljs-keyword">type</span>, <span class="hljs-keyword">count</span>[<span class="hljs-keyword">type</span>];&#125;&#x27; rfam_anno_class.txt nep_genome.tblout.final.xls<br></code></pre></td></tr></table></figure><h3 id="4-ç»Ÿè®¡å„ç±»å‹RNAçš„æ€»é•¿åº¦"><a href="#4-ç»Ÿè®¡å„ç±»å‹RNAçš„æ€»é•¿åº¦" class="headerlink" title="4. ç»Ÿè®¡å„ç±»å‹RNAçš„æ€»é•¿åº¦"></a>4. ç»Ÿè®¡å„ç±»å‹RNAçš„æ€»é•¿åº¦</h3><figure class="highlight wasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs wasm">awk &#x27;BEGIN&#123;OFS=FS=<span class="hljs-string">&quot;\t&quot;</span>&#125;ARGIND==<span class="hljs-number">1</span>&#123;a[<span class="hljs-variable">$2</span>]=<span class="hljs-variable">$4</span>;&#125;ARGIND==<span class="hljs-number">2</span>&#123;<span class="hljs-keyword">type</span>=a[<span class="hljs-variable">$1</span>]; <span class="hljs-keyword">if</span><span class="hljs-punctuation">(</span><span class="hljs-keyword">type</span>==<span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-keyword">type</span>=<span class="hljs-string">&quot;Others&quot;</span>; <span class="hljs-keyword">if</span><span class="hljs-punctuation">(</span><span class="hljs-variable">$6</span>==<span class="hljs-string">&quot;-&quot;</span><span class="hljs-punctuation">)</span>len[<span class="hljs-keyword">type</span>]+=<span class="hljs-variable">$4</span>-<span class="hljs-variable">$5</span><span class="hljs-number">+1</span>;<span class="hljs-keyword">if</span><span class="hljs-punctuation">(</span><span class="hljs-variable">$6</span>==<span class="hljs-string">&quot;+&quot;</span><span class="hljs-punctuation">)</span>len[<span class="hljs-keyword">type</span>]+=<span class="hljs-variable">$5</span>-<span class="hljs-variable">$4</span><span class="hljs-number">+1</span>&#125;END&#123;for<span class="hljs-punctuation">(</span><span class="hljs-keyword">type</span> in len<span class="hljs-punctuation">)</span> print <span class="hljs-keyword">type</span>, len[<span class="hljs-keyword">type</span>];&#125;&#x27; rfam_anno_class.txt nep_genome.tblout.final.xls<br></code></pre></td></tr></table></figure><p>Ref: <a href="https://www.jianshu.com/p/c072acba6bd6">https://www.jianshu.com/p/c072acba6bd6</a></p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>annotation</tag>
      
      <tag>ncRNA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LTR-RT/LTR REs</title>
    <link href="/GeekFocus/2022/05/25/2022-05-25-LTR/"/>
    <url>/GeekFocus/2022/05/25/2022-05-25-LTR/</url>
    
    <content type="html"><![CDATA[<p>Long terminal repeat-retrotransposons<br>LTR retroelements (LTR REs)</p><span id="more"></span><p><a href="https://bmcgenomics.biomedcentral.com/articles/10.1186/1471-2164-15-626#:~:text=LTR%20retroelements%20%28LTR%20REs%29%20constitute%20a%20major%20group,variability%2C%20thus%20contributing%20to%20genome%20structure%20and%20organization">https://bmcgenomics.biomedcentral.com/articles/10.1186/1471-2164-15-626#:~:text=LTR%20retroelements%20%28LTR%20REs%29%20constitute%20a%20major%20group,variability%2C%20thus%20contributing%20to%20genome%20structure%20and%20organization</a>.</p><p>LTR retroelements (LTR REs) constitute a major group of transposable elements widely distributed in eukaryotic genomes. Through their own mechanism of retrotranscription LTR REs enrich the genomic landscape by providing genetic variability, thus contributing to genome structure and organization. </p><h1 id="é•¿æœ«ç«¯é‡å¤åè½¬å½•è½¬åº§å­ï¼ˆLTR-RTsï¼‰"><a href="#é•¿æœ«ç«¯é‡å¤åè½¬å½•è½¬åº§å­ï¼ˆLTR-RTsï¼‰" class="headerlink" title="é•¿æœ«ç«¯é‡å¤åè½¬å½•è½¬åº§å­ï¼ˆLTR-RTsï¼‰"></a>é•¿æœ«ç«¯é‡å¤åè½¬å½•è½¬åº§å­ï¼ˆLTR-RTsï¼‰</h1><p>ref: <a href="https://www.cnblogs.com/triple-y/p/14329159.html">https://www.cnblogs.com/triple-y/p/14329159.html</a></p><h2 id="1-å®šä¹‰ï¼šLTRä¸é‡å¤åºåˆ—ï¼Œè½¬åº§å­çš„å…³ç³»"><a href="#1-å®šä¹‰ï¼šLTRä¸é‡å¤åºåˆ—ï¼Œè½¬åº§å­çš„å…³ç³»" class="headerlink" title="1. å®šä¹‰ï¼šLTRä¸é‡å¤åºåˆ—ï¼Œè½¬åº§å­çš„å…³ç³»"></a>1. å®šä¹‰ï¼šLTRä¸é‡å¤åºåˆ—ï¼Œè½¬åº§å­çš„å…³ç³»</h2><p>LTR-RTs æ˜¯ Long terminal repeat-retrotransposons</p><p>é‡å¤åºåˆ—</p><ul><li>ä¸²è”é‡å¤åºåˆ—ï¼ˆTandem repeatï¼‰<ul><li>å«æ˜ŸDNA</li><li>å¾®å«æ˜Ÿåºåˆ—</li><li>å°å«æ˜Ÿåºåˆ—</li></ul></li><li>æ•£åœ¨é‡å¤åºåˆ—ï¼ˆè½¬åº§å­&#x2F;è½¬åšå…ƒä»¶ï¼‰<ul><li>åè½¬å½•è½¬åº§å­ï¼ˆretrotransposonï¼‰<ul><li>SINE</li><li>LINE</li><li>LTR-RTs</li></ul></li><li>DNAè½¬åº§å­</li></ul></li></ul><p>é‡å¤åºåˆ—ï¼šæ ¹æ®é‡å¤åŒºåŸŸ<font color="blue">æ˜¯å¦è¿ç»­</font>åˆ†ä¸ºä¸²è”é‡å¤å’Œæ•£åœ¨é‡å¤ï¼ˆåˆåè½¬åº§å­ã€è½¬åº§å…ƒä»¶ï¼‰ï¼Œå‰è€…ç›¸è¿ï¼Œåè€…ä¸ç›¸è¿ã€‚</p><p>è½¬åº§å…ƒä»¶(transposable elements, TEs) åˆç§°è½¬åº§å­ï¼šæŒ‡åœ¨åŸºå› ç»„ä¸­<font color="blue">ç§»åŠ¨æˆ–å¤åˆ¶</font>ï¼Œ<font color="blue">æ•´åˆåˆ°åŸºå› ç»„æ–°ä½ç‚¹</font>çš„ä¸€æ®µ DNA åºåˆ—ã€‚æ ¹æ®è½¬åº§è¿‡ç¨‹<font color="blue">æ˜¯å¦å½¢æˆ RNA ä¸­é—´ä½“</font>ï¼Œè½¬åº§å­å¯åˆ†ä¸º DNA è½¬åº§å­å’Œåè½¬å½•è½¬åº§å­ã€‚<font color="blue"><strong>åè½¬å½•è½¬åº§å­</strong></font>æ˜¯ä»¥ RNA ä¸ºåª’ä»‹ï¼Œä¼´æœ‰åè½¬å½•è¿‡ç¨‹ï¼Œä»¥<font color="blue"><strong>å¤åˆ¶-ç²˜è´´</strong></font>æ–¹å¼åœ¨åŸºå› ç»„çš„æ–°ä½ç½®äº§ç”Ÿä¸€ä¸ªæ–°æ‹·è´ã€‚<font color="blue"><strong>DNA è½¬åº§å­</strong></font>çš„è½¬åº§æœºåˆ¶åˆ™æ˜¯<font color="blue"><strong>å‰ªåˆ‡-ç²˜è´´</strong></font>ã€‚</p><p>LTR-RTs :æ˜¯åè½¬åº§å­ä¸­çš„ä¸€ç§ï¼Œ<font color="blue">ä¸¤ä¾§å­˜åœ¨é•¿çš„æœ«ç«¯é‡å¤</font>ã€‚ä¸å«é•¿æœ«ç«¯é‡å¤çš„åè½¬åº§å­ç»Ÿç§° non-LTR-RTsï¼Œä¸»è¦åŒ…å«çŸ­æ•£åœ¨é‡å¤(SINE)å’Œé•¿æ•£åœ¨é‡å¤(LINE)ã€‚</p><h2 id="2-LTRåˆ†ç±»"><a href="#2-LTRåˆ†ç±»" class="headerlink" title="2. LTRåˆ†ç±»"></a>2. LTRåˆ†ç±»</h2><p>åŠ¨æ¤ç‰©åŸºå› ç»„ä¸­å­˜åœ¨å¤§é‡è½¬åº§å­ï¼Œå°¤å…¶æ¤ç‰©åŸºå› ç»„ã€‚LTR  å› å…¶æ•°é‡å¤šä¸” LTR é•¿åº¦å·¨å¤§ï¼Œåœ¨æ¤ç‰©è½¬åº§å­ä¸­å…·æœ‰è¾ƒé«˜å«é‡ã€‚ç‰ç±³åŸºå› ç»„ LTR å åŸºå› ç»„å«é‡é«˜è¾¾ 75% ï¼Œå±±è‹å­åŸºå› ç»„ LTR å æ¯”é«˜è¾¾ 47%ï¼Œæ‰€ä»¥<font color="blue"><strong>åŸºå› ç»„ LTR çš„é‰´å®š</strong>å°¤ä¸ºé‡è¦</font>ã€‚åè½¬å½•è½¬åº§å­æ ¹æ®<font color="blue">è½¬åº§å…ƒä»¶ç»“æ„</font>çš„<font color="blue"><strong>å®Œæ•´æ€§</strong></font>å’Œ<font color="blue"><strong>è½¬åº§ç‰¹ç‚¹</strong></font>å¯åˆ†ä¸º<font color="red"><strong>è‡ªä¸»å…ƒä»¶ï¼ˆç¼–ç è½¬åº§é…¶ï¼‰</strong></font>å’Œ<font color="red"><strong>éè‡ªä¸»å…ƒä»¶ï¼ˆè‡ªèº«ä¸ç¼–ç è½¬åº§é…¶ï¼‰</strong></font>ã€‚éè‡ªä¸»è½¬åº§å…ƒä»¶éœ€åœ¨è‡ªä¸»å…ƒä»¶çš„ååŠ©ä¸‹æ‰èƒ½å‘ç”Ÿè½¬åº§ã€‚å®Œæ•´çš„ LTR-RTs ç”±ä¸¤ç«¯åºåˆ—å®Œå…¨ä¸€è‡´çš„æœ«ç«¯é‡å¤ã€GAGï¼ˆè¡£å£³è›‹ç™½ï¼‰å’Œ POL (AP, RT, RH, INT) æ„æˆï¼Œåç”ŸåŠ¨ç‰©ä¸­å« ENV ï¼ˆåŒ…è†œè›‹ç™½ï¼‰ã€‚å…¶ä¸­ <font color="blue">POL åŒ…å« APï¼ˆå¤©å†¬æ°¨é…¸é…¶ï¼‰ã€INTï¼ˆæ•´åˆé…¶ï¼‰ã€ RTï¼ˆé€†è½¬å½•é…¶ï¼‰å’Œ RHï¼ˆæ ¸ç³–æ ¸é…¸é…¶ Hï¼‰ï¼Œæ˜¯ LTR <strong>èƒ½å¦è‡ªä¸»è½¬åº§</strong>çš„å…³é”®è›‹ç™½</font>ã€‚ LTR åˆ†ç±»è§å›¾ ï¼Œ<font color="red"><strong>é«˜ç­‰æ¤ç‰©</strong>ä¸»è¦åŒ…æ‹¬ <strong>Ty1&#x2F;Copia</strong>å’Œ <strong>Ty3&#x2F;Gypsy</strong> ä¸¤ä¸ª<strong>è¶…å®¶æ—</strong></font>ï¼ŒäºŒè€…å·®åˆ«åœ¨äº<font color="red"> <strong>INT ä½ç½®</strong>ä¸åŒ</font>ã€‚</p><p><img src="/GeekFocus/2022-05-25-LTR/1.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/1.png" alt="img"></p><p>P: æ¤ç‰©  M: åç”ŸåŠ¨ç‰©  F :çœŸèŒ  Oï¼šå…¶ä»–</p><h2 id="3-LTRç”Ÿç‰©å­¦æ„ä¹‰"><a href="#3-LTRç”Ÿç‰©å­¦æ„ä¹‰" class="headerlink" title="3. LTRç”Ÿç‰©å­¦æ„ä¹‰"></a>3. LTRç”Ÿç‰©å­¦æ„ä¹‰</h2><p>ç ”ç©¶è¡¨æ˜æ´»æ€§ LTR æ’å…¥åˆ°å…³é”®åŸºå› å†…æˆ–å‘¨è¾¹ä¼šå¯¼è‡´æ€§çŠ¶æ”¹å˜ã€‚2019 NCçš„ã€ŠA high-quality apple genome assembly reveals the association of a retrotransposon and red fruit colourã€‹æ­ç¤º<strong>è‹¹æœçº¢çš®è¡¨å‹å½¢æˆä¸ä¸€ä¸ª LTR-RT æ’å…¥ç›¸å…³</strong>ã€‚MdMYB1 æœ‰ MdMYB11-1ã€MdMYB1-2 å’Œ MdMYB1-3 ä¸‰ä¸ªç­‰ä½åŸºå› ï¼Œå…¶ä¸­ MdMYB1-1 æ˜¯æ§åˆ¶è‹¹æœæœçš®èŠ±é’ç´ åˆæˆçš„å•ä¸€æ˜¾æ€§åŸºå› ã€‚ç›¸è¾ƒäºé»„è‹¹æœåŸºå› ç»„ï¼Œåœ¨çº¢è‹¹æœåŸºå› ç»„çš„ MdMYB1-1 åŸºå› å¯åŠ¨å­ä¸Šæ¸¸æœ‰ä¸€ä¸ª LTR-RTï¼ˆ redTEï¼‰æ’å…¥ï¼Œç»PCR éªŒè¯çº¢è‹¹æœä¸­å­˜åœ¨ä¸€æ®µç‰¹å¼‚åºåˆ—ã€‚redTE ä½œä¸ºä¸€ç§<strong>å¢å¼ºå­</strong>ï¼Œå¢å¼º MdMYB1-1 å¯¹å…‰çš„æ•æ„Ÿæ€§ï¼Œä»è€Œç´¯è®¡èŠ±é’ç´ ï¼Œå½¢æˆçº¢è‰²è¡¨çš®ã€‚</p><p><img src="/GeekFocus/2022-05-25-LTR/2.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/2.png" alt="img"></p><p>ã€è‹¹æœçº¢çš® LTR-RT æ’å…¥ã€‘</p><p>LTR çš„æ‰©å¼ å’Œæ”¶ç¼©ä¹Ÿå½±å“ç€åŸºå› ç»„å¤§å°ï¼Œ<a href="https://links.jianshu.com/go?to=http://mp.weixin.qq.com/s?__biz=MzA5NzE1MTYwMw==&mid=2650849497&idx=1&sn=0831fe0dc984fd8b0aaae5bc451f3f35&chksm=8b515fc5bc26d6d35020392d2ea035602916f02a322592cad38d291c947a386f787250f7455c&scene=21%23wechat_redirect">å°å¶èŒ¶æ–‡çŒ®ã€ŠMol Plant é¡¹ç›®æ–‡ç«  | ç¬¬ä¸€ä¸ªèŒ¶æ ‘æŸ“è‰²ä½“çº§åˆ«é«˜è´¨é‡å‚è€ƒåŸºå› ç»„å‘å¸ƒã€‹</a>ä¸­ï¼Œæ­ç¤ºå°å¶èŒ¶åŸºå› ç»„ä¸­ LTR çš„æ‰©å¼ å°¤å…¶æ˜¯éè‡ªä¸» LTR çš„æ‰©å¼ æ˜¯å°å¶èŒ¶åŸºå› ç»„åºå¤§çš„ä¸»è¦åŸå› ã€‚</p><h2 id="4-LTR-RTsçš„ç»“æ„ç‰¹å¾"><a href="#4-LTR-RTsçš„ç»“æ„ç‰¹å¾" class="headerlink" title="4. LTR-RTsçš„ç»“æ„ç‰¹å¾"></a>4. LTR-RTsçš„ç»“æ„ç‰¹å¾</h2><p>å…¸å‹çš„ LTR-RTs çš„ç»“æ„æœ‰ 5 ä¸ªç‰¹å¾</p><p><img src="/GeekFocus/2022-05-25-LTR/3.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/3.png" alt="img"></p><p>å…¸å‹ LTR çš„ç»“æ„ç‰¹å¾</p><p>(1) <font color="blue"><strong>TSRï¼ˆTSDï¼‰</strong></font>: ç›®æ ‡é‡å¤ä½ç‚¹ï¼Œæ˜¯ <strong>4~6bp</strong> çš„çŸ­çš„é‡å¤åºåˆ—ï¼Œåœ¨ 5â€™LTR and 3â€™LTR ä¸¤ä¾§ï¼Œæ˜¯è½¬åº§å­<strong>æ’å…¥çš„ä¿¡å·</strong>ã€‚</p><p>(2) <font color="blue">5â€™LTR and 3â€™LTR</font> :  LTR ä¸¤ç«¯<strong>åºåˆ—å®Œå…¨ä¸€è‡´</strong>çš„<strong>æœ«ç«¯é‡å¤</strong>ï¼Œ <strong>TG..CA box</strong>ï¼Œ<strong>å®Œæ•´ LTR</strong> å‡å«æœ‰æ­¤ç»“æ„ã€‚LTR é•¿åº¦ä¸€èˆ¬åœ¨ 85~5000bpã€‚</p><p>(3) <font color="blue">PBS(primer binding site)</font> å¼•ç‰©ç»“åˆä½ç‚¹: åœ¨ 5â€™LTR çš„æœ«ç«¯ï¼Œå¯<strong>ä¸ä¸€äº› tRNA 3â€™ æœ«ç«¯äº’è¡¥ç»“åˆ</strong>çš„ä¸€æ®µ <strong>18bp å·¦å³</strong>çš„åºåˆ—ï¼Œæ˜¯<font color="red"><strong>åè½¬å½•çš„ç¬¬ä¸€æ­¥</strong></font>ã€‚</p><p>(4) <font color="blue">è›‹ç™½åŒºåŸŸ</font>: é•¿åº¦é€šå¸¸åœ¨ 1000~15000bpã€‚</p><p><strong>GAG</strong>ï¼šè¡£å£³è›‹ç™½ã€‚</p><p><strong>POL</strong>ï¼šåŒ…å«4ä¸­é…¶ï¼Œç”±APï¼ˆå¤©å†¬æ°¨é…¸é…¶ï¼‰ã€INï¼ˆINT,æ•´åˆé…¶ï¼‰ã€RTï¼ˆé€†è½¬å½•é…¶ï¼‰ã€RHï¼ˆæ ¸ç³–æ ¸é…¸é…¶ï¼‰ï¼ŒLTR <font color="red"><strong>èƒ½å¦è‡ªä¸»è½¬åº§</strong></font>çš„å…³é”®åŸå› ã€‚</p><p><strong>ENV</strong>ï¼šåŒ…è†œè›‹ç™½ï¼Œåç”ŸåŠ¨ç‰©ä¸­å­˜åœ¨ã€‚</p><p>(5) <font color="blue">PPT</font>ï¼š3â€™LTR çš„èµ·å§‹ä½ç½®çŸ­çš„å¯Œå«å˜Œå‘¤çš„åºåˆ—ï¼Œ<strong>11~15bp</strong>ã€‚</p><p>LTR åƒä¸‡å¹´è¿›åŒ–å‘å±•å‡ºè®¸å¤šå½¢å¼</p><ul><li>A : é€šå¸¸å°†åŒ…å«ä¸¤ä¸ªç›¸å¯¹å®Œæ•´çš„ LTRs å’Œå·²è¯†åˆ«çš„ PPT å’Œ PBS ä½ç‚¹çš„å…ƒç´ ï¼Œä¸”ä¸¤ä¾§æœ‰ TSD çš„ LTR å®šä¹‰ä¸º Intact LTR</li><li>C : ç”±äº LTR-RTs ä¸¤ç«¯åºåˆ—éå¸¸ç›¸ä¼¼ï¼ŒLTR-RTs å†…å¯å‘ç”Ÿé‡ç»„ï¼Œå¯¼è‡´å†…éƒ¨å…ƒä»¶æ¶ˆå¤±ï¼Œå½¢æˆ solo LTR, solo LTR çš„æ•°é‡è¡¨æ˜ä¸€ä¸ªåŸºå› ç»„ä¸­ LTR å»é™¤çš„é¢‘ç‡å’Œæ•ˆç‡</li><li>B : LTR å‘ç”Ÿç¼ºå¤±ã€æ˜“ä½å¯å½¢æˆæˆªæ–­çš„ LTR</li><li>D : LTR ç»å¸¸æ’å…¥åˆ°å…¶ä»– LTR å†…éƒ¨åŒºåŸŸï¼Œå½¢æˆåµŒå¥— LTR</li><li>å› å­˜åœ¨çªå˜æœºåˆ¶ï¼Œå®é™…ä¸Šå®Œæ•´ LTR-RTs ï¼ˆAï¼‰åªå åŸºå› ç»„ä¸­æ‰€æœ‰ LTR-RT ä¸€å°éƒ¨åˆ†</li></ul><p><img src="/GeekFocus/2022-05-25-LTR/4.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/4.png" alt="img"></p><h2 id="5-LTR-RTsé‰´å®šæ–¹æ³•"><a href="#5-LTR-RTsé‰´å®šæ–¹æ³•" class="headerlink" title="5. LTR-RTsé‰´å®šæ–¹æ³•"></a>5. LTR-RTsé‰´å®šæ–¹æ³•</h2><p>LTR-RT é‰´å®šæ–¹æ³•ä¸‰ç±»ï¼šä»å¤´é¢„æµ‹ã€ç»“æ„é¢„æµ‹ã€åŒæºæ¯”å¯¹ã€‚</p><p>LTR_STRUC æ˜¯ä¸€æ¬¾æœ€æ—©çš„ä»å¤´é¢„æµ‹ LTR çš„è½¯ä»¶</p><p>LTR_finder å’Œ LTRharvest æ˜¯ç›®å‰é‰´å®š LTR æœ€æ•æ„Ÿçš„ç¨‹åºï¼Œä½†å‡é˜³æ€§é«˜ã€‚</p><p>RepeatMaskeråŸºäºæ•°æ®åº“ï¼Œä½¿ç”¨åŒæºæ–¹æ³•æ¥é¢„æµ‹ LTRï¼Œä½†ä¸åŒç‰©ç§ LTR å·®å¼‚è¾ƒå¤§ï¼Œæ„å»ºç‰©ç§ç‰¹æœ‰çš„ LTR åº“éå¸¸å¿…è¦ã€‚</p><p>2017 å¹´å¯†æ­‡æ ¹å·ç«‹å¤§å­¦ Shujun Ou å›¢é˜Ÿå¼€å‘ LTR_retrieverç”¨äº LTR çš„é‰´å®šï¼Œæ–‡ç«  Plant Physiology ã€‚è¿™æ˜¯ä¸€æ¬¾æ•´åˆè½¯ä»¶ï¼Œä»¥ä¸€ä¸ªæˆ–å¤šä¸ª LTR é¢„æµ‹è½¯ä»¶é‰´å®š LTR çš„ç»“æœä½œä¸ºè¾“å…¥æ–‡ä»¶ï¼Œé€šè¿‡ä¸åŒæ¨¡å—å¯¹ LTR è¿›è¡Œè¿‡æ»¤å’Œä¿®æ­£æ¥å¯¹é¢„æµ‹è½¯ä»¶çš„é¢„æµ‹ç»“æœè¿›è¡Œæ•´åˆå’Œè°ƒæ•´ï¼Œä»¥å¾—åˆ°éå†—ä½™ç²¾å‡†ä¸”å®Œæ•´çš„ç‰©ç§ç‰¹å¼‚ LTR åº“ï¼Œå†ä½¿ç”¨ RepeatMaskerè¿›è¡Œé¢„æµ‹</p><p><img src="/GeekFocus/2022-05-25-LTR/5.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/5.png" alt="img"></p><p>å›¾ 5-1  LTR_retriever æ•´åˆæ¨¡å—</p><p>LTR_retriever ä» sensitivityï¼ˆæ•æ„Ÿæ€§ï¼‰ã€specificityï¼ˆç‰¹å¼‚æ€§ï¼‰ã€accuracyï¼ˆå‡†ç¡®æ€§ï¼‰ã€precisionï¼ˆç²¾ç¡®åº¦ï¼‰å››ä¸ªç»´åº¦å¯¹ LTR é‰´å®šç»“æœè¿›è¡Œè¯„ä¼°ã€‚ä»¥çœŸå® LTR å’Œé LTR åºåˆ—ä½œä¸ºå‚è€ƒåº“è¿›è¡Œé¢„æµ‹ã€‚å¯¹é¢„æµ‹ç»“æœåˆ†å››ç±»ï¼š</p><p>TPï¼šçœŸé˜³æ€§ï¼ŒçœŸå®çš„ LTRï¼Œè¢«å‡†ç¡®é¢„æµ‹å‡º</p><p>FNï¼šå‡é˜´æ€§ ï¼ŒçœŸå®çš„ LTRï¼Œæœªè¢«å‡†ç¡®é¢„æµ‹å‡º</p><p>TNï¼šçœŸé˜´æ€§ ï¼Œé LTR åºåˆ—æœªè¢«é¢„æµ‹å½“æˆ LTR</p><p>FPï¼šå‡é˜´æ€§ï¼Œé LTR åºåˆ—è¢«å½“æˆ LTR</p><p>ä»ä¸‹å›¾å…¬å¼å¯çŸ¥æ•æ„Ÿæ€§ä»£è¡¨å¯¹çœŸæ­£ LTR çš„æ£€å‡ºèƒ½åŠ›ï¼Œç‰¹å¼‚æ€§ä»£è¡¨æ’é™¤é LTR åºåˆ—çš„èƒ½åŠ›ï¼Œç²¾ç¡®æ€§ä»£è¡¨æ­£ç¡®æ£€å‡ºçš„èƒ½åŠ›ï¼Œç²¾ç¡®åº¦ä»£è¡¨æ£€å‡ºç»“æœçš„çœŸé˜³æ€§ç‡ï¼Œç²¾ç¡®åº¦è¶Šé«˜åˆ™è¡¨æ˜ç»“æœè¶Šå¯é ã€‚</p><p><img src="/GeekFocus/2022-05-25-LTR/6.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/6.png" alt="img"></p><p>é‰´å®šç»“æœè¯„ä¼°æŒ‡æ ‡</p><p>LTR_retriever è¯„ä¼°ç°æœ‰è½¯ä»¶ï¼Œç»“æœæ˜¾ç¤º LTR_retriever æ˜æ˜¾ä¼˜äºå…¶ä»–è½¯ä»¶ï¼Œè€Œ Shujun Ou å›¢é˜Ÿåœ¨ 2019 å‘è¡¨åœ¨ Genome Biology ä¸Šçš„æœ‰å…³<strong>è½¬åº§å­æ³¨é‡Š</strong>æ–¹æ³•ä¸­æ¨è LTR çš„é‰´å®šæ–¹æ³•æ˜¯ä½¿ç”¨<strong>ä»¥ LTR_finder å’Œ LTRharvest è½¯ä»¶é‰´å®šç»“æœä½œä¸º LTR_retriever çš„è¾“å…¥æ–‡ä»¶</strong>ã€‚</p><p><img src="/GeekFocus/2022-05-25-LTR/7.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/7.png" alt="img"></p><p> ä¸åŒ LTR é‰´å®šæ–¹æ³•æ¯”è¾ƒ</p><h2 id="6-LTR-åˆ†æ"><a href="#6-LTR-åˆ†æ" class="headerlink" title="6. LTR åˆ†æ"></a>6. LTR åˆ†æ</h2><p>å…¬å¸ LTR åˆ†ææµç¨‹ï¼Œå…ˆä½¿ç”¨ LTR_finder å’Œ LTRharvest å¯¹ LTR è¿›è¡Œé‰´å®šï¼Œå†åˆ©ç”¨ LTR_retriever æ•´åˆï¼Œæ„å»ºéå†—ä½™ç²¾å‡†çš„ç‰©ç§ç‰¹å¼‚ LTR æ•°æ®åº“åä½¿ç”¨åŒæºé¢„æµ‹æ–¹æ³•æ³¨é‡Šï¼Œå†è¿‡æ»¤æ‰å‡é˜³æ€§ï¼Œæ³¨é‡Šå‡ºå…¨é¢ä¸”ç²¾ç¡®çš„ç‰©ç§ LTR åºåˆ—ï¼ŒåŒ…æ‹¬ intact LTRã€solo LTRã€LTR ç›¸å…³åºåˆ—ï¼Œéå…¸å‹ LTR ç­‰ã€‚æ˜ç¡® LTR å«é‡åœ¨åŸºå› ç»„ä¸­çš„å æ¯”ï¼Œåœ¨æŸ“è‰²ä½“ä¸Šçš„åˆ†å¸ƒæƒ…å†µã€‚</p><hr><h1 id="çœŸæ ¸ç”Ÿç‰©ä¸­çš„è½¬åº§å…ƒä»¶-ç»¼è¿°"><a href="#çœŸæ ¸ç”Ÿç‰©ä¸­çš„è½¬åº§å…ƒä»¶-ç»¼è¿°" class="headerlink" title="çœŸæ ¸ç”Ÿç‰©ä¸­çš„è½¬åº§å…ƒä»¶ | ç»¼è¿°"></a>çœŸæ ¸ç”Ÿç‰©ä¸­çš„è½¬åº§å…ƒä»¶ | ç»¼è¿°</h1><p>ref : <a href="https://zhuanlan.zhihu.com/p/401637411">https://zhuanlan.zhihu.com/p/401637411</a></p><p>Wells, J. N., &amp; Feschotte, C. (2020). A field guide to eukaryotic transposable elements. <em>Annual review of genetics</em>, <em>54</em>, 539-561.</p><p>Chenais et al (2013) Biochimica et Biophysica Acta 1835 (2013) 28â€“35,Transposable elements and human cancer: A causal relationship?</p><p>Sultana, T., Zamborlini, A., Cristofari, G., &amp; Lesage, P. (2017). Integration site selection by retroviruses and transposable elements in eukaryotes. <em>Nature Reviews Genetics</em>, <em>18</em>(5), 292-308.</p><p>è½¬åº§å…ƒä»¶ï¼ˆTEï¼‰å¯ä»¥åœ¨å®¿ä¸»åŸºå› ç»„ä¸Šè‡ªä¸»ç§»åŠ¨çš„DNAåºåˆ—ã€‚é•¿åº¦é€šå¸¸åœ¨<font color="blue">100bp-10000bp</font>ã€‚å’Œç—…æ¯’ç±»ä¼¼ï¼ŒTEä¹Ÿæ˜¯éå¸¸é”™ç»¼å¤æ‚å¹¶ä¸”è‡ªç§çš„å…ƒä»¶ã€‚TEèƒ½å¤Ÿ<font color="blue">ç¼–ç å…·æœ‰å¤šç§ç”ŸåŒ–åŠŸèƒ½çš„è›‹ç™½</font>ï¼Œæˆ–è¿˜å«æœ‰<font color="blue">éç¼–ç è°ƒæ§åºåˆ—</font>ï¼Œè¿™äº›<font color="blue">è›‹ç™½å’Œè°ƒæ§åºåˆ—</font>å¯¹TEè½¬åº§æœ‰é‡è¦ä½œç”¨ã€‚</p><p>TEå’Œä¸€äº›ç±»ä¼¼ç—…æ¯’çš„<font color="blue">ä¾µå…¥æ€§é—ä¼ å…ƒä»¶</font>çš„åŒºåˆ«å¹¶ä¸ååˆ†æ˜ç¡®ã€‚å®šä¹‰TEä¸ºèƒ½å¤Ÿåœ¨<font color="blue"><strong>ç”Ÿæ®–ç³»ç»†èƒ</strong>ä¸­è¿›è¡ŒæŸ“è‰²ä½“æ°´å¹³é‡å¤ç§»åŠ¨çš„é—ä¼ å…ƒä»¶</font>ã€‚é€šè¿‡ç”Ÿæ®–ç³»ç»†èƒçš„ç§»åŠ¨èƒ½å¤Ÿå®ç°TEçš„<font color="blue">å‚ç›´ä¼ é€’</font>ï¼Œä»¥æ­¤å¢åŠ TEçš„é¢‘ç‡ã€‚è¿™ä¸€å®šä¹‰<font color="blue">åŒ…å«éè‡ªä¸»ç§»åŠ¨å…ƒä»¶</font>ï¼Œæ¯”å¦‚<font color="blue">çŸ­æ•£å¸ƒæ ¸é…¸å…ƒä»¶SINE(LINE?)</font>å’Œ<font color="blue">å¾®å°å€’ç½®é‡å¤è½¬åº§å…ƒä»¶MITE</font>ï¼ŒåŒæ—¶ä¹ŸåŒ…å«<font color="blue">å†…æºæ€§é€†è½¬å½•ç—…æ¯’ERV</font>ã€‚ä½†<strong>ä¸åŒ…æ‹¬</strong>ç”Ÿæ®–ç³»ç»†èƒä¸­<strong>æ¥æºäºç—…æ¯’</strong>çš„<strong>ä¸èƒ½æ•´åˆã€ç§»åŠ¨</strong>çš„<strong>å†…æºæ€§å…ƒä»¶</strong>ã€‚æ­¤å¤–ï¼Œ è™½ç„¶å®šä¹‰TEæ˜¯èƒ½å¤Ÿåœ¨ç”Ÿæ®–ç³»ç»†èƒä¸­å‚ç›´ä¼ é€’çš„å…ƒä»¶ï¼Œä½†TEçš„æ°´å¹³è½¬ç§»ä¹Ÿå‘ç”Ÿã€‚<font color="blue">æ°´å¹³è½¬ç§»æ˜¯TEé•¿æœŸå¹¿æ³›å­˜åœ¨çš„é‡è¦åŸå› ä¹‹ä¸€</font>ã€‚</p><p>çœŸæ ¸ç”Ÿç‰©é™¤æå°‘æ•°ç‰©ç§ï¼Œå‡ ä¹æ‰€æœ‰çœŸæ ¸ç‰©ç§åŸºå› ç»„ä¸­éƒ½å‘ç°TEå­˜åœ¨ã€‚æœ‰äº›ç‰©ç§TEå«é‡å¯ä»¥è¾¾åˆ°åŸºå› ç»„<code>85%</code>ï¼Œå¦‚æœæŠŠæ•´ä¸ªåŸºå› ç»„æ¯”ä½œä¸€ç‰‡æµ·æ´‹ï¼Œé‚£ä¹ˆçœŸæ­£å±äºå®¿ä¸»çš„åŸºå› å¯èƒ½ä»…ä»…æ˜¯è¿™äº›æµ·æ´‹ä¸­çš„ä¸€äº›å°å­¤å²›ã€‚<font color="blue">TEå«é‡å’Œç‰©ç§åŸºå› ç»„å¤æ‚ç¨‹åº¦æ— å…³</font>ï¼Œæœ‰äº›å¤æ‚çš„å¤šç»†èƒç”Ÿç‰©ï¼ˆå¦‚é’ˆå¶æ ‘ã€è¾èˆç­‰ï¼‰å«æœ‰è¾ƒå¤šTEï¼Œä½†æœ‰äº›å•ç»†èƒç”Ÿç‰©ï¼ˆæ¯”å¦‚é˜´é“æ¯›æ»´è™«ã€<em>Anncaliia algerae</em>ç­‰ï¼‰ä¹Ÿå«æœ‰è¾ƒå¤šTEã€‚</p><p>åœ¨1950å¹´ï¼ŒBarbara McClintock å‘è¡¨æœ€æ—©å…³äºTEçš„è®ºæ–‡ã€Š<em>The origin and behavior of mutable loci in maize</em>ã€‹ï¼Œè·å¾—1983å¹´è¯ºå¥–ã€‚ä¸ƒåä½™å¹´è¿‡å»ï¼ŒTEçš„ç ”ç©¶è¿˜å­˜åœ¨å¾ˆå¤šä¸è¶³ã€‚ä½†ä¹Ÿè®¤è¯†åˆ°TEåœ¨ç‰©ç§<font color="blue">è¿›åŒ–ã€åˆ†åŒ–ã€é€‚åº”</font>ç­‰æ–¹é¢æœ‰é‡è¦ä½œç”¨ã€‚æœ¬æ–‡ç»¼è¿°äº†åœ¨çœŸæ ¸ç”Ÿç‰©ä¸­ï¼ŒTEçš„<font color="blue">åˆ†ç±»ã€è¿›åŒ–èµ·æº</font>ï¼›<font color="blue">ä¸åŒç‰©ç§é—´TEå«é‡çš„æ¯”è¾ƒ</font>ï¼›ä»¥åŠ<font color="blue">å½±å“TEåˆ†å¸ƒ</font>çš„ä¸€äº›å› ç´ ã€‚</p><h2 id="1-çœŸæ ¸ç”Ÿç‰©ä¸­TEçš„åˆ†ç±»"><a href="#1-çœŸæ ¸ç”Ÿç‰©ä¸­TEçš„åˆ†ç±»" class="headerlink" title="1. çœŸæ ¸ç”Ÿç‰©ä¸­TEçš„åˆ†ç±»"></a><strong>1. çœŸæ ¸ç”Ÿç‰©ä¸­TEçš„åˆ†ç±»</strong></h2><p>1989å¹´ï¼ŒDavid Finnegané¦–æ¬¡å°†TEåˆ’åˆ†ä¸ºä¸¤ç±»ï¼š</p><ul><li>Class Iï¼šé€†è½¬åº§å­</li><li>Class II: DNAè½¬åº§å­</li></ul><p>ç¬¬ä¸€ç±»æ˜¯ä»¥RNAä¸ºä¸­ä»‹ï¼Œå¹¶ä¸”å°†RNAé€†è½¬å½•ä¸ºDNAï¼Œæ•´åˆåˆ°å®¿ä¸»åŸºå› ç»„ï¼Œ<font color="red">å¤åˆ¶ç²˜è´´</font>ã€‚ç¬¬äºŒç±»ä¸­ï¼Œ<strong>å¤§å¤šæ•°</strong>æ˜¯ä»¥<font color="blue">å‰ªåˆ‡ç²˜è´´</font>æœºåˆ¶è¿›è¡Œè½¬åº§ï¼Œä¸æ¶‰åŠRNAä¸­ä»‹ã€‚</p><p>æ ¹æ®TEå¤åˆ¶ã€æ•´åˆç­‰å…·ä½“è¿‡ç¨‹çš„ä¸åŒï¼Œä¸Šè¿°ä¸¤ç±»TEå¯ä»¥è¿›ä¸€æ­¥åˆ†æˆå¾ˆå¤š<strong>å­ç±»</strong>ï¼Œæˆ–è€…<strong>ç›®</strong><code>order</code>ã€‚å†å¾€ä¸‹åˆ†ï¼Œè¿˜å¯ä»¥åˆ†ä¸º<strong>è¶…å®¶æ—ã€å®¶æ—</strong>ç­‰ã€‚</p><p><img src="/GeekFocus/2022-05-25-LTR/8.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/8.png" alt="img"></p><p>ã€TEçš„åˆ†ç±»å’Œè½¬åº§å®ç°æ–¹å¼ã€‘</p><p><img src="/GeekFocus/2022-05-25-LTR/9.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/9.png" alt="img"></p><p>ã€è½¬åº§å®ç°æ–¹å¼ã€‘</p><p>TEå®¶æ—çš„åˆ’åˆ†ä¸€èˆ¬æŒ‰ç…§<code>80-80-80</code>æ–¹æ³•ï¼Œå³å¦‚æœä¸¤ä¸ªTEæ’å…¥çš„åºåˆ—é•¿åº¦éƒ½è¶…è¿‡80bpï¼Œæœ‰è¶…è¿‡80%çš„åºåˆ—çš„ç›¸ä¼¼æ€§è¶…è¿‡80%ï¼Œè®¤ä¸ºè¿™ä¸¤ä¸ªTEæ˜¯æ¥è‡ªåŒä¸€ä¸ªå®¶æ—ã€‚å› ä¸ºåºåˆ—ç›¸ä¼¼æ€§æ¯”è¾ƒé«˜ï¼Œè¯¥å®¶æ—çš„TEå¯ä»¥ç”¨ä¸€ä¸ªå…±åŒçš„åºåˆ—æ¥è¡¨ç¤ºè¯¥å®¶æ—å…±åŒç¥–å…ˆçš„åºåˆ—ã€‚ç‰¹åˆ«æ˜¯å½“è¯¥å®¶æ—çš„TEåœ¨è¾ƒçŸ­æ—¶é—´å†…ç»å†äº†çˆ†å‘ï¼Œå¹¶ä¸”è¿™äº›TEåªç»å†äº†ä¸­æ€§é€‰æ‹©æ—¶ã€‚ä½†æ˜¯ï¼Œ<font color="blue">æœ‰æ—¶æ ¹æ®80-80-80åŸåˆ™å®šä¹‰çš„å®¶æ—å’Œå…¶å…±åŒåºåˆ—å¹¶ä¸èƒ½å¤Ÿåæ˜ å„ä¸ªTEé—´çœŸå®çš„è¿›åŒ–å…³ç³»</font></p><p>è¿˜æœ‰ä¸€äº›TEçš„åˆ†ç±»æ˜¯æ ¹æ®å…¶èƒ½å¦è‡ªä¸»ç§»åŠ¨åˆ’åˆ†ã€‚èƒ½å¤Ÿè‡ªä¸»ç§»åŠ¨çš„å…ƒä»¶é€šå¸¸éƒ½ä¼šç¼–ç ä¸€äº›ç§»åŠ¨å¿…éœ€çš„é…¶ã€‚ä¸èƒ½è‡ªä¸»ç§»åŠ¨çš„å…ƒä»¶é€šå¸¸ä¸å«ç›¸åº”çš„ç¼–ç åºåˆ—ï¼Œä½†æ˜¯å®ƒä»¬èƒ½å¤Ÿå€ŸåŠ©å…¶ä»–å¯ç§»åŠ¨å…ƒä»¶çš„é¡ºå¼åºåˆ—å®ç°è‡ªèº«çš„ç§»åŠ¨ã€‚<font color="blue">æœ‰äº›TEå®¶æ—çš„æ‰€æœ‰æˆå‘˜éƒ½ä¸å«æœ‰å¯è‡ªä¸»ç§»åŠ¨çš„å…ƒä»¶ï¼Œæ¯”å¦‚MITE</font>ã€‚è¿™ç±»TEæºäºå¯è‡ªä¸»ç§»åŠ¨çš„TEï¼Œä½†æ˜¯å…¶ä¸­çš„è‡ªä¸»ç§»åŠ¨å…ƒä»¶åœ¨è¿›åŒ–è¿‡ç¨‹ä¸­è¢«åˆ é™¤äº†ï¼Œåªå‰©ä¸‹äº†æœ«ç«¯å€’ç½®é‡å¤åºåˆ—<code>TIR</code></p><p><img src="/GeekFocus/2022-05-25-LTR/10.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/10.png" alt="img"></p><p>è¿˜æœ‰<font color="red">ä¸€äº›éè‡ªä¸»ç§»åŠ¨å…ƒä»¶ï¼ˆæ¯”å¦‚<code>SINE</code>ï¼‰æºäºéç¼–ç åŸºå› ï¼Œæ¯”å¦‚ç¼–ç tRNAçš„åŸºå› ï¼Œå…¶ç§»åŠ¨éœ€è¦å€ŸåŠ©<code>LINE</code>å…ƒä»¶çš„åºåˆ—</font>ã€‚è¿™äº›å¿…é¡»å€ŸåŠ©å…¶ä»–å®¶æ—æ‰èƒ½å®ç°è‡ªèº«è½¬åº§çš„å…ƒä»¶ï¼Œä¹Ÿè¢«ç§°ä¸ºTEçš„å¯„ç”Ÿå…ƒä»¶ï¼Œæˆ–è€…æ˜¯<code>è¶…å¯„ç”Ÿ</code>ã€‚</p><h3 id="é€†è½¬åº§å­"><a href="#é€†è½¬åº§å­" class="headerlink" title="é€†è½¬åº§å­"></a><strong>é€†è½¬åº§å­</strong></h3><p>æ ¹æ®å¤åˆ¶ã€æ•´åˆæœºåˆ¶çš„ä¸åŒï¼Œå¯ä»¥å°†é€†è½¬åº§å­åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»</p><p>1ï¼‰<font color="blue">é•¿æœ«ç«¯é‡å¤å…ƒä»¶ï¼ˆLTRï¼‰</font>ï¼šæ¯”å¦‚<code>Copia</code>ï¼Œ<code>Gypsy</code></p><p>2ï¼‰<font color="blue">non-LTRå…ƒä»¶</font>ï¼šæ¯”å¦‚<code>L1</code>ï¼Œ<code>R2</code>ï¼Œ<code>Jockey</code></p><p>3ï¼‰<font color="blue">é…ªæ°¨é…¸é‡ç»„é…¶YRç§»åŠ¨å…ƒä»¶</font>ï¼šæ¯”å¦‚<code>DIRS</code></p><p>Non-LTRçš„ç»“æ„æ¯”è¾ƒç®€å•ï¼Œé€šå¸¸åªå«æœ‰2ä¸ªå¼€æ”¾é˜…è¯»æ¡†ï¼ˆ<code>ORF1</code>å’Œ<code>ORF2</code>ï¼‰ã€‚å…¶ä¸­ç¬¬ä¸€ä¸ªçš„å¼€æ”¾é˜…è¯»æ¡†<code>ORF1</code>åœ¨æŸäº›non-LTRç¾¤ç»„ä¸­ç¼ºå¤±ï¼ˆå¦‚<code>R2</code>å…ƒä»¶ï¼‰ã€‚<code>ORF1</code>çš„åŠŸèƒ½å¯èƒ½ä¸RNAçš„è¯†åˆ«å’Œè½¬è¿æœ‰å…³ã€‚ç¬¬äºŒä¸ªå¼€æ”¾é˜…è¯»æ¡†<code>ORF2</code> ç¼–ç æœ‰å†…åˆ‡é…¶<code>EN</code>å’Œé€†è½¬å½•é…¶<code>RT</code>æ´»æ€§ã€‚</p><p><img src="/GeekFocus/2022-05-25-LTR/11.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/11.png" alt="img"></p><p>ã€non-LTRå…ƒä»¶ï¼ŒR2çš„ç¬¬ä¸€ä¸ªå¼€æ”¾é˜…è¯»æ¡†ç¼ºå¤±ï¼ŒL1ç­‰å…ƒä»¶åˆ™å«æœ‰ç¬¬ä¸€ä¸ªå¼€æ”¾é˜…è¯»æ¡†ã€‚ENï¼šæ ¸é…¸å†…åˆ‡é…¶ï¼›RTé€†è½¬å½•é…¶ã€‘</p><p><code>L1</code>å…ƒä»¶æ˜¯non-LTRå®¶æ—çš„ä»£è¡¨ã€‚äººç±»åŸºå› ç»„æœ‰æ•°åä¸‡æ‹·è´çš„L1å…ƒä»¶ï¼Œè‡³å°‘æœ‰100ä¸ªæ‹·è´å¤„äºæ´»è·ƒçŠ¶æ€ã€‚å…¶ç¼–ç çš„æ ¸é…¸å†…åˆ‡é…¶èƒ½å¤Ÿè¯†åˆ«å‰ªåˆ‡<code>5&#39;-TT/AAAA-3&#39;</code>ä½ç‚¹ï¼Œç„¶ååˆæˆRNAï¼Œç¿»è¯‘é€†è½¬å½•é…¶ï¼Œé€†è½¬å½•ï¼Œæœ€åå°†é€†è½¬å½•çš„cDNAæ•´åˆåˆ°å®¿ä¸»åŸºå› ç»„ä¸­ã€‚ä½†æ˜¯åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œé€†è½¬å½•å¸¸å¸¸ä¼š<font color="red"><strong>æå‰ä¸­æ–­</strong></font>ï¼Œé€ æˆ5â€™ç«¯æˆªæ–­ã€‚å› ä¸º5â€™ç«¯æ˜¯L1è¡¨è¾¾çš„é‡è¦ä½ç‚¹ï¼Œæ‰€ä»¥å…¶æˆªæ–­å¾€å¾€ä¼šé€ æˆL1å¤±æ´»ã€‚è¿™ä¹Ÿæ˜¯äººç±»ä¸­ä¸ºä»€ä¹ˆå­˜åœ¨å¤§é‡çš„L1å´åªæœ‰ç›¸å¯¹è¾ƒå°‘çš„L1å…·æœ‰æ´»æ€§çš„åŸå› ã€‚</p><p>ç›¸æ¯”äºnon-LTRï¼ŒLTRçš„ç»“æ„ã€ç¼–ç å’Œå¤åˆ¶æœºåˆ¶æ¯”è¾ƒå¤æ‚ï¼Œå¹¶<font color="blue">å’Œå¾ˆå¤šé€†è½¬å½•ç—…æ¯’ç±»ä¼¼</font>ã€‚<font color="blue">å¯è‡ªä¸»ç§»åŠ¨çš„LTRè‡³å°‘å«æœ‰ä¸¤ä¸ªåŸºå› </font>ï¼š<code>gag</code>å’Œ<code>pol</code>ï¼›è¿™ä¸¤ä¸ªåŸºå› ç¼–ç å¤šèšè›‹ç™½ï¼Œè¯¥å¤šèšè›‹ç™½èƒ½å¤Ÿè¢«<code>pol</code>ç¼–ç çš„è›‹ç™½é…¶<code>PR</code>è£‚è§£ã€‚æ­¤å¤–ï¼Œ<code>pol</code>è¿˜ç¼–ç é€†è½¬å½•é…¶<code>RT</code>ï¼Œæ ¸ç³–æ ¸é…¸é…¶H<code>RH</code>ï¼Œå’Œæ•´åˆé…¶<code>IN</code>ï¼ˆä¸‹å›¾ï¼‰ã€‚é€†è½¬å½•è¿‡ç¨‹å‘ç”Ÿåœ¨<code>gag</code>å½¢æˆçš„ç—…æ¯’æ ·é¢—ç²’ä¸­ï¼Œé€†è½¬å½•å‡ºçš„cDNAå’Œæ•´åˆé…¶ç»“åˆï¼Œè¿›å…¥ç»†èƒæ ¸ï¼Œå¹¶æ•´åˆåˆ°å®¿ä¸»åŸºå› ç»„ä¸­ã€‚</p><p><img src="/GeekFocus/2022-05-25-LTR/12.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/12.png" alt="img"></p><p><font color="blue">é€†è½¬å½•ç—…æ¯’çš„å¤åˆ¶å’Œæ•´åˆä¸LTRçš„è½¬åº§è¿‡ç¨‹ç±»ä¼¼ã€‚åªä¸è¿‡é€†è½¬å½•ç—…æ¯’å¸¸å¸¸å«æœ‰<code>env</code>åŸºå› ã€‚å¦‚æœé€†è½¬å½•ç—…æ¯’çš„<code>env</code>åŸºå› ä¸¢å¤±ï¼Œé‚£ä¹ˆè¯¥é€†è½¬å½•ç—…æ¯’åˆ™å†…æºåŒ–äº†</font>ã€‚</p><p><font color="blue">å¯¹YRé€†è½¬åº§å…ƒä»¶çš„ç ”ç©¶è¾ƒå°‘ï¼Œå…¶ç»“æ„ä¸Šä¸LTRå…ƒä»¶ç›¸ä¼¼ï¼Œä½†æ˜¯å®ƒç¼–ç äº†é…ªæ°¨é…¸é‡ç»„é…¶<code>YR</code>ï¼Œè€Œéæ•´åˆé…¶<code>IN</code></font>ã€‚ä¸€èˆ¬è®¤ä¸ºï¼ŒYRå…ƒä»¶ä¸­å«æœ‰çš„æœ«ç«¯é‡å¤åºåˆ—å‚ä¸ä»¥mRNAä¸ºæ¨¡æ¿çš„é€†è½¬å½•ã€å•é“¾cDNAçš„ç¯åŒ–ã€ç¬¬äºŒæ¡cDNAé“¾çš„åˆæˆï¼Œä»¥åŠæœ€ç»ˆçš„æ•´åˆã€‚</p><h3 id="DNAè½¬åº§å­"><a href="#DNAè½¬åº§å­" class="headerlink" title="DNAè½¬åº§å­"></a><strong>DNAè½¬åº§å­</strong></h3><p>DNAè½¬åº§å­å¯ä»¥åˆ†ä¸º4ç±»ï¼š</p><p>1ï¼‰<strong>DDEè½¬åº§é…¶</strong>ä»‹å¯¼çš„å‰ªåˆ‡ç²˜è´´è½¬åº§ï¼šå¦‚<code>Tc1/Mariner</code>ï¼Œ<code>På…ƒä»¶</code></p><p>2ï¼‰<strong>é…ªæ°¨é…¸è½¬åº§é…¶</strong>è½¬åº§å­ï¼Œå³<code>Cryptons</code></p><p>3ï¼‰<code>Helitron</code></p><p>4ï¼‰<code>Mavericks</code>(ä¹Ÿå³ï¼Œ<code>Polinton</code>)</p><p>å…¶ä¸­å‰ä¸¤ç±»ï¼ˆDDEå’ŒCryptonsï¼‰çš„è½¬åº§æ¯”è¾ƒç®€å•ï¼Œç»“æ„æ„æˆ<font color="blue">åªæœ‰ä¸€ä¸ªå¼€æ”¾é˜…è¯»æ¡†ï¼Œç¼–ç é‡ç»„é…¶ï¼Œä¸¤ç«¯å«æœ‰çŸ­æœ«ç«¯å€’ç½®é‡å¤åºåˆ—ï¼ˆTIRsï¼‰</font>ã€‚è¿™ä¸€ç»“æ„å’Œå¾ˆå¤š<font color="blue">ç»†èŒå’Œå¤ç”ŸèŒ</font>çš„æ’å…¥åºåˆ—å¾ˆç›¸ä¼¼ã€‚</p><p><img src="/GeekFocus/2022-05-25-LTR/13.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/13.png" alt="img"></p><p>ã€DDEç±»è½¬åº§å­ç»“æ„å’Œè½¬åº§æ–¹å¼ã€‘</p><p>Cryptonsåœ¨çœŸæ ¸ç”Ÿç‰©ä¸­åˆ†å¸ƒè¾ƒå°‘ï¼›<font color="blue">DDEç±»è½¬åº§å­æ˜¯æ‰€æœ‰TEä¸­åˆ†å¸ƒæœ€å¹¿ï¼Œç§ç±»æœ€å¤šçš„ä¸€ç±»è½¬åº§å…ƒä»¶ï¼Œå…¶è‡³å°‘åŒ…å«äº†17ä¸ªè¶…å®¶æ—</font>ã€‚ç”šè‡³å¯ä»¥è¯´ï¼ŒDDEæ˜¯åœ°çƒä¸Šæœ€å¤è€ã€æœ€ä¸°å¯Œçš„çš„åŸºå› ã€‚</p><p>ä¸åŒè¶…å®¶æ—çš„DDEè½¬åº§æœºåˆ¶ç•¥æœ‰å·®å¼‚ï¼Œä½†æ˜¯å®ƒä»¬çš„å¼€å§‹è¿‡ç¨‹éƒ½æ˜¯è½¬åº§é…¶å¯¹TIRåºåˆ—çš„è¯†åˆ«å’Œå‰ªåˆ‡ï¼ˆå¦‚ä¸Šå›¾ï¼‰ã€‚<font color="blue">è™½ç„¶è¿™ä¸€ä¸ªâ€œå‰ªåˆ‡ç²˜è´´â€çš„è¿‡ç¨‹ä¼¼ä¹ä¸ä¼šå¢åŠ DDEçš„æ‹·è´æ•°ï¼Œä½†æ˜¯DDEæœ‰ä¸€äº›å®ç°æ‰©å¢çš„ç­–ç•¥ï¼Œæ¯”å¦‚åœ¨å®¿ä¸»åŸºå› ç»„å¤åˆ¶çš„è¿‡ç¨‹ä¸­ï¼ŒDDEå¯ä»¥ä»å·²ç»å¤åˆ¶è¿‡çš„ä½ç‚¹è½¬åº§åˆ°å°šæœªå¤åˆ¶çš„ä½ç‚¹ï¼Œç„¶åé€šè¿‡å®¿ä¸»åŸºå› ç»„çš„å¤åˆ¶ï¼Œå®ç°è‡ªèº«æ‰©å¢</font>ã€‚æ­¤å¤–ï¼Œåœ¨å‰ªåˆ‡å¤„çš„åŒé“¾æ–­è£‚å¯ä»¥é€šè¿‡åŒæºé‡ç»„è¿›è¡Œä¿®å¤ï¼Œ<font color="blue">ä¿®å¤çš„è¿‡ç¨‹ä¹Ÿèƒ½å®ç°ä¸€å®šçš„æ‰©å¢</font>ã€‚</p><p><img src="/GeekFocus/2022-05-25-LTR/14.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/14.png" alt="img"></p><p>ã€<font color="blue">DNAè½¬åº§å­é€šè¿‡å‰ªåˆ‡ç²˜è´´å®ç°æ‰©å¢çš„æ–¹å¼</font>ã€‘</p><p><font color="blue">Helitrons</font>ä¹Ÿæ˜¯ä¸€ç±»å«é‡éå¸¸ä¸°å¯Œçš„DNAè½¬åº§å…ƒä»¶ï¼Œåœ¨é»‘è…¹æœè‡ã€çº¿è™«ã€æ‹Ÿå—èŠ¥ç­‰ç‰©ç§ä¸­å¹¿æ³›å­˜åœ¨ã€‚ä½†æ˜¯å¯¹å®ƒçš„ç ”ç©¶ä»…ä»…æœ‰äºŒåä½™å¹´çš„å†å²ã€‚å®ƒçš„ç»“æœå¾ˆç®€å•ï¼Œæ²¡æœ‰TIRé‡å¤åºåˆ—ç­‰ç»å…¸DNAè½¬åº§å­ç»“æ„ï¼Œä¸èƒ½è‡ªä¸»ç§»åŠ¨ï¼Œæ²¡æœ‰â€œå‰ªåˆ‡ç²˜è´´â€ã€‚</p><p><img src="/GeekFocus/2022-05-25-LTR/15.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/15.png" alt="img"></p><p>ã€Helitronsè½¬åº§å­ç»“æ„ã€‘</p><p><code>Helraiser</code>æ˜¯å…¶ä¸­çš„å…¸å‹ä»£è¡¨ï¼Œå…¶é€šè¿‡<code>peel-and-paste</code>æœºåˆ¶å½¢æˆç¯çŠ¶åŒé“¾DNAï¼Œç„¶åå°†æ­¤ç¯çŠ¶DNAè½¬åº§åˆ°åŸºå› ç»„å…¶ä»–ä½ç½®ã€‚åœ¨è½¬åº§è¿‡ç¨‹ä¸­å°±å®ç°äº†æ‰©å¢ã€‚ä½†æ˜¯åœ¨ç‰ç±³ä¸­çš„ç ”ç©¶æ˜¾ç¤ºï¼Œæœ‰äº›Helitronè½¬åº§å­æ˜¯é€šè¿‡å‰ªåˆ‡è½¬åº§çš„ï¼Œè€Œéæ‰©å¢ã€‚æ‰€ä»¥ï¼Œå¯¹Helitonçš„è½¬åº§æœºåˆ¶è¿˜æœ‰å¾…è¿›ä¸€æ­¥ç ”ç©¶ã€‚</p><p><font color="blue">Mavericks</font>ä¹Ÿç§°ä¹‹ä¸ºPolintonsï¼Œä¹Ÿæ˜¯ä¸€ç±»ç›®å‰ç ”ç©¶å°šä¸å®Œæ•´çš„DNAè½¬åº§å­ã€‚Mavericksè½¬åº§å­çš„å¤§å°çº¦<code>15-20Kb</code>ï¼Œæ„æˆæ¯”è¾ƒå¤æ‚ï¼Œå¯å«æœ‰é«˜è¾¾20ä¸ªè›‹ç™½ç¼–ç åŸºå› ï¼Œä¸¤ç«¯å«æœ‰400-700bpçš„TIRé‡å¤åºåˆ—ã€‚å…¶åœ¨çœŸæ ¸ç”Ÿç‰©ä¸­ä¹Ÿå¹¿æ³›å­˜åœ¨ï¼Œä½†æ˜¯å…¶ä¸€èˆ¬åœ¨åŸºå› ç»„çš„æ‹·è´æ•°è¾ƒå°‘ï¼ˆé˜´é“æ¯›æ»´è™«é™¤å¤–ï¼ŒMaverickså¯å å…¶åŸºå› ç»„çš„1&#x2F;3ï¼‰ã€‚</p><p>Maverickså’Œå¾ˆå¤šåŒé“¾DNAç—…æ¯’ç±»ä¼¼ï¼ŒåŒ…æ‹¬å«æœ‰<code>pPolB</code>çš„DNAèšåˆé…¶ï¼ˆå’Œè…ºç—…æ¯’å…³ç³»å¾ˆè¿‘ï¼‰ï¼Œæ¨æµ‹å…¶è½¬åº§è¿‡ç¨‹ä¸­å¯ä»¥ç›´æ¥åˆæˆDNAï¼Œä¹Ÿå› æ­¤ç§°å…¶ä¸ºâ€œè‡ªæˆ‘åˆæˆå‹è½¬åº§å­â€œã€‚Mavericksè¿˜å«æœ‰å’ŒDDEç±»ä¼¼çš„æ•´åˆé…¶ï¼Œåœ¨æ•´åˆè¿‡ç¨‹ä¸­ä¼šå½¢æˆ5-6bpé•¿åº¦çš„é¶æ ‡ä½ç‚¹é‡å¤åºåˆ—<code>TSD</code>ã€‚</p><p>æœ‰äº›ç ”ç©¶è¿˜æ˜¾ç¤ºMaverickså¯èƒ½è¿˜èƒ½å¤Ÿåˆæˆè¡£å£³æ ·è›‹ç™½ã€‚è¿™æç¤ºï¼ŒMavericksè½¬åº§å­å¯èƒ½ä»£è¡¨äº†å†…æºæ€§ç—…æ¯’æˆ–è€…å™¬ç—…æ¯’ä½“ã€‚å™¬ç—…æ¯’ä½“èƒ½å¤ŸåµŒåˆåˆ°è¾ƒå¤§çš„åŒé“¾DNAç—…æ¯’ä¸­ã€‚<font color="blue">Mavericksä¹Ÿå› æ­¤å¯èƒ½æ˜¯çœŸæ ¸ç‰©ç§ä¸ºäº†ä¿æŠ¤è‡ªå·±å…å—å¤§DNAç—…æ¯’æ”»å‡»çš„ä¸€ç§ç§˜å¯†æ­¦å™¨</font>ã€‚</p><h2 id="2-è½¬åº§å…ƒä»¶çš„è¿›åŒ–èµ·æº"><a href="#2-è½¬åº§å…ƒä»¶çš„è¿›åŒ–èµ·æº" class="headerlink" title="2. è½¬åº§å…ƒä»¶çš„è¿›åŒ–èµ·æº"></a><strong>2. è½¬åº§å…ƒä»¶çš„è¿›åŒ–èµ·æº</strong></h2><p>é€šè¿‡è¿›åŒ–åŸºå› ç»„å­¦ç ”ç©¶<strong>å„ä¸ªè½¬åº§å…ƒä»¶çš„åˆ†å¸ƒå’Œæ ¸å¿ƒè›‹ç™½çš„å‘ç”Ÿå…³ç³»</strong>ã€‚å°½ç®¡æˆ‘ä»¬ç°åœ¨æœ‰å¾ˆæ–¹ä¾¿çš„å…¨åŸºå› ç»„æµ‹åºå’Œå¾ˆå¥½çš„TEæ³¨é‡Šå·¥å…·ï¼Œä½†æ˜¯<strong>TEåºåˆ—è¿›åŒ–å¾ˆå¿«</strong>ï¼Œå³ä¾¿æ˜¯<strong>æœ€å¸¸è§æœ€ä¿å®ˆçš„TEè›‹ç™½åŸŸä¹Ÿå¾ˆéš¾è¿›è¡Œè¶…å®¶æ—ä¹‹é—´çš„æ¯”å¯¹</strong>ã€‚æ­¤å¤–ï¼Œ<strong>TEçš„è¿›åŒ–å…³ç³»å’Œç‰©ç§è¿›åŒ–å…³ç³»å¹¶ä¸ä¸€è‡´</strong>ï¼ŒTEå¯ä»¥è¿›è¡Œ<strong>ç‰©ç§ä¹‹é—´çš„æ°´å¹³è½¬ç§»</strong>ï¼Œç”šè‡³æ˜¯åœ¨è„Šæ¤åŠ¨ç‰©å’Œæ— è„Šæ¤åŠ¨ç‰©ä¹‹é—´<strong>é•¿è·ç¦»è½¬ç§»</strong>ã€‚æœ‰äº›TEåœ¨è¿›åŒ–çš„è¿‡ç¨‹ä¸­å¯èƒ½<strong>ä¸¢å¤±æˆ–ç­ç»</strong>ã€‚æ‰€ä»¥ï¼Œç ”ç©¶è½¬åº§å…ƒä»¶ä¹‹é—´çš„è¿›åŒ–å…³ç³»éå¸¸<strong>å›°éš¾</strong>ã€‚</p><p>åœ¨è¿‡å»æ•°åå¹´çš„ç ”ç©¶ä¸­ï¼Œäººä»¬å‘ç°ï¼Œ<strong>æ‰€æœ‰ä¸»è¦è½¬åº§å…ƒä»¶çš„äºšçº²</strong><code>subclass</code>åœ¨<strong>çœŸæ ¸ç”Ÿç‰©è¿›åŒ–åˆ†æ”¯ä¸­å‡æœ‰åˆ†å¸ƒ</strong>ã€‚å¯¹TEæ ¸å¿ƒè›‹ç™½çš„åˆ†æä¹Ÿæ˜¾ç¤ºè¿™äº›äºšçº²åœ¨çœŸæ ¸ç”Ÿç‰©è¿›åŒ–æ—©æœŸå°±å·²ç»å­˜åœ¨ã€‚åŒæ—¶<strong>TEçš„è¿›åŒ–æ˜¯é«˜åº¦æ¨¡å—åŒ–çš„ï¼Œå¯ä»¥åå¤è·å¾—æˆ–è€…ä¸¢å¤±æŸäº›è›‹ç™½æ¨¡å—</strong>ã€‚</p><h3 id="è½¬åº§å…ƒä»¶ç›¸å…³è›‹ç™½çš„è¿›åŒ–å…³ç³»"><a href="#è½¬åº§å…ƒä»¶ç›¸å…³è›‹ç™½çš„è¿›åŒ–å…³ç³»" class="headerlink" title="è½¬åº§å…ƒä»¶ç›¸å…³è›‹ç™½çš„è¿›åŒ–å…³ç³»"></a><strong>è½¬åº§å…ƒä»¶ç›¸å…³è›‹ç™½çš„è¿›åŒ–å…³ç³»</strong></h3><p>å°½ç®¡å„ç§ä¸åŒå…ƒä»¶çš„ç»“æ„éå¸¸å¤šæ ·ï¼Œä½†æ˜¯åœ¨<font color="blue">å¤åˆ¶å’Œè½¬åº§è¿‡ç¨‹ä¸­æ¶‰åŠçš„è›‹ç™½ç§ç±»å´å¾ˆæœ‰é™ï¼Œå¤§æ¦‚åˆ†ä¸º5ç±»</font>ï¼š</p><ul><li>é€†è½¬å½•é…¶RT</li><li>æ•´åˆé…¶IN</li><li>é…ªæ°¨é…¸é‡ç»„é…¶YR</li><li>HUH&#x2F;Rep</li><li>DNAåˆæˆé…¶pPolB</li></ul><p>è€Œä¸”ï¼ŒHUHã€RTå’ŒpPolBçš„è¿˜æ‹¥æœ‰ç›¸åŒçš„RNAè¯†åˆ«åŸŸã€‚<font color="blue">è¿™äº›è½¬åº§æ¶‰åŠçš„é…¶å¯èƒ½å‡ºç°åœ¨çœŸæ ¸ç”Ÿç‰©å½¢æˆä»¥å‰</font></p><p>åœ¨DDEç±»è½¬åº§å­ä¸­ï¼Œæœ‰è‡³å°‘6è¶…å®¶æ—çš„è½¬åº§é…¶å’Œç»†èŒæ’å…¥åºåˆ—<code>IS</code>ç¼–ç çš„è›‹ç™½ç›¸ä¼¼ï¼Œæç¤ºï¼ŒæŸäº›DNAè½¬åº§å­è¶…å®¶æ—çš„åˆ†åŒ–æ—©äºçœŸæ ¸ç”Ÿç‰©çš„å‡ºç°ã€‚</p><p>é™¤äº†ä¸Šè¿°DDEè½¬åº§å­ï¼Œå…¶ä»–äºšçº²çš„è½¬åº§å­å’Œç»†èŒæˆ–è€…å¤ç»†èŒæ²¡æœ‰åŒæºåºåˆ—ã€‚</p><p>åœ¨Helitronè½¬åº§å­ä¸­ï¼ŒHUHæ ¸é…¸å†…åˆ‡é…¶æ¶‰åŠçš„è½¬åº§ä¹Ÿå‡ºç°åœ¨ç»†èŒ<code>IS91</code>çš„è½¬åº§è¿‡ç¨‹ï¼Œä½†æ˜¯å®ƒä»¬ä¹‹é—´åº”è¯¥æ˜¯ç‹¬ç«‹è¿›åŒ–çš„ã€‚HUHæ ¸é…¸å†…åˆ‡é…¶å¯èƒ½æºäºç—…æ¯’æˆ–è€…è´¨ç²’ã€‚åŒæ ·åœ°ï¼Œåœ¨ç»†èŒå’Œå¤ç»†èŒä¸­çš„é…ªæ°¨é…¸é‡ç»„é…¶å’ŒçœŸæ ¸ç”Ÿç‰©ä¸­è½¬åº§ä¸­æ¶‰åŠçš„é…ªæ°¨é…¸é‡ç»„é…¶ä¹Ÿåº”è¯¥æ˜¯ç‹¬ç«‹è¿›åŒ–çš„ã€‚è¿™äº›è½¬åº§å­åº”è¯¥æ˜¯åœ¨çœŸæ ¸ç”Ÿç‰©å½¢æˆä¹‹åå‡ºç°çš„ã€‚</p><h3 id="åµŒåˆå…ƒä»¶å’Œæ¨¡å—è¿›åŒ–"><a href="#åµŒåˆå…ƒä»¶å’Œæ¨¡å—è¿›åŒ–" class="headerlink" title="åµŒåˆå…ƒä»¶å’Œæ¨¡å—è¿›åŒ–"></a><strong>åµŒåˆå…ƒä»¶å’Œæ¨¡å—è¿›åŒ–</strong></h3><p>ä¸Šè¿°åªæè¿°äº†ç›¸å…³è½¬åº§é…¶ä¹‹é—´çš„è¿›åŒ–å…³ç³»ï¼Œå…·ä½“åˆ°è½¬åº§å­æœ¬èº«ï¼Œå¾ˆéš¾ç”¨ä¸€ä¸ªè¿›åŒ–æ ‘æ¥è¡¨ç¤ºå®ƒä»¬ä¹‹é—´çš„è¿›åŒ–å…³ç³»ã€‚å› ä¸ºè½¬åº§å­ä¹‹é—´ä¼šé¢‘ç¹äº¤æ¢ç»“æ„å•å…ƒï¼Œå½¢æˆä¸€ä¸ªè¿›åŒ–å…³ç³»ç½‘ï¼Œè€Œéè¿›åŒ–å…³ç³»æ ‘ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€äº›è¾…åŠ©ç»“æ„åŸŸæ˜¯ä»å®¿ä¸»åŸºå› ç»„ä¸Šè·å¾—çš„ã€‚è½¬åº§å­ä¹‹é—´çš„ç•Œé™å¹¶ä¸åƒç‰©ç§ä¹‹é—´çš„ç•Œé™é‚£ä¹ˆæ˜ç¡®ã€‚</p><p>æ¯”å¦‚ï¼Œæ ¹æ®é€†è½¬å½•é…¶ç»“æ„åŸŸï¼Œclass Iä¸­çš„YRé€†è½¬åº§å­å¯ä»¥å’ŒLTRåŠé€†è½¬å½•ç—…æ¯’åˆ’åˆ†ä¸ºåŒä¸€ç±»ï¼›ä½†æ˜¯å¦‚æœæ ¹æ®é…ªæ°¨é…¸é‡ç»„é…¶ç»“æ„ï¼ŒYRé€†è½¬åº§å­åˆå¯åˆ’åˆ†ä¸ºclass IIä¸­ï¼Œå’ŒCryptonå±äºä¸€ç±»ã€‚</p><p>LTRé€†è½¬åº§å­æ˜¯æœ€å…¸å‹çš„æ¨¡å—åŒ–è¿›åŒ–çš„ä¾‹å­ã€‚å®ƒä»non-LTRå’ŒDDEä¸­åˆ†åˆ«å€Ÿæ¥äº†ç›¸åº”çš„æ¨¡å—ï¼Œå½¢æˆäº†è‡ªå·±ç‹¬ç‰¹çš„è½¬åº§æœºåˆ¶ã€‚ä»è¿›åŒ–ä¸Šçœ‹ï¼ŒLTRçš„å½¢æˆæ¯”non-LTRå’ŒDDEè¦æ™šï¼Œnon-LTRå’ŒDDEçš„åµŒåˆå½¢æˆäº†LTRã€‚æ”¯æŒè¿™ä¸€è®ºæ–­çš„å¦ä¸€ä¸ªè¯æ®æ¥è‡ªæ ¸ç³–æ ¸é…¸é…¶<code>RNase H</code>ç»“æ„åŸŸï¼ŒRNase Hå½¢æˆäºç”Ÿå‘½èµ·æºçš„æ—©æœŸï¼Œä¸»è¦ä½œç”¨æ˜¯é™è§£DNA-RNAå¤åˆä½“ä¸­çš„RNAåºåˆ—ã€‚å¯¹LTRã€non-LTRå’Œå®¿ä¸»åŸºå› ç»„ä¸­çš„RNase Hç»“æ„åŸŸçš„è¿›åŒ–åˆ†ææ˜¾ç¤ºï¼ŒLTRçš„RNase Héš¶å±äºnon-LTRä¸­çš„ä¸€ä¸ªåˆ†æ”¯ã€‚å¦‚æœå°†å®¿ä¸»åŸºå› ç»„çš„RNase Håºåˆ—ä½œä¸ºæ ‘æ ¹ï¼Œé‚£ä¹ˆå¯ä»¥æ¨æµ‹å‡ºï¼Œnon-LTRçš„å‡ºç°æ—©äºLTRã€‚æ­¤å¤–ï¼ŒLTRä¸­çš„<code>gag</code>è›‹ç™½å’Œnon-LTRä¸­ç¬¬ä¸€ä¸ªå¼€æ”¾é˜…è¯»æ¡†ç¼–ç çš„è›‹ç™½åœ¨åºåˆ—ã€ä½ç½®å’ŒåŠŸèƒ½ä¸Šéƒ½æœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ã€‚æœ€åï¼ŒLTRä¸­çš„INè›‹ç™½æ¥è‡ªDDEè½¬åº§å­ã€‚é€šè¿‡è¿™ç§æ¨¡å—ç»“æ„çš„åµŒåˆï¼Œæœ€ç»ˆå½¢æˆäº†LTRè½¬åº§å­ã€‚</p><p>é™¤äº†LTRå¤–ï¼ŒSINEç±»è½¬åº§å­ä¹Ÿæ˜¯é€šè¿‡åµŒåˆæ¨¡å—çš„æ–¹å¼å½¢å¼çš„ã€‚æ¯”å¦‚åœ¨çµé•¿ç±»ä¸­ï¼Œ<code>Alu</code>åœ¨çµé•¿ç±»ä¸­é€šè¿‡ä¸¤ä¸ª7SLè·å¾—çš„SINEèåˆå¾—åˆ°ã€‚Aluå½¢æˆä¹‹åï¼Œè¿…é€Ÿæ‰©æ•£ï¼Œå¹¶ä¸”å é¢†äº†çµé•¿ç±»åŸºå› ç»„è½¬åº§å­çš„å¾ˆå¤§ä¸€éƒ¨åˆ†ã€‚</p><h2 id="3-è½¬åº§å­åœ¨ç‰©ç§é—´åˆ†å¸ƒçš„å·®å¼‚"><a href="#3-è½¬åº§å­åœ¨ç‰©ç§é—´åˆ†å¸ƒçš„å·®å¼‚" class="headerlink" title="3. è½¬åº§å­åœ¨ç‰©ç§é—´åˆ†å¸ƒçš„å·®å¼‚"></a><strong>3. è½¬åº§å­åœ¨ç‰©ç§é—´åˆ†å¸ƒçš„å·®å¼‚</strong></h2><p>TEçš„å«é‡åœ¨å„ä¸ªç‰©ç§é—´çš„åˆ†å¸ƒå·®å¼‚å¾ˆå¤§ã€‚æœ‰äº›ç‰©ç§çš„åŸºå› ç»„å«æœ‰å¾ˆå°‘çš„TEï¼Œè€Œæœ‰äº›ç‰©ç§åŸºå› ç»„ä¸­åˆ™å……æ–¥ç€å¤§é‡çš„TEã€‚</p><p><img src="/GeekFocus/2022-05-25-LTR/16.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/16.png" alt="img"></p><p>ã€ä¸åŒç‰©ç§çš„åŸºå› ç»„å¤§å°å’ŒTEå«é‡ã€‘</p><p>æœ‰äº›ç ”ç©¶è®¤ä¸ºï¼Œç‰©ç§ä¸­TEçš„å«é‡å’Œå…¶ç‰©ç§çš„æœ‰æ•ˆç¾¤ä½“æ•°é‡ç›¸å…³ã€‚æœ‰æ•ˆç¾¤ä½“æ•°é‡è¶Šå¤§ï¼Œè‡ªç„¶é€‰æ‹©æ•ˆèƒ½è¶Šé«˜ï¼Œå› è€Œå¯¹TEçš„é€‰æ‹©å‹åŠ›ä¹Ÿè¶Šå¤§ã€‚æ¯”å¦‚ï¼Œåœ¨æœ‰æ•ˆç¾¤ä½“æ•°é‡å¾ˆå¤§çš„æœè‡ä¸­ï¼ŒTEå«é‡è¾ƒä½ï¼Œè€Œåœ¨æœ‰æ•ˆç¾¤ä½“æ•°é‡è¾ƒå°çš„è„Šæ¤åŠ¨ç‰©ä¸­ï¼ŒTEæ’å…¥å—åˆ°é€‰æ‹©å‹åŠ›è¾ƒå°ï¼Œå¯ä»¥å¾ˆå¿«çš„åœ¨ç¾¤ä½“ä¸­å›ºå®šä¸‹æ¥ã€‚ä¸è¿‡ï¼Œæœ‰äº›æœ‰æ•ˆç¾¤ä½“æ•°é‡ç›¸è¿‘çš„ç‰©ç§ï¼Œ å…¶TEå«é‡æœ‰æ—¶ä¹Ÿä¼šæœ‰å¾ˆå¤§å·®å¼‚ã€‚æ‰€ä»¥æœ‰æ•ˆç¾¤ä½“æ•°é‡çš„å·®å¼‚å¹¶ä¸è¶³è§£é‡ŠTEçš„åˆ†å¸ƒå·®å¼‚ã€‚</p><p>è€Œä¸”å„ç±»ä¸åŒçš„TEåˆ†å¸ƒå·®å¼‚ä¹Ÿå¾ˆå¤§ï¼Œæ¯”å¦‚<font color="red"><strong>LTRåœ¨å¼€èŠ±æ¤ç‰©ä¸­åˆ†å¸ƒå¾ˆå¤šï¼›non-LTRåœ¨å“ºä¹³åŠ¨ç‰©ä¸­åˆ†å¸ƒå¾ˆå¤šï¼›DNAè½¬åº§å­åœ¨æ–‘é©¬é±¼å’Œçº¿è™«ä¸­åˆ†å¸ƒå¾ˆå¤š</strong></font>ã€‚æœ‰æ•ˆç¾¤ä½“æ•°é‡çš„å·®å¼‚ä¹Ÿä¸è¶³ä»¥è§£é‡Šè¿™ä¸€ç°è±¡ã€‚</p><h3 id="TEä¸°åº¦å’ŒåŸºå› ç»„å¤§å°"><a href="#TEä¸°åº¦å’ŒåŸºå› ç»„å¤§å°" class="headerlink" title="TEä¸°åº¦å’ŒåŸºå› ç»„å¤§å°"></a><strong>TEä¸°åº¦å’ŒåŸºå› ç»„å¤§å°</strong></h3><p>é™¤äº†æå°‘æ•°å·²çŸ¥çœŸæ ¸ç”Ÿç‰©å¤–ï¼ˆç–ŸåŸè™«ã€å¼“å½¢è™«ã€è‚ è„‘ç‚å¾®å­¢å­è™«ã€æ³°å‹’åŸè™«ï¼‰ï¼Œæ‰€æœ‰çš„çœŸæ ¸ç”Ÿç‰©ç‰©ç§ä¸­éƒ½å«æœ‰TEã€‚å·§åˆçš„æ˜¯ï¼Œä¸Šè¿°å‡ ç§ä¾‹å¤–éƒ½æ˜¯å•ç»†èƒç”Ÿç‰©ï¼Œè€Œä¸”åä¸¤è€…æ˜¯çœŸæ ¸ç”Ÿç‰©ä¸­åŸºå› ç»„æœ€å°çš„ã€‚ä½†æ˜¯è¿™å¹¶ä¸è¶³è¯´æ˜åŸºå› ç»„å¤§å°å’ŒTEä¸°åº¦æœ‰ç›´æ¥å…³ç³»ã€‚å¦ä¸€ç§å•ç»†èƒç”Ÿç‰©ï¼Œ<em>Anncaliia algerae</em>çš„åŸºå› ç»„å¤§å°åªæœ‰23Mbï¼Œä½†æ˜¯å…¶ä¸­æœ‰14%éƒ½æ˜¯TEï¼Œæ¶µç›–äº†240ä¸ªTEå®¶æ—ã€‚</p><p>åœ¨ä¸€äº›è¾ƒå¤§çš„åŸºå› ç»„ä¸­ï¼Œæ¯”å¦‚<font color="blue">è¾èˆåŸºå› ç»„ï¼Œå…¶å¤§å°æœ‰120Gb</font>ã€‚è¿™ä¹ˆå¤§çš„åŸºå› ç»„ä¸»è¦æ˜¯LTRè½¬åº§å…ƒä»¶é€ æˆçš„ã€‚æ¤ç‰©åŸºå› ç»„é€šå¸¸ä¹Ÿå¯ä»¥é€šè¿‡è½¬åº§å…ƒä»¶è¿…é€Ÿå¢å¤§ã€‚å…¶ä¸­æ¶‰åŠçš„è½¬åº§å…ƒä»¶å¯èƒ½æ¶µç›–è¾ƒå¤šçš„TEå®¶æ—ï¼Œä½†æ˜¯ä¸ªåˆ«TEçš„ä½œç”¨å¯èƒ½ä¼šæ ¼å¤–æ˜¾è‘—ã€‚æ¯”å¦‚æ£•æ°´è…åœ¨3600ä¸‡å¹´å‰ä»ç»¿æ°´è…ä¸­åˆ†åŒ–å‡ºæ¥ï¼Œéšåå…¶åŸºå› ç»„å¤§å°ä»300Mbè¿…é€Ÿå¢å¤§åˆ°äº†1Gbï¼Œé€ æˆè¿™ä¸€ç°è±¡çš„åŸå› å°±æ˜¯CR1 non-LTRè½¬åº§å­ã€‚</p><p>éå¿…è¦DNAçš„åˆ é™¤æ˜¯å¦ä¸€ä¸ªå†³å®šåŸºå› ç»„å¤§å°å’ŒTEä¸°åº¦çš„å› ç´ ã€‚é™¤äº†è½¬åº§å…ƒä»¶å¤–ï¼Œè¾èˆå½¢æˆçš„å¤§åŸºå› ç»„å’Œå…¶è¾ƒä½çš„DNAåˆ é™¤ç‡ä¹Ÿæœ‰å¾ˆç›´æ¥çš„å…³ç³»ã€‚<font color="red"><strong>åœ¨æ‹Ÿå—èŠ¥å’Œæ°´ç¨»ä¸­ï¼Œå¼‚ä½é‡ç»„é€ æˆçš„åŸºå› ç»„é«˜åˆ é™¤ç‡æŠµæ¶ˆäº†è½¬åº§é€ æˆçš„åŸºå› ç»„æ‰©å¤§ï¼Œç»´æŒäº†æ‹Ÿå—èŠ¥å’Œæ°´ç¨»çš„åŸºå› ç»„å¤§å°ç¨³å®š</strong></font>ã€‚åœ¨é¸Ÿç±»å’Œå“ºä¹³åŠ¨ç‰©ä¸­ï¼Œä¹Ÿæœ‰åŒæ ·çš„ç°è±¡ã€‚</p><h3 id="TEå¤šæ ·æ€§"><a href="#TEå¤šæ ·æ€§" class="headerlink" title="TEå¤šæ ·æ€§"></a><strong>TEå¤šæ ·æ€§</strong></h3><p>TEåœ¨ç‰©ç§ä¹‹é—´çš„åˆ†å¸ƒï¼Œé™¤äº†ä¸°åº¦ä¸åŒå¤–ï¼Œç§ç±»åˆ†å¸ƒä¹Ÿå­˜åœ¨å¾ˆå¤§å·®å¼‚ã€‚å®¿ä¸»å’ŒTEä¹‹é—´çš„ç«äº‰ä½œç”¨ä¼šå¯¼è‡´TEå®¶æ—ç»“æ„çš„å½¢æˆï¼Œæ‰©å¤§TEçš„äºšå®¶æ—ç§ç±»ï¼ˆæ¯”å¦‚<code>L1</code>ï¼‰ã€‚å…¶ä»–ä¸€äº›è½¬åº§å…ƒä»¶ï¼Œæ¯”å¦‚Helitronså¯ä»¥é€šè¿‡è·å–å®¿ä¸»DNAçš„ç‰‡æ®µå½¢æˆæ–°çš„äºšå®¶æ—ã€‚</p><p>ä¸ç®¡åœ¨ä»€ä¹ˆå°ºåº¦æ¥è¡¡é‡ï¼ŒçœŸæ ¸ç”Ÿç‰©çš„TEåˆ†å¸ƒéƒ½å…·æœ‰å¾ˆé«˜çš„å¤šæ ·æ€§ã€‚æ¯”å¦‚åœ¨æ–‘é©¬é±¼ä¸­ï¼Œå…¶TEä¸°åº¦å’Œå¤šæ ·æ€§åœ¨è„Šæ¤æ¨¡å¼ç”Ÿç‰©ä¸­éƒ½æ˜¯æœ€é«˜çš„ï¼Œå«æœ‰è¿‘2000ä¸ªTEå®¶æ—ï¼Œæ¶µç›–äº†æ‰€æœ‰çš„äºšçº²å’Œå‡ ä¹æ‰€æœ‰çš„è¶…å®¶æ—ã€‚å…¶ä¸­ï¼ŒDNAè½¬åº§å­ç‰¹åˆ«ä¸°å¯Œï¼Œå«æœ‰1000ä¸ªä¸åŒæ—¶æœŸå½¢æˆçš„DNAè½¬åº§å­å®¶æ—ï¼Œè¿™åœ¨é±¼ç±»ä¸­å¾ˆä¸å¯»å¸¸ã€‚</p><p>ä½†æ˜¯è¿™å¹¶ä¸æ˜¯è¯´åŸºå› ç»„è¶Šå¤§ï¼Œå…¶TEå¤šæ ·æ€§è¶Šé«˜ã€‚æ¯”å¦‚äº‘æ‰æ˜¯ä¸€ç±»è£¸å­æ¤ç‰©ï¼Œå…¶åŸºå› ç»„å¤§å°20Gbï¼Œå…¶ä¸­çš„è½¬åº§å­ä¸»è¦é›†ä¸­åœ¨LTRè¶…å®¶æ—ä¸­ï¼Œå«æœ‰å¤§é‡çš„æ‹·è´æ•°ã€‚è€Œä¸”å…¶ä¸­çš„å¤§å¤šæ•°è½¬åº§å­å‘ç”Ÿåœ¨500ä¸‡-6000ä¸‡å¹´å‰ã€‚<font color="blue">åœ¨æ°´ç¨»å’Œç‰ç±³ä¸­ï¼Œæ‰€æœ‰çš„è½¬åº§å­éƒ½æ™šäº500ä¸‡å¹´</font>ã€‚è¿™è¯´æ˜å°½ç®¡TEåœ¨äº‘æ‰ä¸­çš„å¤šæ ·æ€§å¾ˆä½ï¼Œä½†æ˜¯å¾ˆå¤šå·²ç»å­˜åœ¨åŸºå› ç»„ä¸­çš„TEä¼šè¢«ç¼“æ…¢çš„ç§»é™¤æ‰ã€‚ä¸äº‘æ‰ç›¸åï¼Œåœ¨å¾ˆå¤šå¼€èŠ±æ¤ç‰©ä¸­ï¼Œå°½ç®¡å…¶åŸºå› ç»„å¾ˆå°ï¼Œä½†æ˜¯å…¶TEçš„å¤šæ ·æ€§å´å¾ˆé«˜ã€‚ç”šè‡³åœ¨æ‰€æœ‰é™†ç”Ÿæ¤ç‰©ä¸­ï¼ŒåŸºå› ç»„å¤§å°å’ŒTEå¤šæ ·æ€§è¿˜è¡¨ç°å‡ºè´Ÿç›¸å…³å…³ç³»ã€‚</p><h2 id="4-å½±å“TEåˆ†å¸ƒçš„å› ç´ "><a href="#4-å½±å“TEåˆ†å¸ƒçš„å› ç´ " class="headerlink" title="4. å½±å“TEåˆ†å¸ƒçš„å› ç´ "></a><strong>4. å½±å“TEåˆ†å¸ƒçš„å› ç´ </strong></h2><p>å†³å®šä¸€ä¸ªTEå®¶æ—ç»“å±€çš„ç›´æ¥å› ç´ æœ‰ä¸‰ä¸ªï¼š<font color="red"><strong>1ï¼‰è½¬åº§å‘ç”Ÿç‡ï¼› 2ï¼‰æ–°TEæ’å…¥åœ¨ç¾¤ä½“ä¸­çš„å›ºå®šç‡ï¼›3ï¼‰TEåºåˆ—è¢«åˆ é™¤å’Œä¾µèš€çš„é€Ÿç‡</strong></font></p><p>å½±å“ç€ä¸‰ä¸ªå› ç´ çš„æ–¹é¢å¾ˆå¤šï¼Œå¯ä»¥æ¦‚æ‹¬ä¸ºï¼šTEè‡ªèº«å±æ€§ï¼Œå®¿ä¸»è‡ªèº«å±æ€§ã€‚</p><p>æ›´å¹¿æ³›åœ°è¯´ï¼ŒTEçš„å‘½è¿å†³å®šäºå…¶è‡ªèº«ã€å®¿ä¸»å’Œç¯å¢ƒä¸‰è€…çš„ç›¸äº’ä½œç”¨ã€‚æœ¬éƒ¨åˆ†å°†é‡ç‚¹è®¨è®ºTEè‡ªèº«å› ç´ å¯¹å…¶ç»“å±€å‘½è¿çš„å½±å“ã€‚</p><h3 id="TEæ’å…¥åå¥½"><a href="#TEæ’å…¥åå¥½" class="headerlink" title="TEæ’å…¥åå¥½"></a><strong>TEæ’å…¥åå¥½</strong></h3><p>TEåœ¨åŸºå› ç»„ä¸­æ’å…¥çš„ä½ç½®å¯¹TEçš„ç»“å±€æœ‰é‡è¦å½±å“ã€‚é€šè¿‡å¯¹è‡ªç„¶é€‰æ‹©å‹åŠ›è¿›å…¥ä¹‹å‰çš„æ–°æ’å…¥çªå˜çš„ç ”ç©¶æ¥ä¸€çª¥ç©¶ç«Ÿã€‚ç ”ç©¶æ˜¾ç¤ºï¼š</p><ul><li>TEå­˜åœ¨ä¸€å®šçš„æ’å…¥åå€š</li><li>TEå€¾å‘äºåœ¨æœ€å°åŒ–æœ‰å®³ä½œç”¨çš„åŸºå› ç»„ä¸­æ’å…¥</li><li>TEçš„é¶ç‚¹å€¾å‘äºæœ‰åˆ©äºè‡ªèº«å¢æ®–</li></ul><p>TEçš„æ’å…¥è¿‡ç¨‹æ¶‰åŠåˆ°æ ¸é…¸é…¶ï¼Œæ‰€æœ‰TEç¼–ç çš„æ ¸é…¸é…¶ï¼ˆé™åˆ¶æ€§å†…åˆ‡æ¢ã€æ•´åˆé…¶ã€è½¬åº§é…¶ï¼‰éƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šå­˜åœ¨ç‰¹å®šDNAæˆ–è€…æŸ“è‰²ä½“å±æ€§çš„ç‰¹å¼‚æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå‡ ä¹æ‰€æœ‰çš„TEæ’å…¥éƒ½ä¸æ˜¯éšæœºçš„ï¼Œè€Œæ˜¯å­˜åœ¨ä¸€å®šé¶æ ‡ç‰¹å¼‚æ€§çš„ã€‚åªæœ‰ä¸€äº›é«˜åº¦ç®€å¹¶æ€§çš„æ ¸é…¸é…¶æˆ–è€…è¯†åˆ«çŸ­åºåˆ—æ¨¡å¼çš„æ ¸é…¸é…¶ï¼Œæ¯”å¦‚<code>L1</code>ï¼Œå…¶åœ¨äººç±»ç»†èƒä¸­çš„æ’å…¥æ‰è¡¨ç°å‡ºä¸€å®šçš„éšæœºæ€§ã€‚</p><p>å¾ˆå¤šTEæ’å…¥è¡¨ç°å‡ºå¾ˆå¼ºçš„ä½ç‚¹åå€šï¼Œå€¾å‘äºé€‰æ‹©é‚£äº›ä¸ä¼šå½±å“ç»†èƒåŠŸèƒ½çš„åŸºå› ç»„ä½ç‚¹è¿›è¡Œæ’å…¥ã€‚æ¯”å¦‚LINEå®¶æ—çš„ä¸€äº›TEæˆå‘˜ï¼ˆR1ï¼ŒR2ï¼‰ç­‰ï¼Œå®ƒä»¬çš„æ’å…¥ç²¾ç¡®å®šä½äºrRNAåŸºå› ç°‡ä¸­ã€‚å› ä¸ºrRNAåŸºå› å…·æœ‰å¤§é‡çš„æ‹·è´å¤‡ä»½ï¼Œåœ¨å…¶ä¸­å°‘é‡åŸºå› çš„ä½ç‚¹çš„æ’å…¥ä¸ä¼šå½±å“åˆ°ç»†èƒçš„æ•´ä½“åŠŸèƒ½ã€‚è€Œå¯¹è¿™äº›ä½ç‚¹çš„è¯†åˆ«åˆ™æ˜¯é€šè¿‡é«˜åº¦åºåˆ—ç‰¹å¼‚æ€§çš„æ ¸é…¸å†…åˆ‡é…¶å®ç°çš„ã€‚ç‰¹åˆ«æ˜¯å¾ˆå¤šç±»ä¼¼R2çš„TEï¼Œå®ƒä»¬åœ¨rRNAåŸºå› ç»„çš„æ’å…¥ä¹Ÿè¡¨ç°å‡ºä½ç‚¹ç‰¹å¼‚æ€§ï¼Œä½¿å¾—å®ƒä»¬èƒ½å¤ŸåŒæ—¶å­˜åœ¨äºåŸºå› ç»„ä¸­ï¼Œç›¸äº’ä¹‹é—´ä¸å—å½±å“ã€‚åœ¨å¤šç»†èƒç”Ÿç‰©ä¸­ï¼Œè¿™ç§é«˜åº¦ç‰¹æ„æ€§çš„rRNAä½ç‚¹æ’å…¥æ˜¯æ™®éå­˜åœ¨çš„ï¼Œä¹Ÿè¯æ˜äº†TEæ’å…¥ä½ç‚¹é€‰æ‹©çš„åå‘æ€§ã€‚</p><p>åŸºå› é—´çš„â€œåƒåœ¾â€åºåˆ—ä¸ºTEçš„æ’å…¥å’Œé•¿æœŸå­˜åœ¨æä¾›äº†ä¸€ä¸ªå®‰å…¨çš„åœºæ‰€ã€‚æ¯”å¦‚åœ¨é…µæ¯èŒä¸­ï¼ŒLTRè½¬åº§å­çš„æ’å…¥ä¼šé¿å¼€å®¿ä¸»åŸºå› ç»„çš„åŸºå› åºåˆ—ã€‚<code>Copia</code>å’Œ<code>Gypsy</code>é€šè¿‡è¶‹åŒè¿›åŒ–ï¼Œèƒ½å¤Ÿé€‰æ‹©åœ¨Pol-IIIè½¬å½•åŸºå› åºåˆ—çš„ä¸Šæ¸¸æ’å…¥ï¼Œé¿å…å¹²æ‰°å®¿ä¸»åŸºå› è¡¨è¾¾ã€‚<code>Ty5</code>èƒ½å¤Ÿé€šè¿‡å…¶æ•´åˆé…¶å’Œä¸€äº›æŸ“è‰²è´¨å› å­çš„ä½œç”¨å®ç°å…¶åœ¨ç«¯ç²’åŒºéè¡¨è¾¾æŸ“è‰²è´¨çš„ç‰¹å¼‚æ’å…¥ã€‚</p><p>å¾ˆå¤šTEçš„æ’å…¥é¶æ ‡ä½äºåŸºå› 5â€™ç«¯çš„ä¸Šæ¸¸ï¼Œè¿™ç§é¶æ ‡é€‰æ‹©å€¾å‘ä¼šç»™TEè‡ªèº«å¸¦æ¥ç›Šå¤„ã€‚é¦–å…ˆåœ¨è¯¥åŒºåŸŸçš„æ’å…¥èƒ½å¤Ÿé¿å…æ’å…¥å¯¹ç¼–ç è›‹ç™½çš„å¹²æ‰°ï¼ŒåŒæ—¶è¿™äº›åŒºåŸŸçš„æŸ“è‰²ä½“å¤šä»¥æŸ“è‰²è´¨å½¢æ€å­˜åœ¨ï¼Œæœ‰åˆ©äºTEè‡ªèº«çš„è¡¨è¾¾å’Œè½¬åº§ã€‚å¾ˆå¤šDNAè½¬åº§å­éƒ½é‡‡ç”¨äº†è¿™ç§ç­–ç•¥æ¥å®ç°è‡ªèº«åˆ©ç›Šæœ€å¤§åŒ–ï¼Œæ¯”å¦‚æœè‡ä¸­çš„<code>P</code>å…ƒä»¶ã€ç‰ç±³ä¸­çš„<code>MuDR</code>ï¼Œå¤§ç±³ä¸­çš„<code>mPing</code>å’Œæ‹Ÿå—èŠ¥ä¸­çš„<code>VANDAL21</code>ç­‰ã€‚</p><p>é…µæ¯èŒä¸­çš„<code>Tf1</code>é€†è½¬åº§å­åŒæ ·å€¾å‘äºé€‰æ‹©åŸºå› çš„å¯åŠ¨å­åŒºåŸŸæ’å…¥ï¼Œè¯¥è½¬åº§å­çš„æ•´åˆé…¶å’Œå®¿ä¸»ç‰¹å¼‚æ€§è½¬å½•å› å­ç›¸äº’ä½œç”¨ï¼Œå®ç°æ’å…¥ä½ç‚¹çš„é€‰æ‹©ã€‚</p><p>åœ¨æ‹Ÿå—èŠ¥å’Œå…¶ä»–ä¸€äº›æ¤ç‰©ä¸­ï¼Œç±»<code>Copia</code>çš„é€†è½¬åº§å­ä¹Ÿè¿›åŒ–å‡ºäº†ä¸€äº›æœºåˆ¶ï¼Œå®ç°åœ¨å®¿ä¸»éå¿…éœ€åŸºå› ä¸­æ’å…¥ã€‚è¿™äº›æœºåˆ¶ä¸»è¦æ˜¯é€šè¿‡è¯†åˆ«æ ¸å°ä½“ç»„è›‹ç™½H2A.Zæ¥å®ç°çš„ï¼Œè¯¥ç»„è›‹ç™½ä¸å­˜åœ¨äºå¿…éœ€åŸºå› ç»„ä¸­ï¼Œåªå­˜åœ¨äºå’Œé€‚åº”ç¯å¢ƒå‹åŠ›ç›¸å…³çš„éå¿…éœ€åŸºå› ä¸­ã€‚è¿™ä¹Ÿæç¤ºï¼ŒTEééšæœºæ’å…¥å¸¦æ¥çš„åŸºå› ç»„çªå˜å¯èƒ½ä¹Ÿæœ‰åˆ©äºå®¿ä¸»é€‚åº”å¤–ç•Œç¯å¢ƒçš„å˜åŒ–ã€‚</p><p>è¿˜æœ‰ä¸€ç§TEçš„æ’å…¥ç­–ç•¥æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒä»¬å€¾å‘äºé€‰æ‹©å…¶ä»–çš„TEåºåˆ—ä½œä¸ºè‡ªå·±çš„æ’å…¥é¶ç‚¹ã€‚ç ”ç©¶æ˜¾ç¤ºæœ‰äº›TEå®¶æ—ä¼šé¢‘ç¹åœ°å‡ºç°åœ¨å…¶ä»–TEå®¶æ—çš„åºåˆ—å†…ã€‚æ¯”å¦‚åœ¨éæ´²çˆªèŸ¾ä¸­ï¼Œnon-LTRè½¬åº§å­<code>Tx1L</code>å‡ ä¹åªå­˜åœ¨äºDNAè½¬åº§å­<code>Tx1D</code>ä¸­ï¼Œå‰è€…åƒæ˜¯åè€…çš„ä¸€ä¸ªå¯„ç”Ÿè™«ï¼Œè¿™ç§ç°è±¡å¯ä»¥ç§°ä¹‹ä¸ºTEçš„â€œè¶…å¯„ç”Ÿâ€<code>hyperparasitism</code>.</p><h3 id="å½±å“TEé•¿æœŸå­˜åœ¨çš„å› ç´ "><a href="#å½±å“TEé•¿æœŸå­˜åœ¨çš„å› ç´ " class="headerlink" title="å½±å“TEé•¿æœŸå­˜åœ¨çš„å› ç´ "></a><strong>å½±å“TEé•¿æœŸå­˜åœ¨çš„å› ç´ </strong></h3><p>æ‰€æœ‰çš„æ–°TEæ’å…¥éƒ½ä¼šå—åˆ°æ¥è‡ªå®¿ä¸»æ°´å¹³çš„è‡ªç„¶é€‰æ‹©ã€‚ç‰¹åˆ«æ˜¯å½“TEå¯¹å®¿ä¸»äº§ç”Ÿæœ‰å®³ä½œç”¨æ—¶ï¼Œæ¯”å¦‚ï¼šå¹²æ‰°åˆ°å®¿ä¸»åŸºå› çš„è¡¨è¾¾ï¼›TEè¡¨è¾¾äº§ç‰©å¯¹å®¿ä¸»ç»†èƒæœ‰æ¯’å‰¯ä½œç”¨ï¼›åŒå®¶æ—TEå¯¼è‡´çš„å®¿ä¸»æŸ“è‰²ä½“å¼‚ä½é‡ç»„ã€‚</p><p><img src="/GeekFocus/2022-05-25-LTR/17.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-25-LTR/17.png" alt="img"></p><p>ã€TEå¯¼è‡´çš„äººç±»ç–¾ç—…ã€‘</p><p>è™½ç„¶æœ‰äº›TEäº§ç‰©ç¡®å®å¯¹å®¿ä¸»æœ‰å®³ï¼Œæ¯”å¦‚<code>L1</code>è½¬åº§ä¸­é—´äº§ç‰©çš„ç§¯ç´¯ä¼šå¯¼è‡´Aicardi-GoutiÃ¨resç»¼åˆå¾ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™æ¯’æ€§å¹¶ä¸æ˜¯ä¸»è¦å—é€‰æ‹©çš„å› ç´ ã€‚ç›®å‰çš„ç ”ç©¶æ˜¾ç¤ºï¼ŒTEå¯¼è‡´çš„å¼‚ä½é‡ç»„æ˜¯é™åˆ¶TEå¢æ®–çš„ä¸»è¦å› ç´ ã€‚</p><p>åºåˆ—è¾ƒé•¿çš„TEæ›´å®¹æ˜“é€ æˆå¼‚ä½é‡ç»„ï¼Œå› è€Œå…¶å—åˆ°çš„é€‰æ‹©å‹åŠ›ä¹Ÿåº”è¯¥æ›´å¤§ã€‚å®éªŒè§‚æµ‹ä¹Ÿç¡®å®å¦‚æ­¤ï¼Œæ¯”å¦‚LTRå’ŒLINEç­‰è¾ƒé•¿çš„è½¬åº§å­å¸¸å¸¸ä¼šèšé›†åœ¨ä½é‡ç»„åŒºï¼ˆä¸­å¿ƒç²’å‘¨å›´çš„å¼‚æŸ“è‰²è´¨åŒºï¼‰ï¼Œåœ¨è¿™äº›åŒºåŸŸå†…ï¼ŒTEå—åˆ°çš„é€‰æ‹©å‹åŠ›ä¼šç›¸å¯¹è¾ƒå°ã€‚ä¸ä¹‹ç›¸åï¼Œä¸€äº›è¾ƒçŸ­çš„è½¬åº§å­ï¼Œæ¯”å¦‚SINEå’ŒMITEï¼Œé€šå¸¸å¯Œé›†åœ¨åŸºå› è¾ƒå¤šçš„æŸ“è‰²ä½“åŒºåŸŸï¼Œè¿™äº›åŒºåŸŸé€šå¸¸é‡ç»„ç‡ä¹Ÿæ¯”è¾ƒé«˜ã€‚</p><p>ç¬¬äºŒä¸ªå¯¼è‡´TEå—åˆ°é€‰æ‹©çš„å› ç´ æ˜¯å…¶å¯¹åŸºå› è¡¨è¾¾çš„å½±å“ã€‚å¯è‡ªä¸»ç§»åŠ¨çš„è½¬åº§å­å…¶è‡ªèº«é€šå¸¸ä¼šå«æœ‰å¯åŠ¨å­å’Œè°ƒèŠ‚åºåˆ—ï¼Œå¦‚æœå…¶æ’å…¥åˆ°åŸºå› åºåˆ—ä¸­ï¼Œé‚£ä¹ˆå¯¹å®¿ä¸»åŸºå› çš„è¡¨è¾¾ä¼šäº§ç”Ÿè¾ƒå¤§å½±å“ã€‚æ¯”å¦‚ï¼Œåœ¨äººç±»åŸºå› ç»„ä¸­ï¼Œ<code>L1</code>è½¬åº§å­å¾ˆå°‘å‡ºç°åœ¨åŸºå› åºåˆ—ä¸­ï¼Œæ¯”è¾ƒè€çš„LTRæ’å…¥ä¹Ÿå¾ˆå°‘å‡ºç°åœ¨åŸºå› åºåˆ—ä¸¤ä¾§5kbçš„çš„èŒƒå›´å†…ã€‚è¿™éƒ½è¯æ˜äº†æºå¸¦å¯åŠ¨å­çš„LTRåœ¨äººç±»åŸºå› ç»„ä¸­å—åˆ°å¾ˆå¼ºçš„è‡ªç„¶é€‰æ‹©å‹åŠ›ã€‚å³ä¾¿æœ‰äº›æ’å…¥å‡ºç°åœ¨åŸºå› ä¸­ï¼Œä¹Ÿå¸¸å¸¸æ˜¯å†…å«å­ä¸­ï¼Œè€Œä¸”æ˜¯å†…å«å­çš„ä¸­æ®µéƒ¨åˆ†ï¼Œä»¥å°½é‡é¿å…å¯¹å¤–æ˜¾å­çš„å½±å“ã€‚</p><p>å½“ç„¶ï¼Œè¿˜è¦è¯´æ˜ä¸€ç‚¹ï¼ŒTEå¹¶ä¸ä¸€å®šåªç»™å®¿ä¸»å¸¦æ¥åå¤„ï¼Œè¿˜æœ‰å¯èƒ½ç»™å®¿ä¸»å¸¦æ¥é€‚åº”ä¼˜åŠ¿ï¼Œæ¯”å¦‚æœè‡ä¸­<code>Doc</code>(non-LTR)çš„æ’å…¥å¯¼è‡´äº†Cyp6g1åŸºå› è¡¨è¾¾å¢åŠ ï¼Œè¯¥åŸºå› æé«˜äº†å®¿ä¸»å¯¹DDTç­‰æ€è™«å‰‚çš„æŠ—è¯æ€§ã€‚</p><h3 id="TEæ°´å¹³è½¬ç§»"><a href="#TEæ°´å¹³è½¬ç§»" class="headerlink" title="TEæ°´å¹³è½¬ç§»"></a><strong>TEæ°´å¹³è½¬ç§»</strong></h3><p>æœ‰æ€§ç”Ÿæ®–ä¸ºTEçš„å‚ç›´ä¼ é€’æä¾›äº†ä¾¿åˆ©ï¼Œä½†æ˜¯TEçš„æ°´å¹³è½¬ç§»ä¹Ÿæ˜¯å…¶é•¿æœŸå­˜åœ¨çš„é‡è¦åŸå› ã€‚å‡ ä¹æ‰€æœ‰çš„TEéƒ½å­˜åœ¨æ°´å¹³è½¬ç§»ç°è±¡ï¼Œåœ¨æŸäº›TEå®¶æ—ä¼šè¡¨ç°çš„ç‰¹åˆ«æ˜æ˜¾ã€‚å¯¹äºDDEç±»å‹çš„DNAè½¬åº§å­ï¼Œå…¶æ°´å¹³è½¬ç§»ç›¸å¯¹å®¹æ˜“ï¼Œå‘ç”Ÿç‡ä¹Ÿæ›´é«˜ï¼›è€Œç›¸å¯¹äºnon-LTRçš„é€†è½¬åº§å­ï¼Œå…¶æ°´å¹³è½¬ç§»æ¯”è¾ƒç½•è§ã€‚</p><p>DNAè½¬åº§å­ï¼ˆDDEï¼‰å®¹æ˜“å‘ç”Ÿæ°´å¹³è½¬ç§»å¯èƒ½æ˜¯å› ä¸ºå…¶è¿›åŒ–å‡ºäº†ä¸€äº›è½¬åº§æœºåˆ¶ï¼Œæœ€å¤§ç¨‹åº¦ä¸Šå‡å°‘äº†å®¿ä¸»ç‰¹å¼‚æ€§ã€‚æ¯”å¦‚ï¼Œå®ƒä»¬ä¼šç¼–ç ä¸€äº›å¼±ä½œç”¨çš„å¯åŠ¨å­ï¼Œç”šè‡³ä¸ç¼–ç å¯åŠ¨å­ï¼Œè¿™ä½¿å¾—å®ƒä»¬çš„è½¬åº§å¿…é¡»ä¾èµ–äºæ’å…¥åˆ°å®¿ä¸»åŸºå› è¡¨è¾¾è°ƒèŠ‚åºåˆ—ä¸­ï¼Œåˆ©ç”¨å®¿ä¸»çš„å¯åŠ¨å­å®ç°è½¬åº§ï¼Œå…¶ä¸­æ¶‰åŠåˆ°çš„å¾ˆå¤šè½¬å½•å› å­ä¹Ÿæ˜¯ç›´æ¥ä½¿ç”¨å®¿ä¸»æä¾›çš„ã€‚è¿™å¤§å¤§æé«˜äº†ä»–ä»¬åœ¨ä¸åŒå®¿ä¸»ä¸­çš„é€‚åº”æ€§ã€‚æ­¤å¤–ï¼Œæœ‰äº›DNAè½¬åº§å­çš„è½¬åº§é…¶åœ¨ä¸åŒå®¿ä¸»ç»†èƒä¸­éƒ½èƒ½ä¿æŒè¾ƒé«˜æ´»æ€§ï¼Œç”šè‡³åœ¨éç»†èƒçš„ä½“å¤–ç¯å¢ƒä¹Ÿèƒ½ä¿æŒä¸€å®šçš„æ´»æ€§ã€‚è¿™äº›å› ç´ éƒ½é™ä½äº†DNAè½¬åº§å­å®¿ä¸»çš„ç‰¹å¼‚æ€§ï¼Œä¿ƒä½¿å…¶æ°´å¹³è½¬ç§»æ›´åŠ å®¹æ˜“ã€‚</p><p>è½¬åº§ä¸­ä»‹ç‰©çš„ä¸åŒä¹Ÿæ˜¯é€ æˆTEå‘ç”Ÿæ°´å¹³è½¬ç§»å·®å¼‚çš„åŸå› ã€‚æ¯”å¦‚è½¬åº§ä¸­çš„DNAä¸­ä»‹æ¯”RNAä¸­ä»‹äº§ç‰©æ›´åŠ ç¨³å®šï¼ŒDNAè½¬åº§å­æ›´å®¹æ˜“æ°´å¹³è½¬ç§»ã€‚æœ‰äº›é€†è½¬åº§å­èƒ½å¤Ÿå½¢æˆç±»ä¼¼ç—…æ¯’å¯ä»¥çš„è¡£å£³ï¼Œè¿™äº›è¡£å£³ä¼šä¿ƒè¿›è¿™äº›é€†è½¬åº§å­åœ¨ç»†èƒå¤–çš„æ’­æ•£ã€‚æœ‰äº›è½¬åº§å­å¯ä»¥ä¾èµ–çœŸæ­£çš„ç—…æ¯’è¿›è¡Œæ°´å¹³è½¬ç§»ï¼Œæ¯”å¦‚è½¬åº§è¿‡ç¨‹ä¸­çš„ä¸­ä»‹ç‰©å¯ä»¥ä¸ç—…æ¯’åºåˆ—ç»“åˆæˆ–è€…åˆ©ç”¨ç—…æ¯’è¡£å£³ã€‚ä¸­ä»‹ç‰©äº§ç”Ÿçš„ä½ç½®ä¼šå½±å“æ°´å¹³è½¬ç§»ï¼Œæ¯”å¦‚æœ‰äº›ä¸­ä»‹ç‰©ä¸»è¦ï¼ˆnon-LTRï¼‰æˆ–è€…å±€é™(DNAè½¬åº§å­)åœ¨ç»†èƒæ ¸ä¸­ï¼Œé‚£ä¹ˆè¿™äº›è½¬åº§å­å¯èƒ½å¾ˆéš¾ä¾èµ–åœ¨ç»†èƒè´¨ä¸­è¿›è¡Œè‡ªæˆ‘å¤åˆ¶çš„ç—…æ¯’ï¼ˆå¦‚ç—˜ç—…æ¯’ï¼‰è€Œè¿›è¡Œæ°´å¹³è½¬ç§»ï¼›ä¸è¿‡å®ƒä»¬å´å¯ä»¥ä¾èµ–ä¸€äº›åœ¨ç»†èƒæ ¸ä¸­å¤åˆ¶çš„ç—…æ¯’ï¼ˆæ¯”å¦‚ç–±ç–¹ç—…æ¯’å’Œæ†çŠ¶ç—…æ¯’ï¼‰è¿›è¡Œæ°´å¹³è½¬ç§»ã€‚</p><h3 id="æŠµå¾¡å®¿ä¸»å…ç–«"><a href="#æŠµå¾¡å®¿ä¸»å…ç–«" class="headerlink" title="æŠµå¾¡å®¿ä¸»å…ç–«"></a><strong>æŠµå¾¡å®¿ä¸»å…ç–«</strong></h3><p>å®¿ä¸»ä¹Ÿä¼šå¯¹TEæ´»åŠ¨è¿›è¡ŒæŠ‘åˆ¶ï¼Œç‰¹åˆ«æ˜¯åœ¨ç”Ÿæ®–ç³»ç»†èƒä¸­ã€‚<code>Piwi</code>(piRNA)åœ¨ç”Ÿæ®–ç»†èƒä¸­å¾ˆæ´»è·ƒï¼Œé€šè¿‡RNAå¹²æ‰°ï¼Œèƒ½å¤ŸæŠ‘åˆ¶TEçš„æ´»æ€§ã€‚æ¯”å¦‚åœ¨é»‘è…¹æœè‡çš„åµå­å½¢æˆè¿‡ç¨‹ä¸­ï¼Œ<code>I</code>å…ƒä»¶åœ¨åµæ¯ç»†èƒä¸­è¿›è¡Œé€†è½¬åº§ï¼Œä½†æ˜¯å…¶RNAä¸­ä»‹ç‰©ä»…ä»…åœ¨åµæ¯ç»†èƒå‘¨å›´çš„æ”¯æŒç»†èƒä¸­ç”Ÿæˆï¼Œç„¶åç­‰åµæ¯ç»†èƒæˆç†Ÿä¹‹åï¼Œå†é€šè¿‡å¾®ç®¡ç³»ç»Ÿä»æ”¯æŒç»†èƒè½¬è¿è‡³åµæ¯ç»†èƒä¸­ã€‚è¿™ä¹ˆåšçš„ç›®çš„ä¸€æ–¹é¢æ˜¯å‘¨å›´æ”¯æŒç»†èƒæ•°é‡è¾ƒå¤šï¼Œèƒ½å¤Ÿç§¯ç´¯å¾ˆé«˜æµ“åº¦çš„RNAä¸­ä»‹ç‰©ï¼›å¦ä¸€æ–¹é¢ä¹Ÿæ˜¯é¿å…åµæ¯ç»†èƒä¸­<code>piRNA</code>çš„æŠ‘åˆ¶ä½œç”¨ã€‚</p><h2 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5. æ€»ç»“"></a><strong>5. æ€»ç»“</strong></h2><p>è½¬åº§å­ï¼ˆTEï¼‰å‡ ä¹å­˜åœ¨äºæ‰€æœ‰çš„ç‰©ç§ä¸­ï¼Œå¯¹ç‰©ç§çš„åŸºå› ç»„ç»“æ„å’Œç‰©ç§è¿›åŒ–æœ‰é‡è¦çš„å½±å“ã€‚å°½ç®¡å¦‚æ­¤ï¼Œäººä»¬å¯¹TEçš„ç ”ç©¶è¿˜ç›¸å½“æ¬ ç¼ºã€‚åœ¨å‘ç°TEçš„å‰60å¹´çš„æ—¶é—´å†…ï¼Œäººä»¬ä¸»è¦æ˜¯é€šè¿‡æ¨¡å¼ç”Ÿç‰©å’Œå°‘æ•°å†œä¸šä½œç‰©å¯¹å°‘æ•°TEè¿›è¡Œæè¿°ï¼Œç ”ç©¶å…¶å¯¹è¡¨å‹çš„å½±å“ã€‚æœ€è¿‘åä½™å¹´ï¼Œæµ‹åºçš„è¿›æ­¥ä½¿å¾—èƒ½å¤Ÿæ›´åŠ å…¨é¢çš„è¯†åˆ«ã€æ¯”è¾ƒã€æ¢ç©¶ä¸åŒTEçš„è°ƒèŠ‚ã€è½¬å½•æ´»æ€§ï¼Œå¯¹TEçš„ç ”ç©¶æ›´åŠ å…·ä½“è¯¦ç»†ã€‚äººä»¬å‘ç°åŸºå› ç»„ä¸­å¤§éƒ¨åˆ†TEéƒ½æ˜¯å¤±æ´»çš„è½¬åº§é—è¿¹ï¼ŒçŠ¹å¦‚ä¸€åº§åº§æ­»ç«å±±ï¼Œè¿™äº›é—è¿¹çš„ç´¯ç§¯æ„æˆäº†çœŸæ ¸ç”Ÿç‰©åŸºå› ä¸­çš„é‡å¤åºåˆ—ã€‚</p><p>å¯¹TEçš„ç ”ç©¶ä¸èƒ½å¿½è§†å¯¹å…¶è½¬åº§æœºåˆ¶çš„ç ”ç©¶ã€‚ç›®å‰è¶Šæ¥è¶Šå¤šçš„ç ”ç©¶å‡ºç°åœ¨äº†åŸºå› ç»„è¿›åŒ–æ°´å¹³ä¸Šçš„ç ”ç©¶ï¼Œå´å¿½ç•¥äº†TEæœ¬èº«çš„è½¬åº§æœºåˆ¶ã€‚</p><p>TEå®¶æ—ä¹‹é—´è¡¨ç°å‡ºäº†å¾ˆå¤§çš„å·®å¼‚æ€§ï¼Œå…¶å¯¹å®¿ä¸»åŸºå› ç»„é€ æˆçš„å½±å“ä¹Ÿå¾ˆå¤§ã€‚åœ¨æ›´å¤šçš„ç‰©ç§ä¸­ï¼Œå¯¹TEè¿›è¡Œè¯†åˆ«å’Œåˆ†ç±»ä¹ŸåŒæ ·é‡è¦ã€‚åŒæ—¶è¦æ³¨é‡å¯¹è½¬åº§æœºåˆ¶çš„ç ”ç©¶ï¼Œç‰¹åˆ«æ˜¯ä¸€äº›æ¯”è¾ƒ<strong>ç‰¹æ®Šçš„è½¬åº§å­ï¼Œæ¯”å¦‚Helitrons, Marvericks, YRå…ƒä»¶</strong>ç­‰ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>annotation</tag>
      
      <tag>LTR</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RNA-seqã€hisat2ã€‘</title>
    <link href="/GeekFocus/2022/05/11/2022-05-11-hisat2/"/>
    <url>/GeekFocus/2022/05/11/2022-05-11-hisat2/</url>
    
    <content type="html"><![CDATA[<p>RNA-seq </p><span id="more"></span><h1 id="ä¸€-è½¯ä»¶æ¯”è¾ƒ"><a href="#ä¸€-è½¯ä»¶æ¯”è¾ƒ" class="headerlink" title="ä¸€. è½¯ä»¶æ¯”è¾ƒ"></a>ä¸€. è½¯ä»¶æ¯”è¾ƒ</h1><p>tophat2 ä¸æ›´æ–°ï¼Œé€Ÿåº¦æ…¢ã€‚hisat2åŒå®éªŒå®¤å¼€å‘</p><p>tophat+cufflinkså¯æ›¿æ¢ä¸ºï¼šhisat2+stringtie+ballgown</p><blockquote><p>Starçš„æ¯”å¯¹é€Ÿåº¦æ˜¯tophatçš„50å€ï¼Œhisatæ˜¯starçš„1.2å€ã€‚<br>stringTieçš„ç»„è£…é€Ÿåº¦æ˜¯cufflinksçš„25å€ï¼Œå†…å­˜æ¶ˆè€—ä¸åˆ°å…¶ä¸€åŠã€‚<br>Ballgownåœ¨å·®å¼‚åˆ†ææ–¹é¢æ¯”cuffdiffæ›´é«˜çš„ç‰¹å¼‚æ€§åŠå‡†ç¡®æ€§ï¼Œæ—¶é—´æ¶ˆè€—ä¸åˆ°cuffdiffçš„åƒåˆ†ä¹‹ä¸€<br>Bowtie2+eXpressåšè´¨é‡æ§åˆ¶ä¼˜äºtophat2+cufflinkså’Œbowtie2+RSEM<br>Sailfishè·³è¿‡æ¯”å¯¹æ­¥éª¤ï¼Œç›´æ¥è¿›è¡Œkmerè®¡æ•°åšQCï¼Œç‰¹å¼‚æ€§åŠå‡†ç¡®æ€§éƒ½è¿˜è¡Œï¼Œä½†é€Ÿåº¦æé«˜äº†25å€<br>kallistoåŒæ ·ä¸éœ€è¦æ¯”å¯¹ï¼Œé€Ÿåº¦æ¯”sailfishæé«˜5å€.</p></blockquote><p>good introductionï¼š<a href="https://cloud.tencent.com/developer/article/1703051">https://cloud.tencent.com/developer/article/1703051</a></p><h1 id="äºŒ-hisat2ä»‹ç»"><a href="#äºŒ-hisat2ä»‹ç»" class="headerlink" title="äºŒ.hisat2ä»‹ç»"></a>äºŒ.hisat2ä»‹ç»</h1><p>Hisatæ˜¯ä¸€ç§é«˜æ•ˆçš„RNA-seqå®éªŒæ¯”å¯¹å·¥å…·ã€‚å®ƒä½¿ç”¨äº†åŸºäºBWTå’ŒFerragina-manzini (Fm) index ä¸¤ç§ç®—æ³•çš„ç´¢å¼•æ¡†æ¶ã€‚ä½¿ç”¨äº†ä¸¤ç±»ç´¢å¼•å»æ¯”å¯¹ï¼Œä¸€ç±»æ˜¯å…¨åŸºå› ç»„èŒƒå›´çš„FMç´¢å¼•æ¥é”šå®šæ¯ä¸€ä¸ªæ¯”å¯¹ï¼Œå¦ä¸€ç±»æ˜¯å¤§é‡çš„å±€éƒ¨ç´¢å¼•å¯¹è¿™äº›æ¯”å¯¹åšå¿«é€Ÿçš„æ‰©å±•ã€‚æ¯”å¯¹åŸç†å¯é˜…è¯»æ–‡çŒ®åŸæ–‡ï¼šHISAT: a fast spliced aligner with low memory requirements.</p><p>ï¼ˆä¸€ï¼‰èƒŒæ™¯</p><p>è‡ª2008å¹´èµ·ï¼ŒRNAseqå·²ç»æˆä¸ºç ”ç©¶åŸºå› è¡¨è¾¾ã€è½¬å½•æœ¬ç»“æ„ã€é•¿é“¾éç¼–ç RNAç¡®å®šä»¥åŠèåˆè½¬å½•æœ¬çš„é‡è¦æ‰‹æ®µã€‚éšç€æµ‹åºæ·±åº¦çš„åŠ æ·±å’Œreadè¯»é•¿çš„å»¶é•¿ï¼Œç»™æ¯”å¯¹å·¥ä½œå¸¦æ¥å¾ˆå¤šå›°éš¾ã€‚ç›®å‰çš„å·¥å…·å¦‚Tophat2å’ŒGSNAPç­‰åœ¨å¯¹å•ä¸ªè½¬å½•ç»„å®éªŒçš„æ¯”å¯¹ä¸­è€—æ—¶å‡ å¤©ï¼Œè€Œæ–°å‹çš„STARè™½ç„¶å¾ˆå¿«ï¼Œä½†æ˜¯ä¼šåƒæ‰å¤§é‡çš„å†…å­˜ç©ºé—´ï¼Œå¦‚åŸºäºäººç±»åŸºå› ç»„çš„æ¯”å¯¹éœ€è¦æ¶ˆè€—28Gå·¦å³ï¼Œè€Œhisat2æ˜¯4.3Gï¼Œå°é¼ 3.8Gå·¦å³ã€‚</p><p>ï¼ˆäºŒï¼‰Hisatè®¾è®¡åŸåˆ™</p><p>1.ä¼˜åŒ–äº†ç´¢å¼•å»ºç«‹ç­–ç•¥</p><p>hisatåº”ç”¨äº†åŸºäºbowtie2çš„æ–¹æ³•å»å¤„ç†å¾ˆå¤šä½æ°´å¹³çš„ç”¨äºæ„å»ºå’ŒæŸ¥è¯¢FMç´¢å¼•çš„æ“ä½œã€‚ä½†æ˜¯ä¸å…¶å®ƒæ¯”å¯¹å™¨ä¸åŒçš„æ˜¯ï¼Œè¯¥è½¯ä»¶åº”ç”¨äº†ä¸¤ç±»ä¸åŒçš„ç´¢å¼•ç±»å‹ï¼šä»£è¡¨å…¨åŸºå› ç»„çš„å…¨å±€FMç´¢å¼•å’Œå¤§é‡çš„å±€éƒ¨å°ç´¢å¼•ï¼Œæ¯ä¸ªç´¢å¼•ä»£è¡¨64000bpã€‚ä»¥äººç±»åŸºå› ç»„ä¸ºä¾‹ï¼Œåˆ›å»ºäº†48000ä¸ªå±€éƒ¨ç´¢å¼•ï¼Œæ¯ä¸€ä¸ªè¦†ç›–1024bpï¼Œæœ€ç»ˆå¯ä»¥è¦†ç›–è¿™ä¸ª3 billion çš„ç¢±åŸºçš„åŸºå› ç»„ã€‚è¿™ç§å­˜åœ¨äº¤å‰ï¼ˆoverlapï¼‰çš„è¾¹ç•Œå¯ä»¥è½»æ¾çš„æ¯”å¯¹é‚£äº›è·¨åŒºåŸŸçš„readï¼ˆå¯å˜å‰ªåˆ‡ä½“ï¼‰ã€‚å°½ç®¡æœ‰å¾ˆå¤šç´¢å¼•ï¼Œä½†æ˜¯hisatä¼šæŠŠä»–ä»¬ä½¿ç”¨åˆé€‚æ–¹æ³•å‹ç¼©ï¼Œæœ€ç»ˆåªå 4gbå·¦å³çš„å†…å­˜ã€‚</p><p>2.é‡‡ç”¨äº†æ–°çš„æ¯”å¯¹ç­–ç•¥</p><p>RNA-seqäº§ç”Ÿçš„readså¯èƒ½è·¨é•¿åº¦æ¯”è¾ƒå¤§çš„å†…å«å­ï¼Œå“ºä¹³åŠ¨ç‰©ä¸­ç”šè‡³æœ€é•¿èƒ½è¾¾åˆ°1MBï¼ŒåŒæ—¶å¤–æ˜¾å­æ¯”è¾ƒçŸ­ï¼Œreadä¹Ÿæ¯”è¾ƒçŸ­ï¼Œä¼šæœ‰å¾ˆå¤šreadï¼ˆæ¨¡æ‹Ÿæ•°æ®ä¸­å¤§æ¦‚34%ï¼‰è·¨ä¸¤ä¸ªå¤–æ˜¾å­çš„æƒ…å†µã€‚ä¸ºäº†æ›´å¥½çš„æ¯”å¯¹ï¼Œå°†è·¨å¤–æ˜¾å­çš„readsåˆ†æˆäº†ä¸‰ç±»ï¼š1ï¼‰é•¿é”šå®šreadï¼Œè‡³å°‘æœ‰16bpåœ¨ä¸¤ä¸ªå¤–æ˜¾å­çš„æ¯ä¸€ä¸ªä¸Š 2ï¼‰ä¸­é—´é”šå®šreadï¼Œæœ‰8-15bpåœ¨ä¸€ä¸ªå¤–æ˜¾å­ä¸Š 3ï¼‰çŸ­é”šå®šreadï¼Œåªæœ‰1-7bpåœ¨ä¸€ä¸ªå¤–æ˜¾å­ä¸Šã€‚æ‰€ä»¥æ€»çš„readså¯ä»¥è¢«åˆ’åˆ†ä¸ºäº”ç±»ï¼š1ï¼‰ä¸è·¨å¤–æ˜¾å­çš„read 2ï¼‰é•¿é”šå®šread 3ï¼‰ä¸­é—´é”šå®šread 4ï¼‰çŸ­é”šå®šread 5ï¼‰è·¨ä¸¤ä¸ªå¤–æ˜¾å­ä»¥ä¸Šçš„readã€‚åœ¨æ¨¡æ‹Ÿçš„æ•°æ®ä¸­ï¼Œæœ‰25%å·¦å³çš„readæ˜¯é•¿é”šå®šreadï¼Œè¿™ç§readåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥è¢«å”¯ä¸€çš„å®šä½åˆ°äººçš„åŸºå› ç»„ä¸Šã€‚5%ä¸ºä¸­é—´é”šå®šreadï¼Œå¯¹äºè¿™ç±»ï¼Œå¾ˆå¤šä¾èµ–äºå…¨å±€ç´¢å¼•çš„ç®—æ³•å°±å¾ˆéš¾æ‰§è¡Œä¸‹å»ï¼ˆéœ€è¦æ¯”å¯¹å¾ˆå¤šæ¬¡ï¼‰ï¼Œè€Œhisatï¼Œå¯ä»¥å…ˆå°†readä¸­çš„é•¿ç‰‡æ®µå®ç°å”¯ä¸€æ¯”å¯¹ï¼Œä¹‹åå†ä½¿ç”¨å±€éƒ¨ç´¢å¼•å¯¹å‰©ä¸‹çš„å°ç‰‡æ®µè¿›è¡Œæ¯”å¯¹ï¼ˆå±€éƒ¨ç´¢å¼•å¯ä»¥å®ç°å¿«é€Ÿæ£€ç´¢ï¼‰ã€‚4.2%ä¸ºçŸ­é”šå®šreadï¼Œå› ä¸ºè¿™äº›åºåˆ—ç‰¹åˆ«çŸ­ï¼Œå› æ­¤åªèƒ½é€šè¿‡åœ¨hisatæ¯”å¯¹å…¶å®ƒreadæ—¶å‘ç°çš„å‰ªåˆ‡ä½ç‚¹æˆ–è€…ç”¨æˆ·è‡ªå·±æä¾›çš„å‰ªåˆ‡ä½ç‚¹æ¥è¾…åŠ©æ¯”å¯¹ã€‚æœ€åè¿˜æœ‰3%çš„æ˜¯è·¨å¤šä¸ªå¤–æ˜¾å­çš„readï¼Œæ¯”å¯¹ç­–ç•¥åœ¨hisatçš„online methodä¸­æœ‰ä»‹ç»ï¼Œæ–‡ç« ä¸­æ²¡æœ‰è¯¦è§£ã€‚æ¯”å¯¹è¿‡ç¨‹ä¸­ï¼Œä¸­é—´é”šå®šreadã€çŸ­é”šå®šreadã€è·¨å¤šä¸ªå¤–æ˜¾å­readçš„æ¯”å¯¹å æ€»æ¯”å¯¹æ—¶é•¿çš„30%-60%ï¼Œè€Œä¸”æ¯”å¯¹é”™è¯¯ç‡å¾ˆé«˜ï¼ã€å¼•ç”¨ï¼š1ã€‘</p><p>å®˜æ–¹æ‰‹å†Œï¼š<a href="https://daehwankimlab.github.io/hisat2/manual/">https://daehwankimlab.github.io/hisat2/manual/</a><br>ï¼ˆä¸‰ï¼‰.HiSat2è¿›è¡Œæ¯”å¯¹çš„å‚æ•°è®¾ç½® ã€å¼•ç”¨ï¼š2ã€‘</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><code class="hljs sh">HISAT2 version 2.1.0 by Daehwan Kim (infphilo@gmail.com, www.ccb.jhu.edu/people/infphilo)<br>Usage: <br>  hisat2 [options]* -x &lt;ht2-idx&gt; &#123;-1 &lt;m1&gt; -2 &lt;m2&gt; | -U &lt;r&gt;&#125; [-S &lt;sam&gt;]<br><br>  &lt;ht2-idx&gt;  Index filename prefix (minus trailing .X.ht2).<br>             ç´¢å¼•æ–‡ä»¶çš„å‰ç¼€<br>  &lt;m1&gt;       Files with <span class="hljs-comment">#1 mates, paired with files in &lt;m2&gt;.</span><br>             Could be gzip<span class="hljs-string">&#x27;ed (extension: .gz) or bzip2&#x27;</span>ed (extension: .bz2).<br>             Paired-endæµ‹åºçš„ç¬¬ä¸€ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥æ˜¯å‹ç¼©æ ¼å¼çš„ï¼ˆ`.gz`æˆ–è€…`.bz2`ï¼‰<br>  &lt;m2&gt;       Files with <span class="hljs-comment">#2 mates, paired with files in &lt;m1&gt;.</span><br>             Could be gzip<span class="hljs-string">&#x27;ed (extension: .gz) or bzip2&#x27;</span>ed (extension: .bz2).<br>             Paired-endæµ‹åºçš„ç¬¬äºŒä¸ªæ–‡ä»¶<br>  &lt;r&gt;        Files with unpaired reads.<br>             Could be gzip<span class="hljs-string">&#x27;ed (extension: .gz) or bzip2&#x27;</span>ed (extension: .bz2).<br>             single-endæµ‹åºçš„æ–‡ä»¶<br>  &lt;sam&gt;      File <span class="hljs-keyword">for</span> SAM output (default: stdout)<br>             è¾“å‡ºæ¯”å¯¹çš„ç»“æœï¼ˆ`.sam`ï¼‰<br><br>  &lt;m1&gt;, &lt;m2&gt;, &lt;r&gt; can be comma-separated lists (no whitespace) and can be<br>  specified many <span class="hljs-built_in">times</span>.  E.g. <span class="hljs-string">&#x27;-U file1.fq,file2.fq -U file3.fq&#x27;</span>.<br>  å¯ä»¥æ˜¯å¤šä¸ªåºåˆ—æ–‡ä»¶ç”¨é€—å·åˆ†éš”<br><br>Options (defaults <span class="hljs-keyword">in</span> parentheses):<br><br> Input:<br>  -q                 query input files are FASTQ .fq/.fastq (default)<br>                     è¾“å…¥æ£€ç´¢åºåˆ—ä¸ºFASTQGæ ¼å¼<br>  --qseq             query input files are <span class="hljs-keyword">in</span> Illumina<span class="hljs-string">&#x27;s qseq format</span><br><span class="hljs-string">                     è¾“å…¥æ£€ç´¢åºåˆ—æ˜¯Illumina qseqæ ¼å¼</span><br><span class="hljs-string">  -f                 query input files are (multi-)FASTA .fa/.mfa</span><br><span class="hljs-string">                     è¾“å…¥æ–‡ä»¶æ˜¯å¤šä¸ªFASTAæ–‡ä»¶</span><br><span class="hljs-string">  -r                 query input files are raw one-sequence-per-line</span><br><span class="hljs-string">                     è¾“å…¥æ£€ç´¢åºåˆ—æ˜¯æ¯è¡Œä¸€ä¸ªåŸå§‹åºåˆ—</span><br><span class="hljs-string">  -c                 &lt;m1&gt;, &lt;m2&gt;, &lt;r&gt; are sequences themselves, not files</span><br><span class="hljs-string">                     ç›´æ¥è¾“å…¥åºåˆ—ï¼Œè€Œä¸æ˜¯æ–‡ä»¶</span><br><span class="hljs-string">  -s/--skip &lt;int&gt;    skip the first &lt;int&gt; reads/pairs in the input (none)</span><br><span class="hljs-string">                     å¿½ç•¥è¾“å…¥åºåˆ—çš„å‰`&lt;int&gt;`ä¸ª</span><br><span class="hljs-string">  -u/--upto &lt;int&gt;    stop after first &lt;int&gt; reads/pairs (no limit)</span><br><span class="hljs-string">                     åªåˆ†æè¾“å…¥åºåˆ—çš„å‰`&lt;int&gt;`ä¸ª</span><br><span class="hljs-string">  -5/--trim5 &lt;int&gt;   trim &lt;int&gt; bases from 5&#x27;</span>/left end of reads (0)<br>                     å‰ªå»readsé•¿åº¦ä¸º`&lt;int&gt;`çš„5<span class="hljs-string">&#x27;ç«¯åºåˆ—</span><br><span class="hljs-string">  -3/--trim3 &lt;int&gt;   trim &lt;int&gt; bases from 3&#x27;</span>/right end of reads (0)<br>                     å‰ªå»readsé•¿åº¦ä¸º`&lt;int&gt;`çš„3<span class="hljs-string">&#x27;ç«¯åºåˆ—</span><br><span class="hljs-string">  --phred33          qualities are Phred+33 (default)</span><br><span class="hljs-string">                     åºåˆ—è´¨é‡æ‰“åˆ†ä¸ºPhred+33</span><br><span class="hljs-string">  --phred64          qualities are Phred+64</span><br><span class="hljs-string">                     åºåˆ—è´¨é‡æ‰“åˆ†ä¸ºPhred+64</span><br><span class="hljs-string">  --int-quals        qualities encoded as space-delimited integers</span><br><span class="hljs-string">                     åºåˆ—è´¨é‡æ‰“åˆ†ä¸ºç”¨ç©ºæ ¼åˆ†éš”çš„æ•´æ•°</span><br><span class="hljs-string"></span><br><span class="hljs-string"> Alignment:</span><br><span class="hljs-string">  --n-ceil &lt;func&gt;    func for max # non-A/C/G/Ts permitted in aln (L,0,0.15)</span><br><span class="hljs-string">                     å…è®¸åœ¨æ¯”å¯¹ç»“æœä¸­å‡ºç°çš„æœ€å¤šéACTGçš„è®¡ç®—å‡½æ•°</span><br><span class="hljs-string">  --ignore-quals     treat all quality values as 30 on Phred scale (off)</span><br><span class="hljs-string">                     å°†æ‰€æœ‰è´¨é‡åˆ†å€¼è®¾ä¸º30</span><br><span class="hljs-string">  --nofw             do not align forward (original) version of read (off)</span><br><span class="hljs-string">                     ä¸æ¯”å¯¹å‰å‘çš„read</span><br><span class="hljs-string">  --norc             do not align reverse-complement version of read (off)</span><br><span class="hljs-string">                     ä¸æ¯”å¯¹åå‘çš„read</span><br><span class="hljs-string"></span><br><span class="hljs-string"> Spliced Alignment:</span><br><span class="hljs-string">  --pen-cansplice &lt;int&gt;              penalty for a canonical splice site (0)</span><br><span class="hljs-string">                                     å¯¹å·²çŸ¥å‰ªæ¥ä½ç‚¹çš„ç½šåˆ†</span><br><span class="hljs-string">  --pen-noncansplice &lt;int&gt;           penalty for a non-canonical splice site (12)</span><br><span class="hljs-string">                                     å¯¹æ–°çš„å‰ªæ¥ä½ç‚¹çš„ç½šåˆ†</span><br><span class="hljs-string">  --pen-canintronlen &lt;func&gt;          penalty for long introns (G,-8,1) with canonical splice sites</span><br><span class="hljs-string">                                     å¯¹å·²çŸ¥å‰ªæ¥ä½ç‚¹ä¸­é•¿å†…å«å­çš„ç½šåˆ†</span><br><span class="hljs-string">  --pen-noncanintronlen &lt;func&gt;       penalty for long introns (G,-8,1) with noncanonical splice sites</span><br><span class="hljs-string">                                     å¯¹æœªçŸ¥å‰ªæ¥ä½ç‚¹ä¸­é•¿å†…å«å­çš„ç½šåˆ†</span><br><span class="hljs-string">  --min-intronlen &lt;int&gt;              minimum intron length (20)</span><br><span class="hljs-string">                                     æœ€å°å…è®¸çš„å†…å«å­é•¿åº¦</span><br><span class="hljs-string">  --max-intronlen &lt;int&gt;              maximum intron length (500000)</span><br><span class="hljs-string">                                     æœ€å¤§å…è®¸çš„å†…å«å­é•¿åº¦</span><br><span class="hljs-string">  --known-splicesite-infile &lt;path&gt;   provide a list of known splice sites</span><br><span class="hljs-string">                                     æä¾›ä¸€ä¸ªå·²çŸ¥çš„å‰ªæ¥ä½ç‚¹åˆ—è¡¨</span><br><span class="hljs-string">  --novel-splicesite-outfile &lt;path&gt;  report a list of splice sites</span><br><span class="hljs-string">                                     æŠ¥å‘Šæ–°çš„å‰ªæ¥ä½ç‚¹</span><br><span class="hljs-string">  --novel-splicesite-infile &lt;path&gt;   provide a list of novel splice sites</span><br><span class="hljs-string">                                     æä¾›æ–°çš„å‰ªæ¥ä½ç‚¹</span><br><span class="hljs-string">  --no-temp-splicesite               disable the use of splice sites found</span><br><span class="hljs-string">                                     ä¸ä½¿ç”¨å‘ç°çš„æ–°å‰ªæ¥ä½ç‚¹</span><br><span class="hljs-string">  --no-spliced-alignment             disable spliced alignment</span><br><span class="hljs-string">                                     ä¸å…è®¸å‰ªæ¥æ¯”å¯¹</span><br><span class="hljs-string">  --rna-strandness &lt;string&gt;          specify strand-specific information (unstranded)</span><br><span class="hljs-string">                                     æŒ‡å®šé“¾ç‰¹å¼‚æ€§çš„ä¿¡æ¯</span><br><span class="hljs-string">  --tmo                              reports only those alignments within known transcriptome</span><br><span class="hljs-string">                                     æŠ¥å‘ŠåªåŒ…å«å·²çŸ¥è½¬å½•ç»„ä¿¡æ¯çš„æ¯”å¯¹ç»“æœ</span><br><span class="hljs-string">  --dta                              reports alignments tailored for transcript assemblers</span><br><span class="hljs-string">                                     ç»“æœé€‚åˆç”¨äºstringtieè¿›è¡Œè½¬å½•æœ¬çš„æ‹¼æ¥</span><br><span class="hljs-string">  --dta-cufflinks                    reports alignments tailored specifically for cufflinks</span><br><span class="hljs-string">                                     ç»“æœé€‚åˆäºcufflinksçš„åº”ç”¨</span><br><span class="hljs-string">  --avoid-pseudogene                 tries to avoid aligning reads to pseudogenes (experimental option)</span><br><span class="hljs-string">                                     é¿å…ä¸å‡åŸºå› çš„æ¯”å¯¹</span><br><span class="hljs-string">  --no-templatelen-adjustment        disables template length adjustment for RNA-seq reads</span><br><span class="hljs-string">                                     ä¸å…è®¸å¯¹readsçš„æ¨¡æ¿é•¿åº¦è¿›è¡Œè°ƒæ•´</span><br><span class="hljs-string"></span><br><span class="hljs-string"> Scoring:</span><br><span class="hljs-string">  --mp &lt;int&gt;,&lt;int&gt;   max and min penalties for mismatch; lower qual = lower penalty &lt;6,2&gt;</span><br><span class="hljs-string">                     ä¸åŒ¹é…çš„æœ€å¤§ä¸æœ€å°ç½šåˆ†å€¼ï¼Œä½è´¨é‡å¯¹åº”ä½ç½šåˆ†</span><br><span class="hljs-string">  --sp &lt;int&gt;,&lt;int&gt;   max and min penalties for soft-clipping; lower qual = lower penalty &lt;2,1&gt;</span><br><span class="hljs-string">                     soft-clippingçš„æœ€å¤§ä¸æœ€å°ç½šåˆ†</span><br><span class="hljs-string">  --no-softclip      no soft-clipping</span><br><span class="hljs-string">                     ä¸è€ƒè™‘Soft-clipping</span><br><span class="hljs-string">  --np &lt;int&gt;         penalty for non-A/C/G/Ts in read/ref (1)</span><br><span class="hljs-string">                     å¯¹readæˆ–å‚è€ƒåºåˆ—ä¸­å‡ºç°çš„éATCGçš„ç½šåˆ†</span><br><span class="hljs-string">  --rdg &lt;int&gt;,&lt;int&gt;  read gap open, extend penalties (5,3)</span><br><span class="hljs-string">                     å¯¹readçš„gap-open, gap-extensionçš„ç½šåˆ†</span><br><span class="hljs-string">  --rfg &lt;int&gt;,&lt;int&gt;  reference gap open, extend penalties (5,3)</span><br><span class="hljs-string">                     å¯¹å‚è€ƒåºåˆ—çš„gap-open,gap-extensionçš„ç½šåˆ†</span><br><span class="hljs-string">  --score-min &lt;func&gt; min acceptable alignment score w/r/t read length</span><br><span class="hljs-string">                     (L,0.0,-0.2)</span><br><span class="hljs-string">                     ç›¸å¯¹readé•¿åº¦çš„æœ€å°æ¥å—æ¯”å¯¹åˆ†å€¼</span><br><span class="hljs-string"></span><br><span class="hljs-string"> Reporting:</span><br><span class="hljs-string">  -k &lt;int&gt; (default: 5) report up to &lt;int&gt; alns per read</span><br><span class="hljs-string">                     å¯¹æ¯ä¸ªreadåªæŠ¥å‘Š`&lt;int&gt;`ä¸ªæ¯”å¯¹ç»“æœ</span><br><span class="hljs-string"></span><br><span class="hljs-string"> Paired-end:</span><br><span class="hljs-string">  -I/--minins &lt;int&gt;  minimum fragment length (0), only valid with --no-spliced-alignment</span><br><span class="hljs-string">                     paired-endçš„æœ€å°ç‰‡æ®µé•¿åº¦</span><br><span class="hljs-string">  -X/--maxins &lt;int&gt;  maximum fragment length (500), only valid with --no-spliced-alignment</span><br><span class="hljs-string">                     æœ€å¤§ç‰‡æ®µé•¿åº¦</span><br><span class="hljs-string">  --fr/--rf/--ff     -1, -2 mates align fw/rev, rev/fw, fw/fw (--fr)</span><br><span class="hljs-string">                     `--fr==fw/rev`ï¼Œ`--rf==rev/fw`, `--ff==fw/fw`</span><br><span class="hljs-string">  --no-mixed         suppress unpaired alignments for paired reads</span><br><span class="hljs-string">                     ä¸è¾“å‡ºpaired readsçš„ä¸èƒ½åŒ¹é…çš„æ¯”å¯¹ç»“æœ</span><br><span class="hljs-string">  --no-discordant    suppress discordant alignments for paired reads</span><br><span class="hljs-string">                     ä¸è¾“å‡ºpaired-readsçš„ä¸ç»Ÿä¸€çš„æ¯”å¯¹ç»“æœ</span><br><span class="hljs-string"></span><br><span class="hljs-string"> Output:</span><br><span class="hljs-string">  -t/--time          print wall-clock time taken by search phases</span><br><span class="hljs-string">                     è¾“å‡ºæœç´¢é˜¶æ®µæ‰€èŠ±è´¹çš„wall-clockæ—¶é—´</span><br><span class="hljs-string">  --un &lt;path&gt;           write unpaired reads that didn&#x27;</span>t align to &lt;path&gt;<br>                        è¾“å‡ºæ²¡æœ‰ä¸`&lt;path&gt;`æ¯”å¯¹çš„unpaired reads<br>  --al &lt;path&gt;           write unpaired reads that aligned at least once to &lt;path&gt;<br>                        è¾“å‡ºè‡³å°‘ä¸`&lt;path&gt;`æœ‰ä¸€æ¬¡æ¯”å¯¹çš„unpaired reads<br>  --un-conc &lt;path&gt;      write pairs that didn<span class="hljs-string">&#x27;t align concordantly to &lt;path&gt;</span><br><span class="hljs-string">  --al-conc &lt;path&gt;      write pairs that aligned concordantly at least once to &lt;path&gt;</span><br><span class="hljs-string">  (Note: for --un, --al, --un-conc, or --al-conc, add &#x27;</span>-gz<span class="hljs-string">&#x27; to the option name, e.g.</span><br><span class="hljs-string">  --un-gz &lt;path&gt;, to gzip compress output, or add &#x27;</span>-bz2<span class="hljs-string">&#x27; to bzip2 compress output.)</span><br><span class="hljs-string">                    å°†è¾“å‡ºç»“æœè¿›è¡Œ`gz`æˆ–è€…`bz2`å‹ç¼©</span><br><span class="hljs-string">  --summary-file     print alignment summary to this file.</span><br><span class="hljs-string">                     å°†æ¯”å¯¹çš„æ€»ç»“è¾“å‡ºåˆ°æ–‡ä»¶ä¸­</span><br><span class="hljs-string">  --new-summary      print alignment summary in a new style, which is more machine-friendly.</span><br><span class="hljs-string">                     å°†æ¯”å¯¹æ€»ç»“ä»¥æ–°çš„å½¢å¼è¾“å‡º</span><br><span class="hljs-string">  --quiet            print nothing to stderr except serious errors</span><br><span class="hljs-string">                     é™¤äº†ä¸¥é‡é”™è¯¯ä»¥å¤–ï¼Œä¸å°†ä»»ä½•ç»“æœè¾“å‡ºåˆ°stderr</span><br><span class="hljs-string">  --met-file &lt;path&gt;  send metrics to file at &lt;path&gt; (off)</span><br><span class="hljs-string">                     å°†åº¦é‡å€¼iè¾“å‡ºåˆ°æ–‡ä»¶</span><br><span class="hljs-string">  --met-stderr       send metrics to stderr (off)</span><br><span class="hljs-string">                     å°†åº¦é‡å€¼è¾“å‡ºåˆ°stderr</span><br><span class="hljs-string">  --met &lt;int&gt;        report internal counters &amp; metrics every &lt;int&gt; secs (1)</span><br><span class="hljs-string">                     æ¯éš”`&lt;int&gt;`ç§’è¾“å‡ºå½“å‰çš„å†…éƒ¨è®¡æ•°å™¨å’Œåº¦é‡å€¼</span><br><span class="hljs-string">  --no-head          supppress header lines, i.e. lines starting with @</span><br><span class="hljs-string">                     ä¸è¾“å‡ºheaderè¡Œï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰ä»¥`@`å¼€å§‹çš„è¡Œ</span><br><span class="hljs-string">  --no-sq            supppress @SQ header lines</span><br><span class="hljs-string">                     ä¸è¾“å‡º`@SQ`è¡Œ</span><br><span class="hljs-string">  --rg-id &lt;text&gt;     set read group id, reflected in @RG line and RG:Z: opt field</span><br><span class="hljs-string">                     è®¾ç½®`@RG`</span><br><span class="hljs-string">  --rg &lt;text&gt;        add &lt;text&gt; (&quot;lab:value&quot;) to @RG line of SAM header.</span><br><span class="hljs-string">                     Note: @RG line only printed when --rg-id is set.</span><br><span class="hljs-string">                     å°†`&lt;text&gt;`åŠ åˆ°SAMæ–‡ä»¶çš„`@RG`è¡Œ</span><br><span class="hljs-string">  --omit-sec-seq     put &#x27;</span>*<span class="hljs-string">&#x27; in SEQ and QUAL fields for secondary alignments.</span><br><span class="hljs-string">                     å°†&quot;*&quot;ç½®äºSEQå’ŒQUALä¸¤åˆ—ä¸­ï¼Œè¿›è¡ŒäºŒæ¬¡æ¯”å¯¹</span><br><span class="hljs-string"></span><br><span class="hljs-string"> Performance:</span><br><span class="hljs-string">  -o/--offrate &lt;int&gt; override offrate of index; must be &gt;= index&#x27;</span>s offrate<br>                     é‡ç½®ç´¢å¼•çš„`offrate`ï¼Œè¯¥å€¼å¿…é¡»å¤§äºåŸæœ‰çš„`offrate`<br>  -p/--threads &lt;int&gt; number of alignment threads to launch (1)<br>                     æ¯”å¯¹æ‰€ç”¨çš„çº¿ç¨‹æ•°<br>  --reorder          force SAM output order to match order of input reads<br>                     å¼ºåˆ¶è¦æ±‚SAMè¾“å‡ºé¡ºåºæ¯”å¯¹ä¸è¾“å…¥readsä¸€è‡´<br>  --mm               use memory-mapped I/O <span class="hljs-keyword">for</span> index; many <span class="hljs-string">&#x27;hisat2&#x27;</span>s can share<br>                     ä½¿ç”¨å†…å­˜æ˜ å°„çš„I/Oä½œä¸ºç´¢å¼•<br><br> Other:<br>  --qc-filter        filter out reads that are bad according to QSEQ filter<br>                     æ ¹æ®QSEQ filterè¿‡æ»¤è¾“å…¥çš„reads<br>  --seed &lt;int&gt;       seed <span class="hljs-keyword">for</span> random number generator (0)<br>                     è®¾ç½®RNG seedsçš„å€¼<br>  --non-deterministic seed rand. gen. arbitrarily instead of using <span class="hljs-built_in">read</span> attributes<br>                     ä¸æ ¹æ®readsçš„å±æ€§äº§ç”Ÿéšæœºæ•°<br>  --remove-chrname   remove <span class="hljs-string">&#x27;chr&#x27;</span> from reference names <span class="hljs-keyword">in</span> alignment<br>                     æ¯”å¯¹ç»“æœä¸­çš„å‚è€ƒåºåˆ—åç§°ä¸­å»é™¤`chr`<br>  --add-chrname      add <span class="hljs-string">&#x27;chr&#x27;</span> to reference names <span class="hljs-keyword">in</span> alignment<br>                     åœ¨æ¯”å¯¹ç»“æœçš„å‚è€ƒåºåˆ—åç§°ä¸­åŠ å…¥`chr` <br>  --version          <span class="hljs-built_in">print</span> version information and quit<br>                     è¾“å‡ºç‰ˆæœ¬ä¿¡æ¯<br>  -h/--help          <span class="hljs-built_in">print</span> this usage message<br>                     è¾“å‡ºå¸®åŠ©ä¿¡æ¯<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh"> --dta                              reports alignments tailored <span class="hljs-keyword">for</span> transcript assemblers<br>                                     ç»“æœé€‚åˆç”¨äºstringtieè¿›è¡Œè½¬å½•æœ¬çš„æ‹¼æ¥<br><span class="hljs-comment">#Cufflinks error: BAM record error: found spliced alignment without XS attribute</span><br>https://www.biostars.org/p/118904/<br>https://bioinformatics.stackexchange.com/questions/4074/hisat2-which-option-should-mention-for-strand-specific-library-read<br>--rna-strandnessSpecify strand-specific information: the default is unstranded. For single-end reads, use F or R. <span class="hljs-string">&#x27;F&#x27;</span> means a <span class="hljs-built_in">read</span> corresponds to a transcript. <span class="hljs-string">&#x27;R&#x27;</span> means a <span class="hljs-built_in">read</span> corresponds to the reverse complemented counterpart of a transcript. For paired-end reads, use either FR or RF. With this option being used, every <span class="hljs-built_in">read</span> alignment will have an XS attribute tag: <span class="hljs-string">&#x27;+&#x27;</span> means a <span class="hljs-built_in">read</span> belongs to a transcript on <span class="hljs-string">&#x27;+&#x27;</span> strand of genome. <span class="hljs-string">&#x27;-&#x27;</span> means a <span class="hljs-built_in">read</span> belongs to a transcript on <span class="hljs-string">&#x27;-&#x27;</span> strand of genome.<br>--fr/--rf/--ffThe upstream/downstream mate orientations <span class="hljs-keyword">for</span> a valid paired-end alignment against the forward reference strand. E.g., <span class="hljs-keyword">if</span> --fr is specified and there is a candidate paired-end alignment <span class="hljs-built_in">where</span> mate 1 appears upstream of the reverse complement of mate 2 and the fragment length constraints (-I and -X) are met, that alignment is valid. Also, <span class="hljs-keyword">if</span> mate 2 appears upstream of the reverse complement of mate 1 and all other constraints are met, that too is valid. --rf likewise requires that an upstream mate1 be reverse-complemented and a downstream mate2 be forward-oriented. --ff requires both an upstream mate 1 and a downstream mate 2 to be forward-oriented. Default: --fr (appropriate <span class="hljs-keyword">for</span> Illumina<span class="hljs-string">&#x27;s Paired-end Sequencing Assay).</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><blockquote><p><code>--fr</code>&#x2F;<code>--rf</code>&#x2F;<code>--ff</code> should rarely be set, since they refer to the relative orientation of reads and basically everything these days is <code>--fr</code>. Mate-pairs were <code>--rf</code>, but you donâ€™t see those much any more.</p><p><code>--rna-strandedness</code> is a very different option, since it sets how reads are expected to align against genes. Most stranded protocols in use these days follow the dUTP-method, where read #2 in a pair has the same orientation as the transcript from which it arose. So either <code>R</code> or <code>RF</code>would typically be appropriate, unless the library is unstranded. In practice, I expect this is more useful if you plan to run stringTie downstream, since then the <code>XS</code> auxiliary tag is set appropriately.</p></blockquote><p>hisat2å¯ä»¥è‡ªå·±å»ºç«‹indexæ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰ç°æˆçš„indexçš„è¯ï¼Œé‚£å°±å¾—è‡ªå·±å»å»ºç«‹äº†ï¼Œè¿™ä¸ªå°±æ¯”è¾ƒéº»çƒ¦è€Œä¸”è€—å†…å­˜å’Œæ—¶é—´ï¼Œä¸‹é¢æ˜¯å»ºç«‹indexçš„ä¸€äº›å‚æ•°ä»‹ç»ã€‚å› ä¸ºæˆ‘ä»¬çš„indexæ–‡ä»¶æ˜¯ç›´æ¥ä¸‹è½½çš„ï¼Œæ‰€ä»¥æˆ‘åé¢ä¸éœ€è¦å»ºç«‹indexæ–‡ä»¶ï¼Œå…³äºè¿™éƒ¨åˆ†ï¼Œåé¢æœ‰æœºä¼šä»‹ç»ã€‚</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">HISAT2 <span class="hljs-built_in">version</span> <span class="hljs-number">2.1</span><span class="hljs-number">.0</span> <span class="hljs-keyword">by</span> Daehwan Kim (infphilo@gmail.com, <span class="hljs-keyword">http</span>://www.ccb.jhu.edu/people/infphilo)<br>Usage: hisat2-build [options]* &lt;reference_in&gt; &lt;ht2_index_base&gt;<br>    reference_in            <span class="hljs-literal">comma</span>-separated list <span class="hljs-keyword">of</span> <span class="hljs-built_in">files</span> <span class="hljs-keyword">with</span> ref sequences<br>                            ä»¥é€—å·åˆ†éš”çš„å‚è€ƒåºåˆ—æ–‡ä»¶çš„åˆ—è¡¨<br>    hisat2_index_base       <span class="hljs-built_in">write</span> ht2 data <span class="hljs-built_in">to</span> <span class="hljs-built_in">files</span> <span class="hljs-keyword">with</span> this dir/basename<br>                            è¾“å‡ºçš„ç´¢å¼•æ–‡ä»¶çš„`basename`<br>Options:<br>    -c                      reference sequences given <span class="hljs-keyword">on</span> <span class="hljs-title">cmd</span> <span class="hljs-title">line</span> (<span class="hljs-title">as</span><br>                            &lt;reference_in&gt;)<br>                            è¾“å…¥çš„å‚è€ƒåºåˆ—<br>    <span class="hljs-comment">--large-index           force generated index to be &#x27;large&#x27;, even if ref</span><br>                            has fewer than <span class="hljs-number">4</span> billion nucleotides<br>                            å¼ºåˆ¶è¦æ±‚äº§ç”Ÿçš„ç´¢å¼•ä¸º`large`<br>    -<span class="hljs-keyword">a</span>/<span class="hljs-comment">--noauto             disable automatic -p/--bmax/--dcv memory-fitting</span><br>                            å…³é—­-p/<span class="hljs-comment">--bmax/--dcvç­‰è‡ªåŠ¨å†…å­˜åŒ¹é…</span><br>    -p                      <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> threads<br>                            çº¿ç¨‹æ•°<br>    <span class="hljs-comment">--bmax &lt;int&gt;            max bucket sz for blockwise suffix-array builder</span><br>                            é€å—åç¼€æ•°ç»„å»ºç«‹é‡‡ç”¨çš„æœ€å¤§bucket size<br>    <span class="hljs-comment">--bmaxdivn &lt;int&gt;        max bucket sz as divisor of ref len (default: 4)</span><br>    <span class="hljs-comment">--dcv &lt;int&gt;             diff-cover period for blockwise (default: 1024)</span><br>    <span class="hljs-comment">--nodc                  disable diff-cover (algorithm becomes quadratic)</span><br>    -r/<span class="hljs-comment">--noref              don&#x27;t build .3/.4.ht2 (packed reference) portion</span><br>    <span class="hljs-number">-3</span>/<span class="hljs-comment">--justref            just build .3/.4.ht2 (packed reference) portion</span><br>    -o/<span class="hljs-comment">--offrate &lt;int&gt;      SA is sampled every 2^offRate BWT chars (default: 5)</span><br>    -t/<span class="hljs-comment">--ftabchars &lt;int&gt;    # of chars consumed in initial lookup (default: 10)</span><br>    <span class="hljs-comment">--localoffrate &lt;int&gt;    SA (local) is sampled every 2^offRate BWT chars (default: 3)</span><br>    <span class="hljs-comment">--localftabchars &lt;int&gt;  # of chars consumed in initial lookup in a local index (default: 6)</span><br>    <span class="hljs-comment">--snp &lt;path&gt;            SNP file name</span><br>    <span class="hljs-comment">--haplotype &lt;path&gt;      haplotype file name</span><br>    <span class="hljs-comment">--ss &lt;path&gt;             Splice site file name</span><br>    <span class="hljs-comment">--exon &lt;path&gt;           Exon file name</span><br>    <span class="hljs-comment">--seed &lt;int&gt;            seed for random number generator</span><br>    -q/<span class="hljs-comment">--quiet              verbose output (for debugging)</span><br>    -h/<span class="hljs-comment">--help               print detailed description of tool and its options</span><br>    <span class="hljs-comment">--usage                 print this usage message</span><br>    <span class="hljs-comment">--version               print version information and quit</span><br></code></pre></td></tr></table></figure><h1 id="ä¸‰-stringtie2ä»‹ç»"><a href="#ä¸‰-stringtie2ä»‹ç»" class="headerlink" title="ä¸‰. stringtie2ä»‹ç»"></a>ä¸‰. stringtie2ä»‹ç»</h1><p><a href="https://ccb.jhu.edu/software/stringtie/">https://ccb.jhu.edu/software/stringtie/</a></p><p><a href="https://github.com/gpertea/stringtie">https://github.com/gpertea/stringtie</a></p><p><a href="https://cloud.tencent.com/developer/article/1702981">https://cloud.tencent.com/developer/article/1702981</a></p><p>StringTie æ˜¯ç”¨äº RNA-seq çš„è½¬å½•æœ¬<font color="blue">ç»„è£…å’Œå®šé‡</font>è½¯ä»¶ï¼ŒStringTie æ˜¯<font color="blue">cufflinkså‡çº§ç‰ˆ</font>ï¼ŒåŠŸèƒ½å’ŒCufflinksä¸€æ ·ï¼ŒåŒ…æ‹¬ä¸‹é¢ä¸¤ä¸ªä¸»è¦åŠŸèƒ½ï¼šè½¬å½•æœ¬ç»„è£…å’Œå®šé‡ï¼›ç›¸æ¯”Cuffinks, è¿è¡Œé€Ÿåº¦æ›´å¿«</p><p>1ã€Stringtieé€šè¿‡<font color="blue">genomeæŒ‡å¯¼ç»„è£…ä¸ä»å¤´ç»„è£…ç»“åˆ</font>çš„æ–°æ–¹æ³•æ¥æ”¹å–„è½¬å½•ç»„ç»„è£…ã€‚</p><p> 2ã€Stringtieçš„è¾“å…¥ä¸ä»…å¯ä»¥æ˜¯ç»è¿‡æ¯”å¯¹çš„ç»“æœï¼Œ<font color="blue">ä¹Ÿå¯ä»¥æ˜¯Stringtieä»å¤´ç»„è£…readå¾—åˆ°çš„contig</font>ï¼Œå½“è¿™ä¸¤ç§è¾“å…¥éƒ½ç”¨åˆ°çš„æ—¶å€™ï¼Œç§°ä¹‹ä¸º<font color="blue">stringtie+SR</font>ã€‚</p><p> 3ã€å¯¹äºå¾ˆå¤š<font color="blue">ä½¿ç”¨å‚è€ƒåŸºå› ç»„è¾…åŠ©ç»„è£…</font>çš„æ–¹æ³•ï¼Œç»„è£…çš„çš„ç­–ç•¥éƒ½æ˜¯<font color="blue">å…ˆå¯¹readè¿›è¡Œcluter</font>ï¼Œç„¶åå»ºç«‹<font color="blue">graph model</font>æ¨æµ‹æ¯ä¸ªåŸºå› <font color="blue">æ‰€æœ‰å¯èƒ½çš„isoform</font>ï¼Œæœ€ç»ˆé€šè¿‡ä¸åŒçš„graphçš„è§£ææ–¹æ³•å¾—åˆ°å¯¹è½¬å½•æœ¬çš„ç»„è£…ç»“æœã€‚</p><p> 4ã€<font color="blue">cufflinks</font>é‡‡ç”¨<font color="blue">overlap graph</font>ï¼Œè¯¥æ¨¡å‹ä¸­<font color="blue">nodesä»£è¡¨fragment</font>ï¼Œå¦‚æœä¸¤ä¸ªfragment<font color="blue">å­˜åœ¨overlapå¹¶å­˜åœ¨å…¼å®¹çš„å‰ªåˆ‡æ¨¡å¼</font>ï¼Œåˆ™å¯¹åº”çš„nodeè¿æ¥èµ·æ¥ã€‚å…¶è§£ææ–¹æ³•ä¸ºä¸€ç§ä¿å®ˆçš„ç®—æ³•ï¼Œ<font color="blue">å¯ä»¥äº§ç”Ÿèƒ½å¤Ÿè§£é‡Šæ‰€æœ‰readçš„æœ€å°‘çš„è½¬å½•æœ¬</font>ï¼Œå°½ç®¡è¿™ç§æ–¹æ³•å¾ˆå¸å¼•äººï¼Œä½†æ˜¯<font color="red">æ²¡æœ‰è€ƒè™‘åˆ°è½¬å½•æœ¬çš„ä¸°åº¦</font>å¹¶ä¸”<font color="blue">æŸäº›isoform</font>è¯¥æ–¹æ³•<font color="blue">æ— æ³•ç»„è£…</font>ï¼</p><p> 5ã€stringtieé‡‡ç”¨<font color="red"><strong>ç»„è£…è½¬å½•æœ¬å’Œä¼°è®¡è¡¨è¾¾é‡åŒæ­¥è¿›è¡Œ</strong></font>çš„æ–¹æ³•ï¼Œä¸åŒäºcufflinksçš„å…ˆç»„è£…åå®šé‡çš„ç­–ç•¥ã€‚</p><p> 6ã€é¦–å…ˆï¼Œstringtieå°†readèšæˆclusterï¼Œç„¶åé‡‡ç”¨<font color="blue">splice graph</font>ï¼Œå…¶ä¸­<font color="blue">nodeä»£è¡¨å¤–æ˜¾å­æˆ–å¤–æ˜¾å­çš„ä¸€éƒ¨åˆ†</font>ï¼Œpathå°†graphä¸­å¯èƒ½çš„å‰ªåˆ‡ç°è±¡è¿æ¥ï¼Œæœ€ç»ˆå¯¹æ¯ä¸ªè½¬å½•æœ¬é€šè¿‡åˆ›å»ºä¸€ä¸ªç½‘ç»œæµçš„æ–¹æ³•ï¼Œåˆ©ç”¨<font color="blue">æœ€å¤§æµç®—æ³•</font>ï¼ˆmaximum flow algorithmï¼‰<font color="red">ä¼°è®¡è½¬å½•æœ¬çš„è¡¨è¾¾é‡</font>ã€‚</p><p> 7ã€<font color="red">æœ€å¤§æµçš„é—®é¢˜æ˜¯æœ€ä¼˜ç†è®ºä¸­çš„ç»å…¸é—®é¢˜</font>ï¼Œä½†æ˜¯ç›®å‰è¿˜æ²¡æœ‰åº”ç”¨åˆ°è½¬å½•æœ¬å®šé‡ä¸­ã€‚</p><p> 8ã€ä¸å…¶å®ƒç»„è£…è½¯ä»¶ç›¸æ¯”ï¼Œstringtieå…·æœ‰å¾ˆé«˜çš„<font color="red"><strong>å‡†ç¡®æ€§</strong>å’Œ<strong>æ–°å‹isoformå‘ç°</strong>èƒ½åŠ›</font>ï¼Œå…¶ä¼˜åŠ¿åœ¨äºä½¿ç”¨ç½‘ç»œæµç®—æ³•ï¼ŒåŒæ—¶stringtieä¹Ÿæ”¯æŒå°†readä»å¤´ç»„è£…æˆ<font color="blue">æ›´é•¿ç‰‡æ®µ</font>ï¼Œè¿›ä¸€æ­¥æé«˜äº†å…¶ç»„è£…çš„æ­£ç¡®æ€§ã€‚</p><p> 9ã€å…¶å¦ä¸€ä¸ªä¼˜åŠ¿åœ¨äºå®ƒçš„<font color="blue">æœ€ä¼˜åŒ–ç­–ç•¥</font>ï¼Œå®ƒ<font color="blue">å¹³è¡¡äº†æ¯æ¬¡ç»„è£…ä¸­æ¯æ¡è½¬å½•æœ¬çš„è¦†ç›–åº¦</font>ï¼Œè¿™æ ·å¯ä»¥å¯¹ç»„è£…ç®—æ³•äº§ç”Ÿä¸€å®šçš„é™åˆ¶ï¼Œå› ä¸ºåœ¨ç»„è£…åŸºå› ç»„æ—¶ï¼Œè¦†ç›–åº¦æ˜¯å¾ˆé‡è¦çš„ä¸€ä¸ªå‚æ•°å› ä¸ºå®ƒéœ€è¦è¢«ç”¨æ¥é™åˆ¶ç®—æ³•ï¼Œå¦åˆ™ç»„è£…å™¨å¯èƒ½å°†é‡å¤çš„ç‰‡æ®µé”™è¯¯åœ°å †å åˆ°ä¸€èµ·ï¼Œç›¸ä¼¼åœ°è½¬å½•ç»„è£…ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œ<font color="red"><strong>åœ¨isoformä¸­çš„æ¯ä¸€ä¸ªå¤–æ˜¾å­éœ€è¦æœ‰ç›¸ä¼¼çš„è¦†ç›–åº¦</strong></font>ï¼Œå¦‚æœå¿½ç•¥è¿™ä¸ªå‚æ•°å¯èƒ½ä¼šäº§ç”Ÿä¸€äº›ä¿å®ˆä½†æ˜¯é”™è¯¯çš„è½¬å½•æœ¬ï¼Œå…¶ä¸­å«æœ‰å¤§é‡å‰ªåˆ‡ä½ç‚¹çš„åŸºå› ç»„è£…èµ·æ¥å°¤å…¶å›°éš¾ã€‚</p><p>å¸¸ç”¨çš„å‚æ•°åŠæè¿°ï¼š</p><table><thead><tr><th>å‚æ•°</th><th>â€“</th></tr></thead><tbody><tr><td>-o [<path/>]&lt;out.gtf&gt;</td><td>è®¾ç½®StringTieç»„è£…è½¬å½•æœ¬çš„è¾“å‡ºGTFæ–‡ä»¶çš„<strong>å…¨è·¯å¾„å’Œæ–‡ä»¶å</strong>ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒStringTieå°†GTFå†™å…¥æ ‡å‡†è¾“å‡º</td></tr><tr><td>-p <int></td><td>çº¿ç¨‹æ•°ï¼Œé»˜è®¤1</td></tr><tr><td>-G &lt;ref_ann.gff&gt;</td><td>ä½¿ç”¨å‚è€ƒæ³¨é‡ŠåŸºå› æ–‡ä»¶æŒ‡å¯¼ç»„è£…è¿‡ç¨‹ï¼Œæ ¼å¼GTF&#x2F;GFF3ã€‚-eæœªè®¾ç½®æ—¶è¾“å‡ºæ–‡ä»¶ä¸­æ—¢åŒ…å«å‚è€ƒæ–‡ä»¶è½¬å½•æœ¬ï¼Œä¹ŸåŒ…å«æ–°è½¬å½•æœ¬ã€‚é€‰é¡¹-Bï¼Œ-bï¼Œ-eï¼Œ-Céœ€è¦æ­¤é€‰é¡¹</td></tr><tr><td>-l <label></td><td>è¾“å‡ºè½¬å½•æœ¬åç§°çš„å‰ç¼€ã€‚é»˜è®¤ï¼šSTRG</td></tr><tr><td>-A &lt;gene_abund.tab&gt;</td><td>è¾“å‡ºçš„gtfç»Ÿè®¡åŸºå› è¡¨è¾¾é‡ï¼ˆtabåˆ†éš”ï¼‰</td></tr><tr><td>-C &lt;cov_refs.gtf&gt;</td><td>è¾“å‡ºæ‰€æœ‰è½¬å½•æœ¬å¯¹åº”çš„readsè¦†ç›–åº¦çš„æ–‡ä»¶ï¼Œæ­¤å¤„çš„è½¬å½•æœ¬æ˜¯æŒ‡å‚è€ƒæ³¨é‡ŠåŸºå› æ–‡ä»¶ä¸­æä¾›çš„è½¬å½•æœ¬ã€‚(éœ€è¦å‚æ•° -G).</td></tr><tr><td>-B</td><td>åº”ç”¨è¯¥é€‰é¡¹ï¼Œåˆ™ä¼šè¾“å‡ºBallgownè¾“å…¥è¡¨æ–‡ä»¶ï¼ˆ* .ctabï¼‰ï¼Œå…¶ä¸­åŒ…å«ç”¨-Gé€‰é¡¹ç»™å‡ºçš„å‚è€ƒè½¬å½•æœ¬çš„è¦†ç›–ç‡æ•°æ®ã€‚ï¼ˆæœ‰å…³è¿™äº›æ–‡ä»¶çš„è¯´æ˜ï¼Œè¯·å‚é˜…Ballgownæ–‡æ¡£ã€‚ï¼‰å¦‚æœé€‰é¡¹-o ç»™å‡ºè¾“å‡ºè½¬å½•æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œåˆ™* .ctabæ–‡ä»¶ä¸è¾“å‡ºGTFæ–‡ä»¶åœ¨ç›¸åŒçš„ç›®å½•ä¸‹ã€‚</td></tr><tr><td>-b <path></td><td>#æŒ‡å®š *.ctab æ–‡ä»¶çš„è¾“å‡ºè·¯å¾„, è€Œéç”±-oé€‰é¡¹æŒ‡å®šçš„ç›®å½•ã€‚æ³¨æ„: å»ºè®®åœ¨ä½¿ç”¨-B&#x2F;-bé€‰é¡¹ä¸­åŒæ—¶ä½¿ç”¨-eé€‰é¡¹ï¼Œé™¤éStringTie GTFè¾“å‡ºæ–‡ä»¶ä¸­ä»éœ€è¦æ–°çš„è½¬å½•æœ¬,-Bå’Œ-bé€‰ä¸€ä¸ªä½¿ç”¨å°±è¡Œã€‚</td></tr><tr><td>-e</td><td>é™åˆ¶readsæ¯”å¯¹çš„å¤„ç†ï¼Œä»…ä¼°è®¡å’Œè¾“å‡ºä¸ç”¨-Gé€‰é¡¹ç»™å‡ºçš„å‚è€ƒè½¬å½•æœ¬åŒ¹é…çš„ç»„è£…è½¬å½•æœ¬ã€‚ä½¿ç”¨è¯¥é€‰é¡¹ï¼Œåˆ™ä¼šè·³è¿‡å¤„ç†ä¸å‚è€ƒè½¬å½•æœ¬ä¸åŒ¹é…çš„ç»„è£…è½¬å½•æœ¬ï¼Œæé€Ÿ</td></tr><tr><td>-m <int></td><td>é¢„æµ‹è½¬å½•æœ¬è®¾ç½®æœ€å°é•¿åº¦ï¼Œé»˜è®¤200</td></tr><tr><td>â€“merge</td><td>#è½¬å½•æœ¬åˆå¹¶æ¨¡å¼ã€‚åœ¨åˆå¹¶æ¨¡å¼ä¸‹ï¼ŒStringTieå°†æ‰€æœ‰æ ·å“çš„GTF&#x2F;GFFæ–‡ä»¶åˆ—è¡¨ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†è¿™äº›è½¬å½•æœ¬åˆå¹¶&#x2F;ç»„è£…æˆéå†—ä½™çš„è½¬å½•æœ¬é›†åˆã€‚è¿™ç§æ¨¡å¼è¢«ç”¨äºæ–°çš„å·®å¼‚åˆ†ææµç¨‹ä¸­ï¼Œç”¨ä»¥ç”Ÿæˆä¸€ä¸ªè·¨å¤šä¸ªRNA-Seqæ ·å“çš„å…¨å±€çš„ã€ç»Ÿä¸€çš„è½¬å½•æœ¬ã€‚å¦‚æœæä¾›äº†-Gé€‰é¡¹ï¼ˆå‚è€ƒæ³¨é‡ŠåŸºå› ç»„æ–‡ä»¶ï¼‰ï¼Œåˆ™StringTieå°†ä»è¾“å…¥çš„GTFæ–‡ä»¶ä¸­å°†å‚è€ƒè½¬å½•æœ¬ç»„è£…åˆ°transfragsä¸­ã€‚(ä¸ªäººç†è§£ï¼štransfragså¯èƒ½æŒ‡çš„æ˜¯æ‹¼æ¥æˆæ›´å¤§çš„è½¬å½•æœ¬ç‰‡æ®µï¼Œtanscript fragments)ã€‚åœ¨æ­¤æ¨¡å¼ä¸‹å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é™„åŠ é€‰é¡¹ï¼š</td></tr><tr><td>-G <guide_gff></td><td>#å‚è€ƒæ³¨é‡ŠåŸºå› ç»„æ–‡ä»¶(GTF&#x2F;GFF3)</td></tr><tr><td>-o <out_gtf></td><td>#æŒ‡å®šè¾“å‡ºåˆå¹¶çš„GTFæ–‡ä»¶çš„è·¯å¾„å’Œåç§° (é»˜è®¤å€¼ï¼šæ ‡å‡†è¾“å‡º)</td></tr><tr><td>-m <min_len></td><td>#åˆå¹¶æ–‡ä»¶ä¸­ï¼ŒæŒ‡å®šå…è®¸æœ€å°è¾“å…¥è½¬å½•æœ¬çš„é•¿åº¦ (é»˜è®¤å€¼: 50)</td></tr><tr><td>-c <min_cov></td><td>#åˆå¹¶æ–‡ä»¶ä¸­ï¼ŒæŒ‡å®šå…è®¸æœ€ä½è¾“å…¥è½¬å½•æœ¬çš„è¦†ç›–åº¦(é»˜è®¤å€¼: 0)</td></tr><tr><td>-F <min_fpkm></td><td>#åˆå¹¶æ–‡ä»¶ä¸­ï¼ŒæŒ‡å®šå…è®¸æœ€ä½è¾“å…¥è½¬å½•æœ¬çš„FPKMå€¼ (é»˜è®¤å€¼: 0)</td></tr><tr><td>-T <min_tpm></td><td>#åˆå¹¶æ–‡ä»¶ä¸­ï¼ŒæŒ‡å®šå…è®¸æœ€ä½è¾“å…¥è½¬å½•æœ¬çš„TPMå€¼ (é»˜è®¤å€¼: 0)</td></tr><tr><td>-f <min_iso></td><td>#minimum isoform fraction (é»˜è®¤å€¼: 0.01)</td></tr><tr><td>-i</td><td>#åˆå¹¶åï¼Œä¿ç•™å«retained intronsçš„è½¬å½•æœ¬ (é»˜è®¤å€¼: é™¤éæœ‰å¼ºæœ‰åŠ›çš„è¯æ®ï¼Œå¦åˆ™ä¸äºˆä¿ç•™)</td></tr><tr><td>-l <label></td><td>#è¾“å‡ºè½¬å½•æœ¬çš„åç§°å‰ç¼€ (é»˜è®¤å€¼: MSTRG)</td></tr></tbody></table><h1 id="å››-stringtie2-ä½¿ç”¨"><a href="#å››-stringtie2-ä½¿ç”¨" class="headerlink" title="å››. stringtie2 ä½¿ç”¨"></a>å››. stringtie2 ä½¿ç”¨</h1><p><strong>1.å•æ ·æœ¬è½¬å½•æœ¬ç»„è£…</strong></p><p>è¾“å…¥æ–‡æ¡£æ˜¯BAM.sortedã€‚å¯ä»¥æ˜¯æ¥æºäºTophatæˆ–hisat2ã€‚æ­¤å¤–ï¼Œè¿˜éœ€è¦gtfæ³¨é‡Šæ–‡ä»¶??</p><p>gtfä¸‹è½½ genecodeå®˜ç½‘ï¼š<a href="https://www.gencodegenes.org/">https://www.gencodegenes.org/</a></p><p>å•æ ·æœ¬ç»„è£…ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">stringtie -p 8 -G /data/mouse_annotation/gencode.mouse.annotation.gtf -o cleandata/stringtiedata/CK-4.gtf cleandata/samtools_bam/CK-4_sort.bam<br></code></pre></td></tr></table></figure><p><strong>2.å¤šæ ·æœ¬è½¬å½•æœ¬æ•´åˆ</strong></p><p>stringtie â€“merge [options] gtf.list :è½¬å½•ç»„mergeæ¨¡å¼ï¼Œåœ¨è¯¥æ¨¡å¼ä¸‹ï¼ŒStringtieå¯ä»¥åˆ©ç”¨è¾“å…¥çš„ä¸€ä¸ªgtf listå¹¶å°†ä»–ä»¬ä¸­çš„è½¬å½•æœ¬è¿›è¡Œéå†—ä½™çš„æ•´ç†ã€‚å¯ä»¥åœ¨å¤„ç†å¤šä¸ªRNA-seqæ ·æœ¬çš„æ—¶å€™ï¼Œç”±äºè½¬å½•ç»„å­˜åœ¨æ—¶ç©ºç‰¹å¼‚æ€§ï¼Œå¯ä»¥å°†æ¯ä¸ªæ ·æœ¬å„è‡ªçš„è½¬å½•ç»„è¿›è¡Œéå†—ä½™çš„æ•´åˆï¼Œå¦‚æœ-Gæä¾›äº†å‚è€ƒgtfæ–‡ä»¶ï¼Œå¯ä»¥å°†å…¶ä¸€èµ·æ•´åˆåˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­,æœ€ç»ˆè¾“å‡ºæˆä¸€ä¸ªå®Œæ•´çš„gtfæ–‡ä»¶ã€‚</p><p>å°†æ–‡ä»¶åçš„å®Œæ•´è·¯å¾„è¾“å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">find /data/RNAseq/cleandata/stringtiedata/ -name *.gtf &gt; /data/RNAseq/cleandata/stringtiedata/merglist.txt<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">stringtie --merge -p 8 -G /data/mouse_annotation/gencode.mouse.annotation.gtf -o cleandata/stringtiedata/stringtie_merged.gtf cleandata/stringtiedata/merglist.txt<br></code></pre></td></tr></table></figure><p><strong>3. ä½¿ç”¨gffcompareæ£€éªŒæ•°æ®æ¯”å¯¹åˆ°åŸºå› ç»„ä¸Šçš„æƒ…å†µ(å¯é€‰)</strong></p><p>ç¨‹åºgffcompareå¯ç”¨äºæ¯”è¾ƒã€åˆå¹¶ã€æ³¨é‡Šå’Œä¼°è®¡ä¸€ä¸ªæˆ–å¤šä¸ªGFFæ–‡ä»¶(â€œæŸ¥è¯¢â€æ–‡ä»¶)çš„å‡†ç¡®æ€§ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">gffcompare [options]* &#123;-i <span class="hljs-tag">&lt;<span class="hljs-name">input_gtf_list</span>&gt;</span> | <span class="hljs-tag">&lt;<span class="hljs-name">input1.gtf</span>&gt;</span> [<span class="hljs-tag">&lt;<span class="hljs-name">input2.gtf</span>&gt;</span> .. <span class="hljs-tag">&lt;<span class="hljs-name">inputN.gtf</span>&gt;</span>]&#125;<br></code></pre></td></tr></table></figure><p><strong>4.é‡æ–°ç»„è£…è½¬å½•æœ¬å¹¶ä¼°ç®—åŸºå› è¡¨è¾¾ä¸°åº¦</strong></p><p>åˆ©ç”¨mergeå¾—åˆ°çš„gtfé‡æ–°å¯¹å„ä¸ªæ ·æœ¬åšå®šé‡ï¼Œå¹¶åˆ›å»ºballgownå¯è¯»å–æ–‡ä»¶ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> CK-4 CK-7 CK-8 HGJ-10 HGJ-6 HGJ-9; <span class="hljs-keyword">do</span> stringtie -e -B -p 8 -G cleandata/stringtiedata/stringtie_merged.gtf  -o cleandata/ballgown/<span class="hljs-variable">$&#123;i&#125;</span>/<span class="hljs-variable">$&#123;i&#125;</span>.gtf cleandata/samtools_bam/<span class="hljs-variable">$&#123;i&#125;</span>_sort.bam; <span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><p><strong>5.read countæ•°æ®è¾“å‡º</strong></p><p>è¿™é‡Œéœ€è¦prepDE.pyè¿™ä¸ªè„šæœ¬ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">prepDE.py -i cleandata<span class="hljs-regexp">/ballgown/</span><br></code></pre></td></tr></table></figure><h1 id="äº”-Trinity"><a href="#äº”-Trinity" class="headerlink" title="äº”. Trinity"></a>äº”. Trinity</h1><p>ä¸‹è½½github æœ€æ–°ç‰ˆ</p><p>make plugins</p><ul><li>Inchworm ï¼ˆè™«ï¼‰ï¼ˆC++ï¼‰</li><li>Chrysalis ï¼ˆè›¹ï¼‰ï¼ˆC++ï¼‰</li><li>Butterfly ï¼ˆè¶ï¼‰ï¼ˆJavaï¼‰</li></ul><h3 id="Trinityç»„è£…åŸç†"><a href="#Trinityç»„è£…åŸç†" class="headerlink" title="Trinityç»„è£…åŸç†"></a>Trinityç»„è£…åŸç†</h3><p>Trinityç»„è£…ä¾æ®çš„ç®—æ³•æ˜¯de Bruijn Graph,å³ä»æ‰“æ–­çš„æ–‡åº“ä¸­æå–ä¸€å®šé•¿åº¦çš„K-merï¼Œç„¶åæ ¹æ®k-1é”™ä½ç›¸ä¼¼çš„æ–¹æ³•æ‹¼æ¥ç»„è£…çš„å¯èƒ½è·¯å¾„ï¼Œæœ€ç»ˆç¡®å®šå®Œæ•´çš„å‚è€ƒç»„è£…è½¬å½•ç»„ã€‚</p><p><img src="/GeekFocus/2022-05-11-hisat2/1.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-11-hisat2/1.png" alt="img"></p><p><strong>Trinityæ ¹æ®è¯¥åŸç†ï¼Œå°†ä¸»è¦æ“ä½œæ­¥éª¤åˆ†ä¸º3ä¸ªæ¨¡å—ï¼Œåˆ†åˆ«å½¢è±¡çš„å‘½åä¸ºè™«ï¼Œè›¹ï¼Œè¶ï¼š</strong></p><ul><li>åºåˆ—å»¶ä¼¸ (inchworm) â€”â€”è™«<ul><li>å°† readsåˆ‡ä¸º k-mers (k bpé•¿åº¦çš„çŸ­ç‰‡æ®µ)</li><li>åˆ©ç”¨Overlapå…³ç³»å¯¹k-mersè¿›è¡Œå»¶ä¼¸ (è´ªå©ªç®—æ³•)</li><li>è¾“å‡ºæ‰€æœ‰çš„åºåˆ— (â€œcontigsâ€)</li></ul></li><li>æ„å»º de Bruijn graph (chrysalis)â€”â€”è›¹<ul><li>èšç±»æ‰€æœ‰ç›¸ä¼¼åŒºåŸŸå¤§äºk-1bpçš„ contigs</li><li>æ„å›¾ (åŒºåˆ†ä¸åŒçš„ â€œcomponentsâ€)</li><li>å°†readsæ¯”å¯¹å› componentsï¼Œè¿›è¡ŒéªŒè¯</li></ul></li><li>è§£å›¾ï¼Œåˆ—ä¸¾è½¬å½•æœ¬ (butterfly)â€”â€”è¶<ul><li>æ‹†åˆ†graph ä¸ºçº¿æ€§åºåˆ—</li><li>ä½¿ç”¨readsä»¥åŠ pairså…³ç³»æ¶ˆé™¤é”™è¯¯åºåˆ—</li></ul></li></ul><img src="2022-05-11-hisat2/2.png" alt="img" style="zoom:50%;" /><p><img src="/GeekFocus/img/2022-05-11-hisat2/2.png" alt="img"></p><h3 id="Trinity-ç»„è£…æµç¨‹"><a href="#Trinity-ç»„è£…æµç¨‹" class="headerlink" title="Trinity ç»„è£…æµç¨‹"></a>Trinity ç»„è£…æµç¨‹</h3><p>Trinityç»„è£…æµç¨‹ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ul><li>ç»„è£…å‰æ•°æ®çš„è´¨æ§</li><li>ç»„è£…</li><li>ç»„è£…è´¨é‡çš„è¯„ä¼°</li><li>ä¸‹æ¸¸åˆ†æ<ul><li>å·®å¼‚åˆ†æ</li><li>å¯Œé›†åˆ†æ</li><li>åŠŸèƒ½åˆ†æ</li></ul></li></ul><img src="2022-05-11-hisat2/3.png" alt="img" style="zoom:67%;" /><p><img src="/GeekFocus/img/2022-05-11-hisat2/3.png" alt="img"></p><h4 id="STEP1-ç»„è£…å‰è´¨æ§"><a href="#STEP1-ç»„è£…å‰è´¨æ§" class="headerlink" title="STEP1: ç»„è£…å‰è´¨æ§"></a>STEP1: ç»„è£…å‰è´¨æ§</h4><p>fatqcâ€”â€”trimmamaticç­‰å»é™¤ä½è´¨é‡çš„readsç­‰</p><h4 id="STEP2-ç»„è£…"><a href="#STEP2-ç»„è£…" class="headerlink" title="STEP2: ç»„è£…"></a>STEP2: ç»„è£…</h4><p><strong>Trinity åŸºæœ¬å‘½ä»¤çš„å«ä¹‰ï¼š</strong></p><ul><li><code>--seqType</code> : [fa&#x2F;fq] åŸå§‹æ•°æ®çš„æ ¼å¼ï¼Œå¯ä»¥æ˜¯fastaæˆ–fastqï¼Œå¯ä»¥æ˜¯.gzæˆ–ä¸æ˜¯</li><li><code>--left/--right</code>ï¼šé’ˆå¯¹åŒç«¯æµ‹åºï¼Œå¦‚æœæ˜¯åŒä¸€æ ·æœ¬ä¸åŒæ—¶æœŸçš„å¤šä¸ªæ–‡ä»¶ï¼Œå¯ä»¥ä¸­é—´ä»¥é€—å·åˆ†éš”ï¼Œæ²¡æœ‰ç©ºæ ¼ã€‚</li><li><code>--single</code>: é’ˆå¯¹å•ç«¯æµ‹åº</li><li><code>--SS_lib_type</code>ï¼š[RF]â€”åŒç«¯é“¾ç‰¹å¼‚æµ‹åºï¼›</li><li><code>--output</code>ï¼šè¾“å‡ºæ–‡ä»¶ï¼Œå‘½åå¿…é¡»å¸¦Trinity</li><li><code>--CPU</code>ï¼šç»„è£…ä½¿ç”¨CPUä¸ªæ•°</li><li><code>--max_memory</code>ï¼šç»„è£…æ‰€éœ€å†…å­˜ï¼ˆegï¼š10Gï¼‰</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">## my_trinity_script.sh</span><br><span class="hljs-comment">#!/bin/bash</span><br>/software/trinityrnaseq-2.2.0/Trinity --seqType fq \<br>--left RNASEQ_data/Sp_ds.left.fq.gz,RNASEQ_data/Sp_hs.left.fq.gz,RNASEQ_data/Sp_log.left.fq.gz,RNASEQ_data/Sp_plat.left.fq.gz \<br>--right RNASEQ_data/Sp_ds.right.fq.gz,RNASEQ_data/Sp_hs.right.fq.gz,RNASEQ_data/Sp_log.right.fq.gz,RNASEQ_data/Sp_plat.right.fq.gz \<br>--CPU  1 \<br>--max_memory 1G<br></code></pre></td></tr></table></figure><p><strong>trinityç»„è£…ç»“æœ</strong></p><p>ä¼šè‡ªåŠ¨ç”ŸæˆTrinity_out_dir, å…¶ä¸­Trinity.fastaå³ç»„è£…çš„åˆæ­¥ç»“æœ</p><p><img src="/GeekFocus/2022-05-11-hisat2/4.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-11-hisat2/4.png" alt="img"></p><p><strong>ç»„è£…ç»“æœç»Ÿè®¡</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/software/</span>trinityrnaseq-<span class="hljs-number">2.2</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/util/</span>TrinityStats.pl trinity_out_dir<span class="hljs-regexp">/Trinity.fasta &gt; ./</span>trinity_out_dir/assembly_report.txt<br></code></pre></td></tr></table></figure><h4 id="STEP3-ç»„è£…åè´¨é‡è¯„ä¼°"><a href="#STEP3-ç»„è£…åè´¨é‡è¯„ä¼°" class="headerlink" title="STEP3: ç»„è£…åè´¨é‡è¯„ä¼°"></a>STEP3: ç»„è£…åè´¨é‡è¯„ä¼°</h4><p><strong>ç»„è£…è´¨é‡è¯„ä¼°æ ‡å‡†</strong></p><ul><li>Unigeneæ•°é‡</li><li>N50</li><li>æ¯”å¯¹ç‡â€“æ¯”å¯¹ç‡å¤§äº80%</li><li>æ³¨é‡Šæ¯”ç‡â€“ç‰©ç§è¿‘ç¼˜æ€§è‰¯å¥½CDSåºåˆ—ç›¸å¯¹å®Œæ•´60%ä»¥ä¸Š</li><li>æ ¸å¿ƒè›‹ç™½æ¯”å¯¹ç‡â€“çœŸæ ¸ç”Ÿç‰©ä¸­å­˜åœ¨ä¸€äº›é«˜åº¦ä¿å®ˆåŒºåŸŸæ‰€ç¼–ç çš„è›‹ç™½ï¼ˆ2748&#x2F;80%ä»¥ä¸Šï¼‰</li></ul><p><strong>ç»„è£…å®Œæ•´æ€§</strong></p><ul><li>N50é•¿åº¦ï¼Œå¯ä»¥åˆæ­¥è¯„ä¼°ï¼Œä½†ä¸æ˜¯è¶Šé•¿è¶Šå¥½ï¼Œå¯¹åº”ç‰©ç§è€ƒè™‘</li><li>é€šè¿‡ç»Ÿè®¡Unigeneå¯¹è¿‘ç¼˜ç‰©ç§åŸºå› è¦†ç›–åº¦åˆ†å¸ƒ</li></ul><p><strong>ç»„è£…å‡†ç¡®æ€§</strong></p><ul><li>ç»„è£…é•¿åº¦ä¼šå½±å“å®šé‡çš„å‡†ç¡®æ€§</li></ul><p><strong>åç»­å®šé‡å‡†ç¡®æ€§</strong></p><p><strong>ç»„è£…å†—ä½™åº¦</strong></p><ul><li><p>å½±å“å®šé‡å‡†ç¡®æ€§çš„æœ€å¤§å› ç´ ï¼š<strong>å†—ä½™</strong></p></li><li><p>å†—ä½™ï¼šç»„è£…å‡ºçš„Unigeneçš„æ•°é‡å¤§å¤§è¶…è¿‡åŸºå› æ•°ï¼›</p></li><li><p>å†—ä½™çš„æ¥æºï¼šï¼ˆ1ï¼‰å¯å˜å‰ªåˆ‡ï¼›ï¼ˆ2ï¼‰æµ‹åºé”™è¯¯å¼•å…¥çš„â€œæ–°â€ è½¬å½•æœ¬ï¼›</p></li><li><p>å†—ä½™çš„æœ€å¤§å½±å“ï¼šå¯¼è‡´å¤šé‡æ¯”å¯¹ï¼Œç»™å®šé‡å¸¦æ¥å›°éš¾</p></li><li><p>å‡å°‘å†—ä½™ç­–ç•¥<br>ï¼ˆ1ï¼‰å»é™¤ä½è´¨é‡çš„reads;ï¼ˆ2ï¼‰æ˜¯å¦æœ‰å¤–æ´æ±¡æŸ“;ï¼ˆ3ï¼‰ä½¿ç”¨Normalizationå‚æ•°ï¼Œé™ä½é«˜ä¸°åº¦åŸºå› çš„readsæ•°æ®ï¼ŒåŒæ—¶æé«˜ç»„è£…æ•ˆç‡ï¼›ï¼ˆ4ï¼‰ åç»­åºåˆ—èšç±»æˆ–è¿‡æ»¤</p></li><li><p><strong>å»å†—ä½™æ–¹æ³•</strong></p><p>ï¼ˆ1ï¼‰ç­›é€‰åŒä¸€åŸºå› çš„æœ€é•¿è½¬å½•æœ¬ä½œä¸ºunigene</p><p>ï¼ˆ2ï¼‰è½¯ä»¶ï¼šTGICLã€CAP3é€šè¿‡èšç±»ç­›é€‰unigene</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 1.æå–æœ€é•¿è½¬å½•æœ¬</span><br>/software/trinityrnaseq-2.2.0/util/misc/get_longest_isoform_seq_per_trinity_gene.pl \ <br>./trinity_out_dir/Trinity.fasta &gt; ./trinity_out_dir/unigene1.fasta<br><br><span class="hljs-comment"># 2.è½¯ä»¶èšç±»å»å†—ä½™</span><br>cd-hit-est -i ./trinity_out_dir/Trinity.fasta -o  output-cdhit -T 1 -M 1000<br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"># unigeneé•¿åº¦åˆ†å¸ƒ<br>perl /software/trinityrnaseq<span class="hljs-number">-2.2</span><span class="hljs-number">.0</span>/util/misc/fasta_seq_length.pl ./trinity_out_dir/Trinity.fasta &gt; ./trinity_out_dir/length.txt<br><span class="hljs-meta">#Rç”»å›¾</span><br>data &lt;- <span class="hljs-keyword">read</span>.<span class="hljs-keyword">table</span>(&quot;length.txt&quot;,<span class="hljs-keyword">header</span>=T)<br>data[,<span class="hljs-number">2</span>][which(<span class="hljs-keyword">as</span>.numeric(data[,<span class="hljs-number">2</span>])&gt;=<span class="hljs-number">2000</span>)]&lt;<span class="hljs-number">-2000</span><br><br>library(ggplot2)<br>pdf(&quot;length_distribution.pdf&quot;,height=<span class="hljs-number">7</span>,width=<span class="hljs-number">10</span>)<br>ggplot(<span class="hljs-keyword">as</span>.data.frame(data), aes(x = <span class="hljs-keyword">as</span>.numeric(data[,<span class="hljs-number">2</span>])))+geom_histogram(binwidth =<span class="hljs-number">100</span>)+<br>xlab(&quot;Transcripts Length Interval&quot;)+<br>ylab(&quot;Number ofTranscripts&quot;)+<br>labs(title=&quot;Transcripts Length Distribution&quot;)+<br>scale_x_continuous(breaks=seq(<span class="hljs-number">100</span>,<span class="hljs-number">2000</span>,<span class="hljs-keyword">by</span>=<span class="hljs-number">100</span>),<br>labels=c(&quot;100&quot;,&quot;200&quot;,&quot;300&quot;,&quot;400&quot;,&quot;500&quot;,&quot;600&quot;,&quot;700&quot;,&quot;800&quot;,&quot;900&quot;,&quot;1000&quot;,&quot;1100&quot;,&quot;1200&quot;,&quot;1<br>300&quot;,&quot;1400&quot;,&quot;1500&quot;,&quot;1600&quot;,&quot;1700&quot;,&quot;1800&quot;,&quot;1900&quot;,&quot;&gt;=2000&quot;))<br>dev.<span class="hljs-keyword">off</span>()<br></code></pre></td></tr></table></figure><h3 id="Trinityç»„è£…åä¸‹æ¸¸åˆ†æ"><a href="#Trinityç»„è£…åä¸‹æ¸¸åˆ†æ" class="headerlink" title="Trinityç»„è£…åä¸‹æ¸¸åˆ†æ"></a>Trinityç»„è£…åä¸‹æ¸¸åˆ†æ</h3><h4 id="STEP4-å®šé‡ï¼šæ¯”å¯¹å’Œä¸°åº¦è®¡ç®—"><a href="#STEP4-å®šé‡ï¼šæ¯”å¯¹å’Œä¸°åº¦è®¡ç®—" class="headerlink" title="STEP4: å®šé‡ï¼šæ¯”å¯¹å’Œä¸°åº¦è®¡ç®—"></a>STEP4: å®šé‡ï¼šæ¯”å¯¹å’Œä¸°åº¦è®¡ç®—</h4><p>åˆ©ç”¨RSEMè¿›è¡Œä¸°åº¦ä¼°è®¡ï¼Œ</p><p><img src="/GeekFocus/2022-05-11-hisat2/4.png" alt="img"></p><p><img src="/GeekFocus/img/2022-05-11-hisat2/4.png" alt="img"></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># æ¯”å¯¹readsè¯„ä¼°è¡¨è¾¾é‡ï¼ˆæ¯ä¸ªæ ·å“è¿è¡Œä¸€æ¬¡ï¼‰</span><br><span class="hljs-comment"># Sp_log</span><br>/software/trinityrnaseq-2.2.0/util/align_and_estimate_abundance.pl \<br>--transcripts ./trinity_out_dir/unigene1.fasta --seqType fq \<br>--left RNASEQ_data/Sp_log.left.fq.gz --right RNASEQ_data/Sp_log.right.fq.gz \<br>--est_method RSEM --aln_method bowtie --trinity_mode --prep_reference \<br>--output_dir rsem_Sp_log_outdir<br><span class="hljs-comment"># Sp_ds</span><br>/software/trinityrnaseq-2.2.0/util/align_and_estimate_abundance.pl \<br>--transcripts ./trinity_out_dir/unigene1.fasta --seqType fq \<br>--left RNASEQ_data/Sp_ds.left.fq.gz --right RNASEQ_data/Sp_ds.right.fq.gz \<br>--est_method RSEM --aln_method bowtie --trinity_mode --prep_reference \<br>--output_dir rsem_Sp_ds_outdir<br><br><span class="hljs-comment"># Sp_hs</span><br>/software/trinityrnaseq-2.2.0/util/align_and_estimate_abundance.pl \<br>--transcripts ./trinity_out_dir/unigene1.fasta --seqType fq \<br>--left RNASEQ_data/Sp_hs.left.fq.gz --right RNASEQ_data/Sp_hs.right.fq.gz \<br>--est_method RSEM --aln_method bowtie --trinity_mode --prep_reference \<br>--output_dir rsem_Sp_hs_outdir<br><br><span class="hljs-comment"># Sp_plat</span><br>/software/trinityrnaseq-2.2.0/util/align_and_estimate_abundance.pl \<br>--transcripts ./trinity_out_dir/unigene1.fasta --seqType fq \<br>--left RNASEQ_data/Sp_plat.left.fq.gz --right RNASEQ_data/Sp_plat.right.fq.gz \<br>--est_method RSEM --aln_method bowtie --trinity_mode --prep_reference \<br>--output_dir rsem_Sp_plat_outdir <br></code></pre></td></tr></table></figure><p>å‚æ•°å«ä¹‰ï¼š</p><ul><li><code>--aln_method</code>: é»˜è®¤æ˜¯bowtie</li><li><code>--est_method</code>:ä¸°åº¦è¯„ä¼°æ–¹æ³•ï¼Œé»˜è®¤æ˜¯RSEMï¼Œæ›´å‡†ç¡®ï¼Œä¹Ÿå¯é€‰æ‹©<code>eXpress</code>, æ›´å¿«å’Œæ‰€éœ€RAMå°‘</li><li><code>--trinity_mode</code>: å‚è€ƒæ–‡ä»¶æ¥è‡ªtrinityï¼Œå¦‚æœä¸æ˜¯éœ€è¦ä¸€ä¸ªgene-isoform æ¯”å¯¹æ–‡ä»¶ <code>--gene_trans_map</code></li></ul><p><strong>æŸ¥çœ‹mappingç»“æœ</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># ds</span><br>perl /software/trinityrnaseq-2.2.0/util/SAM_nameSorted_to_uniq_count_stats.pl rsem_Sp_ds_outdir/bowtie.bam &gt; rsem_Sp_ds_outdir/mapping.out<br></code></pre></td></tr></table></figure><h4 id="STEP5-å·®å¼‚åˆ†æ"><a href="#STEP5-å·®å¼‚åˆ†æ" class="headerlink" title="STEP5: å·®å¼‚åˆ†æ"></a>STEP5: å·®å¼‚åˆ†æ</h4><p><strong>åˆ›å»ºæ•°é‡çŸ©é˜µ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs undefined">/software/trinityrnaseq-2.2.0/util/abundance_estimates_to_matrix.pl \<br>--est_method RSEM \<br>--out_prefix Trinity_trans \<br>rsem_Sp_ds_outdir/ds_RSEM.isoforms.results \<br>rsem_Sp_hs_outdir/hs_RSEM.isoforms.results \<br>rsem_Sp_log_outdir/log_RSEM.isoforms.results \<br>rsem_Sp_plat_outdir/plat_RSEM.isoforms.results<br></code></pre></td></tr></table></figure><p><strong>æ— ç”Ÿç‰©å­¦é‡å¤è¿›è¡Œå·®å¼‚è¡¨è¾¾åˆ†æ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs undefined">/software/trinityrnaseq-2.2.0/Analysis/DifferentialExpression/run_DE_analysis.pl \<br>--matrix trinity_trans.matrix/Trinity_trans.counts.matrix \<br>--dispersion 0.1 --method edgeR \<br>--output edgeR<br></code></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹å·®å¼‚æ•°</strong></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs dart">sed <span class="hljs-string">&#x27;1,1d&#x27;</span> edgeR/Trinity_trans.counts.matrix.ds_RSEM_vs_hs_RSEM.edgeR.DE_results | awk <span class="hljs-string">&#x27;&#123; if (<span class="hljs-subst">$5</span> &lt;= 0.05) print;&#125;&#x27;</span> &gt; edgeR/ds_hs_DE_num<br><br>sed <span class="hljs-string">&#x27;1,1d&#x27;</span> edgeR/Trinity_trans.counts.matrix.ds_RSEM_vs_log_RSEM.edgeR.DE_results | awk <span class="hljs-string">&#x27;&#123; if (<span class="hljs-subst">$5</span> &lt;= 0.05) print;&#125;&#x27;</span> &gt; edgeR/ds_log_DE_num<br><br>sed <span class="hljs-string">&#x27;1,1d&#x27;</span> edgeR/Trinity_trans.counts.matrix.ds_RSEM_vs_plat_RSEM.edgeR.DE_results | awk <span class="hljs-string">&#x27;&#123; if (<span class="hljs-subst">$5</span> &lt;= 0.05) print;&#125;&#x27;</span> &gt; edgeR/ds_plat_DE_num<br><br>sed <span class="hljs-string">&#x27;1,1d&#x27;</span> edgeR/Trinity_trans.counts.matrix.hs_RSEM_vs_log_RSEM.edgeR.DE_results | awk <span class="hljs-string">&#x27;&#123; if (<span class="hljs-subst">$5</span> &lt;= 0.05) print;&#125;&#x27;</span> &gt; edgeR/hs_log_DE_num<br><br>sed <span class="hljs-string">&#x27;1,1d&#x27;</span> edgeR/Trinity_trans.counts.matrix.hs_RSEM_vs_plat_RSEM.edgeR.DE_results | awk <span class="hljs-string">&#x27;&#123; if (<span class="hljs-subst">$5</span> &lt;= 0.05) print;&#125;&#x27;</span> &gt; edgeR/hs_plat_DE_num<br><br>sed <span class="hljs-string">&#x27;1,1d&#x27;</span> edgeR/Trinity_trans.counts.matrix.log_RSEM_vs_plat_RSEM.edgeR.DE_results | awk <span class="hljs-string">&#x27;&#123; if (<span class="hljs-subst">$5</span> &lt;= 0.05) print;&#125;&#x27;</span> &gt; edgeR/log_plat_DE_num<br></code></pre></td></tr></table></figure><h4 id="STEP6-èšç±»-x2F-ç½‘ç»œåˆ†æ"><a href="#STEP6-èšç±»-x2F-ç½‘ç»œåˆ†æ" class="headerlink" title="STEP6: èšç±»&#x2F;ç½‘ç»œåˆ†æ"></a>STEP6: èšç±»&#x2F;ç½‘ç»œåˆ†æ</h4><p><strong>æå–å·®å¼‚è¡¨è¾¾çš„åºåˆ—ç»˜åˆ¶çƒ­å›¾</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æå–å·®å¼‚è¡¨è¾¾çš„åºåˆ—ç»˜åˆ¶çƒ­å›¾</span><br><span class="hljs-built_in">cd</span> edgeR/<br>/software/trinityrnaseq-2.2.0/Analysis/DifferentialExpression/analyze_diff_expr.pl \<br>--matrix ../trinity_trans.matrix/Trinity_trans.TMM.EXPR.matrix -P 1e-3 -C 2<br><br><span class="hljs-comment"># æ ¹æ®èšç±»å›¾æå–å­ç±»</span><br>/software/trinityrnaseq-2.2.0/Analysis/DifferentialExpression/define_clusters_by_cutting_tree.pl \<br>--Ptree 60 -R diffExpr.P1e-3_C2.matrix.RData<br></code></pre></td></tr></table></figure><h3 id="æ ¹æ®èšç±»å›¾æå–å­ç±»"><a href="#æ ¹æ®èšç±»å›¾æå–å­ç±»" class="headerlink" title="æ ¹æ®èšç±»å›¾æå–å­ç±»"></a>æ ¹æ®èšç±»å›¾æå–å­ç±»</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æå–å·®å¼‚è¡¨è¾¾çš„åºåˆ—ç»˜åˆ¶çƒ­å›¾</span><br><span class="hljs-built_in">cd</span> edgeR/<br>/software/trinityrnaseq-2.2.0/Analysis/DifferentialExpression/analyze_diff_expr.pl \<br>--matrix ../trinity_trans.matrix/Trinity_trans.TMM.EXPR.matrix -P 1e-3 -C 2<br><br><span class="hljs-comment"># æ ¹æ®èšç±»å›¾æå–å­ç±»</span><br>/software/trinityrnaseq-2.2.0/Analysis/DifferentialExpression/define_clusters_by_cutting_tree.pl \<br>--Ptree 60 -R diffExpr.P1e-3_C2.matrix.RData<br></code></pre></td></tr></table></figure><h4 id="STEP7-åŠŸèƒ½æ³¨é‡Šå’Œå¯Œé›†åˆ†æ"><a href="#STEP7-åŠŸèƒ½æ³¨é‡Šå’Œå¯Œé›†åˆ†æ" class="headerlink" title="STEP7: åŠŸèƒ½æ³¨é‡Šå’Œå¯Œé›†åˆ†æ"></a>STEP7: åŠŸèƒ½æ³¨é‡Šå’Œå¯Œé›†åˆ†æ</h4><p>ä½¿ç”¨TransDecoder-å¯¹trinityç»“æœè¿›è¡Œæ³¨é‡Š</p><p><strong>1. é¢„æµ‹ORF (open-reading-frame) ( DNA -&gt; protein sequence)</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">/software/TransDecoder/TransDecoder.LongOrfs -t trinity_out_dir/unigene1.fasta<br><span class="hljs-comment"># </span><br>/software/TransDecoder/TransDecoder.Predict -t trinity_out_dir/unigene1.fasta<br></code></pre></td></tr></table></figure><p><strong>2. é¢„æµ‹åŸºå› åŠŸèƒ½</strong></p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RNA-seq</tag>
      
      <tag>mapping</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BRAKER2</title>
    <link href="/GeekFocus/2022/04/21/2022-04-28-BRAKER/"/>
    <url>/GeekFocus/2022/04/21/2022-04-28-BRAKER/</url>
    
    <content type="html"><![CDATA[<p>BRAKER2</p><span id="more"></span><h1 id="Contents"><a href="#Contents" class="headerlink" title="Contents"></a>Contents</h1><ul><li><a href="https://github.com/Gaius-Augustus/BRAKER#authors-of-braker">Authors</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#funding">Funding</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#what-is-braker">What is BRAKER?</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#keys-to-successful-gene-prediction">Keys to successful gene prediction</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#overview-of-modes-for-running-braker">Overview of modes for running BRAKER</a></li><li>Installation<ul><li><a href="https://github.com/Gaius-Augustus/BRAKER#supported-software-versions">Supported software versions</a></li><li>BRAKER<ul><li><a href="https://github.com/Gaius-Augustus/BRAKER#perl-pipeline-dependencies">Perl pipeline dependencies</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#braker-components">BRAKER components</a></li><li>Bioinformatics software dependencies<ul><li><a href="https://github.com/Gaius-Augustus/BRAKER#mandatory-tools">Mandatory tools</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#optional-tools">Optional tools</a></li></ul></li></ul></li></ul></li><li>Running BRAKER<ul><li>BRAKER pipeline modes<ul><li><a href="https://github.com/Gaius-Augustus/BRAKER#braker-with-rna-seq-data">BRAKER with RNA-Seq data</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#braker-with-proteins-of-any-evolutionary-distance">BRAKER with proteins of any evolutionary distance</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#braker-with-proteins-of-short-evolutionary-distance">BRAKER with proteins of short evolutionary distance</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#braker-with-rna-seq-and-protein-data">BRAKER with RNA-Seq and protein data</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#braker-with-short-and-long-read-RNA-Seq-and-protein-data">BRAKER with short and long read RNA-Seq and protein data</a></li></ul></li><li>Description of selected BRAKER command line options<ul><li><a href="https://github.com/Gaius-Augustus/BRAKER#--ab_initio">â€“ab_initio</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#--augustus_args--some_argbla">â€“augustus_args&#x3D;â€“some_arg&#x3D;bla</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#--coresint">â€“cores&#x3D;INT</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#--fungus">â€“fungus</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#--softmasking">â€“softmasking</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#--useexisting">â€“useexisting</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#--crf">â€“crf</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#--lambdaint">â€“lambda&#x3D;int</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#--utron">â€“UTR&#x3D;on</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#--addutr">â€“addUTR&#x3D;on</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#--stranded-">â€“stranded&#x3D;+,-,.,â€¦</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#--makehub---emailyourmailde">â€“makehub --email&#x3D;your@mail.de</a></li></ul></li></ul></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#output-of-braker">Output of BRAKER</a></li><li>Example data<ul><li><a href="https://github.com/Gaius-Augustus/BRAKER#data-description">Data description</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#testing-braker-with-rna-seq-data">Testing BRAKER with RNA-Seq data</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#testing-braker-with-proteins-of-any-evolutionary-distance">Testing BRAKER with proteins of any evolutionary distance</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#testing-braker-with-proteins-of-any-evolutionary-distance-and-rna-seq">Testing BRAKER with proteins of any evolutionary distance and RNA-Seq</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#testing-braker-with-proteins-of-close-homology">Testing BRAKER with proteins of close homology</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#testing-braker-with-proteins-of-close-homology-and-rna-seq-data-rna-seq-supported-training">Testing BRAKER with proteins of close homology and RNA-Seq data (RNA-Seq supported training)</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#testing-braker-with-proteins-of-close-homoogy-and-rna-seq-data-rna-seq-and-protein-supported-training">Testing BRAKER with proteins of close homoogy and RNA-Seq data (RNA-Seq and protein supported training)</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#testing-braker-with-pre-trained-parameters">Testing BRAKER with pre-trained parameters</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#testing-braker-with-genome-sequence">Testing BRAKER with genome sequence</a></li></ul></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#starting-braker-on-the-basis-of-previously-existing-braker-runs">Starting BRAKER on the basis of previously existing BRAKER runs</a></li><li>Bug reporting<ul><li><a href="https://github.com/Gaius-Augustus/BRAKER#reporting-bugs-on-github">Reporting bugs on github</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#common-problems">Common problems</a></li></ul></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#citing-braker-and-software-called-by-braker">Citing BRAKER and software called by BRAKER</a></li><li><a href="https://github.com/Gaius-Augustus/BRAKER#license">License</a></li></ul><h1 id="What-is-BRAKER"><a href="#What-is-BRAKER" class="headerlink" title="What is BRAKER?"></a>What is BRAKER?</h1><p>The rapidly growing number of sequenced genomes requires fully automated methods for accurate gene structure annotation. With this goal in mind, we have developed <font color="blue">BRAKER1</font><a href="https://github.com/Gaius-Augustus/BRAKER#f1">R1</a><a href="https://github.com/Gaius-Augustus/BRAKER#f0">R0</a>, a <strong>combination</strong> of <font color="blue">GeneMark-ET</font> <a href="https://github.com/Gaius-Augustus/BRAKER#f2">R2</a> and <font color="blue">AUGUSTUS</font> <a href="https://github.com/Gaius-Augustus/BRAKER#f3">R3, </a><a href="https://github.com/Gaius-Augustus/BRAKER#f4">R4</a>, that uses genomic and RNA-Seq data to automatically generate full gene structure annotations in novel genome.</p><p>However, the quality of RNA-Seq data that is available for annotating a novel genome is variable, and in some cases, RNA-Seq data is not available, at all.</p><p><font color="blue">BRAKER2 is an extension of BRAKER1</font> which allows for <strong>fully automated training</strong> of the gene prediction tools <font color="blue"><strong>GeneMark</strong>-EX</font> <a href="https://github.com/Gaius-Augustus/BRAKER#f14">R14, </a><a href="https://github.com/Gaius-Augustus/BRAKER#f15">R15, </a><a href="https://github.com/Gaius-Augustus/BRAKER#f17">R17, </a><a href="https://github.com/Gaius-Augustus/BRAKER#g1">F1</a> and <font color="blue"><strong>AUGUSTUS</strong></font> from <strong>RNA-Seq and&#x2F;or protein homology</strong> information, and that integrates the extrinsic evidence from RNA-Seq and protein homology information into the <strong>prediction</strong>.</p><p>In contrast to other available methods that rely on protein homology information, BRAKER2 reaches high gene prediction accuracy even in the absence of the annotation of very closely related species and in the absence of RNA-Seq data.</p><p>In this user guide, we will refer to <font color="blue">BRAKER1 and BRAKER2</font> simply as <strong>BRAKER</strong> because they are <font color="blue">executed by the same script</font> (<code>braker.pl</code>).</p><h1 id="Keys-to-successful-gene-prediction"><a href="#Keys-to-successful-gene-prediction" class="headerlink" title="Keys to successful gene prediction"></a>Keys to successful gene prediction</h1><ul><li>Use a high quality genome assembly. If you have a huge number of very short scaffolds in your genome assembly, those short scaffolds will likely increase runtime dramatically but will not increase prediction accuracy. <strong>ä½¿ç”¨é«˜è´¨é‡ç»„è£…</strong>ã€‚æ—¶é—´ç¼©çŸ­è´¨é‡æé«˜ã€‚</li><li><strong>contigåå­—ç®€çŸ­</strong>ã€‚Use simple scaffold names in the genome file (e.g. <code>&gt;contig1</code> will work better than <code>&gt;contig1my custom species namesome putative function /more/information/  and lots of special characters %&amp;!*()&#123;&#125;</code>). Make the scaffold names in all your fasta files simple before running any alignment program.</li><li>In order to predict genes accurately in a novel genome, the <font color="blue">genome should be <strong>masked</strong> for repeats</font>. This will <strong>avoid the prediction</strong> of false positive gene structures <strong>in repetitive and low complexitiy</strong> regions. Repeat masking is <strong>also essential for mapping RNA</strong>-Seq data to a genome with some tools (other RNA-Seq mappers, such as HISAT2, ignore masking information). In case of GeneMark-EX and AUGUSTUS, <strong>softmasking</strong> (i.e. putting repeat regions into lower case letters and all other regions into upper case letters) leads to <font color="blue"><strong>better results than hardmasking</strong></font> (i.e. replacing letters in repetitive regions by the letter <code>N</code> for unknown nucleotide). If the genome is masked, <font color="blue">use the <strong>â€“softmasking flag</strong> of <strong>braker.pl</strong></font>.</li><li>Many genomes have gene structures that will be predicted accurately with <font color="blue">standard parameters of GeneMark-EX and AUGUSTUS within BRAKER</font>. However, some genomes have clade-specific features, i.e. special branch point model in fungi, or non-standard splice-site patterns. Please read the options section [options] in order to determine whether any of the custom options may improve gene prediction accuracy in the genome of your target species. <strong>å¤§éƒ¨åˆ†genomeä½¿ç”¨é»˜è®¤å‚æ•°ç»“æœä¸é”™ã€‚ä½†ä»éœ€æŸ¥çœ‹æ˜¯å¦æœ‰å‚æ•°å¯ä»¥æé«˜ç‰¹å®šç‰©ç§çš„é¢„æµ‹ã€‚</strong></li><li><font color="blue">Always check gene prediction results before further usage!</font> You can e.g. use a genome browser for visual inspection of gene models in context with extrinsic evidence data. BRAKER supports the generation of track data hubs for the UCSC Genome Browser with MakeHub for this purpose.</li></ul><h1 id="Overview-of-modes-for-running-BRAKER"><a href="#Overview-of-modes-for-running-BRAKER" class="headerlink" title="Overview of modes for running BRAKER"></a>Overview of modes for running BRAKER</h1><p>BRAKER mainly features semi-unsupervised, extrinsic evidence data (RNA-Seq and&#x2F;or protein spliced alignment information) supported <strong>training of GeneMark-EX</strong>[F1] and <strong>subsequent training of AUGUSTUS</strong> with integration of extrinsic evidence in the final gene prediction step. However, there are now a number of additional pipelines included in BRAKER. In the following, we give an overview of <font color="blue">possible input files and pipelines</font>:</p><ul><li><font color="red"><strong>Genome file, only</strong></font>. In this mode, <strong>GeneMark-ES</strong> is <strong>trained</strong> on the genome sequence, <strong>alone</strong>. <strong>Long genes predicted by GeneMark-ES</strong> are <font color="blue"><strong>selected</strong></font> for <strong>training AUGUSTUS</strong>. Final predictions by AUGUSTUS are <em>ab initio</em>. This approach will likely yield lower prediction accuracy than all other here described pipelines. (see Figure <a href="https://github.com/Gaius-Augustus/BRAKER#fig1">2</a>)</li></ul><img src="BRAKER/f2.png" alt="braker2-main-a[fig1]" style="zoom:50%;" /><p>Figure 2: BRAKER pipeline A: training GeneMark-ES on genome data, only; <em>ab initio</em> gene prediction withAUGUSTUS. åªç”¨GeneMark-ESé¢„æµ‹ï¼Œé€‰å–è¾ƒé•¿é¢„æµ‹ç»“æœè®­ç»ƒAUGUSTUS</p><ul><li><font color="red"><strong>Genome</strong> and <strong>RNA-Seq</strong> file from the <strong>same</strong> species</font>; this approach is <strong>suitable for</strong> short read RNA-Seq libraries with a <strong>good coverage</strong> of the transcriptome, <strong>important:</strong> this approach <strong>requires</strong> that each <strong>intron</strong> is <strong>covered by many align</strong>ments, i.e. it does not work with assembled transcriptome mappings. In principle, also alignments of long read RNA-Seq data may lead to sufficient data for running BRAKER, but <strong>only if each transcript that will go into training was sequenced and aligned to the genome multiple times.</strong> Please be aware that at the current point in time, BRAKER <font color="blue">does <strong>not officially support</strong> the integration of <strong>long read RNA-Seq</strong></font> data, yet.</li></ul><img src="BRAKER/f3.png" alt="braker2-main-a[fig1]" style="zoom:50%;" /><p>Figure 3: BRAKER pipeline B: training GeneMark-ET supported by RNA-Seq spliced alignment information, prediction with AUGUSTUS with that same spliced alignment information.</p><ul><li><font color="red"><strong>Genome</strong> file and database of <strong>proteins</strong> that may be of <strong>unknown</strong> evolutionary distance to the target species</font> (see Figure <a href="https://github.com/Gaius-Augustus/BRAKER#fig3">4</a>); this approach is particularly suitable if no RNA-Seq data is available. This method will work better with proteins from species that are rather close to the target species, but <strong>accuracy will drop only very little if the reference proteins are more distant from the target species</strong>. <strong>Important:</strong> This approach requires a database of protein families, i.e. many representatives of each protein family must be present in the database. BRAKER has been tested with OrthoDB <a href="https://github.com/Gaius-Augustus/BRAKER#f19">R19</a>, successfully. <font color="red">The ProtHint <a href="https://github.com/Gaius-Augustus/BRAKER#f18">R18</a> <strong>protein mapping pipeline</strong></font> for generating required hints for BRAKER is available for <strong>download</strong> at <a href="https://github.com/gatech-genemark/ProtHint">https://github.com/gatech-genemark/ProtHint</a>, the instructions on <font color="red"><strong>how to prepare</strong> the OrthoDB input proteins</font> are documented at <a href="https://github.com/gatech-genemark/ProtHint#protein-database-preparation">https://github.com/gatech-genemark/ProtHint#protein-database-preparation</a>. You may add proteins of a closely related species to the OrthoDB fasta file in order to incorporate additional evidence into gene prediction.</li></ul><img src="BRAKER/f4.png" alt="braker2-main-a[fig1]" style="zoom:50%;" /><p>Figure 4: <font color="red"><strong>BRAKER pipeline C</strong>: <strong>training GeneMark-EP+</strong> on <strong>protein spliced alignment</strong>, <strong>start and stop information</strong>, prediction with <strong>AUGUSTUS</strong> with that <strong>same information</strong>, in addition <strong>chained CDSpart hints</strong>. Proteins used here can be of any evolutionary distance to the target organism.</font></p><ul><li><font color="red"><strong>Genome</strong> and <strong>RNA</strong>-Seq file from the same species, and <strong>proteins</strong> that may be of <strong>unknown</strong> evolutionary distance to the target species</font> (see figure <a href="https://github.com/Gaius-Augustus/BRAKER#fig4">5</a>); <strong>important:</strong> this approach requires a database of protein families, i.e. many representatives of each protein family must be present in the database, e.g. OrthoDB is suitable. (You may add proteins of a closely related species to the OrthoDB fasta file in order to incorporate additional evidence into gene prediction.)</li></ul><img src="BRAKER/f5.png" alt="braker2-main-a[fig1]" style="zoom:50%;" /><p>Figure 5: <font color="red"><strong>BRAKER pipeline D</strong>: <strong>training</strong> <strong>GeneMark-ETP+</strong> supported by <strong>RNA</strong>-Seq alignment information and information from <strong>proteins</strong></font> (proteins can be of any evolutionary distance). Please be aware that GeneMark-ETP+ is still under development, BRAKER can currently execute a precursor of the mature version. Introns supported by both RNA-Seq and protein alignment information are treated as â€œtrue positive intronsâ€, their prediction in gene structures by GeneMark-ETP+ and AUGUSTUS is enforced. <strong>Important:</strong> It is not always best to use all evidence! So far, <font color="blue">we found this approach to work well for <strong>large genomes</strong>, but accuracy on <strong>small and medium sized genomes</strong> is <strong>unstable</strong></font>. Please have a look at the poster from PAG 2020 before running this pipeline.</p><ul><li><font color="red"><strong>Genome</strong> file and file with <strong>proteins</strong> of <strong>short evolutionary distance</strong></font> (see Figure <a href="https://github.com/Gaius-Augustus/BRAKER#fig5">6</a>); this approach is suitable if RNA-Seq data is not available and if the reference species is very closely related. <em>Note:</em> This pipeline is deprecated since pipeline C can also use proteins of closely related species in addition to OrthoDB.</li></ul><img src="BRAKER/f6.png" alt="braker2-main-a[fig1]" style="zoom:50%;" /><p>Figure 6: Additional pipeline B: training AUGUSTUS on the basis of spliced alignment information from <font color="red">proteins of a very closely related species</font> against the target genome.</p><ul><li><font color="red"><strong>Genome</strong> and <strong>RNA</strong>-Seq file and <strong>proteins</strong> of <strong>short evolutionary distance</strong></font> (see Figures <a href="https://github.com/Gaius-Augustus/BRAKER#fig6">6</a> and <a href="https://github.com/Gaius-Augustus/BRAKER#fig7">7</a>). In both cases, GeneMark-ET is trained supported by RNA-Seq data, and the resulting gene predictions are used for training AUGUSTUS. In approach A), protein alignment information is used in the gene prediction step with AUGUSTUS, only. In approach C), protein spliced alignment data is used to complement the training set for AUGUSTUS. The latter approach is in particular suitable if RNA-Seq data does not produce a sufficiently high number of training gene structures for AUGUSTUS, and if a very closely related and already annotated species is available. <em>Note:</em> This pipeline is deprecated since pipeline D can also use proteins of closely related species in addition to OrthoDB.</li></ul><img src="BRAKER/f7.png" alt="braker2-main-a[fig1]" style="zoom:50%;" /><p>Figure 7: Additional pipeline A: training GeneMark-ET supported by RNA-Seq spliced alignment information, prediction with AUGUSTUS with spliced alignment information from RNA-Seq data and with gene features determined by alignments from proteins of a very closely related species against the target genome. <em>Note:</em> This pipeline is deprecated since pipeline C can also use proteins of closely related species in addition to OrthoDB.</p><img src="BRAKER/f8.png" alt="braker2-main-a[fig1]" style="zoom:50%;" /><p>Figure 8: Additional pipeline C: training GeneMark-ET on the basis of RNA-Seq spliced alignment information, training AUGUSTUS on a set of training gene structures compiled from RNA-Seq supported gene structures predicted by GeneMark-ET and spliced alignment of proteins of a very closely related species. <em>Note:</em> This pipeline is deprecated since pipeline D can also use proteins of closely related species in addition to OrthoDB.</p><h1 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h1><h2 id="Supported-software-versions"><a href="#Supported-software-versions" class="headerlink" title="Supported software versions"></a>Supported software versions</h2><p>At the time of release, this BRAKER version was tested with:</p><ul><li>AUGUSTUS 3.4.0 <a href="https://github.com/Gaius-Augustus/BRAKER#g2">F2</a></li><li>GeneMark-ES&#x2F;ET&#x2F;EP 4.64_lic</li><li>BAMTOOLS 2.5.1<a href="https://github.com/Gaius-Augustus/BRAKER#f5">R5</a></li><li>SAMTOOLS 1.7-4-g93586ed<a href="https://github.com/Gaius-Augustus/BRAKER#f6">R6</a></li><li>ProtHint 2.6.0</li><li>GenomeThreader 1.7.0<a href="https://github.com/Gaius-Augustus/BRAKER#f7">R7</a></li><li>Spaln 2.3.3d <a href="https://github.com/Gaius-Augustus/BRAKER#f8">R8, </a><a href="https://github.com/Gaius-Augustus/BRAKER#f9">R9, </a><a href="https://github.com/Gaius-Augustus/BRAKER#f10">R10, </a><a href="https://github.com/Gaius-Augustus/BRAKER#g3">F3</a></li><li>(Exonerate 2.2.0 <a href="https://github.com/Gaius-Augustus/BRAKER#f11">R11</a>)[F3]</li><li>NCBI BLAST+ 2.2.31+ <a href="https://github.com/Gaius-Augustus/BRAKER#f12">R12, </a><a href="https://github.com/Gaius-Augustus/BRAKER#f13">R13</a></li><li>DIAMOND 0.9.24</li><li>cdbfasta 0.99</li><li>cdbyank 0.981</li><li>GUSHR 1.0.0</li></ul><h2 id="BRAKER"><a href="#BRAKER" class="headerlink" title="BRAKER"></a>BRAKER</h2><h3 id="Perl-pipeline-dependencies"><a href="#Perl-pipeline-dependencies" class="headerlink" title="Perl pipeline dependencies"></a>Perl pipeline dependencies</h3><p>Running BRAKER requires a Linux-system with <code>bash</code> and Perl. Furthermore, BRAKER requires the following CPAN-Perl modules to be installed:</p><ul><li><code>File::Spec::Functions</code></li><li><code>Hash::Merge</code></li><li><code>List::Util</code></li><li><code>MCE::Mutex</code></li><li><code>Module::Load::Conditional</code></li><li><code>Parallel::ForkManager</code></li><li><code>POSIX</code></li><li><code>Scalar::Util::Numeric</code></li><li><code>YAML</code></li><li><code>Math::Utils</code></li><li><code>File::HomeDir</code></li></ul><p>For ProtHint, used when protein input is supplied, also install:</p><ul><li><code>threads</code></li></ul><p>On Ubuntu, for example, install the modules with CPANminus<a href="https://github.com/Gaius-Augustus/BRAKER#g4">F4</a>: <code>sudo cpanm Module::Name</code>, e.g. <code>sudo cpanm Hash::Merge</code>.</p><p>BRAKER also uses a Perl module <code>helpMod.pm</code> that is not available on CPAN. This module is part of the BRAKER release and does not require separate installation.</p><p>If you do not have root permissions on the Linux machine, try setting up an <strong>Anaconda</strong> (<a href="https://www.anaconda.com/distribution/">https://www.anaconda.com/distribution/</a>) environment as follows:</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cmake">wget https://repo.anaconda.com/archive/Anaconda3-<span class="hljs-number">2018.12</span>-Linux-x86_64.sh<br>bash bin/Anaconda3-<span class="hljs-number">2018.12</span>-Linux-x86_64.sh <span class="hljs-comment"># do not install VS (needs root privileges)</span><br>conda <span class="hljs-keyword">install</span> -c anaconda perl<br>conda <span class="hljs-keyword">install</span> -c bioconda perl-app-cpanminus<br>conda <span class="hljs-keyword">install</span> -c bioconda perl-hash-merge<br>conda <span class="hljs-keyword">install</span> -c bioconda perl-parallel-forkmanager<br>conda <span class="hljs-keyword">install</span> -c bioconda perl-scalar-util-numeric<br>conda <span class="hljs-keyword">install</span> -c bioconda perl-yaml<br>conda <span class="hljs-keyword">install</span> -c bioconda perl-class-data-inheritable<br>conda <span class="hljs-keyword">install</span> -c bioconda perl-exception-class<br>conda <span class="hljs-keyword">install</span> -c bioconda perl-<span class="hljs-keyword">test</span>-pod<br>conda <span class="hljs-keyword">install</span> -c anaconda biopython<br>conda <span class="hljs-keyword">install</span> -c bioconda perl-<span class="hljs-keyword">file</span>-which <span class="hljs-comment"># skip if you are not comparing to reference annotation</span><br>conda <span class="hljs-keyword">install</span> -c bioconda perl-mce<br>conda <span class="hljs-keyword">install</span> -c bioconda perl-threaded<br>conda <span class="hljs-keyword">install</span> -c bioconda perl-<span class="hljs-keyword">list</span>-util<br>conda <span class="hljs-keyword">install</span> -c bioconda perl-<span class="hljs-keyword">math</span>-utils<br>conda <span class="hljs-keyword">install</span> -c bioconda cdbtools<br></code></pre></td></tr></table></figure><p>Subsequently install BRAKER and other software â€œas usualâ€ while being in your conda environment. <strong>Note:</strong> <strong>There is a bioconda braker package, and a bioconda augustus package</strong>. They work. But <strong>they are usually lagging behind the development code of both tools on github</strong>. We therefore recommend manual installation and usage of lastest sources.</p><h3 id="BRAKER-components"><a href="#BRAKER-components" class="headerlink" title="BRAKER components"></a>BRAKER components</h3><p>BRAKER is a collection of Perl and Python scripts and a Perl module. The main script that will be called in order to run BRAKER is <code>braker.pl</code>. Additional Perl and Python components are:</p><ul><li><code>align2hints.pl</code></li><li><code>filterGenemark.pl</code></li><li><code>filterIntronsFindStrand.pl</code></li><li><code>startAlign.pl</code></li><li><code>helpMod.pm</code></li><li><code>findGenesInIntrons.pl</code></li><li><code>downsample_traingenes.pl</code></li><li><code>ensure_n_training_genes.py</code></li></ul><p>All scripts (files ending with <code>*.pl</code> and <code>*.py</code>) that are part of BRAKER must be executable in order to run BRAKER. This should already be the case if you download BRAKER from GitHub. Executability may be overwritten if you e.g. transfer BRAKER on a USB-stick to another computer. In order to check whether required files are executable, run the following command in the directory that contains BRAKER Perl scripts:</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">ls</span> -l *<span class="hljs-string">.pl</span> *<span class="hljs-string">.py</span><br></code></pre></td></tr></table></figure><p>The output should be similar to this:</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs tap">-rwxr-xr-x<span class="hljs-number"> 1 </span>katharina katharina <span class="hljs-number"> 18191 </span>Mai <span class="hljs-number"> 7 </span>10:25 align2hints.pl<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>katharina katharina  <span class="hljs-number"> 6090 </span>Feb<span class="hljs-number"> 19 </span>09:35 braker_cleanup.pl<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>katharina katharina<span class="hljs-number"> 408782 </span>Aug<span class="hljs-number"> 17 </span>18:24 braker.pl<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>katharina katharina  <span class="hljs-number"> 5024 </span>Mai <span class="hljs-number"> 7 </span>10:25 downsample_traingenes.pl<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>katharina katharina  <span class="hljs-number"> 5024 </span>Mai <span class="hljs-number"> 7 </span>10:23 ensure_n_training_genes.py<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>katharina katharina  <span class="hljs-number"> 4542 </span>Apr <span class="hljs-number"> 3 </span><span class="hljs-number"> 2019 </span>filter_augustus_gff.pl<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>katharina katharina <span class="hljs-number"> 30453 </span>Mai <span class="hljs-number"> 7 </span>10:25 filterGenemark.pl<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>katharina katharina  <span class="hljs-number"> 5754 </span>Mai <span class="hljs-number"> 7 </span>10:25 filterIntronsFindStrand.pl<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>katharina katharina  <span class="hljs-number"> 7765 </span>Mai <span class="hljs-number"> 7 </span>10:25 findGenesInIntrons.pl<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>katharina katharina  <span class="hljs-number"> 1664 </span>Feb<span class="hljs-number"> 12 </span><span class="hljs-number"> 2019 </span>gatech_pmp2hints.pl<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>katharina katharina  <span class="hljs-number"> 2250 </span>Jan <span class="hljs-number"> 9 </span>13:55 log_reg_prothints.pl<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>katharina katharina  <span class="hljs-number"> 4679 </span>Jan <span class="hljs-number"> 9 </span>13:55 merge_transcript_sets.pl<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>katharina katharina <span class="hljs-number"> 41674 </span>Mai <span class="hljs-number"> 7 </span>10:25 startAlign.pl<br></code></pre></td></tr></table></figure><p>It is important that the <code>x</code> in <code>-rwxr-xr-x</code> is present for each script. If that is not the case, run</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">`chmod a+x *<span class="hljs-string">.pl</span> *<span class="hljs-string">.py</span>`<br></code></pre></td></tr></table></figure><p>in order to change file attributes.</p><p>You may find it helpful to add the directory in which BRAKER perl scripts reside to your <code>$PATH</code> environment variable. For a single bash session, enter:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">PATH</span>=/your_path_to_braker/:$PATH<br><span class="hljs-built_in">export</span> PATH<br></code></pre></td></tr></table></figure><p>To make this <code>$PATH</code> modification available to all bash sessions, add the above lines to a startup script (e.g.<code>~/.bashrc</code>).</p><h2 id="Bioinformatics-software-dependencies"><a href="#Bioinformatics-software-dependencies" class="headerlink" title="Bioinformatics software dependencies"></a>Bioinformatics software dependencies</h2><p>BRAKER calls upon various bioinformatics software tools that are not part of BRAKER. Some tools are obligatory, i.e. BRAKER will not run at all if these tools are not present on your system. Other tools are optional. Please install all tools that are required for running BRAKER in the mode of your choice.</p><h3 id="Mandatory-tools"><a href="#Mandatory-tools" class="headerlink" title="Mandatory tools"></a>Mandatory tools</h3><h4 id="GeneMark-EX"><a href="#GeneMark-EX" class="headerlink" title="GeneMark-EX"></a>GeneMark-EX</h4><p>Download GeneMark-EX<a href="https://github.com/Gaius-Augustus/BRAKER#g1">F1</a> from <a href="http://exon.gatech.edu/GeneMark/license_download.cgi">http://exon.gatech.edu/GeneMark/license_download.cgi</a> (the GeneMark-ES&#x2F;ET&#x2F;EP) option. Unpack and install GeneMark-EX as described in GeneMark-EXâ€™s <code>README</code> file.</p><p>If already contained in your <code>$PATH</code> variable, BRAKER will guess the location of <code>gmes_petap.pl</code>, automatically. Otherwise, BRAKER can find GeneMark-EX executables either by locating them in an environment variable <code>GENEMARK_PATH</code>, or by taking a command line argument (<code>--GENEMARK_PATH=/your_path_to_GeneMark-EX/</code>).</p><p>In order to set the environment variable for your current Bash session, type:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">GENEMARK_PATH</span>=/your_path_to_GeneMark-EX/<br></code></pre></td></tr></table></figure><p>Add the above lines to a startup script (e.g. <code>~/.bashrc</code>) in order to make it available to all bash sessions.<a href="https://github.com/Gaius-Augustus/BRAKER#g5">F5</a></p><p><strong>Important:</strong> GeneMark-EX will only run if a valid key file resides in your home directory. The key file will expire after 200 days, which means that you have to download a new GeneMark-EX release and a new key file after 200 days. The key file is downloaded as <code>gm_key.gz</code>. Unpack the key file and move it to a hidden file <strong>in your home directory</strong> as follows:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> <span class="hljs-comment"># change to your home directory</span><br>gunzip gm_key_64.gz<br><span class="hljs-built_in">mv</span> gm_key_64 .gm_key<br></code></pre></td></tr></table></figure><p>Perl scripts within GeneMark-EX are configured with default Perl location at <code>/usr/bin/perl</code>.</p><p>If you are running GeneMark-EX in an Anaconda environment (or want to use Perl from the <code>$PATH</code> variable for any other reason), modify the shebang of all GeneMark-EX scripts with the following command located inside GeneMark-EX folder:</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">perl</span> change_path_in_perl_scripts.pl <span class="hljs-string">&quot;/usr/bin/env perl&quot;</span><br></code></pre></td></tr></table></figure><p>You can check whether GeneMark-EX is installed properly by running the <code>check_install.bash</code> and&#x2F;or executing examples in <code>GeneMark-E-tests</code> directory.</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">my<br>./gmes_linux_64/check_install.bash<br>Checking GeneMark-ES installation<br>Checking Perl setup<br><span class="hljs-keyword">All</span> required Perl modules were <span class="hljs-built_in">found</span><br>Checking GeneMark.hmm setup<br>GeneMark.hmm was <span class="hljs-built_in">found</span><br>GeneMark.hmm <span class="hljs-keyword">is</span> <span class="hljs-keyword">set</span><br>GeneMark.hmm <span class="hljs-keyword">is</span> executable<br>Performing GeneMark.hmm test run<br><span class="hljs-keyword">All</span> required components <span class="hljs-keyword">for</span> GeneMark-ES were <span class="hljs-built_in">found</span><br></code></pre></td></tr></table></figure><h4 id="AUGUSTUS"><a href="#AUGUSTUS" class="headerlink" title="AUGUSTUS"></a>AUGUSTUS</h4><p>Download AUGUSTUS from its master branch at <a href="https://github.com/Gaius-Augustus/Augustus">https://github.com/Gaius-Augustus/Augustus</a>. Unpack AUGUSTUS and install AUGUSTUS according to AUGUSTUS <code>README.TXT</code>. <em><strong>Do not use outdated AUGUSTUS versions from other sources, e.g. Debian package or Bioconda package! BRAKER highly depends in particular on an up-to-date Augustus&#x2F;scripts directory, and other sources are often lagging behind.</strong></em></p><p>You should compile AUGUSTUS on your own system in order to avoid problems with versions of libraries used by AUGUSTUS. Compilation instructions are provided in the AUGUSTUS <code>README.TXT</code> file (<code>Augustus/README.txt</code>).</p><p>AUGUSTUS consists of <code>augustus</code>, the gene prediction tool, additional C++ tools located in <code>Augustus/auxprogs</code> and Perl scripts located in <code>Augustus/scripts</code>. Perl scripts must be executable (see instructions in section <a href="https://github.com/Gaius-Augustus/BRAKER#executability">BRAKER components</a>.</p><p>The C++ tool <code>bam2hints</code> is an essential component of BRAKER when run with RNA-Seq. Sources are located in <code>Augustus/auxprogs/bam2hints</code>. Make sure that you compile <code>bam2hints</code> on your system (it should be automatically compiled when AUGUSTUS is compiled, but in case of problems with <code>bam2hints</code>, please read troubleshooting instructions in <code>Augustus/auxprogs/bam2hints/README</code>).</p><p>Since BRAKER is a pipeline that trains AUGUSTUS, i.e. writes species specific parameter files, BRAKER needs writing access to the configuration directory of AUGUSTUS that contains such files (<code>Augustus/config/</code>). If you install AUGUSTUS globally on your system, the <code>config</code> folder will typically not be writable by all users. Either make the directory where <code>config</code> resides recursively writable to users of AUGUSTUS, or copy the <code>config/</code> folder (recursively) to a location where users have writing permission.</p><p>AUGUSTUS will locate the <code>config</code> folder by looking for an environment variable <code>$AUGUSTUS_CONFIG_PATH</code>. If the <code>$AUGUSTUS_CONFIG_PATH</code> environment variable is not set, then BRAKER will look in the path <code>../config</code> relative to the directory in which it finds an AUGUSTUS executable. Alternatively, you can supply the variable as a command line argument to BRAKER (<code>--AUGUSTUS_CONFIG_PATH=/your_path_to_AUGUSTUS/Augustus/config/</code>). We recommend that you export the variable e.g. for your current bash session:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">export AUGUSTUS_CONFIG_PATH=<span class="hljs-regexp">/your_path_to_AUGUSTUS/</span>Augustus<span class="hljs-regexp">/config/</span><br></code></pre></td></tr></table></figure><p>In order to make the variable available to all Bash sessions, add the above line to a startup script, e.g. <code>~/.bashrc</code>.</p><h5 id="Important"><a href="#Important" class="headerlink" title="Important:"></a>Important:</h5><p>BRAKER expects the entire <code>config</code> directory of AUGUSTUS at <code>$AUGUSTUS_CONFIG_PATH</code>, i.e. the subfolders <code>species</code> with its contents (at least <code>generic</code>) and <code>extrinsic</code>! Providing a writable but empty folder at <code>$AUGUSTUS_CONFIG_PATH</code> will not work for BRAKER. If you need to separate augustus binary and <code>$AUGUSTUS_CONFIG_PATH</code>, we recommend that you recursively copy the un-writable config contents to a writable location.</p><p>If you have a system-wide installation of AUGUSTUS at <code>/usr/bin/augustus</code>, an unwritable copy of <code>config</code> sits at <code>/usr/bin/augustus_config/</code>. The folder <code>/home/yours/</code> is writable to you. Copy with the following command (and additionally set the then required variables):</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">cp -r <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/Augustus/</span>config<span class="hljs-regexp">/ /</span>home<span class="hljs-regexp">/yours/</span><br>export AUGUSTUS_CONFIG_PATH=<span class="hljs-regexp">/home/y</span>ours/augustus_config<br>export AUGUSTUS_BIN_PATH=<span class="hljs-regexp">/usr/</span>bin<br>export AUGUSTUS_SCRIPTS_PATH=<span class="hljs-regexp">/usr/</span>bin/augustus_scripts<br></code></pre></td></tr></table></figure><h5 id="Modification-of-PATH"><a href="#Modification-of-PATH" class="headerlink" title="Modification of $PATH"></a>Modification of $PATH</h5><p>Adding directories of AUGUSTUS binaries and scripts to your <code>$PATH</code> variable enables your system to locate these tools, automatically. It is not a requirement for running BRAKER to do this, because BRAKER will try to guess them from the location of another environment variable (<code>$AUGUSTUS_CONFIG_PATH</code>), or both directories can be supplied as command line arguments to <code>braker.pl</code>, but we recommend to add them to your <code>$PATH</code> variable. For your current bash session, type:</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-title class_">PATH</span>=<span class="hljs-symbol">:/your_path_to_augustus/bin/</span><span class="hljs-symbol">:/your_path_to_augustus/scripts/</span><span class="hljs-symbol">:</span><span class="hljs-variable">$PATH</span><br>export <span class="hljs-title class_">PATH</span><br></code></pre></td></tr></table></figure><p>For all your BASH sessions, add the above lines to a startup script (e.g.<code>~/.bashrc</code>).</p><h4 id="Python3"><a href="#Python3" class="headerlink" title="Python3"></a>Python3</h4><p>On Ubuntu, Python3 is usually installed by default, <code>python3</code> will be in your <code>$PATH</code> variable, by default, and BRAKER will automatically locate it. However, you have the option to specify the <code>python3</code> binary location in two other ways:</p><ol><li><p>Export an environment variable <code>$PYTHON3_PATH</code>, e.g. in your <code>~/.bashrc</code> file:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">export PYTHON3_PATH=<span class="hljs-regexp">/path/</span>to<span class="hljs-regexp">/python3/</span><br></code></pre></td></tr></table></figure></li><li><p>Specify the command line option <code>--PYTHON3_PATH=/path/to/python3/</code> to <code>braker.pl</code>.</p></li></ol><h4 id="Bamtools"><a href="#Bamtools" class="headerlink" title="Bamtools"></a>Bamtools</h4><p>Download BAMTOOLS (e.g. <code>git clone https://github.com/pezmaster31/bamtools.git</code>). Install BAMTOOLS by typing the following in your shell:</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">cd</span> your-bamtools-directory <span class="hljs-built_in">mkdir</span> build <span class="hljs-keyword">cd</span> build cmake .. <span class="hljs-keyword">make</span><br></code></pre></td></tr></table></figure><p>If already in your <code>$PATH</code> variable, BRAKER will find bamtools, automatically. Otherwise, BRAKER can locate the bamtools binary either by using an environment variable <code>$BAMTOOLS_PATH</code>, or by taking a command line argument (<code>--BAMTOOLS_PATH=/your_path_to_bamtools/bin/</code><a href="https://github.com/Gaius-Augustus/BRAKER#g6">F6</a>). In order to set the environment variable e.g. for your current bash session, type:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">BAMTOOLS_PATH</span>=/your_path_to_bamtools/bin/<br></code></pre></td></tr></table></figure><p>Add the above line to a startup script (e.g. <code>~/.bashrc</code>) in order to set the environment variable for all bash sessions.</p><h4 id="NCBI-BLAST-or-DIAMOND"><a href="#NCBI-BLAST-or-DIAMOND" class="headerlink" title="NCBI BLAST+ or DIAMOND"></a>NCBI BLAST+ or DIAMOND</h4><p>You can use either NCBI BLAST+ or DIAMOND for removal of redundant training genes. You do not need both tools. If DIAMOND is present, it will be preferred because it is much faster.</p><p>Obtain and unpack DIAMOND as follows:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">wget http:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/bbuchfink/</span>diamond<span class="hljs-regexp">/releases/</span>download<span class="hljs-regexp">/v0.9.24/</span>diamond-linux64.tar.gz<br>tar xzf diamond-linux64.tar.gz<br></code></pre></td></tr></table></figure><p>If already in your <code>$PATH</code> variable, BRAKER will find diamond, automatically. Otherwise, BRAKER can locate the diamond binary either by using an environment variable <code>$DIAMOND_PATH</code>, or by taking a command line argument (<code>--DIAMOND_PATH=/your_path_to_diamond</code>). In order to set the environment variable e.g. for your current bash session, type:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">DIAMOND_PATH</span>=/your_path_to_diamond/<br></code></pre></td></tr></table></figure><p>Add the above line to a startup script (e.g. <code>~/.bashrc</code>) in order to set the environment variable for all bash sessions.</p><p>If you decide for BLAST+, install NCBI BLAST+ with <code>sudo apt-get install ncbi-blast+</code>.</p><p>If already in your <code>$PATH</code> variable, BRAKER will find blastp, automatically. Otherwise, BRAKER can locate the blastp binary either by using an environment variable <code>$BLAST_PATH</code>, or by taking a command line argument (<code>--BLAST_PATH=/your_path_to_blast/</code>). In order to set the environment variable e.g. for your current bash session, type:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">BLAST_PATH</span>=/your_path_to_blast/<br></code></pre></td></tr></table></figure><p>Add the above line to a startup script (e.g. <code>~/.bashrc</code>) in order to set the environment variable for all bash sessions.</p><h4 id="ProtHint"><a href="#ProtHint" class="headerlink" title="ProtHint"></a>ProtHint</h4><p>ProtHint is a pipeline for generating hints for GeneMark-EX and AUGUSTUS from proteins of any evolutionary distance. If protein sequences are given on input, BRAKER runs ProtHint automatically. Alternatively, ProtHint can be executed as a separate step during data preparation. ProtHint is available from <a href="https://github.com/gatech-genemark/ProtHint">https://github.com/gatech-genemark/ProtHint</a>. Download as follows:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/gatech-genemark/</span>ProtHint.git<br></code></pre></td></tr></table></figure><p>or by getting the latest release from <a href="https://github.com/gatech-genemark/ProtHint/releases">https://github.com/gatech-genemark/ProtHint/releases</a>.</p><p>ProtHint has software requirements of its own. In addition to the Perl modules required by BRAKER, it needs</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">threads</span><br></code></pre></td></tr></table></figure><p>You can easily verify ProtHintâ€™s installation by running the test in <a href="https://github.com/gatech-genemark/ProtHint/tree/master/example">https://github.com/gatech-genemark/ProtHint/tree/master/example</a>.</p><p>ProtHint requires DIAMOND and Spaln, both of which come with ProtHintâ€™s installation. ProtHintâ€™s requirement of GeneMark-ES will already be fulfilled if you installed BRAKER dependencies above. For further installation instructions, please check <a href="https://github.com/gatech-genemark/ProtHint">https://github.com/gatech-genemark/ProtHint</a>.</p><p>If already in your <code>$PATH</code> variable, BRAKER will find prothint.py, automatically. Otherwise, BRAKER will try to locate the prothint.py executable by using an environment variable <code>$PROTHINT_PATH</code>. Alternatively, this can be supplied as a command line argument <code>--PROTHINT_PATH=/your/path/to/ProtHint/bin</code>.</p><h3 id="Optional-tools"><a href="#Optional-tools" class="headerlink" title="Optional tools"></a>Optional tools</h3><h4 id="Samtools"><a href="#Samtools" class="headerlink" title="Samtools"></a>Samtools</h4><p>Samtools is not required for running BRAKER if all your files are formatted, correctly (i.e. all sequences should have short and unique fasta names). If you are not sure whether all your files are fomatted correctly, it might be helpful to have Samtools installed because BRAKER can automatically fix certain format issues by using Samtools.</p><p>As a prerequisite for Samtools, download and install <code>htslib</code> (e.g. <code>git clone https://github.com/samtools/htslib.git</code>, follow the <code>htslib</code> documentation for installation).</p><p>Download and install Samtools (e.g. <code>git clone git://github.com/samtools/samtools.git</code>), subsequently follow Samtools documentation for installation).</p><p>If already in your <code>$PATH</code> variable, BRAKER will find samtools, automatically. Otherwise, BRAKER can find Samtools either by taking a command line argument (<code>--SAMTOOLS_PATH=/your_path_to_samtools/</code>), or by using an environment variable <code>$SAMTOOLS_PATH</code>. For exporting the variable, e.g. for your current bash session, type:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">SAMTOOLS_PATH</span>=/your_path_to_samtools/<br></code></pre></td></tr></table></figure><p>Add the above line to a startup script (e.g. <code>~/.bashrc</code>) in order to set the environment variable for all bash sessions.</p><h4 id="Biopython"><a href="#Biopython" class="headerlink" title="Biopython"></a>Biopython</h4><p>If Biopython is installed, BRAKER can generate FASTA-files with coding sequences and protein sequences predicted by AUGUSTUS and generate track data hubs for visualization of a BRAKER run with MakeHub <a href="https://github.com/Gaius-Augustus/BRAKER#f16">R16</a>. These are optional steps. The first can be disabled with the command-line flag <code>--skipGetAnnoFromFasta</code>, the second can be activated by using the command-line options <code>--makehub --email=your@mail.de</code>, Biopython is not required if neither of these optional steps shall be performed.</p><p>On Ubuntu, install Python3 package manager with:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">`sudo apt-<span class="hljs-built_in">get</span> install python3-pip`<br></code></pre></td></tr></table></figure><p>Then, install Biopython with:</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-string">`sudo pip3 install biopython`</span><br></code></pre></td></tr></table></figure><h4 id="cdbfasta"><a href="#cdbfasta" class="headerlink" title="cdbfasta"></a>cdbfasta</h4><p>cdbfasta and cdbyank are required by BRAKER for correcting AUGUSTUS genes with in frame stop codons (spliced stop codons) using the AUGUSTUS script fix_in_frame_stop_codon_genes.py. This can be skipped with <code>--skip_fixing_broken_genes</code>.</p><p>On Ubuntu, install cdbfasta with:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">`sudo apt-<span class="hljs-built_in">get</span> install cdbfasta`<br></code></pre></td></tr></table></figure><p>For other systems, you can for example obtain cdbfasta from <a href="https://github.com/gpertea/cdbfasta">https://github.com/gpertea/cdbfasta</a>, e.g.:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/gpertea/</span>cdbfasta.git`<br>cd cdbfasta<br>make all<br></code></pre></td></tr></table></figure><p>On Ubuntu, cdbfasta and cdbyank will be in your <code>$PATH</code> variable after installation, and BRAKER will automatically locate them. However, you have the option to specify the <code>cdbfasta</code> and <code>cdbyank</code> binary location in two other ways:</p><ol><li>Export an environment variable <code>$CDBTOOLS_PATH</code>, e.g. in your <code>~/.bashrc</code> file:</li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">export CDBTOOLS_PATH=<span class="hljs-regexp">/path/</span>to<span class="hljs-regexp">/cdbtools/</span><br></code></pre></td></tr></table></figure><ol><li>Specify the command line option <code>--CDBTOOLS_PATH=/path/to/cdbtools/</code> to <code>braker.pl</code>.</li></ol><h4 id="GenomeThreader"><a href="#GenomeThreader" class="headerlink" title="GenomeThreader"></a>GenomeThreader</h4><p><strong>Note:</strong> Support of GenomeThreader within BRAKER is deprecated.</p><p>This tool is required, only, if you would like to run protein to genome alignments with BRAKER using GenomeThreader. This is a suitable approach only if an annotated species of short evolutionary distance to your target genome is available. Download GenomeThreader from <a href="http://genomethreader.org/">http://genomethreader.org/</a>. Unpack and install according to <code>gth/README</code>.</p><p>BRAKER will try to locate the GenomeThreader executable by using an environment variable <code>$ALIGNMENT_TOOL_PATH</code>. Alternatively, this can be supplied as command line argument (<code>--ALIGNMENT_TOOL_PATH=/your/path/to/gth</code>).</p><h4 id="Spaln"><a href="#Spaln" class="headerlink" title="Spaln"></a>Spaln</h4><p><strong>Note:</strong> Support of stand-alone Spaln (ouside of ProtHint) within BRAKER is deprecated.</p><p>This tool is required if you run ProtHint or if you would like to run protein to genome alignments with BRAKER using Spaln outside of ProtHint. Using Spaln outside of ProtHint is a suitable approach only if an annotated species of short evolutionary distance to your target genome is available. We recommend running Spaln through ProtHint for BRAKER. ProtHint brings along a Spaln binary. If that does not work on your system, download Spaln from <a href="https://github.com/ogotoh/spaln">https://github.com/ogotoh/spaln</a>. Unpack and install according to <code>spaln/doc/SpalnReadMe22.pdf</code>.</p><p>BRAKER will try to locate the Spaln executable by using an environment variable <code>$ALIGNMENT_TOOL_PATH</code>. Alternatively, this can be supplied as command line argument (<code>--ALIGNMENT_TOOL_PATH=/your/path/to/spaln</code>).</p><h4 id="Exonerate"><a href="#Exonerate" class="headerlink" title="Exonerate"></a>Exonerate</h4><p><strong>Note:</strong> Support of Exonerate within BRAKER is deprecated.</p><p>This tool is required, only, if you would like to run protein to genome alignments with BRAKER using Exonerate. This is a suitable approach only if an annotated species of short evolutionary distance to your target genome is available. (We recommend the usage of GenomeThreader instad of Exonerate because Exonerate is comparably slower and has lower specificity than GenomeThreader.) Download Exonerate from <a href="https://github.com/nathanweeks/exonerate">https://github.com/nathanweeks/exonerate</a>. Unpack and install according to <code>exonerate/README</code>. (On Ubuntu, download and install by typing <code>sudo apt-get install exonerate</code>.)</p><p>BRAKER will try to locate the Exonerate executable by using an environment variable <code>$ALIGNMENT_TOOL_PATH</code>. Alternatively, this can be supplied as command line argument (<code>--ALIGNMENT_TOOL_PATH=/your/path/to/exonerate</code>).</p><h4 id="GUSHR"><a href="#GUSHR" class="headerlink" title="GUSHR"></a><font color="red">GUSHR</font></h4><p>This tool is only required if you want either add UTRs (from RNA-Seq data) to predicted genes or if you want to train UTR parameters for AUGUSTUS and predict genes with UTRs. In any case, GUSHR requires the input of RNA-Seq data.</p><p>GUSHR is available for download at <a href="https://github.com/Gaius-Augustus/GUSHR">https://github.com/Gaius-Augustus/GUSHR</a>. Obtain it by typing:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/Gaius-Augustus/</span>GUSHR.git<br></code></pre></td></tr></table></figure><p>GUSHR executes a GeMoMa jar file <a href="https://github.com/Gaius-Augustus/BRAKER#f19">R19, </a><a href="https://github.com/Gaius-Augustus/BRAKER#f20">R20, </a><a href="https://github.com/Gaius-Augustus/BRAKER#f21">R21</a>, and this jar file requires Java 1.8. On Ubuntu, you can install Java 1.8 with the following command:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">sudo apt-<span class="hljs-built_in">get</span> install openjdk-8-jdk<br></code></pre></td></tr></table></figure><p>If you have several java versions installed on your system, make sure that you enable 1.8 prior running BRAKER with java by running</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">sudo update-alternatives --<span class="hljs-built_in">config</span> <span class="hljs-keyword">java </span><br></code></pre></td></tr></table></figure><p>and selecting the correct version.</p><h4 id="Tools-from-UCSC"><a href="#Tools-from-UCSC" class="headerlink" title="Tools from UCSC"></a><font color="red">Tools from UCSC</font></h4><p>If you switch <code>--UTR=on</code>, bamToWig.py will require the following tools that can be downloaded from <a href="http://hgdownload.soe.ucsc.edu/admin/exe">http://hgdownload.soe.ucsc.edu/admin/exe</a>:</p><ul><li>twoBitInfo</li><li>faToTwoBit</li></ul><p>It is optional to install these tools into your $PATH. If you donâ€™t, and you switch <code>--UTR=on</code>, bamToWig.py will automatically download them into the working directory.</p><h4 id="MakeHub"><a href="#MakeHub" class="headerlink" title="MakeHub"></a>MakeHub</h4><p>If you wish to automaticaly generate a track data hub of your BRAKER run, the MakeHub software, available at <a href="https://github.com/Gaius-Augustus/MakeHub">https://github.com/Gaius-Augustus/MakeHub</a> is required. Download the software (either by running <code>git clone https://github.com/Gaius-Augustus/MakeHub.git</code>, or by picking a release from <a href="https://github.com/Gaius-Augustus/MakeHub/releases">https://github.com/Gaius-Augustus/MakeHub/releases</a>. Extract the release package if you downloaded a release (e.g. <code>unzip MakeHub.zip</code> or <code>tar -zxvf MakeHub.tar.gz</code>.</p><p>BRAKER will try to locate the make_hub.py script by using an environment variable <code>$MAKEHUB_PATH</code>. Alternatively, this can be supplied as command line argument (<code>--MAKEHUB_PATH=/your/path/to/MakeHub/</code>). BRAKER can also try to guess the location of MakeHub on your system.</p><h1 id="Running-BRAKER"><a href="#Running-BRAKER" class="headerlink" title="Running BRAKER"></a><font color="red">Running BRAKER</font></h1><h2 id="Different-BRAKER-pipeline-modes"><a href="#Different-BRAKER-pipeline-modes" class="headerlink" title="Different BRAKER pipeline modes"></a>Different BRAKER pipeline modes</h2><p>In the following, we describe â€œtypicalâ€ BRAKER calls for different input data types. In general, we recommend that you run BRAKER <font color="blue">on genomic sequences that have been <strong>softmasked</strong> for Repeats</font>. If your genome has been softmasked, include the <code>--softmasking</code> flag in your BRAKER call!</p><h3 id="BRAKER-with-RNA-Seq-data"><a href="#BRAKER-with-RNA-Seq-data" class="headerlink" title="BRAKER with RNA-Seq data"></a>BRAKER with <font color="red">RNA-Seq data</font></h3><p>This approach is suitable for genomes of species for which <font color="blue">RNA-Seq libraries with a good coverage</font> of the transcriptome are available. The pipeline is illustrated in Figure <a href="https://github.com/Gaius-Augustus/BRAKER#fig1">2</a>.</p><p>BRAKER can either extract RNA-Seq spliced alignment information from <code>bam</code> files, or it can use such extracted information, directly.</p><p>In order to run BRAKER with RNA-Seq data supplied as <code>bam</code> file(s) (in case of multiple files, separate them by comma), run:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">braker.pl <span class="hljs-attribute">--species</span>=yourSpecies <span class="hljs-attribute">--genome</span>=genome.fasta \<br>   <span class="hljs-attribute">--bam</span>=file1.bam,file2.bam<br></code></pre></td></tr></table></figure><p>In order to run BRAKER with <font color="blue">RNA-Seq <strong>spliced alignment information</strong> that has already been extracted</font>, run:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">braker.pl <span class="hljs-attribute">--species</span>=yourSpecies <span class="hljs-attribute">--genome</span>=genome.fasta \<br>   <span class="hljs-attribute">--hints</span>=hints1.gff,hints2.gff<br></code></pre></td></tr></table></figure><p>The format of such a hints file must be as follows (tabulator separated file):</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs tap">chrName b2h intron <span class="hljs-number"> 6591 </span>  <span class="hljs-number"> 8003 </span>  <span class="hljs-number"> 1 </span>  +   .   pri=4;src=E<br>chrName b2h intron <span class="hljs-number"> 6136 </span>  <span class="hljs-number"> 9084 </span>  <span class="hljs-number"> 11 </span> +   .   mult=11;pri=4;src=E<br>...<br></code></pre></td></tr></table></figure><p><font color="blue">The source <strong>b2h</strong> in the <strong>second column</strong> and the source tag <strong>src&#x3D;E</strong> in the <strong>last column</strong> are <strong>essential for BRAKER to determine</strong> whether a <strong>hint</strong> has been <strong>generated from RNA-Seq</strong> data.</font></p><h3 id="BRAKER-with-proteins-of-any-evolutionary-distance"><a href="#BRAKER-with-proteins-of-any-evolutionary-distance" class="headerlink" title="BRAKER with proteins of any evolutionary distance"></a>BRAKER with <font color="red">proteins of any evolutionary distance</font></h3><p>This approach is <font color="blue"><strong>suitable for</strong> genomes of species for which <strong>no RNA-Seq libraries</strong></font> are available. A large database of proteins (with possibly longer evolutionary distance to the target species) should be used in this case. This mode is illustrated in figure <a href="https://github.com/Gaius-Augustus/BRAKER#fig8">9</a>.</p><img src="BRAKER/f9.png" alt="braker2-main-a[fig1]" style="zoom:50%;" /><p>Figure 9: BRAKER with proteins of any evolutionary distance. ProtHint protein mapping pipelines is used to generate protein hints. <font color="blue"><strong>ProtHint</strong> automatically <strong>determines</strong> which <strong>alignments</strong> are <strong>from close relatives</strong>, and which are <strong>from rather distant relatives.</strong></font></p><p>For running BRAKER in this mode, type:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span>=genome<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--prot_seq</span>=proteins<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--softmasking</span><br></code></pre></td></tr></table></figure><p>We <font color="blue"><strong>recommend</strong> using OrthoDB</font> as basis for <code>proteins.fa</code>. The instructions on <font color="blue"><strong>how to prepare the input OrthoDB proteins</strong></font> are documented here: <a href="https://github.com/gatech-genemark/ProtHint#protein-database-preparation">https://github.com/gatech-genemark/ProtHint#protein-database-preparation</a>.</p><p>You can of course add additional protein sequences to that file, or try with a completely different database. Any database will need several representatives for each protein, though.</p><p>Instead of having BRAKER run ProtHint, you <font color="blue">can also start BRAKER with hints already produced by ProtHint</font>, by providing ProtHintâ€™s <code>prothint_augustus.gff</code> output:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span>=genome<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--hints</span>=prothint_augustus<span class="hljs-selector-class">.gff</span> <span class="hljs-attr">--softmasking</span><br></code></pre></td></tr></table></figure><p>The format of <code>prothint_augustus.gff</code> in this mode looks like this:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2R</span> ProtHint intron <span class="hljs-number">11506230</span> <span class="hljs-number">11506648</span> <span class="hljs-number">4</span> + . src=M;mult=<span class="hljs-number">4</span>;pri=<span class="hljs-number">4</span><br><span class="hljs-attribute">2R</span> ProtHint intron <span class="hljs-number">9563406</span>  <span class="hljs-number">9563473</span>  <span class="hljs-number">1</span> + . grp=<span class="hljs-number">69004</span>_0:<span class="hljs-number">001</span>de1_702_g;src=C;pri=<span class="hljs-number">4</span>;<br><span class="hljs-attribute">2R</span> ProtHint intron <span class="hljs-number">8446312</span>  <span class="hljs-number">8446371</span>  <span class="hljs-number">1</span> + . grp=<span class="hljs-number">43151</span>_0:<span class="hljs-number">001</span>cae_473_g;src=C;pri=<span class="hljs-number">4</span>;<br><span class="hljs-attribute">2R</span> ProtHint intron <span class="hljs-number">8011796</span>  <span class="hljs-number">8011865</span>  <span class="hljs-number">2</span> - . src=P;mult=<span class="hljs-number">1</span>;pri=<span class="hljs-number">4</span>;al_score=<span class="hljs-number">0</span>.<span class="hljs-number">12</span>;<br><span class="hljs-attribute">2R</span> ProtHint start  <span class="hljs-number">234524</span>   <span class="hljs-number">234526</span>   <span class="hljs-number">1</span> + . src=P;mult=<span class="hljs-number">1</span>;pri=<span class="hljs-number">4</span>;al_score=<span class="hljs-number">0</span>.<span class="hljs-number">08</span>;<br></code></pre></td></tr></table></figure><p>The prediction of all hints with <font color="blue"><strong>src&#x3D;M</strong></font> will be enforced. Hints with <font color="blue"><strong>src&#x3D;C</strong></font> are â€˜chained evidenceâ€™, i.e. they will only be incorporated if all members of the group (grp&#x3D;â€¦) can be incorporated in a single transcript. All other hints have <font color="blue"><strong>src&#x3D;P</strong></font> in the last column. Supported features in column 3 are <code>intron</code>, <code>start</code>, <code>stop</code> and <code>CDSpart</code>.</p><h4 id="Training-and-prediction-of-UTRs-integration-of-coverage-information"><a href="#Training-and-prediction-of-UTRs-integration-of-coverage-information" class="headerlink" title="Training and prediction of UTRs, integration of coverage information"></a>Training and prediction of <font color="red">UTRs</font>, integration of coverage information</h4><p>If RNA-Seq (and only RNA-Seq) data is provided to BRAKER as a bam-file, and <font color="blue">if the genome is <strong>softmasked for repeats</strong></font>, BRAKER can automatically train UTR parameters for AUGUSTUS. After successful training of UTR parameters, BRAKER will automatically predict genes including coverage information form RNA-Seq data. Example call:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">braker.pl <span class="hljs-attribute">--species</span>=yourSpecies <span class="hljs-attribute">--genome</span>=genome.fasta \<br>   <span class="hljs-attribute">--bam</span>=file.bam --softmasking <span class="hljs-attribute">--UTR</span>=on<br></code></pre></td></tr></table></figure><p><strong>Warnings:</strong></p><ol><li>This feature is experimental!</li><li>â€“UTR&#x3D;on is currently not compatible with bamToWig.py as released in AUGUSTUS 3.3.3; it requires the current development code version from the github repository (git clone <a href="https://github.com/Gaius-Augustus/Augustus.git">https://github.com/Gaius-Augustus/Augustus.git</a>).</li><li>â€“UTR&#x3D;on increases memory consumption of AUGUSTUS. Carefully monitor jobs if your machine was close to maxing RAM without â€“UTR&#x3D;on! Reducing the number of cores will also reduce RAM consumption.</li><li>UTR prediction sometimes improves coding sequence prediction accuracy, but not always.<font color="red"> <strong>If you try this feature, carefully compare results with and without UTR parameters</strong>, </font>afterwards (e.g. in UCSC Genome Browser).</li></ol><h4 id="Stranded-RNA-Seq-alignments"><a href="#Stranded-RNA-Seq-alignments" class="headerlink" title="Stranded RNA-Seq alignments"></a>Stranded RNA-Seq alignments</h4><p>For running BRAKER without UTR parameters, <strong>it is not very important whether RNA-Seq data was generated by a <em>stranded</em> protocol</strong> (because spliced alignments are â€™artificially strandedâ€™ by checking the splice site pattern). <font color="red"><strong>However, for UTR training and prediction, stranded libraries may provide information that is valuable for BRAKER</strong>.</font></p><p>After alignment of the <strong>stranded RNA-Seq libraries</strong>, separate the resulting bam file entries into two files: <strong>one for plus strand mappings, one for minus strand mappings</strong>. Call BRAKER as follows:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">braker.pl <span class="hljs-attribute">--species</span>=yourSpecies <span class="hljs-attribute">--genome</span>=genome.fasta \<br>   --softmasking <span class="hljs-attribute">--bam</span>=plus.bam,minus.bam <span class="hljs-attribute">--stranded</span>=+,- \<br>    <span class="hljs-attribute">--UTR</span>=on<br></code></pre></td></tr></table></figure><p>You may additionally include bam files from <strong>unstranded libraries. Those files will not used for generating UTR training examples, but they will be included in the final gene prediction step as unstranded coverage information</strong>, example call:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--species</span>=yourSpecies <span class="hljs-attr">--genome</span>=genome<span class="hljs-selector-class">.fasta</span> \<br>   <span class="hljs-attr">--softmasking</span> <span class="hljs-attr">--bam</span>=plus<span class="hljs-selector-class">.bam</span>,minus<span class="hljs-selector-class">.bam</span>,unstranded<span class="hljs-selector-class">.bam</span> \<br>   <span class="hljs-attr">--stranded</span>=+,-,. <span class="hljs-attr">--UTR</span>=on<br></code></pre></td></tr></table></figure><p><strong>Warning:</strong> This feature is experimental and currently has low priority on our maintenance list!</p><h3 id="BRAKER-with-proteins-of-short-evolutionary-distance"><a href="#BRAKER-with-proteins-of-short-evolutionary-distance" class="headerlink" title="BRAKER with proteins of short evolutionary distance"></a>BRAKER with <font color="red">proteins of short evolutionary distance</font></h3><p>This is a deprecated pipeline that was before the only suitable approach if RNA-Seq data for the species of the target genome is not available and if a well annotated and very closely related reference species is available and you donâ€™t want to use the approach for proteins of any evolutionary distance (where we back then werenâ€™t sure how itâ€™d perform on proteins of short evolutionary distance).</p><p>For running BRAKER in this mode, type:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">braker.pl <span class="hljs-attribute">--species</span>=yourSpecies <span class="hljs-attribute">--genome</span>=genome.fasta \<br>   <span class="hljs-attribute">--prot_seq</span>=proteins.fa <span class="hljs-attribute">--prg</span>=gth \<br>   <span class="hljs-attribute">--ALIGNMENT_TOOL_PATH</span>=/path/to/gth/binary \<br>   --trainFromGth<br></code></pre></td></tr></table></figure><p><font color="blue">It is possible to generate protein alignments <strong>externally</strong>,</font> prior running BRAKER, itself. The compatible command for running GenomeThreader prior running BRAKER, is:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">gth -genomic genome<span class="hljs-selector-class">.fa</span>  -protein protein<span class="hljs-selector-class">.fa</span> -gff3out \<br>   -skipalignmentout -o gth.aln<br></code></pre></td></tr></table></figure><p>In order to use such externally created alignment files, run: <font color="blue"><strong>[aln out]</strong></font></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">braker.pl <span class="hljs-attribute">--species</span>=yourSpecies <span class="hljs-attribute">--genome</span>=genome.fasta \<br>   <span class="hljs-attribute">--prot_aln</span>=proteins.aln <span class="hljs-attribute">--prg</span>=gth --trainFromGth<br></code></pre></td></tr></table></figure><p>It is also possible to run BRAKER in this mode using an already prepared hints file. In this case, run: <font color="blue"><strong>[aln trans hint]</strong></font></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">braker.pl <span class="hljs-attribute">--species</span>=yourSpecies <span class="hljs-attribute">--genome</span>=genome.fasta \<br>   <span class="hljs-attribute">--hints</span>=hints.gff <span class="hljs-attribute">--prg</span>=gth --trainFromGth<br></code></pre></td></tr></table></figure><p><font color="red"><strong>â€“prg&#x3D;gth â€“trainFromGth? if i have aug,rna,pro hints, alos set this???</strong></font></p><p>Format of the hints file should look like this:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">chrName</span>   gth2h   CDSpart <span class="hljs-number">105984</span>  <span class="hljs-number">106633</span>  .     -    .    src=P;grp=FBpp0285205;pri=<span class="hljs-number">4</span><br><span class="hljs-attribute">chrName</span>   gth2h   start   <span class="hljs-number">106646</span>  <span class="hljs-number">106648</span>  .     -    .    src=P;grp=FBpp0285205;pri=<span class="hljs-number">4</span><br></code></pre></td></tr></table></figure><p>Supported features in column 3 are intron, CDSpart, start, stop.</p><h3 id="BRAKER-with-RNA-Seq-and-protein-data"><a href="#BRAKER-with-RNA-Seq-and-protein-data" class="headerlink" title="BRAKER with RNA-Seq and protein data"></a>BRAKER with <font color="red">RNA-Seq and protein data</font></h3><p>Even though BRAKER supports the combination of RNA-Seq and protein data within the BRAKER pipeline, we strongly recommend to run BRAKER twice (<font color="blue"><strong>1x with RNA-Seq only</strong></font>, <font color="blue"><strong>1x with protein data only</strong></font>) and subsequently combine the results of both runs with <font color="blue"><strong>TSEBRA</strong></font>, the Transcript Selector for BRAKER (<a href="https://github.com/Gaius-Augustus/TSEBRA">https://github.com/Gaius-Augustus/TSEBRA</a>). You find more information on TSEBRA at <a href="https://www.biorxiv.org/content/10.1101/2021.06.07.447316v1">https://www.biorxiv.org/content/10.1101/2021.06.07.447316v1</a></p><p>In the following, we describe that it is possible to combine both data sources with BRAKER, alone, for the sake of completeness.</p><p>The  <font color="blue">native mode</font> for running BRAKER  <font color="blue">with RNA-Seq and protein</font> data is <code>--etpmode</code>. This will  <font color="blue">call GeneMark-ETP</font> (which is currently only available as a premature version by using current state GeneMark-ES&#x2F;ET&#x2F;EP&#x2F;EP+, improvements are to be expected, soon), which will  <font color="blue">use RNA-Seq and protein hints for training GeneMark-ETP</font>. Hints that are  <font color="blue"><strong>supported by both</strong> sources and proteins hints of particularly high quality are enforced in gene prediction with <strong>GeneMark-ETP</strong></font>. Subsequently,  <font color="blue"><strong>AUGUSTUS</strong></font> is trained on GeneMark-ETP predictions and genes with hints are predicted by AUGUSTUS. To call the pipeline in this mode, run:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span>=genome<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--prot_seq</span>=orthodb<span class="hljs-selector-class">.fa</span> \<br>   <span class="hljs-attr">--hints</span>=rnaseq<span class="hljs-selector-class">.hints</span> <span class="hljs-attr">--etpmode</span> <span class="hljs-attr">--softmasking</span><br></code></pre></td></tr></table></figure><p>You can or course replace the <code>rnaseq.gff</code> hints file by a BAM-file, e.g. <code>--bam=ranseq.bam</code>.</p><p>In addition, the following pipelines can be executed by BRAKER (deprecated pipelines):</p><ul><li>Adding protein data of short evolutionary distance to gene prediction step</li><li>Extending training gene set with proteins of short evolutionary distance</li></ul><h4 id="Adding-protein-data-of-short-evolutionary-distance-to-gene-prediction-step"><a href="#Adding-protein-data-of-short-evolutionary-distance-to-gene-prediction-step" class="headerlink" title="Adding protein data of short evolutionary distance to gene prediction step"></a>Adding protein data of short evolutionary distance to gene prediction step</h4><p>This pipeline is illustrated in Figure <a href="https://github.com/Gaius-Augustus/BRAKER#fig6">7</a>.</p><p>In general, add the options</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-literal">--</span><span class="hljs-comment">prot_seq=proteins</span><span class="hljs-string">.</span><span class="hljs-comment">fa</span> <span class="hljs-literal">--</span><span class="hljs-comment">prg=(gth|exonerate|spaln)</span><br></code></pre></td></tr></table></figure><p>to the BRAKER call that is described in section <a href="https://github.com/Gaius-Augustus/BRAKER#braker-with-rna-seq-data">BRAKER with RNA-Seq data</a>.  <font color="blue">Select one protein alignment tool</font> from <font color="blue"> <strong>GenomeThreader</strong> (<code>gth</code>, <strong>recommended</strong>), Spaln (<code>spaln</code>) or Exonerate (<code>exonerate</code>)</font>. Of course, you may also specify the protein information  <font color="blue">as protein alignment files or hints files as</font> described in section <a href="https://github.com/Gaius-Augustus/BRAKER#braker-with-proteins-of-short-evolutionary-distance">BRAKER with proteins of short evolutionary distance</a>). This may result in a call similar to:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">braker.pl <span class="hljs-attribute">--species</span>=yourSpecies <span class="hljs-attribute">--genome</span>=genome.fasta \<br>   <span class="hljs-attribute">--bam</span>=file1.bam,file2.bam <span class="hljs-attribute">--prot_seq</span>=proteins.fa \<br>   --prg=(gth|exonerate|spaln)<br></code></pre></td></tr></table></figure><h4 id="Extending-training-gene-set-with-proteins-of-short-evolutionary-distance"><a href="#Extending-training-gene-set-with-proteins-of-short-evolutionary-distance" class="headerlink" title="Extending training gene set with proteins of short evolutionary distance"></a>Extending training gene set with proteins of short evolutionary distance</h4><p> <font color="blue">If the <strong>number of training gene</strong> structures identified by RNA-Seq data, only, seems to be <strong>too small</strong></font>, you may add training gene structures generated by protein alignments with GenomeThreader to the training gene set. This pipeline is illustrated in Figure <a href="https://github.com/Gaius-Augustus/BRAKER#fig7">8</a>.</p><p>In general, add the options</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">--prot_seq</span>=proteins.fa <span class="hljs-attribute">--prg</span>=gth --gth2traingenes<br></code></pre></td></tr></table></figure><p>to the BRAKER call that is described in section <a href="https://github.com/Gaius-Augustus/BRAKER#braker-with-rna-seq-data">BRAKER with RNA-Seq data</a>. This may result in a call similar to:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--species</span>=yourSpecies <span class="hljs-attr">--genome</span>=genome<span class="hljs-selector-class">.fasta</span> \<br>   <span class="hljs-attr">--bam</span>=file1<span class="hljs-selector-class">.bam</span>,file2<span class="hljs-selector-class">.bam</span> <span class="hljs-attr">--prot_seq</span>=proteins<span class="hljs-selector-class">.fa</span> \<br>   <span class="hljs-attr">--prg</span>=gth <span class="hljs-attr">--gth2traingenes</span><br></code></pre></td></tr></table></figure><h4 id="BRAKER-with-short-and-long-read-RNA-Seq-and-protein-data"><a href="#BRAKER-with-short-and-long-read-RNA-Seq-and-protein-data" class="headerlink" title="BRAKER with short and long read RNA-Seq and protein data"></a>BRAKER with short and long read RNA-Seq and protein data</h4><p>A preliminary protocol for integration of assembled subreads from PacBio ccs sequencing in combination with short read Illumina RNA-Seq and protein database is described at <a href="https://github.com/Gaius-Augustus/BRAKER/blob/master/docs/long_reads/long_read_protocol.md">https://github.com/Gaius-Augustus/BRAKER/blob/master/docs/long_reads/long_read_protocol.md</a></p><h2 id="Description-of-selected-BRAKER-command-line-options"><a href="#Description-of-selected-BRAKER-command-line-options" class="headerlink" title="Description of selected BRAKER command line options"></a>Description of selected BRAKER command line options</h2><p>Please run <code>braker.pl --help</code> to obtain a full list of options.</p><h3 id="â€“epmode"><a href="#â€“epmode" class="headerlink" title="â€“epmode"></a>â€“epmode</h3><p>Run BRAKER in <font color="blue"><strong>EP-mode</strong>, i.e. with proteins of any evolutionary distance as <strong>processed by ProtHint</strong> within BRAKER. This mode is turned on <strong>by default</strong> when <strong>only protein</strong> input is detected</font>. Should be provided with either <strong>â€“prot_seq&#x3D;orthodb.fa</strong> or protein hints <strong>â€“hints&#x3D;prothint_augustus.gff</strong>.</p><h3 id="â€“etpmode"><a href="#â€“etpmode" class="headerlink" title="â€“etpmode"></a>â€“etpmode</h3><p>Run BRAKER in <font color="red"><strong>ETP-mode</strong></font>, i.e. with proteins of any evolutionary distance processed by ProtHint, and with RNA-Seq data. Should to be provided with <code>prot_seq=orthodb.fa</code> and <code>--bam=rnaseq.bam</code>. <font color="blue"><strong>Alternatively, the RNA-Seq and protein hints can be provided as processed hints</strong></font> with the <code>--hints</code> opiton. Please consider using TSEBRA (<a href="https://github.com/Gaius-Augustus/TSEBRA">https://github.com/Gaius-Augustus/TSEBRA</a>) instead of BRAKER in ETP-mode.</p><h3 id="â€“ab-initio"><a href="#â€“ab-initio" class="headerlink" title="â€“ab_initio"></a>â€“ab_initio</h3><p><strong>Compute AUGUSTUS <em>ab initio</em> predictions in addition</strong> to AUGUSTUS predictions with hints (additional output files: <code>augustus.ab_initio.*</code>. This may be useful for <strong>estimating the quality of training gene parameters</strong> when inspecting predictions in a Browser.</p><h3 id="â€“augustus-args-x3D-â€â€“some-arg-x3D-blaâ€"><a href="#â€“augustus-args-x3D-â€â€“some-arg-x3D-blaâ€" class="headerlink" title="â€“augustus_args&#x3D;â€â€“some_arg&#x3D;blaâ€"></a>â€“augustus_args&#x3D;â€â€“some_arg&#x3D;blaâ€</h3><p>One or several command line arguments to be passed to AUGUSTUS, if several arguments are given, separate them by whitespace, i.e. <code>&quot;--first_arg=sth --second_arg=sth&quot;</code>. This may be be useful if you know that gene prediction in your particular species benefits from a particular AUGUSTUS argument during the prediction step.</p><h3 id="â€“cores-x3D-INT"><a href="#â€“cores-x3D-INT" class="headerlink" title="â€“cores&#x3D;INT"></a>â€“cores&#x3D;INT</h3><p>Specifies the maximum number of cores that can be used during computation. BRAKER has to run some steps on a single core, others can take advantage of multiple cores. If you use more than 8 cores, this will not speed up all parallelized steps, in particular, the time consuming <code>optimize_augustus.pl</code> will not use more than <strong>8 cores</strong>. However, if you donâ€™t mind some cores being idle, using more than 8 cores will speed up other steps.</p><h3 id="â€“fungus"><a href="#â€“fungus" class="headerlink" title="â€“fungus"></a>â€“fungus</h3><p>GeneMark-EX option: run algorithm with branch point model. Use this option <strong>if you genome is a fungus</strong>.</p><h3 id="â€“softmasking"><a href="#â€“softmasking" class="headerlink" title="â€“softmasking"></a>â€“softmasking</h3><p>Softmasking option for <strong>soft masked genome</strong> files. (Disabled by default.)</p><h3 id="â€“useexisting"><a href="#â€“useexisting" class="headerlink" title="â€“useexisting"></a>â€“useexisting</h3><p>ã€<strong>Use the present config and parameter files if they exist</strong> for â€˜speciesâ€™; will overwrite original parameters if BRAKER performs an AUGUSTUS training.ã€‘??</p><h3 id="â€“crf"><a href="#â€“crf" class="headerlink" title="â€“crf"></a>â€“crf</h3><p>Execute CRF training for AUGUSTUS; resulting parameters are only kept for final predictions if they show higher accuracy than HMM parameters. This increases runtime!</p><h3 id="â€“lambda-x3D-int"><a href="#â€“lambda-x3D-int" class="headerlink" title="â€“lambda&#x3D;int"></a>â€“lambda&#x3D;int</h3><p>Change the parameter $\lambda$ of the Poisson distribution that is used for downsampling training genes according to their number of introns (only genes with up to 5 introns are downsampled). The default value is $\lambda&#x3D;2$. You might want to set it to 0 for organisms that mainly have single-exon genes. (Generally, single-exon genes contribute less value to increasing AUGUSTUS parameters compared to genes with many exons.)</p><h3 id="â€“UTR-x3D-on"><a href="#â€“UTR-x3D-on" class="headerlink" title="â€“UTR&#x3D;on"></a>â€“UTR&#x3D;on</h3><p><font color="blue">Generate <strong>UTR training</strong> examples for AUGUSTUS from <strong>RNA-Seq coverage information</strong></font>, train AUGUSTUS UTR parameters and predict genes with AUGUSTUS and UTRs, including coverage information for RNA-Seq as evidence. This flag only works if â€“softmasking is also enabled. <em>This is an experimental feature!</em></p><p>If you performed a BRAKER run without â€“UTR&#x3D;on, you can add UTR parameter training and gene prediction with UTR parameters (and only RNA-Seq hints) with the following command:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span>=../genome<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--addUTR</span>=on <span class="hljs-attr">--softmasking</span> \<br>    <span class="hljs-attr">--bam</span>=../RNAseq<span class="hljs-selector-class">.bam</span> <span class="hljs-attr">--workingdir</span>=<span class="hljs-variable">$wd</span> \<br>    <span class="hljs-attr">--AUGUSTUS_hints_preds</span>=augustus<span class="hljs-selector-class">.hints</span><span class="hljs-selector-class">.gtf</span> \<br>    <span class="hljs-attr">--cores</span>=<span class="hljs-number">8</span> <span class="hljs-attr">--skipAllTraining</span> <span class="hljs-attr">--species</span>=somespecies<br></code></pre></td></tr></table></figure><p><font color="red"><strong>â€“AUGUSTUS_hints_preds</strong>. Modify <strong>augustus.hints.gtf</strong> to point to the <strong>AUGUSTUS predictions with hints from previous BRAKER run</strong></font>; <strong>modify flaning_DNA value to the flanking region from the log file???</strong> of your previous BRAKER run; modify some_new_working_directory to the location where BRAKER should store results of the additional BRAKER run; modify somespecies to the species name used in your previous BRAKER run.</p><p><font color="red">â€“AUGUSTUS_hints_preds</font>: only UTR training and prediction is performed if this option is given</p><h3 id="â€“addUTR-x3D-on"><a href="#â€“addUTR-x3D-on" class="headerlink" title="â€“addUTR&#x3D;on"></a>â€“addUTR&#x3D;on</h3><p>Add UTRs from RNA-Seq converage information to AUGUSTUS gene predictions using GUSHR. No training of UTR parameters and no gene prediction with UTR parameters is performed.</p><p>If you performed a BRAKER run without â€“addUTR&#x3D;on, you can add UTRs results of a previous BRAKER run with the following command:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span>=../genome<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--addUTR</span>=on <span class="hljs-attr">--softmasking</span> \<br>    <span class="hljs-attr">--bam</span>=../RNAseq<span class="hljs-selector-class">.bam</span> <span class="hljs-attr">--workingdir</span>=<span class="hljs-variable">$wd</span> \<br>    <span class="hljs-attr">--AUGUSTUS_hints_preds</span>=augustus<span class="hljs-selector-class">.hints</span><span class="hljs-selector-class">.gtf</span> <span class="hljs-attr">--cores</span>=<span class="hljs-number">8</span> \<br>    <span class="hljs-attr">--skipAllTraining</span> <span class="hljs-attr">--species</span>=somespecies<br></code></pre></td></tr></table></figure><p>Modify <code>augustus.hints.gtf</code> to point to the AUGUSTUS predictions with hints from previous BRAKER run; modify some_new_working_directory to the location where BRAKER should store results of the additional BRAKER run; this run will not modify AUGUSTUS parameters. <font color="red"> <strong>We recommend that you specify the original species of the original run with â€“species&#x3D;somespecies. Otherwise, BRAKER will create an unneeded species parameters directory Sp_</strong></font></p><h3 id="â€“stranded-x3D-â€¦"><a href="#â€“stranded-x3D-â€¦" class="headerlink" title="â€“stranded&#x3D;+,-,.,â€¦"></a>â€“stranded&#x3D;+,-,.,â€¦</h3><p>If <code>--UTR=on</code> is enabled, strand-separated bam-files can be provided with <code>--bam=plus.bam,minus.bam</code>. In that case, <code>--stranded=...</code> should hold the strands of the bam files (<code>+</code> for plus strand, <code>-</code> for minus strand, <code>.</code> for unstranded). Note that unstranded data will be used in the gene prediction step, only, if the parameter <code>--stranded=...</code> is set. <em>This is an experimental feature! GUSHR currently does not take advantage of stranded data.</em></p><h3 id="â€“makehub-email-x3D-x79-111-117-x72-64-x6d-x61-105-108-46-100-x65"><a href="#â€“makehub-email-x3D-x79-111-117-x72-64-x6d-x61-105-108-46-100-x65" class="headerlink" title="â€“makehub --email&#x3D;&#x79;&#111;&#117;&#x72;&#64;&#x6d;&#x61;&#105;&#108;&#46;&#100;&#x65;"></a>â€“makehub --email&#x3D;<a href="mailto:&#x79;&#111;&#117;&#x72;&#64;&#x6d;&#x61;&#105;&#108;&#46;&#100;&#x65;">&#x79;&#111;&#117;&#x72;&#64;&#x6d;&#x61;&#105;&#108;&#46;&#100;&#x65;</a></h3><p>If <code>--makehub</code> and <code>--email=your@mail.de</code> (with your valid e-mail adress) are provided, a track data hub for visualizing results with the UCSC Genome Browser will be generated using MakeHub (<a href="https://github.com/Gaius-Augustus/MakeHub">https://github.com/Gaius-Augustus/MakeHub</a>).</p><h3 id="â€“gc-probability-x3D-DECIMAL"><a href="#â€“gc-probability-x3D-DECIMAL" class="headerlink" title="â€“gc_probability&#x3D;DECIMAL"></a>â€“gc_probability&#x3D;DECIMAL</h3><p>By default, GeneMark-EX uses a probability of 0.001 for predicting the donor splice site pattern GC (instead of GT). It may make sense to increase this value for species where this donor splice site is more common. For example, in the species <em>Emiliania huxleyi</em>, about 50% of donor splice sites have the pattern GC (<a href="https://media.nature.com/original/nature-assets/nature/journal/v499/n7457/extref/nature12221-s2.pdf">https://media.nature.com/original/nature-assets/nature/journal/v499/n7457/extref/nature12221-s2.pdf</a>, page 5).</p><h1 id="Output-of-BRAKER"><a href="#Output-of-BRAKER" class="headerlink" title="Output of BRAKER"></a>Output of BRAKER</h1><p>BRAKER produces several important output files in the working directory.</p><ul><li><font color="red"><strong>augustus.hints.gtf</strong></font>: Genes predicted by AUGUSTUS with hints from given extrinsic evidence. This file will be missing if BRAKER was run with the option <code>--esmode</code>.</li><li><font color="blue"><strong>augustus.hints_utr.gtf</strong></font>: This file may contain different contents depending on how you called BRAKER:<ul><li>If you ran BRAKER with <font color="blue"><strong>â€“UTR&#x3D;on</strong></font>, then this file will <strong>contain genes predicted by AUGUSTUS with UTR parameters and coverage information from RNA-Seq</strong> data <strong>in GTF</strong> format.</li><li>If you ran BRAKER with <font color="blue"><strong>â€“addUTR&#x3D;on</strong></font>, then this file will contain genes predicted by AUGUSTUS <strong>without</strong> UTR parameters and without coverage information from RNA-Seq data. Instead, <strong>AUGUSTUS gene predictions with hints will only be extended by UTRs if RNA-Seq coverage allows</strong> it (i.e. no separate AUGUSTUS training or run was performed, UTRs are only added from running GUSHR). Genes in are in GTF format.</li></ul></li></ul><p>This file will only be present if BRAKER was executed with the options <code>--UTR=on</code> or <code>--addUTR=on</code> and a RNA-Seq BAM file.</p><ul><li><font color="blue"><strong>augustus.ab_initio.gtf</strong></font>: <strong>Genes predicted by AUGUSTUS in <em>ab initio</em> mode</strong> in GTF-format. The file will always be present if AUGUSTUS has been run with the option <font color="blue">â€“esmode</font>. Otherwise, it will only be present if BRAKER was run with the option <font color="blue">â€“AUGUSTUS_ab_initio</font>.</li><li><font color="blue"><strong>augustus.ab_initio_utr.gtf</strong></font>: This file may contain gene predictions with UTRs if you ran BRAKER with<font color="blue"> â€“UTR&#x3D;on</font>.</li></ul><p>This file will only be present if BRAKER was executed with the options <code>--UTR=on</code> or <code>--addUTR=on</code> and a RNA-Seq BAM-file, and with the option <code>--AUGUSTUS_ab_initio</code>.</p><ul><li><font color="blue"><em><em>GeneMark-E</em>&#x2F;genemark.gtf</em>*</font>: Genes predicted by GeneMark-ES&#x2F;ET&#x2F;EP&#x2F;EP+ in GTF-format. This file will be missing if BRAKER was executed with proteins of close homology and the option <code>--trainFromGth</code>.</li><li><font color="blue"><strong>braker.gtf</strong></font>: Union of augustus.hints.gtf and reliable GeneMark-EX predictions (genes fully supported by external evidence). In <code>--esmode</code>, this is the union of augustus.ab_initio.gtf and all GeneMark-ES genes. Thus, this set is generally more sensitive (more genes correctly predicted) and can be less specific (more false-positive predictions can be present).</li><li><font color="red"><strong>hintsfile.gff</strong></font>: The extrinsic evidence data extracted from RNAseq.bam and&#x2F;or protein data.</li></ul><p>AUGUSTUS output files may be present with the following name endings and formats:</p><ul><li><font color="red"><strong>GTF</strong>-format is <strong>always produced</strong></font>.</li><li><font color="red"><strong>GFF3</strong></font>-format is produced if the flag <font color="red"><strong>â€“gff3</strong></font> was specified to BRAKER.</li><li><font color="red">Coding sequences in FASTA-format <strong>augustus.hints.codingseq</strong></font> are produced if the flag <font color="blue">â€“skipGetAnnoFromFasta was not set</font>.</li><li><font color="red">Protein sequence files in FASTA-formatÂ <strong>augustus.hints.aa</strong></font> are produced if the flag <font color="blue">â€“skipGetAnnoFromFasta was not set.</font></li></ul><p>For details about gtf format, see <a href="http://www.sanger.ac.uk/Software/formats/GFF/">http://www.sanger.ac.uk/Software/formats/GFF/</a>. A GTF-format file contains one line per predicted exon. Example:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">HS04636</span> AUGUSTUS initial   <span class="hljs-number">966</span> <span class="hljs-number">1017</span> . + <span class="hljs-number">0</span> transcript_id <span class="hljs-string">&quot;g1.1&quot;</span>; gene_id <span class="hljs-string">&quot;g1&quot;</span>;<br><span class="hljs-attribute">HS04636</span> AUGUSTUS internal <span class="hljs-number">1818</span> <span class="hljs-number">1934</span> . + <span class="hljs-number">2</span> transcript_id <span class="hljs-string">&quot;g1.1&quot;</span>; gene_id <span class="hljs-string">&quot;g1&quot;</span>;<br></code></pre></td></tr></table></figure><p>The columns (fields) contain:</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">seqname</span> source feature start <span class="hljs-meta">end</span> score strand frame transcript ID <span class="hljs-keyword">and</span> gene ID<br></code></pre></td></tr></table></figure><p>If the <code>--makehub</code> option was used and MakeHub is available on your system, a hub directory beginning with the name <code>hub_</code> will be created. Copy this directory to a publicly accessible web server. A file <code>hub.txt</code> resides in the directory. Provide the link to that file to the <font color="blue">UCSC Genome Browser for visualizing results</font>.</p><h1 id="Example-data"><a href="#Example-data" class="headerlink" title="Example data"></a>Example data</h1><p>An incomplete example data set is contained in the directory <code>BRAKER/example</code>. In order to complete the data set, please <strong>download the RNA-Seq alignment BAM file</strong> (134 MB) with <code>wget</code>:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">cd BRAKER/example<br>wget http:<span class="hljs-regexp">//</span>topaz.gatech.edu<span class="hljs-regexp">/GeneMark/</span>Braker/RNAseq.bam<br></code></pre></td></tr></table></figure><p>In case you have trouble accessing that file, thereâ€™s also a copy available from another server:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">cd BRAKER/example<br>wget http:<span class="hljs-regexp">//</span>bioinf.uni-greifswald.de<span class="hljs-regexp">/augustus/</span>datasets/RNAseq.bam<br></code></pre></td></tr></table></figure><p>The example data set was not compiled in order to achieve optimal prediction accuracy, but in order to quickly test pipeline components. The small subset of <strong>the genome used in these test examples is not long enough for BRAKER training</strong> to work well. <font color="blue">Too few genes</font></p><h2 id="Data-description"><a href="#Data-description" class="headerlink" title="Data description"></a>Data description</h2><p>Data corresponds to the last 1,000,000 nucleotides of <em>Arabidopsis thaliana</em>â€˜s chromosome Chr5, split into 8 artificial contigs.</p><p>RNA-Seq alignments were obtained by <a href="https://github.com/Gaius-Augustus/VARUS">VARUS</a>.</p><p>The protein sequences are a subset of <a href="https://v100.orthodb.org/download/odb10_plants_fasta.tar.gz">OrthoDB v10 plants proteins</a>.</p><p>List of files:</p><ul><li><code>genome.fa</code> - genome file in fasta format</li><li><code>RNAseq.bam</code> - RNA-Seq alignment file in bam format (this file is not a part of this repository, it must be downloaded separately from <a href="http://topaz.gatech.edu/GeneMark/Braker/RNAseq.bam">http://topaz.gatech.edu/GeneMark/Braker/RNAseq.bam</a>)</li><li><code>RNAseq.hints</code> - RNA-Seq hints (<strong>can be used instead of RNAseq.bam as RNA-Seq input to BRAKER</strong>)</li><li><code>proteins.fa</code> - protein sequences in fasta format</li></ul><p><strong>Set $PATH.</strong></p><p>The example data set also contains scripts <code>tests/test*.sh</code> that will execute below listed commands for testing BRAKER with the example data set. You find example <font color="blue"><strong>results of AUGUSTUS and GeneMark-EX</strong></font> in the folder <code>results/test*</code>. Be aware that BRAKER contains several parts where random variables are used, i.e. results that you obtain when running the tests may not be exactly identical. To <strong>compare</strong> your test <strong>results with the reference ones</strong>, you can use the <a href="https://github.com/Gaius-Augustus/BRAKER/blob/master/scripts/compare_intervals_exact.pl">compare_intervals_exact.pl</a> script as follows:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># Compare CDS features</span><br>compare_intervals_exact.pl --f1 augustus.hints.gtf --f2 ../../results/test<span class="hljs-variable">$&#123;N&#125;</span>/augustus.hints.gtf --verbose<br><span class="hljs-comment"># Compare transcripts</span><br>compare_intervals_exact.pl --f1 augustus.hints.gtf --f2 ../../results/test<span class="hljs-variable">$&#123;N&#125;</span>/augustus.hints.gtf --trans --verbose<br></code></pre></td></tr></table></figure><p>Several tests use <code>--gm_max_intergenic 10000</code> option to make the test runs faster. <font color="red"><strong>It is not recommended to use this option in real BRAKER runs, the speed increase achieved by adjusting this option is negligible on full-sized genomes.</strong></font></p><h2 id="Testing-BRAKER-with-RNA-Seq-data"><a href="#Testing-BRAKER-with-RNA-Seq-data" class="headerlink" title="Testing BRAKER with RNA-Seq data"></a>Testing BRAKER with RNA-Seq data</h2><p>The following command will run the pipeline according to Figure <a href="https://github.com/Gaius-Augustus/BRAKER#fig2">3</a>:</p><img src="BRAKER/f3.png" alt="braker2-main-a[fig1]" style="zoom:50%;" /><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span> genome<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--bam</span> RNAseq<span class="hljs-selector-class">.bam</span> <span class="hljs-attr">--softmasking</span> <span class="hljs-attr">--cores</span> N<br></code></pre></td></tr></table></figure><p>This test is implemented in <code>test1.sh</code>, expected runtime is ~20 minutes.</p><h2 id="Testing-BRAKER-with-proteins-of-any-evolutionary-distance"><a href="#Testing-BRAKER-with-proteins-of-any-evolutionary-distance" class="headerlink" title="Testing BRAKER with proteins of any evolutionary distance"></a>Testing BRAKER with proteins of any evolutionary distance</h2><p>The following command will run the pipeline according to Figure <a href="https://github.com/Gaius-Augustus/BRAKER#fig3">4</a>: <strong>ProHint</strong></p><img src="BRAKER/f4.png" alt="braker2-main-a[fig1]" style="zoom:50%;" /><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span> genome<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--prot_seq</span> proteins<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--softmasking</span> <span class="hljs-attr">--cores</span> N<br></code></pre></td></tr></table></figure><p>This test is implemented in <code>test2.sh</code>, expected runtime is ~20 minutes.</p><h2 id="Testing-BRAKER-with-proteins-of-any-evolutionary-distance-and-RNA-Seq"><a href="#Testing-BRAKER-with-proteins-of-any-evolutionary-distance-and-RNA-Seq" class="headerlink" title="Testing BRAKER with proteins of any evolutionary distance and RNA-Seq"></a>Testing BRAKER with proteins of any evolutionary distance and RNA-Seq</h2><p><font color="red"><strong>Please consider using TSEBRA instead of running BRAKER with both RNA-Seq and protein data</strong></font>: <a href="https://github.com/Gaius-Augustus/TSEBRA">https://github.com/Gaius-Augustus/TSEBRA</a></p><p>The following command will run a pipeline that <font color="red">first trains <strong>GeneMark-ETP</strong> with <strong>protein</strong> and <strong>RNA</strong>-Seq hints</font> and subsequently trains AUGUSTUS on the basis of GeneMark-ETP predictions. <strong>AUGUSTUS predictions</strong> are also performed with hints from <strong>both sources</strong>, see Figure <a href="https://github.com/Gaius-Augustus/BRAKER#fig4">5</a>:</p><img src="BRAKER/f5.png" alt="braker2-main-a[fig1]" style="zoom:50%;" /><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span> genome<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--prot_seq</span> proteins<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--bam</span> ../RNAseq<span class="hljs-selector-class">.bam</span> <span class="hljs-attr">--etpmode</span> <span class="hljs-attr">--softmasking</span> <span class="hljs-attr">--cores</span> N<br></code></pre></td></tr></table></figure><p>This test is implemented in <code>test3.sh</code>, expected runtime is ~20 minutes.</p><p>You can <font color="red"><strong>add UTRs</strong> from RNA-Seq data</font> (<font color="red"><strong>no AUGUSTUS training</strong></font>) to <strong>results of a BRAKER run in ETP-mode</strong> the following way:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span>=../genome<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--addUTR</span>=on <span class="hljs-attr">--softmasking</span> \<br>    <span class="hljs-attr">--bam</span>=../RNAseq<span class="hljs-selector-class">.bam</span> <span class="hljs-attr">--workingdir</span>=<span class="hljs-variable">$wd</span> \<br>    <span class="hljs-attr">--AUGUSTUS_hints_preds</span>=augustus<span class="hljs-selector-class">.hints</span><span class="hljs-selector-class">.gtf</span> <span class="hljs-attr">--cores</span>=<span class="hljs-number">8</span> \<br>    <span class="hljs-attr">--skipAllTraining</span> <span class="hljs-attr">--species</span>=somespecies<br></code></pre></td></tr></table></figure><p>This is implemented in <code>test3_add_utrs.sh</code>, expected <strong>runtime is ~1 minute.</strong></p><h2 id="Testing-BRAKER-with-proteins-of-close-homology"><a href="#Testing-BRAKER-with-proteins-of-close-homology" class="headerlink" title="Testing BRAKER with proteins of close homology"></a>Testing BRAKER with proteins of close homology</h2><p>The following command will run the pipeline according to Figure <a href="https://github.com/Gaius-Augustus/BRAKER#fig5">6</a>:</p><img src="BRAKER/f6.png" alt="braker2-main-a[fig1]" style="zoom:50%;" /><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span> genome<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--prot_seq</span> proteins<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--prg</span> gth \<br>    <span class="hljs-attr">--trainFromGth</span> <span class="hljs-attr">--softmasking</span> <span class="hljs-attr">--cores</span> N<br></code></pre></td></tr></table></figure><p>This test is implemented in <code>test4.sh</code>, expected runtime is ~7 minutes. The fast runtime of this test is mostly caused by <font color="red"><strong>generating a low number of training genes [no GeneMark]</strong></font>. Note that this approach <font color="red"> not scale well with increasing genome size and the number of proteins in a protein database</font>. The runtime on a full genome will be much slower than with the command used in <code>test2.sh</code>.</p><h2 id="Testing-BRAKER-with-proteins-of-close-homology-and-RNA-Seq-data-RNA-Seq-supported-training"><a href="#Testing-BRAKER-with-proteins-of-close-homology-and-RNA-Seq-data-RNA-Seq-supported-training" class="headerlink" title="Testing BRAKER with proteins of close homology and RNA-Seq data (RNA-Seq supported training)"></a>Testing BRAKER with proteins of close homology and RNA-Seq data (<font color="red">RNA-Seq supported training</font>)</h2><p><font color="red">Please consider using <strong>TSBERA</strong> instead of running BRAKER with <strong>proteins</strong> and <strong>RNA</strong>-Seq</font>font&gt; data at the same time: <a href="https://github.com/Gaius-Augustus/TSEBRA">https://github.com/Gaius-Augustus/TSEBRA</a></p><p>The following command will run the pipeline according to Figure <a href="https://github.com/Gaius-Augustus/BRAKER#fig6">7</a>:</p><img src="BRAKER/f7.png" alt="braker2-main-a[fig1]" style="zoom:50%;" /><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#no etp</span><br>braker.pl --genome genome.fa --prot_seq proteins.fa --prg gth \<br>    --bam RNAseq.bam --softmasking --cores N<br></code></pre></td></tr></table></figure><p>This test is implemented in <code>test5.sh</code>, expected runtime is ~20 minutes.</p><h2 id="Testing-BRAKER-with-proteins-of-close-homology-and-RNA-Seq-data-RNA-Seq-and-protein-supported-training"><a href="#Testing-BRAKER-with-proteins-of-close-homology-and-RNA-Seq-data-RNA-Seq-and-protein-supported-training" class="headerlink" title="Testing BRAKER with proteins of close homology and RNA-Seq data (RNA-Seq and protein supported training)"></a>Testing BRAKER with proteins of close homology and RNA-Seq data (<font color="red">RNA-Seq and protein supported training</font>)</h2><p>Please consider using TSBERA instead of running BRAKER with proteins and RNA-Seq data at the same time: <a href="https://github.com/Gaius-Augustus/TSEBRA">https://github.com/Gaius-Augustus/TSEBRA</a></p><p>The following command will run the pipeline according to Figure <a href="https://github.com/Gaius-Augustus/BRAKER#fig7">8</a>:</p><img src="BRAKER/f8.png" alt="braker2-main-a[fig1]" style="zoom:50%;" /><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># --gth2traingenes</span><br>braker.pl --genome genome.fa --prot_seq prot.fa --prg gth --bam RNAseq.bam \<br>    --gth2traingenes --softmasking --cores N<br></code></pre></td></tr></table></figure><p>This test is implemented in <code>test6.sh</code>, expected runtime is ~20 minutes.</p><h2 id="Testing-BRAKER-with-pre-trained-parameters"><a href="#Testing-BRAKER-with-pre-trained-parameters" class="headerlink" title="Testing BRAKER with pre-trained parameters"></a>Testing BRAKER with pre-trained parameters</h2><p>The training step of all pipelines can be skipped with the option <code>--skipAllTraining</code>. This means, <font color="red"><strong>only AUGUSTUS predictions</strong> will be <strong>performed</strong></font>, using pre-trained, already existing parameters. For example, you can predict genes with the command:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span>=genome<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--bam</span> RNAseq<span class="hljs-selector-class">.bam</span> <span class="hljs-attr">--species</span>=arabidopsis \<br>    <span class="hljs-attr">--skipAllTraining</span> <span class="hljs-attr">--softmasking</span> <span class="hljs-attr">--cores</span> N<br></code></pre></td></tr></table></figure><p>This test is implemented in <code>test7.sh</code>, expected runtime is ~1 minute.</p><h2 id="Testing-BRAKER-with-genome-sequence"><a href="#Testing-BRAKER-with-genome-sequence" class="headerlink" title="Testing BRAKER with genome sequence"></a>Testing BRAKER with genome sequence</h2><p>The following command will run the pipeline with <strong>no extrinsic evidence</strong>:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span>=genome<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--esmode</span> <span class="hljs-attr">--softmasking</span> <span class="hljs-attr">--cores</span> N<br></code></pre></td></tr></table></figure><p>This test is implemented in <code>test8.sh</code>, expected runtime is ~20 minutes.</p><h2 id="Testing-BRAKER-with-RNA-Seq-data-and-â€“UTR-x3D-on"><a href="#Testing-BRAKER-with-RNA-Seq-data-and-â€“UTR-x3D-on" class="headerlink" title="Testing BRAKER with RNA-Seq data and â€“UTR&#x3D;on"></a>Testing BRAKER with RNA-Seq data and â€“UTR&#x3D;on</h2><p>The following command will run BRAKER with <strong><font color="red">training</font> UTR parameters from RNA-Seq coverage data</strong>:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span> genome<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--bam</span> RNAseq<span class="hljs-selector-class">.bam</span> <span class="hljs-attr">--softmasking</span> <span class="hljs-attr">--UTR</span>=on <span class="hljs-attr">--cores</span> N<br></code></pre></td></tr></table></figure><p>This test is implemented in <code>test9.sh</code>, expected runtime is ~20 minutes.</p><h2 id="Testing-BRAKER-with-RNA-Seq-data-and-â€“addUTR-x3D-on"><a href="#Testing-BRAKER-with-RNA-Seq-data-and-â€“addUTR-x3D-on" class="headerlink" title="Testing BRAKER with RNA-Seq data and â€“addUTR&#x3D;on"></a>Testing BRAKER with RNA-Seq data and â€“addUTR&#x3D;on</h2><p>The following command will <strong><font color="red">add[ no training]</font> UTRs to augustus.hints.gtf from RNA-Seq coverage data</strong>:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">braker<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span> genome<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--bam</span> RNAseq<span class="hljs-selector-class">.bam</span> <span class="hljs-attr">--softmasking</span> <span class="hljs-attr">--addUTR</span>=on <span class="hljs-attr">--cores</span> N<br></code></pre></td></tr></table></figure><p>This test is implemented in <code>test10.sh</code>, expected runtime is ~20 minutes.</p><h1 id="Starting-BRAKER-on-the-basis-of-previously-existing-BRAKER-runs"><a href="#Starting-BRAKER-on-the-basis-of-previously-existing-BRAKER-runs" class="headerlink" title="Starting BRAKER on the basis of previously existing BRAKER runs"></a>Starting BRAKER on the basis of previously existing BRAKER runs</h1><p>There is currently no clean way to restart a failed BRAKER run (after solving some problem). However, it is possible to start a new BRAKER run based on results from a previous run â€“ given that the old run produced the required intermediate results. We will in the following refer to the old working directory with variable <code>$&#123;BRAKER_OLD&#125;</code>, and to the new BRAKER working directory with <code>$&#123;BRAKER_NEW&#125;</code>. The file <code>what-to-cite.txt</code> will always only refer to the software that was actually called by a particular run. You might have to combine the contents of <code>$&#123;BRAKER_NEW&#125;/what-to-cite.txt</code> with <code>$&#123;BRAKER_OLD&#125;/what-to-cite.txt</code> for preparing a publication. The following figure illustrates at which points BRAKER run may be intercepted.</p><img src="BRAKER/f10.png" alt="braker2-main-a[fig1]" style="zoom:50%;" /><p>Figure 10: Points for intercepting a BRAKER run and reusing intermediate results in a new BRAKER run.</p><h2 id="Option-1-starting-BRAKER-with-existing-hints-file-s-before-training-my-opo-hints-file-generated-before-GeneMark-and-Aug"><a href="#Option-1-starting-BRAKER-with-existing-hints-file-s-before-training-my-opo-hints-file-generated-before-GeneMark-and-Aug" class="headerlink" title="Option 1: starting BRAKER with existing hints file(s) before training[my opo:hints file generated before GeneMark and Aug]"></a>Option 1: starting BRAKER with existing hints file(s) before training[my opo:hints file generated before GeneMark and Aug]</h2><p>If you have access to an existing BRAKER output that contains <strong>hintsfiles</strong> that were <strong>generated from</strong> extrinsic data, such as <strong>RNA</strong>-Seq or <strong>protein</strong> sequences, you can <strong>recycle these hints files in a new BRAKER run</strong>. Also, <strong>hints from a separate ProtHint run</strong> can be <strong>directly used in BRAKER</strong>.</p><p>The hints can be given to BRAKER with <font color="red"><strong>â€“hints ${BRAKER_OLD}&#x2F;hintsfile.gff</strong></font> option. This is illustrated in the test files <code>test1_restart1.sh</code>, <code>test2_restart1.sh</code>, <code>test3_restart1.sh</code>, <code>test5_restart1.sh</code>, and <code>test7_restart1.sh</code>. The other modes (for which this test is missing) cannot be restarted in this way.</p><h2 id="Option-2-starting-BRAKER-after-GeneMark-EX-had-finished-before-training-AUGUSTUS"><a href="#Option-2-starting-BRAKER-after-GeneMark-EX-had-finished-before-training-AUGUSTUS" class="headerlink" title="Option 2: starting BRAKER after GeneMark-EX had finished, before training AUGUSTUS"></a>Option 2: starting BRAKER after GeneMark-EX had finished, before training AUGUSTUS</h2><p>The GeneMark result can be given to BRAKER with <font color="red"><strong>â€“geneMarkGtf</strong> ${BRAKER_OLD}&#x2F;GeneMark-EX&#x2F;genemark.gtf</font> option. This is illustrated in the test files <code>test1_restart2.sh</code>, <code>test2_restart2.sh</code>, <code>test3_restart2.sh</code>, <code>test5_restart2.sh</code>, and <code>test8_restart2.sh</code>. The other modes (for which this test is missing) cannot be restarted in this way.</p><h2 id="Option-3-starting-BRAKER-after-AUGUSTUS-training"><a href="#Option-3-starting-BRAKER-after-AUGUSTUS-training" class="headerlink" title="Option 3: starting BRAKER after AUGUSTUS training"></a>Option 3: starting BRAKER after AUGUSTUS training</h2><p>The trained species parameters for AGUSTUS can be passed with <font color="red"><strong>â€“skipAllTraining and â€“species $speciesName</strong></font> options. This is illustrated in <code>test*_restart3.sh</code> files.</p><p>My opo: each training creat a new dir, can be use again.</p><h1 id="Bug-reporting"><a href="#Bug-reporting" class="headerlink" title="Bug reporting"></a>Bug reporting</h1><p>Before reporting bugs, please check that you are using the most recent versions of GeneMark-EX, AUGUSTUS and BRAKER. Also, check the list of <a href="https://github.com/Gaius-Augustus/BRAKER#common-problems">Common problems</a>, and the Issue list on GitHub before reporting bugs. We do monitor open issues on GitHub. Sometimes, we are unable to help you, immediately, but we try hard to solve your problems.</p><h2 id="Reporting-bugs-on-GitHub"><a href="#Reporting-bugs-on-GitHub" class="headerlink" title="Reporting bugs on GitHub"></a>Reporting bugs on GitHub</h2><p>If you found a bug, please open an issue at <a href="https://github.com/Gaius-Augustus/BRAKER/issues">https://github.com/Gaius-Augustus/BRAKER/issues</a> (or contact <a href="mailto:&#107;&#x61;&#x74;&#104;&#97;&#x72;&#105;&#x6e;&#97;&#46;&#x68;&#111;&#x66;&#x66;&#64;&#117;&#x6e;&#x69;&#x2d;&#x67;&#114;&#101;&#x69;&#102;&#x73;&#119;&#x61;&#108;&#x64;&#x2e;&#100;&#101;">&#107;&#x61;&#x74;&#104;&#97;&#x72;&#105;&#x6e;&#97;&#46;&#x68;&#111;&#x66;&#x66;&#64;&#117;&#x6e;&#x69;&#x2d;&#x67;&#114;&#101;&#x69;&#102;&#x73;&#119;&#x61;&#108;&#x64;&#x2e;&#100;&#101;</a> or <a href="mailto:&#98;&#x72;&#117;&#x6e;&#97;&#x2e;&#x74;&#111;&#109;&#97;&#115;&#x40;&#x67;&#97;&#116;&#101;&#99;&#x68;&#x2e;&#x65;&#100;&#117;">&#98;&#x72;&#117;&#x6e;&#97;&#x2e;&#x74;&#111;&#109;&#97;&#115;&#x40;&#x67;&#97;&#116;&#101;&#99;&#x68;&#x2e;&#x65;&#100;&#117;</a>).</p><p>Information worth mentioning in your bug report:</p><p>Check in <code>braker/yourSpecies/braker.log</code> at which step <code>braker.pl</code> crashed.</p><p>There are a number of other files that might be of interest, depending on where in the pipeline the problem occurred. Some of the following files will not be present if they did not contain any <strong>errors</strong>.</p><ul><li><code>braker/yourSpecies/errors/bam2hints.*.stderr</code> - will give details on a bam2hints crash (<strong>step for converting bam file to intron gff file</strong>)</li><li><code>braker/yourSpecies/hintsfile.gff</code> - is this file empty? If yes, something went wrong during hints generation - does this file contain hints from source â€œ<strong>b2h</strong>â€ and of type â€œ<strong>intron</strong>â€? If not: <strong>GeneMark-ET</strong>(RNA) will not be able to <strong>execute</strong> properly. Conversely, <strong>GeneMark-EP+</strong>(pro) will not be able to execute correctly if hints from the source â€œ<strong>ProtHint</strong>â€œ are missing.</li><li><code>braker/yourSpecies/(align_gthalign_exoneratealign_spaln)/*err</code> - <strong>errors reported by the alignment tools gth&#x2F;exonerate&#x2F;spaln</strong></li><li><code>braker/yourSpecies/errors/GeneMark-&#123;ET,EP&#125;.stderr</code> - <strong>errors reported by GeneMark-ET&#x2F;EP+</strong></li><li><code>braker/yourSpecies/errors/GeneMark-&#123;ET,EP).stdout</code> - may give clues about the point at <strong>which errors in GeneMark-ET&#x2F;EP+ occured</strong></li><li><code>braker/yourSpecies/GeneMark-&#123;ET,EP&#125;/genemark.gtf</code> - is this file empty? If yes, something went wrong during executing GeneMark-ET&#x2F;EP+ <strong>My is gene mark_hintsfile.gff? no ,in GeneMark-ET</strong></li><li><code>braker/yourSpecies/GeneMark-&#123;ET,EP&#125;/genemark.f.good.gtf</code> - is this file empty? If yes, something went wrong during <font color="red"><strong>filtering GeneMark-ET&#x2F;EP+ genes for training AUGUSTUS no??</strong></font></li><li><code>braker/yourSpecies/genbank.good.gb</code> - try a â€œgrep -c LOCUS genbank.good.gbâ€ to determine the number of training genes for training AUGUSTUS, should not be low. <font color="red"><strong>no??</strong></font></li><li><code>braker/yourSpecies/errors/firstetraining.stderr</code> - contains errors from first iteration of training AUGUSTUS</li><li><code>braker/yourSpecies/errors/secondetraining.stderr</code> - contains errors from second iteration of training AUGUSTUS</li><li><code>braker/yourSpecies/errors/optimize_augustus.stderr</code> - contains errors <strong>optimize_augustus.pl</strong> (<strong>additional training set for AUGUSTUS</strong>)</li><li><code>braker/yourSpecies/errors/augustus*.stderr</code> - contain <strong>AUGUSTUS execution</strong> errors</li><li><code>braker/yourSpecies/startAlign.stderr</code> - if you provided a protein fasta file and <code>--prg</code> option and this file is not empty, something went <strong>wrong</strong> during <strong>protein alignment</strong></li><li><code>braker/yourSpecies/startAlign.stdout</code> - may give clues on at which point protein alignment went wrong</li></ul><h2 id="Common-problems"><a href="#Common-problems" class="headerlink" title="Common problems"></a>Common problems</h2><ul><li><p><em>BRAKER complains that the RNA-Seq file does not correspond to the provided genome file, but I am sure the files correspond to each other!</em></p><p>Please check the headers of the genome FASTA file. If the headers are long and contain whitespaces, some RNA-Seq alignment tools will truncate sequence names in the BAM file. This leads to an error with BRAKER. Solution: shorten&#x2F;simplify FASTA headers in the genome file before running the RNA-Seq alignment and BRAKER.</p></li><li><p><em>There are duplicate Loci in the train.gb file (after using GenomeThreader)!</em></p><p>This issue arises if outdated versions of AUGUSTUS and BRAKER are used. Solution: Please update AUGUSTUS and BRAKER from github (<a href="https://github.com/Gaius-Augustus/Augustus">https://github.com/Gaius-Augustus/Augustus</a>, <a href="https://github.com/Gaius-Augustus/BRAKER">https://github.com/Gaius-Augustus/BRAKER</a>).</p></li><li><p><em>GeneMark fails!</em></p><p>(a) GeneMark requires a valid hidden key file in your home directory (<code>~/.gm_key</code>). The file expires after 200 days. Please check whether you have a valid key file before reporting an issue about this. Also, BRAKER may issue a WARNING that GeneMark is likely going to fail due to limited extrinsic evidence. If you see that warning, please donâ€™t open an issue but try a different approach towards annotating your genome. For example, you can add more evidence data, you can try the protein mapping pipeline approach, you can try running <code>--esmode</code> without extrinsic evidence, â€¦</p><p>(b) GeneMark by default only uses contigs longer than 50k for training. If you have a highly fragmented assembly, this might lead to â€œno dataâ€ for training. You can override the default minimal length by setting the BRAKER argument <code>--min_contig=10000</code>.</p><p>(c) see â€œ[something] failed to executeâ€ below.</p></li><li><p><em>[something] failed to execute!</em></p><p>When providing paths to software to BRAKER, please use absolute, non-abbreviated paths. For example, BRAKER might have problems with <code>--SAMTOOLS_PATH=./samtools/</code> or <code>--SAMTOOLS_PATH=~/samtools/</code>. Please use <code>SAMTOOLS_PATH=/full/absolute/path/to/samtools/</code>, instead. This applies to all path specifications as command line options to <code>braker.pl</code>. Relative paths and absolute paths will not pose problems if you export a bash variable, instead, or if you append the location of tools to your $PATH variable.</p></li><li><p><em>BRAKER cannot find the Augustus script XYZâ€¦</em></p><p>Update Augustus from github with <code>git clone https://github.com/Gaius-Augustus/Augustus.git</code>. Do not use Augustus from other sources. BRAKER is highly dependent on an up-to-date Augustus. Augustus releases happen rather rarely, updates to the Augustus scripts folder occur rather frequently.</p></li><li><p><em>Does BRAKER depend on Python3?</em></p><p>It does. The python scripts employed by BRAKER are not compatible with Python2.</p></li><li><p><em>Why does BRAKER predict more genes than I expected?</em></p><p>If transposable elements (or similar) have not been masked appropriately, AUGUSTUS tends to predict those elements as protein coding genes. This can lead to a huge number genes. You can check whether this is the case for your project by BLASTing (or DIAMONDing) the predicted protein sequences against themselves (all vs. all) and counting how many of the proteins have a high number of high quality matches. You can use the output of this analysis to divide your gene set into two groups: the protein coding genes that you want to find and the repetitive elements that were additionally predicted.</p></li><li><p><em>I am running BRAKER in Anaconda and something failsâ€¦</em></p><p>Update AUGUSTUS and BRAKER from github with <code>git clone https://github.com/Gaius-Augustus/Augustus.git</code> and <code>git clone https://github.com/Gaius-Augustus/BRAKER.git</code>. The Anaconda installation is great, but it relies on releases of AUGUSTUS and BRAKER - which are often lagging behind. Please use the current GitHub code, instead.</p></li></ul><h1 id="Citing-BRAKER-and-software-called-by-BRAKER"><a href="#Citing-BRAKER-and-software-called-by-BRAKER" class="headerlink" title="Citing BRAKER and software called by BRAKER"></a>Citing BRAKER and software called by BRAKER</h1><p>Since BRAKER is a pipeline that calls several Bioinformatics tools, publication of results obtained by BRAKER requires that not only BRAKER is cited, but also the tools that are called by BRAKER. BRAKER will output a file <code>what-to-cite.txt</code> in the BRAKER working directory, informing you about which exact sources apply to your run.</p><ul><li>Always cite:<ul><li>Bruna, T., Hoff, K.J., Lomsadze, A., Stanke, M., &amp; Borodovsky, M. (2021). BRAKER2: Automatic Eukaryotic Genome Annotation with GeneMark-EP+ and AUGUSTUS Supported by a Protein Database. NAR Genomics and Bioinformatics 3(1):lqaa108, doi: 10.1093&#x2F;nargab&#x2F;lqaa108.</li><li>Hoff, K.J., Lomsadze, A., Borodovsky, M. and Stanke, M. (2019). Whole-Genome Annotation with BRAKER. Methods Mol Biol. 1962:65-95, doi: 10.1007&#x2F;978-1-4939-9173-0_5.</li><li>Hoff, K.J., Lange, S., Lomsadze, A., Borodovsky, M. and Stanke, M. (2016). BRAKER1: unsupervised RNA-Seq-based genome annotation with GeneMark-ET and AUGUSTUS. Bioinformatics, 32(5):767-769.</li><li>Stanke, M., Diekhans, M., Baertsch, R. and Haussler, D. (2008). Using native and syntenically mapped cDNA alignments to improve de novo gene finding. Bioinformatics, doi: 10.1093&#x2F;bioinformatics&#x2F;btn013.</li><li>Stanke. M., SchÃ¶ffmann, O., Morgenstern, B. and Waack, S. (2006). Gene prediction in eukaryotes with a generalized hidden Markov model that uses hints from external sources. BMC Bioinformatics 7, 62.</li></ul></li><li>If any kind of AUGUSTUS training was performed by BRAKER, check carefully whether you configured BRAKER to use NCBI BLAST or DIAMOND. One of them was used to filter out redundant training gene structures.<ul><li>If you used NCBI BLAST, please cite:<ul><li>Altschul, A.F., Gish, W., Miller, W., Myers, E.W. and Lipman, D.J. (1990). A basic local alignment search tool. J Mol Biol 215:403â€“410.</li><li>Camacho, C., Coulouris, G., Avagyan, V., Ma, N., Papadopoulos, J., Bealer, K., and Madden, T.L. (2009). Blast+: architecture and applications. BMC bioinformatics, 10(1):421.</li></ul></li><li>If you used DIAMOND, please cite:<ul><li>Buchfink, B., Xie, C., Huson, D.H. (2015). Fast and sensitive protein alignment using DIAMOND. Nature Methods 12:59-60.</li></ul></li></ul></li><li>If BRAKER was executed with a genome file and no extrinsic evidence, cite, then GeneMark-ES was used, cite:<ul><li>Lomsadze, A., Ter-Hovhannisyan, V., Chernoff, Y.O. and Borodovsky, M. (2005). Gene identification in novel eukaryotic genomes by self-training algorithm. Nucleic Acids Research, 33(20):6494â€“6506.</li><li>Ter-Hovhannisyan, V., Lomsadze, A., Chernoff, Y.O. and Borodovsky, M. (2008). Gene prediction in novel fungal genomes using an ab initio algorithm with unsupervised training. Genome research, pages grâ€“081612, 2008.</li></ul></li><li>If BRAKER was run with proteins of any phylogenetic distance (â€“epmode or â€“etpmode), please cite all tools that are used by the ProtHint pipeline to generate hints:<ul><li>Bruna, T., Lomsadze, A., &amp; Borodovsky, M. (2020). GeneMark-EP+: eukaryotic gene prediction with self-training in the space of genes and proteins. NAR Genomics and Bioinformatics, 2(2), lqaa026.</li><li>Buchfink, B., Xie, C., Huson, D.H. (2015). Fast and sensitive protein alignment using DIAMOND. Nature Methods 12:59-60.</li><li>Lomsadze, A., Ter-Hovhannisyan, V., Chernoff, Y.O. and Borodovsky, M. (2005). Gene identification in novel eukaryotic genomes by self-training algorithm. Nucleic Acids Research, 33(20):6494â€“6506.</li><li>Iwata, H., and Gotoh, O. (2012). Benchmarking spliced alignment programs including Spaln2, an extended version of Spaln that incorporates additional species-specific features. Nucleic acids research, 40(20), e161-e161.</li><li>Gotoh, O., Morita, M., Nelson, D. R. (2014). Assessment and refinement of eukaryotic gene structure prediction with gene-structure-aware multiple protein sequence alignment. BMC bioinformatics, 15(1), 189.</li></ul></li><li>If BRAKER was executed with RNA-Seq alignments in bam-format, then SAMtools was used, cite:<ul><li>Li, H., Handsaker, B., Wysoker, A., Fennell, T., Ruan, J., Homer, N., Marth, G., Abecasis, G., Durbin, R.; 1000 Genome Project Data Processing Subgroup (2009). The Sequence Alignment&#x2F;Map format and SAMtools. Bioinformatics, 25(16):2078-9.</li><li>Barnett, D.W., Garrison, E.K., Quinlan, A.R., StrÃ¶mberg, M.P. and Marth G.T. (2011). BamTools: a C++ API and toolkit for analyzing and managing BAM files. Bioinformatics, 27(12):1691-2</li></ul></li><li>If BRAKER used RNA-Seq alignments for generating a training gene set, cite GeneMark-ET:<ul><li>Lomsadze, A., Paul D.B., and Mark B. (2014) Integration of Mapped Rna-Seq Reads into Automatic Training of Eukaryotic Gene Finding Algorithm. Nucleic Acids Research 42(15): e119â€“e119</li></ul></li><li>If BRAKER was executed with proteins of closely related species, cite GenomeThreader:<ul><li>Gremme, G. (2013). Computational Gene Structure Prediction. PhD thesis, UniversitÃ¤t Hamburg.</li></ul></li><li>If BRAKER called MakeHub for creating a track data hub for visualization of BRAKER results with the UCSC Genome Browser, cite:<ul><li>Hoff, K.J. (2019) MakeHub: Fully automated generation of UCSC Genome Browser Assembly Hubs. Genomics, Proteomics and Bioinformatics, in press 2020, preprint on bioarXive, doi: <a href="https://doi.org/10.1101/550145">https://doi.org/10.1101/550145</a>.</li></ul></li><li>If BRAKER called GUSHR for generating UTRs, cite:<ul><li>Keilwagen, J., Hartung, F., Grau, J. (2019) GeMoMa: Homology-based gene prediction utilizing intron position conservation and RNA-seq data. Methods Mol Biol. 1962:161-177, doi: 10.1007&#x2F;978-1-4939-9173-0_9.</li><li>Keilwagen, J., Wenk, M., Erickson, J.L., Schattat, M.H., Grau, J., Hartung F. (2016) Using intron position conservation for homology-based gene prediction. Nucleic Acids Research, 44(9):e89.</li><li>Keilwagen, J., Hartung, F., Paulini, M., Twardziok, S.O., Grau, J. (2018) Combining RNA-seq data and homology-based gene prediction for plants, animals and fungi. BMC Bioinformatics, 19(1):189.</li></ul></li></ul><h1 id="License"><a href="#License" class="headerlink" title="License"></a>License</h1><p>All source code, i.e. <code>scripts/*.pl</code> or <code>scripts/*.py</code> are under the Artistic License (see <a href="http://www.opensource.org/licenses/artistic-license.php">http://www.opensource.org/licenses/artistic-license.php</a>).</p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><hr><h1 id="TSEBRA"><a href="#TSEBRA" class="headerlink" title="TSEBRA"></a>TSEBRA</h1><p><a href="https://github.com/Gaius-Augustus/TSEBRA">https://github.com/Gaius-Augustus/TSEBRA</a></p><h1 id="TSEBRA-Transcript-Selector-for-BRAKER"><a href="#TSEBRA-Transcript-Selector-for-BRAKER" class="headerlink" title="TSEBRA: Transcript Selector for BRAKER"></a>TSEBRA: Transcript Selector for BRAKER</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><a href="https://doi.org/10.1186/s12859-021-04482-0">TSEBRA</a> is a combiner tool that <font color="blue">selects transcripts from gene predictions</font> based on the support by extrisic evidence in form of <font color="blue">introns and start&#x2F;stop codons</font>. It was developed to combine BRAKER1<a href="https://github.com/Gaius-Augustus/TSEBRA#ref1">1</a> and BRAKER2<a href="https://github.com/Gaius-Augustus/TSEBRA#ref2">2</a>predicitons to increase their accuracies.</p><h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><p>Python 3.5.2 or higher is required.</p><h2 id="Installation-1"><a href="#Installation-1" class="headerlink" title="Installation"></a>Installation</h2><p>Download TSEBRA:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/Gaius-Augustus/</span>TSEBRA<br></code></pre></td></tr></table></figure><h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><p>The main script is <code>./bin/tsebra.py</code>. For usage information run <code>./bin/tsebra.py --help</code>.</p><h2 id="Input-Files"><a href="#Input-Files" class="headerlink" title="Input Files"></a>Input Files</h2><p>TSEBRA takes a list of <font color="blue">gene prediciton files</font>, a list of <font color="blue">hintfiles</font> and a <font color="blue">configuration file</font> as mandatory input.</p><h4 id="1-Gene-Predictions"><a href="#1-Gene-Predictions" class="headerlink" title="1 Gene Predictions"></a>1 Gene Predictions</h4><p>The gene prediction files have to be in <font color="blue">gtf format</font>. This is the standard output format of a BRAKER or AUGUSTUS<a href="https://github.com/Gaius-Augustus/TSEBRA#ref3">3,</a><a href="https://github.com/Gaius-Augustus/TSEBRA#ref4">4</a> gene prediciton.</p><p>Example:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2L</span>      AUGUSTUS        gene    <span class="hljs-number">83268</span>   <span class="hljs-number">87026</span>   <span class="hljs-number">0</span>.<span class="hljs-number">88</span>    -       .       g5332<br><span class="hljs-attribute">2L</span>      AUGUSTUS        transcript      <span class="hljs-number">83268</span>   <span class="hljs-number">87026</span>   <span class="hljs-number">0</span>.<span class="hljs-number">88</span>    -       .       g5332.t1<br><span class="hljs-attribute">2L</span>      AUGUSTUS        intron  <span class="hljs-number">84278</span>   <span class="hljs-number">87019</span>   <span class="hljs-number">1</span>       -       .       transcript_id <span class="hljs-string">&quot;file_1_file_1_g5332.t1&quot;</span>; gene_id <span class="hljs-string">&quot;file_1_file_1_g5332&quot;</span>;<br><span class="hljs-attribute">2L</span>      AUGUSTUS        CDS     <span class="hljs-number">87020</span>   <span class="hljs-number">87026</span>   <span class="hljs-number">0</span>.<span class="hljs-number">88</span>    -       <span class="hljs-number">0</span>       transcript_id <span class="hljs-string">&quot;file_1_file_1_g5332.t1&quot;</span>; gene_id <span class="hljs-string">&quot;file_1_file_1_g5332&quot;</span>;<br><span class="hljs-attribute">2L</span>      AUGUSTUS        exon    <span class="hljs-number">87020</span>   <span class="hljs-number">87026</span>   .       -       .       transcript_id <span class="hljs-string">&quot;file_1_file_1_g5332.t1&quot;</span>; gene_id <span class="hljs-string">&quot;file_1_file_1_g5332&quot;</span>;<br></code></pre></td></tr></table></figure><h4 id="2-Hint-Files"><a href="#2-Hint-Files" class="headerlink" title="2 Hint Files"></a>2 Hint Files</h4><p>The hints files have to be in <font color="blue">gff format</font>, the last column must include an attribute for <font color="blue">the source for the hint with <strong>â€˜src&#x3D;â€™</strong></font> and can include <font color="blue">the number of hints supporting the gene structure segment with <strong>â€˜mult&#x3D;â€™</strong></font>. This is the standard file format of the <code>hintsfile.gff</code> in a BRAKER working directory.</p><p>Example:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2L</span>      ProtHint        intron  <span class="hljs-number">279806</span>  <span class="hljs-number">279869</span>  <span class="hljs-number">2</span>       +       .       src=P;mult=<span class="hljs-number">25</span>;pri=<span class="hljs-number">4</span>;al_score=<span class="hljs-number">0</span>.<span class="hljs-number">437399</span>;<br><span class="hljs-attribute">2L</span>      ProtHint        intron  <span class="hljs-number">275252</span>  <span class="hljs-number">275318</span>  <span class="hljs-number">2</span>       -       .       src=P;mult=<span class="hljs-number">19</span>;pri=<span class="hljs-number">4</span>;al_score=<span class="hljs-number">0</span>.<span class="hljs-number">430006</span>;<br><span class="hljs-attribute">2L</span>      ProtHint        stop    <span class="hljs-number">293000</span>  <span class="hljs-number">293002</span>  <span class="hljs-number">1</span>       +       <span class="hljs-number">0</span>       grp=<span class="hljs-number">7220</span>_0:<span class="hljs-number">002</span>b08_g42;src=C;pri=<span class="hljs-number">4</span>;<br><span class="hljs-attribute">2L</span>      ProtHint        intron  <span class="hljs-number">207632</span>  <span class="hljs-number">207710</span>  <span class="hljs-number">1</span>       +       .       grp=<span class="hljs-number">7220</span>_0:<span class="hljs-number">002</span>afa_g26;src=C;pri=<span class="hljs-number">4</span>;<br><span class="hljs-attribute">2L</span>      ProtHint        start   <span class="hljs-number">207512</span>  <span class="hljs-number">207514</span>  <span class="hljs-number">1</span>       +       <span class="hljs-number">0</span>       grp=<span class="hljs-number">7220</span>_0:<span class="hljs-number">002</span>afa_g26;src=C;pri=<span class="hljs-number">4</span>;<br></code></pre></td></tr></table></figure><h4 id="3-Configuration-File"><a href="#3-Configuration-File" class="headerlink" title="3 Configuration File"></a>3 Configuration File</h4><p>The configuration file has to include three different sets of parameter:</p><ol><li><p>Weights for <font color="blue">all sources of hints</font>. The source of a hint is specified by the mandatory â€˜src&#x3D;â€™ attribute in the last column of the <code>hintsfile.gff</code> (see section â€˜Hint Filesâ€™). See section â€˜Transcript scoresâ€™ in <a href="https://doi.org/10.1101/2021.06.07.447316">TSEBRA</a> for more information on how these weigths are used.<br>A weight is set to 1, if the weight for a hint source is not specified in the configuration file.</p><ul><li><p><em>Notes on adjusting these parameters: Increase the weight of the hint sources that have the highest quality. For example, if the protein database includes only species that are remotely related to the target species, the hints produced by BRAKER2 might be less accurate than the RNA-seq evidence. Then, you should increase the weight of the source related to the RNA-seq hints.</em></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-comment"># src weights</span><br>P <span class="hljs-number">0.1</span><br>E <span class="hljs-number">10</span><br>C <span class="hljs-number">5</span><br><span class="hljs-comment"># Eè®¾ç½®10ï¼ŒCè®¾ç½®5ï¼Œ8ï¼Œ10æ²¡åŒºåˆ«ï¼Ÿï¼Ÿï¼Ÿ</span><br>M <span class="hljs-number">1</span><br><br>E = RNA-seq hints<br>M = manual hints, these are hints that are enforced during <span class="hljs-keyword">the</span> prediction step <span class="hljs-keyword">of</span> BRAKER,   æ‰‹åŠ¨å¼ºåˆ¶é¢„æµ‹ã€‚<br>C = protein hints <span class="hljs-built_in">from</span> proteins <span class="hljs-keyword">with</span> <span class="hljs-keyword">a</span> <span class="hljs-string">&#x27;high&#x27;</span> spliced alignment score.<br>P = protein hints <span class="hljs-built_in">from</span> proteins that have <span class="hljs-keyword">a</span> <span class="hljs-string">&#x27;good&#x27;</span> spliced alignment score, <br>     but that is <span class="hljs-built_in">lower</span> than <span class="hljs-keyword">the</span> score <span class="hljs-built_in">from</span> <span class="hljs-keyword">the</span> ones <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;C&#x27;</span>. <br></code></pre></td></tr></table></figure></li></ul></li><li><p>Required fractions of <strong>supported introns</strong> or <strong>supported start&#x2F;stop-codons</strong> for a transcript. A transcript is not included in the TSEBRA result if the fractions of introns and start&#x2F;stop codons supported by extrinsic evidence are lower than the thresholds.</p><ul><li><p><em>Notes on adjusting these parameters: The low evidence support thresholds for low evidence support are quite strict in the default configuration file. In this configuration, <strong>only transcripts with very high evidence support are allowed in the TSBERA result</strong>. In some cases, the default setting might be too strict, so that too many transcripts are filtered out. In this case, you should reduce the threshold of â€˜intron_supportâ€™ (e.g., to 0.2).</em></p></li><li><p>Transcript scores: Likely exon-intron borders are inferred from the alignments to create intron hints. The start and stop codons of the protein alignments are used to create start and stop codon hints, respectively. The transcript scores utilize them to quantify the support of the transcript structure.</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># Low evidence support</span><br><span class="hljs-attribute">intron_support</span> <span class="hljs-number">0</span>.<span class="hljs-number">75</span><br><span class="hljs-attribute">stasto_support</span> <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure></li></ul></li><li><p>Allowed difference between two overlapping transcripts for the four transcript scores (see section â€˜Transcript scoresâ€™ in <a href="https://doi.org/10.1101/2021.06.07.447316">TSEBRA</a> for a definition of the different transcript scores and section â€˜Pairwise transcript comparison ruleâ€™ for more information on how transcripts are compared). TSEBRA compares transcripts via their transcript scores and removes the one with the lower score if their difference exceeds the respective threshold.<br>Note that e_1, e_2 are fractions (e_1, e_2 âˆŠ [0,1]), and e_3, e_4 can be larger than 1 (e_3, e_4 â‰¥ 0).</p><ul><li><p><em>Notes on adjusting these parameters: The higher the thresholds are set the less transcripts are filtered by the respective rule. With these thresholds one can adjust the effect of each filtering rule of TSEBRA. As these thresholds are increased, more transcripts are included in the TSEBRA result, in particular, more alternatively spliced isoforms per gene are contained in the result.</em></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># Allowed difference for each feature </span><br><span class="hljs-comment"># Values have to be in [0,1]</span><br><span class="hljs-attribute">e_1</span> <span class="hljs-number">0</span><br><span class="hljs-attribute">e_2</span> <span class="hljs-number">0</span>.<span class="hljs-number">5</span><br><span class="hljs-comment"># Values have to be &gt;0</span><br><span class="hljs-attribute">e_3</span> <span class="hljs-number">25</span><br><span class="hljs-attribute">e_4</span> <span class="hljs-number">10</span><br></code></pre></td></tr></table></figure></li></ul></li></ol><p>The name and the value of a parameter are separated by a space, and each parameter is listed in a different line.<br>Example:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># src weights</span><br><span class="hljs-attribute">P</span> <span class="hljs-number">0</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">E</span> <span class="hljs-number">10</span><br><span class="hljs-attribute">C</span> <span class="hljs-number">5</span><br><span class="hljs-attribute">M</span> <span class="hljs-number">1</span><br><span class="hljs-comment"># Low evidence support</span><br><span class="hljs-attribute">intron_support</span> <span class="hljs-number">0</span>.<span class="hljs-number">75</span><br><span class="hljs-attribute">stasto_support</span> <span class="hljs-number">1</span><br><span class="hljs-comment"># Feature differences</span><br><span class="hljs-attribute">e_1</span> <span class="hljs-number">0</span><br><span class="hljs-attribute">e_2</span> <span class="hljs-number">0</span>.<span class="hljs-number">5</span><br><span class="hljs-attribute">e_3</span> <span class="hljs-number">25</span><br><span class="hljs-attribute">e_4</span> <span class="hljs-number">10</span><br></code></pre></td></tr></table></figure><p>Description of evidence sources in default BRAKER1 and BRAKER2 outputs:</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">E = RNA-seq hints<br>M = manual hints, these are hints that are enforced during <span class="hljs-keyword">the</span> prediction step <span class="hljs-keyword">of</span> BRAKER,<br>C = protein hints <span class="hljs-built_in">from</span> proteins <span class="hljs-keyword">with</span> <span class="hljs-keyword">a</span> <span class="hljs-string">&#x27;high&#x27;</span> spliced alignment score.<br>P = protein hints <span class="hljs-built_in">from</span> proteins that have <span class="hljs-keyword">a</span> <span class="hljs-string">&#x27;good&#x27;</span> spliced alignment score, <br>     but that is <span class="hljs-built_in">lower</span> than <span class="hljs-keyword">the</span> score <span class="hljs-built_in">from</span> <span class="hljs-keyword">the</span> ones <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;C&#x27;</span>. <br></code></pre></td></tr></table></figure><h2 id="Use-Case"><a href="#Use-Case" class="headerlink" title="Use Case"></a>Use Case</h2><p>The recommended and most common usage for TSEBRA is to combine the resulting <code>augustus.hints.gtf</code> files of a BRAKER1 and a BRAKER2 run using the hintsfile.gff from both working directories. However, TSEBRA can be applied to any number (&gt;1) of gene predictions and hint files as long as they are in the correct format.</p><p>A common case might be that a user wants to annotate a novel genome with BRAKER and has:</p><ul><li>a novel genome with repeats masked: <code>genome.fasta.masked</code>,</li><li>hints for intron positions from RNA-seq reads<code>rna_seq_hints.gff</code>,</li><li>database of homologous proteins: <code>proteins.fa</code>.</li></ul><ol><li>Run BRAKER1 and BRAKER2 for example with</li></ol><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment">### BRAKER1</span><br>braker.pl <span class="hljs-attribute">--genome</span>=genome.fasta.masked <span class="hljs-attribute">--hints</span>=rna_seq_hints.gff \<br>            --softmasking <span class="hljs-attribute">--species</span>=species_name <span class="hljs-attribute">--workingdir</span>=braker1_out<br><span class="hljs-comment">### BRAKER2</span><br>braker.pl <span class="hljs-attribute">--genome</span>=genome.fasta.masked <span class="hljs-attribute">--prot_seq</span>=proteins.fa \<br>    --softmasking <span class="hljs-attribute">--species</span>=species_name --epmode \<br>    <span class="hljs-attribute">--workingdir</span>=braker2_out<br></code></pre></td></tr></table></figure><ol><li>Combine predicitons with TSEBRA</li></ol><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">./bin/tsebra<span class="hljs-selector-class">.py</span> -g braker1_out/augustus<span class="hljs-selector-class">.hints</span><span class="hljs-selector-class">.gtf</span>,braker2_out/augustus<span class="hljs-selector-class">.hints</span><span class="hljs-selector-class">.gtf</span> -c default<span class="hljs-selector-class">.cfg</span> \<br>    -e braker1_out/hintsfile<span class="hljs-selector-class">.gff</span>,braker2_out/hintsfile<span class="hljs-selector-class">.gff</span> \<br>    -o braker1+<span class="hljs-number">2</span>_combined.gtf<br></code></pre></td></tr></table></figure><p>The combined gene prediciton is <code>braker1+2_combined.gtf</code>.</p><h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><p>A small example is located at <code>example/</code>. Run <code>./example/run_prevco_example.sh</code> to execute the example and to check if TSEBRA runs properly.</p><h2 id="Other-scripts-in-the-TSEBRA-repository"><a href="#Other-scripts-in-the-TSEBRA-repository" class="headerlink" title="Other scripts in the TSEBRA repository"></a>Other scripts in the TSEBRA repository</h2><h3 id="Renaming-transcripts-from-a-TSEBRA-output"><a href="#Renaming-transcripts-from-a-TSEBRA-output" class="headerlink" title="Renaming transcripts from a TSEBRA output"></a>Renaming transcripts from a TSEBRA output</h3><p>The IDs of the transcripts and genes in the TSEBRA output can be renamed such that the gene and transcript ID match. Genes and transcript are numbered consecutively and for example, the second transcript of gene â€œg12â€ has the ID â€œg12.t2â€. If a prefix is set then it will be added before all IDs, for example, the transcript ID is â€œdmel_g12.t2â€ if the prefix is set to â€œdmelâ€. Additionally, a translation table can be produced that provides the mapping from old to new transcript IDs.</p><p>Example for renaming <code>tsebra_result.gtf</code>:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">./bin/rename_gtf<span class="hljs-selector-class">.py</span> <span class="hljs-attr">--gtf</span> tsebra_result<span class="hljs-selector-class">.gtf</span> <span class="hljs-attr">--prefix</span> dmel <span class="hljs-attr">--translation_tab</span> translation<span class="hljs-selector-class">.tab</span> <span class="hljs-attr">--out</span> tsebra_result_renamed.gtf<br></code></pre></td></tr></table></figure><p>The arguments <code>--prefix</code> and <code>--translation_tab</code> are optional.</p><h3 id="Fixing-the-formatting-issue-of-braker-gtf"><a href="#Fixing-the-formatting-issue-of-braker-gtf" class="headerlink" title="Fixing the formatting issue of braker.gtf"></a>Fixing the formatting issue of <code>braker.gtf</code></h3><p>A BRAKER run produces a second complete gene set named <code>braker.gtf</code>, besides the official output <code>augustus.hints.gtf</code>. The <code>braker.gtf</code> is the result of merging <code>augustus.hints.gtf</code> with some â€˜high-confidentsâ€™ genes from the GeneMark prediction. However, the merging process leads to a formatting issue in <code>braker.gtf</code>. A quick fix for this formatting issue is the script <code>fix_gtf_ids.py</code>, e.g.:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">./bin/fix_gtf_ids<span class="hljs-selector-class">.py</span> <span class="hljs-attr">--gtf</span> braker_out/braker<span class="hljs-selector-class">.gtf</span> <span class="hljs-attr">--out</span> braker1_fixed.gtf<br></code></pre></td></tr></table></figure><p>Take note that the <code>braker.gtf</code> and <code>fix_gtf_ids.py</code> havenâ€™t been tested sufficently and there is no guarantee that this gene set is superior to <code>augustus.hints.gtf</code>.</p><h2 id="-1"><a href="#-1" class="headerlink" title=""></a></h2><h1 id="brakeré—®é¢˜"><a href="#brakeré—®é¢˜" class="headerlink" title="brakeré—®é¢˜"></a>brakeré—®é¢˜</h1><p>é¢„æµ‹ç»“æœæ–‡ä»¶braker.gtfä¸­ï¼Œè½¬å½•æœ¬å’ŒåŸºå› IDï¼Œå‰é¢å¯èƒ½ä¼šè‡ªåŠ¨åŠ ä¸Šfile_1_file_1_ï¼Œå¦‚g4417.t1å˜ä¸ºfile_1_file_1_g4417.t1ï¼Œå¯¼è‡´ç”Ÿæˆçš„gffï¼ˆæˆ–è€…ä½ ç”¨å…¶ä»–è½¯ä»¶ï¼Œå¦‚augustusè½¬æ¢è„šæœ¬gtf2gff.plï¼Œå®é™…ä¸Šä½ åœ¨å‚æ•°ä¸­æŒ‡å®šâ€“gff3ï¼Œæµç¨‹è°ƒç”¨çš„ä¹Ÿæ˜¯agustus&#x2F;gtf2gff.plï¼‰è½¬åŒ–å¾—åˆ°çš„gff3æ–‡ä»¶ä¸­æ²¡æœ‰åŸºå› ç‰¹å¾ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ ç”¨çš„ç»“æœæ˜¯braker.gtfï¼Œå«æœ‰è¿™ä¸ªé—®é¢˜ï¼Œå¿…é¡»äººä¸ºå»æ‰ã€‚augustus.hints.*åˆ™æ˜¯æ­£å¸¸ï¼Œç›®å‰æ²¡å‘ç°è¿™ä¸ªé—®é¢˜ã€‚<br><a href="https://www.biostars.org/p/9464353/">https://www.biostars.org/p/9464353/</a></p><p>ç¬¬äºŒä¸ªæ¯”è¾ƒå…³å¿ƒçš„é—®é¢˜æ˜¯ï¼Œbrakeræµç¨‹å‡ºæ¥ä¸€å †ç»“æœï¼Œæˆ‘åˆ°åº•è¯¥ç”¨å“ªä¸ªï¼Ÿè™½ç„¶å®˜ç½‘æœ‰ä¸€äº›è§£é‡Šï¼Œä½†æ€»æœ‰äº›ä¸èƒ½ç†è§£ã€‚<br>å‡ ä¸ªæ¯”è¾ƒå…³é”®çš„ç»“æœï¼š augustus.hints.* æ˜¯AUGUSTUSæœ€ç»ˆè›‹ç™½hintsç»“æœã€‚<br>è€Œbraker.gtf&#x2F;gff3æ˜¯ AUGUSTUSå’ŒGeneMark-EP+é¢„æµ‹ï¼ˆbrakeræµç¨‹ä¸­çš„è›‹ç™½é¢„æµ‹ï¼‰çš„å¹¶é›†ï¼Œå› æ­¤è¯¥ç»“æœæ˜¯é«˜æ•æ„Ÿæ€§ä½ç‰¹å¼‚æ€§ï¼ˆæ›´å¤šåŸºå› è¢«é¢„æµ‹ä»¥åŠæ›´å¤šå‡é˜³æ€§ï¼‰ã€‚<br>æ€»ä½“æ¥è¯´ï¼ŒäºŒè€…ç»“æœæ˜¯ç›¸è¿‘çš„ï¼Œå¦‚æœä¾§é‡äºæ•æ„Ÿæ€§ï¼Œåˆ™ç”¨braker.gtfç»“æœã€‚å¦åˆ™ç”¨augustusã€‚ï¼ˆä¸ªäººå»ºè®®è¿˜æ˜¯ç”¨augustusçš„ç»“æœï¼Œç›¸å½“äºäºŒæ¬¡é¢„æµ‹ï¼‰<br><a href="https://github.com/Gaius-Augustus/BRAKER/issues/194">https://github.com/Gaius-Augustus/BRAKER/issues/194</a></p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>annotation</tag>
      
      <tag>Braker2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MAKER</title>
    <link href="/GeekFocus/2022/04/10/2022-04-10-MAKER-anno/"/>
    <url>/GeekFocus/2022/04/10/2022-04-10-MAKER-anno/</url>
    
    <content type="html"><![CDATA[<h1 id="Genome-annotation-with-Maker"><a href="#Genome-annotation-with-Maker" class="headerlink" title="Genome annotation with Maker"></a><a href="https://training.galaxyproject.org/training-material/topics/genome-annotation/tutorials/annotation-with-maker/tutorial.html">Genome annotation with Maker</a></h1><span id="more"></span><p>Maker is able to annotate both prokaryotes and eukaryotes. It works by <strong>aligning as many evidences as possible along the genome sequence</strong>, and then reconciliating all these signals to determine probable gene structures.</p><p>The evidences can be <strong>transcript or protein sequences</strong> from the <font color="red"><strong>same (or closely related) organism</strong></font>. These sequences can come from <strong>public databases</strong> (like NR or GenBank) or from your <strong>own experimental data</strong> (transcriptome assembly from an RNASeq experiment for example). Maker is also able to <strong>take into account repeated elements</strong>.</p><p>Maker uses <strong>ab-initio predictors</strong> (like <a href="http://bioinf.uni-greifswald.de/augustus/">Augustus</a> or <a href="https://github.com/KorfLab/SNAP">SNAP</a>) to improve its predictions: these software tools are able to make gene structure predictions by analysing only the genome sequence with a <strong>statistical model</strong>.</p><p>In this tutorial you will learn <strong>how to perform a genome annotation</strong>, and <strong>how to evaluate its quality</strong>. You will see how training ab-initio predictors is an important step to produce good results. Finally, you will learn how to use the <a href="http://jbrowse.org/">JBrowse</a> genome browser to visualise the results.</p><p>More information about Maker can be found <a href="http://www.yandell-lab.org/software/maker.html">here</a>.</p><p>This tutorial was inspired by the MAKER Tutorial for <a href="http://weatherby.genetics.utah.edu/MAKER/wiki/index.php/MAKER_Tutorial_for_WGS_Assembly_and_Annotation_Winter_School_2018">WGS Assembly and Annotation Winter School 2018</a>, donâ€™t hesitate to consult it for more information on Maker, and on how to run it with command line.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#install</span><br>ä¸æ˜¯maker/src/bin/maker<br>æ³¨æ„maker/bin/maker<br>ä¸ç”¨conda perl [ç³»ç»Ÿperl]<br><br>tar xf maker-2.31.10.tgz<br><span class="hljs-built_in">cd</span> maker/src<br>perl Build.PL   æ£€æŸ¥ä¾èµ–çš„åº“<br>./Build installdeps<br>./Build installexes<br>./Build install<br>./Build status<br><span class="hljs-built_in">mkdir</span> test01<br><span class="hljs-built_in">cp</span> data/dpp* test01<br><span class="hljs-built_in">cd</span> test01<br>maker -CPL<br><span class="hljs-comment">#MPICC å¤šçº¿ç¨‹ï¼Œæ‰€ç”¨çš„computeréƒ½éœ€è¦ï¼Ÿï¼Ÿï¼Ÿç½‘ç»œå†²çª ã€å·²å®‰è£…</span><br>https://github.com/bioconda/bioconda-recipes/issues/16501<br>ERROR: Could not determine <span class="hljs-keyword">if</span> RepBase is installed<br>ï¼ï¼MASKER checks xxx/RepeatMasker/Libraries/RepeatMaskerLib.embl <span class="hljs-keyword">for</span> Repbase.<br>If you have older versions of Repbase like RMRBSeqs.embl, create symlink <span class="hljs-keyword">in</span> xxx/RepeatMasker/Libraries/. For example, <span class="hljs-built_in">ln</span> -s RMRBSeqs.embl RepeatMaskerLib.embl. But <span class="hljs-keyword">in</span> that <span class="hljs-keyword">case</span>, model_org= should be <span class="hljs-built_in">set</span> to the org that exists <span class="hljs-keyword">in</span> the database, instead of all. CAUTION: I don<span class="hljs-string">&#x27;t know whether the result is reliable enough in this way.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Can&#x27;</span>t locate List/MoreUtils.pm <span class="hljs-keyword">in</span> @INC (@INC contains: <br>conda <span class="hljs-built_in">env</span> install ï¼Œ no conda <span class="hljs-built_in">env</span> no errorï¼Ÿ<br>conda install perl-list-moreutils [<span class="hljs-built_in">link</span>](https://www.biostars.org/p/278249/)<br></code></pre></td></tr></table></figure><h2 id="éœ€è¦çš„è¾“å…¥æ–‡ä»¶"><a href="#éœ€è¦çš„è¾“å…¥æ–‡ä»¶" class="headerlink" title="éœ€è¦çš„è¾“å…¥æ–‡ä»¶"></a>éœ€è¦çš„è¾“å…¥æ–‡ä»¶</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs sh">-1. ã€genome.fastaã€‘<br>    åŸºå› ç»„åºåˆ—æ–‡ä»¶ã€‚<br>-2. ã€inchworm.fastaã€‘<br>    è½¬å½•ç»„ç»„è£…ç»“æœæ–‡ä»¶ã€‚æ­¤æ–‡ä»¶å†…å®¹ä»£è¡¨è½¬å½•å­åºåˆ—æˆ– EST åºåˆ—ã€‚ä¸ºäº†å¢åŠ å…¶å‡†ç¡®æ€§ï¼Œé€‰ç”¨äº† trinity ä¸­ inchworm çš„ç»“æœæ–‡ä»¶ï¼Œè€Œä¸æ˜¯è½¬å½•ç»„æœ€ç»ˆçš„ç»„è£…ç»“æœæ–‡ä»¶ã€‚<br>-3. ã€proteins.fastaã€‘<br>    ä¸´è¿‘ç‰©ç§çš„è›‹ç™½è´¨åºåˆ—ã€‚å¯ä»¥ä» NCBI çš„ Taxonomy æ•°æ®åº“ä¸­ä¸‹è½½ã€‚<br>-4. ã€consensi.fa.classifiedã€‘<br>    é€‚åˆæœ¬ç‰©ç§çš„é‡å¤åºåˆ—æ•°æ®åº“ã€‚è¯¥æ–‡ä»¶æ˜¯ä¸€ä¸ªfastaæ–‡ä»¶ï¼Œå…¶åºåˆ—ä»£è¡¨ç€æœ¬ç‰©ç§çš„é«˜é‡å¤åºåˆ—ã€‚è¯¥æ–‡ä»¶ä½¿ç”¨ RepeatModeler åˆ¶ä½œã€‚<br>-5. ã€Augustus hmm files [species]ã€‘<br>    é€‚åˆæœ¬ç‰©ç§çš„ Augustus çš„ HMM æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶ä»¥æ–‡ä»¶å¤¹å½¢å¼å­˜æ”¾åœ¨ /opt/biosoft/augustus-3.0.3/config/species/ ç›®å½•ä¸‹ã€‚<br>    å°† genome.fasta å’Œ inchworm.fasta è¾“å…¥ PASAï¼Œå¾—åˆ°ç”¨äº trainning çš„åŸºå› <br>    ç„¶åä½¿ç”¨ Augustus è¿›è¡Œ trainingï¼Œå¾—åˆ° HMM æ–‡ä»¶ã€‚<br>-6. ã€Snap hmm file [species.hmm]ã€‘<br>    é€‚åˆæœ¬ç‰©ç§çš„ SNAP çš„ HMM æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶æ˜¯ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ã€‚å°† genome.fasta å’Œ inchworm.fasta è¾“å…¥ PASAï¼Œå¾—åˆ°ç”¨äº trainning çš„åŸºå› ï¼Œç„¶åä½¿ç”¨ SNAP è¿›è¡Œ trainingï¼Œå¾—åˆ° HMM æ–‡ä»¶ã€‚<br>-7. ã€Genemark_es hmm file [es.mod]ã€‘<br>    é€‚åˆæœ¬ç‰©ç§çš„ Genemark_es çš„ HMM æ–‡ä»¶ã€‚å°† genome.fasta è¾“å…¥ genemark_es è½¯ä»¶è¿›è¡Œè‡ªæˆ‘è®­ç»ƒå¾—åˆ°çš„ HMM æ–‡ä»¶ã€‚<br>-8. ã€rRNA.faã€‘<br>    rRNA çš„åºåˆ—æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶ä½¿ç”¨ RNAmmer å¯¹åŸºå› ç»„è¿›è¡Œåˆ†æå¾—åˆ°ã€‚<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ MAKER å‘½ä»¤å¾—åˆ°åˆå§‹åŒ–çš„ 3 ä¸ªé…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">$ maker -CTL<br><br>å¾—åˆ°<span class="hljs-number">3</span>ä¸ªé…ç½®æ–‡ä»¶ï¼š maker_exe<span class="hljs-selector-class">.ctl</span>, maker_bopts<span class="hljs-selector-class">.ctl</span> å’Œ maker_opts.ctlã€‚<br>maker_exe.ctlï¼š é…ç½® Maker éœ€è¦è°ƒç”¨çš„ç¨‹åºçš„è·¯å¾„ï¼›maker_exe<span class="hljs-selector-class">.ctl</span>: æ‰§è¡Œç¨‹åºçš„è·¯å¾„<br>maker_bopts.ctlï¼š é…ç½® blast çš„å„ç§é˜ˆå€¼ï¼›maker_bopt<span class="hljs-selector-class">.ctl</span>: BLASTå’ŒExoneratçš„è¿‡æ»¤å‚æ•°<br>maker_opts.ctlï¼š MAKER çš„ä¸»è¦é…ç½®æ–‡ä»¶ï¼Œé…ç½®è¾“å…¥æ–‡ä»¶çš„è·¯å¾„ï¼Œä»¥åŠ MAKER çš„ä½¿ç”¨æµç¨‹ã€‚<br></code></pre></td></tr></table></figure><h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h2><p>å…ˆä¿®æ”¹ maker_opts.ctl é…ç½®æ–‡ä»¶ï¼Œéœ€è¦ä¿®æ”¹çš„å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh">genome=genome.fasta            <span class="hljs-comment"># åŸºå› ç»„åºåˆ—æ–‡ä»¶</span><br>est=inchworm.fasta             <span class="hljs-comment"># EST åºåˆ—æ–‡ä»¶</span><br>protein=proteins.fasta         <span class="hljs-comment"># ä¸´è¿‘ç‰©ç§çš„è›‹ç™½è´¨åºåˆ—æ–‡ä»¶</span><br>model_org=fungi                <span class="hljs-comment"># é€‰æ‹©repebaseæ•°æ®åº“çš„ç‰©ç§ï¼Œå¯¹çœŸèŒåˆ™ç”¨fungiï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ all</span><br>rmlib=consensi.fa.classified   <span class="hljs-comment"># é€‚åˆæœ¬ç‰©ç§çš„é‡å¤åºåˆ—æ•°æ®åº“</span><br>snaphmm=species.hmm            <span class="hljs-comment"># snap traing çš„ HMM æ–‡ä»¶</span><br>gmhmm=es.mod                   <span class="hljs-comment"># genemark_es çš„ HMM æ–‡ä»¶</span><br>augustus_species=species       <span class="hljs-comment"># augustus çš„ HMM æ–‡ä»¶</span><br>est2genome=1                   <span class="hljs-comment"># ä½¿ç”¨ EST åºåˆ—è¿›è¡ŒåŸºå› é¢„æµ‹</span><br>protein2genome=1               <span class="hljs-comment"># ä½¿ç”¨è›‹ç™½è´¨åºåˆ—è¿›è¡ŒåŸºå› é¢„æµ‹</span><br>trna=1                         <span class="hljs-comment"># ä½¿ç”¨ tRNAscan è¿›è¡Œ tRNA é¢„æµ‹</span><br>snoscan_rrna=rRNA.fa           <span class="hljs-comment"># ã€ä½¿ç”¨ Snoscan åˆ©ç”¨ rRNA åºåˆ—è¿›è¡Œ C/D box ç±»å‹çš„ snoRNAs é¢„æµ‹ï¼Œä¸è¿‡æˆ‘åŠ å…¥äº†è¿™ä¸ªä¿¡æ¯åï¼Œmakerè¿è¡Œä¸æˆåŠŸï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚ã€‘</span><br>correct_est_fusion=1           <span class="hljs-comment"># è¿›è¡Œèåˆ EST çš„æ ¡æ­£</span><br></code></pre></td></tr></table></figure><p>å¹¶è¡ŒåŒ–è¿è¡Œ makerã€‚åŸºå› ç»„åºåˆ—æ¯”è¾ƒå¤§ï¼ŒMAKER çš„è®¡ç®—é‡å¤§ï¼Œå¹¶è¡ŒåŒ–èƒ½æå¤§èŠ‚çº¦æ—¶é—´ï¼Ÿï¼Ÿï¼Ÿ</p><p>è®¡ç®—èŠ‚ç‚¹æœ‰mpiccå—</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs crystal">mpd &amp;<br><span class="hljs-variable">$ </span>maker                  <span class="hljs-comment"># ä¸å¹¶è¡ŒåŒ–è¿è¡Œ</span><br><span class="hljs-variable">$ </span>mpiexec -n <span class="hljs-number">20</span> maker    <span class="hljs-comment"># ä½¿ç”¨20ä¸ªçº¿ç¨‹å¹¶è¡Œè®¡ç®—</span><br></code></pre></td></tr></table></figure><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-comment">#change</span><br><span class="hljs-attr">genome</span>=dpp_contig.fasta<br><span class="hljs-attr">est</span>=dpp_est.fasta<br><span class="hljs-attr">protein</span>=dpp_protein.fasta<br><span class="hljs-attr">est2genome</span>=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>å½“å‰è·¯å¾„è¿è¡Œç¨‹åº</p><p>è¾“å‡ºç»“æœè§â€dpp_contig.maker.outputâ€, é‡ç‚¹æ˜¯â€dpp_contig_master_datastore_index.logâ€æ–‡ä»¶ï¼Œç”±äºmakerä¼šæ‹†åˆ†æ•°æ®é›†å¹¶è¡Œè®¡ç®—ï¼Œå› æ­¤è¯¥æ–‡ä»¶è®°å½•æ€»ä½“çš„è¿è¡Œæƒ…å†µï¼Œéœ€è¦å…³æ³¨å…¶ä¸­æ˜¯å¦æœ‰<font color="red">â€FAILEDâ€,â€RETRYâ€,â€SKIPPED_SAMLLâ€,â€DIED_SIPPED_PERMANETâ€</font>ï¼Œå› ä¸ºè¿™æ„å‘³ç€æœ‰äº›æ•°æ®å‡ºäºæŸäº›åŸå› æ²¡æœ‰è¿ç®—ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬éœ€è¦å°†å¹¶è¡Œè¿ç®—çš„ç»“æœè¿›è¡Œæ•´åˆï¼Œå¯¼å‡ºGFFæ–‡ä»¶, è½¬å½•æœ¬åºåˆ—å’Œè›‹ç™½åºåˆ—</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">~<span class="hljs-regexp">/opt/</span>biosoft<span class="hljs-regexp">/maker/</span>bin/fasta_merge -d dpp_contig_master_datastore_index.log<br>~<span class="hljs-regexp">/opt/</span>biosoft<span class="hljs-regexp">/maker/</span>bin/gff3_merge -d dpp_contig_master_datastore_index.log<br></code></pre></td></tr></table></figure><p>åœ¨è¯¥ç›®å½•ä¸‹å°±ä¼šå‡ºç°,<font color="red"> â€œdpp_contig.all.gffâ€,â€œdpp_contig.all.maker.proteins.fastaâ€,â€dpp_contig.all.maker.transcripts.fastaâ€</font></p><p>å…¶ä¸­GFFæ–‡ä»¶å°±éœ€è¦ç”¨IGVï¼ŒJBrowse, Apolloä¸‹å±•ç¤ºæ¥æ£€æŸ¥ä¸‹æ³¨é‡Šæ˜¯å¦æ­£ç¡®ã€‚</p><hr><p><a href="https://www.jianshu.com/p/fe14cab264a7">https://www.jianshu.com/p/fe14cab264a7</a></p><p><a href="http://weatherby.genetics.utah.edu/MAKER/wiki/index.php/The_MAKER_control_files_explained">http://weatherby.genetics.utah.edu/MAKER/wiki/index.php/The_MAKER_control_files_explained</a></p><h1 id="MAKERé…ç½®æ–‡ä»¶è¯¦è§£"><a href="#MAKERé…ç½®æ–‡ä»¶è¯¦è§£" class="headerlink" title="MAKERé…ç½®æ–‡ä»¶è¯¦è§£"></a>MAKERé…ç½®æ–‡ä»¶è¯¦è§£</h1><p>æœ¬æ–‡ç¿»è¯‘è‡ª<a href="https://links.jianshu.com/go?to=http://weatherby.genetics.utah.edu/MAKER/wiki/index.php/The_MAKER_control_files_explained">http://weatherby.genetics.utah.edu/MAKER/wiki/index.php/The_MAKER_control_files_explained</a></p><p>MAKERä¼šç”Ÿæˆä¸‰ä¸ªé…ç½®æ–‡ä»¶ï¼Œå¦‚ä¸‹</p><ul><li>maker_opts.ctl: æ§åˆ¶MAKERåˆ†æè¡Œä¸ºçš„ä¸»è¦é…ç½®æ–‡ä»¶</li><li>maker_bopts.ctl: BLASTå’ŒExnerateçš„è¿‡æ»¤é˜ˆå€¼</li><li>maker_exe.ctl: MAKERè¿è¡Œè¿‡ç¨‹ä¸­æ‰€ä¾èµ–è½¯ä»¶çš„è·¯å¾„</li></ul><p>è¿™é‡Œä¸»è¦ä»‹ç»<code>maker_opts.ctl</code>, å…¶ä½™é…ç½®æ–‡ä»¶ç›´æ¥çœ‹é…ç½®æ–‡ä»¶é‡Œé¢çš„æ³¨é‡Šä¿¡æ¯å³å¯ã€‚</p><p><font color="blue">A minimal input file set for MAKER would generally consist of a F<strong>ASTA file for the genomic</strong> sequence, a <strong>FASTA file of RNA</strong> (ESTs&#x2F;cDNA&#x2F;mRNA transcripts) from <strong>ã€the organismã€‘</strong>, and a <strong>FASTA file of protein</strong> sequences from <strong>ã€the same or related organismsã€‘</strong> (or a general protein database).</font></p><h3 id="åŸºå› ç»„"><a href="#åŸºå› ç»„" class="headerlink" title="åŸºå› ç»„"></a>åŸºå› ç»„</h3><p>ç”¨äºè®¾ç½®è¢«æ³¨é‡Šçš„åŸºå› ç»„åºåˆ—çš„ä½ç½®å’Œç‰©ç§ç±»å‹ï¼ŒåŒ…æ‹¬<code>genome</code>å’Œ<code>organisam_type</code>ä¸¤é¡¹</p><ul><li>genome: FASTAåºåˆ—è·¯å¾„</li><li>organism_type: eukaryotic,prokaryoticäºŒé€‰ä¸€</li></ul><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒåŸºå› ç»„åºåˆ—çš„N50éœ€è¦è¶…è¿‡é¢„æœŸåŸºå› é•¿åº¦çš„ä¸­ä½æ•°ï¼Œå¦åˆ™æ³¨é‡Šæ•ˆæœä¸å¥½ã€‚å¦å¤–æœ€å¥½ä¿è¯åŸºå› ç»„åºåˆ—åªåŒ…æ‹¬A,T,C,G,N, å¯¹äºå…¶ä»–ç±»å‹å…¼å¹¶ç¢±åŸºå¯ä»¥éƒ½æ”¹æˆN.</p><h3 id="ä½¿ç”¨MAKERå¾—åˆ°GFF3è¿›è¡Œé‡æ³¨é‡Š"><a href="#ä½¿ç”¨MAKERå¾—åˆ°GFF3è¿›è¡Œé‡æ³¨é‡Š" class="headerlink" title="ä½¿ç”¨MAKERå¾—åˆ°GFF3è¿›è¡Œé‡æ³¨é‡Š"></a>ä½¿ç”¨MAKERå¾—åˆ°GFF3è¿›è¡Œé‡æ³¨é‡Š</h3><p>è¿™ä¸€é¡¹åŸºæœ¬ä¸Šæˆ‘ä»¬ç”¨ä¸ä¸Šï¼Œå®ƒæ˜¯åœ¨å½“ä½ æŠŠMAKERçš„ä¸­é—´è¾“å‡ºæ–‡ä»¶éƒ½åˆ é™¤äº†ï¼Œä»…ä¿ç•™äº†è¾“å‡ºçš„GFF3æ–‡ä»¶æ—¶ï¼Œä½ å¯ä»¥ç”¨ä¹‹å‰ç›¸åŒçš„è¾“å…¥è®¾ç½®é‡æ–°è¿è¡Œæµç¨‹å¾—åˆ°ç›¸åŒçš„è¾“å‡º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#-----Re-annotation Using MAKER Derived GFF3</span><br>maker_gff= <span class="hljs-comment">#MAKER derived GFF3 file</span><br>est_pass=0 <span class="hljs-comment">#use ESTs in maker_gff: 1 = yes, 0 = no</span><br>altest_pass=0 <span class="hljs-comment">#use alternate organism ESTs in maker_gff: 1 = yes, 0 = no</span><br>protein_pass=0 <span class="hljs-comment">#use protein alignments in maker_gff: 1 = yes, 0 = no</span><br>rm_pass=0 <span class="hljs-comment">#use repeats in maker_gff: 1 = yes, 0 = no</span><br>model_pass=0 <span class="hljs-comment">#use gene models in maker_gff: 1 = yes, 0 = no</span><br>pred_pass=0 <span class="hljs-comment">#use ab-initio predictions in maker_gff: 1 = yes, 0 = no</span><br>other_pass=0 <span class="hljs-comment">#passthrough anyything else in maker_gff: 1 = yes, 0 = no</span><br></code></pre></td></tr></table></figure><h3 id="EST-x2F-è½¬å½•æœ¬è¯æ®"><a href="#EST-x2F-è½¬å½•æœ¬è¯æ®" class="headerlink" title="EST&#x2F;è½¬å½•æœ¬è¯æ®"></a>EST&#x2F;è½¬å½•æœ¬è¯æ®</h3><p>å‡ºäºå†å²åŸå› , MAKERè¿˜æ˜¯ç”¨ESTä»£è¡¨ä¹‹å‰<font color="blue">ESTæ•°æ®</font>å’Œç›®å‰çš„<font color="blue">è½¬å½•ç»„æ•°æ®</font>ã€‚ æ­¤å¤„ä¸åªæ˜¯ä½¿ç”¨ESTæ•°æ®ï¼Œè€Œæ˜¯å¯ä»¥ä½¿ç”¨<font color="blue">ç»„è£…çš„mRNA-seq</font>, ç»„è£…çš„<font color="blue">å…¨é•¿cDNA</font>ã€‚ é¢„æœŸä»–ä»¬èƒ½å¤Ÿæ­£ç¡®çš„ç»„è£…ï¼Œå¹¶è”é…åˆ°æ­£ç¡®çš„å‰ªåˆ‡ä½ç‚¹(å¯¹äºFASTAæ ¼å¼ï¼ŒMAKERä½¿ç”¨<code>exonerate</code>æ‰¾åˆ°å‰ªåˆ‡ä½ç‚¹ï¼‰ã€‚ç”¨é€”å¦‚ä¸‹:</p><ul><li><font color="red">ç›´æ¥<strong>æ¨æ–­</strong></font>åŸºå› æ¨¡å‹(est2genome)</li><li>ä½œä¸ºé¢„æµ‹ç»“æœçš„<strong>æ”¯æŒè¯æ®</strong></li><li>ä¿®æ”¹ç»“æœå’Œ<strong>å¢åŠ UTR</strong></li><li>é‰´å®š<strong>å¯å˜è½¬å½•æœ¬</strong></li><li>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™äº›æ•°æ®å’Œå…¶ä»–è¯æ®èƒ½å¸®åŠ©MAKERæ¨æ–­<strong>åŸºå› è¾¹ç•Œ</strong></li><li>åœ¨é¢„æµ‹æ­¥éª¤ä¸­è¾…åŠ©åŸºå› é¢„æµ‹å·¥å…·æ¨æ–­<strong>å‰ªåˆ‡ä½ç‚¹</strong></li></ul><p>è®¾ç½®é¡¹å¦‚ä¸‹:</p><ul><li><code>est</code>: EST, å…¨é•¿cDNA, ç»„è£…çš„mRNAåºåˆ—ï¼Œå¯ä»¥é€šè¿‡<font color="blue">é€—å·åˆ†éš”å¤šä¸ªæ–‡ä»¶</font>ã€‚</li><li><code>altest</code>: å¦‚æœçœŸçš„æ²¡æœ‰å½“å‰ç‰©ç§çš„è½¬å½•ç»„æ•°æ®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<font color="blue">åŒæºç‰©ç§åºåˆ—</font>ã€‚è¿™äº›åºåˆ—ä¼šé€šè¿‡tblstxè¿›è¡Œæ¯”å¯¹ï¼Œä¼šæ¶ˆè€—å¤§é‡çš„è¿ç®—æ—¶é—´ã€‚</li><li><code>est_gff</code>: é¢„æ¯”å¯¹çš„è½¬å½•æœ¬ï¼Œä»¥<strong>GFF3</strong>æ ¼å¼å­˜æ”¾ï¼Œé€šå¸¸æ¥è‡ªäº<font color="blue">CuffLinks&#x2F;StringTieçš„ç»„è£…ç»“æœgtf</font>ï¼Œæˆ–è€…æ˜¯ä¸Šä¸€æ­¥çš„MAKERæ³¨é‡Š</li><li><code>altest_gff</code>: å’Œaltestä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯æ¯”å¯¹åä»¥GFF3å­˜æ”¾ï¼ŒåŸºæœ¬ä¸Šä¹Ÿç”¨ä¸åˆ°</li></ul><p>Tophat2 + cufflinks æœ‰å‚è½¬å½•ç»„ç»„è£…å¾—åˆ°<font color="red"><strong>gtfç»“æœï¼Œè½¬åŒ–ä¸ºgff</strong></font>ï¼Œç”¨äºestgffã€‚<font color="red"><strong>è½¬åŒ–fa</strong></font>ç”¨äºestã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">cufflinks-gffread<br>gffread transcripts.gtf -g reference.fasta -w transcripts.fasta<br>gffread hp1.est.gtf -o- &gt; hp1.est.gff3<br></code></pre></td></tr></table></figure><h3 id="åŒæºè›‹ç™½è¯æ®"><a href="#åŒæºè›‹ç™½è¯æ®" class="headerlink" title="åŒæºè›‹ç™½è¯æ®"></a>åŒæºè›‹ç™½è¯æ®</h3><p>å’Œä¹‹å‰çš„è½¬å½•ç»„æ•°æ®ç±»ä¼¼ï¼Œç”¨é€”å¦‚ä¸‹</p><ul><li>ç›´æ¥æ¨æ–­åŸºå› æ¨¡å‹(protein2genome), ä»…åœ¨å®ƒä»¬èƒ½å¤Ÿæ­£ç¡®çš„<font color="blue">è”é…åˆ°å‰ªåˆ‡ä½ç‚¹é™„ä»¶</font>ã€‚</li><li>ä½œä¸ºé¢„æµ‹ç»“æœçš„<font color="blue">æ”¯æŒè¯æ®</font>(MAKERä¼šæ£€æŸ¥CDSï¼Œä¿è¯åŸºå› é¢„æµ‹ç»“æœå’Œè›‹ç™½è”é…æ˜¯<font color="blue">ç›¸åŒçš„é˜…è¯»æ¡†</font>)</li><li>æŸäº›æƒ…å†µä¸‹ï¼Œç”¨äºæ¨æ–­<font color="blue">åŸºå› è¾¹ç•Œ</font></li><li>åœ¨é¢„æµ‹æ­¥éª¤ä¸­ï¼Œ<font color="blue">ä½¿ç”¨ä»è›‹ç™½æ¨æ–­çš„ORFè¾…åŠ©ä»å¤´é¢„æµ‹è½¯ä»¶</font></li></ul><p><strong>å»ºè®®</strong>ä½¿ç”¨ <font color="blue">uniprot&#x2F;swiss-prot æˆ– RefSeq</font>ä¸Šçš„NPæ•°æ®ï¼Œå› ä¸ºç»è¿‡äººå·¥å®¡æŸ¥ï¼Œå¯ä¿¡åº¦è¾ƒé«˜ã€‚<font color="blue">ä¸å»ºè®®ç”¨UniProt&#x2F;trembleæˆ–è€…Genbankä¸Šçš„æ•°æ®</font>ï¼Œè¿™äº›æ•°æ®çš„å¯ä¿¡åº¦è¾ƒä½ã€‚ä½ å¯ä»¥æŒ‘é€‰å‡ ä¸ªåŒæºç‰©ç§çš„é«˜å¯ä¿¡åº¦è›‹ç™½ã€‚æˆ–è€…ä½¿ç”¨MAKERæ³¨é‡Šçš„å…¶ä»–ç‰©ç§AEDå°äº0.5çš„è½¬å½•æœ¬äº§ç‰©ã€‚</p><p>ç”±äºè®¸å¤šæ³¨é‡Šé‡ŒåŒ…å«ä¸€äº›<font color="blue">æ­»äº¡è½¬åº§å­(dead transposons)æˆ–ä¼ªåŸºå› (pseudogenes)</font>ï¼Œ<font color="blue">å› æ­¤<strong>ä¸å»ºè®®</strong>ä½¿ç”¨ä¸´è¿‘ç‰©ç§çš„æ‰€æœ‰æ³¨é‡Šè›‹ç™½</font>ã€‚æƒ³è±¡ä¸€ä¸ªæ¯”è¾ƒç³Ÿç³•çš„æƒ…å†µï¼Œå¦‚æœæœ‰é‚»è¿‘ç‰©ç§çš„æ­»äº¡è½¬åº§å­ï¼Œå½“æ„å»ºé‡å¤åºåˆ—å±è”½æ–‡åº“æ—¶ï¼Œå‘ç°å…¶ä¸­ä¸€ä¸ªæ¡ç›®å’Œè¯¥åºåˆ—åŒ¹é…ã€‚ äºæ˜¯ä½ å‡è®¾è¿™æ˜¯ä¸€ä¸ªçœŸå®çš„åŸºå› ï¼Œäºæ˜¯ä½ ä»å±è”½æ–‡åº“ä¸­åˆ é™¤äº†è¯¥æ¡ç›®ã€‚å½“æ³¨é‡ŠåŸºå› ç»„çš„æ—¶å€™ï¼Œè¯¥åŸºå› å˜æˆäº†æ³¨é‡Šé›†ä¸­çš„ä¸€æ•´ä¸ªåŸºå› ç»„å®¶æ—ï¼Œä½†è¿™å…¶å®æ˜¯ç³Ÿç³•çš„è¯æ®å’Œé‡å¤åºåˆ—å±è”½æ‰€å¯¼è‡´çš„åæœã€‚</p><p>éœ€è¦è®¾ç½®çš„å°±ä¸¤é¡¹ï¼š</p><ul><li><code>protein</code>: ä»¥FASTAå­˜æ”¾çš„è›‹ç™½åºåˆ—ä½ç½®</li><li><code>protein_gff</code>: ä»¥GFF3æ ¼å¼è®°å½•çš„è›‹ç™½åºåˆ—é¢„å…ˆæ¯”å¯¹ç»“æœï¼Œé€šå¸¸æ¥è‡ªäºä¹‹å‰MAKERè¾“å‡º</li></ul><h3 id="é‡å¤åºåˆ—é‡å¤å±è”½"><a href="#é‡å¤åºåˆ—é‡å¤å±è”½" class="headerlink" title="é‡å¤åºåˆ—é‡å¤å±è”½"></a>é‡å¤åºåˆ—é‡å¤å±è”½</h3><p>é€šè¿‡å±è”½é‡å¤åºåˆ—æ¥é¿å…ESTå’Œè›‹ç™½æ¯”å¯¹åˆ°é‡å¤åŒºåŸŸï¼Œé˜²æ­¢åŸºå› é¢„æµ‹ç®—æ³•åœ¨è¿™äº›åŒºåŸŸé¢„æµ‹å¤–æ˜¾å­ã€‚ç”±äºè®¸å¤šé‡å¤åºåˆ—ä¼šç¼–ç çœŸå®çš„è›‹ç™½(ä¾‹å¦‚åè½¬åº§å­ç­‰)ï¼ŒåŸºå› é¢„æµ‹å·¥å…·å’Œæ¯”å¯¹å·¥å…·ä¼šè¢«ä»–ä»¬æ‰€è¿·æƒ‘(ä¼šåœ¨ä¸€ä¸ªåŸºå› ä¸­é”™è¯¯çš„åŠ ä¸Šå¤–æ˜¾å­)</p><ul><li><code>model_org</code>: é»˜è®¤æ˜¯all, å¯ä»¥è®¾ç½®æˆRepeatMaskerä¸­<font color="blue">RepBaseæ•°æ®åº“çš„å…¶ä¸­ä¸€ä¸ª</font></li><li><code>rmlib</code>: <font color="blue">è‡ªå·±æ„å»ºçš„é‡å¤åºåˆ—æ–‡åº“</font></li><li><code>repeat_protein</code>: è½¬åº§å› å­çš„è›‹ç™½åºåˆ—</li><li><code>rm_gff</code>: ä»¥GFF3æ ¼å¼è®°å½•çš„é‡å¤åºåˆ—ä½ç½®ä¿¡æ¯</li><li><code>prok_rm</code>: ä¸éœ€è¦ä¿®æ”¹ï¼Œå› ä¸ºåŸæ ¸ç”Ÿç‰©ä¸éœ€è¦è€ƒè™‘é‡å¤åºåˆ—</li><li><code>softmask</code>: ä¸éœ€è¦ä¿®æ”¹</li></ul><h3 id="ä»å¤´åŸºå› é¢„æµ‹"><a href="#ä»å¤´åŸºå› é¢„æµ‹" class="headerlink" title="ä»å¤´åŸºå› é¢„æµ‹"></a>ä»å¤´åŸºå› é¢„æµ‹</h3><p>å¦‚æœä½ éœ€è¦ä»MAKERä»¥å¤–è·å–åŸºå› æ¨¡å‹ï¼Œåˆ™éœ€è¦åœ¨è¿™ä¸€èŠ‚æ·»åŠ ç›¸åº”çš„é…ç½®ã€‚æ ¹æ®å¯ä¿¡åº¦é«˜ä½ï¼ŒMAKERä¼šå¯¹è¿™äº›åŸºå› æ¨¡å‹é‡‡å–ä¸åŒçš„è¡Œä¸ºã€‚</p><ul><li>é€šè¿‡è½¯ä»¶é¢„æµ‹çš„åŸºå› ç»“æ„å¯ä¿¡åº¦ä½ï¼Œå®ƒä»¬ä¸ä¼šå½±å“è¯æ®ç°‡(evidence cluster). MAKERä¼šä¿ç•™é¢„æµ‹ç»“æœï¼Œæˆ–è€…æ ¹æ®ESTè¯æ®è°ƒæ•´å¤–æ˜¾å­ï¼Œå¦‚æœæœ‰è¯æ®æ”¯æŒï¼Œé‚£ä¹ˆä»–ä»¬ä¼šä¿ç•™åœ¨æœ€ç»ˆçš„æ³¨é‡Šé›†ä¸­ã€‚å¦‚æœæœ‰å¤šä¸ªæ³¨é‡Šç»“æœï¼ŒMAKERä¼šå¯¹å…¶è¿›è¡Œæ¯”è¾ƒï¼Œä»ä¸­æŒ‘é€‰å‡ºæœ€ä¼˜ç»“æœã€‚</li><li><code>model_gff</code>æä¾›çš„åŸºå› æ¨¡å‹çš„å¯ä¿¡åº¦æœ€é«˜ï¼Œä¼šå½±å“è¯æ®ç°‡ã€‚åœ¨ä¸€äº›åŸºå› è¾¹ç•Œåˆ¤å®šä¸­ï¼ŒMAKERåœ¨è¯æ®ç°‡çš„å½±å“ä¸‹ï¼Œæ›´å€¾å‘äºä¿ç•™ä¹‹å‰çš„åŸºå› æ¨¡å‹è€Œéæ›¿æ¢ã€‚å®ƒä»¬ä¹Ÿä¼šä¿ç•™åå­—ã€‚MAKERä¸ä¼šä¿®æ”¹æ¨¡å‹ï¼Œè¦ä¹ˆåˆ é™¤è¦ä¹ˆä¿ç•™ã€‚æœ€åï¼Œå³ä¾¿æ²¡æœ‰è¯æ®æ”¯æŒï¼ŒMAKERè¿˜æ˜¯ä¼šä¿ç•™ä»–ä»¬ï¼Œè€Œä¸ä¼šåˆ é™¤ä»–ä»¬ï¼Œåªä¸è¿‡æœ€ç»ˆçš„AEDä¼šè®¾ç½®ä¸º1.</li><li>snaphmm: SNAPçš„HMMæ–‡ä»¶è·¯å¾„ï¼Œå…è®¸å¤šä¸ªè¾“å…¥ï¼Œä»¥é€—å·åˆ†éš”</li><li>gmhmm: GeneMarkçš„HMMæ–‡ä»¶æ–‡ä»¶è·¯å¾„ï¼Œå…è®¸å¤šä¸ªè¾“å…¥ï¼Œä»¥é€—å·åˆ†éš”</li><li>augustus_species: Augustusçš„åŸºå› æ¨¡å‹å‘½å, ä¸å®¹æ˜“è®­ç»ƒï¼Œä½†æ˜¯æ•ˆæœå¾ˆå¥½</li><li>fgenesh_par_file: FGENESHçš„HMMå‚æ•°æ–‡ä»¶ï¼Œæ”¶è´¹å·¥å…·ï¼ŒåŸºæœ¬ä¸Šç”¨ä¸åˆ°</li><li>pred_gff: å…¶ä»–é¢„æµ‹å·¥å…·çš„è¾“å‡ºç»“æœï¼Œä»¥GFF3æ ¼å¼ä¿å­˜</li><li>model_gff: æœ€é«˜å¯ä¿¡åº¦çš„GFFè¾“å…¥</li><li>run_evm&#x3D;0: æ˜¯å¦è®©MAKERè¿è¡ŒEVMï¼Œé€Ÿåº¦ä¼šå˜æ…¢</li><li>est2genome: è®©MAKERæ ¹æ®ESTæ¨æµ‹åŸºå› æ¨¡å‹</li><li>protein2genome: è®©MAKERæ ¹æ®è›‹ç™½åºåˆ—æ¨æµ‹åŸºå› æ¨¡å‹</li><li>trna: ä½¿ç”¨tRNAscanåˆ†ætRNA #find tRNAs with tRNAscan, 1 &#x3D; yes, 0 &#x3D; no</li><li>snoscan_rrna: Snoscanåˆ†æsnoRNAæ‰€éœ€çš„rRNAæ–‡ä»¶&#x3D; #rRNA file to have Snoscan find snoRNAs</li><li>snoscan_methï¼šSnoscanåˆ†æsnoRNAæ‰€éœ€çš„O-methylation site æ–‡ä»¶</li><li>unmask: æ˜¯å¦åœ¨å±è”½åºåˆ—ä¸­è¿›è¡ŒåŸºå› é¢„æµ‹ï¼Œé»˜è®¤æ˜¯0</li><li>allow_overlap: å…è®¸çš„åŸºå› é‡å æ¯”ä¾‹ï¼Œä»0åˆ°1ï¼Œç©ºç™½è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼</li></ul><h3 id="å…¶ä»–ç±»å‹çš„æ³¨é‡Š"><a href="#å…¶ä»–ç±»å‹çš„æ³¨é‡Š" class="headerlink" title="å…¶ä»–ç±»å‹çš„æ³¨é‡Š"></a>å…¶ä»–ç±»å‹çš„æ³¨é‡Š</h3><p>è¿™ä¸€é¡¹åŠŸèƒ½å¾ˆç®€å•ï¼Œå°±æ˜¯æä¾›ä¸€ä¸ªGFFæ–‡ä»¶ï¼Œåœ¨MAKERè¿è¡Œç»“æŸåå¢åŠ é‡Œé¢çš„ä¿¡æ¯</p><ul><li><code>other_gff</code>: å…¶ä»–ç±»å‹æ³¨é‡Šçš„GFFæ–‡ä»¶è·¯å¾„</li></ul><h3 id="å¤–éƒ¨ç¨‹åºé€‰é¡¹"><a href="#å¤–éƒ¨ç¨‹åºé€‰é¡¹" class="headerlink" title="å¤–éƒ¨ç¨‹åºé€‰é¡¹"></a>å¤–éƒ¨ç¨‹åºé€‰é¡¹</h3><p>è¿™é‡Œçš„ä¸¤ä¸ªå‚æ•°ç”¨äºå½±å“å¤–éƒ¨ç¨‹åºï¼Œå³BLASTçš„è¡Œä¸º</p><ul><li><code>alt_peptide</code>: å¯¹äºéæ ‡å‡†æ°¨åŸºé…¸çš„æ›¿æ¢æ–¹æ³•ï¼Œé»˜è®¤æ˜¯C(cysteine)</li><li><code>cpus</code>: BLASTçš„çº¿ç¨‹æ•°ï¼Œå¦‚æœä½¿ç”¨MPIï¼Œè¯¥å€¼å¯ä»¥è®¾ç½®çš„å°ä¸€äº›ï¼Œé»˜è®¤æ˜¯1.</li></ul><h3 id="MAKERè¡Œä¸ºé€‰é¡¹"><a href="#MAKERè¡Œä¸ºé€‰é¡¹" class="headerlink" title="MAKERè¡Œä¸ºé€‰é¡¹"></a>MAKERè¡Œä¸ºé€‰é¡¹</h3><p>è¿™é‡Œçš„é€‰é¡¹ç”¨äºè°ƒæ•´MAKERçš„è¡Œä¸ºï¼Œä½¿å…¶ç¬¦åˆä½ çš„åŸºå› ç»„ç‰¹æ€§</p><ul><li><code>mad_dna_len</code>è‡³å°‘è¦3å€äºé¢„æœŸçš„æœ€å¤§å†…å«å­é•¿åº¦ã€‚åœ¨å†…å­˜è¶³å¤Ÿçš„æƒ…å†µä¸‹ï¼Œå¯¹äº<strong>è„Šæ¤åŠ¨ç‰©</strong>å¯ä»¥è€ƒè™‘è®¾ç½®ä¸º<code>300000</code>ï¼Œæ¤ç‰©ä¸€èˆ¬æ²¡æœ‰é‚£ä¹ˆå¤§çš„å†…å«å­</li><li><code>min_contig</code>: ä½äºè¯¥å€¼çš„contigä¼šè¢«è¿‡æ»¤æ‰ï¼Œå»ºè®®è®¾ç½®ä¸º10k.</li><li><code>pred_flank</code>: åœ¨åŸºå› é¢„æµ‹æ—¶ï¼Œå°†è¯æ®ç°‡åœ¨ä¸¤ç«¯è¿›è¡Œæ‰©å±•ï¼Œé»˜è®¤æ˜¯200 bp. å¯¹äºæ¯”è¾ƒç´§å‡‘çš„åŸºå› ç»„ï¼Œé™ä½è¯¥å€¼èƒ½å¤Ÿé¿å…åŸºå› é”™è¯¯åˆå¹¶ã€‚å¯¹äºæ¯”è¾ƒç¨€ç–çš„åŸºå› ç»„ï¼Œæé«˜è¯¥å€¼å¯ä»¥é¿å…å¤–æ˜¾å­ç¼ºå¤±ã€‚</li><li><code>pred_stats</code>: é»˜è®¤æ˜¯0ï¼Œåªè®¡ç®—MAKERé¢„æµ‹åŸºå› çš„AEDå’ŒQIå€¼ï¼Œè®¾ç½®ä¸º1åˆ™è®¡ç®—æ‰€æœ‰ä»å¤´é¢„æµ‹çš„åŸºå› ç»“æ„ã€‚</li><li><code>AED_threashold</code>: æ ¹æ®AED(0-1)å€¼æ¥è¿‡æ»¤è¾“å‡ºçš„åŸºå› ï¼Œé»˜è®¤æ˜¯1ï¼Œè¡¨ç¤ºä¿ç•™æ‰€æœ‰é¢„æµ‹ç»“æœã€‚</li><li><code>min_protein</code>: ä¸€äº›æ—¶å€™ï¼ŒåŸºå› é¢„æµ‹å·¥å…·ä¼šç”Ÿæˆè®¸å¤šçŸ­é¢„æµ‹ç»“æœï¼Œè€Œç”±äºä¸€äº›è¯æ®ç±»å‹ï¼ˆä¾‹å¦‚mRNA-seqï¼‰å­˜åœ¨å™ªéŸ³ï¼Œå¯¼è‡´è¿™äº›é¢„æµ‹ç»“æœçœ‹èµ·æ¥æœ‰è¯æ®æ”¯æŒï¼Œäºæ˜¯ä¿ç•™åœ¨æœ€ç»ˆçš„è¾“å‡ºç»“æœä¸­(AED&gt;1). é€šè¿‡é™åˆ¶é¢„æµ‹è›‹ç™½çš„æ°¨åŸºé…¸æ•°(amino acides, AA)ï¼Œå¯ä»¥å‡å°‘é¢„æµ‹ç»“æœã€‚</li><li><code>alt_splice</code>: æ˜¯å¦è®¡ç®—å¯å˜è½¬å½•æœ¬</li><li><code>always_complete</code>: è¿™ä¸ªæ˜¯MAKERå¼€å‘è€…åœ¨åˆä½œè€…çš„è¦æ±‚ä¸‹åŠ ä¸Šçš„å‚æ•°ï¼Œç”¨æ¥ç¡®ä¿åŸºå› æ¨¡å‹å§‹ç»ˆæœ‰èµ·å§‹å¯†ç å­å’Œç»ˆæ­¢å¯†ç å­ï¼Œé»˜è®¤æ˜¯0</li><li><code>map_forward</code>: ç”¨äºä¿ç•™è€ç‰ˆæœ¬çš„GFFæ–‡ä»¶çš„ä¿¡æ¯ï¼Œæ˜ å°„åˆ°æ–°çš„ç‰ˆæœ¬GFFä¸­ã€‚</li><li><code>keep_preds</code>: è®¾ç½®ä¸º1æ—¶è¡¨ç¤ºä¿ç•™æ‰€æœ‰çš„é¢„æµ‹ç»“æœï¼Œé»˜è®¤æ˜¯0.</li><li><code>split_hit</code>: æ–°ç‰ˆæœ¬çš„MAKER(&gt;2.28)ä¸éœ€è¦è€ƒè™‘è¯¥é¡¹ã€‚å› ä¸ºä¹‹å‰ç‰ˆæœ¬æ‹†åˆ†åçš„contigæ˜¯äº’ä¸é‡å ï¼Œäºæ˜¯å°±æœ‰å¯èƒ½æœ‰å¤–æ˜¾å­è¢«åˆšå¥½è¢«æ‹†æˆä¸¤ç«¯ï¼Œè®¾ç½®è¯¥é¡¹å¯ä»¥ä¿ç•™è¯¥ä¿¡æ¯ã€‚</li><li><code>single_exon</code>: å¦‚æœä¸€ä¸ªESTåªæœ‰åªæœ‰å•ä¸ªå¤–æ˜¾å­ï¼Œé»˜è®¤æƒ…å†µä¸‹MAKERå¹¶ä¸ä¼šæŠŠå®ƒå½“åšæ”¯æŒåŸºå› æ¨¡å‹çš„è¯æ®, é™¤éè¿˜æœ‰åŒæºè›‹ç™½ä½œä¸ºæ”¯æŒã€‚å•å¤–æ˜¾å­ESTå’Œç»„è£…çš„mRNA-seqè½¬å½•æœ¬é€šå¸¸æ˜¯RNAåˆ¶å¤‡è¿‡ç¨‹ä¸­çš„åŸºå› ç»„åºåˆ—æ±¡æŸ“ã€‚å…³é—­æ—¶ä¼šé™ä½MAKERçš„æ•æ„Ÿåº¦(sensitivity), ä½†æ˜¯å½“ä½ æ‰“å¼€å®ƒçš„æ—¶å€™ï¼Œå‘½ä¸­çš„ç‰¹å¼‚æ€§ä¼šæ¯”æ•´ä½“çš„å‡†ç¡®åº¦(accuracy)å·®å¾—å¤šã€‚</li><li><code>single_length</code>: åœ¨å¯ç”¨<code>single_exon</code>æ—¶ï¼Œè®¾ç½®è¯¥é¡¹ç”¨äºä¿ç•™ä¸€äº›æ¯”è¾ƒå°çš„åºåˆ—ï¼Œä½†å³ä¾¿æ³¨é‡Šäº†ä¹Ÿå¯èƒ½ä¸æ˜¯æœ‰åŠŸèƒ½çš„è›‹ç™½ã€‚</li><li><code>correct_est_fusion</code>ç”¨æ¥é¿å…å› ä¸ºUTRçš„é‡å å¯¼è‡´å°†åŸºå› æ¨¡å‹çš„é”™è¯¯åˆå¹¶ï¼Œåœ¨<strong>çœŸèŒåŸºå› ç»„</strong>ä¸­æ¯”è¾ƒå¸¸è§ã€‚å®ƒä¼šæ£€æŸ¥åŸºå› æ¨¡å‹çš„5â€™ UTRé•¿åº¦æ˜¯å¦è¶…è¿‡åŸºå› é•¿åº¦çš„ä¸€åŠï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œé‚£ä¹ˆMAKERä¼šåœ¨èµ·å§‹å¯†ç ä½ç½®æ‰“æ–­åŸºå› ï¼Œç„¶ååœ¨5â€™UTRåŒºé‡æ–°é¢„æµ‹åŸºå› ã€‚</li><li><code>tries</code>: å°è¯•æ¬¡æ•°ï¼Œé»˜è®¤æ˜¯2</li><li><code>clean_try</code>: é‡æ–°å°è¯•æ—¶ï¼Œæ˜¯å¦åˆ é™¤ä¹‹å‰çš„æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯0ï¼Œä¹Ÿå°±æ˜¯ä¸åˆ é™¤ã€‚å»ºè®®è®¾ç½®ä¸º1</li><li><code>clean_up</code>: åˆ é™¤åˆ†æè¿‡ç¨‹ä¸­çš„æ–‡ä»¶ï¼Œé»˜è®¤ä¸åˆ é™¤</li><li><code>TMP</code>: ä¸´æ—¶æ–‡ä»¶çš„ç›®å½•ï¼Œé»˜è®¤å­˜æ”¾åœ¨<code>/tmp</code>ä¸‹ï¼Œå»ºè®®è®¾ç½®ä¸€ä¸ªå®¹é‡æ¯”è¾ƒå¤§çš„ç›®å½•</li></ul><hr><h1 id="maker-å†…å«è½¯ä»¶å®‰è£…"><a href="#maker-å†…å«è½¯ä»¶å®‰è£…" class="headerlink" title="maker å†…å«è½¯ä»¶å®‰è£…"></a>maker å†…å«è½¯ä»¶å®‰è£…</h1><h2 id="snoscan"><a href="#snoscan" class="headerlink" title="snoscan"></a>snoscan</h2><p><a href="http://www.chenlianfu.com/?p=2325">http://www.chenlianfu.com/?p=2325</a></p><p><a href="http://lowelab.ucsc.edu/snoscan/">http://lowelab.ucsc.edu/snoscan/</a></p><p><a href="https://iamphioxus.org/2016/01/20/installing-trnascan-se-and-snoscan/">https://iamphioxus.org/2016/01/20/installing-trnascan-se-and-snoscan/</a></p><p>snoRNAs ä¸»è¦æœ‰ 2 ç§ä¸åŒç±»å‹ã€‚å…¶ä¸­ C&#x2F;D box ç±»å‹ snoRNAs ç”¨äºæŒ‡å¯¼ç”²åŸºåŒ–ä¿®é¥°(2â€™O-ribose-methylations)ï¼Œè¯¥ç”²åŸºåŒ–ä¿®é¥°ä½äºæ ¸ç³–ä½“ 2â€²-OHä¸Šï¼› H&#x2F;ACA box ç±»å‹ snoRNAs ç”¨äºæŒ‡å¯¼å‡å°¿è‹·é…¸åŒ–ä¿®é¥°(Pseudouridylation)ï¼Œå³å°†å°¿å˜§å•¶è½¬æ¢ä¸ºå‡å°¿å˜§å•¶ã€‚</p><p><strong>snoscan</strong>ç”¨äºé‰´å®š C&#x2F;D box ç±»å‹ snoRNAsï¼› <strong>snoGPS</strong>ç”¨äºé‰´å®š H&#x2F;ACA box ç±»å‹çš„ snoRNAsã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#wget lowelab.ucsc.edu/software/snoscan.tar.gz</span><br><span class="hljs-comment">#ä¸‹è½½æœ€æ–°1.0</span><br>$ tar zxf snoscan.tar.gz -C /opt/biosoft/<br><span class="hljs-built_in">cd</span> snoscan-1.0<br><span class="hljs-built_in">cd</span> squid-1.5.11<br>$ perl -p -i -e <span class="hljs-string">&#x27;s/getline/get_line/g&#x27;</span> sqio.c<span class="hljs-comment">#å¦ä¸€ä¸ªåšå®¢ä¿®æ”¹ä¸ºgetLineï¼Ÿï¼Ÿï¼Ÿ</span><br>$ <span class="hljs-built_in">cd</span> ..<br>$ make<br><span class="hljs-comment">#no conda, fat error </span><br><span class="hljs-comment">#/usr/bin/ld: cannot find -lsquid</span><br><span class="hljs-comment">#collect2: error: ld returned 1 exit status</span><br><span class="hljs-comment">#no fat no conda:ok.</span><br>$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;PATH=$PATH:/opt/biosoft/snoscan-1.0&#x27;</span> &gt;&gt; ~/.bashrc<br><span class="hljs-comment">#perl -p -i -e &#x27;s#/usr/local/bin/perl#/usr/bin/perl#&#x27; sort-snos</span><br>change sort-snos   <span class="hljs-comment">#!/usr/bin/perl</span><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ snoscan rRNA.fa genome.fasta -s -o out<br>rRNA.fa      : rRNAåºåˆ—çš„fastaæ ¼å¼<br>genome.fasta : ç”¨äºæœç´¢ snoRNAs çš„åŸºå› ç»„åºåˆ—<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sh">-h<br>    æ‰“å°å¸®åŠ©ä¿¡æ¯<br>-m string<br>    æŒ‡å®šåŒ…å«ç”²åŸºåŒ–ä½ç‚¹ä¿¡æ¯çš„æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶çš„æ ¼å¼ä¸ºï¼š<br>        &gt;seq_A<br>        T 5 Verified meth site by TML<br>        C 12  Predicted by snoscan<br>        &gt;My-seq-B<br>        G 1   Partially modified site<br>        A 6   Mapped by Maden<br>    ä¸fastaæ ¼å¼ç±»ä¼¼ï¼Œå¤´éƒ¨æ˜¯å’Œ genome.fasta åºåˆ—åç›¸åŒï¼›å†…å®¹éƒ¨åˆ†åˆ†3åˆ—ï¼Œä»¥ç©ºæ ¼æˆ–åˆ¶è¡¨ç¬¦åˆ†å‰²ï¼Œç¬¬1åˆ—æ˜¯ä½ç‚¹çš„ç¢±åŸºï¼Œç¬¬2åˆ—æ˜¯1-basedçš„ä½ç‚¹ï¼Œç¬¬3åˆ—æ˜¯60ä¸ªå­—ç¬¦ä»¥å†…çš„æè¿°ã€‚<br>-o string<br>    å°†ç»“æ„è¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶ï¼Œé»˜è®¤è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º<br>-s<br>    æ˜¯å¦ä¿å­˜ snoRNA çš„åºåˆ—åˆ°è¾“å‡ºä¸­<br></code></pre></td></tr></table></figure><blockquote><p>snoRNA æŒ‡å¯¼çš„ rRNA çš„è½¬å½•åä¿®é¥°æœ‰ 2 ç§ï¼š ç”²åŸºåŒ–(Methylation) å’Œ å‡å°¿è‹·é…¸åŒ–(Pseudouridylation)ã€‚</p><p>snoRNP(small nucleolar ribonucleoprotein): æ¯ä¸ª snoRNA å’Œè‡³å°‘4ä¸ªè›‹ç™½åˆ†å­å½¢æˆå¤åˆç‰©ï¼Œæ¥æŒ‡å¯¼ç›®æ ‡RNAçš„ä¿®é¥°ã€‚</p><p>snoRNAs ä¸»è¦æœ‰ 2 ç§ä¸åŒç±»å‹ã€‚å…¶ä¸­ C&#x2F;D box ç±»å‹ç”¨äºæŒ‡å¯¼ç”²åŸºåŒ–ä¿®é¥°ï¼› H&#x2F;ACA box ç±»å‹ç”¨äºæŒ‡å¯¼å‡å°¿è‹·é…¸åŒ–ä¿®é¥°ã€‚</p><p>C&#x2F;D box ç±»å‹çš„ snoRNAs åŒ…å« C(RUGAUGA)ç¯ å’Œ D(CUGA)ç¯ï¼Œåˆ†åˆ«åœ¨ snoRNA çš„ 5â€² å’Œ 3â€² ç«¯ã€‚</p><p>H&#x2F;ACA box ç±»å‹çš„ snoRNAs ç”± 2 ä¸ªå‘å¤¹ç»“æ„å’Œ 2 ä¸ªå•é“¾åŒºç»„æˆï¼Œç§°ä¸º hairpin-hinge-hairpin-tail ç»“æ„ã€‚ç»“æ„ä¸­åŒ…å« H box(ANANNA) å’Œ ACA box(ACA)ã€‚</p></blockquote><h2 id="RNAmmer"><a href="#RNAmmer" class="headerlink" title="RNAmmer"></a>RNAmmer</h2><p><a href="http://www.chenlianfu.com/?p=1979">http://www.chenlianfu.com/?p=1979</a></p><p>Appending installation info to &#x2F;home&#x2F;~&#x2F;perl5&#x2F;lib&#x2F;perl5&#x2F;x86_64-linux-thread-multi&#x2F;perllocal.pod<br>  JV&#x2F;Getopt-Long-2.52.tar.gz</p><p>Appending installation info to &#x2F;home&#x2F;~&#x2F;perl5&#x2F;lib&#x2F;perl5&#x2F;x86_64-linux-thread-multi&#x2F;perllocal.pod<br>  GRANTM&#x2F;XML-Simple-2.25.tar.gz</p><ol><li>perlçš„Getopt::Longå’ŒXML::Simpleæ¨¡å—ï¼› 2. hmmsearch,éœ€è¦å®‰è£…hmmer-2.2gç‰ˆæœ¬ï¼Œä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ä¼šå‡ºé”™ã€‚</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs sh">ä¸‹è½½å¹¶å®‰è£…hmmer-2.2gå¤±è´¥ï¼ŒæŸ¥çœ‹https://blog.karinlag.no/2013/10/rnammer-install/ï¼Œæç¤º2.3<br>$ wgetï¼š http://hmmer.org/download.html<br>$ tar zxf hmmer-2.3<br><span class="hljs-built_in">mkdir</span> hmmer2.3<br>$ <span class="hljs-built_in">cd</span> hmmer-2.3<br>$ ./configure --prefix=~/opt/biosoft/hmmer2.3<br>$ <span class="hljs-built_in">mkdir</span> -p /opt/biosoft/hmmer-2.3/man/man1/ /opt/biosoft/hmmer-2.3/bin<br>$ make; make install<br><br>å®‰è£…RNAmmerï¼Œè¯¥è½¯ä»¶éœ€è¦ä½¿ç”¨edué‚®ç®±å»ç”³è¯·ã€‚<br>$ <span class="hljs-built_in">mkdir</span> -p /opt/biosoft/rnammer-1.2<br>$ tar zxf rnammer-1.2.src.tar.Z -C /opt/biosoft/rnammer-1.2<br>ä¿®æ”¹rnammerä¸­çš„<span class="hljs-variable">$INSTALL_PATH</span><br>ä¿®æ”¹rnammerä¸­çš„<span class="hljs-variable">$HMMSEARCH_BINARY</span><br><br>æ£€æµ‹æ˜¯å¦æ­£å¸¸è¿è¡Œ<br>./rnammer -S bac -multi -f rRNA.fasta -h rRNA.hmmreport -xml rRNA.xml -gff rRNA.gff2 example/ecoli.fsa &gt; rnammer.log 2&gt;&amp;1 &amp;<br><span class="hljs-comment">#errorï¼šFATAL: POSIX threads support is not compiled into HMMER; --cpu doesn&#x27;t have any effect</span><br><span class="hljs-comment">#ä¾ç„¶åœ¨å®˜ç½‘ï¼šhttps://blog.karinlag.no/2013/10/rnammer-install/</span><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh">USAGE:<br>$ rnammer [options] sequence.fasta<br>-S  æŒ‡å®šè¾“å…¥åºåˆ—çš„ç‰©ç§æ‰€å±çš„ç•Œï¼š arc bac æˆ– euk<br>-gff  ç”Ÿæˆçš„gffæ–‡ä»¶ç»“æœ<br>-m  æ‰€éœ€è¦é¢„æµ‹çš„moleculersï¼š <span class="hljs-string">&#x27;tsu&#x27;</span> <span class="hljs-keyword">for</span> 5/8s rRNA, <span class="hljs-string">&#x27;ssu&#x27;</span> <span class="hljs-keyword">for</span> 16/18s rRNA, <span class="hljs-string">&#x27;lsu&#x27;</span> <span class="hljs-keyword">for</span> 23/28s rRNAã€‚å¦‚æœå…¨éƒ¨è¿›è¡Œé¢„æµ‹ï¼Œåˆ™è¯¥å‚æ•°åä¸º <span class="hljs-string">&#x27;tsu,ssu,lsu&#x27;</span>ã€‚<br>-multi  å¹¶è¡Œè¿ç®—ï¼Œé¢„æµ‹æ­£åä¸¤æ¡é“¾ä¸Šæ‰€æœ‰çš„moleculersã€‚æœ€å¤šå¹¶è¡Œè¿è¡Œ6ä¸ªè®¡ç®—ã€‚ä½¿ç”¨è¯¥å‚æ•°ï¼Œåˆ™ä¸éœ€è¦ä¸Šä¸€ä¸ªå‚æ•°ã€‚<br>-f  ç”Ÿæˆçš„rRNAçš„fastaç»“æœæ–‡ä»¶<br>-h  ç”Ÿæˆçš„hmmæŠ¥å‘Šç»“æœ<br>-gff  ç”Ÿæˆçš„rRNAçš„gff2æ–‡ä»¶<br>-x  ç”Ÿæˆçš„xmlç»“æœæ–‡ä»¶<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ /opt/biosoft/rnammer-1.2/rnammer -S euk -multi -f rRNA.fasta\<br> -h rRNA.hmmreport -xml rRNA.xml -gff rRNA.gff2 genome.fasta<br> <span class="hljs-comment">#result: rRNA.fastaï¼ŒrRNA.gff2ï¼ŒrRNA.hmmreportï¼ŒrRNA.xml</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>annotation</tag>
      
      <tag>Maker2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>count, TPM, FPKM, RPKM in RNA-seq</title>
    <link href="/GeekFocus/2022/03/28/2022-03-28-TPM/"/>
    <url>/GeekFocus/2022/03/28/2022-03-28-TPM/</url>
    
    <content type="html"><![CDATA[<p>CUT&amp;RUN CUT&amp;Tag ChIP-seq ATAC-seq</p><span id="more"></span><p><a href="https://hbctraining.github.io/DGE_workshop/lessons/02_DGE_count_normalization.html">https://hbctraining.github.io/DGE_workshop/lessons/02_DGE_count_normalization.html</a></p><p><a href="https://zhuanlan.zhihu.com/p/150300801">https://zhuanlan.zhihu.com/p/150300801</a></p><p><a href="https://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/">https://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/</a></p>]]></content>
    
    
    <categories>
      
      <category>NGS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>TPM</tag>
      
      <tag>RNA-seq</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€samtoolsã€‘</title>
    <link href="/GeekFocus/2022/03/26/2022-03-26-samtools/"/>
    <url>/GeekFocus/2022/03/26/2022-03-26-samtools/</url>
    
    <content type="html"><![CDATA[<p>Samtools is a suite of programs for interacting with high-throughput sequencing data. It consists of three separate repositories:</p><ul><li><p><strong>Samtools</strong></p><p>Reading&#x2F;writing&#x2F;editing&#x2F;indexing&#x2F;viewing SAM&#x2F;BAM&#x2F;CRAM format</p></li><li><p><strong>BCFtools</strong></p><p>Reading&#x2F;writing BCF2&#x2F;VCF&#x2F;gVCF files and calling&#x2F;filtering&#x2F;summarising SNP and short indel sequence variants</p></li><li><p><strong>HTSlib</strong></p><p>A C library for reading&#x2F;writing high-throughput sequencing data</p></li></ul><span id="more"></span><p>samtools flags â€“ convert between textual and numeric flag representation.</p><p>Each <em>FLAGS</em> argument may be either an integer (in decimal, hexadecimal, or octal) representing a combination of the listed numeric flag values, or a comma-separated string <em>NAME</em><strong>,</strong>â€¦**,**<em>NAME</em> representing a combination of the flag names listed below.</p><p><strong>FLAGS:</strong></p><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td><strong>0x1</strong></td><td>PAIRED</td><td>paired-end (or multiple-segment) sequencing technology</td></tr><tr><td><strong>0x2</strong></td><td>PROPER_PAIR</td><td>each segment properly aligned according to the aligner</td></tr><tr><td><strong>0x4</strong></td><td>UNMAP</td><td>segment unmapped</td></tr><tr><td><strong>0x8</strong></td><td>MUNMAP</td><td>next segment in the template unmapped</td></tr><tr><td><strong>0x10</strong></td><td>REVERSE</td><td>SEQ is reverse complemented</td></tr><tr><td><strong>0x20</strong></td><td>MREVERSE</td><td>SEQ of the next segment in the template is reverse complemented</td></tr><tr><td><strong>0x40</strong></td><td>READ1</td><td>the first segment in the template</td></tr><tr><td><strong>0x80</strong></td><td>READ2</td><td>the last segment in the template</td></tr><tr><td><strong>0x100</strong></td><td>SECONDARY</td><td>secondary alignment</td></tr><tr><td><strong>0x200</strong></td><td>QCFAIL</td><td>not passing quality controls</td></tr><tr><td><strong>0x400</strong></td><td>DUP</td><td>PCR or optical duplicate</td></tr><tr><td><strong>0x800</strong></td><td>SUPPLEMENTARY</td><td>supplementary alignment</td></tr></tbody></table><p> when calc insert size, only calc -f 0x40, reads1 $F[8]?</p><p>Or calc -F 0x4 ,exclude unmapped?</p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>samtools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>perlè¯»å†™</title>
    <link href="/GeekFocus/2022/03/25/2022-03-25-perl/"/>
    <url>/GeekFocus/2022/03/25/2022-03-25-perl/</url>
    
    <content type="html"><![CDATA[<p>å‘½ä»¤è¡Œ å‚æ•° è¯»å…¥ã€‚è¯»å†™</p><span id="more"></span><h2 id="ç¨‹åºåï¼š-0"><a href="#ç¨‹åºåï¼š-0" class="headerlink" title="ç¨‹åºåï¼š$0"></a>ç¨‹åºåï¼š$0</h2><p><code>$0</code>è¡¨ç¤ºå½“å‰<strong>æ­£åœ¨è¿è¡Œçš„Perlè„šæœ¬å</strong>ã€‚æœ‰3ç§æƒ…å†µï¼š</p><ol><li>å¦‚æœæ‰§è¡Œæ–¹å¼ä¸º<code>perl x.pl</code>ï¼Œåˆ™<code>$0</code>çš„å€¼ä¸º<code>x.pl</code>è€Œéperlå‘½ä»¤æœ¬èº«</li><li>å¦‚æœæ‰§è¡Œæ–¹å¼ä¸º<code>./x.pl</code>ï¼Œåˆ™<code>$0</code>çš„å€¼ä¸º<code>./x.pl</code></li><li>å¦‚æœæ‰§è¡Œçš„æ˜¯<code>perl -e</code>æˆ–<code>perl -E</code>ä¸€è¡Œå¼perlç¨‹åºï¼Œåˆ™<code>$0</code>çš„å€¼ä¸º<code>-e</code>æˆ–<code>-E</code></li></ol><h2 id="å‘½ä»¤è¡Œå‚æ•°ARGV"><a href="#å‘½ä»¤è¡Œå‚æ•°ARGV" class="headerlink" title="å‘½ä»¤è¡Œå‚æ•°ARGV"></a>å‘½ä»¤è¡Œå‚æ•°ARGV</h2><ul><li>perlå°†perlå‘½ä»¤è¡Œçš„å‚æ•°åˆ—è¡¨æ”¾è¿›æ•°ç»„ARGV(@ARGV)ä¸­ã€‚æ—¢ç„¶æ˜¯æ•°ç»„ï¼Œå°±å¯ä»¥è®¿é—®($ARGV[n])ã€éå†ï¼Œç”šè‡³ä¿®æ”¹æ•°ç»„å…ƒç´ </li><li>ARGVæ•°ç»„åˆ†ä¸‰ç§æƒ…å†µæ”¶é›†ï¼š<ul><li><code>perl x.pl a b c</code>æ–¹å¼è¿è¡Œæ—¶ï¼Œè„šæœ¬åx.plä¹‹åçš„<code>a b c</code>æ‰ä¼šè¢«æ”¶é›†åˆ°ARGVæ•°ç»„</li><li><code>./x.pl a b c</code>æ–¹å¼è¿è¡Œæ—¶ï¼Œ<code>a b c</code>æ‰ä¼šè¢«æ”¶é›†åˆ°ARGVæ•°ç»„</li><li><code>perl -e &#39;xxxxx&#39; a b c</code>æ–¹å¼è¿è¡Œæ—¶ï¼Œ<code>a b c</code>æ‰ä¼šè¢«æ”¶é›†åˆ°ARGVæ•°ç»„</li></ul></li><li>ARGVæ•°ç»„ç´¢å¼•ä»0å¼€å§‹è®¡ç®—ï¼Œç´¢å¼•0ä½ä»è„šæœ¬å(perlç¨‹åºå)<strong>ä¹‹å</strong>çš„å‚æ•°å¼€å§‹è®¡ç®—</li><li>é»˜è®¤ï¼Œè¿™äº›å‘½ä»¤è¡Œå‚æ•°æ˜¯perlç¨‹åºçš„æ•°æ®è¾“å…¥æºï¼Œä¹Ÿå°±æ˜¯perlä¼šä¾æ¬¡å°†å®ƒä»¬å½“ä½œæ–‡ä»¶è¿›è¡Œè¯»å–</li><li>å‚æ•°æ˜¯æœ‰åºçš„ï¼Œè¯»å–çš„æ—¶å€™ä¹Ÿæ˜¯æœ‰åºçš„</li><li>éœ€è¦åŒºåˆ†ARGVå˜é‡å’ŒARGVæ•°ç»„ï¼š<ul><li><code>$ARGV</code>è¡¨ç¤ºå‘½ä»¤è¡Œå‚æ•°ä»£è¡¨çš„æ–‡ä»¶åˆ—è¡¨ä¸­ï¼Œå½“å‰è¢«å¤„ç†çš„æ–‡ä»¶å</li><li><code>@ARGV</code>è¡¨ç¤ºå‘½ä»¤è¡Œå‚æ•°æ•°ç»„</li><li><code>$ARGV[n]</code>ï¼šè¡¨ç¤ºå‘½ä»¤è¡Œå‚æ•°æ•°ç»„çš„å…ƒç´ </li><li><code>ARGV</code>ï¼šè¡¨ç¤º<code>&lt;&gt;</code>å½“å‰æ­£åœ¨å¤„ç†çš„æ–‡ä»¶å¥æŸ„</li></ul></li></ul><p>ä¾‹å¦‚ï¼Œtest.plxçš„å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs nsis"><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-number">3</span><br><span class="hljs-number">4</span><br><span class="hljs-number">5</span><br><span class="hljs-number">6</span><br><span class="hljs-number">7</span><br>/usr/bin/perl<br><br><span class="hljs-literal">print</span> <span class="hljs-string">&#x27;<span class="hljs-variable">$ARGV</span>[0] ---&gt; &#x27;</span>,<span class="hljs-variable">$ARGV</span>[<span class="hljs-number">0</span>],<span class="hljs-string">&quot;\n&quot;</span>,<br>      <span class="hljs-string">&#x27;<span class="hljs-variable">$ARGV</span>[1] ---&gt; &#x27;</span>,<span class="hljs-variable">$ARGV</span>[<span class="hljs-number">1</span>],<span class="hljs-string">&quot;\n&quot;</span>,<br>      <span class="hljs-string">&#x27;<span class="hljs-variable">$ARGV</span>[2] ---&gt; &#x27;</span>,<span class="hljs-variable">$ARGV</span>[<span class="hljs-number">2</span>],<span class="hljs-string">&quot;\n&quot;</span>,<br>      <span class="hljs-string">&#x27;<span class="hljs-variable">$ARGV</span>[3] ---&gt; &#x27;</span>,<span class="hljs-variable">$ARGV</span>[<span class="hljs-number">3</span>],<span class="hljs-string">&quot;\n&quot;</span>,<br>      <span class="hljs-string">&#x27;<span class="hljs-variable">$ARGV</span>[4] ---&gt; &#x27;</span>,<span class="hljs-variable">$ARGV</span>[<span class="hljs-number">4</span>],<span class="hljs-string">&quot;\n&quot;</span><span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>æ‰§è¡Œè¿™ä¸ªç¨‹åºï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-number">3</span><br><span class="hljs-number">4</span><br><span class="hljs-number">5</span><br><span class="hljs-number">6</span><br>shell&gt; ./test<span class="hljs-selector-class">.plx</span> -w <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">b</span> c d<br><span class="hljs-variable">$ARGV</span><span class="hljs-selector-attr">[0]</span> ---&gt; -w<br><span class="hljs-variable">$ARGV</span><span class="hljs-selector-attr">[1]</span> ---&gt; <span class="hljs-selector-tag">a</span><br><span class="hljs-variable">$ARGV</span><span class="hljs-selector-attr">[2]</span> ---&gt; <span class="hljs-selector-tag">b</span><br><span class="hljs-variable">$ARGV</span><span class="hljs-selector-attr">[3]</span> ---&gt; c<br><span class="hljs-variable">$ARGV</span><span class="hljs-selector-attr">[4]</span> ---&gt; d<br></code></pre></td></tr></table></figure><p>å› ä¸ºæ˜¯æ•°ç»„ï¼Œæ‰€ä»¥å¯ä»¥ä¿®æ”¹æ•°ç»„ï¼Œæ¯”å¦‚å¼ºåˆ¶æŒ‡å®šå…ƒç´ ï¼š</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-number">3</span><br><span class="hljs-number">4</span><br><span class="hljs-number">5</span><br><span class="hljs-number">6</span><br>/usr/bin/perl<br><br>@ARGV=<span class="hljs-string">qw(first second third)</span>;<br><span class="hljs-keyword">print</span> <span class="hljs-string">&#x27;$ARGV[0] ---&gt; &#x27;</span>,$ARGV[<span class="hljs-number">0</span>],<span class="hljs-string">&quot;\n&quot;</span>,<br>      <span class="hljs-string">&#x27;$ARGV[1] ---&gt; &#x27;</span>,$ARGV[<span class="hljs-number">1</span>],<span class="hljs-string">&quot;\n&quot;</span>,<br>      <span class="hljs-string">&#x27;$ARGV[2] ---&gt; &#x27;</span>,$ARGV[<span class="hljs-number">2</span>],<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-number">3</span><br><span class="hljs-number">4</span><br>shell&gt; ./test.plx a b c d<br>$ARGV[<span class="hljs-number">0</span>] ---&gt; first<br>$ARGV[<span class="hljs-number">1</span>] ---&gt; second<br>$ARGV[<span class="hljs-number">2</span>] ---&gt; third<br></code></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œè¯»å–2ä¸ªæ–‡ä»¶(a.log,b.log)çš„å†…å®¹ï¼š</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs stata">1<br>2<br>3<br>4<br>5<br>/usr/bin/perl<br><br><span class="hljs-keyword">while</span>(&lt;&gt;)&#123;<br>    <span class="hljs-keyword">print</span> <span class="hljs-variable">$_</span>;<br>&#125;<br><span class="hljs-keyword">shell</span>&gt; ./<span class="hljs-keyword">test</span>.plx a.<span class="hljs-keyword">log</span> b.<span class="hljs-keyword">log</span><br></code></pre></td></tr></table></figure><p>å¦‚æœæƒ³è¯»å–æ ‡å‡†è¾“å…¥ï¼Œåªéœ€ä½¿ç”¨â€-â€œä½œä¸ºæ–‡ä»¶å‚æ•°å³å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;abcd\nefg&quot;</span> | ./test.plx a.log - b.log</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢å°†æŒ‰å…ˆåé¡ºåºè¯»å–a.logï¼Œæ ‡å‡†è¾“å…¥(ç®¡é“å·¦è¾¹å‘½ä»¤çš„è¾“å‡ºå†…å®¹)ï¼Œb.logã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs æ•´ä½“è¯»å…¥ï¼Œé€è¡Œå¤„ç†">open(FILE,&quot;&lt;&quot;,&quot;/home/chenmi/.bashrc&quot;)||die&quot;cannot open the file: $!\n&quot;; <br>@linelist=&lt;FILE&gt;; <br>foreach $eachline(@linelist)&#123; <br>       print $eachline; <br>&#125; <br>close FILE; <br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs é€è¡Œè¯»å…¥ï¼Œè¾¹è¯»è¾¹å¤„ç†">open(FILE,&quot;&lt;&quot;,&quot;/home/chenmi/.bashrc&quot;)||die&quot;cannot open the file: $!\n&quot;; <br>while (&lt;FILE&gt;)&#123; <br>       print; <br>&#125; <br>close FILE; <br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Perl</category>
      
    </categories>
    
    
    <tags>
      
      <tag>perl</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>S-Locus</title>
    <link href="/GeekFocus/2022/03/22/2022-03-22-S-Locus/"/>
    <url>/GeekFocus/2022/03/22/2022-03-22-S-Locus/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><hr><h1 id="Part1-æ¤ç‰©Sä½ç‚¹è‡ªäº¤ä¸äº²å’Œæœºåˆ¶ç ”ç©¶çš„æ€åŠ¿åˆ†æ2016"><a href="#Part1-æ¤ç‰©Sä½ç‚¹è‡ªäº¤ä¸äº²å’Œæœºåˆ¶ç ”ç©¶çš„æ€åŠ¿åˆ†æ2016" class="headerlink" title="Part1:æ¤ç‰©Sä½ç‚¹è‡ªäº¤ä¸äº²å’Œæœºåˆ¶ç ”ç©¶çš„æ€åŠ¿åˆ†æ2016"></a>Part1:<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml">æ¤ç‰©Sä½ç‚¹è‡ªäº¤ä¸äº²å’Œæœºåˆ¶ç ”ç©¶çš„æ€åŠ¿åˆ†æ2016</a></h1><p><strong>æ¤ç‰©è‡ªäº¤ä¸äº²å’Œæ€§</strong>å¹¿æ³›å­˜åœ¨äº<strong>æ˜¾èŠ±æ¤ç‰©</strong>,æ˜¯<strong>é˜²æ­¢è¿‘äº²ç¹æ®–</strong>å’Œ<strong>ä¿ƒè¿›å¼€èŠ±æ¤ç‰©é—ä¼ å¤šæ ·æ€§</strong>å’Œ<strong>æ‚ç§ä¼˜åŠ¿</strong>çš„é‡è¦é—ä¼ æœºåˆ¶ã€‚å…³äºè‡ªäº¤ä¸äº²å’Œæœºåˆ¶çš„ç ”ç©¶å¤šé›†ä¸­åœ¨<strong>SåŸºå› </strong>ä¸Šã€‚è¯¥æ–‡ç»“åˆæ–‡çŒ®è®¡é‡çš„æ–¹æ³•,åˆ©ç”¨Hisciteã€Citespaceå’ŒVosVieweråˆ†æäº†<strong>åŸºäºSä½ç‚¹</strong>çš„æ¤ç‰©<strong>è‡ªäº¤ä¸äº²å’Œæœºåˆ¶ç ”ç©¶</strong>çš„å¹´ä»£è¶‹åŠ¿ã€é‡ç‚¹å›½å®¶ã€é‡è¦æœºæ„ã€é‡è¦ä½œè€…ã€ç ”ç©¶å‰æ²¿å’Œç ”ç©¶çƒ­ç‚¹,å¯¹<strong>è›‹ç™½è´¨ç£·é…¸åŒ–</strong>ã€<strong>S-RNaseæ³›ç´ åŒ–</strong>å’Œ<strong>æ‹Ÿå—èŠ¥å±çš„æ¼”åŒ–</strong>ä½œç®€è¦è®ºè¿°,å¹¶æ ¹æ®ç›®å‰ç ”ç©¶ç°çŠ¶æå‡ºè¯¥é¢†åŸŸç ”ç©¶ä¸­å­˜åœ¨çš„é—®é¢˜åŠè§£å†³å¯¹ç­–,æ—¨åœ¨ä¸ºè¿›ä¸€æ­¥ç ”ç©¶æä¾›é‡è¦å‚è€ƒä¾æ®ã€‚</p><p><strong>1 å¼•è¨€</strong></p><p>è‡ªäº¤ä¸äº²å’Œæ€§(self-incompatibility, SI)æ˜¯æŒ‡å…·æœ‰<strong>å®Œå…¨èŠ±</strong>å¹¶èƒ½å½¢æˆ<strong>æ­£å¸¸é›Œã€é›„é…å­</strong>,ç„¶è€Œ<strong>ç¼ºä¹è‡ªèŠ±æˆç²‰ç»“å®</strong>èƒ½åŠ›çš„ä¸€ç§<strong>è‡ªäº¤ä¸è‚²</strong>æ€§,<strong>å¸¸</strong>å­˜åœ¨äº<strong>é›Œé›„åŒæ ªçš„æ¤ç‰©</strong>,è‡ªäº¤ä¸äº²å’Œç°è±¡å¹¿æ³›åˆ†å¸ƒåœ¨æ˜¾èŠ±æ¤ç‰©ä¸­[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b1-1673-5668-11-4-9">1</a>]ã€‚SIæ˜¯é˜²æ­¢è¿‘äº²ç¹æ®–å’Œä¿ƒè¿›å¼€èŠ±æ¤ç‰©é—ä¼ å¤šæ ·æ€§å’Œæ‚ç§ä¼˜åŠ¿çš„é‡è¦é—ä¼ æœºåˆ¶[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b2-1673-5668-11-4-9">2</a>]ã€‚åŸºäº<strong>èŠ±ç²‰è¯†åˆ«ç‰¹å¼‚æ€§</strong>çš„<strong>é—ä¼ å†³å®šæ–¹å¼</strong>,SIå¯åˆ†ä¸º<strong>é…å­ä½“å‹è‡ªäº¤ä¸äº²å’Œæ€§</strong>(<strong>gametophytic</strong> self-incompatibility, GSI)å’Œ<strong>å­¢å­ä½“å‹è‡ªäº¤ä¸äº²å’Œæ€§</strong>(sporophytic self-incompatibility, SSI) [<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b3-1673-5668-11-4-9">3</a>]ã€‚<font color="red"><strong>GSI</strong>å³æ˜¯<strong>èŠ±ç²‰</strong>åœ¨<strong>æŸ±å¤´ä¸Šå‘èŠ½</strong>å<strong>å¯ä¾µå…¥æŸ±å¤´</strong>,ä¸”èƒ½<strong>åœ¨èŠ±æŸ±ç»„ç»‡</strong>ä¸­<strong>å»¶ä¼¸ä¸€å®šè·ç¦»</strong>,<strong>ä¹‹åå—åˆ°æŠ‘åˆ¶</strong></font>ã€‚èŠ±ç²‰ç®¡ä¸é›Œæ€§å› ç´ çš„æŠ‘åˆ¶å…³ç³»å‘ç”Ÿåœ¨å•å€ä½“é…å­ä½“ä¹‹é—´,å¸¸è§äº<font color="red"><strong>ç½‚ç²Ÿç§‘</strong>(Papaveraceae)ã€<strong>è”·è–‡ç§‘</strong>(Rosaceae)ã€<strong>èŒ„ç§‘</strong>(Solanaceae)<strong>å’Œç„å‚ç§‘</strong>(Scrophulariaceae)</font>çš„ä¸€äº›æ¤ç‰©[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b4-1673-5668-11-4-9">4</a>]ã€‚<font color="red">æ­¤ç§æŠ‘åˆ¶å…³ç³»å¯ä»¥å‘ç”Ÿåœ¨<strong>èŠ±æŸ±ç»„ç»‡ä¸­</strong>,ä¹Ÿèƒ½å‘ç”Ÿåœ¨<strong>èŠ±ç²‰ç®¡ä¸èƒšå›Šç»„ç»‡ä¹‹é—´</strong>,æœ‰çš„ç”šè‡³æ˜¯<strong>ç²¾å­å·²ç»åˆ°è¾¾èƒšå›Šå†…,ä»ç„¶ä¸èƒ½ä¸åµç»†èƒç»“åˆ</strong></font>[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b5-1673-5668-11-4-9">5</a>]ã€‚<font color="blue"><strong>SSI</strong>å³æ˜¯èŠ±ç²‰è½åˆ°æŸ±å¤´ä¸Š<strong>ä¸èƒ½æ­£å¸¸å‘èŠ½</strong>,æˆ–è€…<strong>å‘èŠ½ä¹‹å</strong>åœ¨æŸ±å¤´ä¹³çªç»†èƒä¸Šç¼ ç»•è€Œ<strong>æ— æ³•ä¾µå…¥æŸ±å¤´</strong></font>ã€‚è¿™ç§ä¸äº²å’Œå…³ç³»å‘ç”Ÿåœ¨<strong>èŠ±ç²‰ç®¡ä¸æŸ±å¤´ä¹³çªç»†èƒçš„å­¢å­ä½“ä¹‹é—´</strong>,èŠ±ç²‰çš„è¡Œä¸ºå†³å®šäºäºŒå€ä½“äº²æœ¬çš„åŸºå› å‹,å¤šè§äº<font color="blue"><strong>æ²¹èœ</strong>ã€<strong>æ‹Ÿå—èŠ¥</strong>ç­‰<strong>åå­—èŠ±ç§‘</strong></font>(Brassicaceae)æ¤ç‰©ä¸­[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b6-1673-5668-11-4-9">6</a>]ã€‚</p><p><font color="red">æ¤ç‰©<strong>å—ç²‰</strong>è¿‡ç¨‹åŒ…æ‹¬<strong>èŠ±ç²‰è½åˆ°æŸ±å¤´ä¸Š</strong>ã€<strong>ç²˜é™„</strong>ã€<strong>æ°´åˆ</strong>ã€<strong>èŒå‘</strong>,<strong>èŠ±ç²‰ç®¡ç”Ÿé•¿</strong>ã€<strong>èŠ±ç²‰åˆ°è¾¾èƒšç å®Œæˆå—ç²¾</strong>ä½œç”¨å‡ ä¸ªé˜¶æ®µ,æ¤ç‰©è‡ªäº¤ä¸äº²å’Œååº”çš„è¯†åˆ«å¯å‘ç”Ÿåœ¨å—ç²‰è¿‡ç¨‹çš„<strong>ä»»ä½•é˜¶æ®µ</strong></font>[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b7-1673-5668-11-4-9">7</a>]ã€‚</p><p>å¦‚<font color="green"><strong>æ‹Ÿå—èŠ¥</strong></font>çš„è¯†åˆ«å‘ç”Ÿåœ¨<font color="green"><strong>èŠ±ç²‰æ°´åˆé˜¶æ®µ</strong></font>[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b8-1673-5668-11-4-9">8</a>, <a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b9-1673-5668-11-4-9">9</a>];</p><p><font color="green"><strong>ç½‚ç²Ÿ</strong></font>çš„ä¸äº²å’Œååº”å‘ç”Ÿåœ¨<font color="green"><strong>èŠ±ç²‰èŒå‘é˜¶æ®µ</strong></font>[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b10-1673-5668-11-4-9">10</a>];</p><p><font color="green"><strong>é‡‘é±¼è‰</strong></font>çš„è¯†åˆ«å’Œä¸äº²å’Œååº”éƒ½å‘ç”Ÿåœ¨<font color="green"><strong>èŠ±ç²‰ç®¡å†…éƒ¨</strong></font>[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b11-1673-5668-11-4-9">11</a>]ã€‚</p><p>ä¸€ä¸ªåŸºå› å­˜åœ¨å¤šç§ç­‰ä½åŸºå› ç§°ä¸ºå¤ç­‰ä½åŸºå› ï¼ˆmultiple allelismï¼‰ã€‚ä»»ä½•ä¸€ä¸ªæ‚åˆäºŒå€ä½“åªå­˜åœ¨å¤ç­‰ä½åŸºå› ä¸­çš„ä¸¤ä¸ªä¸åŒçš„ç­‰ä½åŸºå› ã€‚äººABOè¡€å‹ç³»ç»Ÿ IAã€IBã€i ã€‚å…¶ä¸­ï¼ŒIA<strong>å’Œ</strong>IBå¯¹ i æ˜¾æ€§ï¼ŒIA<strong>ä¸</strong>IBå…±æ˜¾æ€§ã€‚æ¯ä¸ªäººåªèƒ½æœ‰å…¶ä¸­çš„ä¸¤ä¸ªåŸºå› ã€‚</p><p>ä¸è®ºæ˜¯GSIè¿˜æ˜¯SSIé—ä¼ ä¸Šéƒ½æ˜¯ç”±<font color="darkred"><strong>ç‰¹å®š</strong>çš„<strong>å¤ç­‰ä½åŸºå› </strong>æ§åˆ¶</font>,å¤§å¤šæ•°æ¤ç‰©çš„è‡ªäº¤ä¸äº²å’Œæ€§æ˜¯ç”±<font color="darkred"><strong>å•ä¸€</strong>çš„<strong>å¤ç­‰ä½åŸºå› ä½ç‚¹</strong>æ§åˆ¶,ç§°ä¸º<strong>Sä½ç‚¹</strong>(S-locus),Sä½ç‚¹å…·æœ‰<strong>é«˜åº¦å¤šæ€æ€§</strong></font>[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b3-1673-5668-11-4-9">3</a>]ã€‚<strong>å°‘æ•°æ¤ç‰©</strong>çš„è‡ªäº¤ä¸äº²å’Œæ€§æ˜¯ç”±<strong>ä¸¤ä¸ªåŠä»¥ä¸Šä½ç‚¹æ§åˆ¶</strong>çš„,å¦‚<font color="darkred"><strong>ç¦¾æœ¬ç§‘</strong></font>çš„è‡ªäº¤ä¸äº²å’Œæ€§ç”±<font color="darkred"><strong>Så’ŒZ</strong>ä¸¤ä¸ª<strong>äº’ä¸è¿é”</strong>çš„é—ä¼ ä½ç‚¹<strong>å…±åŒ</strong>æ§åˆ¶</font>[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b12-1673-5668-11-4-9">12</a>]ã€‚Sä½ç‚¹é€šå¸¸åŒ…å«ä¸¤ç±»åŸºå› ï¼š<font color="darkred">å†³å®š<strong>èŠ±ç²‰è¯†åˆ«ç‰¹å¼‚æ€§</strong>çš„<strong>èŠ±ç²‰SåŸºå› </strong></font>ä¸<font color="darkred">å†³å®š<strong>èŠ±æŸ±è¯†åˆ«ç‰¹å¼‚æ€§</strong>çš„<strong>èŠ±æŸ±SåŸºå› </strong></font>ã€‚<font color="red"><strong>è”·è–‡ç§‘ã€ç„å‚ç§‘å’ŒèŒ„ç§‘</strong>çš„<strong>èŠ±æŸ±</strong>å’Œ<strong>èŠ±ç²‰å†³å®šå› å­</strong>è¢«é‰´å®šä¸º<strong>S-æ ¸é…¸é…¶</strong>(S-RNase)å’Œ<strong>F-boxè›‹ç™½</strong></font>[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b13-1673-5668-11-4-9">13</a>]ã€‚<font color="blue"><strong>åå­—èŠ±ç§‘</strong>çš„<strong>èŠ±æŸ±</strong>å’Œ<strong>èŠ±ç²‰å†³å®šå› å­</strong>ä¸º<strong>Sä½ç‚¹å—ä½“æ¿€é…¶</strong></font> (<strong>S-locus receptor kinase</strong> , <font color="blue">SRK</font>)å’Œ<font color="blue"><strong>SCR</strong></font>(<strong>S-locus cysteine-rich</strong>)[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b9-1673-5668-11-4-9">9</a>]ã€‚è€Œ<font color="green"><strong>ç½‚ç²Ÿç§‘</strong>çš„<strong>èŠ±æŸ±</strong>å’Œ<strong>èŠ±ç²‰å†³å®šå› å­</strong></font>ä¸º<strong>PrsS</strong>(Palaver rhoeas <strong>stigma</strong> S-determinant)å’Œ<strong>PrpS</strong>(Papaver rhoeas <strong>pollen</strong> S-determinant),ä¸”é€šè¿‡<font color="green"><strong>èŠ±ç²‰ç®¡èƒè´¨è‡ªç”±Ca2+<strong>ä»‹å¯¼çš„</strong>ä¿¡å·çº§è”</strong>æ¿€æ´»</font>ä½œç”¨æ¥è°ƒæ§[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b14-1673-5668-11-4-9">14</a>]ã€‚SIæ˜¯ç ”ç©¶æœ‰æ€§æ¤ç‰©ç”Ÿæ®–ç»†èƒé—´<strong>ä¿¡å·è¯†åˆ«ã€è½¬å¯¼</strong>ä»¥åŠ<strong>ç»†èƒé—´ç›¸äº’ä½œç”¨</strong>çš„ä¸€ç§<strong>ç†æƒ³æ¨¡å‹</strong>,åœ¨æ¤ç‰©<strong>é—ä¼ æ”¹è‰¯</strong>å’Œ<strong>ä½œç‰©æ‚ç§ä¼˜åŠ¿åˆ©ç”¨</strong>ä¸Šå…·æœ‰é‡è¦ä»·å€¼ã€‚</p><p>æœ¬æ–‡æ–‡çŒ®ä¿¡æ¯æºè‡ªäºæ±¤æ£®è·¯é€çš„<em>Web of Science</em>æ•°æ®åº“æ ¸å¿ƒåˆé›†,é€šè¿‡æ£€ç´¢å¼TS&#x3D; Self-Incompatibilit* and (s-rnase or f-box or S-locus or â€œs geneâ€),é€‰å–äº†1990â€“2016å¹´çš„å…¨éƒ¨æ–‡çŒ®è®°å½•å…±è®¡<strong>1 310æ¡</strong>,æ•°æ®åº“æ›´æ–°æ—¶é—´ä¸º2016å¹´3æœˆ19æ—¥,å…¶ä¸­2016å¹´æ–‡çŒ®è®°å½•ä¸º4æ¡ã€‚åˆ©ç”¨Hisciteã€Citespaceã€Excelã€VosViewerè½¯ä»¶åˆ†æäº†æœ‰å…³æ¤ç‰©Sä½ç‚¹è‡ªäº¤ä¸äº²å’Œæœºåˆ¶ç ”ç©¶çš„å¹´ä»£è¶‹åŠ¿ã€é‡ç‚¹å›½å®¶ã€é‡è¦æœºæ„ã€é‡è¦ä½œè€…ã€ç ”ç©¶å‰æ²¿ä¸ç ”ç©¶çƒ­ç‚¹,æ—¨åœ¨ä¸ºè¿›ä¸€æ­¥ç ”ç©¶æä¾›å‚è€ƒã€‚</p><p><strong>2 æ¤ç‰©Sä½ç‚¹è‡ªäº¤ä¸äº²å’Œæœºåˆ¶æ€»ä½“ç ”ç©¶ç°çŠ¶å’Œå‘å±•è¶‹åŠ¿</strong></p><p><strong>2.1 å¹´åº¦å‘å±•è¶‹åŠ¿</strong></p><p>æ¤ç‰©Sä½ç‚¹è‡ªäº¤ä¸äº²å’Œæœºåˆ¶å¹´åº¦å‘æ–‡é‡å¦‚<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9/img_1.png">å›¾1</a>æ‰€ç¤ºã€‚æ€»ä½“è€Œè¨€,æ¤ç‰©è‡ªäº¤ä¸äº²å’Œæœºåˆ¶ç ”ç©¶é¢†åŸŸå‘æ–‡é‡è¾ƒå°‘,è‡ª1990å¹´å¼€å§‹ç¨³æ­¥ä¸Šå‡,å…·æœ‰é‡è¦æ„ä¹‰å’Œå¹¿æ³›å‰æ™¯ã€‚</p><p><strong>2.2 å›½å®¶åˆ†æ</strong></p><p>ç»“åˆHistciteè½¯ä»¶å’Œ<em>Web of Science</em>æ•°æ®åº“å¯¹æ–‡çŒ®åˆ†å¸ƒæƒ…å†µè¿›è¡Œç»Ÿè®¡,åœ¨è¿™26å¹´å†…,<em>Web of Science</em>æ•°æ®åº“ä¸­è®°å½•çš„å‘æ–‡æ•°é‡å‰10å›½å®¶å¦‚è¡¨1æ‰€ç¤ºã€‚ç¾å›½342ç¯‡,å 26.11%ã€‚æ—¥æœ¬å 24.58%ã€‚ä¸­å›½å’Œè‹±æ ¼å…°ç´§éšå…¶å,ä½†å‡ä¸åˆ°ç¾å›½å’Œæ—¥æœ¬çš„ä¸€åŠã€‚ä»å¼•ç”¨çœ‹,ç¾å›½è®ºæ–‡æ€»è¢«å¼•ä¸º15 273æ¬¡,è¿œè¶…å…¶ä»–å›½å®¶;æ—¥æœ¬æ¬¡ä¹‹,è¢«å¼•9 483æ¬¡ã€‚äºŒè€…è¢«å¼•æ˜¾è‘—é«˜äºå…¶ä»–å›½å®¶ã€‚1 310ç¯‡,è¢«å¼•â‰¥50çš„è®ºæ–‡æ€»è®¡220ç¯‡ã€‚<strong>ä¸­å›½</strong>å‘æ–‡é‡è™½è¾ƒå¤š,ä½†è¢«å¼•æ¬¡æ•°<strong>â‰¥50</strong>çš„è®ºæ–‡<strong>ä»…9ç¯‡</strong>,ä»å­˜åœ¨å·®è·ã€‚</p><p>å›½å®¶é—´åˆä½œã€‚è‹æ ¼å…°ã€è‹±æ ¼å…°ã€æ¾³å¤§åˆ©äºšã€åŠ æ‹¿å¤§ä¸å…¶ä»–å›½å®¶åˆä½œè¾ƒå¤šã€‚å…¶ä¸­è‹æ ¼å…°ä¸å‘æ–‡é‡è¾ƒå¤šçš„æ¾³å¤§åˆ©äºšã€è‹±æ ¼å…°ã€åŠ æ‹¿å¤§ã€æ³•å›½ã€è‘¡è„ç‰™ã€ä¸¹éº¦å‡æœ‰åˆä½œã€‚ç¾å›½ä¸æ—¥æœ¬æœ‰åˆä½œ,æ—¥æœ¬ä¸æ¾³å¤§åˆ©äºšå’Œå¾·å›½åˆä½œç›¸å¯¹ç´§å¯†,è€Œä¸­å›½ä»…ä¸è‘¡è„ç‰™ä¸€ä¸ªå›½å®¶æœ‰è¿‡åˆä½œã€‚</p><p><strong>2.3 æœºæ„åˆ†æ</strong></p><p>åº·å¥ˆå°”å¤§å­¦ã€ä¸œåŒ—å¤§å­¦ã€äº¬éƒ½å¤§å­¦å‘æ–‡é‡ä½å±…å‰ä¸‰ã€‚ä¸­ç§‘é™¢å’Œå—å†œå‘æ–‡é‡ä»…æ¬¡äºå‰5ä¸ªæœºæ„,ä½†æ˜¯æ–‡ç« è¢«å¼•é¢‘æ¬¡è¿œè¿œè½å,å­˜åœ¨å·®è·,è€Œ2010å¹´è‡³ä»Šçš„å‘æ–‡é‡è·ƒå±…å‰3,è¯´æ˜è¿‘å¹´æ¥åœ¨è¯¥é¢†åŸŸåŠ å¤§äº†ç ”ç©¶åŠ›åº¦ã€‚ç»¼åˆè¯„ä»·,åº·å¥ˆå°”å¤§å­¦ã€ä¸œåŒ—å¤§å­¦ã€äº¬éƒ½å¤§å­¦ã€å¥ˆè‰¯å…ˆç«¯ç§‘å­¦æŠ€æœ¯å¤§å­¦é™¢å¤§å­¦å’Œå®¾å·å·ç«‹å¤§å­¦æ˜¯æ¤ç‰©Sä½ç‚¹è‡ªäº¤ä¸äº²å’Œé¢†åŸŸç ”ç©¶çš„é‡è¦æœºæ„ã€‚</p><p><strong>2.4 é‡è¦ä½œè€…åˆ†æ</strong></p><p>é‡è¦ä½œè€…åˆ†ææ˜¯åˆ†æå­¦ç§‘é¢†åŸŸå‘å±•çŠ¶å†µé‡è¦ç¯èŠ‚,é€šè¿‡åˆ†æé‡è¦ä½œè€…æ‰€å‘è¡¨çš„ç§‘ç ”æˆæœèƒ½å¯¹è¯¥å­¦ç§‘é¢†åŸŸçš„ä¸»è¦ç ”ç©¶å†…å®¹æœ‰å¤§è‡´äº†è§£ã€‚è€Œåˆ†æ<strong>ä½œè€…åˆ†å¸ƒ</strong>åŠ<strong>åˆä½œç½‘ç»œ</strong>æ˜¯ç¡®å®šæŸç ”ç©¶é¢†åŸŸ<strong>æ ¸å¿ƒä½œè€…ç¾¤</strong>çš„é‡è¦æ–¹æ³•ã€‚æœ¬ç€å‘æ–‡é‡ã€å…¨çƒæ€»è¢«å¼•ã€æœ¬åœ°æ€»è¢«å¼•3é¡¹æŒ‡æ ‡,é€‰å–10ä½é‡è¦ä½œè€…,å¹¶ç»Ÿè®¡å…¶ä½œä¸ºé€šè®¯ä½œè€…çš„å‘æ–‡é‡å’Œè¿‘6å¹´çš„å‘æ–‡é‡ã€‚å…¶ä¸­ISOGAI Aå’ŒHINATA Kè¿‘6å¹´å‘æ–‡é‡ä¸ºé›¶,è¡¨æ˜ä»–ä»¬æ›¾å¯¹è¯¥é¢†åŸŸåšå‡ºäº†å·¨å¤§çš„è´¡çŒ®,è€Œå…¶ä½™8ä½ä½œè€…æŒç»­æ¤ç‰©è‡ªäº¤ä¸äº²å’Œæœºåˆ¶ç ”ç©¶ã€‚</p><p><strong>3 æ¤ç‰©Sä½ç‚¹è‡ªäº¤ä¸äº²å’Œæœºåˆ¶ç ”ç©¶çƒ­ç‚¹åŠå‰æ²¿</strong></p><p>æ¤ç‰©Sä½ç‚¹è‡ªäº¤ä¸äº²å’Œæœºåˆ¶ç ”ç©¶ç›¸å…³çš„3ä¸ªé‡è¦è¯ï¼š<font color="red"><strong>äººå·¥åˆæˆ</strong>(resynthesized)ã€<strong>æ¿€é…¶</strong>(kinase)ã€<strong>ç£·é…¸åŒ–è›‹ç™½è´¨ç»„å­¦</strong>(phosphoproteomic)</font>ã€‚æ¤ç‰©Sä½ç‚¹è‡ªäº¤ä¸äº²å’Œæœºåˆ¶ç ”ç©¶è¿½æº¯åˆ°1955,è‡ª1990å¹´å,æ¶Œç°å¤§é‡æˆæœã€‚æ—©æœŸå…³äºSåŸºå› çš„ç ”ç©¶é›†ä¸­åœ¨äººå·¥åˆæˆç”˜è“å‹æ²¹èœ,è¿‘å¹´çš„ç ”ç©¶çƒ­ç‚¹ä¸º<font color="red">Sä½ç‚¹<strong>å—ä½“æ¿€é…¶</strong>å’Œ<strong>è›‹ç™½è´¨ç£·é…¸åŒ–</strong></font>ã€‚å‰æ²¿ç›¸å…³æ€§è¾ƒå¼ºçš„è¯ï¼ševolutionã€brassicaceaeã€arabidopsis,å³åå­—èŠ±ç§‘,å°¤å…¶æ‹Ÿå—èŠ¥æ¼”åŒ–æ˜¯å…¶ç ”ç©¶çƒ­ç‚¹ã€‚é¢†åŸŸç ”ç©¶çƒ­ç‚¹åŠå‰æ²¿ 3ä¸ªæ–¹é¢ï¼š<font color="red"><strong>è›‹ç™½è´¨ç£·é…¸åŒ–</strong>ã€<strong>S-RNaseæ³›ç´ åŒ–</strong>å’Œ<strong>SRKä»‹å¯¼çš„æ‹Ÿå—èŠ¥å±æ¼”åŒ–</strong></font>ã€‚</p><p><strong>3.1 è›‹ç™½è´¨ç£·é…¸åŒ–</strong></p><p>è›‹ç™½è´¨ç£·é…¸åŒ–ç”Ÿç‰©ä½“å†…å¹¿æ³›å­˜åœ¨,å‘ç”Ÿåœ¨SIä¿¡å·è½¬å¯¼æ—©æœŸé˜¶æ®µ,åœ¨è°ƒæ§<strong>æŸ±å¤´ä¹³çªç»†èƒ</strong>å¯¹<strong>ç»†èƒå¤–çš„ä¿¡å·è¯†åˆ«</strong>åŠ<strong>ç»†èƒå†…çš„ä¿¡å·ä¼ é€’</strong>æ–¹é¢èµ·é‡è¦ä½œç”¨[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b15-1673-5668-11-4-9">15</a>]ã€‚<strong>SRK</strong>çš„<strong>ç»“æ„åŸŸ</strong>é€šè¿‡<strong>èƒå¤–åŸŸ</strong>ç‰¹å¼‚æ€§åœ°<strong>ä¸SCRç»“åˆ</strong>,å¼•èµ·<strong>èƒå†…æ¿€é…¶åŸŸ</strong>çš„<strong>è‡ªç£·é…¸åŒ–</strong>ã€‚<strong>Mä½ç‚¹è›‹ç™½æ¿€é…¶</strong>(M locus protein kinase, MLPK)æ˜¯ç”˜è“çš„ä¸€ç§éå—ä½“è›‹ç™½æ¿€é…¶,èƒ½å¤Ÿä¸<strong>SRK</strong>å½¢æˆ<strong>ä¿¡å·å¤åˆä½“</strong>ã€‚è¯¥ä¿¡å·å¤åˆä½“çš„ç£·é…¸åŒ–å¼•èµ·ä¸‹æ¸¸ç»„åˆ†çš„<strong>çº§è”</strong>ååº”,ä»è€Œå¯¼è‡´<strong>è‡ªäº¤ä¸äº²å’Œ</strong>ç°è±¡çš„å‘ç”Ÿ[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b16-1673-5668-11-4-9">16</a>]ã€‚Poulterç­‰[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b10-1673-5668-11-4-9">10</a>]ä¹Ÿè¯å®å¯æº¶æ€§æ— æœºç„¦ç£·é…¸é…¶(soluble inorganic pyrophosphatases)å’Œä¸è£‚åŸæ´»åŒ–è›‹ç™½æ¿€é…¶ (mitogen-activated protein kinases, MAPKs)çš„ç£·é…¸åŒ–æ˜¯SIçš„ä¸‹æ¸¸ååº”ã€‚åˆ°ç›®å‰ä¸ºæ­¢,è™½ç„¶å·²åœ¨SIä¿¡å·è½¬å¯¼é€šè·¯ä¸­é‰´å®šå‡ºä¸€äº›è›‹ç™½ç£·é…¸é…¶å’Œè›‹ç™½æ¿€é…¶,ä½†è¿˜æ˜¯<strong>æœªèƒ½è§£é‡Š</strong>è‡ªäº¤èŠ±ç²‰å—åˆ°æŠ‘åˆ¶ä»è€Œä¸äº²å’Œçš„åŸå› ,åªæœ‰å¯¹<strong>æ•´ä¸ªä¿¡å·é€šè·¯è›‹ç™½è´¨ç£·é…¸åŒ–é€”å¾„</strong>æœ‰æ›´åŠ å…¨é¢çš„è®¤è¯†,æ‰èƒ½è¿›ä¸€æ­¥é˜æ˜SIçš„åˆ†å­æœºåˆ¶[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b17-1673-5668-11-4-9">17</a>]ã€‚å‰äººå¯¹èŠ±ç²‰ä¸é›Œè•Šç›¸äº’ä½œç”¨çš„ç ”ç©¶ä¸»è¦é›†ä¸­åœ¨ç”¨æ¯”è¾ƒè½¬å½•ç»„å­¦æ¢è®¨åŸºå› è¡¨è¾¾æƒ…å†µã€‚ç„¶è€Œ,åœ¨<strong>è›‹ç™½è´¨ç¿»è¯‘åä¿®é¥°</strong>çš„ç ”ç©¶è¾ƒç¼ºä¹ã€‚Wangç­‰[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b18-1673-5668-11-4-9">18</a>, <a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b19-1673-5668-11-4-9">19</a>]å¯¹æ°´ç¨»æˆç†Ÿé›Œè•Šä¸€ä¸ªç£·é…¸åŒ–è›‹ç™½è´¨ç»„å­¦çš„å‰–æä¸ºç ”ç©¶æ¤ç‰©è‡ªäº¤ä¸äº²å’Œçš„ç»†èƒä¿¡å·è½¬å¯¼æä¾›å‚è€ƒã€‚</p><p><strong>3.2 S-RNaseæ³›ç´ åŒ–</strong></p><p><font color="red"><strong>èŠ±æŸ±ç‰¹å¼‚æ€§å› å­</strong></font>ä¸º<font color="red"><strong>S-RNase</strong></font>çš„<strong>SI</strong>åœ¨è‡ªç„¶ç•Œä¸­<font color="red"><strong>æœ€å¹¿æ³›</strong></font>,ç›¸åº”çš„<font color="red"><strong>èŠ±ç²‰å†³å®šå› å­</strong></font>åœ¨<font color="red"><strong>è½¦å‰ç§‘</strong>(Plantaginaceae)å’Œ<strong>èŒ„ç§‘</strong></font>ä¸­è¢«ç§°ä¸º<font color="red"><strong>SLF(S-locus F-box)</strong></font>,åœ¨<font color="red"><strong>è”·è–‡ç§‘</strong></font>ä¸­<font color="red"><strong>ç±»ä¼¼F-boxè›‹ç™½</strong>è¢«å‘½åä¸º<strong>SFB</strong></font>(S haplotype-specific F-box protein)[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b20-1673-5668-11-4-9">20</a>, <a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b21-1673-5668-11-4-9">21</a>]ã€‚Qiaoç­‰[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b22-1673-5668-11-4-9">22</a>]é€šè¿‡<strong>å…ç–«å…±æ²‰æ·€</strong>å’Œ<strong>é…µæ¯åŒæ‚</strong>äº¤å®éªŒå‘ç°å¹¶è¯æ˜<font color="red"><strong>è¿›å…¥å¼‚å·±èŠ±ç²‰ç®¡</strong>çš„<strong>S-RNase</strong>ä¼šä¸<strong>SLFç»“åˆ</strong>å¹¶è¢«<strong>æ³›ç´ åŒ–</strong></font>ã€‚<font color="red"><strong>æ³›ç´ è›‹ç™½é…¶ä½“é€”å¾„</strong></font>(ubiquitin proteasome pathway)ä»‹å¯¼çš„<strong>è›‹ç™½é™è§£</strong>æ˜¯æœºä½“è°ƒèŠ‚ç»†èƒå†…è›‹ç™½æ°´å¹³ä¸åŠŸèƒ½çš„é‡è¦æœºåˆ¶,å¤§é‡ç ”ç©¶è¯å®<font color="red"><strong>F-box</strong>æ˜¯<strong>æ³›ç´ è›‹ç™½é™è§£ç³»ç»Ÿ</strong>ä¸­<strong>æ³›ç´ è›‹ç™½è¿æ¥é…¶å¤åˆä½“</strong>(SCF-E3)ç»“åˆç‰¹å¼‚æ€§åº•ç‰©çš„<strong>å—ä½“</strong></font>[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b23-1673-5668-11-4-9">23</a>, <a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b24-1673-5668-11-4-9">24</a>]ã€‚é’ˆå¯¹SIç³»ç»Ÿ,ä¸­ç§‘é™¢é—ä¼ æ‰€è–›å‹‡å½ªè¯¾é¢˜ç»„æå‡ºä¸€ä¸ª<font color="red"><strong>S-RNaseæ³›ç´ åŒ–</strong>ä»‹å¯¼çš„<strong>æ¶²æ³¡åˆ†æ‹£æ¨¡å‹</strong></font>[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b7-1673-5668-11-4-9">7</a>]ï¼šS-RNaseé€šè¿‡ç»†èƒ<font color="red">å†…åä½œç”¨</font>ä»ç»†èƒå¤–åŸºè´¨è¿›å…¥åˆ°èŠ±ç²‰ç®¡åè¢«è¿è¾“åˆ°<font color="red">èŠ±ç²‰æ¶²æ³¡</font>ä¸­ã€‚åœ¨<strong>è‡ªäº¤</strong>èŠ±ç²‰ç®¡ä¸­,<strong>æ¶²æ³¡è†œ</strong>ç”±äºæŸç§æœºåˆ¶ä¼š<strong>è¢«ç ´å</strong>,<font color="red">S-RNase<strong>è¢«é‡Šæ”¾</strong>åˆ°ç»†èƒè´¨ä¸­</font>,å¼•èµ·<font color="red"><strong>ç»†èƒæ¯’ç´ æ•ˆåº”</strong></font>ä»è€Œ<font color="red">æŠ‘åˆ¶èŠ±ç²‰ç®¡ç”Ÿé•¿</font>;è€Œåœ¨<strong>å¼‚äº¤</strong>èŠ±ç²‰ç®¡ä¸­,<font color="red">æ¶²æ³¡ä¸è¢«ç ´å</font>,S-RNaseä¸èƒ½å‘æŒ¥ç»†èƒæ¯’æ€§,å› æ­¤å¼‚äº¤èŠ±ç²‰ç®¡æ­£å¸¸ç”Ÿé•¿ã€‚è¿™ä¸ªæ¨¡å‹åˆç†è§£é‡Šäº†èŠ±ç²‰ç‰¹å¾çš„ç‰¹å¼‚æ€§,ä¸ºè¿›ä¸€æ­¥ç ”ç©¶æ¤ç‰©è‡ªäº¤ä¸äº²å’Œååº”çš„åˆ†å­æœºåˆ¶æä¾›äº†é‡è¦åŸºç¡€ã€‚</p><p><strong>3.3 æ‹Ÿå—èŠ¥å±çš„æ¼”åŒ–</strong></p><p>Sä½ç‚¹å—ä½“æ¿€é…¶æ˜¯ä»¥åå­—èŠ±ç§‘ä¸ºä»£è¡¨çš„SSIååº”çš„æ ¸å¿ƒå› å­ã€‚Steinç­‰[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b25-1673-5668-11-4-9">25</a>]é¦–æ¬¡ä»ç”˜è“ä¸­é‰´å®šå‡ºæŸ±å¤´å—ä½“æ¿€é…¶SRKã€‚Nasrallah JB[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b26-1673-5668-11-4-9">26</a>]é¦–å…ˆå‘ç°ç”˜è“è‡ªäº¤ä¸äº²å’Œç‰¹å¼‚æ€§çš„èŠ±ç²‰SåŸºå› <em>SCR&#x2F;SP11</em>ã€‚åœ¨æ‹Ÿå—èŠ¥ä¸­,<em>SCR</em>ä½œä¸ºé…ä½“ä¸å—ä½“SRKç›¸äº’ä½œç”¨å‘æŒ¥è‡ªäº¤ä¸äº²å’Œæ•ˆåº”ã€‚è€Œç”˜è“çš„è‡ªäº¤ä¸äº²å’Œæ€§ç”±SRKã€<em>SCR</em>å’ŒSä½ç‚¹ç³–è›‹ç™½(SLG)3ä¸ªé«˜åº¦å¤šæ€æ€§çš„åŸºå› å…±åŒæ§åˆ¶,SLGä¸æ˜¯å¿…é¡»çš„èŠ±æŸ±SåŸºå› ,ä½†å®ƒçš„å­˜åœ¨å¯ä»¥å¢å¼ºè‡ªäº¤ä¸äº²å’Œå“åº”çš„èƒ½åŠ›[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b27-1673-5668-11-4-9">27</a>, <a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b28-1673-5668-11-4-9">28</a>]ã€‚æ¤ç‰©äº¤é…ç³»ç»Ÿå…·æœ‰é«˜åº¦ä¸ç¨³å®šçš„ç‰¹æ€§,å¼‚äº¤å’Œè‡ªäº¤ä¹‹é—´é¢‘ç¹çš„è½¬æ¢,ä½†æ˜¯æ½œåœ¨çš„é—ä¼ åŸå› è¿˜ä¸æ˜ç¡®ã€‚Mableç­‰[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b29-1673-5668-11-4-9">29</a>]åŸºäºæ¸©å®¤æ¡ä»¶ä¸‹çš„æˆç²‰å®éªŒå‘ç°åŒ—ç¾æ·±å±±å—èŠ¥ä¸­å­˜åœ¨SIä¸¢å¤±çš„ç°è±¡,å¹¶è¡¨æ˜å¯èƒ½ä¸SRKæ‰©å¢çš„ç­‰ä½åŸºå› æœ‰å…³ã€‚Tsuchimatsuç­‰[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b30-1673-5668-11-4-9">30</a>]åœ¨æ¬§æ´²æ‹Ÿå—èŠ¥ä¸­å‘ç°äº†èŠ±ç²‰ç‰¹å¼‚æ€§åŸºå› <em>SCR</em>ä¸­ç¢±åŸºçš„çªå˜,è¿›ä¸€æ­¥æè¿°äº†æ‹Ÿå—èŠ¥SIä¸¢å¤±çš„é—ä¼ æœºåˆ¶ã€‚é€šè¿‡å¯¹æ‹Ÿå—èŠ¥è‡ªäº¤ä¸äº²å’ŒåŸºå› ç³»ç»Ÿå‘è‚²åˆ†æå¯çŸ¥<em>SCR</em>ä¸SRKå­˜åœ¨å…±è¿›åŒ–çš„å…³ç³»[<a href="https://manu56.magtech.com.cn/kxgc/article/2016/1673-5668/1673-5668-11-4-9.shtml#b31-1673-5668-11-4-9">31</a>]ã€‚æ‹Ÿå—èŠ¥çš„ç¥–å…ˆå…·æœ‰è‡ªäº¤ä¸äº²å’Œæ€§,ç„¶è€Œåœ¨æ¼«é•¿çš„é€‚åº”ç¯å¢ƒçš„è¿›åŒ–è¿‡ç¨‹ä¸­é€æ¸å‘è‡ªäº¤äº²å’Œè¿‡åº¦ã€‚éšç€å…¨åŸºå› ç»„æµ‹åºçš„å‘å±•,æ‹Ÿå—èŠ¥å±SIçš„ä¸¢å¤±åŠæŸäº›åŸºå› çš„è¿›åŒ–å°†ä¼šæ›´åŠ æ¸…æ™°å…¨é¢çš„å‘ˆç°å‡ºæ¥ã€‚</p><p><strong>6 ç»“è®ºä¸å±•æœ›</strong></p><p>ç¾å›½åº·å¥ˆå°”å¤§å­¦çš„Nasrallah JBå’ŒNasrallah MEã€æ—¥æœ¬å¥ˆè‰¯å…ˆç«¯ç§‘å­¦æŠ€æœ¯å¤§å­¦é™¢å¤§å­¦çš„Isogai Aå’ŒTakayama Sã€æ—¥æœ¬ä¸œåŒ—å¤§å­¦çš„Watanabe Mã€Nishio Tå’ŒHinata Kã€ç¾å›½å®¾å·å·ç«‹å¤§å­¦çš„Kao THã€æ—¥æœ¬äº¬éƒ½å¤§å­¦çš„Tao Rä¸æ—¥æœ¬åƒå¶å¤§å­¦çš„Sassa Hä¸ºè¯¥é¢†åŸŸå‰10ä½œè€…ã€‚è›‹ç™½è´¨ç£·é…¸åŒ–ã€S-RNaseæ³›ç´ åŒ–å’ŒSRKä»‹å¯¼çš„æ‹Ÿå—èŠ¥å±æ¼”åŒ–æ˜¯æœ¬é¢†åŸŸè¿‘æœŸæˆ–è€…æœªæ¥å‡ å¹´çš„ç ”ç©¶å‰æ²¿çƒ­ç‚¹ã€‚</p><p>æ¤ç‰©è‡ªäº¤ä¸äº²å’Œååº”å¯å‘ç”Ÿåœ¨å—ç²¾å‰å¤šä¸ªé˜¶æ®µ,è€Œä¸”åœ¨è‡ªäº¤ä¸äº²å’Œç³»ç»Ÿä¸­è¿˜å­˜æœ‰ä¸€äº›é‡è¦çš„**éSå› å­,ä¸Så› å­å­˜åœ¨ç€äº’ä½œå…³ç³»,**ä½“ç°å‡ºSIå…·æœ‰æå…¶å¤æ‚çš„åˆ†å­æœºåˆ¶ã€‚è¿‘å¹´æ¥,æ¤ç‰©Sä½ç‚¹è‡ªäº¤ä¸äº²å’Œæœºåˆ¶ç ”ç©¶å–å¾—ä¸€å®šè¿›å±•,ä½†ä»ç„¶å­˜åœ¨è¯¸å¤šé—®é¢˜ï¼š</p><p>(1)è›‹ç™½è´¨ç£·é…¸åŒ–ä¸S-RNaseæ³›ç´ åŒ–æœ‰æ— äº’ä½œå…³ç³»,æ˜¯å¦‚ä½•ç›¸äº’ä½œç”¨çš„?</p><p> (2)S-RNaseè¿›å…¥è‡ªäº¤çš„èŠ±ç²‰ç®¡å,æ¶²æ³¡è†œå¦‚ä½•è¢«ç ´å?</p><p>(3)S-RNaseè¿›å…¥å¼‚äº¤èŠ±ç²‰ç®¡çš„ç»†èƒä¾¿ä¸èƒ½å‘æŒ¥ç»†èƒæ¯’ç´ æ•ˆåº”æ˜¯å¦ä¸èŠ±ç²‰Så› å­æœ‰å…³?</p><p>(4)å…¶ä»–è‡ªäº¤ä¸äº²å’Œæ¤ç‰©ä¸­æ˜¯å¦å­˜åœ¨ç±»ä¼¼çš„èŠ±ç²‰å’ŒèŠ±æŸ±Så› å­?</p><p>(5)ç°é˜¶æ®µæ™®éè®¤ä¸ºSIçš„æœºç†æ˜¯åœ¨èŠ±ç²‰ç®¡æˆ–èŠ±ç²‰ä¸­è¯±å‘ç»†èƒç¨‹åºæ€§æ­»äº¡,è¯¦ç»†æœºåˆ¶åˆæ˜¯ä»€ä¹ˆ?</p><p>è¦è§£å†³è¿™ä¸€ç³»åˆ—é—®é¢˜,ç¬”è€…è®¤ä¸ºéœ€è¦ä»ä»¥ä¸‹3ä¸ªå±‚é¢è¿›è¡Œæ·±å…¥ç ”ç©¶ï¼š</p><p>(1)åœ¨åŸºå› å±‚é¢ä¸Š,æŒ–æ˜ä¸SIç›¸å…³çš„åŸºå› å¹¶è¿›è¡Œå•ä¸ªç”šè‡³å¤šä¸ªåŸºå› åŒæ—¶ä½œç”¨çš„åŠŸèƒ½åˆ†æã€‚</p><p>(2)åœ¨åˆ†å­å±‚é¢ä¸Š,ç ”ç©¶è›‹ç™½è´¨ä½“ç³»ã€è›‹ç™½è´¨-æ ¸é…¸ä½“ç³»æ˜¯å¦‚ä½•ç›¸äº’ä½œç”¨çš„ã€‚</p><p>(3)åœ¨ç»†èƒå±‚é¢ä¸Š,æ¢è®¨S-RNaseè¿›å…¥æ¶²æ³¡çš„ä¿¡å·è½¬å¯¼é€”å¾„åŠå…¶ä»–ç›¸å…³ä¿¡å·é€šè·¯ã€‚</p><p>è¿ç”¨åˆ†å­é—ä¼ å­¦ã€åŸºå› ç»„å­¦ã€ç”Ÿç‰©ä¿¡æ¯å­¦ã€ç»†èƒç”Ÿç‰©å­¦ã€è¿›åŒ–å‘è‚²ç”Ÿç‰©å­¦ç­‰å­¦ç§‘çš„ç»¼åˆæ‰‹æ®µå¯¹è‡ªäº¤ä¸äº²å’Œä¿¡å·è¯†åˆ«å’Œæ¿€æ´»çš„åˆ†å­æœºåˆ¶ä½œè¿›ä¸€æ­¥ç ”ç©¶ã€‚ä¸åŒç§å±è‡ªäº¤ä¸äº²å’Œæ€§æœºåˆ¶çš„é˜æ˜å¯¹äººå·¥æ‰“ç ´å…¶ç”Ÿæ®–éšœç¢ã€å¼€è¾Ÿæ–°çš„ä½œç‰©è‚²ç§é€”å¾„å…·æœ‰é‡è¦æ„ä¹‰ã€‚</p><hr><h1 id="part2"><a href="#part2" class="headerlink" title="part2"></a><a href="https://www.cas.cn/kxcb/kpwz/201311/t20131106_3968674.shtml">part2</a></h1><p>è‡ªäº¤ä¸äº²å’Œæ€§åœ¨æ¤ç‰©ç•Œä¸­å¹¿æ³›åˆ†å¸ƒï¼Œè¶…è¿‡60%çš„è¢«å­æ¤ç‰©éƒ½æœ‰è¿™ç§ç‰¹æ€§ï¼Œæ¶‰åŠå¤§çº¦320å¤šä¸ªç§‘ã€‚</p><p>ä¸ç”Ÿç‰©ç•Œå…¶å®ƒçš„â€œè¯†åˆ«ç³»ç»Ÿâ€å¦‚<strong>äººçš„ä¸»è¦ç»„ç»‡ç›¸å®¹æ€§å¤åˆä½“ï¼ˆMHCï¼‰</strong>ä¸€æ ·ï¼Œè‡ªäº¤ä¸äº²å’Œæ€§åœ¨é—ä¼ ä¸Šéœ€è¦æ ‡è®°ä¸ªä½“èº«ä»½çš„ç‰¹å¼‚æ€§ï¼Œåœ¨<strong>ç¾¤ä½“ä¸­</strong>éœ€æœ‰è¿™ç§<strong>èº«ä»½æ ‡è®°çš„å¤šæ ·æ€§</strong>ã€‚å¤§å¤šæ•°æ¤ç‰©çš„è‡ªäº¤ä¸äº²å’Œæ€§æ˜¯ç”±<strong>å•ä¸€çš„å¤ç­‰ä½åŸºå› ä½ç‚¹æ§åˆ¶</strong>ï¼Œç§°ä¸º<em>S</em>ä½ç‚¹ã€‚<strong>Sä½ç‚¹</strong>ä¸€èˆ¬åŒ…å«<strong>ä¸¤ç±»åŸºå› </strong>ï¼š<strong>å†³å®šèŠ±æŸ±è¯†åˆ«ç‰¹å¼‚æ€§</strong>çš„<strong>èŠ±æŸ±<em>S</em>åŸºå› </strong>å’Œ<strong>å†³å®šèŠ±ç²‰è¯†åˆ«ç‰¹å¼‚æ€§</strong>çš„<strong>èŠ±ç²‰<em>S</em>åŸºå› </strong>ã€‚<strong>ä¸åŒçš„èŠ±æŸ±<em>S</em>ç­‰ä½åŸºå› </strong>ä¸å…¶<font color="red"><strong>ç´§å¯†è¿é”</strong>çš„èŠ±ç²‰<em>S</em>ç­‰ä½åŸºå› </font>æ„æˆ<font color="red"><strong>ä¸åŒçš„Så•å€å‹</strong></font>ã€‚åŸºäºèŠ±ç²‰è¯†åˆ«ç‰¹å¼‚æ€§çš„é—ä¼ å†³å®šæ–¹å¼ï¼Œè‡ªäº¤ä¸äº²å’Œæ€§åˆ†ä¸º<strong>å­¢å­ä½“</strong>è‡ªäº¤ä¸äº²å’Œæ€§å’Œ<strong>é…å­ä½“</strong>è‡ªäº¤ä¸äº²å’Œæ€§ä¸¤ç§ç±»å‹ã€‚å­¢å­ä½“è‡ªäº¤ä¸äº²å’Œçš„èŠ±ç²‰äº²å’Œä¸å¦çš„è¡¨å‹ç”±äº§ç”ŸèŠ±ç²‰çš„äºŒå€ä½“äº²æœ¬ï¼ˆå³å­¢å­ä½“ï¼‰<em>S</em>åŸºå› å‹å†³å®šï¼Œä¸»è¦å­˜åœ¨äºæ²¹èœã€æ‹Ÿå—èŠ¥ç­‰åå­—èŠ±ç§‘æ¤ç‰©ä¸­ã€‚é…å­ä½“è‡ªäº¤ä¸äº²å’Œçš„èŠ±ç²‰è¡¨å‹ç”±å•å€ä½“èŠ±ç²‰ï¼ˆå³é…å­ä½“ï¼‰è‡ªèº«çš„<em>S</em>åŸºå› å‹å†³å®šï¼Œ<font color="red">åˆ†å¸ƒ<strong>æœ€å¹¿æ³›</strong>çš„æ˜¯ä¸€ç§ç§°ä¸º<strong>Sæ ¸é…¸é…¶ç±»</strong>çš„è‡ªäº¤ä¸äº²å’Œæ€§ï¼Œä¸»è¦å­˜åœ¨äº<strong>èŒ„ç§‘ã€è”·è–‡ç§‘ã€è½¦å‰ç§‘</strong>ç­‰æ¤ç‰©ä¸­</font>ã€‚åœ¨<strong>æ­£é€‰æ‹©å’Œå¹³è¡¡é€‰æ‹©</strong>ç­‰ä½œç”¨ä¸‹ï¼Œæ¤ç‰©è‡ªäº¤ä¸äº²å’Œæ€§çš„<font color="red">Så•å€å‹å¿«é€Ÿè¿›åŒ–</font>ï¼Œåœ¨ç¾¤ä½“ä¸­å§‹ç»ˆç»´æŒç€<font color="red">ä½é¢‘å¤šæ€</font>æ°´å¹³ã€‚ç ”ç©¶å‘ç°è‡ªç„¶ç¾¤ä½“ä¸­<font color="red"><em>S</em>å•å€å‹çš„ç±»å‹å¯è¾¾ä¸Šç™¾ä¸ª</font>ã€‚ </p><p>ã€€ã€€äºŒåä¸–çºªå…«ä¹åå¹´ä»£ï¼Œäººä»¬é€æ­¥åˆ©ç”¨åˆ†å­ç”Ÿç‰©å­¦æ‰‹æ®µç ”ç©¶è¿™ç§å—ç²‰ç›¸å…³æ€§çŠ¶çš„åŸºå› åŸºç¡€åŠåˆ†å­æœºç†ã€‚æ¤ç‰©å—ç²‰ä»èŠ±ç²‰è½åœ¨æŸ±å¤´ä¸Šå¼€å§‹ï¼Œç»è¿‡<font color="red">ç²˜é™„ã€æ°´åˆã€èŒå‘ï¼ŒèŠ±ç²‰ç®¡ç”Ÿé•¿</font>ï¼Œç›´è‡³åˆ°è¾¾èƒšç å®Œæˆå—ç²¾ä½œç”¨ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒèŠ±ç²‰æˆ–èŠ±ç²‰ç®¡ç»†èƒæºå¸¦è‡ªèº«ä¿¡æ¯ï¼Œä¸æ–­æ„ŸçŸ¥æ¥è‡ªæŸ±å¤´æˆ–èŠ±æŸ±é“ç»†èƒçš„å¤–éƒ¨ä¿¡å·ï¼Œå½“â€œè¯†åˆ«â€å‘ç”Ÿåï¼Œè¿…é€Ÿä½œå‡ºâ€œç”Ÿæ­»æŠ‰æ‹©â€ã€‚é€šè¿‡ä¸åŒçš„ä¿¡å·è½¬å¯¼çº§è”ååº”ï¼Œâ€œå¼‚å·±èŠ±ç²‰â€é¡ºåˆ©å®Œæˆå—ç²¾è¿‡ç¨‹ï¼Œâ€œè‡ªå·±èŠ±ç²‰â€çš„ç”Ÿé•¿åˆ™è¢«é˜»æ­¢ã€‚æ¤ç‰©è‡ªäº¤ä¸äº²å’Œååº”çš„è¯†åˆ«å¯ä»¥å‘ç”Ÿåœ¨å—ç²‰è¿‡ç¨‹çš„ä¸åŒé˜¶æ®µã€‚<strong>æ‹Ÿå—èŠ¥</strong>çš„è¯†åˆ«å‘ç”Ÿåœ¨<strong>èŠ±ç²‰æ°´åˆé˜¶æ®µ</strong>ï¼Œ<strong>ç›¸äº’ä½œç”¨</strong>çš„<strong>èŠ±æŸ±å’ŒèŠ±ç²‰å› å­</strong>åˆ†åˆ«ä¸º<strong>SRKå’ŒSCR</strong>ã€‚<strong>ç½‚ç²Ÿ</strong>çš„ä¸äº²å’Œååº”å‘ç”Ÿåœ¨<strong>èŠ±ç²‰èŒå‘é˜¶æ®µ</strong>ã€‚<strong>é‡‘é±¼è‰</strong>çš„è¯†åˆ«å’Œä¸äº²å’Œååº”éƒ½å‘ç”Ÿåœ¨<strong>èŠ±ç²‰ç®¡å†…éƒ¨</strong>ï¼Œç”Ÿé•¿å—é˜»çš„èŠ±ç²‰ç®¡åœç•™åœ¨<font color="red"><strong>èŠ±æŸ±é“ä¸Šéƒ¨çš„1&#x2F;3å¤„</strong></font>ï¼Œå…¶èŠ±æŸ±å’ŒèŠ±ç²‰å†³å®šå› å­åˆ†åˆ«ä¸º<strong>S-RNase</strong>å’ŒèŠ±ç²‰<strong>SLF&#x2F;SFB</strong>ã€‚ç›®å‰è®¤ä¸ºæ¤ç‰©è‡ªäº¤ä¸äº²å’Œååº”çš„<font color="red">åˆ†å­ç»†èƒæœºç†æ˜¯åœ¨<strong>èŠ±ç²‰æˆ–èŠ±ç²‰ç®¡</strong>ä¸­<strong>è¯±å‘</strong>äº†<strong>ç»†èƒç¨‹åºæ€§æ­»äº¡</strong></font>ã€‚ </p><p>ã€€ã€€å¼‚äº¤å¯å¢åŠ ä¸ªä½“é—ä¼ æ‚åˆåº¦å¢å¼ºé€‚åº”æ€§ã€‚è‡ªäº¤äº²å’Œè¿…é€Ÿå é¢†é€‚å®œç”Ÿå¢ƒï¼Œå®ç°ç¾¤ä½“æ‰©å¼ ã€‚æ ½åŸ¹ä½œç‰©å¤§å¤šæ˜¯è‡ªäº¤äº²å’Œçš„çº¯åˆå“ç³»ï¼Œå‘ˆç°å‡ä¸€ç›®çš„å†œè‰ºæ€§çŠ¶ï¼Œä½†è‡ªäº¤äº²å’ŒåŠå…¶çº¯åˆæ•ˆåº”ä½¿ä½œç‰©æŠ—é€†æ€§è¾ƒå¼±ã€‚è‡ªäº¤ä¸äº²å’Œæ€§ä½œä¸º<strong>ç§å†…ç”Ÿæ®–éšœç¢</strong>ï¼Œå¯¹äº<strong>ä¿ƒè¿›ç§é—´ç”Ÿæ®–éšœç¢å½¢æˆ</strong>å’Œ<strong>ç‰©ç§åˆ†åŒ–</strong>æ„ä¹‰é‡å¤§ï¼Œåœ¨<strong>è¢«å­æ¤ç‰©æ¼”åŒ–</strong>è¿‡ç¨‹ä¸­<strong>å¤šæ¬¡ç‹¬ç«‹èµ·æº</strong>ï¼Œæ¨æµ‹åœ°çƒä¸Š<strong>æ˜¾èŠ±æ¤ç‰©çš„ç¹ç››å‘è¾¾</strong>ä¸å…¶é¢‘ç¹è·å¾—è¿™ä¸€ç”Ÿæ®–æ€§çŠ¶æœ‰å¯†åˆ‡å…³ç³»ã€‚ </p><p>ã€€ã€€æ¤ç‰©è‡ªäº¤ä¸äº²å’Œæ€§ä¸ä»…æ˜¯å€¼å¾—æ·±å…¥ç ”ç©¶çš„ç”Ÿç‰©å­¦é—®é¢˜ï¼Œåœ¨ç”Ÿäº§å®è·µä¸­ä¹Ÿæœ‰é‡è¦åº”ç”¨ä»·å€¼ã€‚äºŒåä¸–çºªä¸ƒåå¹´ä»£ï¼Œæˆ‘å›½ç§‘å­¦å®¶åˆ©ç”¨<strong>åå­—èŠ±ç§‘è‡ªäº¤ä¸äº²å’Œ</strong>æœºåˆ¶è‚²æˆäº†<strong>ç”˜è“å‹æ‚äº¤æ²¹èœ</strong>ï¼Œå¤§å¹…åº¦æé«˜æ²¹èœäº§é‡å’Œå“è´¨ï¼Œåœ¨ç”˜è“ã€å¤§ç™½èœå’Œèåœç­‰è”¬èœè‚²ç§ä¸­ä¹Ÿæœ‰å¾ˆå¥½çš„åº”ç”¨ã€‚ </p><p><img src="/GeekFocus/2022-03-22-S-Locus/1.png" alt="img"><br><img src="/GeekFocus/img/2022-03-22-S-Locus/1.png" alt="img"></p><hr><h1 id="èŒ„ç§‘è‡ªäº¤ä¸äº²å’Œæ€§èŠ±æŸ±å› å­S-RNaseçš„è§£æ¯’æœºåˆ¶"><a href="#èŒ„ç§‘è‡ªäº¤ä¸äº²å’Œæ€§èŠ±æŸ±å› å­S-RNaseçš„è§£æ¯’æœºåˆ¶" class="headerlink" title="èŒ„ç§‘è‡ªäº¤ä¸äº²å’Œæ€§èŠ±æŸ±å› å­S-RNaseçš„è§£æ¯’æœºåˆ¶"></a><a href="http://pcce.genetics.cas.cn/zhxw/202106/t20210603_642162.html">èŒ„ç§‘è‡ªäº¤ä¸äº²å’Œæ€§èŠ±æŸ±å› å­S-RNaseçš„è§£æ¯’æœºåˆ¶</a></h1><p>ã€€ã€€2021å¹´5æœˆ31æ—¥åœ¨çº¿å‘è¡¨åœ¨<em>New Phytologist</em>æ‚å¿—ã€‚ </p><p>â€‹ã€€è‡ªäº¤ä¸äº²å’Œæ€§å¹¿æ³›å­˜åœ¨äºæ˜¾èŠ±æ¤ç‰©, ç§å†…ç”Ÿæ®–éšœç¢ã€‚å‰æœŸç ”ç©¶è¡¨æ˜ï¼Œ<font color="red">èŒ„ç§‘ã€è½¦å‰ç§‘ã€è”·è–‡ç§‘å’ŒèŠ¸é¦™ç§‘</font>æ¤ç‰©<font color="red">èŠ±æŸ±ç‰¹å¼‚è¡¨è¾¾</font>çš„å¯ä½œä¸ºä¸€ç±»ç»†èƒæ¯’å› å­<strong>æŠ‘åˆ¶</strong>è‡ªå·±èŠ±ç²‰ç®¡ç”Ÿé•¿ï¼Œè€Œåœ¨å¼‚äº¤æˆç²‰åï¼Œç”±äºå…¶<font color="red"><strong>è¢«å¼‚å·±èŠ±ç²‰æ³›ç´ åŒ–</strong>å¹¶é€šè¿‡<strong>è›‹ç™½é…¶ä½“é™è§£</strong></font>ï¼Œæ— æ³•å‘æŒ¥ç»†èƒæ¯’æ€§ï¼Œäº§ç”Ÿå¼‚äº¤äº²å’Œã€‚ç„¶è€Œï¼Œ<strong>æ³›ç´ è›‹ç™½é…¶ä½“ç³»ç»Ÿè§£é™¤ç»†èƒæ¯’æ€§çš„è¯¦ç»†æœºåˆ¶</strong>å¹¶ä¸æ¸…æ¥šã€‚ </p><p>ã€€ã€€å¯¹èŒ„ç§‘æ¤ç‰©æ‚äº¤çŸ®ç‰µç‰›(<em>Petunia hybrida</em>)è‡ªäº¤ä¸äº²å’Œæ€§<font color="red">èŠ±æŸ±å› å­<strong>S3</strong>-RNase</font>çš„æ³›<strong>ç´ åŒ–ä¿®é¥°</strong>è¿›è¡Œ<strong>ç”ŸåŒ–åˆ†æ</strong>ï¼Œå‘ç°å…¶ä¸»è¦åœ¨<strong>ä¸‰ä¸ªè¾ƒä¸ºä¿å®ˆçš„ç©ºé—´åŒºåŸŸ</strong>(<strong>I, IIå’ŒIII</strong>)å‘ç”Ÿ<strong>K48ç±»å‹</strong>çš„<strong>å¤šèšæ³›ç´ åŒ–</strong>ã€‚<font color="red"><strong>åŒºåŸŸI</strong>åœ¨<strong>æœªæˆç²‰</strong>ã€<strong>è‡ªäº¤</strong>æˆç²‰å’Œ<strong>å¼‚äº¤</strong>æˆç²‰èŠ±æŸ±ä¸­<strong>éƒ½è¢«æ³›ç´ åŒ–</strong></font>ï¼Œè¡¨æ˜å…¶åœ¨<strong>S3-RNaseè¿›å…¥èŠ±ç²‰ç®¡ä¹‹å‰</strong>å³å¯å‘ç”Ÿï¼Œè€Œ<font color="red"><strong>åŒºåŸŸIIå’ŒIIIåªåœ¨å¼‚äº¤æˆç²‰èŠ±æŸ±ä¸­è¢«æ³›ç´ åŒ–</strong></font>ã€‚é—ä¼ åˆ†æè¡¨æ˜ï¼Œ<font color="red"><strong>åŒºåŸŸIIçªå˜</strong>çš„<strong>S3</strong>-RNaseå¯å¯¼è‡´è½¬åŸºå› æ¤æ ªçš„<strong>å¼‚äº¤ç»“ç±½æ•°æ˜¾è‘—å‡å°‘</strong></font>ï¼Œè€Œ<font color="red">åŒºåŸŸIæˆ–IIIçªå˜</font>æ—¶ï¼Œ<font color="red">å¼‚äº¤ç»“ç±½æ•°<strong>å‡å°‘ç¨‹åº¦è¾ƒå°</strong></font>ï¼Œæç¤º<font color="red"><strong>æ³›ç´ åŒ–ä¿®é¥°åŒºåŸŸçªå˜</strong>çš„<strong>S3-RNase</strong>åœ¨<strong>èŠ±ç²‰ç®¡</strong>ä¸­å‘ç”Ÿ<strong>ç§¯ç´¯</strong>å¹¶äº§ç”Ÿ<strong>æ›´é«˜</strong>çš„<strong>ç»†èƒæ¯’æ€§</strong></font>ã€‚<font color="red">èŠ±ç²‰ç®¡å…±åŸ¹å…»åŠé™è§£å®éªŒ</font>ç»“æœæ˜¾ç¤º<font color="red"><strong>åŒºåŸŸIIçªå˜</strong>å<strong>S3</strong>-RNaseåœ¨èŠ±ç²‰ç®¡ä¸­çš„é™è§£é€Ÿç‡<strong>æ˜¾è‘—å‡æ…¢</strong>ï¼Œè€Œ<strong>åŒºåŸŸIå’ŒIII</strong>çªå˜åå‡æ…¢ç¨‹åº¦<strong>è¾ƒå°</strong>ï¼Œ<strong>ä¸å¼‚äº¤æˆç²‰ç»“æœç›¸ä¸€è‡´(III why?)</strong></font>ï¼Œè¡¨æ˜<font color="red"><strong>åŒºåŸŸII</strong></font>åœ¨<strong>å¼‚äº¤äº²å’Œ</strong>ååº”<strong>S3</strong>-RNaseçš„<font color="red"><strong>æ³›ç´ åŒ–ä¿®é¥°</strong>å’Œ<strong>é™è§£</strong>ä¸­å‘æŒ¥<strong>ä¸»è¦ä½œç”¨</strong></font>ï¼ŒåŒºåŸŸIå’ŒIIIä½œç”¨è¾ƒå°ã€‚è¿›ä¸€æ­¥ç ”ç©¶å‘ç°ï¼Œ<font color="reen"><strong>åŒºåŸŸII</strong></font>ä¸­çš„<font color="reen"><strong>K154</strong>å’Œ<strong>K217</strong></font>åœ¨æ­¤è¿‡ç¨‹ä¸­å‘æŒ¥ä¸»è¦ä½œç”¨ï¼Œè€Œ<strong>è‹æ°¨é…¸ä½ç‚¹ä½œç”¨è¾ƒå°</strong>ã€‚è¯¥ç ”ç©¶æ­ç¤º<strong>S3</strong>-RNaseçš„<strong>æ³›ç´ åŒ–ä¿®é¥°</strong>å’Œ<strong>é™è§£</strong>åœ¨æ‚äº¤çŸ®ç‰µç‰›çš„<strong>å¼‚äº¤äº²å’Œ</strong>æˆç²‰ä¸­<font color="red"><strong>åˆ†æ­¥</strong>è¿›è¡Œ</font>(å›¾)ï¼Œä¸º<strong>T2ç±»æ ¸é…¸é…¶</strong>åŠ<strong>åˆ†æ³Œå‹ç»†èƒæ¯’ç´ </strong>ç¨³å®šæ€§çš„åŠ¨æ€è°ƒæ§æœºåˆ¶æä¾›æ–°æ€è·¯ã€‚ </p><p><img src="/GeekFocus/2022-03-22-S-Locus/2.png" alt="img"><br><img src="/GeekFocus/img/2022-03-22-S-Locus/2.png" alt="img"></p><p>S-RNaseçš„æ³›ç´ åŒ–ä¿®é¥°å’Œé™è§£åœ¨æ‚äº¤çŸ®ç‰µç‰›çš„å¼‚äº¤äº²å’Œæˆç²‰ä¸­åˆ†æ­¥è¿›è¡Œ</p><hr><h1 id="è¢«å­æ¤ç‰©è‡ªäº¤ä¸äº²å’Œæ€§èµ·æºã€ä¸¢å¤±å’Œé‡è·çš„é«˜åº¦åŠ¨æ€è¿›åŒ–æœºåˆ¶"><a href="#è¢«å­æ¤ç‰©è‡ªäº¤ä¸äº²å’Œæ€§èµ·æºã€ä¸¢å¤±å’Œé‡è·çš„é«˜åº¦åŠ¨æ€è¿›åŒ–æœºåˆ¶" class="headerlink" title="è¢«å­æ¤ç‰©è‡ªäº¤ä¸äº²å’Œæ€§èµ·æºã€ä¸¢å¤±å’Œé‡è·çš„é«˜åº¦åŠ¨æ€è¿›åŒ–æœºåˆ¶"></a>è¢«å­æ¤ç‰©è‡ªäº¤ä¸äº²å’Œæ€§èµ·æºã€ä¸¢å¤±å’Œé‡è·çš„é«˜åº¦åŠ¨æ€è¿›åŒ–æœºåˆ¶</h1><p>2021.11.04 plant cell</p><p>é™†åœ°ç”Ÿç‰©å åœ°çƒç”Ÿç‰©æ€»æ•°85%ï¼Œå…¶å¤šæ ·æ€§ä¸è¢«å­æ¤ç‰©çš„èµ·æºå’Œæ‰©å¼ å¯†åˆ‡ç›¸å…³ã€‚<strong>è¢«å­æ¤ç‰©</strong>çº¦æœ‰<strong>20å¤šä¸‡ç§</strong>ï¼Œæ˜¯æ¤ç‰©ç•Œæœ€å¤§çš„ç±»ç¾¤ï¼Œä½†å…¶å½¢æˆå’Œæ‰©å¼ çš„åŸå› ä»ä¸ºæœªè§£ä¹‹è°œã€‚ç°å­˜è¢«å­æ¤ç‰©ä¸­ï¼Œ<strong>çº¦40%<strong>å…·æœ‰è‡ªäº¤ä¸äº²å’Œæ€§ (Self-incompatibility, SI)ã€‚SIæ˜¯ä¸€ç§</strong>æ­£å¸¸å¯è‚²</strong>çš„<strong>é›Œé›„åŒèŠ±è¢«å­æ¤ç‰©</strong>è‡ªèŠ±æˆç²‰å<strong>ä¸èƒ½äº§ç”Ÿåˆå­</strong>çš„ç°è±¡ï¼Œå¯¹äºä¿ƒè¿›å…¶å¼‚äº¤å¹¶å¢åŠ å…¶å¤šæ ·æ€§è‡³å…³é‡è¦ã€‚è¢«å­æ¤ç‰©åœ¨è¿›åŒ–è¿‡ç¨‹ä¸­ï¼Œç”±äºå—åˆ°èµ·ä¼ä¸å®šçš„æ¥è‡ª<strong>è‡ªäº¤æˆ–å¼‚äº¤</strong>çš„<strong>é€‰æ‹©å‹åŠ›</strong>ï¼Œå…¶<strong>SI</strong>ä¼šå‘ç”Ÿ<strong>é¢‘ç¹</strong>çš„<strong>ä¸¢å¤±</strong>å’Œ<strong>é‡è·</strong>ã€‚<strong>çœŸåŒå­å¶æ¤ç‰©</strong>ç›®å‰å…±å‘ç°<strong>å››ç±»ä¸åŒåˆ†å­æœºåˆ¶çš„SI</strong>ï¼ŒåŒ…æ‹¬å¸¸è§äº<font color="red"><strong>è½¦å‰ç§‘ã€èŒ„ç§‘ã€è”·è–‡ç§‘å’ŒèŠ¸é¦™ç§‘çš„1ç±»</strong></font>ã€<font color="blue"><strong>åå­—èŠ±ç§‘</strong>çš„2ç±»(Sä½ç‚¹å—ä½“æ¿€é…¶èŠ±æŸ±SRKèŠ±ç²‰SCR)</font>ã€<font color="green"><strong>ç½‚ç²Ÿç§‘</strong>çš„3ç±»(PrsS PrpS èŠ±ç²‰ç®¡èƒè´¨è‡ªç”±Ca2+ä»‹å¯¼)</font>å’Œ<font color="purple"><strong>æŠ¥æ˜¥èŠ±ç§‘çš„4ç±»</strong></font>SIã€‚<strong>å¦‚æ­¤å¤šæ ·çš„SIæœºåˆ¶æ˜¯å¦‚ä½•èµ·æºå’Œæ¼”åŒ–çš„ï¼Ÿå››ç±»SIæœºåˆ¶çš„æ¼”åŒ–å…³ç³»åˆæ˜¯ä»€ä¹ˆï¼Ÿè¿™äº›é—®é¢˜çš„é˜æ˜å°†ä¸ºæ­ç¤ºæ—©æœŸè¢«å­æ¤ç‰©ç‰©ç§å½¢æˆå’Œæ‰©å¼ çš„æœºåˆ¶æä¾›å…³é”®çº¿ç´¢ã€‚</strong></p><p><strong>Origin, Loss and Regain of Self-Incompatibility in Angiosperms</strong>ã€‚è¯¥ç ”ç©¶åˆ©ç”¨<strong>ç³»ç»ŸåŸºå› ç»„æ¼”åŒ–åˆ†æ</strong>ã€<strong>é—ä¼ å­¦éªŒè¯</strong>å’Œ<strong>ç”Ÿç‰©å­¦åŠŸèƒ½ç ”ç©¶</strong>æ­ç¤ºäº†è¢«å­æ¤ç‰©SIèµ·æºã€ä¸¢å¤±å’Œé‡è·çš„é«˜åº¦åŠ¨æ€è¿›åŒ–æœºåˆ¶ã€‚</p><p>SIé€šå¸¸ç”±<font color="red">åŒ…å«<strong>ç´§å¯†è¿é”</strong>çš„é›Œæ€§å’Œé›„æ€§<em>S</em>åŸºå› çš„å•ä¸€å¤ç­‰ä½çš„<em>S</em>ä½ç‚¹</font>æ‰€æ§åˆ¶ã€‚å…¶ä¸­ï¼Œ<strong>1ç±»SI</strong>çš„<strong>é›Œæ€§</strong>SåŸºå› ç¼–ç <strong>ä¸€ä¸ª</strong>T2ç±»æ ¸é…¸é…¶å³<strong>S-æ ¸é…¸é…¶</strong>ï¼Œè€Œé›„æ€§<em>S</em>åŸºå› åˆ™ç¼–ç <strong>å¤šä¸ª</strong>Cç«¯ä¸º<strong>FBKæˆ–FBAç»“æ„åŸŸ</strong>çš„<strong>F-boxè›‹ç™½SLF</strong>ã€‚å¼‚äº¤æˆç²‰æ—¶ï¼Œ<font color="red">ç”±äº<strong>å¤šä¸ªSLF</strong>å¯<strong>ååŒè¯†åˆ«</strong>å¹¶<strong>è§£é™¤å¼‚å·±S-æ ¸é…¸é…¶</strong>çš„<strong>ç»†èƒæ¯’æ€§</strong></font>ï¼Œå› è€Œäº§ç”Ÿå¼‚äº¤äº²å’Œååº”ï¼›è€Œåœ¨è‡ªäº¤æˆç²‰æ—¶ï¼Œè‡ªå·±S-æ ¸é…¸é…¶çš„æ¯’æ€§ç”±äºæ— æ³•è¢«æŠ‘åˆ¶ï¼Œæœ€ç»ˆäº§ç”Ÿè‡ªäº¤ä¸äº²å’Œååº”ã€‚</p><p>è¯¥ç ”ç©¶é¦–æ¬¡å‘ç°æ¥è‡ª<strong>æ¯›èŒ›ç§‘ã€èŒ„ç§‘ã€è½¦å‰ç§‘å’Œè”·è–‡ç§‘</strong>çš„<strong>å¤šä¸ªç‰©ç§</strong>çš„<strong>SLF</strong>å‡èƒ½<font color="red"><strong>æœ‰æ•ˆè§£é™¤</strong>èŒ„ç§‘æ¤ç‰©<strong>æ‚äº¤çŸ®ç‰µç‰›</strong>S-æ ¸é…¸é…¶çš„ç»†èƒæ¯’æ€§</font>ï¼Œè¿›è€Œæ‰“ç ´å…¶SIï¼Œå¹¶ä¸”è¿™ç§<font color="red"><strong>è·¨ç‰©ç§SLFæ‰“ç ´SI</strong></font>çš„æ¦‚ç‡æ˜¾è‘—é«˜äºç§å†…ï¼Œè¡¨æ˜<font color="red"><strong>ç¥–å…ˆSLF</strong>å…·æœ‰<strong>é«˜æ•ˆ</strong></font>è§£é™¤S-æ ¸é…¸é…¶æ¯’æ€§çš„<strong>èƒ½åŠ›</strong>ï¼Œè€Œéšç€é€æ­¥<font color="red">è¿›åŒ–å’Œé€‰æ‹©</font>ï¼Œ<font color="red">SLFçš„<strong>æ•°é‡æ˜¾è‘—æ‰©å¢</strong></font>ï¼Œå…¶<font color="red">ååŒè§£æ¯’èƒ½åŠ›ä¹Ÿæœ‰æ‰€å¢åŠ </font>ã€‚è¿›ä¸€æ­¥å¯¹æ¥è‡ªç§å­æ¤ç‰©<strong>59ä¸ªã€ç§‘ã€‘</strong>çš„ç‰©ç§è¿›è¡Œ<font color="blue"><strong><em>S</em>ä½ç‚¹ç»“æ„åˆ†æ</strong></font>ï¼Œå‘ç°ç¼–ç <strong>é›Œæ€§</strong>è‡ªäº¤ä¸äº²å’Œå†³å®šå› å­<strong>T2ç±»æ ¸é…¸é…¶</strong>å’Œ<strong>é›„æ€§</strong>è‡ªäº¤ä¸äº²å’Œå†³å®šå› å­<strong>FBKæˆ–FBAç»“æ„åŸŸè›‹ç™½</strong>çš„<strong>1ç±»<em>S</em>ä½ç‚¹</strong>ç»“æ„åœ¨<font color="red"><strong>è¢«å­æ¤ç‰©èµ·æºä¹‹åˆå³å·²äº§ç”Ÿ</strong></font>ï¼Œè¡¨æ˜è¯¥ç±»<em>S</em>ä½ç‚¹<strong>æå…¶å¤è€</strong>ï¼Œå¯èƒ½ä¸è¢«å­æ¤ç‰©çš„èµ·æºå’Œæ‰©å¼ æœ‰å…³ã€‚</p><p>éšåï¼Œé€šè¿‡å¯¹çœŸåŒå­å¶æ¤ç‰©<strong>22ä¸ªã€ç‰©ç§ã€‘</strong>çš„è‡ªäº¤ä¸äº²å’Œæ€§åŠ<font color="blue"><strong><em>S</em>ä½ç‚¹ç‰¹å¾è¿›è¡Œå½’çº³åˆ†æ</strong></font>ï¼Œç ”ç©¶äººå‘˜ç³»ç»Ÿæ€»ç»“å‡ºçœŸåŒå­å¶æ¤ç‰©SIçš„<font color="red"><strong>ä¸‰ç§ä¸¢å¤±</strong>è·¯å¾„å’Œ<strong>å››ç§é‡è·</strong>è·¯å¾„</font> (å›¾A)ã€‚</p><p>ã€SIä¸¢å¤±1ã€‘ï¼šç”±äº<font color="red">å…¨åŸºå› ç»„<strong>å¤åˆ¶</strong>å’Œ1ç±»<em>S</em>ä½ç‚¹<strong>é‡å¤</strong></font>æ‰€å¯¼è‡´çš„1ç±»SIçš„<font color="green"><strong>ä¸¢å¤±</strong></font>æœ€ä¸ºæ™®éï¼Œä¾‹å¦‚è‡ªäº¤äº²å’Œçš„è€§æ–—èœ (<em>Aquilegia coerulea</em>) å’Œèœè±† (<em>Phaseolus vulgaris</em>) å‡åŒ…å«<font color="red">2-3ä¸ª1ç±»<em>S</em>ä½ç‚¹</font>ã€‚è¯¥ä¸¢å¤±è·¯å¾„ä¸»è¦åŸºäºç«äº‰æ€§ç›¸äº’ä½œç”¨çš„åŸç†ã€‚<strong>ç«äº‰æ€§ç›¸äº’ä½œç”¨</strong>æ˜¯æŒ‡<strong>å››å€ä½“æ¤ç‰©</strong>äº§ç”Ÿçš„<em>S</em>åŸºå› å‹<strong>æ‚åˆçš„äºŒå€ä½“èŠ±ç²‰</strong>å¯ä»¥<strong>æ‰“ç ´è‡ªäº¤ä¸äº²å’Œæ€§</strong>çš„ç°è±¡ã€‚å¯¹äºåŸºå› ç»„ä¸­å­˜åœ¨<strong>å¤šä¸ªç‹¬ç«‹çš„1ç±»<em>S</em>ä½ç‚¹</strong>çš„æ¤ç‰©ï¼Œç”±äºå…¶ä¸­<font color="red">ä¸€ä¸ª<em>S</em>ä½ç‚¹çš„SLFå¯ä»¥è¯†åˆ«å¹¶è§£é™¤å¦ä¸€ä¸ª<em>S</em>ä½ç‚¹æ‰€ç¼–ç çš„å¼‚å·±S-æ ¸é…¸é…¶çš„ç»†èƒæ¯’æ€§</font>ï¼Œå› æ­¤è¯¥ç±»æ¤ç‰©æ‰€äº§ç”Ÿçš„èŠ±ç²‰ä¸º<em>S</em><strong>åŸºå› å‹æ‚åˆå¹¶ä¸”äº²å’Œ</strong>ã€‚</p><p>ã€SIä¸¢å¤±2ã€‘ï¼šä¸€äº›ç‰©ç§åˆ™é€šè¿‡<font color="red"><strong>åˆ é™¤</strong>æˆ–<strong>å¤±æ´»</strong></font>1ç±»<em>S</em>åŸºå› ä»è€Œ<font color="green"><strong>ä¸¢å¤±</strong></font>äº†SIï¼Œè¯¥è·¯å¾„å¸¸è§äº<font color="red">æ ½åŸ¹ç§</font>ï¼Œä¾‹å¦‚<strong>è‡ªäº¤äº²å’Œ</strong>çš„<strong>æ ½åŸ¹é‡‘é±¼è‰</strong> (<em>Antirrhinum majus</em>) å’Œ<strong>æ ½åŸ¹ç•ªèŒ„</strong> (<em>Solanum lycopersicum</em>)å‡<font color="red"><strong>ä¸§å¤±</strong></font>é›Œæ€§è‡ªäº¤<font color="red"><strong>ä¸äº²å’Œå†³å®šå› å­S-æ ¸é…¸é…¶</strong></font>ï¼›Inactivation of the S-RNase was only detected in horticulturally selected lines, suggesting this route to self- compatibility (SC) is not favored in natural populations. å¤±æ´»åªå­˜åœ¨äºæ ½åŸ¹ç§ï¼Œè‡ªç„¶ç•Œæ— </p><p>ã€SIä¸¢å¤±3ã€‘ï¼šå¦ä¸€äº›ç‰©ç§åˆ™<font color="red"><strong>å®Œå…¨åˆ é™¤</strong></font>äº†1ç±»<em>S</em>ä½ç‚¹ä»è€Œ<font color="green"><strong>ä¸¢å¤±</strong></font>äº†è¯¥ç±»SIæœºåˆ¶ï¼Œä¾‹å¦‚æŠ¥æ˜¥èŠ± (<em>Primula vulgaris</em>)ã€ç”˜è“ (<em>Brassica oleracea</em>) å’Œæ‹Ÿå—èŠ¥ (<em>Arabidopsis thaliana</em>)ã€‚</p><p>å°½ç®¡å¦‚æ­¤ï¼Œä¸ºäº†<strong>é¿å…è‡ªäº¤è¡°é€€</strong>ï¼Œä¿ƒè¿›é€‚åº”æ€§ç”Ÿå­˜å’Œè¿›åŒ–ï¼Œä¸€äº›è‡ªäº¤äº²å’Œçš„ç‰©ç§é€šè¿‡<font color="red"><strong>å¤±æ´»æˆ–åˆ é™¤é‡å¤</strong>çš„1ç±»<em>S</em>ä½ç‚¹</font>è¿›è€Œ<font color="green"><strong>é‡æ–°è·å¾—</strong></font>äº†1ç±»SIï¼Œä¾‹å¦‚<strong>è‡ªäº¤ä¸äº²å’Œçš„è¥¿ç­ç‰™é‡‘é±¼è‰</strong>(<em>A. hispanicum</em>)ã€<strong>å¤šæ¯›ç•ªèŒ„</strong> (<em>S. habrochaites</em>)å’Œ<strong>æŸšå­</strong>(<em>Citrus maxima</em>)ç­‰ï¼›</p><p>è€Œå¦ä¸€äº›ç‰©ç§åˆ™<font color="green"><strong>æ¼”åŒ–å‡ºæ–°çš„</strong></font>2ç±»åå­—èŠ±ç§‘ç”˜è“ (<em>B. oleracea</em>)ã€3ç±»ç½‚ç²Ÿ (<em>Papaver somniferum</em>) æˆ–4ç±»æŠ¥æ˜¥èŠ± (<em>P. vulgaris</em>) çš„SI (å›¾B)ã€‚</p><p><strong>è¿™äº›ç»“æœæ­ç¤ºäº†SIçš„èµ·æºå’Œè¿›åŒ–æœºåˆ¶ï¼Œä¸ºæ·±å…¥ç ”ç©¶è¢«å­æ¤ç‰©çš„èµ·æºå’Œæ‰©å¼ æä¾›äº†ä¸€ä¸ªæ–°çš„åˆ†å­è¿›åŒ–ç†è®ºæ¡†æ¶ã€‚</strong></p><p>åœ¨ç¼ºä¹é—ä¼ å­¦æ•°æ®çš„æƒ…å†µä¸‹ï¼Œå°šä¸æ¸…æ¥šåœ¨å•å­å¶ä¸­å‘ç°çš„Iç±»T2 RNaseå’ŒFBKåŸºå› æ˜¯å¦èƒ½èµ‹äºˆ- 1å‹SIã€‚ç¥–å…ˆçŠ¶æ€åˆ†æè¡¨æ˜ï¼Œè¢«å­æ¤ç‰©å…±åŒç¥–å…ˆå…·æœ‰I&#x2F;IIç±»T2 RNaseså’ŒFBA&#x2F;FBKåŸºå› çš„è¿é”ã€‚çœŸåŒå­å¶æ¤ç‰©æœ€è¿‘çš„å…±åŒç¥–å…ˆï¼ˆmost recent common ancestorMRCAï¼‰æ˜¯å¦ä¸I&#x2F;IIç±»T2 RNases&#x2F;FBA&#x2F;FBKåŸºå› æœ‰å…³è”ï¼Œæˆ–è€…æ˜¯å¦æœ‰ä¸€ä¸ªäºšå®¶æ—å‘IIIç±»T2 RNases&#x2F;FBA&#x2F;FBKåŸºå› è¿›åŒ–ï¼Œç›®å‰å°šä¸èƒ½ç¡®å®š</p><hr>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>slocus</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€CUT&amp;Tag-pipelineã€‘</title>
    <link href="/GeekFocus/2022/03/21/2022-03-21-CUTTag/"/>
    <url>/GeekFocus/2022/03/21/2022-03-21-CUTTag/</url>
    
    <content type="html"><![CDATA[<p><strong>CUT&amp;Tag Data Processing and Analysis Tutorial</strong></p><p>Ye Zheng, Kami Ahmad, Steven Henikoff [following NC]</p><p><a href="https://yezhengstat.github.io/CUTTag_tutorial/#223_Intepret_the_quality_check_results">https://yezhengstat.github.io/CUTTag_tutorial/#223_Intepret_the_quality_check_results</a></p><p><a href="https://www.jianshu.com/p/1a23656a0713">https://www.jianshu.com/p/1a23656a0713</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzUxNTkzODIzMg==&mid=2247484049&idx=2&sn=b74aa66a9c9e4bd36a8a1d50e2834226&chksm=f9ae4046ced9c950efee443e1f0692e37dbce2b856e4f2f841ecd723affcff9c67c698ebe2fa&scene=21#wechat_redirect">wechat</a></p><span id="more"></span><hr><h1 id="I-Introduction"><a href="#I-Introduction" class="headerlink" title="I. Introduction"></a>I. Introduction</h1><h2 id="1-1-Overview-of-CUT-amp-Tag"><a href="#1-1-Overview-of-CUT-amp-Tag" class="headerlink" title="1.1. Overview of CUT&amp;Tag"></a>1.1. Overview of CUT&amp;Tag</h2><p>All dynamic processes that take place on DNA in the eukaryotic nucleus occur in the context of a chromatin landscape that comprises nucleosomes and their modifications, transcription factors, and chromatin-associated complexes. A variety of chromatin features mark sites of activating and silencing transcriptional regulatory elements and chromatin domains that differ between cell types and change during development.</p><p>The mapping of chromatin features genome-wide has traditionally been performed using chromatin immunoprecipitation (ChIP), in which chromatin is <strong>cross-linked</strong> and <strong>solubilized</strong>, and an <strong>antibody</strong> to a <strong>protein or modification of interest</strong> is used to <strong>immunoprecipitate the bound DNA</strong> (<font color="green"><strong>Fig. 1a</strong></font>). Very little has changed in the way <strong>ChIP</strong> is most generally performed since it was first described <strong>35 years ago</strong>, and remains fraught with <strong>signal-to-noise issues</strong> and <strong>artifacts</strong>. An alternative chromatin profiling strategy is <strong>enzyme tethering in situ</strong> whereby the chromatin protein or modification of interest is targeted by an <strong>antibody or fusion protein</strong>. Then, the underlying DNA is marked or cleaved, and a succession of enzyme-tethering methods have been introduced over the past two decades. <font color="green"><strong>Cleavage Under Targets &amp; Tagmentation (CUT&amp;Tag)</strong></font> is a tethering method that uses a <font color="green"><strong>protein-A-Tn5 (pA-Tn5) transposome fusion protein</strong></font> (<font color="green"><strong>Fig. 1b</strong></font>). In CUT&amp;Tag, permeabilized cells or nuclei are incubated with antibody to a specified chromatin protein, and then <strong>pA-Tn5 loaded with mosaic end adaptors</strong> is successively tethered to antibody-bound sites. Activation of the transposome by adding magnesium ions[<strong>Mg2+</strong>] results in the <strong>integration of the adaptors into nearby DNA</strong>. These are then amplified to generate sequencing libraries. Antibody-tethered Tn5-based methods achieve high sensitivity owing to stringent washing of samples after pA-Tn5 tethering and the high efficiency of adaptor integration. The <font color="green"><strong>improved signal-to-noise</strong></font> relative to ChIP-seq translates to an order-of-magnitude reduction in the amount of sequencing required to map chromatin features, allowing sample pooling (typically up to 90 samples) for paired-end sequencing on Illumina NGS sequencers by barcoded PCR of libraries.</p><p><img src="/GeekFocus/2022-03-21-CUTTag/1.png" alt="Figure 1"><br><img src="/GeekFocus/img/2022-03-21-CUTTag/1.png" alt="Figure 1. Differences between immunoprecipitation and in antibody-targeted chromatin profiling strategies. A. ChIP-seq experimental procedure. B. CUT&amp;Tag experimental procedure. Cells and nuclei are indicated in grey, chromatin as red nucleosomes, and a specific chromatin protein in green."></p><p>Cells and nuclei are indicated in grey, chromatin as red nucleosomes, and a specific chromatin protein in green.</p><h2 id="1-2-Objectives"><a href="#1-2-Objectives" class="headerlink" title="1.2. Objectives"></a>1.2. Objectives</h2><p>This tutorial is designed for processing and analyzing CUT&amp;Tag data following the <a href="https://www.protocols.io/view/bench-top-cut-amp-tag-bcuhiwt6/abstract">Bench top CUT&amp;Tag V.3 protocol</a> <strong>NC</strong>. The illustration data used in <strong>this tutorial</strong> is the profiling of <strong>histone modifications</strong> in the human lymphoma K562 cell line, but the tutorial is <strong>generally applicable to</strong> any chromatin protein, including <strong>transcription factors, RNA polymerase II</strong>, and epitope-tagged proteins.</p><h2 id="1-3-CUT-amp-Tag-data-processing-and-analysis-outline"><a href="#1-3-CUT-amp-Tag-data-processing-and-analysis-outline" class="headerlink" title="1.3 CUT&amp;Tag data processing and analysis outline."></a>1.3 CUT&amp;Tag data processing and analysis outline.</h2><p><img src="/GeekFocus/2022-03-21-CUTTag/2.png" alt="Figure 2"><br><img src="/GeekFocus/img/2022-03-21-CUTTag/2.png" alt="Figure 2. CUT&amp;Tag data processing and analysis."></p><ol start="3"><li><strong>Alignment</strong>: Bowtie2 alignment; Duplicates; Fragment size; Replicate reproducibility</li></ol><blockquote><p>Bowtie2, Samtools, Picard</p></blockquote><ol start="4"><li><strong>Filtering and Conversion</strong>: Sam to bam; bam to bed</li></ol><blockquote><p>Samtools, Bedtools</p></blockquote><ol start="5"><li><strong>Spike-in Calibration?:</strong> Sam to bam; Bam to bed</li></ol><blockquote><p>Bowtie2, Bedtools</p></blockquote><ol start="6"><li><strong>Peak Calling:</strong> SEACR peak calling; Fragment propotion in peak regions(FRiPs)</li></ol><blockquote><p>SEACR, R: chromVAR</p></blockquote><ol start="7"><li>Visualization: Genome browser; Heatmap</li></ol><blockquote><p>IGV, UCSC browser, Deeptools</p></blockquote><ol start="8"><li>Different Analysis</li><li>Additional alternatives</li></ol><h2 id="1-4-Requirements"><a href="#1-4-Requirements" class="headerlink" title="1.4. Requirements"></a>1.4. Requirements</h2><ul><li>R (versions &gt;&#x3D; 3.6)<ul><li>dplyr</li><li>stringr</li><li>ggplot2</li><li>viridis</li><li>GenomicRanges</li><li><strong>chromVAR</strong></li><li>DESeq2</li><li><strong>ggpubr</strong></li><li><strong>corrplot</strong></li><li>ChIPseqSpikeInFree [Optional]</li></ul></li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs r">library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>stringr<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>viridis<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>GenomicRanges<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>chromVAR<span class="hljs-punctuation">)</span> <span class="hljs-comment">## For FRiP analysis and differential analysis</span><br>library<span class="hljs-punctuation">(</span>DESeq2<span class="hljs-punctuation">)</span> <span class="hljs-comment">## For differential analysis section</span><br>library<span class="hljs-punctuation">(</span>ggpubr<span class="hljs-punctuation">)</span> <span class="hljs-comment">## For customizing figures</span><br>library<span class="hljs-punctuation">(</span>corrplot<span class="hljs-punctuation">)</span> <span class="hljs-comment">## For correlation plot</span><br></code></pre></td></tr></table></figure><ul><li>FastQC(version &gt;&#x3D; 0.11.9)</li><li>Bowtie2 (version &gt;&#x3D; 2.3.4.3)</li><li>samtools (version &gt;&#x3D; 1.10)</li><li>bedtools (version &gt;&#x3D; 2.29.1)</li><li>Picard (version &gt;&#x3D; 2.18.29)</li><li><strong>SEACR (version &gt;&#x3D; 1.3)</strong></li><li>deepTools (version &gt;&#x3D; 2.0)</li></ul><h2 id="1-5-Data-Downloading"><a href="#1-5-Data-Downloading" class="headerlink" title="1.5. Data Downloading"></a>1.5. Data Downloading</h2><ol><li>Using <a href="https://www.ncbi.nlm.nih.gov/sra/docs/sradownload/">SRA Toolkit</a></li><li>Download through <a href="file:///Users/yezheng/Downloads/downloading_fastq_GEO.pdf">European Nucleotide Archive</a>. New ENA Browser: <a href="https://www.ebi.ac.uk/ena/browser/view">https://www.ebi.ac.uk/ena/browser/view</a>. We are using this option as illustration.</li></ol><ul><li><strong>H3K27me3</strong>:<ul><li>SH_Hs_K27m3_NX_0918 as replicate 1: GEO accession: GSE145187, SRA entry: SRX8754646</li><li>SH_Hs_K27m3_Xpc_0107 as replicate 2: GEO accession: GSE145187, SRA entry: SRX7713678</li></ul></li><li><strong>H3K4me3</strong>:<ul><li>SH_Hs_K4m3_NX_0918 as replicate 1: GEO accession: GSE145187, SRA entry: SRX7713692</li><li>SH_Hs_K4m3_Xpc_0107 as replicate 2: GEO accession: GSE145187, SRA entry: SRX7713696</li></ul></li><li><strong>IgG</strong>:<ul><li>SH_Hs_IgG_1x_0924 as replicate 1:GEO accession: GSE145187, SRA entry: SRX8468909</li><li>SH_Hs_IgG_20181224 as replicate 2: GEO accession: GSM3680227, SRA entry: SRX5545346</li></ul></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#example</span><br>wget -O <span class="hljs-variable">$projPath</span>/data/IgG_rep2/IgG_rep2_R1_001.fastq.gz ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR875/001/SRR8754611/SRR8754611_1.fastq.gz<br>wget -O <span class="hljs-variable">$projPath</span>/data/IgG_rep2/IgG_rep2_R2_001.fastq.gz ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR875/001/SRR8754611/SRR8754611_2.fastq.gz<br></code></pre></td></tr></table></figure><hr><h1 id="II-Data-Pre-processing"><a href="#II-Data-Pre-processing" class="headerlink" title="II. Data Pre-processing"></a>II. Data Pre-processing</h1><p>FASTQC</p><p><strong>Per base sequence content fails the FastQC quality check.</strong></p><p><strong>The discordant sequence content at the begining of the reads are common phenomenon for CUT&amp;Tag reads. Failing to pass the Per base seuqnence content does not mean your data failed.</strong></p><ul><li>It can be due to the Tn5 preference.</li><li>What you might be detecting is <font color="green">the 10-bp</font> periodicity that shows up as a sawtooth pattern in the length distribution. If so, <font color="blue"><strong>this is normal and will not affect alignment or peak calling</strong></font>. In any case we do not recommend trimming as the bowtie2 parameters that we list <font color="blue"><strong>will give accurate mapping information without trimming</strong></font>.</li></ul><h2 id="2-2-Merge-technical-replicates-x2F-lanes-if-needed-Optional"><a href="#2-2-Merge-technical-replicates-x2F-lanes-if-needed-Optional" class="headerlink" title="2.2. Merge technical replicates&#x2F;lanes if needed [Optional]"></a>2.2. Merge technical replicates&#x2F;lanes if needed [Optional]</h2><p>Sometimes, samples are often sequenced across <strong>multiple lanes for efficiency</strong> and can be pooled before alignment. <font color="blue">If you want to <strong>check the reproducibility</strong> between sequences of different lanes of the same sample</font>, you can skip this step and <strong>align</strong> each sequencing file (fastq file) <strong>respectively</strong>.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#combination of the data</span><br><span class="hljs-built_in">cat</span> <span class="hljs-variable">$&#123;projPath&#125;</span>/data/<span class="hljs-variable">$&#123;histName&#125;</span>/*_R1_*.fastq.gz &gt;<span class="hljs-variable">$&#123;projPath&#125;</span>/fastq/<span class="hljs-variable">$&#123;histName&#125;</span>_R1.fastq.gz<br></code></pre></td></tr></table></figure><hr><h1 id="III-Alignment"><a href="#III-Alignment" class="headerlink" title="III. Alignment"></a>III. Alignment</h1><h2 id="3-1-Bowtie2-alignment-required"><a href="#3-1-Bowtie2-alignment-required" class="headerlink" title="3.1. Bowtie2 alignment [required]"></a>3.1. Bowtie2 alignment [required]</h2><p>The structure of <font color="blue"><strong>CUT&amp;Tag insert libraries</strong></font> with <font color="blue"><strong>Tn5 adapters</strong></font> and <font color="blue"><strong>barcoded PCR primers</strong></font> is shown below:</p><p><img src="/GeekFocus/2022-03-21-CUTTag/3.png" alt="Figure 4"><br><img src="/GeekFocus/img/2022-03-21-CUTTag/3.png" alt="Figure 4. CUT&amp;Tag insert libraries with the sequence of adapters."></p><p>Our standard pipeline is to perform <font color="blue">single-index 25x25 PE Illumina sequencing??</font> on up to 90 pooled samples on a single HiSeq 2500 flowcell, where <font color="blue">each sample</font> has a <font color="blue">unique PCR primer barcode</font>. Amounts for <strong>each library</strong> are adjusted to provide <strong>~5 million</strong> paired-end reads, which provides high-quality profiling for abundant chromatin features with a specific and high-yield antibody. Less abundant features typically require fewer reads, while <strong>lower-quality antibodies</strong> may increase the number of reads needed for generating robust chromatin profiles. A thorough discussion of feature recall and <strong>sequencing depths for CUT&amp;Tag</strong> has been published (Kaya-Okur et al 2020).</p><h3 id="3-1-1-Alignment-to-ref"><a href="#3-1-1-Alignment-to-ref" class="headerlink" title="3.1.1 Alignment to ref."></a>3.1.1 Alignment to <font color="red">ref</font>.</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sh">bowtie2 \<br>--end-to-end \<br>--very-sensitive \<br><span class="hljs-comment">#runs a little faster, only consider alignment status of pairs per se</span><br>--no-mixed \<br><span class="hljs-comment">#disablelooks for discordant alignments if it cannot find any concordant alignments. </span><br>--no-discordant \<br>--phred33 \<br><span class="hljs-comment">#-I The minimum fragment length for valid paired-end alignments. Default: 0</span><br>-I 10 \<br>-X 700 \<br>-p <span class="hljs-variable">$&#123;cores&#125;</span> \<br>-x <span class="hljs-variable">$&#123;ref&#125;</span> \<br>-1 <span class="hljs-variable">$&#123;projPath&#125;</span>/fastq/<span class="hljs-variable">$&#123;histName&#125;</span>_R1.fastq.gz -2 <span class="hljs-variable">$&#123;projPath&#125;</span>/fastq/<span class="hljs-variable">$&#123;histName&#125;</span>_R2.fastq.gz \<br>-S <span class="hljs-variable">$&#123;projPath&#125;</span>/alignment/sam/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.sam &amp;&gt; <span class="hljs-variable">$&#123;projPath&#125;</span>/alignment/sam/bowtie2_summary/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.txt<br></code></pre></td></tr></table></figure><p><code>--end-to-end --very-sensitive --no-mixed --no-discordant --phred33 -I 10 -X 700</code> for mapping of <strong>inserts 10-700 bp</strong> in length.</p><p><font color="red"><strong>Critical step</strong></font>: There is no need to trim reads from out standard 25x25 PE sequencing?, as adapter sequences will not be included in reads of inserts &gt;25 bp. However, for users <strong>performing longer sequencing</strong>, reads will need to be trimmed by Cutadapt and mapped by <code>--local --very-sensitive --no-mixed --no-discordant --phred33 -I 10 -X 700</code> to ignore any remaining adapter sequence at the 3â€™ ends of reads during mapping.</p><p><font color="red">â€“local</font> In this mode, Bowtie 2 does not require that the entire read align from one end to the other. Rather, some characters may be omitted (â€œsoft clippedâ€) from the ends <strong>in order to achieve the greatest possible alignment score</strong>. The match bonus <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-ma"><code>--ma</code></a>is used in this mode, and the best possible alignment score is equal to the match bonus (<a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-ma"><code>--ma</code></a>) times the length of the read. Specifying <code>--local</code> and one of the presets (e.g. <code>--local --very-fast</code>) is equivalent to specifying the local version of the preset (<code>--very-fast-local</code>). This is mutually exclusive with <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-end-to-end"><code>--end-to-end</code></a>. <code>--end-to-end</code> is the default mode.</p><h3 id="3-1-2-Alignment-to-spike-in-genome-for-spike-in-calibration-optional-x2F-recommended"><a href="#3-1-2-Alignment-to-spike-in-genome-for-spike-in-calibration-optional-x2F-recommended" class="headerlink" title="3.1.2 Alignment to spike-in genome for spike-in calibration [optional&#x2F;recommended]"></a>3.1.2 Alignment to <font color="red">spike-in genome</font> for spike-in calibration [optional&#x2F;recommended]</h3><p>This section is <strong>optional</strong> but <strong>recommended</strong> depending on your experimental protocol.</p><p><font color="red"><strong>E. coli</strong> DNA is <strong>carried along with</strong> bacterially-produced <strong>pA-Tn5 protein</strong></font> and gets tagmented non-specifically during the reaction. <strong>The fraction of total reads that map to the E.coli genome</strong> <font color="blue"><strong>depends on</strong></font> the <strong>yield of epitope-targeted CUT&amp;Tag</strong>, and so <font color="blue"><strong>depends on</strong></font> the <strong>number of cells used and the abundance of that epitope in chromatin</strong>. Since a constant amount of pATn5 is added to CUT&amp;Tag reactions and brings along a fixed amount of E. coli DNA, E. coli reads can be used to <font color="red"><strong>normalize epitope abundance</strong></font> in a set of experiments. More discussion, please see Section V.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># download E.coli K12 MG1655</span><br>bowtie2-build ecoli.fa ecoli<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">##== linux command ==##</span><br>spikeInRef=/path/to/index/eoli<br>chromSize=<span class="hljs-string">&quot;hg38.chrom.size&quot;</span><br><span class="hljs-comment"># download ecoli K-12 substr.MG1655[INSDC:U00096.3;size:4.64M;]</span><br>bowtie2-build path/to/Ecoli/fasta/Ecoli.fa /path/to/bowtie2Index/Ecoli<br>bowtie2 --end-to-end --very-sensitive --no-overlap --no-dovetail --no-mixed --no-discordant --phred33 -I 10 -X 700 -p <span class="hljs-variable">$&#123;cores&#125;</span> -x <span class="hljs-variable">$&#123;spikeInRef&#125;</span> -1 _R1.fastq.gz -2 _R2.fastq.gz -S _bowtie2_spikeIn.sam &amp;&gt; log_bowtie2_spikeIn.txt<br><br><span class="hljs-comment">#-f output alignments with bits</span><br><span class="hljs-comment">#-F Do not output alignments with any bits set in INT present in the FLAG field. INT can be specified in hex by beginning with 0x&#x27; (i.e. /^0x[0-9A-F]+/) or in octal by beginning with0&#x27; (i.e./^0 [0-7]+/) </span><br><span class="hljs-comment"># FLAGS 0x2 PROPER_PAIR each segment properly aligned according to the aligner</span><br><span class="hljs-comment"># FLAGS 0x4 UNMAP segment unmapped</span><br>seqDepthDouble=`samtools view -F 0x04 _bowtie2_spikeIn.sam | <span class="hljs-built_in">wc</span> -l`<br>seqDepth=$((seqDepthDouble/<span class="hljs-number">2</span>))<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$seqDepth</span> &gt; _bowtie2_spikeIn.seqDepth<br></code></pre></td></tr></table></figure><ul><li>For spike-in normalization, reads are aligned to the <strong>E. coli genome U00096.3</strong> with two more parameters <code>--no-overlap</code>and <code>--no-dovetail</code>(<code>--end-to-end --very-sensitive --no-overlap --no-dovetail --no-mixed --no-discordant --phred33 -I 10 -X 700</code>) to avoid possible cross-mapping of the experimental genome to that of the carry-over E. coli DNA that is used for calibration.</li></ul><h3 id="3-1-3-Alignment-summary"><a href="#3-1-3-Alignment-summary" class="headerlink" title="3.1.3 Alignment summary"></a>3.1.3 Alignment summary</h3><p>For more detailed parameters explanation, users can refer to the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml">bowite2 manual</a>.</p><p>Bowtie2 alignment results summary is saved at <code>log</code> .</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2984630</span> reads; of these:<br>  <span class="hljs-attribute">2984630</span> (<span class="hljs-number">100</span>.<span class="hljs-number">00</span>%) were paired; of these:<br>    <span class="hljs-attribute">125110</span> (<span class="hljs-number">4</span>.<span class="hljs-number">19</span>%) aligned concordantly <span class="hljs-number">0</span> times<br>    <span class="hljs-attribute">2360430</span> (<span class="hljs-number">79</span>.<span class="hljs-number">09</span>%) aligned concordantly exactly <span class="hljs-number">1</span> time<br>    <span class="hljs-attribute">499090</span> (<span class="hljs-number">16</span>.<span class="hljs-number">72</span>%) aligned concordantly &gt;<span class="hljs-number">1</span> times<br><span class="hljs-attribute">95</span>.<span class="hljs-number">81</span>% overall alignment rate<br></code></pre></td></tr></table></figure><ul><li>2984640 is the <strong>sequencing depth?</strong>, i.e., total number of paired reads.</li><li>125110 is the number of read pairs that fail to be mapped.</li><li>2360430 + 499090 is the number of read paris that are successfully mapped.</li><li>95.81% is the overall alignment rate</li></ul><h2 id="3-2-Report-sequencing-mapping-summary-required"><a href="#3-2-Report-sequencing-mapping-summary-required" class="headerlink" title="3.2 Report sequencing mapping summary [required]"></a>3.2 Report sequencing mapping summary [required]</h2><p>Summarize the raw reads and uniquely mapping reads to report the efficiency of alignment. Alignment frequencies are expected to be &gt;80% for high-quality data. <strong>CUT&amp;Tag</strong> data typically has <font color="red"><strong>very low backgrounds</strong></font>, so as few as 1 million mapped fragments can give robust profiles for a histone modification in the human genome. Profiling of less-abundant transcription factors and chromatin proteins may require 10 times as many mapped fragments for downstream analysis.</p><p>We can evaluate the following metrics:</p><ul><li>Sequencing depth</li><li>Alignment rate</li><li>Number of mappable fragments</li><li>Duplication rate</li><li>Unique library size</li><li>Fragment size distribution</li></ul><h3 id="3-2-1-Sequencing-depth"><a href="#3-2-1-Sequencing-depth" class="headerlink" title="3.2.1 Sequencing depth"></a>3.2.1 Sequencing depth</h3><p>code in this part, <font color="red"><strong>no use</strong></font>. Summary all reads, mapped reads, and mapping ratio</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">##=== R command ===## </span><br><span class="hljs-comment">## Path to the project and histone list</span><br>projPath <span class="hljs-operator">=</span> <span class="hljs-string">&quot;///CUTTag_tutorial&quot;</span><br>sampleList <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;K27me3_rep1&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;K27me3_rep2&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;K4me3_rep1&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;K4me3_rep2&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;IgG_rep1&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;IgG_rep2&quot;</span><span class="hljs-punctuation">)</span><br>histList <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;K27me3&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;K4me3&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;IgG&quot;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment">## Collect the alignment results from the bowtie2 alignment summary files</span><br>alignResult <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-keyword">for</span><span class="hljs-punctuation">(</span>hist <span class="hljs-keyword">in</span> sampleList<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  alignRes <span class="hljs-operator">=</span> read.table<span class="hljs-punctuation">(</span>paste0<span class="hljs-punctuation">(</span>projPath<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;/alignment/sam/bowtie2_summary/&quot;</span><span class="hljs-punctuation">,</span> hist<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_bowtie2.txt&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> header <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> fill <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>  alignRate <span class="hljs-operator">=</span> substr<span class="hljs-punctuation">(</span>alignRes<span class="hljs-operator">$</span>V1<span class="hljs-punctuation">[</span><span class="hljs-number">6</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> nchar<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.character</span><span class="hljs-punctuation">(</span>alignRes<span class="hljs-operator">$</span>V1<span class="hljs-punctuation">[</span><span class="hljs-number">6</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><br>  histInfo <span class="hljs-operator">=</span> strsplit<span class="hljs-punctuation">(</span>hist<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br>  alignResult <span class="hljs-operator">=</span> data.frame<span class="hljs-punctuation">(</span>Histone <span class="hljs-operator">=</span> histInfo<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> Replicate <span class="hljs-operator">=</span> histInfo<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br>                           SequencingDepth <span class="hljs-operator">=</span> alignRes<span class="hljs-operator">$</span>V1<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.character</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">,</span> <br>                           MappedFragNum_hg38 <span class="hljs-operator">=</span> alignRes<span class="hljs-operator">$</span>V1<span class="hljs-punctuation">[</span><span class="hljs-number">4</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.character</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.numeric</span> <span class="hljs-operator">+</span> alignRes<span class="hljs-operator">$</span>V1<span class="hljs-punctuation">[</span><span class="hljs-number">5</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.character</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">,</span> <br>                           AlignmentRate_hg38 <span class="hljs-operator">=</span> alignRate <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">)</span>  <span class="hljs-operator">%&gt;%</span> rbind<span class="hljs-punctuation">(</span>alignResult<span class="hljs-punctuation">,</span> .<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br>alignResult<span class="hljs-operator">$</span>Histone <span class="hljs-operator">=</span> factor<span class="hljs-punctuation">(</span>alignResult<span class="hljs-operator">$</span>Histone<span class="hljs-punctuation">,</span> levels <span class="hljs-operator">=</span> histList<span class="hljs-punctuation">)</span><br>alignResult <span class="hljs-operator">%&gt;%</span> mutate<span class="hljs-punctuation">(</span>AlignmentRate_hg38 <span class="hljs-operator">=</span> paste0<span class="hljs-punctuation">(</span>AlignmentRate_hg38<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;%&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><h3 id="3-2-2-Spike-in-alignment"><a href="#3-2-2-Spike-in-alignment" class="headerlink" title="3.2.2 Spike-in alignment"></a>3.2.2 Spike-in alignment</h3><p>Summary of bowtie2 log file</p><h3 id="3-2-3-Summarize-the-alignment-to-hg38-and-E-coli"><a href="#3-2-3-Summarize-the-alignment-to-hg38-and-E-coli" class="headerlink" title="3.2.3 Summarize the alignment to hg38 and E.coli"></a>3.2.3 Summarize the alignment to hg38 and E.coli</h3><p>Summary of bowtie2 log file(ref and ecoli)</p><h3 id="3-2-4-Visualizing-the-sequencing-depth-and-alignment-results"><a href="#3-2-4-Visualizing-the-sequencing-depth-and-alignment-results" class="headerlink" title="3.2.4 Visualizing the sequencing depth and alignment results"></a>3.2.4 Visualizing the sequencing depth and alignment results</h3><p><font color="red"><strong>No use</strong></font> . barplot learning</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">## Generate sequencing depth boxplot</span><br>fig3A = alignResult %&gt;% ggplot(aes(x = Histone, y = SequencingDepth/1000000, fill = Histone)) +<br>    geom_boxplot() +<br>    geom_jitter(aes(color = Replicate), position = position_jitter(0.15)) +<br>    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.9, option = <span class="hljs-string">&quot;magma&quot;</span>, alpha = 0.8) +<br>    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<br>    theme_bw(base_size = 18) +<br>    ylab(<span class="hljs-string">&quot;Sequencing Depth per Million&quot;</span>) +<br>    xlab(<span class="hljs-string">&quot;&quot;</span>) + <br>    ggtitle(<span class="hljs-string">&quot;A. Sequencing Depth&quot;</span>)<br></code></pre></td></tr></table></figure><p>In a typical <strong>CUT&amp;Tag experiment</strong> targeting the abundant <strong>H3K27me3</strong> histone modification in <strong>65,000</strong> <strong>K562 cells</strong>, the <font color="red"><strong>percentage</strong> of <strong>E. coli</strong> reads range from ~<strong>0.01% to 10%</strong></font>. With <font color="red"><strong>fewer cells</strong> or <strong>less abundant epitopes</strong></font>, E. coli reads can comprise[<strong>more</strong>] as much as 70% or the total mapped reads. For <font color="red"><strong>IgG</strong> controls</font>, the percentage of <strong>E. coli</strong> reads is typically <font color="red"><strong>much higher</strong></font> than that for an abundant histone modification.</p><h2 id="3-3-Remove-duplicates-optional-x2F-required"><a href="#3-3-Remove-duplicates-optional-x2F-required" class="headerlink" title="3.3. Remove duplicates [optional&#x2F;required]"></a>3.3. Remove duplicates [optional&#x2F;required]</h2><p>CUT&amp;Tag integrates adapters into DNA in the vicinity of the antibody-tethered pA-Tn5, and the exact sites of integration are affected by the accessibility of surrounding DNA. For this reason fragments that share exact starting and ending positions are expected to be common, and <font color="red">such â€˜duplicatesâ€™ <strong>may not be due to duplication during PCR</strong></font>. In practice, we have found that the <font color="red">apparent <strong>duplication rate is low for high quality CUT&amp;Tag datasets</strong></font>, and even the apparent â€˜duplicateâ€™ fragments are <strong>likely to be true fragments</strong>. Thus, we <font color="red"><strong>do not recommend removing</strong> the duplicates</font>. In experiments with very small amounts of material or where PCR duplication is suspected, duplicates can be removed. The following commands show how to check the duplication rate using <a href="https://broadinstitute.github.io/picard/">Picard</a>.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">##== linux command ==##</span><br><span class="hljs-comment">## depending on how you load picard and your server environment, the picardCMD can be different. Adjust accordingly.</span><br>picardCMD=<span class="hljs-string">&quot;java -jar picard.jar&quot;</span><br><span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$projPath</span>/alignment/removeDuplicate/picard_summary<br><br><span class="hljs-comment">## Sort by coordinate</span><br><span class="hljs-variable">$picardCMD</span> SortSam I=<span class="hljs-variable">$projPath</span>/alignment/sam/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.sam O=<span class="hljs-variable">$projPath</span>/alignment/sam/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.sorted.sam SORT_ORDER=coordinate<br><br><span class="hljs-comment">## mark duplicates</span><br><span class="hljs-variable">$picardCMD</span> MarkDuplicates I=<span class="hljs-variable">$projPath</span>/alignment/sam/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.sorted.sam O=<span class="hljs-variable">$projPath</span>/alignment/removeDuplicate/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.sorted.dupMarked.sam METRICS_FILE=<span class="hljs-variable">$projPath</span>/alignment/removeDuplicate/picard_summary/<span class="hljs-variable">$&#123;histName&#125;</span>_picard.dupMark.txt<br><br><span class="hljs-comment">## remove duplicates</span><br>picardCMD MarkDuplicates I=<span class="hljs-variable">$projPath</span>/alignment/sam/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.sorted.sam O=<span class="hljs-variable">$projPath</span>/alignment/removeDuplicate/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.sorted.rmDup.sam REMOVE_DUPLICATES=<span class="hljs-literal">true</span> METRICS_FILE=<span class="hljs-variable">$projPath</span>/alignment/removeDuplicate/picard_summary/<span class="hljs-variable">$&#123;histName&#125;</span>_picard.rmDup.txt<br></code></pre></td></tr></table></figure><p>We summarize the apparent duplication rate and calculate the unique library size without duplicates.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">##=== R command ===## </span><br><span class="hljs-comment">## Summarize the duplication information from the picard summary outputs.</span><br>library<span class="hljs-punctuation">(</span>magrittr<span class="hljs-punctuation">)</span><br>libry<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span><br>libry<span class="hljs-punctuation">)</span><span class="hljs-punctuation">(</span>idyverse<br>sampleList <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;K27me3_rep1&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;K27me3_rep2&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;K4me3_rep1&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;K4me3_rep2&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;IgG_rep1&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;IgG_rep2&quot;</span><span class="hljs-punctuation">)</span><br>histList <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;K27me3&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;K4me3&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;IgG&quot;</span><span class="hljs-punctuation">)</span><br><br>dupResult <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-keyword">for</span><span class="hljs-punctuation">(</span>hist <span class="hljs-keyword">in</span> sampleList<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  dupRes <span class="hljs-operator">=</span> read.table<span class="hljs-punctuation">(</span>paste0<span class="hljs-punctuation">(</span>projPath<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;/alignment/removeDuplicate/picard_summary/&quot;</span><span class="hljs-punctuation">,</span> hist<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_picard.rmDup.txt&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> header <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> fill <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>  <br>  histInfo <span class="hljs-operator">=</span> strsplit<span class="hljs-punctuation">(</span>hist<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br>  dupResult <span class="hljs-operator">=</span> data.frame<span class="hljs-punctuation">(</span>Histone <span class="hljs-operator">=</span> histInfo<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> Replicate <span class="hljs-operator">=</span> histInfo<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> MappedFragNum_hg38 <span class="hljs-operator">=</span> dupRes<span class="hljs-operator">$</span>READ_PAIRS_EXAMINED<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.character</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">,</span> DuplicationRate <span class="hljs-operator">=</span> dupRes<span class="hljs-operator">$</span>PERCENT_DUPLICATION<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.character</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.numeric</span> <span class="hljs-operator">*</span> <span class="hljs-number">100</span><span class="hljs-punctuation">,</span> EstimatedLibrarySize <span class="hljs-operator">=</span> dupRes<span class="hljs-operator">$</span>ESTIMATED_LIBRARY_SIZE<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.character</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> mutate<span class="hljs-punctuation">(</span>UniqueFragNum <span class="hljs-operator">=</span> MappedFragNum_hg38 <span class="hljs-operator">*</span> <span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">-</span>DuplicationRate<span class="hljs-operator">/</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>  <span class="hljs-operator">%&gt;%</span> rbind<span class="hljs-punctuation">(</span>dupResult<span class="hljs-punctuation">,</span> .<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br>dupResult<span class="hljs-operator">$</span>Histone <span class="hljs-operator">=</span> factor<span class="hljs-punctuation">(</span>dupResult<span class="hljs-operator">$</span>Histone<span class="hljs-punctuation">,</span> levels <span class="hljs-operator">=</span> histList<span class="hljs-punctuation">)</span><br>alignDupSummary <span class="hljs-operator">=</span> left_join<span class="hljs-punctuation">(</span>alignSummary<span class="hljs-punctuation">,</span> dupResult<span class="hljs-punctuation">,</span> by <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Histone&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Replicate&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;MappedFragNum_hg38&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> mutate<span class="hljs-punctuation">(</span>DuplicationRate <span class="hljs-operator">=</span> paste0<span class="hljs-punctuation">(</span>DuplicationRate<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;%&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>alignDupSummary<br></code></pre></td></tr></table></figure><p>è®¡ç®—æ€»readsï¼Œæ¯”å¯¹åˆ°refå’Œecoliçš„fragå’Œratioï¼Œè®¡ç®—<strong>duplicationrateï¼Œestimatedlibrarysizeå’ŒuniqueFragNum</strong></p><ul><li>In these example datasets, the <strong>IgG</strong> control samples have <strong>relatively high duplication rates</strong>, since reads in this sample derive from <strong>non-specific tagmentation</strong> in the CUT&amp;Tag reactions. Therefore, <font color="red">it is appropriate to <strong>remove the duplicates</strong> from the <strong>IgG</strong> datasets before downstream analysis</font>.</li><li>The <font color="red"><strong>estimated library size</strong></font> are the estimated <strong>number of unique molecules in the library based on PE duplication</strong> calculated by <strong>Picard</strong>.</li><li>The estimated library sizes is proportional to the <strong>abundance of the targeted epitope</strong> and to the <strong>quality of the antibody</strong> used, while the estimated library sizes of <font color="red">IgG</font> samples are expected to be <font color="red">very low</font>.</li><li><strong>Unique fragment number</strong> is calculated by the MappedFragNum_hg38 * (1-DuplicationRate&#x2F;100).</li></ul><p><font color="red"><strong>no use</strong>, code</font></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">##=== R command ===## </span><br><span class="hljs-comment">## generate boxplot figure for the  duplication rate</span><br>fig4A <span class="hljs-operator">=</span> dupResult <span class="hljs-operator">%&gt;%</span> ggplot<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> Histone<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> DuplicationRate<span class="hljs-punctuation">,</span> fill <span class="hljs-operator">=</span> Histone<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    geom_boxplot<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    geom_jitter<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> Replicate<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> position <span class="hljs-operator">=</span> position_jitter<span class="hljs-punctuation">(</span><span class="hljs-number">0.15</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    scale_fill_viridis<span class="hljs-punctuation">(</span>discrete <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> begin <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> end <span class="hljs-operator">=</span> <span class="hljs-number">0.9</span><span class="hljs-punctuation">,</span> option <span class="hljs-operator">=</span> <span class="hljs-string">&quot;magma&quot;</span><span class="hljs-punctuation">,</span> alpha <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    scale_color_viridis<span class="hljs-punctuation">(</span>discrete <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> begin <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> end <span class="hljs-operator">=</span> <span class="hljs-number">0.9</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    ylab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Duplication Rate (*100%)&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    xlab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span> <br><span class="hljs-comment">## generate boxplot figure for the  Estimated Library Size</span><br>fig4B <span class="hljs-operator">=</span> dupResult <span class="hljs-operator">%&gt;%</span> ggplot<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> Histone<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> EstimatedLibrarySize<span class="hljs-punctuation">,</span> fill <span class="hljs-operator">=</span> Histone<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    geom_boxplot<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    geom_jitter<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> Replicate<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> position <span class="hljs-operator">=</span> position_jitter<span class="hljs-punctuation">(</span><span class="hljs-number">0.15</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    scale_fill_viridis<span class="hljs-punctuation">(</span>discrete <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> begin <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> end <span class="hljs-operator">=</span> <span class="hljs-number">0.9</span><span class="hljs-punctuation">,</span> option <span class="hljs-operator">=</span> <span class="hljs-string">&quot;magma&quot;</span><span class="hljs-punctuation">,</span> alpha <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    scale_color_viridis<span class="hljs-punctuation">(</span>discrete <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> begin <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> end <span class="hljs-operator">=</span> <span class="hljs-number">0.9</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    ylab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Estimated Library Size&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    xlab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span> <br><span class="hljs-comment">## generate boxplot figure for the  Unique Fragments</span><br>fig4C <span class="hljs-operator">=</span> dupResult <span class="hljs-operator">%&gt;%</span> ggplot<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> Histone<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> UniqueFragNum<span class="hljs-punctuation">,</span> fill <span class="hljs-operator">=</span> Histone<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    geom_boxplot<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    geom_jitter<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> Replicate<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> position <span class="hljs-operator">=</span> position_jitter<span class="hljs-punctuation">(</span><span class="hljs-number">0.15</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    scale_fill_viridis<span class="hljs-punctuation">(</span>discrete <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> begin <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> end <span class="hljs-operator">=</span> <span class="hljs-number">0.9</span><span class="hljs-punctuation">,</span> option <span class="hljs-operator">=</span> <span class="hljs-string">&quot;magma&quot;</span><span class="hljs-punctuation">,</span> alpha <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    scale_color_viridis<span class="hljs-punctuation">(</span>discrete <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> begin <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> end <span class="hljs-operator">=</span> <span class="hljs-number">0.9</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    ylab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;# of Unique Fragments&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    xlab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><br><br>ggarrange<span class="hljs-punctuation">(</span>fig4A<span class="hljs-punctuation">,</span> fig4B<span class="hljs-punctuation">,</span> fig4C<span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> common.legend <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> legend<span class="hljs-operator">=</span><span class="hljs-string">&quot;bottom&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><h2 id="3-4-Assess-mapped-fragment-size-distribution-Required"><a href="#3-4-Assess-mapped-fragment-size-distribution-Required" class="headerlink" title="3.4. Assess mapped fragment size distribution [Required]"></a>3.4. Assess mapped fragment size distribution [Required]</h2><p>CUT&amp;Tag inserts adapters on either side of chromatin particles in the vicinity of the tethered enzyme, although tagmentation within chromatin particles can also occur. So, CUT&amp;Tag reactions targeting a histone modification predominantly results in fragments that are nucleosomal lengths (~180 bp), or multiples of that length. CUT&amp;Tag targeting transcription factors predominantly produce nucleosome-sized fragments and variable amounts of shorter fragments, from neighboring nucleosomes and the factor-bound site, respectively. Tagmentation of DNA on the surface of nucleosomes also occurs, and plotting fragment lengths with single-basepair resolution reveal a 10-bp sawtooth periodicity, which is typical of successful CUT&amp;Tag experiments.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs linux">##== linux command ==##<br>mkdir -p $projPath/alignment/sam/fragmentLen<br><br>## Extract the 9th column from the alignment sam file which is the fragment length<br>samtools view -F 0x04 $projPath/alignment/sam/$&#123;histName&#125;_bowtie2.sam | awk -F&#x27;\t&#x27; &#x27;function abs(x)&#123;return ((x &lt; 0.0) ? -x : x)&#125; &#123;print abs($9)&#125;&#x27; | sort | uniq -c | awk -v OFS=&quot;\t&quot; &#x27;&#123;print $2, $1/2&#125;&#x27; &gt;$projPath/alignment/sam/fragmentLen/$&#123;histName&#125;_fragmentLen.txt<br></code></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">##=== R command ===## </span><br><span class="hljs-comment">## Collect the fragment size information</span><br>fragLen <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-keyword">for</span><span class="hljs-punctuation">(</span>hist <span class="hljs-keyword">in</span> sampleList<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  <br>  histInfo <span class="hljs-operator">=</span> strsplit<span class="hljs-punctuation">(</span>hist<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br>  fragLen <span class="hljs-operator">=</span> read.table<span class="hljs-punctuation">(</span>paste0<span class="hljs-punctuation">(</span>projPath<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;/alignment/sam/fragmentLen/&quot;</span><span class="hljs-punctuation">,</span> hist<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_fragmentLen.txt&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> header <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> mutate<span class="hljs-punctuation">(</span>fragLen <span class="hljs-operator">=</span> V1 <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">,</span> fragCount <span class="hljs-operator">=</span> V2 <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">,</span> Weight <span class="hljs-operator">=</span> <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>V2<span class="hljs-punctuation">)</span><span class="hljs-operator">/</span><span class="hljs-built_in">sum</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>V2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> Histone <span class="hljs-operator">=</span> histInfo<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> Replicate <span class="hljs-operator">=</span> histInfo<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sampleInfo <span class="hljs-operator">=</span> hist<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> rbind<span class="hljs-punctuation">(</span>fragLen<span class="hljs-punctuation">,</span> .<span class="hljs-punctuation">)</span> <br><span class="hljs-punctuation">&#125;</span><br>fragLen<span class="hljs-operator">$</span>sampleInfo <span class="hljs-operator">=</span> factor<span class="hljs-punctuation">(</span>fragLen<span class="hljs-operator">$</span>sampleInfo<span class="hljs-punctuation">,</span> levels <span class="hljs-operator">=</span> sampleList<span class="hljs-punctuation">)</span><br>fragLen<span class="hljs-operator">$</span>Histone <span class="hljs-operator">=</span> factor<span class="hljs-punctuation">(</span>fragLen<span class="hljs-operator">$</span>Histone<span class="hljs-punctuation">,</span> levels <span class="hljs-operator">=</span> histList<span class="hljs-punctuation">)</span><br><span class="hljs-comment">## Generate the fragment size density plot (violin plot)</span><br>fig5A <span class="hljs-operator">=</span> fragLen <span class="hljs-operator">%&gt;%</span> ggplot<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> sampleInfo<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> fragLen<span class="hljs-punctuation">,</span> weight <span class="hljs-operator">=</span> Weight<span class="hljs-punctuation">,</span> fill <span class="hljs-operator">=</span> Histone<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    geom_violin<span class="hljs-punctuation">(</span>bw <span class="hljs-operator">=</span> <span class="hljs-number">5</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    scale_y_continuous<span class="hljs-punctuation">(</span>breaks <span class="hljs-operator">=</span> seq<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">800</span><span class="hljs-punctuation">,</span> <span class="hljs-number">50</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    scale_fill_viridis<span class="hljs-punctuation">(</span>discrete <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> begin <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> end <span class="hljs-operator">=</span> <span class="hljs-number">0.9</span><span class="hljs-punctuation">,</span> option <span class="hljs-operator">=</span> <span class="hljs-string">&quot;magma&quot;</span><span class="hljs-punctuation">,</span> alpha <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    scale_color_viridis<span class="hljs-punctuation">(</span>discrete <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> begin <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> end <span class="hljs-operator">=</span> <span class="hljs-number">0.9</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">20</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    ggpubr<span class="hljs-operator">::</span>rotate_x_text<span class="hljs-punctuation">(</span>angle <span class="hljs-operator">=</span> <span class="hljs-number">20</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    ylab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Fragment Length&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    xlab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><br><br>fig5B <span class="hljs-operator">=</span> fragLen <span class="hljs-operator">%&gt;%</span> ggplot<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> fragLen<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> fragCount<span class="hljs-punctuation">,</span> color <span class="hljs-operator">=</span> Histone<span class="hljs-punctuation">,</span> group <span class="hljs-operator">=</span> sampleInfo<span class="hljs-punctuation">,</span> linetype <span class="hljs-operator">=</span> Replicate<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  geom_line<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  scale_color_viridis<span class="hljs-punctuation">(</span>discrete <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> begin <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> end <span class="hljs-operator">=</span> <span class="hljs-number">0.9</span><span class="hljs-punctuation">,</span> option <span class="hljs-operator">=</span> <span class="hljs-string">&quot;magma&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">20</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  xlab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Fragment Length&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  ylab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Count&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  coord_cartesian<span class="hljs-punctuation">(</span>xlim <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">500</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br>ggarrange<span class="hljs-punctuation">(</span>fig5A<span class="hljs-punctuation">,</span> fig5B<span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="/GeekFocus/2022-03-21-CUTTag/4.png"><br><img src="/GeekFocus/img/2022-03-21-CUTTag/4.png"></p><ul><li>The smaller fragments (50-100 bp) can be due to that tethered Tn5 can tagment on the surface of a nucleosome as well as in linker regions(NFR?), so the <strong>small fragments might not be background.</strong></li></ul><h2 id="3-5-Assess-replicate-reproducibility"><a href="#3-5-Assess-replicate-reproducibility" class="headerlink" title="3.5 Assess replicate reproducibility"></a>3.5 Assess replicate reproducibility</h2><p>Data reproducibility between replicates is assessed by <strong>correlation</strong> analysis of <strong>mapped read counts</strong> across the genome. For the simplicity of implementation, we will postpone this analysis after Section IV when the file format has been converted into fragment bed files.</p><hr><h1 id="IV-Alignments-results-filtering-and-file-format-conversion"><a href="#IV-Alignments-results-filtering-and-file-format-conversion" class="headerlink" title="IV. Alignments results filtering and file format conversion"></a>IV. Alignments results filtering and file format conversion</h1><h2 id="4-1-Filtering-mapped-reads-by-the-mapping-quality-filtering-optinal"><a href="#4-1-Filtering-mapped-reads-by-the-mapping-quality-filtering-optinal" class="headerlink" title="4.1 Filtering mapped reads by the mapping quality filtering [optinal]"></a>4.1 Filtering mapped reads by the mapping quality filtering [<font color="red">optinal</font>]</h2><p>Some project may require more stringent filtering on the alignment quality score. This <a href="http://biofinysics.blogspot.com/2014/05/how-does-bowtie2-assign-mapq-scores.html">blog</a> detailedly discussed how does bowtie assign quality score with examples.</p><p>MAPQ(x) &#x3D; -10 * log10(P(x is mapped wrongly)) &#x3D; -10 * log10(p)</p><p>which ranges from 0 to 37, 40 or 42.</p><p><code>samtools view -q minQualityScore</code> will <strong>eliminate</strong> all the alignment results that are below the minQualityScore defined by user.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">##== linux command ==##</span><br>minQualityScore=2<span class="hljs-comment">#20?30?</span><br>samtools view -q <span class="hljs-variable">$minQualityScore</span> <span class="hljs-variable">$&#123;projPath&#125;</span>/alignment/sam/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.sam &gt;<span class="hljs-variable">$&#123;projPath&#125;</span>/alignment/sam/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.qualityScore<span class="hljs-variable">$minQualityScore</span>.sam<br></code></pre></td></tr></table></figure><ul><li>If you do implement this filtering, please replace the <code>$&#123;histName&#125;_bowtie2.sam</code> in the following steps by this filtered sam file <code>$&#123;histName&#125;_bowtie2.qualityScore$minQualityScore.sam</code>. <font color="red">Use the MAPQ20&#x2F;30 reads</font></li></ul><h2 id="4-2-File-format-conversion-required"><a href="#4-2-File-format-conversion-required" class="headerlink" title="4.2 File format conversion [required]"></a>4.2 File format conversion [required]</h2><p>This section is <strong>required</strong> in preparation for the <font color="red">peak calling</font> and <font color="red">visualization</font> where there are a few filtering and file format conversion that need to be done.</p><p>For example, in MACS2, it has bed(shift extent mode) and pe mode</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">##== linux command ==##</span><br><span class="hljs-comment">## Filter and keep the mapped read pairs</span><br>samtools view -bS -F 0x4 <span class="hljs-variable">$projPath</span>/alignment/sam/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.sam &gt;<span class="hljs-variable">$projPath</span>/alignment/bam/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.mapped.bam<br><br><span class="hljs-comment">## Convert into bed file format</span><br>bedtools bamtobed -i <span class="hljs-variable">$projPath</span>/alignment/bam/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.mapped.bam -bedpe &gt;<span class="hljs-variable">$projPath</span>/alignment/bed/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.bed<br><br><span class="hljs-comment">## Keep the read pairs that are on the same chromosome and fragment length less than 1000bp.</span><br>awk <span class="hljs-string">&#x27;$1==$4 &amp;&amp; $6-$2 &lt; 1000 &#123;print $0&#125;&#x27;</span> <span class="hljs-variable">$projPath</span>/alignment/bed/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.bed &gt;<span class="hljs-variable">$projPath</span>/alignment/bed/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.clean.bed<br><br><span class="hljs-comment">## Only extract the fragment related columns</span><br><span class="hljs-built_in">cut</span> -f 1,2,6 <span class="hljs-variable">$projPath</span>/alignment/bed/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.clean.bed | <span class="hljs-built_in">sort</span> -k1,1 -k2,2n -k3,3n  &gt;<span class="hljs-variable">$projPath</span>/alignment/bed/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.fragments.bed<br></code></pre></td></tr></table></figure><h2 id="4-3-Assess-replicate-reproducibility-continue-section-3-5"><a href="#4-3-Assess-replicate-reproducibility-continue-section-3-5" class="headerlink" title="4.3 Assess replicate reproducibility (continue section 3.5)"></a>4.3 Assess replicate reproducibility (continue section 3.5)</h2><p>To study the reproducibility between replicates and across conditions, the <strong>genome is split into 500 bp bins</strong>, and a <strong>Pearson correlation of the log2-transformed values</strong> of <strong>read counts in each bin</strong> is calculated between replicate datasets. Multiple replicates and IgG control datasets are displayed in a hierarchically clustered correlation matrix.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">##== linux command ==##</span><br><span class="hljs-comment">## We use the mid point of each fragment to infer which 500bp bins does this fragment belong to.</span><br>binLen=500<br>awk -v w=<span class="hljs-variable">$binLen</span> <span class="hljs-string">&#x27;&#123;print $1, int(($2 + $3)/(2*w))*w + w/2&#125;&#x27;</span> <span class="hljs-variable">$projPath</span>/alignment/bed/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.fragments.bed | <span class="hljs-built_in">sort</span> -k1,1V -k2,2n | <span class="hljs-built_in">uniq</span> -c | awk -v OFS=<span class="hljs-string">&quot;\t&quot;</span> <span class="hljs-string">&#x27;&#123;print $2, $3, $1&#125;&#x27;</span> |  <span class="hljs-built_in">sort</span> -k1,1V -k2,2n  &gt;<span class="hljs-variable">$projPath</span>/alignment/bed/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.fragmentsCount.bin<span class="hljs-variable">$binLen</span>.bed<br></code></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">##== R command ==##</span><br>reprod <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>fragCount <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><br><span class="hljs-keyword">for</span><span class="hljs-punctuation">(</span>hist <span class="hljs-keyword">in</span> sampleList<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  <br>  <span class="hljs-keyword">if</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">is.null</span><span class="hljs-punctuation">(</span>fragCount<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>    <br>    fragCount <span class="hljs-operator">=</span> read.table<span class="hljs-punctuation">(</span>paste0<span class="hljs-punctuation">(</span>projPath<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;/alignment/bed/&quot;</span><span class="hljs-punctuation">,</span> hist<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_bowtie2.fragmentsCount.bin500.bed&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> header <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span> <br>    colnames<span class="hljs-punctuation">(</span>fragCount<span class="hljs-punctuation">)</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;chrom&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;bin&quot;</span><span class="hljs-punctuation">,</span> hist<span class="hljs-punctuation">)</span><br>  <br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-keyword">else</span><span class="hljs-punctuation">&#123;</span><br>    <br>    fragCountTmp <span class="hljs-operator">=</span> read.table<span class="hljs-punctuation">(</span>paste0<span class="hljs-punctuation">(</span>projPath<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;/alignment/bed/&quot;</span><span class="hljs-punctuation">,</span> hist<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_bowtie2.fragmentsCount.bin500.bed&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> header <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>    colnames<span class="hljs-punctuation">(</span>fragCountTmp<span class="hljs-punctuation">)</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;chrom&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;bin&quot;</span><span class="hljs-punctuation">,</span> hist<span class="hljs-punctuation">)</span><br>    fragCount <span class="hljs-operator">=</span> full_join<span class="hljs-punctuation">(</span>fragCount<span class="hljs-punctuation">,</span> fragCountTmp<span class="hljs-punctuation">,</span> by <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;chrom&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;bin&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>    <br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br>M <span class="hljs-operator">=</span> cor<span class="hljs-punctuation">(</span>fragCount <span class="hljs-operator">%&gt;%</span> select<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;chrom&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;bin&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> log2<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> use <span class="hljs-operator">=</span> <span class="hljs-string">&quot;complete.obs&quot;</span><span class="hljs-punctuation">)</span> <br><br>corrplot<span class="hljs-punctuation">(</span>M<span class="hljs-punctuation">,</span> method <span class="hljs-operator">=</span> <span class="hljs-string">&quot;color&quot;</span><span class="hljs-punctuation">,</span> outline <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span> addgrid.col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;darkgray&quot;</span><span class="hljs-punctuation">,</span> order<span class="hljs-operator">=</span><span class="hljs-string">&quot;hclust&quot;</span><span class="hljs-punctuation">,</span> addrect <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> rect.col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span> rect.lwd <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span>cl.pos <span class="hljs-operator">=</span> <span class="hljs-string">&quot;b&quot;</span><span class="hljs-punctuation">,</span> tl.col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;indianred4&quot;</span><span class="hljs-punctuation">,</span> tl.cex <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> cl.cex <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> addCoef.col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span> number.digits <span class="hljs-operator">=</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> number.cex <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> col <span class="hljs-operator">=</span> colorRampPalette<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;midnightblue&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;white&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;darkred&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">(</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="/GeekFocus/2022-03-21-CUTTag/5.png"><br><img src="/GeekFocus/img/2022-03-21-CUTTag/5.png"></p><hr><h1 id="V-Spike-in-calibration"><a href="#V-Spike-in-calibration" class="headerlink" title="V. Spike-in calibration"></a>V. Spike-in calibration</h1><p>This section is <strong>optional</strong> but <strong>recommended</strong> depending on your experimental protocol. We have shown the alignment to the spike-in genome in Section 3.1.2 and the spike-in alignment summary in Section 3.2.2.</p><p>The underlying assumption is that the ratio of fragments mapped to the primary genome to the E. coli genome is the same for a series of samples, each using the same number of cells. Because of this assumption, we do not normalize between experiments or between batches of purified pATn5, which can have very different amounts of carry-over E. coli DNA. Using a constant C to avoid small fractions in normalized data, we define a scaling factor S as</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">S</span> <span class="hljs-operator">=</span> C / (fragments mapped to E. coli genome)<br></code></pre></td></tr></table></figure><p>Normalized coverage is then calculated as:</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">Normalized coverage <span class="hljs-operator">=</span> (primary_genome_coverage) * S<br></code></pre></td></tr></table></figure><p>The Constant is an arbitrary multiplier, typically 10,000. The resulting file will be comparatively small as a genomic coverage bedgraph file.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">##== linux command ==##</span><br><span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$seqDepth</span>&quot;</span> -gt <span class="hljs-string">&quot;1&quot;</span> ]]; <span class="hljs-keyword">then</span><br>    <br>    <span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$projPath</span>/alignment/bedgraph<br><br>    scale_factor=`<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;10000 / <span class="hljs-variable">$seqDepth</span>&quot;</span> | bc -l`<br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Scaling factor for <span class="hljs-variable">$histName</span> is: <span class="hljs-variable">$scale_factor</span>!&quot;</span><br>    bedtools genomecov -<span class="hljs-built_in">bg</span> -scale <span class="hljs-variable">$scale_factor</span> -i <span class="hljs-variable">$projPath</span>/alignment/bed/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.fragments.bed -g <span class="hljs-variable">$chromSize</span> &gt; <span class="hljs-variable">$projPath</span>/alignment/bedgraph/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.fragments.normalized.bedgraph<br>    <br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><h2 id="5-1-Scaling-factor"><a href="#5-1-Scaling-factor" class="headerlink" title="5.1 Scaling factor"></a>5.1 Scaling factor</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">##=== R command ===## </span><br>scaleFactor <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>multiplier <span class="hljs-operator">=</span> <span class="hljs-number">10000</span><br><span class="hljs-keyword">for</span><span class="hljs-punctuation">(</span>hist <span class="hljs-keyword">in</span> sampleList<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  spikeDepth <span class="hljs-operator">=</span> read.table<span class="hljs-punctuation">(</span>paste0<span class="hljs-punctuation">(</span>projPath<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;/alignment/sam/bowtie2_summary/&quot;</span><span class="hljs-punctuation">,</span> hist<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_bowtie2_spikeIn.seqDepth&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> header <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> fill <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-operator">$</span>V1<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>  <br>  histInfo <span class="hljs-operator">=</span> strsplit<span class="hljs-punctuation">(</span>hist<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br>  scaleFactor <span class="hljs-operator">=</span> data.frame<span class="hljs-punctuation">(</span>scaleFactor <span class="hljs-operator">=</span> multiplier<span class="hljs-operator">/</span>spikeDepth<span class="hljs-punctuation">,</span> Histone <span class="hljs-operator">=</span> histInfo<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> Replicate <span class="hljs-operator">=</span> histInfo<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span>  <span class="hljs-operator">%&gt;%</span> rbind<span class="hljs-punctuation">(</span>scaleFactor<span class="hljs-punctuation">,</span> .<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br>scaleFactor<span class="hljs-operator">$</span>Histone <span class="hljs-operator">=</span> factor<span class="hljs-punctuation">(</span>scaleFactor<span class="hljs-operator">$</span>Histone<span class="hljs-punctuation">,</span> levels <span class="hljs-operator">=</span> histList<span class="hljs-punctuation">)</span><br>left_join<span class="hljs-punctuation">(</span>alignDupSummary<span class="hljs-punctuation">,</span> scaleFactor<span class="hljs-punctuation">,</span> by <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Histone&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Replicate&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p>Histone<br>Replicate<br>SequencingDepth<br>MappedFragNum_hg38<br>AlignmentRate_hg38<br>MappedFragNum_spikeIn<br>AlignmentRate_spikeIn<br><strong>DuplicationRate</strong><br><strong>EstimatedLibrarySize</strong><br><strong>UniqueFragNum</strong><br><strong>scaleFactor</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">##=== R command ===##</span><br><span class="hljs-comment">## Generate sequencing depth boxplot</span><br>fig6A <span class="hljs-operator">=</span> scaleFactor <span class="hljs-operator">%&gt;%</span> ggplot<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> Histone<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> scaleFactor<span class="hljs-punctuation">,</span> fill <span class="hljs-operator">=</span> Histone<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    geom_boxplot<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    geom_jitter<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> Replicate<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> position <span class="hljs-operator">=</span> position_jitter<span class="hljs-punctuation">(</span><span class="hljs-number">0.15</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    scale_fill_viridis<span class="hljs-punctuation">(</span>discrete <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> begin <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> end <span class="hljs-operator">=</span> <span class="hljs-number">0.9</span><span class="hljs-punctuation">,</span> option <span class="hljs-operator">=</span> <span class="hljs-string">&quot;magma&quot;</span><span class="hljs-punctuation">,</span> alpha <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    scale_color_viridis<span class="hljs-punctuation">(</span>discrete <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> begin <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> end <span class="hljs-operator">=</span> <span class="hljs-number">0.9</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">20</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    ylab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Spike-in Scalling Factor&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    xlab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><br><br>normDepth <span class="hljs-operator">=</span> inner_join<span class="hljs-punctuation">(</span>scaleFactor<span class="hljs-punctuation">,</span> alignResult<span class="hljs-punctuation">,</span> by <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Histone&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Replicate&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> mutate<span class="hljs-punctuation">(</span>normDepth <span class="hljs-operator">=</span> MappedFragNum_hg38 <span class="hljs-operator">*</span> scaleFactor<span class="hljs-punctuation">)</span><br><br>fig6B <span class="hljs-operator">=</span> normDepth <span class="hljs-operator">%&gt;%</span> ggplot<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> Histone<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> normDepth<span class="hljs-punctuation">,</span> fill <span class="hljs-operator">=</span> Histone<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    geom_boxplot<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    geom_jitter<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> Replicate<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> position <span class="hljs-operator">=</span> position_jitter<span class="hljs-punctuation">(</span><span class="hljs-number">0.15</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    scale_fill_viridis<span class="hljs-punctuation">(</span>discrete <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> begin <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> end <span class="hljs-operator">=</span> <span class="hljs-number">0.9</span><span class="hljs-punctuation">,</span> option <span class="hljs-operator">=</span> <span class="hljs-string">&quot;magma&quot;</span><span class="hljs-punctuation">,</span> alpha <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    scale_color_viridis<span class="hljs-punctuation">(</span>discrete <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> begin <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> end <span class="hljs-operator">=</span> <span class="hljs-number">0.9</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">20</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    ylab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Normalization Fragment Count&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>    xlab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>    coord_cartesian<span class="hljs-punctuation">(</span>ylim <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1000000</span><span class="hljs-punctuation">,</span> <span class="hljs-number">130000000</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>ggarrange<span class="hljs-punctuation">(</span>fig6A<span class="hljs-punctuation">,</span> fig6B<span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> common.legend <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> legend<span class="hljs-operator">=</span><span class="hljs-string">&quot;bottom&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="/GeekFocus/2022-03-21-CUTTag/6.png"><br><img src="/GeekFocus/img/2022-03-21-CUTTag/6.png"></p><hr><h1 id="VI-Peak-calling"><a href="#VI-Peak-calling" class="headerlink" title="VI. Peak calling"></a>VI. Peak calling</h1><h2 id="6-1-SEACR"><a href="#6-1-SEACR" class="headerlink" title="6.1. SEACR"></a>6.1. SEACR</h2><p>The Sparse Enrichment Analysis for CUT&amp;RUN, <a href="https://github.com/FredHutch/SEACR/">SEACR</a>, package is designed to call peaks and enriched regions from chromatin profiling data <strong>with very low backgrounds</strong> (i.e., regions with no read coverage) that are <strong>typical for CUT&amp;Tag</strong> chromatin profiling experiments. SEACR requires <strong>bedGraph files from paired-end sequencing as input</strong> and defines <strong>peaks</strong> as <strong>contiguous blocks of basepair coverage</strong> that <strong>do not overlap</strong> with <strong>blocks of background signal delineated in the IgG</strong> control dataset. SEACR is effective for calling <strong>both</strong> <strong>narrow</strong> peaks from <strong>factor binding sites</strong> and <strong>broad</strong> domains characteristic of some <strong>histone</strong> modifications. The description of the method is published at <a href="https://epigeneticsandchromatin.biomedcentral.com/articles/10.1186/s13072-019-0287-4">Meers et al. 2019</a>, and the userâ€™s manual is available on <a href="https://github.com/FredHutch/SEACR/">github</a>. Since we have normalized fragment counts with the E. coli read count, we set the normalization option of SEACR to â€œnonâ€. <strong>Otherwise</strong>, the â€œ<strong>norm</strong>â€ is <strong>recommended</strong>.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">##== linux command ==##</span><br>seacr=<span class="hljs-string">&quot;/fh/fast/gottardo_r/yezheng_working/Software/SEACR/SEACR_1.3.sh&quot;</span><br>histControl=<span class="hljs-variable">$2</span><br><span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$projPath</span>/peakCalling/SEACR<br><br>bash <span class="hljs-variable">$seacr</span> <span class="hljs-variable">$projPath</span>/alignment/bedgraph/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.fragments.normalized.bedgraph \<br>     <span class="hljs-variable">$projPath</span>/alignment/bedgraph/<span class="hljs-variable">$&#123;histControl&#125;</span>_bowtie2.fragments.normalized.bedgraph \<br>     non stringent <span class="hljs-variable">$projPath</span>/peakCalling/SEACR/<span class="hljs-variable">$&#123;histName&#125;</span>_seacr_control.peaks<br><br>bash <span class="hljs-variable">$seacr</span> <span class="hljs-variable">$projPath</span>/alignment/bedgraph/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.fragments.normalized.bedgraph 0.01 non stringent <span class="hljs-variable">$projPath</span>/peakCalling/SEACR/<span class="hljs-variable">$&#123;histName&#125;</span>_seacr_top0.01.peaks<br></code></pre></td></tr></table></figure><h3 id="6-1-1-Number-of-peaks-called"><a href="#6-1-1-Number-of-peaks-called" class="headerlink" title="6.1.1 Number of peaks called"></a>6.1.1 Number of peaks called</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">##=== R command ===## </span><br>peakN <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>peakWidth <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>peakType <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;control&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;top0.01&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-keyword">for</span><span class="hljs-punctuation">(</span>hist <span class="hljs-keyword">in</span> sampleList<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  histInfo <span class="hljs-operator">=</span> strsplit<span class="hljs-punctuation">(</span>hist<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br>  <span class="hljs-keyword">if</span><span class="hljs-punctuation">(</span>histInfo<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">!=</span> <span class="hljs-string">&quot;IgG&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-keyword">for</span><span class="hljs-punctuation">(</span>type <span class="hljs-keyword">in</span> peakType<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>      peakInfo <span class="hljs-operator">=</span> read.table<span class="hljs-punctuation">(</span>paste0<span class="hljs-punctuation">(</span>projPath<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;/peakCalling/SEACR/&quot;</span><span class="hljs-punctuation">,</span> hist<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_seacr_&quot;</span><span class="hljs-punctuation">,</span> type<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;.peaks.stringent.bed&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> header <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> fill <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span>  <span class="hljs-operator">%&gt;%</span> mutate<span class="hljs-punctuation">(</span>width <span class="hljs-operator">=</span> <span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span>V3<span class="hljs-operator">-</span>V2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>      peakN <span class="hljs-operator">=</span> data.frame<span class="hljs-punctuation">(</span>peakN <span class="hljs-operator">=</span> nrow<span class="hljs-punctuation">(</span>peakInfo<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> peakType <span class="hljs-operator">=</span> type<span class="hljs-punctuation">,</span> Histone <span class="hljs-operator">=</span> histInfo<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> Replicate <span class="hljs-operator">=</span> histInfo<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> rbind<span class="hljs-punctuation">(</span>peakN<span class="hljs-punctuation">,</span> .<span class="hljs-punctuation">)</span><br>      peakWidth <span class="hljs-operator">=</span> data.frame<span class="hljs-punctuation">(</span>width <span class="hljs-operator">=</span> peakInfo<span class="hljs-operator">$</span>width<span class="hljs-punctuation">,</span> peakType <span class="hljs-operator">=</span> type<span class="hljs-punctuation">,</span> Histone <span class="hljs-operator">=</span> histInfo<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> Replicate <span class="hljs-operator">=</span> histInfo<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span>  <span class="hljs-operator">%&gt;%</span> rbind<span class="hljs-punctuation">(</span>peakWidth<span class="hljs-punctuation">,</span> .<span class="hljs-punctuation">)</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br>peakN <span class="hljs-operator">%&gt;%</span> select<span class="hljs-punctuation">(</span>Histone<span class="hljs-punctuation">,</span> Replicate<span class="hljs-punctuation">,</span> peakType<span class="hljs-punctuation">,</span> peakN<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><table><thead><tr><th align="left">Histone<chr></th><th align="left">Replicate<chr></th><th align="left">peakType<chr></th><th align="right">peakN<int></th></tr></thead><tbody><tr><td align="left">K27me3</td><td align="left">rep1</td><td align="left">control</td><td align="right">144906</td></tr><tr><td align="left">K27me3</td><td align="left">rep1</td><td align="left">top0.01</td><td align="right">5829</td></tr><tr><td align="left">K27me3</td><td align="left">rep2</td><td align="left">control</td><td align="right">74444</td></tr><tr><td align="left">K27me3</td><td align="left">rep2</td><td align="left">top0.01</td><td align="right">9642</td></tr><tr><td align="left">K4me3</td><td align="left">rep1</td><td align="left">control</td><td align="right">8709</td></tr><tr><td align="left">K4me3</td><td align="left">rep1</td><td align="left">top0.01</td><td align="right">878</td></tr></tbody></table><h3 id="6-1-2-Reproducibility-of-the-peak-across-biological-replicates"><a href="#6-1-2-Reproducibility-of-the-peak-across-biological-replicates" class="headerlink" title="6.1.2 Reproducibility of the peak across biological replicates"></a>6.1.2 Reproducibility of the peak across biological replicates</h3><p>Peak calling on replicate datasets is compared to define reproducible peaks. The top 1% of peaks (ranked by total signal in each block) are selected as high-confidence sites.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">##=== R command ===## </span><br>histL <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;K27me3&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;K4me3&quot;</span><span class="hljs-punctuation">)</span><br>repL <span class="hljs-operator">=</span> paste0<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;rep&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><br>peakType <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;control&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;top0.01&quot;</span><span class="hljs-punctuation">)</span><br>peakOverlap <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-keyword">for</span><span class="hljs-punctuation">(</span>type <span class="hljs-keyword">in</span> peakType<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-keyword">for</span><span class="hljs-punctuation">(</span>hist <span class="hljs-keyword">in</span> histL<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>    overlap.gr <span class="hljs-operator">=</span> GRanges<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>    <span class="hljs-keyword">for</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">rep</span> <span class="hljs-keyword">in</span> repL<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>      peakInfo <span class="hljs-operator">=</span> read.table<span class="hljs-punctuation">(</span>paste0<span class="hljs-punctuation">(</span>projPath<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;/peakCalling/SEACR/&quot;</span><span class="hljs-punctuation">,</span> hist<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_seacr_&quot;</span><span class="hljs-punctuation">,</span> type<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;.peaks.stringent.bed&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> header <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> fill <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>      peakInfo.gr <span class="hljs-operator">=</span> GRanges<span class="hljs-punctuation">(</span>peakInfo<span class="hljs-operator">$</span>V1<span class="hljs-punctuation">,</span> IRanges<span class="hljs-punctuation">(</span>start <span class="hljs-operator">=</span> peakInfo<span class="hljs-operator">$</span>V2<span class="hljs-punctuation">,</span> end <span class="hljs-operator">=</span> peakInfo<span class="hljs-operator">$</span>V3<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> strand <span class="hljs-operator">=</span> <span class="hljs-string">&quot;*&quot;</span><span class="hljs-punctuation">)</span><br>      <span class="hljs-keyword">if</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>overlap.gr<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>        overlap.gr <span class="hljs-operator">=</span> overlap.gr<span class="hljs-punctuation">[</span>findOverlaps<span class="hljs-punctuation">(</span>overlap.gr<span class="hljs-punctuation">,</span> peakInfo.gr<span class="hljs-punctuation">)</span><span class="hljs-operator">@</span>from<span class="hljs-punctuation">]</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-keyword">else</span><span class="hljs-punctuation">&#123;</span><br>        overlap.gr <span class="hljs-operator">=</span> peakInfo.gr<br>        <br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>    peakOverlap <span class="hljs-operator">=</span> data.frame<span class="hljs-punctuation">(</span>peakReprod <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>overlap.gr<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> Histone <span class="hljs-operator">=</span> hist<span class="hljs-punctuation">,</span> peakType <span class="hljs-operator">=</span> type<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> rbind<span class="hljs-punctuation">(</span>peakOverlap<span class="hljs-punctuation">,</span> .<span class="hljs-punctuation">)</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br>peakReprod <span class="hljs-operator">=</span> left_join<span class="hljs-punctuation">(</span>peakN<span class="hljs-punctuation">,</span> peakOverlap<span class="hljs-punctuation">,</span> by <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Histone&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;peakType&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> mutate<span class="hljs-punctuation">(</span>peakReprodRate <span class="hljs-operator">=</span> peakReprod<span class="hljs-operator">/</span>peakN <span class="hljs-operator">*</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span><br>peakReprod <span class="hljs-operator">%&gt;%</span> select<span class="hljs-punctuation">(</span>Histone<span class="hljs-punctuation">,</span> Replicate<span class="hljs-punctuation">,</span> peakType<span class="hljs-punctuation">,</span> peakN<span class="hljs-punctuation">,</span> peakReprodNum <span class="hljs-operator">=</span> peakReprod<span class="hljs-punctuation">,</span> peakReprodRate<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><table><thead><tr><th align="left">Histone<chr></th><th align="left">Replicate<chr></th><th align="left">peakType<chr></th><th align="right">peakN<int></th><th align="right">peakReprodNum<int></th><th align="right">peakReprodRate<dbl></th></tr></thead><tbody><tr><td align="left">K27me3</td><td align="left">rep1</td><td align="left">control</td><td align="right">144906</td><td align="right">71692</td><td align="right">49.47483</td></tr><tr><td align="left">K27me3</td><td align="left">rep1</td><td align="left">top0.01</td><td align="right">5829</td><td align="right">5314</td><td align="right">91.16487</td></tr><tr><td align="left">K27me3</td><td align="left">rep2</td><td align="left">control</td><td align="right">74444</td><td align="right">71692</td><td align="right">96.30326</td></tr><tr><td align="left">K27me3</td><td align="left">rep2</td><td align="left">top0.01</td><td align="right">9642</td><td align="right">5314</td><td align="right">55.11305</td></tr></tbody></table><p>The reproducibility is calculated by</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean">`# peaks overlapping rep1 and rep2/# peaks <span class="hljs-keyword">of</span> rep1 or rep2 * <span class="hljs-number">100</span><br></code></pre></td></tr></table></figure><p>Therefore, it is sensitive to the total number of peaks called in each replicate.</p><h3 id="6-1-3-FRagment-proportion-in-Peaks-regions-FRiPs"><a href="#6-1-3-FRagment-proportion-in-Peaks-regions-FRiPs" class="headerlink" title="6.1.3 FRagment proportion in Peaks regions (FRiPs)."></a>6.1.3 FRagment proportion in Peaks regions (FRiPs).</h3><p>We calculate the fraction of reads in peaks (FRiPs) as a measure of signal-to-noise, and contrast it to FRiPs in the IgG control dataset for illustration. Although sequencing depths for CUT&amp;Tag are typically only 1-5 million reads, the low background of the method results in high FRiP scores.</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">##=== R command ===## <br>library(chromVAR)<br><br>bamDir = paste0(projPath, <span class="hljs-string">&quot;/alignment/bam&quot;</span>)<br>inPeakData = c<span class="hljs-literal">()</span><br>## overlap <span class="hljs-keyword">with</span> bam file <span class="hljs-keyword">to</span> get count<br><span class="hljs-keyword">for</span>(hist <span class="hljs-keyword">in</span> histL)&#123;<br>  <span class="hljs-keyword">for</span>(rep <span class="hljs-keyword">in</span> repL)&#123;<br>    peakRes = read.table(paste0(projPath, <span class="hljs-string">&quot;/peakCalling/SEACR/&quot;</span>, hist, <span class="hljs-string">&quot;_&quot;</span>, rep, <span class="hljs-string">&quot;_seacr_control.peaks.stringent.bed&quot;</span>), header = FALSE, fill = TRUE)<br>    peak.gr = <span class="hljs-constructor">GRanges(<span class="hljs-params">seqnames</span> = <span class="hljs-params">peakRes$V1</span>, IRanges(<span class="hljs-params">start</span> = <span class="hljs-params">peakRes$V2</span>, <span class="hljs-params">end</span> = <span class="hljs-params">peakRes$V3</span>)</span>, strand = <span class="hljs-string">&quot;*&quot;</span>)<br>    bamFile = paste0(bamDir, <span class="hljs-string">&quot;/&quot;</span>, hist, <span class="hljs-string">&quot;_&quot;</span>, rep, <span class="hljs-string">&quot;_bowtie2.mapped.bam&quot;</span>)<br>    fragment_counts &lt;- get<span class="hljs-constructor">Counts(<span class="hljs-params">bamFile</span>, <span class="hljs-params">peak</span>.<span class="hljs-params">gr</span>, <span class="hljs-params">paired</span> = TRUE, <span class="hljs-params">by_rg</span> = FALSE, <span class="hljs-params">format</span> = <span class="hljs-string">&quot;bam&quot;</span>)</span><br>    inPeakN = counts(fragment_counts)<span class="hljs-literal">[,<span class="hljs-number">1</span>]</span> %&gt;% sum<br>    inPeakData = rbind(inPeakData, data.frame(inPeakN = inPeakN, Histone = hist, Replicate = rep))<br>  &#125;<br>&#125;<br><br>frip = left<span class="hljs-constructor">_join(<span class="hljs-params">inPeakData</span>, <span class="hljs-params">alignResult</span>, <span class="hljs-params">by</span> = <span class="hljs-params">c</span>(<span class="hljs-string">&quot;Histone&quot;</span>, <span class="hljs-string">&quot;Replicate&quot;</span>)</span>) %&gt;% mutate(frip = inPeakN/MappedFragNum_hg38<span class="hljs-operator"> * </span><span class="hljs-number">100</span>)<br>frip %&gt;% select(Histone, Replicate, SequencingDepth, MappedFragNum_hg38, AlignmentRate_hg38, FragInPeakNum = inPeakN, FRiPs = frip)<br></code></pre></td></tr></table></figure><table><thead><tr><th align="left">Histone<chr></th><th align="left">Replicate<chr></th><th align="right">SequencingDepth<dbl></th><th align="right">MappedFragNum_hg38<dbl></th><th align="right">AlignmentRate_hg38<dbl></th><th align="right">FragInPeakNum<dbl></th><th align="left"><strong>FRiPs</strong></th></tr></thead><tbody><tr><td align="left">K27me3</td><td align="left">rep1</td><td align="right">2984630</td><td align="right">2859520</td><td align="right">95.81</td><td align="right">2223813</td><td align="left">77.76875</td></tr><tr><td align="left">K27me3</td><td align="left">Rep2</td><td align="right"></td><td align="right"></td><td align="right"></td><td align="right"></td><td align="left">40.68507</td></tr><tr><td align="left">K4me3</td><td align="left">rep1</td><td align="right"></td><td align="right"></td><td align="right"></td><td align="right"></td><td align="left">91.60169</td></tr><tr><td align="left">K4me3</td><td align="left">Rep2</td><td align="right"></td><td align="right"></td><td align="right"></td><td align="right"></td><td align="left">71.46116</td></tr></tbody></table><h3 id="6-1-4-Visualization-of-peak-number-peak-width-peak-reproducibility-and-FRiPs"><a href="#6-1-4-Visualization-of-peak-number-peak-width-peak-reproducibility-and-FRiPs" class="headerlink" title="6.1.4 Visualization of peak number, peak width, peak reproducibility and FRiPs."></a>6.1.4 Visualization of peak number, peak width, peak reproducibility and FRiPs.</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs sh">fig7A = peakN %&gt;% ggplot(aes(x = Histone, y = peakN, fill = Histone)) +<br>    geom_boxplot() +<br>    geom_jitter(aes(color = Replicate), position = position_jitter(0.15)) +<br>    facet_grid(~peakType) +<br>    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = <span class="hljs-string">&quot;magma&quot;</span>, alpha = 0.8) +<br>    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<br>    theme_bw(base_size = 18) +<br>    ylab(<span class="hljs-string">&quot;Number of Peaks&quot;</span>) +<br>    xlab(<span class="hljs-string">&quot;&quot;</span>)<br><br>fig7B = peakWidth %&gt;% ggplot(aes(x = Histone, y = width, fill = Histone)) +<br>    geom_violin() +<br>    facet_grid(Replicate~peakType) +<br>    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = <span class="hljs-string">&quot;magma&quot;</span>, alpha = 0.8) +<br>    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<br>    scale_y_continuous(trans = <span class="hljs-string">&quot;log&quot;</span>, breaks = c(400, 3000, 22000)) +<br>    theme_bw(base_size = 18) +<br>    ylab(<span class="hljs-string">&quot;Width of Peaks&quot;</span>) +<br>    xlab(<span class="hljs-string">&quot;&quot;</span>)<br><br>fig7C = peakReprod %&gt;% ggplot(aes(x = Histone, y = peakReprodRate, fill = Histone, label = round(peakReprodRate, 2))) +<br>    geom_bar(<span class="hljs-built_in">stat</span> = <span class="hljs-string">&quot;identity&quot;</span>) +<br>    geom_text(vjust = 0.1) +<br>    facet_grid(Replicate~peakType) +<br>    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = <span class="hljs-string">&quot;magma&quot;</span>, alpha = 0.8) +<br>    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<br>    theme_bw(base_size = 18) +<br>    ylab(<span class="hljs-string">&quot;% of Peaks Reproduced&quot;</span>) +<br>    xlab(<span class="hljs-string">&quot;&quot;</span>)<br><br>fig7D = frip %&gt;% ggplot(aes(x = Histone, y = frip, fill = Histone, label = round(frip, 2))) +<br>    geom_boxplot() +<br>    geom_jitter(aes(color = Replicate), position = position_jitter(0.15)) +<br>    scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = <span class="hljs-string">&quot;magma&quot;</span>, alpha = 0.8) +<br>    scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +<br>    theme_bw(base_size = 18) +<br>    ylab(<span class="hljs-string">&quot;% of Fragments in Peaks&quot;</span>) +<br>    xlab(<span class="hljs-string">&quot;&quot;</span>)<br><br>ggarrange(fig7A, fig7B, fig7C, fig7D, ncol = 2, nrow=2, common.legend = TRUE, legend=<span class="hljs-string">&quot;bottom&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="/GeekFocus/2022-03-21-CUTTag/7.png" alt="7"><br><img src="/GeekFocus/img/2022-03-21-CUTTag/7.png" alt="7"></p><hr><h1 id="VII-Visualization"><a href="#VII-Visualization" class="headerlink" title="VII. Visualization"></a>VII. Visualization</h1><p>Typically we are interested in visualizing a chromatin landscape in regions using a genome browser. The <a href="http://software.broadinstitute.org/software/igv/home">Integrative Genomic Viewer</a> provides a web app version and a local desktop version that are easy to use. The <a href="https://genome.ucsc.edu/">UCSC Genome Browser</a> provides the most comprehensive supplementary genome information.</p><h2 id="7-1-Browser-display-of-normalized-bedgraph-files"><a href="#7-1-Browser-display-of-normalized-bedgraph-files" class="headerlink" title="7.1. Browser display of normalized bedgraph files."></a>7.1. Browser display of normalized bedgraph files.</h2><p><img src="/GeekFocus/2022-03-21-CUTTag/8.png"><br><img src="/GeekFocus/img/2022-03-21-CUTTag/8.png"></p><h2 id="7-2-Heatmap-visualization-on-specific-regions"><a href="#7-2-Heatmap-visualization-on-specific-regions" class="headerlink" title="7.2. Heatmap visualization on specific regions"></a>7.2. Heatmap visualization on specific regions</h2><p>We are also interested in looking at chromatin features at a list of annotated sites, for example histone modification signal at gene promoters.We will use the <code>computeMatrix</code> and <code>plotHeatmap</code> functions from <a href="https://deeptools.readthedocs.io/en/develop/">deepTools</a> to generate the heatmap.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">##== linux command ==##</span><br><span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$projPath</span>/alignment/bigwig                                                                                                                                        <br>samtools <span class="hljs-built_in">sort</span> -o <span class="hljs-variable">$projPath</span>/alignment/bam/<span class="hljs-variable">$&#123;histName&#125;</span>.sorted.bam <span class="hljs-variable">$projPath</span>/alignment/bam/<span class="hljs-variable">$&#123;histName&#125;</span>_bowtie2.mapped.bam                                                     <br>samtools index <span class="hljs-variable">$projPath</span>/alignment/bam/<span class="hljs-variable">$&#123;histName&#125;</span>.sorted.bam                                                                                                              <br>bamCoverage -b <span class="hljs-variable">$projPath</span>/alignment/bam/<span class="hljs-variable">$&#123;histName&#125;</span>.sorted.bam -o <span class="hljs-variable">$projPath</span>/alignment/bigwig/<span class="hljs-variable">$&#123;histName&#125;</span>_raw.bw         <br></code></pre></td></tr></table></figure><h3 id="7-2-1-Heatmap-over-transcription-units"><a href="#7-2-1-Heatmap-over-transcription-units" class="headerlink" title="7.2.1 Heatmap over transcription units"></a>7.2.1 Heatmap over transcription units</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">##== linux command ==##</span><br>cores=8<br>computeMatrix scale-regions -S <span class="hljs-variable">$projPath</span>/alignment/bigwig/K27me3_rep1_raw.bw \<br>                               <span class="hljs-variable">$projPath</span>/alignment/bigwig/K27me3_rep2_raw.bw \<br>                               <span class="hljs-variable">$projPath</span>/alignment/bigwig/K4me3_rep1_raw.bw \<br>                               <span class="hljs-variable">$projPath</span>/alignment/bigwig/K4me3_rep2_raw.bw \<br>                              -R <span class="hljs-variable">$projPath</span>/data/hg38_gene/hg38_gene.tsv \<br>                              --beforeRegionStartLength 3000 \<br>                              --regionBodyLength 5000 \<br>                              --afterRegionStartLength 3000 \<br>                              --skipZeros -o <span class="hljs-variable">$projPath</span>/data/hg38_gene/matrix_gene.mat.gz -p <span class="hljs-variable">$cores</span><br><br>plotHeatmap -m <span class="hljs-variable">$projPath</span>/data/hg38_gene/matrix_gene.mat.gz -out <span class="hljs-variable">$projPath</span>/data/hg38_gene/Histone_gene.png --sortUsing <span class="hljs-built_in">sum</span><br></code></pre></td></tr></table></figure><p><img src="/GeekFocus/2022-03-21-CUTTag/9.png"><br><img src="/GeekFocus/img/2022-03-21-CUTTag/9.png"></p><h3 id="7-2-2-Heatmap-on-CUT-amp-Tag-peaks"><a href="#7-2-2-Heatmap-on-CUT-amp-Tag-peaks" class="headerlink" title="7.2.2. Heatmap on CUT&amp;Tag peaks"></a>7.2.2. Heatmap on CUT&amp;Tag peaks</h3><p>We use the midpoint of the signal block returned from SEACR to align signals in heatmaps. The sixth column of the SEACR output is an entry in the form chr:start-end that represents the first and ending bases of the region with the maximum signal of the region. We first generate a new bed file containing this midpoint information in column 6 and use deeptools for the heatmap visualization.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#== linux command ==##</span><br>awk <span class="hljs-string">&#x27;&#123;split($6, summit, &quot;:&quot;); split(summit[2], region, &quot;-&quot;); print summit[1]&quot;\t&quot;region[1]&quot;\t&quot;region[2]&#125;&#x27;</span> <span class="hljs-variable">$projPath</span>/peakCalling/SEACR/<span class="hljs-variable">$&#123;histName&#125;</span>_<span class="hljs-variable">$&#123;repName&#125;</span>_seacr_control.pe\<br>aks.stringent.bed &gt;<span class="hljs-variable">$projPath</span>/peakCalling/SEACR/<span class="hljs-variable">$&#123;histName&#125;</span>_<span class="hljs-variable">$&#123;repName&#125;</span>_seacr_control.peaks.summitRegion.bed<br><br>computeMatrix reference-point -S <span class="hljs-variable">$projPath</span>/alignment/bigwig/<span class="hljs-variable">$&#123;histName&#125;</span>_<span class="hljs-variable">$&#123;repName&#125;</span>_raw.bw \<br>              -R <span class="hljs-variable">$projPath</span>/peakCalling/SEACR/<span class="hljs-variable">$&#123;histName&#125;</span>_<span class="hljs-variable">$&#123;repName&#125;</span>_seacr_control.peaks.summitRegion.bed \<br>              --skipZeros -o <span class="hljs-variable">$projPath</span>/peakCalling/SEACR/<span class="hljs-variable">$&#123;histName&#125;</span>_<span class="hljs-variable">$&#123;repName&#125;</span>_SEACR.mat.gz -p <span class="hljs-variable">$cores</span> -a 3000 -b 3000 --referencePoint center<br><br>plotHeatmap -m <span class="hljs-variable">$projPath</span>/peakCalling/SEACR/<span class="hljs-variable">$&#123;histName&#125;</span>_SEACR.mat.gz -out <span class="hljs-variable">$projPath</span>/peakCalling/SEACR/<span class="hljs-variable">$&#123;histName&#125;</span>_SEACR_heatmap.png --sortUsing <span class="hljs-built_in">sum</span> --startLabel <span class="hljs-string">&quot;Peak Start&quot;</span> -\<br>-endLabel <span class="hljs-string">&quot;Peak End&quot;</span> --xAxisLabel <span class="hljs-string">&quot;&quot;</span> --regionsLabel <span class="hljs-string">&quot;Peaks&quot;</span> --samplesLabel <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;histName&#125;</span> <span class="hljs-variable">$&#123;repName&#125;</span>&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/GeekFocus/2022-03-21-CUTTag/10.png"><br><img src="/GeekFocus/img/2022-03-21-CUTTag/10.png"></p><hr><h1 id="VIII-Differention-analysis"><a href="#VIII-Differention-analysis" class="headerlink" title="VIII. Differention analysis"></a>VIII. Differention analysis</h1><ul><li>DESeq2: <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-014-0550-8">Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</a></li></ul><p>Estimate variance-mean dependence in count data from high-throughput sequencing assays and test for differential expression based on a model using the negative binomial distribution.</p><h2 id="8-1-Create-the-peak-x-sample-matrix"><a href="#8-1-Create-the-peak-x-sample-matrix" class="headerlink" title="8.1. Create the peak x sample matrix."></a>8.1. Create the peak x sample matrix.</h2><p>Usually, the differential tests compare two or more conditions of the same histone modification. In this tutorial, limited by the demonstration data, we will illustrate the differential detection by comparing two replicates of H3K27me3 and two replicates of H3K4me3. We will use DESeq2 (<a href="http://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#why-un-normalized-counts">complete tutorial</a>) as illustration.</p><h3 id="8-1-1-Create-a-master-peak-list-merging-all-the-peaks-called-for-each-sample"><a href="#8-1-1-Create-a-master-peak-list-merging-all-the-peaks-called-for-each-sample" class="headerlink" title="8.1.1 Create a master peak list merging all the peaks called for each sample."></a>8.1.1 Create a master peak list merging all the peaks called for each sample.</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">##=== R command ===## </span><br>mPeak = GRanges()<br><span class="hljs-comment">## overlap with bam file to get count</span><br><span class="hljs-keyword">for</span>(hist <span class="hljs-keyword">in</span> histL)&#123;<br>  <span class="hljs-keyword">for</span>(rep <span class="hljs-keyword">in</span> repL)&#123;<br>    peakRes = read.table(paste0(projPath, <span class="hljs-string">&quot;/peakCalling/SEACR/&quot;</span>, hist, <span class="hljs-string">&quot;_&quot;</span>, rep, <span class="hljs-string">&quot;_seacr_control.peaks.stringent.bed&quot;</span>), header = FALSE, fill = TRUE)<br>    mPeak = GRanges(seqnames = peakRes<span class="hljs-variable">$V1</span>, IRanges(start = peakRes<span class="hljs-variable">$V2</span>, end = peakRes<span class="hljs-variable">$V3</span>), strand = <span class="hljs-string">&quot;*&quot;</span>) %&gt;% append(mPeak, .)<br>  &#125;<br>&#125;<br>masterPeak = reduce(mPeak)<br></code></pre></td></tr></table></figure><h3 id="8-1-2-Get-the-fragment-counts-for-each-peak-in-the-master-peak-list"><a href="#8-1-2-Get-the-fragment-counts-for-each-peak-in-the-master-peak-list" class="headerlink" title="8.1.2 Get the fragment counts for each peak in the master peak list."></a>8.1.2 Get the fragment counts for each peak in the master peak list.</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">##=== R command ===## </span><br>library<span class="hljs-punctuation">(</span>DESeq2<span class="hljs-punctuation">)</span><br>bamDir <span class="hljs-operator">=</span> paste0<span class="hljs-punctuation">(</span>projPath<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;/alignment/bam&quot;</span><span class="hljs-punctuation">)</span><br>countMat <span class="hljs-operator">=</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-literal">NA</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>masterPeak<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>histL<span class="hljs-punctuation">)</span><span class="hljs-operator">*</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>repL<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment">## overlap with bam file to get count</span><br>i <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span><span class="hljs-punctuation">(</span>hist <span class="hljs-keyword">in</span> histL<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-keyword">for</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">rep</span> <span class="hljs-keyword">in</span> repL<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>    <br>    bamFile <span class="hljs-operator">=</span> paste0<span class="hljs-punctuation">(</span>bamDir<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;/&quot;</span><span class="hljs-punctuation">,</span> hist<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_bowtie2.mapped.bam&quot;</span><span class="hljs-punctuation">)</span><br>    fragment_counts <span class="hljs-operator">&lt;-</span> getCounts<span class="hljs-punctuation">(</span>bamFile<span class="hljs-punctuation">,</span> masterPeak<span class="hljs-punctuation">,</span> paired <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> by_rg <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> format <span class="hljs-operator">=</span> <span class="hljs-string">&quot;bam&quot;</span><span class="hljs-punctuation">)</span><br>    countMat<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> i<span class="hljs-punctuation">]</span> <span class="hljs-operator">=</span> counts<span class="hljs-punctuation">(</span>fragment_counts<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>    i <span class="hljs-operator">=</span> i <span class="hljs-operator">+</span> <span class="hljs-number">1</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br>colnames<span class="hljs-punctuation">(</span>countMat<span class="hljs-punctuation">)</span> <span class="hljs-operator">=</span> paste<span class="hljs-punctuation">(</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span>histL<span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span>repL<span class="hljs-punctuation">,</span> each <span class="hljs-operator">=</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><h2 id="8-2-Sequencing-depth-normalization-and-differential-enriched-peaks-detection"><a href="#8-2-Sequencing-depth-normalization-and-differential-enriched-peaks-detection" class="headerlink" title="8.2. Sequencing depth normalization and differential enriched peaks detection"></a>8.2. Sequencing depth normalization and differential enriched peaks detection</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">##=== R command ===## </span><br>selectR <span class="hljs-operator">=</span> which<span class="hljs-punctuation">(</span>rowSums<span class="hljs-punctuation">(</span>countMat<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span><span class="hljs-punctuation">)</span> <span class="hljs-comment">## remove low count genes</span><br>dataS <span class="hljs-operator">=</span> countMat<span class="hljs-punctuation">[</span>selectR<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>condition <span class="hljs-operator">=</span> factor<span class="hljs-punctuation">(</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span>histL<span class="hljs-punctuation">,</span> each <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>repL<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>dds <span class="hljs-operator">=</span> DESeqDataSetFromMatrix<span class="hljs-punctuation">(</span>countData <span class="hljs-operator">=</span> dataS<span class="hljs-punctuation">,</span><br>                              colData <span class="hljs-operator">=</span> DataFrame<span class="hljs-punctuation">(</span>condition<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                              design <span class="hljs-operator">=</span> <span class="hljs-operator">~</span> condition<span class="hljs-punctuation">)</span><br>DDS <span class="hljs-operator">=</span> DESeq<span class="hljs-punctuation">(</span>dds<span class="hljs-punctuation">)</span><br>normDDS <span class="hljs-operator">=</span> counts<span class="hljs-punctuation">(</span>DDS<span class="hljs-punctuation">,</span> normalized <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span> <span class="hljs-comment">## normalization with respect to the sequencing depth</span><br>colnames<span class="hljs-punctuation">(</span>normDDS<span class="hljs-punctuation">)</span> <span class="hljs-operator">=</span> paste0<span class="hljs-punctuation">(</span>colnames<span class="hljs-punctuation">(</span>normDDS<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;_norm&quot;</span><span class="hljs-punctuation">)</span><br>res <span class="hljs-operator">=</span> results<span class="hljs-punctuation">(</span>DDS<span class="hljs-punctuation">,</span> independentFiltering <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> altHypothesis <span class="hljs-operator">=</span> <span class="hljs-string">&quot;greaterAbs&quot;</span><span class="hljs-punctuation">)</span><br><br>countMatDiff <span class="hljs-operator">=</span> cbind<span class="hljs-punctuation">(</span>dataS<span class="hljs-punctuation">,</span> normDDS<span class="hljs-punctuation">,</span> res<span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>countMatDiff<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs r">DataFrame with <span class="hljs-number">6</span> rows and <span class="hljs-number">14</span> columns<br>  K27me3_rep1 K4me3_rep1 K27me3_rep2 K4me3_rep2 K27me3_rep1_norm<br>    <span class="hljs-operator">&lt;</span>numeric<span class="hljs-operator">&gt;</span>  <span class="hljs-operator">&lt;</span>numeric<span class="hljs-operator">&gt;</span>   <span class="hljs-operator">&lt;</span>numeric<span class="hljs-operator">&gt;</span>  <span class="hljs-operator">&lt;</span>numeric<span class="hljs-operator">&gt;</span>        <span class="hljs-operator">&lt;</span>numeric<span class="hljs-operator">&gt;</span><br><span class="hljs-number">1</span>           <span class="hljs-number">6</span>          <span class="hljs-number">2</span>           <span class="hljs-number">1</span>          <span class="hljs-number">6</span>         <span class="hljs-number">1.408657</span><br><span class="hljs-number">2</span>           <span class="hljs-number">1</span>          <span class="hljs-number">0</span>         <span class="hljs-number">242</span>        <span class="hljs-number">182</span>         <span class="hljs-number">0.234776</span><br><span class="hljs-number">3</span>           <span class="hljs-number">0</span>          <span class="hljs-number">0</span>         <span class="hljs-number">176</span>         <span class="hljs-number">88</span>         <span class="hljs-number">0.000000</span><br><span class="hljs-number">4</span>           <span class="hljs-number">0</span>          <span class="hljs-number">0</span>         <span class="hljs-number">274</span>        <span class="hljs-number">194</span>         <span class="hljs-number">0.000000</span><br><span class="hljs-number">5</span>           <span class="hljs-number">3</span>          <span class="hljs-number">4</span>           <span class="hljs-number">0</span>          <span class="hljs-number">1</span>         <span class="hljs-number">0.704328</span><br><span class="hljs-number">6</span>           <span class="hljs-number">0</span>          <span class="hljs-number">1</span>         <span class="hljs-number">109</span>         <span class="hljs-number">59</span>         <span class="hljs-number">0.000000</span><br>  K4me3_rep1_norm K27me3_rep2_norm K4me3_rep2_norm  baseMean log2FoldChange<br>        <span class="hljs-operator">&lt;</span>numeric<span class="hljs-operator">&gt;</span>        <span class="hljs-operator">&lt;</span>numeric<span class="hljs-operator">&gt;</span>       <span class="hljs-operator">&lt;</span>numeric<span class="hljs-operator">&gt;</span> <span class="hljs-operator">&lt;</span>numeric<span class="hljs-operator">&gt;</span>      <span class="hljs-operator">&lt;</span>numeric<span class="hljs-operator">&gt;</span><br><span class="hljs-number">1</span>        <span class="hljs-number">0.620403</span>            <span class="hljs-number">4.170</span>         <span class="hljs-number">18.2724</span>   <span class="hljs-number">6.11787</span>       <span class="hljs-number">3.496854</span><br><span class="hljs-number">2</span>        <span class="hljs-number">0.000000</span>         <span class="hljs-number">1009.141</span>        <span class="hljs-number">554.2634</span> <span class="hljs-number">390.90978</span>      <span class="hljs-number">12.510325</span><br><span class="hljs-number">3</span>        <span class="hljs-number">0.000000</span>          <span class="hljs-number">733.921</span>        <span class="hljs-number">267.9955</span> <span class="hljs-number">250.47905</span>      <span class="hljs-number">13.297304</span><br><span class="hljs-number">4</span>        <span class="hljs-number">0.000000</span>         <span class="hljs-number">1142.581</span>        <span class="hljs-number">590.8082</span> <span class="hljs-number">433.34733</span>      <span class="hljs-number">14.089840</span><br><span class="hljs-number">5</span>        <span class="hljs-number">1.240806</span>            <span class="hljs-number">0.000</span>          <span class="hljs-number">3.0454</span>   <span class="hljs-number">1.24763</span>       <span class="hljs-number">0.846266</span><br><span class="hljs-number">6</span>        <span class="hljs-number">0.310202</span>          <span class="hljs-number">454.530</span>        <span class="hljs-number">179.6788</span> <span class="hljs-number">158.62986</span>      <span class="hljs-number">11.189689</span><br>      lfcSE      stat      pvalue        padj<br>  <span class="hljs-operator">&lt;</span>numeric<span class="hljs-operator">&gt;</span> <span class="hljs-operator">&lt;</span>numeric<span class="hljs-operator">&gt;</span>   <span class="hljs-operator">&lt;</span>numeric<span class="hljs-operator">&gt;</span>   <span class="hljs-operator">&lt;</span>numeric<span class="hljs-operator">&gt;</span><br><span class="hljs-number">1</span>   <span class="hljs-number">1.19893</span>  <span class="hljs-number">2.916635</span> <span class="hljs-number">3.53829e-03</span> <span class="hljs-number">4.22134e-02</span><br><span class="hljs-number">2</span>   <span class="hljs-number">1.50039</span>  <span class="hljs-number">8.338074</span> <span class="hljs-number">7.55102e-17</span> <span class="hljs-number">2.18197e-15</span><br><span class="hljs-number">3</span>   <span class="hljs-number">1.58547</span>  <span class="hljs-number">8.386969</span> <span class="hljs-number">4.98837e-17</span> <span class="hljs-number">1.50548e-15</span><br><span class="hljs-number">4</span>   <span class="hljs-number">1.55196</span>  <span class="hljs-number">9.078730</span> <span class="hljs-number">1.09850e-19</span> <span class="hljs-number">6.73560e-18</span><br><span class="hljs-number">5</span>   <span class="hljs-number">2.18326</span>  <span class="hljs-number">0.387617</span> <span class="hljs-number">6.98300e-01</span> <span class="hljs-number">9.72755e-01</span><br><span class="hljs-number">6</span>   <span class="hljs-number">1.53046</span>  <span class="hljs-number">7.311313</span> <span class="hljs-number">2.64545e-13</span> <span class="hljs-number">4.33546e-12</span><br></code></pre></td></tr></table></figure><ul><li>DESeq2 requires the input matrix should be un-normalized counts or estimated counts of sequencing reads.</li><li>DESeq2 model internally corrects for library size.</li><li><strong>countMatDiff</strong> summarizes the differential analysis results:<ul><li>First 4 columns: raw reads counts after filtering the peak regions with low counts</li><li>Second 4 columns: normalized read counts eliminating library size difference.</li><li>Remaining columns: differential detection results.</li></ul></li></ul><h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Kaya</span>-Okur HS, Wu SJ, Codomo CA, Pledger ES, Bryson TD, Henikoff JG, Ahmad K, Henikoff S: CUT&amp;Tag for efficient epigenomic profiling of small samples and single cells. Nature Communications <span class="hljs-number">2019</span> <span class="hljs-number">10</span>:<span class="hljs-number">1930</span> (PMID:<span class="hljs-number">31036827</span>).<br><br><span class="hljs-attribute">Meers</span>, M.P., Tenenbaum, D. &amp; Henikoff, S. Peak calling by Sparse Enrichment Analysis for CUT&amp;RUN chromatin profiling. Epigenetics &amp; Chromatin <span class="hljs-number">12</span>, <span class="hljs-number">42</span> (<span class="hljs-number">2019</span>). https://doi.org/<span class="hljs-number">10</span>.<span class="hljs-number">1186</span>/s13072-<span class="hljs-number">019</span>-<span class="hljs-number">0287</span>-<span class="hljs-number">4</span><br><br></code></pre></td></tr></table></figure><h1 id="IX-Additional-Alternatives"><a href="#IX-Additional-Alternatives" class="headerlink" title="IX. Additional Alternatives"></a>IX. Additional Alternatives</h1><h2 id="9-1-ChIPseqSpikeInFree-for-normalizing-data-without-spike-in-DNA-Optional"><a href="#9-1-ChIPseqSpikeInFree-for-normalizing-data-without-spike-in-DNA-Optional" class="headerlink" title="9.1 ChIPseqSpikeInFree for normalizing data without spike-in DNA [Optional]"></a>9.1 ChIPseqSpikeInFree for normalizing data without spike-in DNA [Optional]</h2><p><a href="https://academic.oup.com/bioinformatics/article/36/4/1270/5578481">ChIPseqSpikeInFree: a ChIP-seq normalization approach to reveal global changes in histone modifications without spike-in</a> is a novel ChIP-seq normalization method to effectively determine scaling factors for samples across various conditions and treatments, which does not rely on exogenous spike-in chromatin or peak detection to reveal global changes in histone modification occupancy. The installation details can be found on <a href="https://github.com/stjude/ChIPseqSpikeInFree">github</a>.</p><ul><li><a href="https://github.com/stjude/ChIPseqSpikeInFree#interpretation-of-scaling-factor-table">Interpretation of the ChIPseqSpikeInFree output.</a></li><li><a href="https://github.com/stjude/ChIPseqSpikeInFree#how-to-use-chipseqspikein-scaling-factor">How to use ChIPseqSpikeInFree scaling factor.</a></li></ul><h2 id="9-2-Other-peak-calling-methods"><a href="#9-2-Other-peak-calling-methods" class="headerlink" title="9.2. Other peak calling methods."></a>9.2. Other peak calling methods.</h2><ul><li>MACS2: <a href="https://genomebiology.biomedcentral.com/articles/10.1186/gb-2008-9-9-r137">Model-based Analysis of ChIP-Seq (MACS)</a>. Installation details can be found <a href="https://github.com/taoliu/MACS/wiki">here</a>.</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">##== linux command ==##</span><br>histName=<span class="hljs-string">&quot;K27me3&quot;</span><br>controlName=<span class="hljs-string">&quot;IgG&quot;</span><br><br><span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$projPath</span>/peakCalling<br>macs2 callpeak -t <span class="hljs-variable">$&#123;projPath&#125;</span>/alignment/bam/<span class="hljs-variable">$&#123;histName&#125;</span>_rep1_bowtie2.mapped.bam \<br>      -c <span class="hljs-variable">$&#123;projPath&#125;</span>/alignment/bam/<span class="hljs-variable">$&#123;controlName&#125;</span>_rep1_bowtie2.mapped.bam \<br>      -g hs -f BAMPE -n macs2_peak_q0.1 --outdir <span class="hljs-variable">$projPath</span>/peakCalling/MACS2 -q 0.1 --keep-dup all 2&gt;<span class="hljs-variable">$&#123;projPath&#125;</span>/peakCalling/MACS2/macs2Peak_summary.txt<br></code></pre></td></tr></table></figure><ul><li>dPeak: <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003246">dPeak: High Resolution Identification of Transcription Factor Binding Sites from PET and SET ChIP-Seq Data</a></li><li>MOSAiCS: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4608541/">A Statistical Framework for the Analysis of ChIP-Seq Data</a></li></ul><h2 id="9-3-Other-packages-for-differential-analysis-of-binding-sites"><a href="#9-3-Other-packages-for-differential-analysis-of-binding-sites" class="headerlink" title="9.3 Other packages for differential analysis of binding sites"></a>9.3 Other packages for differential analysis of binding sites</h2><ul><li>Limma: <a href="https://academic.oup.com/nar/article/43/7/e47/2414268">limma powers differential expression analyses for RNA-sequencing and microarray studies</a></li></ul><p>Limma is an R package for the analysis of gene expression microarray data, especially the use of linear models for analysing designed experiments and the assessment of differential expression. Limma provides the ability to analyse comparisons between many RNA targets simultaneously in arbitrary complicated designed experiments. Empirical Bayesian methods are used to provide stable results even when the number of arrays is small. Limma can be extended to study differential fragment enrichment analysis within peak regions. Notably, limma can deal with both fixed effect model and random effect model.</p><ul><li>edgeR: <a href="https://academic.oup.com/nar/article/40/10/4288/2411520">Differential Expression Analysis of Multifactor RNA-Seq Experiments With Respect to Biological Variation</a></li></ul><p>Differential expression analysis of RNA-seq expression profiles with biological replication. Implements a range of statistical methodology based on the negative binomial distributions, including empirical Bayes estimation, exact tests, generalized linear models and quasi-likelihood tests. As well as RNA-seq, it be applied to differential signal analysis of other types of genomic data that produce read counts, including ChIP-seq, ATAC-seq, Bisulfite-seq, SAGE and CAGE. edgeR can deal with multifactor problem.</p><h1 id="X-Troubleshooting-Generating-your-data"><a href="#X-Troubleshooting-Generating-your-data" class="headerlink" title="X. Troubleshooting: Generating your data"></a>X. Troubleshooting: Generating your data</h1><p>This workflow can be followed with your own data and will generate a standardized set of quality-control reports. However, many sequencing facilities do not perform 25x25 PE sequencing, and alternate parameters for trimming and mapping are provided here. Control datasets for non-specific antibody (IgG) profiling or ATAC-seq profiling of your material can also be used for optional analysis detailed here.</p><p>Stringent washing with 300 mM NaCl is critical to limit the affinity of Tn5 for exposed DNA. We describe here the need for controlling background Tn5 affinities and describe how our CUT&amp;Tag protocol effectively suppresses this artifact for unambiguous mapping of chromatin epitopes. We present a protocol that can process either native or fixed nuclei and includes alternative methods for DNA isolation. To illustrate the method, we describe a typical experiment, including evaluation of the results using a new metric for peak-calling information. Further, we validate a single-tube format for CUT&amp;Tag that requires no DNA isolation but instead uses tagmented material directly for library amplification. We document critical steps for the CUT&amp;Tag protocol, informed by our experiences, helping users establish this method in their research.</p><hr><p>Cite:<a href="https://yezhengstat.github.io/CUTTag_tutorial/#">https://yezhengstat.github.io/CUTTag_tutorial/#</a> Zheng Y et al (2020). Protocol.io</p>]]></content>
    
    
    <categories>
      
      <category>NGS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>pipeline</tag>
      
      <tag>CUT-tag</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ATAC-seq-pipelineã€‘</title>
    <link href="/GeekFocus/2022/03/20/2022-03-20-ATAC-seq-6/"/>
    <url>/GeekFocus/2022/03/20/2022-03-20-ATAC-seq-6/</url>
    
    <content type="html"><![CDATA[<p>ATAC-seqä¿¡æ¯åˆ†ææµç¨‹ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼šæ•°æ®è´¨æ§ã€åºåˆ—æ¯”å¯¹ã€å³°æ£€æµ‹ã€motifåˆ†æã€å³°æ³¨é‡Šã€å¯Œé›†åˆ†æ.</p><p>an <strong>a</strong>ssay for <strong>t</strong>ransposase-<strong>a</strong>ccessible <strong>c</strong>hromatin using <strong>seq</strong>uencing </p><span id="more"></span><hr><p><a href="https://www.biostars.org/p/442707/">?</a></p><p><a href="https://www.biostars.org/p/413626/">?</a></p><p><a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM3455685">Data processing1:Johns Hopkins University School of Medicine</a>2019 mar</p><p>ATAC-seq data were <strong>aligned</strong> using <strong>Bowtie2</strong> (Version 2.3.2 t -X 2000 <strong>â€“no-mixed â€“no-discordant</strong>) </p><p> <strong>duplicate</strong> reads were removed (<strong>picard</strong> MarkDuplicates)</p><p>Peaks were called using <strong>MACS2</strong> (Version 2.1.1.20160309 callpeak <strong>â€“nomodel â€“keep-dup all â€“shift âˆ’100 â€“extsize 200</strong> â€“call-summits) (Zhang et al., 2008). </p><p>Peaks were then <strong>filtered for fold-change &gt;2 and -log(qvalue) &gt;2</strong>. </p><p><strong>deepTools</strong> was used to visualize ATAC-seq peaks on the browser (bamCoverage -bs 1 â€“normalizeUsing <strong>RPKM</strong>).<br>Genome_build: <strong>mm10</strong><br>Supplementary_files_format_and_content: narrowPeak and .bw</p><p><a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM5502736">Data processing2:University of California, San Diego</a>  2022 Jan<br>Sequenced reads were trimmed for adaptor sequence, and masked for low-complexity or low-quality sequence, then mapped to hg38 whole genome using <strong>bowtie</strong> v2.3.5.1 with parameters -q -p 4 -e 100 -y -a -m 10 â€“best â€“strata<br>For <strong>RNA-seq data</strong>: Transcripts per Million (<strong>TPM</strong>) were calculated using a protocol from <strong>Chepelev et al</strong>., Nucleic Acids Research, 2009. In short, exons from all isoforms of a gene were merged to create one meta-transcript. The number of reads falling in the exons of this meta-transcript were counted and normalized by the size of the meta-transcript and by the size of the library.<br>For <strong>ATAC-seq data</strong>: peaks were called using <strong>Genrich</strong> version 0.6.1 with the following setting: -j -y -r -e chrM -v.</p><p><strong>Bigwig</strong> file generated using bamCoverage version 3.3.2 with the following setting: <strong>â€”binSize 20 â€”normalizeUsing BPM â€”smoothLength 60 â€”centerReads</strong>. Heatmap, genomic tracker and scatter map generated using EaSeq version 1.111.<br>For <strong>ChIP-seq data</strong>: peaks were called using <strong>MACS3</strong> version 3.0.0a6 with the following setting: -g hs -f BAM. Bigwig file generated using bamCoverage version 3.3.2 with the following setting: <strong>â€”binSize 20 â€”normalizeUsing BPM â€”smoothLength 60 â€”centerReads</strong>. Heatmap, genomic tracker and scatter map generated using EaSeq version 1.111.<br>For <strong>CUT&amp;Tag-seq data</strong>: peaks were called using <strong>SEACR</strong> version 1.3 with the following setting: <strong>-norm strigent</strong>. </p><p>Bigwig file generated using bamCoverage version 3.3.2 with the following setting: <strong>â€”binSize 20 â€”normalizeUsing BPM â€”smoothLength 60 â€”centerReads</strong>. Heatmap, genomic tracker and scatter map generated using <strong>EaSeq</strong> version 1.111.<br>Genome_build: <strong>hg38</strong><br>Supplementary_files_format_and_content: For RNA-seq: tab-delimited text files include TPM values for each Sample<br>Supplementary_files_format_and_content: For ATAC-seq, ChIP-seq and CUT&amp;Tag-seq: bigwid files for display in hg38 genome browser track</p><p><a href="https://https.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM4432199">Data processing3:Hong Kong University of Science and Technology</a>  2020 may</p><p>For ChIP-seq, Base-calling is done by bcl2-fastq<br>For sequencing alignment and duplicate removal, sequencing data were mapped to the mm10 mice genome assembly by using the <strong>BWA</strong>. Duplicates were marked and removed using the <strong>Picard</strong> tools MarkDuplicates function with the parameter, REMOVE_DUPLICATES&#x3D;TRUE.<br>For <strong>peak identification</strong>, the <strong>HOMER</strong> (Heinz et al., 2010) maketagdirectory function was used to combine sequencing data from the biological replicates, and the <strong>findPeaks</strong> function was used to identify binding&#x2F;accessible regions with the following parameters: -style factor (for PU.1 ChIP-seq), <strong>-style histone</strong> (for H3K4me3 ChIP-seq), and <strong>-style histone -minDist 200</strong> (for ATAC-seq). Regions were annotated by the <strong>annotatePeaks.pl</strong> function. deepTools bamCoverage function and visualized in igv browser (Robinson et al., 2011).<br><strong>Read count in the binding&#x2F;accessible regions</strong> was <strong>quantified</strong> by the <strong>bedtools</strong> (Quinlan and Hall, 2010) <strong>multicov</strong> function. Differential binding&#x2F;accessible regions (p &lt; 0.05) were calculated using R.<br>Genome_build: mm10<br>Supplementary_files_format_and_content: bigWig files were generated using <strong>Bamcoverage â€“normalizeUsing CPM â€“binSize 10</strong><br>For scRNA-seq,Base-calling is done by bcl2-fastq<br>The sequencing data were aligned, quantified, and clustered using Cell Ranger (version 3.0) as previously described (Zheng et al., 2017).<br>Genome_build: mm10<br>Supplementary_files_format_and_content: Matrix of read count, barcode were generated using cell ranger v3</p><p><a href="https://https.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM4160552">Data processing 4:Johns Hopkins University School of Medicine</a> 2020 Jan</p><p>ATAC-seq data were <strong>aligned</strong> to the GRCm38 genome using <strong>HISAT2</strong> version 2.1.0 (hisat2 -t -X 2000 â€“no-mixed â€“no-discordant) and then duplicate reads were removed (<strong>picard</strong> MarkDuplicates). Peaks were called using <strong>MACS2</strong> version 2.1.2 (<strong>callpeak -f BAM â€“nomodel â€“keep-dup all â€“shift âˆ’100 â€“extsize 200</strong>) (Zhang et al., 2008). Peaks were then filtered for <strong>fold-change &gt;2 and -log(qvalue) &gt;2</strong>. deepTools was used to visualize ATAC-seq peaks on the browser (bamCoverage <strong>-bs 1 â€“extendReads â€“ignoreDuplicates â€“normalizeUsing CPM</strong>).<br>Genome_build: mm10</p><p>GEO ATAC-seq?????</p><p>GEO CUT&amp;Tag??????</p><p><a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE101940">2018Arab</a></p><hr><p><a href="https://www.jianshu.com/p/dc0c49bfcd41;https://seqhealth.biomart.cn/news/2995703.htm;https://zhuanlan.zhihu.com/p/146068902;https://www.jianshu.com/p/09e05bcd6981">Ref1</a></p><blockquote><p><strong>ä¸€ã€æ•°æ®è¿‡æ»¤ä¸è´¨é‡è¯„ä¼°</strong></p></blockquote><p>fastp fastqc</p><blockquote><p><strong>äºŒã€æ¯”å¯¹</strong></p></blockquote><p>Bowtie2,bwa</p><p>åç»­åˆ†æreadséœ€è¦å”¯ä¸€æ¯”å¯¹ä¸”å»é‡å¤çš„ï¼Œæ¯”å¯¹ç»“æœé€šè¿‡<strong>MAPQ</strong>å€¼æå–å”¯ä¸€æ¯”å¯¹readsï¼Œå¯ä»¥ç”¨picardã€sambambaç­‰å»é™¤dupï¼Œæœ€ç»ˆå¾—åˆ°å”¯ä¸€æ¯”å¯¹ä¸”å»é‡å¤çš„bam</p><p>è´¨ä½“åºåˆ—å»é™¤ã€‚samtoolsæå–ï¼Œå°†ä¸å«è´¨ä½“çš„æŸ“è‰²ä½“å†™åˆ°chrlistæ–‡ä»¶[Chr1â€¦.12]ï¼Œä¸€æ¡æŸ“è‰²ä½“ä¸€è¡Œ</p><p><code>samtools view -b A1.bam $chrlist &gt; A1.del_MT_PT.bam</code></p><blockquote><p><strong>ä¸‰ã€readsåœ¨æŸ“è‰²ä½“ä¸Šåˆ†å¸ƒçš„å¯è§†åŒ–</strong></p></blockquote><p>bamè½¬bigWigï¼ˆbwï¼‰ï¼ŒIGVå±•ç¤º(no shift)ã€‚deeptoolså¯å®ç°bwæ ¼å¼è½¬åŒ–å’Œå¯è§†åŒ–å±•ç¤º</p><p><code>bamCoverage -b A1.bam -o A1.bw</code></p><p>deeptoolså±•ç¤ºreadsåœ¨ç‰¹å®šåŒºåŸŸçš„åˆ†å¸ƒï¼Œå¦‚ï¼š</p><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ldif">computeMatrix reference-point   \ <span class="hljs-comment"># reference-piointè¡¨ç¤ºè®¡ç®—ä¸€ä¸ªå‚ç…§ç‚¹é™„è¿‘çš„readsåˆ†å¸ƒï¼Œä¸ä¹‹ç›¸å¯¹çš„æ˜¯scale-regionsï¼Œè®¡ç®—ä¸€ä¸ªåŒºåŸŸé™„è¿‘çš„readsåˆ†å¸ƒ</span><br><span class="hljs-literal">-</span>-referencePoint TSS   \<span class="hljs-comment">#ä»¥è¾“å…¥çš„bedæ–‡ä»¶çš„èµ·å§‹ä½ç½®ä½œä¸ºå‚ç…§ç‚¹</span><br><span class="hljs-literal">-</span>S  A1.bw \ <span class="hljs-comment">#å¯ä»¥æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªbwæ–‡ä»¶</span><br><span class="hljs-literal">-</span>R  gene.bed \ <span class="hljs-comment">#åŸºå› ç»„ä½ç½®æ–‡ä»¶</span><br><span class="hljs-literal">-</span>b 3000   \ <span class="hljs-comment">#è®¡ç®—è¾¹ç•Œä¸ºå‚è€ƒç‚¹ä¸Šæ¸¸3000bp</span><br><span class="hljs-literal">-</span>a 3000   \ <span class="hljs-comment">#è®¡ç®—è¾¹ç•Œä¸ºå‚è€ƒç‚¹ä¸‹æ¸¸3000bpï¼Œä¸-båˆèµ·æ¥å°±æ˜¯ç»˜åˆ¶å‚è€ƒç‚¹ä¸Šä¸‹æ¸¸3000bpä»¥å†…çš„readsåˆ†å¸ƒ</span><br><span class="hljs-literal">-</span>o  A1.matrix.mat.gz \ <span class="hljs-comment">#è¾“å‡ºä½œå›¾æ•°æ®åç§°</span><br></code></pre></td></tr></table></figure><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-string">\#å›¾å½¢ç»˜åˆ¶</span><br>plotHeatmap <span class="hljs-string">\</span><br>-m  new_A1.matrix.mat.gz <span class="hljs-string">\</span> <span class="hljs-comment">#ä¸Šä¸€æ­¥ç”Ÿæˆçš„ä½œå›¾æ•°æ®</span><br>-out A1.pdf <span class="hljs-string">\</span> <span class="hljs-comment"># è¾“å‡ºå›¾ç‰‡åç§°</span><br></code></pre></td></tr></table></figure><blockquote><p><strong>å››ã€Peak calling</strong></p></blockquote><p>MACS2æ£€æµ‹DNAç‰‡æ–­å¯Œé›†åŒºåŸŸï¼Œæ˜¯ATAC-seq call peakçš„<strong>ä¸»æµè½¯ä»¶</strong>ã€‚å³°æ£€å‡ºåŸç†ï¼šé¦–å…ˆå°†æ‰€æœ‰çš„readséƒ½å‘3â€™æ–¹å‘å»¶ä¼¸æ’å…¥ç‰‡æ®µé•¿åº¦ï¼Œç„¶åå°†åŸºå› ç»„è¿›è¡Œæ»‘çª—ï¼Œè®¡ç®—è¯¥çª—å£çš„dynamic Î»ï¼ŒÎ»çš„è®¡ç®—å…¬å¼ä¸ºï¼šÎ»local &#x3D; Î»BGï¼ˆÎ»BGæ˜¯æŒ‡èƒŒæ™¯åŒºåŸŸä¸Šçš„readsæ•°ç›®ï¼‰ï¼Œç„¶ååˆ©ç”¨æ³Šæ¾åˆ†å¸ƒæ¨¡å‹çš„å…¬å¼è®¡ç®—è¯¥çª—å£çš„æ˜¾è‘—æ€§På€¼ï¼Œæœ€åå¯¹æ¯ä¸€ä¸ªçª—å£çš„æ˜¾è‘—æ€§På€¼è¿›è¡ŒFDRæ ¡æ­£ã€‚é»˜è®¤æ ¡æ­£åçš„På€¼ï¼ˆå³qvalueï¼‰å°äºæˆ–è€…ç­‰äº0.05çš„åŒºåŸŸä¸ºpeakåŒºåŸŸã€‚</p><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ldif">macs2 callpeak \<br><span class="hljs-literal">-</span>t A1.uni.dedup.bam \ <span class="hljs-comment">#bamæ–‡ä»¶</span><br><span class="hljs-literal">-</span>n A1 \ <span class="hljs-comment"># è¾“å‡ºæ–‡ä»¶å‰ç¼€å</span><br><span class="hljs-literal">-</span>-shift -100 \ <span class="hljs-comment">#extsizeçš„ä¸€åŠä¹˜ä»¥-1</span><br><span class="hljs-literal">-</span>-extsize 200 \ <span class="hljs-comment">#ä¸€èˆ¬æ˜¯æ ¸å°ä½“å¤§å°</span><br><span class="hljs-literal">-</span>-call-summits <span class="hljs-comment">#æ£€æµ‹å³°é¡¶ä¿¡æ¯</span><br><br><span class="hljs-comment">#æ³¨ï¼šä»¥ä¸Šå‚æ•°å‚è€ƒæ–‡çŒ®ï¼ˆJie Wangï¼Œet.al.2018.â€œATAC-Seq analysis reveals a widespread decrease of chromatin accessibility in age-related macular degeneration.â€Nature Communicationsï¼‰</span><br></code></pre></td></tr></table></figure><blockquote><p><strong>äº”ã€motifåˆ†æ</strong></p></blockquote><p>ATACçš„peakæ˜¯æŸ“è‰²è´¨å¼€æ”¾åŒºåŸŸï¼ŒæŸ“è‰²è´¨å¼€æ”¾åŒºåŸŸé¢„ç¤ºç€è½¬å½•å› å­ç»“åˆï¼Œå¯¹peakåŒºè¿›è¡Œmotifåˆ†æå¾ˆæœ‰æ„ä¹‰ã€‚å¸¸è§çš„motifåˆ†æè½¯ä»¶æœ‰homerå’ŒMEMEã€‚ä»¥homerè½¯ä»¶ä¸ºä¾‹ motifåˆ†æï¼š</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs livescript">findMotifsGenome.pl <span class="hljs-string">\</span><br>A1_peaks.bed <span class="hljs-string">\</span> <span class="hljs-comment">#ç”¨äºè¿›è¡Œmotifåˆ†æçš„bedæ–‡ä»¶</span><br>genome.fa  <span class="hljs-string">\</span> <span class="hljs-comment">#å‚è€ƒåŸºå› ç»„faæ–‡ä»¶</span><br>A1  <span class="hljs-string">\</span> <span class="hljs-comment">#è¾“å‡ºæ–‡ä»¶å‰ç¼€</span><br>-size  given <span class="hljs-string">\</span> <span class="hljs-comment">#ä½¿ç”¨ç»™å®šçš„bedåŒºåŸŸä½ç½®è¿›è¡Œåˆ†æï¼Œå¦‚æœå¡«-size -100,50åˆ™æ˜¯ç”¨ç»™å®šbedä¸­é—´ä½ç½®çš„ä¸Šæ¸¸100bpåˆ°ä¸‹æ¸¸50bpçš„åŒºåŸŸè¿›è¡Œåˆ†æ</span><br></code></pre></td></tr></table></figure><p>homeråˆ†æmotifçš„åŸç†åŠç»“æœå‚è§ï¼š<a href="http://homer.ucsd.edu/homer/motif/index.html">http://homer.ucsd.edu/homer/motif/index.html</a></p><p>æ ¹æ®motifä¸å·²çŸ¥è½¬å½•å› å­çš„å¯Œé›†æƒ…å†µå¯ä»¥ç»˜åˆ¶æ°”æ³¡å›¾ï¼Œä»è€Œå¯ä»¥çœ‹åˆ°æ ·æœ¬ä¸å·²çŸ¥è½¬å½•å› å­çš„å¯Œé›†æ˜¾è‘—æ€§ã€‚</p><p><img src="/GeekFocus/2022-03-20-ATAC-seq-6/1.png" alt="img"><br><img src="/GeekFocus/img/2022-03-20-ATAC-seq-6/1.png" alt="img"></p><blockquote><p><strong>å…­ã€å·®å¼‚åˆ†æ</strong></p></blockquote><p>å·®å¼‚peakæ˜¯æŸ“è‰²è´¨å¼€æ”¾æ€§å·®å¼‚ä½ç‚¹ï¼ŒChIP-seqå’ŒATAC-seqéƒ½å¯ç”¨<strong>DiffBind</strong>å·®å¼‚åˆ†æã€‚DiffBindé€šè¿‡bamæ–‡ä»¶å’Œpeakçš„bedæ–‡ä»¶è®¡ç®—<strong>peakåŒºåŸŸæ ‡å‡†åŒ–çš„readcount</strong>ï¼Œå¯é€‰æ‹©edgeRã€DESeq2ç­‰æ¨¡å‹è¿›è¡Œå·®å¼‚åˆ†æã€‚</p><blockquote><p><strong>ä¸ƒã€å³°æ³¨é‡Š</strong></p></blockquote><p>peakåŒºåŸŸä¸åŸºå› è”ç³»ï¼Œé€šè¿‡å¯¹peakæ³¨é‡Šæ‰¾åˆ°peakç›¸å…³åŸºå› ã€‚å¸¸è§çš„peakæ³¨é‡Šè½¯ä»¶æœ‰ChIPseekerã€homerã€PeakAnnotatorç­‰ã€‚ä»¥ChIPseekerä¸ºä¾‹ï¼Œå®‰è£…ChIPseekeråŒ…å’ŒGenomicFeaturesåŒ…ï¼Œç„¶ååˆ†æ</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">library(ChIPseeker)<br>library(GenomicFeatures)<br>txdb&lt;- make<span class="hljs-constructor">TxDbFromGFF(â€˜<span class="hljs-params">gene</span>.<span class="hljs-params">gtf</span>â€™)</span>#ç”Ÿæˆtxdbå¯¹è±¡ï¼Œå¦‚æœç ”ç©¶ç‰©ç§æ²¡æœ‰å·²çŸ¥çš„TxDb,å¯ä»¥ç”¨GenomicFeaturesä¸­çš„å‡½æ•°ç”Ÿæˆ<br>peakfile &lt;-read<span class="hljs-constructor">PeakFile(â€˜A1_peaks.<span class="hljs-params">narrowPeak</span>â€™)</span>#å¯¼å…¥éœ€è¦æ³¨é‡Šçš„peakæ–‡ä»¶<br>peakAnno &lt;- annotate<span class="hljs-constructor">Peak(<span class="hljs-params">peakfile</span>,<span class="hljs-params">tssRegion</span>=<span class="hljs-params">c</span>(-2000, 2000)</span>, TxDb=txdb)<br>\# ç”¨peakæ–‡ä»¶å’Œtxdbè¿›è¡Œpeakæ³¨é‡Šï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡tssRegionå®šä¹‰TSSåŒºåŸŸçš„åŒºé—´<br>å¯¹peakæ³¨é‡Šçš„ç»“æœå¯è§†åŒ–å±•ç¤ºï¼š<br>p &lt;- plot<span class="hljs-constructor">AnnoPie(<span class="hljs-params">peakAnno</span>)</span><br></code></pre></td></tr></table></figure><blockquote><p><strong>å…«ã€å¯Œé›†åˆ†æ</strong></p></blockquote><p>peakç›¸å…³åŸºå› ä½¿ç”¨goseqã€topGOç­‰RåŒ…GOå¯Œé›†åˆ†æï¼Œç”¨kobasè¿›è¡Œkeggå¯Œé›†åˆ†æï¼Œä¹Ÿå¯ç”¨DAVIDåœ¨çº¿å·¥å…·å¯Œé›†åˆ†æã€‚æŒ‘é€‰æ„Ÿå…´è¶£çš„GO termæˆ–pathwayè¿›ä¸€æ­¥<strong>ç­›é€‰å€™é€‰åŸºå› </strong>ã€‚</p><hr><p><a href="https://seqhealth.biomart.cn/news/2995703.htm">Ref2</a></p><p>æ¾³å¤§åˆ©äºšè«çº³ä»€å¤§å­¦çš„Yan F.ç­‰äººäº2020å¹´2æœˆåœ¨Genome Biologyä¸Šå‘è¡¨ç»¼è¿°ã€ŠFrom reads to insight: a hitchhikerâ€™s guide to ATAC-seq data analysisã€‹</p><p>å“ºä¹³åŠ¨ç‰©DNAé€šè¿‡ä¸‰ä¸ªä¸»è¦å±‚æ¬¡å°ºåº¦ é«˜åº¦å‹ç¼©ï¼š</p><ul><li>ç¬¬ä¸€å±‚æ˜¯æ ¸å°ä½“ï¼ŒDNAç¼ ç»•åœ¨æ ¸å°ä½“å•ä½“ä¸Šï¼›</li><li>ç¬¬äºŒå±‚æ˜¯æŸ“è‰²è´¨ï¼Œæ ¸å°ä½“å•ä½“äº’ç›¸ç¼ ç»•å½¢æˆæŸ“è‰²è´¨ï¼›</li><li>ç¬¬ä¸‰å±‚æ˜¯æŸ“è‰²ä½“ï¼ŒæŸ“è‰²è´¨è¿›ä¸€æ­¥å‹ç¼©ä¸ºæŸ“è‰²ä½“ã€‚</li></ul><p>DNAå‹ç¼©çš„ä¸‰ä¸ªå°ºåº¦åŠå…¶ç›¸äº’ä½œç”¨å…±åŒé€ å°±äº†åŸºå› è¡¨è¾¾è°ƒæ§ã€‚</p><p>ATAC-seqä½¿ç”¨åŸºå› å·¥ç¨‹æ”¹é€ çš„<strong>è¶…é«˜æ´»æ€§Tn5è½¬åº§é…¶</strong>ï¼ˆHyperactive Transposase Tn5ï¼‰ï¼ŒTn5é…¶<strong>é¢„è½½</strong>æµ‹åºæ–‡åº“æ„å»ºçš„Adaptorï¼ˆ<strong>P5å’ŒP7</strong>ï¼‰ã€‚Tn5é…¶åˆ‡å‰²å¼€æ”¾æŸ“è‰²è´¨åŒºåŸŸï¼Œåœ¨é…¶åˆ‡ä½ç‚¹ç•™ä¸‹9 bpç²˜æ€§æœ«ç«¯ï¼Œå¹¶å°†ä¸¤ç§Adaptorè¿æ¥åˆ°åˆ‡å£çš„ç²˜æ€§æœ«ç«¯ï¼›éšåDNAç‰‡æ®µæ‰©å¢å½¢æˆæ–‡åº“æµ‹åºã€‚ä¸‹å›¾ä¸­<strong>NFR fragments</strong>æ˜¯å¼€æ”¾æŸ“è‰²è´¨ä¸­æ ¸å°ä½“é—´çš„<strong>Linker DNAç‰‡æ®µ</strong>ï¼Œç”±Peak Callingçš„Peaké‰´å®šï¼›<strong>è“è‰²Footprintæ˜¯è½¬å½•å› å­è¶³è¿¹</strong>ï¼Œå¯¹åº”<strong>è½¬å½•å› å­è¶³è¿¹åˆ†æ</strong>ï¼›æ ¸å°ä½“å•ä½“ï¼ˆMononucleosomeï¼‰ç»“åˆDNAç‰‡æ®µåˆ™åæ˜ æ ¸å°ä½“ä½ç½®ä¿¡æ¯ï¼Œå¯¹åº”<strong>æ ¸å°ä½“å ä½åˆ†æ</strong>ã€‚</p><p><img src="/GeekFocus/2022-03-20-ATAC-seq-6/2.png" alt="img"><br><img src="/GeekFocus/img/2022-03-20-ATAC-seq-6/2.png" alt="img"></p><p>ç”±äºATAC-seqå’ŒChIP-seqæ•°æ®ç›¸ä¼¼æ€§è¾ƒé«˜ï¼Œç»¼è¿°é’ˆå¯¹ATAC-seqåˆ†æç°æœ‰è½¯ä»¶å…¨é¢ä»‹ç»å’Œè¯„ä¼°ã€‚</p><p><img src="/GeekFocus/2022-03-20-ATAC-seq-6/3.png" alt="img"><br><img src="/GeekFocus/img/2022-03-20-ATAC-seq-6/3.png" alt="img"></p><blockquote><p> è´¨æ§</p></blockquote><p>FastQCã€‚ATAC-seqæ–‡åº“é‡‡ç”¨<strong>Illumina Nexteraå»ºåº“</strong>ï¼Œ<strong>æ¥å¤´å’ŒTruseqæ–‡åº“ä¸ä¸€æ ·</strong>ï¼Œcutadaptã€AdapterRemoval v2ã€Skeweræˆ–trimmomatic(å»Nexteraæ¥å¤´)ã€‚</p><blockquote><p>åºåˆ—æ¯”å¯¹</p></blockquote><p>è¿‡æ»¤åFastQCã€‚<strong>BWA-MEM</strong>å’Œ<strong>Bowtie2</strong>ä¸¤ä¸ªè½¯ä»¶çš„soft-clipç­–ç•¥ä¿ç•™çªå‡ºå’Œæ²¡æœ‰æ¯”å¯¹ä¸Šçš„ç¢±åŸºï¼Œå¯<strong>å¢åŠ </strong>åœ¨å‚è€ƒåºåˆ—å”¯1æ¯”å¯¹çš„åºåˆ—æ•°ç›®ï¼ˆ<strong>Uniqueæ¯”å¯¹ç‡</strong>ï¼‰ã€‚å“ºä¹³åŠ¨ç‰©ï¼Œ**Uniqueæ¯”å¯¹ç‡å¤§äº80%**çš„æ•°æ®æ˜¯æ¯”è¾ƒæˆåŠŸçš„ATAC-seqæ–‡åº“ã€‚</p><blockquote><p>æ¯”å¯¹åå¤„ç†å’Œè´¨æ§</p></blockquote><p>Picardå’ŒSAMtoolsè½¯ä»¶ç»Ÿè®¡Uniqueæ¯”å¯¹ç‡ã€é‡å¤readsæ¯”ä¾‹å’Œç‰‡æ®µå¤§å°åˆ†å¸ƒã€‚</p><p><strong>Mappingåå»é™¤å¹²æ‰°reads</strong>ï¼š</p><ol><li>é…å¯¹é”™è¯¯å’Œæ¯”å¯¹è´¨é‡è¾ƒä½çš„readså‰”é™¤</li><li><strong>çº¿ç²’ä½“åŸºå› ç»„æ²¡æœ‰æŸ“è‰²è´¨ç»„è£…</strong>ï¼Œå¤„äºå¼€æ”¾çŠ¶æ€ï¼Œ<strong>æ›´å®¹æ˜“è¢«Tn5é…¶åˆ‡å‰²</strong>ï¼Œçº¿ç²’ä½“åºåˆ—å»é™¤</li><li>ENCODEæ•°æ®åº“é»‘åå•åŒºåŸŸï¼ˆblacklisted regionsï¼‰åŒ…å«ä¸€äº›å¼‚å¸¸ã€readè¦†ç›–åº¦å¾ˆé«˜çš„åŒºåŸŸï¼ŒåŒºåŸŸreadså»é™¤</li><li>ç”±PCRå»ºåº“äº§ç”Ÿã€é‡å¤ç‡è¿‡é«˜çš„readséœ€è¦å»é™¤ã€‚</li></ol><p>æ­¤å¤–ï¼Œ<strong>æµ‹åºæ–‡åº“æ’å…¥ç‰‡æ®µå¤§å°åˆ†å¸ƒ</strong>ä¹Ÿå¯ç”¨æ¥åˆ¤æ–­ATAC-seqå®éªŒè´¨é‡ã€‚æ’å…¥ç‰‡æ®µå¤§å°ç†è®ºåˆ†å¸ƒä¸ºï¼šNFR fragmentsï¼ˆ&lt;100 bpï¼‰ã€æ ¸å°ä½“å•ä½“ï¼ˆ<del>200 bpï¼‰ã€æ ¸å°ä½“äºŒèšä½“ï¼ˆ</del>400 bpï¼‰å’Œæ ¸å°ä½“ä¸‰èšä½“ï¼ˆ~600 bpï¼‰</p><blockquote><p>æ ¸å¿ƒåˆ†æ peak calling</p></blockquote><p>ENCODEé€‰æ‹©MACS2ä½œä¸ºATAC-seqæ ‡å‡†Peak Callingã€‚ä¸ChIP-seqä¸åŒï¼Œ<strong>ç”±äºTn5é…¶åˆ‡å‰²çš„éšæœºæ€§å’Œæˆæœ¬</strong>ï¼ŒATAC-seqæ²¡<strong>æœ‰Inputå¯¹ç…§</strong>ã€‚ATAC-seqæ•°æ®åŒ…å«<strong>NFR reads</strong>å’Œ<strong>DNAä¸æ ¸å°ä½“ç»“åˆåŒºåŸŸreads</strong>ï¼Œè€Œ<font color="red">ATAC-seqå…³æ³¨<strong>NFRéƒ¨åˆ†reads</strong></font>ï¼Œä¸èƒ½ç›´æ¥ç”¨æ‰€æœ‰reads Peak Callingã€‚ä¸€ç§æ–¹å¼æŠŠNFR readså•ç‹¬æå–åˆ†æï¼›<font color="red">å¦ä¸€ç§æ–¹å¼é‡‡ç”¨<strong>shift-extend</strong>åˆ†æ</font>ï¼Œè¿™ç§æ–¹æ³•å°è¯•å¯¹Tn5é…¶åˆ‡å£çš„æœ«ç«¯å¹³æ»‘åŒ–äº‹ä»¶è¿›è¡Œè®¡æ•°ï¼ˆè§ä¸‹å›¾ï¼‰ã€‚ç¬¬äºŒç§æ›´é€šç”¨ï¼Œå› ä¸ºè¿™ç§æ–¹æ³•<strong>å‡ ä¹é€‚ç”¨æ‰€æœ‰ä¸ºChIP-seqæ•°æ®å¼€å‘çš„Peak Callingè½¯ä»¶ï¼Œä¸”ä¸å—æ’å…¥ç‰‡æ®µå¤§å°å½±å“</strong>ã€‚</p><p><img src="/GeekFocus/2022-03-20-ATAC-seq-6/4.png" alt="img"><br><img src="/GeekFocus/img/2022-03-20-ATAC-seq-6/4.png" alt="img"></p><p>ChIP-seq Peak Callingè½¯ä»¶æ ¹æ®åŸç†åˆ†ä¸¤å¤§ç±»ï¼š<font color="red"><strong>Count-based</strong>å’Œ<strong>Shaped-based</strong></font>ã€‚Count-basedçš„è½¯ä»¶æ›´æ˜“äºä½¿ç”¨å’Œè§£é‡Šç»“æœã€‚è¿™äº›è½¯ä»¶é‡‡ç”¨<font color="red">ä¸åŒç»Ÿè®¡æ–¹æ³•æ¯”è¾ƒ<strong>ç›®æ ‡åŒºåŸŸå’ŒéšæœºèƒŒæ™¯åŒºåŸŸ</strong>çš„<strong>readsåˆ†å¸ƒ</strong>å½¢çŠ¶</font>ï¼Œå¸¸ç”¨åŒ…æ‹¬ï¼š</p><ul><li>å‡è®¾ç‰‡æ®µåˆ†å¸ƒä¸ºæ³Šæ¾åˆ†å¸ƒï¼š<strong>MACS2ã€HOMERã€SICER&#x2F;epic2</strong></li><li>å‡è®¾ç‰‡æ®µåˆ†å¸ƒä¸ºé›¶è†¨èƒ€è´ŸäºŒé¡¹åˆ†å¸ƒï¼š<strong>ZINBA</strong></li><li>æ ¸å¯†åº¦ä¼°è®¡æ¥åˆ¤æ–­ç‰‡æ®µåˆ†å¸ƒï¼š<strong>F-seqã€PeakDEck</strong></li><li>ä¸ä½¿ç”¨ç‰‡æ®µåˆ†å¸ƒå‡è®¾ä½†é€šè¿‡è½¯ä»¶æ‰“åˆ†ï¼š<strong>SPP</strong></li><li>æ··åˆæ¨¡å‹ï¼š<strong>JAMM</strong></li></ul><p>å…¶ä¸­F-seq, ZINBA ä¸æ›´æ–°<br><font color="red">Shaped-based</font>ç›´æ¥æˆ–è€…é—´æ¥<font color="red">åˆ©ç”¨reads<strong>å¯†åº¦åˆ†å¸ƒä¿¡æ¯</strong>Peak Calling</font>ï¼ŒåŒ…æ‹¬å’Œç­‰è½¯ä»¶ï¼Œæš‚æ—¶æ²¡ç”¨äºATAC-seqã€‚ç›®å‰ä¸“é—¨ä¸ºATAC-seqå¼€å‘çš„Peak Callingè½¯ä»¶åªæœ‰<strong>HMMRATAC</strong>ã€‚è¯¥è½¯ä»¶é€šè¿‡ä¸‰çŠ¶æ€åŠç›‘ç£éšé©¬å°”ç§‘å¤«æ¨¡å‹ç®—æ³•æŠŠåŸºå› ç»„åˆ†æˆé«˜ä¿¡å·å¼ºåº¦çš„æ´»æ€§æŸ“è‰²è´¨åŒºåŸŸã€ä¸­ç­‰ä¿¡å·å¼ºåº¦çš„æ ¸å°ä½“åŒºåŸŸå’Œä½ä¿¡å·å¼ºåº¦çš„èƒŒæ™¯åŒºåŸŸã€‚è®¡ç®—é‡åå¤§ï¼Œè€—æ—¶è¾ƒé•¿ï¼Œ<font color="red"><strong>ç»“æœæ¯”MACS2æ›´å¥½</strong></font>ï¼ŒåŒæ—¶æä¾›æ ¸å°ä½“ä½ç½®ä¿¡æ¯ã€‚</p><p><img src="/GeekFocus/2022-03-20-ATAC-seq-6/5.png" alt="img"><br><img src="/GeekFocus/img/2022-03-20-ATAC-seq-6/5.png" alt="img"></p><p><font color="red"><strong>MACS2 pair-end å’ŒMACS2 shift-extendå“ªä¸ªå¥½?</strong></font></p><p>Count-basedè½¯ä»¶å·®å¼‚ä¸å¤§ï¼Œä½†Shaped-basedç»“æœéå¸¸ä¸åŒã€‚<font color="red"><strong>ç›®å‰ä»æ²¡æœ‰ç»¼åˆæ€§æŒ‡æ ‡è¯„ä¼°Peak Callingè½¯ä»¶çš„ç»“æœè¡¨ç°ã€‚</strong></font><br>ä»¥ä¸Šåˆ†æPeak Callingè½¯ä»¶ç»“æœï¼Œä½†æ˜¯å¹¶æ²¡æœ‰é’ˆå¯¹å­˜åœ¨ç”Ÿç‰©å­¦é‡å¤çš„Peak Callingç»“æœå¯ä¿¡åº¦è¿›è¡Œæ¢è®¨ã€‚</p><p><strong>Peak Callingå¯ä¿¡åº¦</strong>: <strong>IDR</strong>ï¼ˆIrreproducibility Discovery Rateï¼‰æ˜¯æŒ‡ä¸å¯é‡ç°çš„å‘ç°ç‡ï¼Œç”¨äºæµ‹é‡ç”Ÿç‰©å­¦é‡å¤ä¸­çš„å¯é‡ç°æ€§ã€‚ATAC-seqæ¯”è¾ƒä¸€å¯¹ç»è¿‡æ’åºçš„regions&#x2F;peaksï¼Œè®¡ç®—åæ˜ å…¶é‡å¤æ€§çš„å€¼ã€‚IDRåˆ†æç»“æœçš„Peakæ˜¯å¯ä¿¡åº¦æ›´é«˜çš„Peakã€‚å»ºè®®æ¯ç»„æ ·å“2ä¸ªåŠä»¥ä¸Šç”Ÿç‰©å­¦é‡å¤ã€‚</p><blockquote><p> ATAC-seqé«˜çº§åˆ†æ</p></blockquote><p>ATAC-seqä¸»è¦åŠŸèƒ½æ˜¯æ­ç¤ºè½¬å½•è°ƒæ§å„ä¸ªæ–¹é¢ï¼Œå¯4ç§æ°´å¹³å¯¹ç»“æœåˆ†æå’Œè§£é‡Šï¼š1. Peakæ³¨é‡Šå’Œå·®å¼‚Peakåˆ†æï¼›2. Motifåˆ†æï¼›3. æ ¸å°ä½“å ä½åˆ†æï¼›4. è½¬å½•å› å­è¶³è¿¹åˆ†æã€‚</p><p><font color="green"><strong>Peakæ³¨é‡Šå’Œå·®å¼‚Peakåˆ†æ</strong></font></p><p>Peakä¸å…¶æœ€è¿‘åŸºå› æˆ–è°ƒæ§å…ƒä»¶çš„Peakæ³¨é‡Šï¼Œ<strong>HOMERã€ChIPseeker</strong>å’Œ<strong>ChIPpeakAnno</strong>ä¸‰ä¸ªè½¯ä»¶éƒ½å¯æŠŠPeakåˆ†é…åˆ°æœ€è¿‘æˆ–é‡å çš„åŸºå› ã€å¤–æ˜¾å­ã€å†…å«å­ã€å¯åŠ¨å­ã€5â€™UTRã€3â€™UTRå’Œå…¶å®ƒåŸºå› ç»„åŠŸèƒ½åŒºã€‚éšåç”¨Gene Ontologyï¼ˆGOï¼‰ã€KEGGå’ŒReactomeç­‰æ•°æ®åº“åšPeakå…³è”åŸºå› åŠŸèƒ½å¯Œé›†åˆ†æã€‚<strong>ChIPseeker</strong>å’Œ<strong>ChIPpeakAnno</strong>è½¯ä»¶å…·æœ‰å¯è§†åŒ–åŠŸèƒ½ã€‚<br>ç›®å‰æ²¡æœ‰ä¸“é—¨ä¸ºATAC-seqå¼€å‘çš„å·®å¼‚Peakåˆ†æè½¯ä»¶ã€‚å·®å¼‚Peakåˆ†æé¦–å…ˆé€šè¿‡<strong>å¯»æ‰¾å€™é€‰åŒºåŸŸ</strong>ï¼ˆå…±æœ‰Peakæˆ–æ ¹æ®binåˆ’åˆ†çš„åŸºå› ç»„ï¼‰ï¼Œç„¶å<strong>æ ‡å‡†åŒ–</strong>ï¼Œå†å¯¹è½åœ¨<strong>åŒºåŸŸå†…çš„ç‰‡æ®µè®¡æ•°</strong>ï¼Œæœ€ååœ¨ç›¸åŒåæ ‡å†…ä¸å…¶å®ƒå¤„ç†æ¡ä»¶çš„æ ·æœ¬è¿›è¡Œ<strong>ç»Ÿè®¡å­¦æ¯”è¾ƒ</strong>ã€‚åœ¨ä»¥å…±æœ‰Peakä¸ºåŸºç¡€åˆ†æçš„è½¯ä»¶ä¸­ï¼Œ<strong>HOMERã€DBChIP</strong>å’Œ<strong>DiffBind</strong>ä¾èµ–RNA-seqå·®å¼‚è¡¨è¾¾åŸºå› åˆ†æä¸­ä½¿ç”¨çš„RåŒ…è®¡ç®—å·®å¼‚Peakï¼Œä¾‹å¦‚<strong>edgeRã€DESeq</strong>å’Œ<strong>DESeq2</strong>ç­‰ï¼Œéƒ½è¦æ±‚ç”Ÿç‰©å­¦é‡å¤ã€‚</p><p><strong>HOMER</strong>æŠŠæ‰€æœ‰ç”Ÿç‰©å­¦é‡å¤æ ·å“æ•°æ®åˆå¹¶åˆ°ä¸€èµ·å‡å°‘å·®å¼‚peakçš„å‡é˜³æ€§ç»“æœã€‚<strong>DBChIP</strong>å’Œ<strong>DiffBind</strong>é€šè¿‡å–äº¤é›†æˆ–å¹¶é›†çš„æ–¹æ³•å¾—åˆ°å…±æœ‰Peakï¼Œå–äº¤é›†ä¼šå¿½ç•¥ä¸€äº›æ ·æœ¬æˆ–ç‰¹æ®Šçš„Peakï¼Œè€Œå–å¹¶é›†ä½¿å‡é˜³æ€§å¢å¤šã€‚</p><p>å¦å¤–ä¸ä¾èµ–RNA-seqåˆ†æRåŒ…çš„è½¯ä»¶åŒ…æ‹¬<strong>PePrã€DiffReps</strong>å’Œ<strong>ChIPDiff</strong>ï¼Œè¿˜æœ‰ä¸€ç§<strong>edgeR</strong>åŒ…çš„æ‰©å±•è½¯ä»¶<strong>csaw</strong>ï¼Œè¿™äº›è½¯ä»¶ä½¿ç”¨æ»‘çª—ï¼ˆSliding windowï¼‰æ–¹æ³•è¿›è¡Œåˆ†æï¼Œä½†æ˜¯å¾—åˆ°çš„<strong>ç»“æœå‡é˜³æ€§ç‡å¾ˆé«˜</strong>ï¼Œéœ€è¦è®¾ç½®ä¸¥æ ¼çš„FDRã€‚<br>æ–‡ç« æ¨èPeakæ³¨é‡Šä¸å·®å¼‚åˆ†æè½¯ä»¶ï¼š<strong>HOMER&#x2F;ChIPseeker&#x2F;ChIPpeakAnno + csaw</strong><br>åº·ç§‘Peakæ³¨é‡Šä¸å·®å¼‚åˆ†æè½¯ä»¶ï¼š<strong>Bedtools</strong> + <strong>edgeR</strong></p><p><font color="green"><strong>Motifåˆ†æ</strong></font></p><p>å¼€æ”¾æŸ“è‰²è´¨åŒºåŸŸä¸€èˆ¬å¯ç»“åˆç‰¹å®šè½¬å½•å› å­è¿›è€Œå½±å“è½¬å½•ï¼Œè½¬å½•å› å­ç»“åˆè¯†åˆ«çš„DNAåºåˆ—å³ä¸ºmotifï¼Œäººä½“å¤§çº¦<strong>1600ç§è½¬å½•å› å­</strong>ï¼Œå…¶ä¸­ä¸€åŠå¤šå·²æœ‰æ˜ç¡®æŠ¥é“çš„motifã€‚å¯¹motifçš„åˆ†æåŒ…æ‹¬<strong>motifå¯Œé›†åˆ†æ</strong>å’Œ<strong>è½¬å½•å› å­Footprintï¼ˆè¶³è¿¹ï¼‰åˆ†æ</strong>ã€‚</p><p>Motifå¯Œé›†åˆ†æ</p><p>ç›®å‰å¾ˆå¤šmotifæ•°æ®åº“ï¼Œä½¿ç”¨æœ€æ™®éçš„æ˜¯<strong>JASPARæ•°æ®åº“</strong>ï¼Œè¯¥æ•°æ®åº“æ”¶å½•å¤šç‰©ç§çš„motifæ•°æ®ï¼Œå¯ä»¥é€šè¿‡APIsæˆ–è€…Bioconductorçš„RåŒ…ä¸‹è½½ç›¸å…³æ•°æ®ã€‚æ­¤å¤–ï¼ŒCIS-BPå’ŒTRANSFACæ•°æ®åº“æ”¶å½•<strong>çœŸæ ¸ç”Ÿç‰©</strong>è½¬å½•å› å­çš„motifä¿¡æ¯ï¼ŒHOCOMOCOæ•°æ®åº“åˆ™ä¸“é—¨æ”¶å½•äº†<strong>äººå’Œå°é¼ </strong>çš„motifï¼ŒRegulonDBä¸ºå¤§è‚ æ†èŒçš„motifæ•°æ®åº“ã€‚<br><strong>HOMERã€MEME-AMEã€MEME-CentriMo</strong> <strong>DAStk</strong></p><p><font color="green"><strong>è½¬å½•å› å­è¶³è¿¹åˆ†æ</strong></font></p><p>å¦ä¸€ç§ATAC-seq<strong>è§£é‡Šè½¬å½•å› å­è°ƒæ§æ–¹å¼</strong>çš„æ˜¯è¶³è¿¹åˆ†æã€‚<font color="red">è½¬å½•å› å­è¶³è¿¹æŒ‡ä¸€ä¸ªè½¬å½•å› å­ç»“åˆåœ¨DNAï¼Œ<strong>é˜»æ­¢Tn5é…¶åˆ‡å‰²</strong>ï¼Œåœ¨<strong>æŸ“è‰²è´¨å¼€æ”¾åŒºåŸŸç•™</strong>ä¸‹ä¸€ä¸ª<strong>ç›¸å¯¹ç¼ºå¤±çš„ä½ç½®</strong></font>ã€‚</p><p>åšè¶³è¿¹åˆ†æä¸‰ä¸ªé—®é¢˜éœ€è¦è§£å†³ï¼š</p><p>1ï¼‰ç”±äºå»ºåº“æ—¶Tn5é…¶åˆ‡æ—¶ä¼šäº§ç”Ÿ9 bpçš„ç²˜æ€§æœ«ç«¯åˆ‡å£ï¼Œç»è¿‡æœ«ç«¯ä¿®å¤è¡¥é½åï¼ŒåŸå§‹readsåœ¨é¢„å¤„ç†æ—¶éœ€è¦ç»è¿‡ç§»ä½æ‰å¯ä»¥å‡†ç¡®æ£€æµ‹åˆ°Footprintï¼›</p><p>2ï¼‰Tn5é…¶åˆ‡å…·æœ‰5â€™ç«¯åå¥½æ€§ï¼›</p><p>3ï¼‰æŸäº›ç¬æ—¶ç»“åˆçš„è½¬å½•å› å­è¶³è¿¹ä¿¡å·è¾ƒå¼±ã€‚</p><p>è¶³è¿¹åˆ†æè½¯ä»¶æ ¹æ®ç®—æ³•åˆ†ä¸ºä¸¤å¤§ç±»ï¼šde novoå’ŒMotif-centricã€‚</p><p>de novoç±»å‹çš„è½¯ä»¶é€šè¿‡ç†è®ºè®¡ç®—é‰´åˆ«è½¬å½•å› å­è¶³è¿¹ä¿¡æ¯ï¼Œæ¶ˆé™¤Tn5é…¶åˆ‡æ—¶çš„5â€™åå¥½æ€§ã€‚ç›®å‰åªæœ‰<strong>HINT-ATAC</strong>å¯ä»¥å¤„ç†ATAC-seqæ•°æ®ç‰¹æœ‰çš„åå¥½æ€§ã€‚</p><p>Motif-centricæ–¹æ³•ä¸»è¦å…³æ³¨å·²çŸ¥TFçš„ç»“åˆä½ç‚¹ï¼Œä¸»è¦è½¯ä»¶æœ‰<strong>MILLIPEDEã€DeFCoM</strong>ç­‰ã€‚</p><p>è”åˆChIP-seqæ•°æ®çš„Motif-centricæ–¹æ³•åœ¨è¶³è¿¹åˆ†æä¸Šä¼˜äºde noveçš„æ–¹æ³•ï¼Œä½†æ˜¯è¿™äº›ChIP-seqæ•°æ®æ¥æºäºç‰¹å®šçš„è½¬å½•å› å­å’Œç‰¹å®šçš„ç»†èƒç±»å‹ï¼Œé€šç”¨æ€§ä¸å¼ºã€‚è€Œde novoçš„æ–¹æ³•åœ¨ä¸€äº›ä½è´¨é‡å’Œæ–°å‘ç°çš„ä¸€äº›motifä¸Šå…·æœ‰ä¼˜åŠ¿ã€‚</p><p>æ–‡ç« æ¨èè½¬å½•å› å­è¶³è¿¹åˆ†æè½¯ä»¶ï¼š<strong>HINT-ATAC</strong><br>åº·æµ‹ç§‘æŠ€è½¬å½•å› å­è¶³è¿¹åˆ†æè½¯ä»¶ï¼š<strong>HOMER + Bedtoolsè‡ªç¼–è„šæœ¬</strong></p><p><font color="green"><strong>æ ¸å°ä½“å ä½åˆ†æ</strong></font></p><p>æ ¸å°ä½“å•ä½“å¯ä»¥ç»“åˆå¤§çº¦147 bpçš„DNAï¼Œåœ¨æ ‡å‡†ATAC-seqæ–‡åº“ä¸­ï¼Œè¾ƒé•¿çš„æ’å…¥ç‰‡æ®µå¯¹åº”DNAä¸æ ¸å°ä½“ç»“åˆçš„åŒºåŸŸã€‚ATAC-seqæ•°æ®æ ¸å°ä½“ç»“åˆåŒºåŸŸæ¯”æŸ“è‰²è´¨å¼€æ”¾åŒºåŸŸreads<strong>è¦†ç›–åº¦æ›´ä½</strong>ï¼Œæ‰€ä»¥ç›¸æ¯”MNase-seqï¼ŒATAC-seqçš„æ ¸å°ä½“å ä½åˆ†æ<strong>éš¾åº¦æ›´é«˜</strong>ã€‚ä¸€èˆ¬æƒ…å†µï¼Œä¸ºMNase-seqå¼€å‘çš„è½¯ä»¶ï¼ˆæ¯”å¦‚<strong>DNAPOS2ã€PuFFINã€iNPS</strong>å’Œ<strong>NucTools</strong>ï¼‰å¯ç”¨äºATAC-seqã€‚ä¸“é—¨ä¸ºATAC-seqå¼€å‘çš„è½¯ä»¶åŒ…æ‹¬<strong>NuleoATAC</strong>å’Œ<strong>HMMRATAC</strong>ã€‚<strong>NuleoATAC</strong>æ¯”<strong>DANPOS2</strong>ç»“æœè¡¨ç°æ›´å¥½ï¼Œè€Œ<strong>HMMRATAC</strong>å¯ä»¥åŒæ—¶å®ŒæˆPeak Callingå’Œæ ¸å°ä½“å ä½åˆ†æã€‚<br>æ–‡ç« æ¨èæ ¸å°ä½“å ä½åˆ†æè½¯ä»¶ï¼š<strong>NuleoATAC</strong> <strong>&#x2F;HMMRATAC</strong><br>åº·æµ‹ç§‘æŠ€æ ¸å°ä½“å ä½åˆ†æè½¯ä»¶ï¼š<strong>Samtoolsè‡ªç¼–è„šæœ¬</strong></p><blockquote><p> ATAC-seqä¸å¤šç»„å­¦æ•°æ®è”åˆåˆ†æ</p></blockquote><ol><li><strong>è½¬å½•å› å­ChIP-seq</strong>ï¼šå¤§éƒ¨åˆ†è½¬å½•å› å­ç»“åˆæŸ“è‰²è´¨å¼€æ”¾åŒºåŸŸï¼Œæ‰€ä»¥ATAC-seqçš„Peakå¯èƒ½å’Œè½¬å½•å› å­ChIP-seqçš„Peakå­˜åœ¨éƒ¨åˆ†é‡å ï¼Œè€Œä¸”ATAC-seqå¾—åˆ°çš„Peaké•¿åº¦å¾€å¾€æ›´é•¿ï¼Œå› æ­¤ATAC-seqæ•°æ®å’Œè½¬å½•å› å­ChIP-seqæ•°æ®å¯ä»¥<font color="red"><strong>ç›¸äº’éªŒè¯</strong></font>ã€‚è½¬å½•å› å­åœ¨<strong>ChIP-seqä¸­ç‹¬æœ‰</strong>çš„Peakæš—ç¤ºè¿™ä¸ªè½¬å½•å› å­<strong>å¯èƒ½ç»“åˆåœ¨å¼‚æŸ“è‰²è´¨åŒºåŸŸ</strong>çš„<strong>é©±åŠ¨å‹è½¬å½•å› å­</strong>ï¼ˆPioneer TFsï¼‰ï¼Œ<font color="red"><strong>é©±åŠ¨å‹è½¬å½•å› å­</strong>éšåæ‹›å‹Ÿ<strong>æŸ“è‰²è´¨é‡å¡‘å¤åˆä½“</strong>ä»¥åŠå…¶å®ƒè½¬å½•å› å­å¼€å§‹è½¬å½•</font>ã€‚è”åˆåˆ†ææŠ¥é“ChIP-seqæ•°æ®å¯æ›´å‡†ç¡®åœ°åˆ†æè½¬å½•å› å­çš„è¶³è¿¹ã€‚</li><li><strong>ç»„è›‹ç™½ä¿®é¥°ChIP-seq</strong>ï¼šATAC-seqåŒæ ·å¯ä»¥å’Œ<font color="red"><strong>ç»„è›‹ç™½ä¿®é¥°ChIP-seq</strong></font>è”åˆåˆ†æï¼Œå…¶ä¸­<font color="red">è½¬å½•<strong>æ¿€æ´»</strong>æ€§ä¿®é¥°ï¼ˆH3K4me3ï¼ŒH3K4me1å’ŒH3K27acç­‰ï¼‰</font>ä¸æŸ“<strong>è‰²è´¨å¼€æ”¾ç¨‹åº¦å‘ˆæ­£ç›¸å…³</strong>ï¼Œ<font color="red">è½¬å½•<strong>æŠ‘åˆ¶</strong>æ€§ä¿®é¥°ï¼ˆH3K27me3ï¼‰</font>ä¸æŸ“è‰²è´¨å¼€æ”¾ç¨‹åº¦å‘ˆ<strong>è´Ÿç›¸å…³</strong>ã€‚è”åˆå·²çŸ¥çš„<strong>å¢å¼ºå­å’Œå¯åŠ¨å­ä¹‹é—´çš„ç›¸äº’ä½œç”¨</strong>æ•°æ®ä¹Ÿå¯ä»¥å¸®åŠ©<strong>æ„å»ºè°ƒæ§ç½‘ç»œ</strong>ã€‚</li><li><strong>RNA-seq</strong>ï¼šATAC-seqé€šè¿‡è”åˆRNA-seqå‘ç°å“ªäº›<font color="red">å·®å¼‚è¡¨è¾¾çš„åŸºå› </font>æ˜¯<font color="red">å—æŸ“è‰²è´¨å¯åŠæ€§è°ƒæ§çš„</font>ï¼Œè¿›ä¸€æ­¥æ¨æµ‹è¿™äº›å·®å¼‚è¡¨è¾¾åŸºå› <font color="red">å“ªäº›æ˜¯å—å¼€æ”¾æŸ“è‰²è´¨ä¸­<strong>å…·æœ‰motifå’Œfootprint</strong>çš„è½¬å½•å› å­è°ƒæ§</font>ï¼Œå› æ­¤ATAC-seqä¸RNA-seqçš„è”åˆåˆ†ææœ‰åŠ©äºç ´è¯‘<strong>åŸºå› è°ƒæ§ç½‘ç»œ</strong>å’Œç»†èƒå¼‚è´¨æ€§ã€‚</li></ol><p>é€šè¿‡é‰´å®šæŸ“è‰²è´¨å¼€æ”¾åŒºåŸŸå¹¶<strong>ç»“åˆmotifä¿¡æ¯å’ŒåŸºå› è¡¨è¾¾ä¿¡æ¯</strong>ï¼Œå»ºç«‹<strong>è½¬å½•å› å­-é¶åŸºå› </strong>çš„äº’ä½œç½‘ç»œã€‚</p><blockquote><p>æ€»ç»“</p></blockquote><p>è¯¥reviewç³»ç»Ÿæè¿°ATAC-seqç”Ÿä¿¡åˆ†æä¸»è¦æµç¨‹ï¼Œå¹¶æ¨èç›¸å…³è½¯ä»¶ï¼š<strong>FastQC</strong>è´¨æ§ï¼›<strong>trimmomatic</strong>å»é™¤ä½è´¨é‡ç¢±åŸºå’Œæ¥å¤´åºåˆ—ï¼›<strong>BWA-MEM</strong>æ¯”å¯¹ï¼›<strong>MACS2</strong> Peak Callingï¼›<strong>csaw</strong>å·®å¼‚Peakåˆ†æï¼›<strong>MEME-CentriMo</strong>å¯»æ‰¾motifä»¥åŠå¯Œé›†åˆ†æï¼›<strong>ChIPseeker</strong> Peakæ³¨é‡Šå’Œå¯è§†åŒ–ï¼›<strong>HMMRATAC</strong>åˆ†ææ ¸å°ä½“å ä½ï¼›<strong>HINT-ATAC</strong>è½¬å½•å› å­Footprintåˆ†æã€‚</p><p>åº·æµ‹ç§‘æŠ€ç¨æœ‰ä¸åŒï¼šå¼•å…¥<strong>IDR</strong>åˆ¤æ–­Peakå¯ä¿¡åº¦ï¼›å·®å¼‚Peakåˆ†æä½¿ç”¨<strong>bedtools</strong>å’Œå•ç‹¬çš„<strong>edgeR</strong>åŒ…ç»“åˆè‡ªç¼–è„šæœ¬æé«˜å·®å¼‚Peakåˆ†æä¸­å‚æ•°è®¾ç½®è‡ªç”±åº¦ï¼Œå¾—åˆ°å‡†ç¡®åº¦å’Œå¯ä¿¡åº¦æ›´é«˜çš„åˆ†æç»“æœã€‚</p><p><img src="/GeekFocus/2022-03-20-ATAC-seq-6/6.png" alt="img"><br><img src="/GeekFocus/img/2022-03-20-ATAC-seq-6/6.png" alt="img"></p><hr><p><a href="https://www.jianshu.com/p/09e05bcd6981">Ref3</a></p><blockquote><p>æ¯”å¯¹</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs sh">bowtie2  -p 5  --very-sensitive -X 2000 -x  <span class="hljs-variable">$bowtie2_index</span> -1 <span class="hljs-variable">$fq1</span> -2 <span class="hljs-variable">$fq2</span> |samtools <span class="hljs-built_in">sort</span>  -O bam  -@ 5 -o - &gt; <span class="hljs-variable">$&#123;sample&#125;</span>.raw.bam<br><br>samtools index <span class="hljs-variable">$&#123;sample&#125;</span>.raw.bam<br>bedtools bamtobed -i <span class="hljs-variable">$&#123;sample&#125;</span>.raw.bam  &gt; <span class="hljs-variable">$&#123;sample&#125;</span>.raw.bed<br>samtools flagstat <span class="hljs-variable">$&#123;sample&#125;</span>.raw.bam  &gt; <span class="hljs-variable">$&#123;sample&#125;</span>.raw.stat<br><span class="hljs-comment"># https://github.com/biod/sambamba/issues/177</span><br><span class="hljs-comment"># ä¸‰ç§ä¸åŒçš„å»é‡å¤è½¯ä»¶</span><br><span class="hljs-comment"># è¿™é‡Œé€‰ç”¨sambambaæ¥å»é‡å¤</span><br>sambamba markdup --overflow-list-size 600000  --tmpdir=<span class="hljs-string">&#x27;./&#x27;</span>  -r <span class="hljs-variable">$&#123;sample&#125;</span>.raw.bam  <span class="hljs-variable">$&#123;sample&#125;</span>.rmdup.bam<br>samtools index   <span class="hljs-variable">$&#123;sample&#125;</span>.rmdup.bam<br>samtools flagstat  <span class="hljs-variable">$&#123;sample&#125;</span>.rmdup.bam &gt; <span class="hljs-variable">$&#123;sample&#125;</span>.rmdup.stat<br><br><span class="hljs-comment">## ref:https://www.biostars.org/p/170294/ </span><br><span class="hljs-comment">## Calculate %mtDNA:</span><br>mtReads=$(samtools idxstats  <span class="hljs-variable">$&#123;sample&#125;</span>.rmdup.bam | grep <span class="hljs-string">&#x27;chrM&#x27;</span> | <span class="hljs-built_in">cut</span> -f 3)<br>totalReads=$(samtools idxstats  <span class="hljs-variable">$&#123;sample&#125;</span>.rmdup.bam | awk <span class="hljs-string">&#x27;&#123;SUM += $3&#125; END &#123;print SUM&#125;&#x27;</span>)<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;==&gt; mtDNA Content:&#x27;</span> $(bc &lt;&lt;&lt; <span class="hljs-string">&quot;scale=2;100*<span class="hljs-variable">$mtReads</span>/<span class="hljs-variable">$totalReads</span>&quot;</span>)<span class="hljs-string">&#x27;%&#x27;</span><br><br><span class="hljs-comment">## ä¿ç•™ä¸¤æ¡readsæ¯”å¯¹åˆ°åŒä¸€æ¡æŸ“è‰²ä½“(Proper paired) ï¼Œè¿˜æœ‰é«˜è´¨é‡çš„æ¯”å¯¹ç»“æœ(Mapping quality&gt;=30)</span><br><span class="hljs-comment">## é¡ºä¾¿è¿‡æ»¤ çº¿ç²’ä½“reads</span><br>samtools view  -h  -f 2 -q 30    <span class="hljs-variable">$&#123;sample&#125;</span>.rmdup.bam   |grep -v chrM |samtools <span class="hljs-built_in">sort</span>  -O bam  -@ 5 -o - &gt; <span class="hljs-variable">$&#123;sample&#125;</span>.last.bam<br><br>samtools index   <span class="hljs-variable">$&#123;sample&#125;</span>.last.bam<br>samtools flagstat  <span class="hljs-variable">$&#123;sample&#125;</span>.last.bam &gt; <span class="hljs-variable">$&#123;sample&#125;</span>.last.stat<br><br><span class="hljs-comment"># è½¬bed æ–‡ä»¶ ç”¨MACS2 shift extend model</span><br>bedtools bamtobed -i <span class="hljs-variable">$&#123;sample&#125;</span>.last.bam  &gt; <span class="hljs-variable">$&#123;sample&#125;</span>.bed<br></code></pre></td></tr></table></figure><blockquote><p>Deeptools å¯è§†åŒ–</p></blockquote><p><strong>bamè½¬bw</strong></p><p><a href="https://deeptools.readthedocs.io/en/develop/content/tools/bamCoverage.html">bamCoverage</a></p><p><font color="red"><strong>â€“normalizeUsing</strong></font></p><p>Possible choices: RPKM, CPM, BPM, RPGC, None</p><p>Use one of the entered methods to normalize the number of reads per bin. By <strong>default, no normalization</strong> is performed. <strong>RPKM</strong> &#x3D; Reads Per Kilobase per Million mapped reads; <strong>CPM</strong> &#x3D; Counts Per Million mapped reads, same as CPM in RNA-seq; <strong>BPM</strong> &#x3D; Bins Per Million mapped reads, same as <strong>TPM</strong> in RNA-seq; <strong>RPGC</strong> &#x3D; reads per genomic content (1x normalization); Mapped reads <strong>are considered after blacklist filtering?</strong> (if applied). </p><p>RPKM (per bin) &#x3D; number of reads per bin &#x2F; (number of mapped reads (in millions) * bin length (kb)). </p><p>CPM (per bin) &#x3D; number of reads per bin &#x2F; number of mapped reads (in millions). BPM (per bin) &#x3D; number of reads per bin &#x2F; sum of all reads per bin (in millions). </p><p>RPGC (per bin) &#x3D; number of reads per bin &#x2F; scaling factor for 1x average coverage. None &#x3D; the default and equivalent to not setting this option at all. This scaling factor, in turn, is determined from the sequencing depth: (total number of mapped reads * fragment length) &#x2F; effective genome size. The scaling factor used is the inverse of the sequencing depth computed for the sample to match the 1x coverage. This option requires â€“effectiveGenomeSize. Each read is considered independently, if you want to only count one mate from a pair in paired-end data, then use the â€“samFlagInclude&#x2F;â€“samFlagExclude options. (Default: None)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span>  ~/project/atac/deeptools_result<br><br><span class="hljs-comment">###æ„å»ºç´¢å¼•</span><br><span class="hljs-built_in">ls</span>  *.bam  |xargs -i samtools index &#123;&#125;<br><span class="hljs-comment">###å°†æœ€ç»ˆçš„bamè½¬æ¢æˆbigwigæ–‡ä»¶</span><br><span class="hljs-built_in">ls</span> *last.bam |<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> <span class="hljs-built_in">id</span>;<span class="hljs-keyword">do</span><br><span class="hljs-built_in">nohup</span> bamCoverage -b <span class="hljs-variable">$&#123;id&#125;</span> -p 5 --normalizeUsing RPKM  -o <span class="hljs-variable">$&#123;id%%.*&#125;</span>.last.bw &amp;<br><span class="hljs-keyword">done</span><br><span class="hljs-comment">###å°†å»é‡çš„bamè½¬æ¢æˆbigwigæ–‡ä»¶</span><br><span class="hljs-comment"># cd dup </span><br><span class="hljs-built_in">ls</span>  *.bam  |xargs -i samtools index &#123;&#125; <br><span class="hljs-built_in">ls</span> *rmdup.bam |<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> <span class="hljs-built_in">id</span>;<span class="hljs-keyword">do</span><br><span class="hljs-built_in">nohup</span> bamCoverage --normalizeUsing CPM -b <span class="hljs-variable">$id</span> -o <span class="hljs-variable">$&#123;id%%.*&#125;</span>.rm.bw &amp; <br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹TSSé™„ä»¶ä¿¡å·å¼ºåº¦ï¼ˆæ¿€æ´»markerï¼Œ27acï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">## both -R and -S can accept multiple files </span><br><span class="hljs-built_in">mkdir</span> -p  ~/project/atac/tss<br><span class="hljs-built_in">cd</span>   ~/project/atac/tss <br><span class="hljs-comment"># source activate atac # ç”±äºæˆ‘è¿™é‡Œè‡ªå·±ç³»ç»Ÿæœ‰å°±æ²¡è°ƒç”¨äº†</span><br>computeMatrix reference-point  --referencePoint TSS  -p 15  \<br>-b 10000 -a 10000    \<br>-R ~/project/atac/mm10_Refgene/Refseq.bed  \<br>-S ~/project/atac/deeptools_result/*.bw  \<br>--skipZeros  -o matrix1_test_TSS.gz  \<br>--outFileSortedRegions regions1_test_genes.bed<br><br><span class="hljs-comment">##     both plotHeatmap and plotProfile will use the output from   computeMatrix</span><br>plotHeatmap -m matrix1_test_TSS.gz  -out test_Heatmap.png<br>plotHeatmap -m matrix1_test_TSS.gz  -out test_Heatmap.pdf --plotFileFormat pdf  --dpi 720  <br>plotProfile -m matrix1_test_TSS.gz  -out test_Profile.png<br>plotProfile -m matrix1_test_TSS.gz  -out test_Profile.pdf --plotFileFormat pdf --perGroup --dpi 720 <br></code></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹åŸºå› bodyçš„ä¿¡å·å¼ºåº¦ï¼ˆæŠ‘åˆ¶markerï¼Œ27me3ï¼‰</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#source activate atac</span><br><span class="hljs-built_in">mkdir</span> Body<br><span class="hljs-built_in">cd</span> ~/project/atac/Body<br>computeMatrix scale-regions  -p 15  \<br>-R ~/project/atac/mm10_Refgene/Refseq.bed  \<br>-S ~/project/atac/deeptools_result/*.bw  \<br>-b 10000 -a 10000  \<br>--skipZeros -o matrix1_test_body.gz<br><span class="hljs-comment"># plotHeatmap -m matrix1_test_body.gz  -out ExampleHeatmap1.png</span><br>plotHeatmap -m matrix1_test_body.gz  -out test_body_Heatmap.png<br>plotProfile -m matrix1_test_body.gz  -out test_body_Profile.png<br>plotProfile -m matrix1_test_body.gz -out test_Body_Profile.pdf --plotFileFormat pdf --perGroup --dpi 720<br></code></pre></td></tr></table></figure><ul><li>â€“regionBodyLength #è°ƒæ•´genebodyåŒºåŸŸ</li><li>â€“binSize</li></ul><blockquote><p>call peak</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#macs2 callpeak -t 2-cell-1.bed  -g mm --nomodel --shift -100 --extsize 200  -n 2-cell-1 --outdir ../peaks/</span><br><span class="hljs-built_in">cd</span> ~/project/atac/peaks/<br><span class="hljs-built_in">ls</span> *.bed | <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> <span class="hljs-built_in">id</span> ;<span class="hljs-keyword">do</span> (macs2 callpeak -t <span class="hljs-variable">$id</span>  -g mm --nomodel --<span class="hljs-built_in">shift</span>  -100 --extsize 200  -n <span class="hljs-variable">$&#123;id%%.*&#125;</span> --outdir ./) ;<span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><blockquote><p> è®¡ç®—æ’å…¥ç‰‡æ®µé•¿åº¦ï¼ŒFRiPå€¼ï¼ŒIDRè®¡ç®—é‡å¤æƒ…å†µ</p></blockquote><ul><li>éå†—ä½™éçº¿ç²’ä½“èƒ½å¤Ÿæ¯”å¯¹çš„fragmentã€æ¯”å¯¹ç‡ã€NRFã€PBC1ã€PBC2ã€peakæ•°ã€æ— æ ¸å°ä½“åŒºNFRã€TSSå¯Œé›†ã€FRiP ã€IDRé‡å¤çš„ä¸€è‡´æ€§ï¼</li></ul><p><strong>ç»Ÿè®¡indelæ’å…¥é•¿åº¦çš„åˆ†å¸ƒ</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#åˆ›å»ºæå–bamæ–‡ä»¶çš„ç¬¬ä¹åˆ—indelæ’å…¥é•¿åº¦ä¿¡æ¯çš„shæ–‡ä»¶ indel_length.shï¼Œå†…å®¹å¦‚ä¸‹ï¼š</span><br><span class="hljs-built_in">cat</span> config.last_bam |<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> <span class="hljs-built_in">id</span>;<br><span class="hljs-keyword">do</span><br>arr=(<span class="hljs-variable">$id</span>)<br>sample=<span class="hljs-variable">$&#123;arr[0]&#125;</span><br>sample_name=<span class="hljs-variable">$&#123;arr[1]&#125;</span><br>samtools view <span class="hljs-variable">$sample</span> |awk <span class="hljs-string">&#x27;&#123;print $9&#125;&#x27;</span>  &gt; <span class="hljs-variable">$&#123;sample_name&#125;</span>_length.txt<br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#indel_length_distribution.sh</span><br>md<span class="hljs-operator">=</span>commandArgs<span class="hljs-punctuation">(</span>trailingOnly<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span>; <br>input<span class="hljs-operator">=</span>cmd<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span>; output<span class="hljs-operator">=</span>cmd<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span>; <br>a<span class="hljs-operator">=</span><span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>read.table<span class="hljs-punctuation">(</span>input<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>; <br>png<span class="hljs-punctuation">(</span>file<span class="hljs-operator">=</span>output<span class="hljs-punctuation">)</span>;<br>hist<span class="hljs-punctuation">(</span>a<span class="hljs-punctuation">,</span><br>main<span class="hljs-operator">=</span><span class="hljs-string">&quot;Insertion Size distribution&quot;</span><span class="hljs-punctuation">,</span><br>ylab<span class="hljs-operator">=</span><span class="hljs-string">&quot;Read Count&quot;</span><span class="hljs-punctuation">,</span>xlab<span class="hljs-operator">=</span><span class="hljs-string">&quot;Insert Size&quot;</span><span class="hljs-punctuation">,</span><br>xaxt<span class="hljs-operator">=</span><span class="hljs-string">&quot;n&quot;</span><span class="hljs-punctuation">,</span><br>breaks<span class="hljs-operator">=</span>seq<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">max</span><span class="hljs-punctuation">(</span>a<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">)</span>; <br><br>axis<span class="hljs-punctuation">(</span>side<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>at<span class="hljs-operator">=</span>seq<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">max</span><span class="hljs-punctuation">(</span>a<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>labels<span class="hljs-operator">=</span>seq<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">max</span><span class="hljs-punctuation">(</span>a<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">)</span>;<br><br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <br></code></pre></td></tr></table></figure><p><strong>FRiPå€¼çš„è®¡ç®—ï¼šfraction of reads in called peak regions</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">bedtools intersect -a 2-cell-1.bed -b 2-cell-1_peaks.narrowPeak |<span class="hljs-built_in">wc</span> -l<br>148210<br><span class="hljs-built_in">wc</span>  -l 2-cell-1.bed<br>5105850 <br><span class="hljs-comment"># æ•…2-cell-1çš„FRiPä¸º</span><br>148210/5105850 = 0.0292<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> ~/project/atac/peaks<br><span class="hljs-built_in">ls</span> *narrowPeak|<span class="hljs-keyword">while</span>  <span class="hljs-built_in">read</span> <span class="hljs-built_in">id</span>;<br><span class="hljs-keyword">do</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$id</span><br>bed=$(<span class="hljs-built_in">basename</span> <span class="hljs-variable">$id</span> <span class="hljs-string">&quot;_peaks.narrowPeak&quot;</span>).bed<br><span class="hljs-comment">#ls  -lh $bed </span><br>Reads=$(bedtools intersect -a <span class="hljs-variable">$bed</span> -b <span class="hljs-variable">$id</span> |<span class="hljs-built_in">wc</span> -l|awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span>)<br>totalReads=$(<span class="hljs-built_in">wc</span> -l <span class="hljs-variable">$bed</span>|awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span>)<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$Reads</span>  <span class="hljs-variable">$totalReads</span> <br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;==&gt; FRiP value:&#x27;</span> $(bc &lt;&lt;&lt; <span class="hljs-string">&quot;scale=2;100*<span class="hljs-variable">$Reads</span>/<span class="hljs-variable">$totalReads</span>&quot;</span>)<span class="hljs-string">&#x27;%&#x27;</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><p>Fraction of reads in peaks (FRiP) - Fraction of all mapped reads that fall into the called peak regions, i.e. usable reads in significantly enriched peaks divided by all usable reads. In general, FRiP scores correlate positively with the number of regions. (Landt et al, Genome Research Sept. 2012, 22(9): 1813â€“1831)<br><strong>ä½¿ç”¨RåŒ…çœ‹ä¸åŒpeaksæ–‡ä»¶çš„overlapæƒ…å†µ</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs r">options<span class="hljs-punctuation">(</span>BioC_mirror<span class="hljs-operator">=</span><span class="hljs-string">&quot;https://mirrors.ustc.edu.cn/bioc/&quot;</span><span class="hljs-punctuation">)</span> <br>options<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;repos&quot;</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span>CRAN<span class="hljs-operator">=</span><span class="hljs-string">&quot;https://mirrors.tuna.tsinghua.edu.cn/CRAN/&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>source<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;http://bioconductor.org/biocLite.R&quot;</span><span class="hljs-punctuation">)</span> <br>library<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;BiocInstaller&#x27;</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment"># biocLite(&quot;ChIPpeakAnno&quot;)</span><br><span class="hljs-comment"># biocLite(&quot;ChIPseeker&quot;)</span><br>library<span class="hljs-punctuation">(</span>ChIPseeker<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>ChIPpeakAnno<span class="hljs-punctuation">)</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E://desktop/sept/ATAC-seq_practice/find_peaks_overlaping/&quot;</span><span class="hljs-punctuation">)</span><br>list.files<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;./&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;*.narrowPeak&quot;</span><span class="hljs-punctuation">)</span><br>tmp <span class="hljs-operator">=</span> lapply<span class="hljs-punctuation">(</span>list.files<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;./&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;*.narrowPeak&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span>readPeakFile<span class="hljs-punctuation">(</span>file.path<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;./&#x27;</span><span class="hljs-punctuation">,</span> x<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">)</span><br>tmp<br>ol <span class="hljs-operator">&lt;-</span> findOverlapsOfPeaks<span class="hljs-punctuation">(</span>tmp<span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>tmp<span class="hljs-punctuation">[[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-comment"># è¿™é‡Œé€‰å–çš„æ˜¯ç¬¬ä¸€ä¸ªæ–‡ä»¶å’Œç¬¬äºŒä¸ªæ–‡ä»¶ï¼Œå³cell.1_peak_1å’Œcell.2_peak</span><br>png<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;overlapVenn.png&#x27;</span><span class="hljs-punctuation">)</span><br>makeVennDiagram<span class="hljs-punctuation">(</span>ol<span class="hljs-punctuation">)</span><br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><strong>IDR è®¡ç®—ï¼ŒåŒæ—¶è€ƒè™‘peaksé—´çš„overlapï¼Œå’Œå¯Œé›†å€æ•°çš„ä¸€è‡´æ€§</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs sh">conda  create -n py3 -y   python=3 idr<br>conda activate py3<br>idr -h <br>idr --samples  2-cell-1_peaks.narrowPeak 2-cell-2_peaks.narrowPeak  --plot<br><br><span class="hljs-comment">###############---</span><br>idr --samples SRR2927018_peaks.narrowPeak SRR3545580_peaks.narrowPeak \<br>--input-file-type narrowPeak \<br>--rank p.value \<br>--output-file group2-idr \<br>--plot \<br>--log-output-file group2.idr.log<br><br><span class="hljs-built_in">ls</span> -lh group*|<span class="hljs-built_in">cut</span> -d <span class="hljs-string">&quot; &quot;</span> -f 5-<br><span class="hljs-comment"># 740K Apr 19 22:00 group1-idr</span><br><span class="hljs-comment">#  205 Apr 19 22:00 group1.idr.log</span><br><span class="hljs-comment"># 341K Apr 19 22:00 group1-idr.png</span><br><span class="hljs-comment"># 315K Apr 19 22:00 group2-idr</span><br><span class="hljs-comment">#  202 Apr 19 22:00 group2.idr.log</span><br><span class="hljs-comment"># 218K Apr 19 22:00 group2-idr.png</span><br><span class="hljs-built_in">cat</span> group1.idr.log<br><span class="hljs-comment"># Initial parameter values: [0.10 1.00 0.20 0.50]</span><br><span class="hljs-comment"># Final parameter values: [0.59 1.05 0.62 0.79]</span><br><span class="hljs-comment"># Number of reported peaks - 5869/5869 (100.0%)</span><br><span class="hljs-comment"># Number of peaks passing IDR cutoff of 0.05 - 1571/5869 (26.8%)</span><br><br><span class="hljs-built_in">cat</span> group2.idr.log<br><span class="hljs-comment"># Initial parameter values: [0.10 1.00 0.20 0.50]</span><br><span class="hljs-comment"># Final parameter values: [0.35 1.06 0.47 0.50]</span><br><span class="hljs-comment"># Number of reported peaks - 2505/2505 (100.0%)</span><br><span class="hljs-comment"># Number of peaks passing IDR cutoff of 0.05 - 38/2505 (1.5%)</span><br><br><span class="hljs-comment">#è¾“å‡ºæ ‡åˆ™è¡¨ç¤ºï¼š</span><br>å·¦ä¸Šï¼š Rep1 peak ranks vs Rep2 peak ranksï¼Œæ²¡æœ‰é€šè¿‡ç‰¹å®šIDRé˜ˆå€¼çš„peaksæ˜¾ç¤ºä¸ºçº¢è‰²ã€‚ å³ä¸Šï¼šRep1 log10 peak scores vs Rep2 log10 peak scoresï¼Œæ²¡æœ‰é€šè¿‡ç‰¹å®šIDRé˜ˆå€¼çš„peaksæ˜¾ç¤ºä¸ºçº¢è‰²ã€‚ ä¸‹é¢ä¸¤ä¸ªå›¾ï¼š Peak rank vs IDR scoresï¼Œç®±çº¿å›¾å±•ç¤ºäº†IDRå€¼çš„åˆ†å¸ƒï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒIDRå€¼çš„é˜ˆå€¼ä¸º-1E-6ã€‚<br></code></pre></td></tr></table></figure><blockquote><p>æ³¨é‡Š</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">options(BioC_mirror=<span class="hljs-string">&quot;https://mirrors.ustc.edu.cn/bioc/&quot;</span>) <br>options(<span class="hljs-string">&quot;repos&quot;</span> = c(CRAN=<span class="hljs-string">&quot;https://mirrors.tuna.tsinghua.edu.cn/CRAN/&quot;</span>))<br><span class="hljs-built_in">source</span>(<span class="hljs-string">&quot;http://bioconductor.org/biocLite.R&quot;</span>) <br>library(<span class="hljs-string">&#x27;BiocInstaller&#x27;</span>)<br>biocLite(<span class="hljs-string">&quot;ChIPpeakAnno&quot;</span>)<br>library(ChIPpeakAnno)<br>setwd(<span class="hljs-string">&quot;E://desktop/sept/ATAC-seq_practice/peaks_annotaion/&quot;</span>)<br>biocLite(<span class="hljs-string">&quot;TxDb.Mmusculus.UCSC.mm10.knownGene&quot;</span>)<br>biocLite(<span class="hljs-string">&quot;org.Mm.eg.db&quot;</span>)<br>txdb &lt;- TxDb.Mmusculus.UCSC.mm10.knownGene<br>promoter &lt;- getPromoters(TxDb=txdb, <br>                         upstream=3000, downstream=3000)<br>files = list(cell_1_summits = <span class="hljs-string">&quot;2-cell-1_summits.bed&quot;</span>, cell_2_summits = <span class="hljs-string">&quot;2-cell-2_summits.bed&quot;</span>,<br>                   cell_4_summits = <span class="hljs-string">&quot;2-cell-4_summits.bed&quot;</span>, cell_5_summits = <span class="hljs-string">&quot;2-cell-5_summits.bed&quot;</span>)<br>peakAnno &lt;- annotatePeak(files[[1]], <span class="hljs-comment"># åˆ†åˆ«æ”¹æˆ2æˆ–è€…3æˆ–è€…4å³å¯ï¼Œåˆ†åˆ«å¯¹åº”å››ä¸ªæ–‡ä»¶</span><br>                         tssRegion=c(-3000, 3000),<br>                         TxDb=txdb, annoDb=<span class="hljs-string">&quot;org.Hs.eg.db&quot;</span>)<br>plotAnnoPie(peakAnno)<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined">plotAnnoBar(peakAnno)<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined">vennpie(peakAnno)<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">upsetplot(peakAnno)<br>upsetplot(peakAnno, vennpie=TRUE)<br></code></pre></td></tr></table></figure><p><img src="/GeekFocus/2022-03-20-ATAC-seq-6/8.png" alt="img"></p><p>ChIPseekeræ³¨é‡Šæœ€è¿‘åŸºå› ï¼Œpeakç¦»æœ€è¿‘åŸºå› çš„è·ç¦»åˆ†å¸ƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">plotDistToTSS(peakAnno,<br>              title=<span class="hljs-string">&quot;Distribution of transcription factor-binding loci\nrelative to TSS&quot;</span>)<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">peakAnnoList &lt;- lapply(files, annotatePeak, <br>                       TxDb=txdb,tssRegion=c(-3000, 3000))<br>plotAnnoBar(peakAnnoList)<br></code></pre></td></tr></table></figure><p>ChIPseekeræä¾›äº†vennplotå‡½æ•°ï¼Œçœ‹æ³¨é‡Šçš„æœ€è¿‘åŸºå› åœ¨ä¸åŒæ ·æœ¬çš„overlap</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">genes &lt;- lapply(peakAnnoList, <span class="hljs-keyword">function</span>(i) <br>    as.data.frame(i)<span class="hljs-variable">$geneId</span>)<br>vennplot(genes[2:4], by=<span class="hljs-string">&#x27;Vennerable&#x27;</span>)<br></code></pre></td></tr></table></figure><blockquote><p>Motif å¯»æ‰¾ æ³¨é‡Š</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># mkdir -p  ~/project/atac/motif</span><br><span class="hljs-built_in">cd</span>   ~/project/atac/motif<br><span class="hljs-comment"># source activate atac</span><br><span class="hljs-built_in">ls</span> ../peaks/*.narrowPeak |<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> <span class="hljs-built_in">id</span>;<br><span class="hljs-keyword">do</span><br>file=$(<span class="hljs-built_in">basename</span> <span class="hljs-variable">$id</span> )<br>sample=<span class="hljs-variable">$&#123;file%%.*&#125;</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$sample</span> <br>awk <span class="hljs-string">&#x27;&#123;print $4&quot;\t&quot;$1&quot;\t&quot;$2&quot;\t&quot;$3&quot;\t+&quot;&#125;&#x27;</span> <span class="hljs-variable">$id</span> &gt; <span class="hljs-variable">$&#123;sample&#125;</span>.homer_peaks.tmp<br><span class="hljs-built_in">nohup</span> findMotifsGenome.pl <span class="hljs-variable">$&#123;sample&#125;</span>.homer_peaks.tmp  mm10 <span class="hljs-variable">$&#123;sample&#125;</span>_motifDir -len 8,10,12  &amp;<br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><blockquote><p> å·®å¼‚peaksåˆ†æ</p></blockquote><p>diffbind, DESeq2</p>]]></content>
    
    
    <categories>
      
      <category>NGS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>atac-seq</tag>
      
      <tag>pipeline</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€bowtie2ã€‘</title>
    <link href="/GeekFocus/2022/03/20/2022-03-20-bowtie2/"/>
    <url>/GeekFocus/2022/03/20/2022-03-20-bowtie2/</url>
    
    <content type="html"><![CDATA[<p><strong>Bowtie 2</strong> is an ultrafast and memory-efficient tool for aligning sequencing reads to long reference sequences. It is particularly good at aligning reads of about <strong>50 up to 100s or 1,000s</strong> of characters, and particularly <strong>good at aligning to relatively long</strong> (e.g. mammalian) genomes. Bowtie 2 indexes the genome with an <strong>FM Index</strong> to keep its <strong>memory footprint small</strong>: for the human genome, its memory footprint is typically around 3.2 GB. Bowtie 2 supports <strong>gapped</strong>, <strong>local</strong>, and <strong>paired-end</strong> alignment modes.</p><span id="more"></span><p><a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml">http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml</a></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p><a href="http://bowtie-bio.sf.net/bowtie2">Bowtie 2</a> is an ultrafast and memory-efficient tool for aligning sequencing reads to long reference sequences. It is particularly good at aligning reads of about 50 up to 100s of characters to relatively long (e.g. mammalian) genomes. Bowtie 2 indexes the genome with an <a href="http://en.wikipedia.org/wiki/FM-index">FM Index</a> (based on the <a href="http://en.wikipedia.org/wiki/Burrows-Wheeler_transform">Burrows-Wheeler Transform</a> or <a href="http://en.wikipedia.org/wiki/Burrows-Wheeler_transform">BWT</a>) to keep its memory footprint small: for the human genome, its memory footprint is typically around 3.2 gigabytes of RAM. Bowtie 2 supports gapped, local, and paired-end alignment modes. Multiple processors can be used simultaneously to achieve greater alignment speed.</p><p>Bowtie 2 outputs alignments in <a href="http://samtools.sourceforge.net/SAM1.pdf">SAM</a> format, enabling interoperation with a large number of other tools (e.g. <a href="http://samtools.sourceforge.net/">SAMtools</a>, <a href="http://www.broadinstitute.org/gsa/wiki/index.php/The_Genome_Analysis_Toolkit">GATK</a>) that use SAM. Bowtie 2 is distributed under the <a href="http://www.gnu.org/licenses/gpl-3.0.html">GPLv3 license</a>, and it runs on the command line under Windows, Mac OS X and Linux and BSD.</p><p><a href="http://bowtie-bio.sf.net/bowtie2">Bowtie 2</a> is often the first step in pipelines for <font color="blue"><strong>comparative genomics</strong></font>, including for <font color="blue"><strong>variation calling, ChIP-seq, RNA-seq, BS-seq</strong></font>. <a href="http://bowtie-bio.sf.net/bowtie2">Bowtie 2</a> and <a href="http://bowtie-bio.sf.net/">Bowtie</a>(also called â€œ<a href="http://bowtie-bio.sf.net/">Bowtie 1</a>â€œ here) are also tightly integrated into many other tools, some of which <a href="http://bowtie-bio.sourceforge.net/bowtie2/other_tools.shtml">are listed here</a>.</p><p>If you use <a href="http://bowtie-bio.sf.net/bowtie2">Bowtie 2</a> for your published research, please cite our work. Papers describing Bowtie 2 are:</p><ul><li>Langmead B, Wilks C, Antonescu V, Charles R. <a href="https://doi.org/10.1093/bioinformatics/bty648">Scaling read aligners to hundreds of threads on general-purpose processors</a>. <em>Bioinformatics</em>. 2018 Jul 18. doi: 10.1093&#x2F;bioinformatics&#x2F;bty648.</li><li>Langmead B, Salzberg SL. <a href="https://www.nature.com/articles/nmeth.1923">Fast gapped-read alignment with Bowtie 2</a>. <em>Nature Methods</em>. 2012 Mar 4;9(4):357-9. doi: 10.1038&#x2F;nmeth.1923.</li></ul><h2 id="How-is-Bowtie-2-different-from-Bowtie-1"><a href="#How-is-Bowtie-2-different-from-Bowtie-1" class="headerlink" title="How is Bowtie 2 different from Bowtie 1?"></a>How is Bowtie 2 different from Bowtie 1?</h2><p><font color="blue"><strong>Bowtie 1</strong></font> was released in 2009 and was geared toward <strong>aligning the relatively short sequencing reads</strong> (up to <strong>25-50 nucl</strong>eotides) prevalent at the time. Since then, technology has improved both sequencing throughput (more nucleotides produced per sequencer per day) and read length (more nucleotides per read).</p><p>The chief differences between Bowtie 1 and Bowtie 2 are:</p><ol><li>For reads <strong>longer than about 50 bp</strong> Bowtie 2 is generally <strong>faster</strong>, more <strong>sensitive</strong>, and uses <strong>less memory</strong> than Bowtie 1. For relatively short reads (e.g. <strong>less than 50 bp) Bowtie 1</strong> is sometimes <strong>faster</strong> and&#x2F;or more <strong>sensitive</strong>.</li><li>Bowtie 2 <strong>supports gapped alignment</strong> with affine gap penalties. Number of gaps and gap lengths are not restricted, except by way of the configurable scoring scheme. <strong>Bowtie 1</strong> finds just <strong>ungapped alignments</strong>.</li><li>Bowtie 2 <strong>supports</strong> <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#end-to-end-alignment-versus-local-alignment"><strong>local alignment</strong></a>, which doesnâ€™t require reads to align end-to-end. Local alignments might be â€œtrimmedâ€ (â€œsoft clippedâ€) at one or both extremes in a way that optimizes alignment score. Bowtie 2 <strong>also supports</strong> <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#end-to-end-alignment-versus-local-alignment">end-to-end alignment</a> which, like <strong>Bowtie 1, requires that the read align entirely.</strong></li><li>There is <strong>no upper limit on read length</strong> in <strong>Bowtie 2</strong>. Bowtie 1 had an upper limit of around 1000 bp.</li><li>Bowtie 2 <strong>allows</strong> alignments to <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#ambiguous-characters">overlap ambiguous characters</a> (e.g. <code>N</code>s) in the reference. Bowtie 1 does not.</li><li>Bowtie 2 does away with Bowtie 1â€™s notion of alignment â€œstratumâ€, and its distinction between â€œMaq-likeâ€ and â€œend-to-endâ€ modes. In Bowtie 2 all alignments <strong>lie along a continuous spectrum of alignment scores</strong> where the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#scores-higher-more-similar">scoring scheme</a>, <strong>similar to</strong> <a href="http://en.wikipedia.org/wiki/Needleman-Wunsch_algorithm">Needleman-Wunsch</a> and <a href="http://en.wikipedia.org/wiki/Smith_waterman">Smith-Waterman</a>.</li><li>Bowtie 2â€™s <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#aligning-pairs">paired-end alignment</a> is <strong>more flexible</strong>. E.g. for pairs that do not align in a paired fashion, Bowtie 2 attempts to <strong>find unpaired alignments for each mate</strong>.</li><li>Bowtie 2 <strong>reports</strong> a spectrum of <strong>mapping qualities</strong>, in contrast for Bowtie 1 which reports either 0 or high.</li><li>Bowtie 2 does not align <strong>colorspace reads?</strong>.</li></ol><p>Bowtie 2 is not a â€œdrop-inâ€ replacement for Bowtie 1. Bowtie 2â€™s command-line <strong>arguments and genome index format are both different</strong> from Bowtie 1â€™s.</p><h2 id="What-isnâ€™t-Bowtie-2"><a href="#What-isnâ€™t-Bowtie-2" class="headerlink" title="What isnâ€™t Bowtie 2?"></a>What isnâ€™t Bowtie 2?</h2><p>Bowtie 2 is geared toward aligning relatively short sequencing reads to long genomes. That said, it handles arbitrarily small reference sequences (e.g. amplicons) and very long reads (i.e. upwards of 10s or 100s of kilobases), though it is slower in those settings. It is optimized for the read lengths and error modes yielded by typical Illumina sequencers.</p><p>Bowtie 2 <strong>does not support</strong> alignment of colorspace reads. (Bowtie 1 does.)</p><h1 id="Obtaining-Bowtie-2"><a href="#Obtaining-Bowtie-2" class="headerlink" title="Obtaining Bowtie 2"></a>Obtaining Bowtie 2</h1><p>Bowtie 2 is available from various package managers, notably <a href="https://anaconda.org/bioconda/bowtie2">Bioconda</a>. With Bioconda installed, you should be able to install Bowtie 2 with <code>conda install bowtie2</code>.</p><p>Containerized versions of Bowtie 2 are also available via the <a href="https://biocontainers.pro/">Biocontainers</a> project (e.g. <a href="https://hub.docker.com/r/biocontainers/bowtie2/">via Docker Hub</a>).</p><p>You can also download Bowtie 2 sources and binaries from the <a href="https://sourceforge.net/projects/bowtie-bio/files/bowtie2/">Download</a> section of the Sourceforge site. <strong>Binaries</strong> are available for the <code>x86_64</code>architecture running Linux, Mac OS X, and Windows.  If you plan to <strong>compile Bowtie 2 yourself</strong>, make sure to get the <strong>source package</strong>, i.e., the filename that ends in â€œ-source.zipâ€.</p><h2 id="Building-from-source"><a href="#Building-from-source" class="headerlink" title="Building from source"></a>Building from source</h2><p>Building from source</p><p>Unzip the <strong>-source.zip</strong>, change to the unzipped directory, and build the Bowtie 2 tools by running GNU <code>make</code> (usually with the command <code>make</code>, but sometimes with <code>gmake</code>) with no arguments. </p><p>The Bowtie 2 Makefile also includes recipes for basic automatic dependency management. Running <code>make static-libs &amp;&amp; make STATIC_BUILD=1</code>will issue a series of commands that will: 1. download <strong>zstd</strong> and <strong>zlib 2</strong>. compile them as static libraries 3. <strong>link the resulting libraries to the compiled Bowtie 2 binaries</strong></p><p>As of version 2.3.5 bowtie2 now <strong>supports aligning SRA reads</strong>. Prepackaged builds will include a package that supports SRA. If youâ€™re building bowtie2 from source please make sure that the Java runtime is available on your system. You can then proceed with the build by running <code>make sra-deps &amp;&amp; make USE_SRA=1</code>.</p><h1 id="The-bowtie2-aligner"><a href="#The-bowtie2-aligner" class="headerlink" title="The bowtie2 aligner"></a>The <code>bowtie2</code> aligner</h1><p><code>bowtie2</code> takes a Bowtie 2 <strong>index</strong> and a set of sequencing <strong>read</strong> files and outputs a set of alignments in <strong>SAM</strong> format.</p><p>â€œAlignmentâ€ is the process by which we discover <strong>how and where the read sequences are similar to the reference</strong> sequence. An â€œalignmentâ€ is a result from this process, specifically: an alignment is a way of â€œlining upâ€ some or all of the characters in the read with some characters from the reference in a way that reveals how theyâ€™re similar. For example:</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">Read:      GACTGGGCGATCTCGACTTCG<br>           |||||<span class="hljs-string">  </span>||||||||||<span class="hljs-string"> </span>|||<br>Reference: GACTG--CGATCTCGACATCG<br></code></pre></td></tr></table></figure><p>Where dash symbols represent <strong>gaps</strong> and <strong>vertical bars</strong> show where aligned characters <strong>match</strong>.</p><p>We use alignment to <strong>make an educated guess</strong> as to where a read originated with respect to the reference genome. <strong>Itâ€™s not always possible to determine this with certainty</strong>. For instance, if the reference genome contains several long stretches of As (<code>AAAAAAAAA</code> etc.) and the read sequence is a short stretch of As (<code>AAAAAAA</code>), we cannot know for certain exactly where in the sea of <code>A</code>s the read originated.</p><h2 id="End-to-end-alignment-versus-local-alignment"><a href="#End-to-end-alignment-versus-local-alignment" class="headerlink" title="End-to-end alignment versus local alignment"></a>End-to-end alignment versus local alignment</h2><p><font color="blue">By default, Bowtie 2 performs <strong>end-to-end</strong> read alignment</font>. That is, it searches for alignments involving all of the read characters. This is also called an â€œuntrimmedâ€ or â€œunclippedâ€ alignment.</p><p>When the <font color="blue"><strong>â€“local option</strong></font> is specified, Bowtie 2 performs local read alignment. In this mode, Bowtie 2 <font color="blue">might â€œtrimâ€ or â€œclipâ€ some read characters from one or both ends of the alignment</font> if doing so maximizes the alignment score.</p><h3 id="End-to-end-alignment-example"><a href="#End-to-end-alignment-example" class="headerlink" title="End-to-end alignment example"></a>End-to-end alignment example</h3><p>The following is an â€œend-to-endâ€ alignment because it involves all the characters in the read. Such an alignment can be produced by Bowtie 2 in either end-to-end mode or in local mode.</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">Read:</span>      GACTGGGCGATCTCGACTTCG<br><span class="hljs-symbol">Reference:</span> GACTGCGATCTCGACATCG<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">Alignment:</span><br><span class="hljs-symbol">  Read:</span>      GACTGGGCGATCTCGACTTCG<br>             |||||  |||||||||| |||<br><span class="hljs-symbol">  Reference:</span> GACTG--CGATCTCGACATCG<br></code></pre></td></tr></table></figure><h3 id="Local-alignment-example"><a href="#Local-alignment-example" class="headerlink" title="Local alignment example"></a>Local alignment example</h3><p>The following is a â€œlocalâ€ alignment because <font color="blue">some of the characters <strong>at the ends of the read do not participate</strong></font>. In this case, 4 characters are <font color="red"><strong>omitted</strong> (or â€œ<strong>soft trimmed</strong>â€œ or â€œ<strong>soft clipped</strong>â€œ)</font> from the beginning and 3 characters are omitted from the end. This sort of alignment can be produced by Bowtie 2 <strong>only in local mode</strong>.</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">Read:</span>      ACGGTTGCGTTAATCCGCCACG<br><span class="hljs-symbol">Reference:</span> TAACTTGCGTTAAATCCGCCTGG<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">Alignment:</span><br><span class="hljs-symbol">  Read:</span>      ACGGTTGCGTTAA-TCCGCCACG<br>                 ||||||||| ||||||<br><span class="hljs-symbol">  Reference:</span> TAACTTGCGTTAAATCCGCCTGG<br></code></pre></td></tr></table></figure><h2 id="Scores-higher-x3D-more-similar"><a href="#Scores-higher-x3D-more-similar" class="headerlink" title="Scores: higher &#x3D; more similar"></a>Scores: higher &#x3D; more similar</h2><p>An alignment score quantifies how similar the read sequence is to the reference sequence aligned to. The higher the score, the more similar they are. A score is <font color="blue"><strong>calculated</strong> by <strong>subtracting penalties</strong> for each difference (<strong>mismatch</strong>, <strong>gap</strong>, etc.)</font> and, in local alignment mode, adding bonuses for each match.</p><p>The scores can be configured with the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-ma"><code>--ma</code></a> (match bonus), <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-mp"><code>--mp</code></a> (mismatch penalty), <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-np"><code>--np</code></a> (penalty for having an N in either the read or the reference), <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-rdg"><code>--rdg</code></a> (affine read gap penalty) and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-rfg"><code>--rfg</code></a> (affine reference gap penalty) options.</p><h3 id="End-to-end-alignment-score-example-Default"><a href="#End-to-end-alignment-score-example-Default" class="headerlink" title="End-to-end alignment score example[Default]"></a>End-to-end alignment score example[Default]</h3><p>A <strong>mismatched</strong> base at a high-quality position in the read receives a penalty of <strong>-6</strong> by default. A length-2 read <strong>gap</strong> receives a penalty of -11 by default (<strong>-5 for the gap open</strong>, <strong>-3 for the first extension</strong>, -3 for the second extension). Thus, if 50 bp, one mismatch, one length-2 read gap, the overall score is -(6 + 11) &#x3D; -<strong>17</strong>.</p><p>The <strong>best</strong> possible alignment <strong>score</strong> in end-to-end mode is <strong>0</strong>, which happens when there are <strong>no differences</strong> between the read and the reference. <font color="red"><strong>No match bonus</strong>.Â </font> </p><h3 id="Local-alignment-score-example"><a href="#Local-alignment-score-example" class="headerlink" title="Local alignment score example"></a>Local alignment score example</h3><p>A mismatched base at a high-quality position in the read receives a penalty of -6 by default. A length-2 read gap receives a penalty of -11 by default (-5 for the gap open, -3 for the first extension, -3 for the second extension). A base that <font color="red"><strong>matches receives a bonus of +2 be default</strong></font>. Thus, if 50 bp, one mismatch, one length-2 read gap, <strong>bonus, 2 * 49</strong>, minus the total penalty, 6 + 11, &#x3D; <strong>81</strong>.</p><p>The best possible score in local mode equals the match bonus times the length of the read. This happens when there are no differences between the read and the reference.</p><h3 id="Valid-alignments-meet-or-exceed-the-minimum-score-threshold"><a href="#Valid-alignments-meet-or-exceed-the-minimum-score-threshold" class="headerlink" title="Valid alignments meet or exceed the minimum score threshold"></a><font color="red">Valid alignments meet or exceed the minimum score threshold</font></h3><p>For an alignment to be considered â€œvalidâ€ (i.e. â€œgood enoughâ€) by Bowtie 2, it must have an alignment score no less than the minimum score threshold. The threshold is configurable and is expressed as a function of the read length. In <font color="red"><strong>end-to-end</strong> alignment mode, the <strong>default minimum score threshold</strong></font> is <code>-0.6 + -0.6 * L</code>, where <code>L</code> is the read length. In <font color="red"><strong>local</strong> alignment mode, the <strong>default minimum score threshold</strong></font> is <code>20 + 8.0 * ln(L)</code>, where L is the read length. This can be configured with the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-score-min"><code>--score-min</code></a> option. For details on how to set options like <code>--score-min</code> that correspond to functions, see the section on <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#setting-function-options">setting function options</a>.</p><h2 id="MAPQ-Mapping-quality-higher-x3D-more-unique"><a href="#MAPQ-Mapping-quality-higher-x3D-more-unique" class="headerlink" title="MAPQ,Mapping quality: higher &#x3D; more unique"></a><font color="red">MAPQ</font>,Mapping quality: higher &#x3D; more unique</h2><p>The aligner cannot always assign a read to its point of origin with high confidence. For instance, a read that originated inside a repeat element might align equally well to many occurrences of the element throughout the genome, leaving the aligner with no basis for preferring one over the others.</p><p>Aligners characterize their degree of confidence in the point of origin by reporting a mapping quality: a non-negative integer <font color="red"><strong>Q &#x3D; -10 log10 p</strong></font>, where <font color="blue">p is an estimate of the probability that the alignment does not correspond to the readâ€™s true point of origin</font>. Mapping quality is sometimes abbreviated <font color="red"><strong>MAPQ</strong></font>, and is recorded in the <a href="http://samtools.sourceforge.net/SAM1.pdf">SAM</a> <code>MAPQ</code> field.</p><p>Mapping quality is related to â€œuniqueness.â€ We say an alignment is unique if it has a much higher alignment score than all the other possible alignments. The bigger the gap between the best alignmentâ€™s score and the second-best alignmentâ€™s score, the more unique the best alignment, and the higher its mapping quality should be.</p><p><strong>Accurate mapping qualities</strong> are <strong>useful</strong> for <strong>downstream tools</strong> like <strong>variant callers</strong>. For instance, a variant caller might choose to ignore evidence from alignments with mapping quality less than, say, 10. A mapping quality of 10 or less indicates that there is at least a 1 in 10 chance that the read truly originated elsewhere.</p><h2 id="Aligning-pairs"><a href="#Aligning-pairs" class="headerlink" title="Aligning pairs"></a>Aligning pairs</h2><p>A â€œpaired-endâ€ or â€œmate-pairâ€ read consists of pair of mates, called mate 1 and mate 2. Pairs come with a prior expectation about (a) the relative orientation of the mates, and (b) the distance separating them on the original DNA molecule. Exactly what expectations hold for a given dataset depends on the lab procedures used to generate the data. For example, a common lab procedure for producing pairs is Illuminaâ€™s Paired-end Sequencing Assay, which yields pairs with a <font color="blue"><strong>relative orientation of FR (â€œforward, reverseâ€)</strong></font> meaning that if <font color="blue">mate 1 came from the <strong>Watson strand</strong></font>, <font color="blue">mate 2 very likely came from the <strong>Crick strand</strong></font> and vice versa. Also, this protocol yields pairs where the expected genomic distance from end to end is about <strong>200-500 base pairs</strong>.</p><p>For simplicity, this manual uses the term â€œpaired-endâ€ to refer to any pair of reads with some expected relative orientation and distance. Depending on the protocol, these might actually be referred to as â€œpaired-endâ€ or â€œmate-paired.â€ Also, we always refer to the individual sequences making up the pair as â€œmates.â€</p><h3 id="Paired-inputs"><a href="#Paired-inputs" class="headerlink" title="Paired inputs"></a>Paired inputs</h3><p>Bowtie 2, mate 1s mates using the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-1"><code>-1</code></a> ,  mate 2s using the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-2"><code>-2</code></a> argument. </p><h3 id="Paired-SAM-output"><a href="#Paired-SAM-output" class="headerlink" title="Paired SAM output"></a>Paired SAM output</h3><p>When Bowtie 2 prints a SAM alignment for a pair, it <font color="blue"><strong>prints two records</strong> (i.e. two lines of output), one for each mate(1&amp;2)</font>. In both records, some of the fields of the SAM record describe various properties of the alignment; for instance, the <font color="blue">7th and 8th</font> fields (<code>RNEXT</code> and <code>PNEXT</code> respectively) indicate the <font color="blue">reference <strong>name</strong> and <strong>position</strong> where the other mate aligned</font>, and the <font color="blue"><strong>9th</strong> field indicates the inferred length of the <strong>DNA fragment</strong></font> from which the two mates were sequenced. See the <a href="http://samtools.sourceforge.net/SAM1.pdf">SAM specification</a> for more details regarding these fields.</p><h3 id="Concordant-pairs-match-pair-expectations-discordant-pairs-donâ€™t"><a href="#Concordant-pairs-match-pair-expectations-discordant-pairs-donâ€™t" class="headerlink" title="Concordant pairs match pair expectations, discordant pairs donâ€™t"></a><font color="red">Concordant pairs</font> match pair expectations, discordant pairs donâ€™t</h3><p>A pair that aligns <font color="blue">with the <strong>expected relative mate orientation</strong> and with the <strong>expected range</strong> of distances between mates</font> is said to align â€œ<font color="red"><strong>concordantly</strong></font>â€œ. If both mates have unique alignments, but the alignments do not match paired-end expectations (i.e. the mates arenâ€™t in the expected relative orientation, or arenâ€™t within the expected distance range, or both), the pair is said to align â€œ<font color="red"><strong>discordantly</strong></font>â€œ. Discordant alignments may be of particular interest, for instance, when seeking <a href="http://www.ncbi.nlm.nih.gov/dbvar/content/overview/"><font color="red"><strong>structural variants</strong></font></a>.</p><p>The expected relative orientation of the mates is set using the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-fr"><code>--ff</code></a>, <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-fr"><code>--fr</code></a>, or <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-fr"><code>--rf</code></a> options. The <strong>expected range of inter-mates distances</strong> (as measured from the furthest extremes of the mates; also called â€œouter distanceâ€) is set with the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-I"><code>-I</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-X"><code>-X</code></a> options. Note that setting <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-I"><code>-I</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-X"><code>-X</code></a> far apart <font color="blue">makes Bowtie 2 slower</font>. See documentation for <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-I"><code>-I</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-X"><code>-X</code></a>.</p><p>To declare that a pair aligns discordantly, Bowtie 2 requires that both mates align uniquely. This is a conservative threshold, but this is often desirable when seeking structural variants.</p><p><font color="red">By default, Bowtie 2 searches for both concordant and discordant alignments</font>, though searching for discordant alignments can be <strong>disabled</strong> with the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-no-discordant"><code>--no-discordant</code></a> option.</p><h3 id="Mixed-mode-paired-where-possible-unpaired-otherwise"><a href="#Mixed-mode-paired-where-possible-unpaired-otherwise" class="headerlink" title="Mixed mode: paired where possible, unpaired otherwise"></a>Mixed mode: paired where possible, unpaired otherwise</h3><p>If Bowtie 2 <font color="blue"><strong>cannot find</strong> a <strong>paired-end</strong> alignment for a <strong>pair</strong></font>, <font color="blue">by default it will go on to <strong>look for unpaired alignments</strong> for the constituent mates</font>. This is called â€œmixed mode.â€ To disable mixed mode, set the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-no-mixed"><code>--no-mixed</code></a> option.</p><p>Bowtie 2 <strong>runs a little faster</strong> in <code>--no-mixed</code> mode, but will only consider alignment status of pairs per se, not individual mates.</p><h3 id="Some-SAM-FLAGS-describe-paired-end-properties"><a href="#Some-SAM-FLAGS-describe-paired-end-properties" class="headerlink" title="Some SAM FLAGS describe paired-end properties"></a>Some <font color="red">SAM FLAGS</font> describe <font color="red">paired-end properties</font></h3><p>The SAM <code>FLAGS</code> field, the <font color="red"><strong>second field</strong></font> in a SAM record, has multiple bits that describe the paired-end nature of the read and alignment. </p><p>The first (least significant) bit (1 in decimal, 0x1 in hexadecimal) is set if the read is part of a pair. </p><p>The second bit (2 in decimal, 0x2 in hexadecimal) is set if <font color="blue">the read is part of a pair that aligned in a paired-end fashion</font>. </p><p>The fourth bit (8 in decimal, 0x8 in hexadecimal) is set if the read is part of a pair and the other mate in the pair had at least one valid alignment. </p><p>The sixth bit (32 in decimal, 0x20 in hexadecimal) is set if the read is part of a pair and the other mate in the pair aligned to the Crick strand (or, equivalently, if the reverse complement of the other mate aligned to the Watson strand). </p><p>The seventh bit (64 in decimal, 0x40 in hexadecimal) is set if the read is mate 1 in a pair. </p><p>The eighth bit (128 in decimal, 0x80 in hexadecimal) is set if the read is mate 2 in a pair. </p><p>See the <a href="http://samtools.sourceforge.net/SAM1.pdf">SAM specification</a> for a more detailed description of the <code>FLAGS</code> field.</p><h3 id="Some-SAM-optional-fields-describe-more-paired-end-properties"><a href="#Some-SAM-optional-fields-describe-more-paired-end-properties" class="headerlink" title="Some SAM optional fields describe more paired-end properties"></a>Some SAM optional fields describe more paired-end properties</h3><p>The last several fields of each SAM record usually contain SAM optional fields, which are simply tab-separated strings conveying additional information about the reads and alignments. A SAM optional field is formatted like this: â€œXP:i:1â€ where â€œXPâ€ is the <code>TAG</code>, â€œiâ€ is the <code>TYPE</code> (â€œintegerâ€ in this case), and â€œ1â€ is the <code>VALUE</code>. See the <a href="http://samtools.sourceforge.net/SAM1.pdf">SAM specification</a> for details regarding SAM optional fields.</p><h3 id="Mates-can-overlap-contain-or-dovetail-each-other"><a href="#Mates-can-overlap-contain-or-dovetail-each-other" class="headerlink" title="Mates can overlap, contain, or dovetail each other"></a>Mates can <font color="red">overlap, contain, or dovetail</font> each other</h3><p>The fragment and read lengths might be such that alignments for the two mates from a pair overlap each other. Consider this example:</p><p>(For these examples, assume we expect mate 1 to align to the left of mate 2.)</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">Mate 1</span><span class="hljs-punctuation">:</span> <span class="hljs-string">   GCAGATTATATGAGTCAGCTACGATATTGTT</span><br><span class="hljs-attribute">Mate 2</span><span class="hljs-punctuation">:</span> <span class="hljs-string">                              TGTTTGGGGTGACACATTACGCGTCTTTGAC</span><br><span class="hljs-attribute">Reference</span><span class="hljs-punctuation">:</span> <span class="hljs-string">GCAGATTATATGAGTCAGCTACGATATTGTTTGGGGTGACACATTACGCGTCTTTGAC</span><br></code></pre></td></tr></table></figure><p>Itâ€™s also possible, though unusual, for one mate alignment to contain the other, as in these examples:</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">Mate 1</span><span class="hljs-punctuation">:</span> <span class="hljs-string">   GCAGATTATATGAGTCAGCTACGATATTGTTTGGGGTGACACATTACGC</span><br><span class="hljs-attribute">Mate 2</span><span class="hljs-punctuation">:</span> <span class="hljs-string">                              TGTTTGGGGTGACACATTACGC</span><br><span class="hljs-attribute">Reference</span><span class="hljs-punctuation">:</span> <span class="hljs-string">GCAGATTATATGAGTCAGCTACGATATTGTTTGGGGTGACACATTACGCGTCTTTGAC</span><br><br><span class="hljs-attribute">Mate 1</span><span class="hljs-punctuation">:</span> <span class="hljs-string">                  CAGCTACGATATTGTTTGGGGTGACACATTACGC</span><br><span class="hljs-attribute">Mate 2</span><span class="hljs-punctuation">:</span> <span class="hljs-string">                     CTACGATATTGTTTGGGGTGAC</span><br><span class="hljs-attribute">Reference</span><span class="hljs-punctuation">:</span> <span class="hljs-string">GCAGATTATATGAGTCAGCTACGATATTGTTTGGGGTGACACATTACGCGTCTTTGAC</span><br></code></pre></td></tr></table></figure><p>And itâ€™s also possible, though unusual, for the mates to â€œdovetailâ€, with the mates seemingly extending â€œpastâ€ each other as in this example:</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">Mate 1</span><span class="hljs-punctuation">:</span> <span class="hljs-string">                GTCAGCTACGATATTGTTTGGGGTGACACATTACGC</span><br><span class="hljs-attribute">Mate 2</span><span class="hljs-punctuation">:</span> <span class="hljs-string">           TATGAGTCAGCTACGATATTGTTTGGGGTGACACAT                   </span><br><span class="hljs-attribute">Reference</span><span class="hljs-punctuation">:</span> <span class="hljs-string">GCAGATTATATGAGTCAGCTACGATATTGTTTGGGGTGACACATTACGCGTCTTTGAC</span><br></code></pre></td></tr></table></figure><p>In some situations, itâ€™s desirable for the aligner to consider all these cases as â€œconcordantâ€ as long as other paired-end constraints are not violated. <font color="red"><strong>Bowtie 2â€™s default</strong></font> behavior is to consider <font color="blue">overlapping and containing</font> as being consistent with <font color="blue">concordant</font> alignment. By default, <font color="blue">dovetailing is considered inconsistent with concordant alignment</font>.</p><p>These <font color="red"><strong>defaults can be overridden</strong></font>. Setting <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-no-overlap"><code>--no-overlap</code></a> causes Bowtie 2 to consider overlapping mates as non-concordant. Setting <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-no-contain"><code>--no-contain</code></a>causes Bowtie 2 to consider cases where one mate alignment contains the other as non-concordant. Setting <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-dovetail"><code>--dovetail</code></a> causes Bowtie 2 to consider cases where the mate alignments dovetail as concordant.</p><h2 id="Reporting"><a href="#Reporting" class="headerlink" title="Reporting"></a>Reporting</h2><p>The reporting mode governs how many alignments Bowtie 2 looks for, and how to report them. Bowtie 2 has three distinct reporting modes. The default reporting mode is similar to the default reporting mode of many other read alignment tools, including <a href="http://bio-bwa.sourceforge.net/">BWA</a>. It is also similar to Bowtie 1â€™s <code>-M</code>alignment mode.</p><p>In general, when we say that a read has an alignment, we mean that it has a <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#valid-alignments-meet-or-exceed-the-minimum-score-threshold">valid alignment</a>. When we say that a read has multiple alignments, we mean that it has multiple alignments that are valid and distinct from one another.</p><h3 id="Distinct-alignments-map-a-read-to-different-places"><a href="#Distinct-alignments-map-a-read-to-different-places" class="headerlink" title="Distinct alignments map a read to different places"></a>Distinct alignments map a read to different places</h3><p>Two alignments for the same individual read are â€œdistinctâ€ if they map the same read to different places. Specifically, we say that two alignments are distinct if there are no alignment positions where a particular read offset is aligned opposite a particular reference offset in both alignments with the same orientation. E.g. if the first alignment is in the forward orientation and aligns the read character at read offset 10 to the reference character at chromosome 3, offset 3,445,245, and the second alignment is also in the forward orientation and also aligns the read character at read offset 10 to the reference character at chromosome 3, offset 3,445,245, they are not distinct alignments.</p><p>Two alignments for the same pair are distinct if either the mate 1s in the two paired-end alignments are distinct or the mate 2s in the two alignments are distinct or both.</p><h3 id="Default-mode-search-for-multiple-alignments-report-the-best-one"><a href="#Default-mode-search-for-multiple-alignments-report-the-best-one" class="headerlink" title="Default mode: search for multiple alignments, report the best one"></a><font color="red">Default mode</font>: search for multiple alignments, <font color="red">report the best one</font></h3><p>By default, Bowtie 2 searches for distinct, valid alignments for each read. When it finds a valid alignment, it generally will continue to look for alignments that are nearly as good or better. It will eventually stop looking, either because it <font color="red">exceeded a limit placed on search effort</font> (see <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-D"><code>-D</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-R"><code>-R</code></a>) or because it already knows all it needs to know to report an alignment. <font color="blue">Information from the best alignments are used to estimate mapping quality</font> (the <code>MAPQ</code> <a href="http://samtools.sourceforge.net/SAM1.pdf">SAM</a> field) and to set SAM optional fields, such as <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-opt-fields-as"><code>AS:i</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-opt-fields-xs"><code>XS:i</code></a>. Bowtie 2 does not guarantee that the alignment reported is the best possible in terms of alignment score.</p><p>See also: <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-D"><code>-D</code></a>, which puts an <strong>upper limit</strong> on the number of dynamic programming problems (i.e. seed extensions) that can â€œfailâ€ in a row before Bowtie 2 stops searching. Increasing <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-D"><code>-D</code></a> makes Bowtie 2 <strong>slower</strong>, but increases the likelihood that it will report the correct alignment for a read that aligns many places.</p><p>See also: <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-R"><code>-R</code></a>, which sets the maximum number of times Bowtie 2 will â€œre-seedâ€ when attempting to align a read with repetitive seeds. Increasing <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-R"><code>-R</code></a>makes Bowtie 2 <strong>slower</strong>, but increases the likelihood that it will report the correct alignment for a read that aligns many places.</p><h3 id="k-mode-search-for-one-or-more-alignments-report-each"><a href="#k-mode-search-for-one-or-more-alignments-report-each" class="headerlink" title="-k mode: search for one or more alignments, report each"></a><font color="red">-k mode</font>: search for one or more alignments, report each</h3><p>In <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-k"><code>-k</code></a> mode, Bowtie 2 <font color="red">searches for up to N distinct</font>, valid alignments for each read, where N equals the integer specified with the <code>-k</code> parameter. That is, if <code>-k 2</code> is specified, Bowtie 2 will search for at most 2 distinct alignments. It reports all alignments found, in descending order by alignment score. The alignment score for a paired-end alignment equals the sum of the alignment scores of the individual mates. Each reported read or pair alignment beyond the first has the SAM â€˜secondaryâ€™ bit (which equals 256) set in its FLAGS field. Supplementary alignments will also be assigned a MAPQ of 255. See the <a href="http://samtools.sourceforge.net/SAM1.pdf">SAM specification</a> for details.</p><p>Bowtie 2 does not â€œfindâ€ alignments in any specific order, so for reads that have more than N distinct, valid alignments, Bowtie 2 does not guarantee that the N alignments reported are the best possible in terms of alignment score. Still, this mode can be effective and fast in situations where the user <font color="red">cares more about whether a read aligns (or aligns a certain number of times) than where exactly it originated</font>.</p><h3 id="a-mode-search-for-and-report-all-alignments"><a href="#a-mode-search-for-and-report-all-alignments" class="headerlink" title="-a mode: search for and report all alignments"></a>-a mode: search for and report all alignments</h3><p><a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-a"><code>-a</code></a> mode is similar to <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-k"><code>-k</code></a> mode except that there is <font color="red">no upper limit on the number of alignments Bowtie 2 should report</font>. Alignments are reported in descending order by alignment score. The alignment score for a paired-end alignment equals the sum of the alignment scores of the individual mates. Each reported read or pair alignment beyond the first has the SAM â€˜secondaryâ€™ bit (which equals 256) set in its FLAGS field. Supplementary alignments will be assigned a MAPQ of 255. See the <a href="http://samtools.sourceforge.net/SAM1.pdf">SAM specification</a> for details.</p><p>Some tools are designed with this reporting mode in mind. Bowtie 2 is not! For very large genomes, this mode is <strong>very slow</strong>.</p><h3 id="Randomness-in-Bowtie-2"><a href="#Randomness-in-Bowtie-2" class="headerlink" title="Randomness in Bowtie 2"></a>Randomness in Bowtie 2</h3><p>Bowtie 2â€™s search for alignments for a given read is â€œrandomized.â€ That is, when Bowtie 2 encounters <font color="blue">a set of equally-good choices, it uses a <strong>pseudo-random number</strong> to choose?</font>. For example, if Bowtie 2 discovers a set of 3 equally-good alignments and wants to decide which to report, it picks a pseudo-random integer 0, 1 or 2 and reports the corresponding alignment. Arbitrary choices can crop up at various points during alignment.</p><p>The pseudo-random number generator is re-initialized for every read, and the seed used to initialize it is a function of the read name, nucleotide string, quality string, and the value specified with <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-seed"><code>--seed</code></a>. If you run the same version of Bowtie 2 on two reads with identical names, nucleotide strings, and quality strings, and if <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-seed"><code>--seed</code></a> is <font color="blue">set the same for both runs, Bowtie 2 will produce the same output</font>; i.e., it will align the read to the same place, even if there are multiple equally good alignments. This is intuitive and desirable in most cases. <font color="red">Most users expect Bowtie to produce the <strong>same output</strong> when run twice on the <strong>same input</strong></font>.</p><p>However, when the user specifies the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-non-deterministic"><code>--non-deterministic</code></a> option, Bowtie 2 will use the current time to re-initialize the pseudo-random number generator. When this is specified, Bowtie 2 might report different alignments for identical reads. This is counter-intuitive for some users, but might be more appropriate in situations where the input consists of many identical reads.</p><h2 id="Multiseed-heuristic"><a href="#Multiseed-heuristic" class="headerlink" title="Multiseed heuristic"></a>Multiseed heuristic</h2><p>To rapidly narrow the number of possible alignments that must be considered, Bowtie 2 begins by extracting substrings (â€œseedsâ€) from the read and its reverse complement and aligning them in an ungapped fashion with the help of the <a href="http://portal.acm.org/citation.cfm?id=796543">FM Index</a>. This is â€œmultiseed alignmentâ€ and it is similar to what <a href="http://genomebiology.com/2009/10/3/R25">Bowtie 1 does</a>, except Bowtie 1 attempts to align the entire read this way.</p><p>This initial step makes Bowtie 2 much faster than it would be without such a filter, but at the expense of missing some valid alignments. For instance, it is possible for a read to have a valid overall alignment but to have no valid seed alignments because each potential seed alignment is interrupted by too many mismatches or gaps.</p><p>The <font color="red">trade-off between <strong>speed</strong> and <strong>sensitivity&#x2F;accuracy</strong> can be adjusted by setting the seed length</font> (<a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-L"><code>-L</code></a>), the interval between extracted seeds (<a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-i"><code>-i</code></a>), and the number of mismatches permitted per seed (<a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-N"><code>-N</code></a>). For more sensitive alignment, set these parameters to (a) make the seeds closer together, (b) make the seeds shorter, and&#x2F;or (c) allow more mismatches. You can adjust these options one-by-one, though Bowtie 2 comes with some useful combinations of options prepackaged as â€œ<a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#presets-setting-many-settings-at-once">preset options</a>.â€</p><p><a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-D"><code>-D</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-R"><code>-R</code></a> are also options that adjust the trade-off between speed and sensitivity&#x2F;accuracy.</p><h3 id="FM-Index-memory-footprint"><a href="#FM-Index-memory-footprint" class="headerlink" title="FM Index memory footprint"></a>FM Index memory footprint</h3><p>Bowtie 2 uses the <a href="http://portal.acm.org/citation.cfm?id=796543">FM Index</a> to find ungapped alignments for seeds. This step accounts for the bulk of Bowtie 2â€™s memory footprint, as the <a href="http://portal.acm.org/citation.cfm?id=796543">FM Index</a>itself is typically the largest data structure used. For instance, the memory footprint of the <a href="http://portal.acm.org/citation.cfm?id=796543">FM Index</a> for the human genome is about 3.2 gigabytes of RAM.</p><h2 id="Ambiguous-characters"><a href="#Ambiguous-characters" class="headerlink" title="Ambiguous characters"></a>Ambiguous characters</h2><p>Non-whitespace characters besides A, C, G or T are considered â€œambiguous.â€ N is a common ambiguous character that appears in reference sequences. Bowtie 2 considers all ambiguous characters in the reference (including <a href="http://www.bioinformatics.org/sms/iupac.html">IUPAC nucleotide codes</a>) to be Ns.</p><p>Bowtie 2 <font color="red"><strong>allows</strong> alignments to overlap ambiguous characters in the reference</font>. An alignment position that contains an ambiguous character in the read, reference, or both, is penalized according to <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-np"><code>--np</code></a>. <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-n-ceil"><code>--n-ceil</code></a> sets an upper limit on the number of positions that may contain ambiguous reference characters in a valid alignment. The optional field <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-opt-fields-xn"><code>XN:i</code></a> reports the number of ambiguous reference characters overlapped by an alignment.</p><p>Note that the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#multiseed-heuristic">multiseed heuristic</a> cannot find <em>seed</em> alignments that overlap ambiguous reference characters. For an alignment overlapping an ambiguous reference character to be found, it must have one or more seed alignments that do not overlap ambiguous reference characters.</p><h2 id="Presets-setting-many-settings-at-once"><a href="#Presets-setting-many-settings-at-once" class="headerlink" title="Presets: setting many settings at once"></a>Presets: setting many settings at once</h2><p>Bowtie 2 comes with some useful combinations of parameters packaged into shorter â€œpresetâ€ parameters. For example, running Bowtie 2 with the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-very-sensitive"><code>--very-sensitive</code></a> option is the same as running with options: <code>-D 20 -R 3 -N 0 -L 20 -i S,1,0.50</code>. The preset options that come with Bowtie 2 are <font color="red">designed to cover a wide area of the speed&#x2F;sensitivity&#x2F;accuracy trade-off space</font>, with the presets ending in <code>fast</code> generally being faster but less sensitive and less accurate, and the presets ending in <code>sensitive</code> generally being slower but <strong>more sensitive and more accurate</strong>. See the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#preset-options-in---end-to-end-mode">documentation for the preset options</a> for details.</p><p>As of Bowtie2 v2.4.0, individual preset values can be overridden by providing the specific options e.g. the configured seed length of 20 in the [<code>--very-senitive</code>] preset above can be changed to 25 by <strong>also specifying</strong> the <code>-L 25</code> parameter anywhere on the command line[masked -L 20].</p><h2 id="Filtering"><a href="#Filtering" class="headerlink" title="Filtering"></a>Filtering</h2><p>Some <font color="red"><strong>reads</strong></font> are skipped or â€œ<font color="red"><strong>filtered out</strong></font>â€œ by Bowtie 2. For example, reads may be filtered out because they are extremely short or have a high proportion of ambiguous nucleotides. Bowtie 2 will still print a SAM record for such a read, but no alignment will be reported and the <code>YF:i</code> SAM optional field will be set to indicate the reason the read was filtered.</p><ul><li><code>YF:Z:LN</code>: the read was filtered because it had <font color="blue">length less than or equal</font> to the number of seed mismatches set with the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-N"><code>-N</code></a> option.</li><li><code>YF:Z:NS</code>: the read was filtered because it <font color="blue">contains a number of ambiguous characters</font> (usually <code>N</code> or <code>.</code>) greater than the ceiling specified with <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-n-ceil"><code>--n-ceil</code></a>.</li><li><code>YF:Z:SC</code>: the read was filtered because the read length and the match bonus (set with <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-ma"><code>--ma</code></a>) are such that the read <font color="blue">canâ€™t possibly earn an alignment score</font> greater than or equal to the threshold set with <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-score-min"><code>--score-min</code></a></li><li><code>YF:Z:QC</code>: the read was filtered because it was <font color="blue">marked as failing quality control</font> and the user specified the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-qc-filter"><code>--qc-filter</code></a> option. This only happens when the input is in Illuminaâ€™s QSEQ format (i.e. when <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-qseq"><code>--qseq</code></a> is specified) and the last (11th) field of the readâ€™s QSEQ record contains <code>1</code>.</li></ul><p>If a read could be filtered for more than one reason, the value <code>YF:Z</code> flag will reflect only one of those reasons.</p><h2 id="Alignment-summary"><a href="#Alignment-summary" class="headerlink" title="Alignment summary"></a>Alignment summary</h2><p>When Bowtie 2 finishes running, it prints messages summarizing what happened. These messages are printed to the â€œstandard errorâ€ (â€œstderrâ€) filehandle. For datasets <font color="blue">consisting of unpaired reads</font>, the summary might look like this:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">20000</span> reads; of these:<br>  <span class="hljs-attribute">20000</span> (<span class="hljs-number">100</span>.<span class="hljs-number">00</span>%) were unpaired; of these:<br>    <span class="hljs-attribute">1247</span> (<span class="hljs-number">6</span>.<span class="hljs-number">24</span>%) aligned <span class="hljs-number">0</span> times<br>    <span class="hljs-attribute">18739</span> (<span class="hljs-number">93</span>.<span class="hljs-number">69</span>%) aligned exactly <span class="hljs-number">1</span> time<br>    <span class="hljs-attribute">14</span> (<span class="hljs-number">0</span>.<span class="hljs-number">07</span>%) aligned &gt;<span class="hljs-number">1</span> times<br><span class="hljs-attribute">93</span>.<span class="hljs-number">77</span>% overall alignment rate<br></code></pre></td></tr></table></figure><p>For datasets <font color="blue">consisting of pairs</font>, the summary might look like this:</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-number">10000</span> reads; <span class="hljs-keyword">of</span> these:<br>  <span class="hljs-number">10000</span> (<span class="hljs-number">100.00</span>%) were paired; <span class="hljs-keyword">of</span> these:<br>    <span class="hljs-number">650</span> (<span class="hljs-number">6.50</span>%) aligned concordantly <span class="hljs-number">0</span> <span class="hljs-keyword">times</span><br>    <span class="hljs-number">8823</span> (<span class="hljs-number">88.23</span>%) aligned concordantly exactly <span class="hljs-number">1</span> <span class="hljs-built_in">time</span><br>    <span class="hljs-number">527</span> (<span class="hljs-number">5.27</span>%) aligned concordantly &gt;<span class="hljs-number">1</span> <span class="hljs-keyword">times</span><br>    <span class="hljs-comment">----</span><br>    <span class="hljs-number">650</span> pairs aligned concordantly <span class="hljs-number">0</span> <span class="hljs-keyword">times</span>; <span class="hljs-keyword">of</span> these:<br>      <span class="hljs-number">34</span> (<span class="hljs-number">5.23</span>%) aligned discordantly <span class="hljs-number">1</span> <span class="hljs-built_in">time</span><br>    <span class="hljs-comment">----</span><br>    <span class="hljs-number">616</span> pairs aligned <span class="hljs-number">0</span> <span class="hljs-keyword">times</span> concordantly <span class="hljs-keyword">or</span> discordantly; <span class="hljs-keyword">of</span> these:<br>      <span class="hljs-number">1232</span> mates make up <span class="hljs-keyword">the</span> pairs; <span class="hljs-keyword">of</span> these:<br>        <span class="hljs-number">660</span> (<span class="hljs-number">53.57</span>%) aligned <span class="hljs-number">0</span> <span class="hljs-keyword">times</span><br>        <span class="hljs-number">571</span> (<span class="hljs-number">46.35</span>%) aligned exactly <span class="hljs-number">1</span> <span class="hljs-built_in">time</span><br>        <span class="hljs-number">1</span> (<span class="hljs-number">0.08</span>%) aligned &gt;<span class="hljs-number">1</span> <span class="hljs-keyword">times</span><br><span class="hljs-number">96.70</span>% overall alignment rate<br></code></pre></td></tr></table></figure><p>The indentation indicates how subtotals relate to totals.</p><h2 id="Wrapper-scripts"><a href="#Wrapper-scripts" class="headerlink" title="Wrapper scripts"></a>Wrapper scripts</h2><p>The <code>bowtie2</code>, <code>bowtie2-build</code> and <code>bowtie2-inspect</code> executables are actually wrapper scripts that call binary programs as appropriate. The wrappers shield users from having to distinguish between â€œsmallâ€ and â€œlargeâ€ index formats, discussed briefly in the following section. Also, the <code>bowtie2</code>wrapper provides some key functionality, like the ability to handle compressed inputs, and the functionality for <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-un"><code>--un</code></a>, <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-al"><code>--al</code></a> and related options.</p><p>It is recommended that you always run the bowtie2 wrappers and <strong>not run the binaries directly.</strong></p><h2 id="Small-and-large-indexes"><a href="#Small-and-large-indexes" class="headerlink" title="Small and large indexes"></a>Small and large indexes</h2><p><code>bowtie2-build</code> can index reference genomes of any size. For genomes less than about 4 billion nucleotides in length, <code>bowtie2-build</code> builds a â€œsmallâ€ index using 32-bit numbers in various parts of the index. When the genome is longer, <code>bowtie2-build</code> builds a â€œlargeâ€ index using 64-bit numbers. <font color="blue">Small indexes are stored in files with the <code>.bt2</code> extension, and large indexes are stored in files with the <code>.bt2l</code> extension. </font>The user need not worry about whether a particular index is small or large; the wrapper scripts will automatically build and use the appropriate index.</p><h2 id="Performance-tuning"><a href="#Performance-tuning" class="headerlink" title="Performance tuning"></a>Performance tuning</h2><ol><li><p>If your computer has multiple processors&#x2F;cores, use <code>-p</code></p><p>The <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-p"><code>-p</code></a> option causes Bowtie 2 to launch a specified number of parallel search threads. Each thread runs on a different processor&#x2F;core and all threads find alignments in parallel, increasing alignment throughput by approximately a multiple of the number of threads (though in practice, speedup is somewhat worse than linear).</p></li><li><p>If reporting many alignments per read, try reducing <code>bowtie2-build --offrate</code></p><p><font color="blue">If you are using <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-k"><code>-k</code></a> or <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-a"><code>-a</code></a> options and Bowtie 2 is reporting many alignments per read, using an index with a denser SA sample can speed things up considerably</font>. To do this, specify a smaller-than-default <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-o"><code>-o</code>&#x2F;<code>--offrate</code></a> value when running <code>bowtie2-build</code>. A denser SA sample yields a larger index, but is also particularly effective at speeding up alignment when many alignments are reported per read.</p></li><li><p>If <code>bowtie2</code> â€œthrashesâ€, try increasing <code>bowtie2-build --offrate</code></p><p>If <code>bowtie2</code> runs very slowly on a relatively low-memory computer, try setting <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-o"><code>-o</code>&#x2F;<code>--offrate</code></a> to a <em>larger</em> value when building the index. This decreases the memory footprint of the index.</p></li></ol><h2 id="Command-Line"><a href="#Command-Line" class="headerlink" title="Command Line"></a>Command Line</h2><h3 id="Alignment"><a href="#Alignment" class="headerlink" title="Alignment"></a><font color="red">Alignment</font></h3><p>Here are a few that may benefit the alignment of an <a href="https://informatics.fas.harvard.edu/atac-seq-guidelines.html">ATAC-seq dataset on Cannon</a>:</p><table><thead><tr><th align="left">Argument</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>-X &lt;int&gt;</code></td><td align="left"><strong>Maximum DNA fragment length</strong> (default 500bp). If you anticipate that you may have DNA fragments longer than the default value, you should increase this parameter accordingly; otherwise, alignments from such fragments are considered not properly paired (see Fig. 3B below).</td></tr><tr><td align="left"><code>--very-sensitive</code></td><td align="left">Bowtie2 has a number of alignment and effort parameters that interact in complex (and sometimes unexpected) ways. Preset collections of these parameters are provided for convenience; the default is <code>--sensitive</code>, but <strong>better alignment results</strong> are frequently achieved with <code>--very-sensitive</code>.</td></tr><tr><td align="left"><code>-k &lt;int&gt;</code></td><td align="left">Maximum number of <strong>alignments to report per read</strong>. By default, Bowtie2 reports at most one alignment per read, and if multiple equivalent alignments exist, it chooses one randomly. Generate huge output</td></tr><tr><td align="left"><code>-p &lt;int&gt;</code></td><td align="left">Number of cores on which to run</td></tr></tbody></table><p>The output is a <a href="https://samtools.github.io/hts-specs/SAMv1.pdf">SAM file</a>, which contains alignment information for each input read. The SAM <strong>should be compressed to a binary format (BAM)</strong> and sorted by queryname with <a href="http://www.htslib.org/doc/samtools.html">SAMtools</a>. This is best accomplished by piping the output from Bowtie2 directly to <code>samtools view</code> and <code>samtools sort</code>, </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">module load bowtie2   <span class="hljs-comment"># if not already loaded</span><br>module load samtools<br>bowtie2  --very-sensitive  -k 10  -x &lt;genomeIndexName&gt;  -1 &lt;name&gt;_1.fastq.gz  -2 &lt;name&gt;_2.fastq.gz  \<br>  |  samtools view  -u  -  \<br>  |  samtools <span class="hljs-built_in">sort</span>  -n  -o &lt;BAM&gt;  -<br></code></pre></td></tr></table></figure><p>For input files of <strong>20 million paired reads</strong>, this command takes around <strong>five hours</strong> on Cannon. This can be decreased by increasing the number of cores in the Bowtie2 command. For example, one could specify eight cores for Bowtie2 with <code>-p 8</code> and adjust the request in the SLURM script to <code>#SBATCH -n 10</code>(that is, <strong>eight cores for Bowtie2 and one each for SAMtools view and sort, simultaneously processing</strong>). The memory usage of Bowtie2 depends primarily on the genome length; enough must be requested to load the genome indexes.</p><p>Bowtie2 also provides (via <code>stderr</code>) a summary of the mapping results, separated according to uniqueness and alignment type (concordant, discordant, and non-concordant&#x2F;non-discordant). In terms of alignment interpretation, it is conceptually easier to divide alignments into two <strong>basic categories: properly paired and unpaired</strong> (Fig. 3).</p><p><img src="/GeekFocus/2022-03-20-bowtie2/1.png"><br><img src="/GeekFocus/img/2022-03-20-bowtie2/1.png" alt="Alignment types"></p><p><strong>Figure 3. Alignment types for paired-end reads. A:</strong> Properly paired alignments (â€œconcordantâ€) have the reads aligned in opposite orientations on the same reference sequence (chromosome). The reads may overlap to some extent (bottom).  <strong>B:</strong> A read alignment (for R1) can be unpaired for several reasons: if the readâ€™s mate (R2) is unaligned (upper left), aligns to a different chromosome (upper right), aligns in the incorrect orientation (middle cases), or aligns in the correct orientation but at an invalid distance (bottom). In all cases except the upper left, the R2 read alignment is also unpaired, and the read pair align discordantly (though Bowtie2 also requires uniqueness for such alignments to be counted as discordant).</p><h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">bowtie2 [<span class="hljs-keyword">options</span>]* -<span class="hljs-keyword">x</span> <span class="hljs-symbol">&lt;bt2-idx&gt;</span> &#123;-<span class="hljs-number">1</span> <span class="hljs-symbol">&lt;m1&gt;</span> -<span class="hljs-number">2</span> <span class="hljs-symbol">&lt;m2&gt;</span> | -U <span class="hljs-symbol">&lt;r&gt;</span> | --interleaved <span class="hljs-symbol">&lt;i&gt;</span> | --sra-acc <span class="hljs-symbol">&lt;acc&gt;</span> | <span class="hljs-keyword">b</span> <span class="hljs-symbol">&lt;bam&gt;</span>&#125; -S [<span class="hljs-symbol">&lt;sam&gt;</span>]<br></code></pre></td></tr></table></figure><h3 id="Main-arguments"><a href="#Main-arguments" class="headerlink" title="Main arguments"></a>Main arguments</h3><table><thead><tr><th><code>-x &lt;bt2-idx&gt;</code></th><th>The basename of the index for the reference genome.</th></tr></thead><tbody><tr><td><code>-1 &lt;m1&gt;</code></td><td>Comma-separated list of files containing mate 1s (filename usually includes <code>_1</code>), e.g. <code>-1 flyA_1.fq,flyB_1.fq</code>.</td></tr><tr><td><code>-2 &lt;m2&gt;</code></td><td>Comma-separated list of files containing mate 2s (filename usually includes <code>_2</code>), e.g. <code>-2 flyA_2.fq,flyB_2.fq</code>.</td></tr><tr><td><code>-U &lt;r&gt;</code></td><td>Comma-separated list of files containing unpaired reads to be aligned, e.g. <code>lane1.fq,lane2.fq,lane3.fq,lane4.fq</code>. Reads may be a mix of different lengths. If <code>-</code> is specified, <code>bowtie2</code> gets the reads from the â€œstandard inâ€ or â€œstdinâ€ filehandle.</td></tr><tr><td><code>--interleaved</code></td><td>Reads interleaved FASTQ files where the first two records (8 lines) represent a mate pair.</td></tr><tr><td><code>--sra-acc</code></td><td>Reads are SRA accessions.</td></tr><tr><td><code>-b &lt;bam&gt;</code></td><td>Reads are unaligned BAM records sorted by read name. The <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-align-paired-reads"><code>--align-paired-reads</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-preserve-tags"><code>--preserve-tags</code></a> options affect the way Bowtie 2 processes records.</td></tr><tr><td><code>-S &lt;sam&gt;</code></td><td>File to write SAM alignments to. By default, alignments are written to the â€œstandard outâ€ or â€œstdoutâ€ filehandle (i.e. the console).</td></tr></tbody></table><h3 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h3><h4 id="Input-options"><a href="#Input-options" class="headerlink" title="Input options"></a>Input options</h4><table><thead><tr><th><code>-q</code></th><th>Reads (specified with <code>&lt;m1&gt;</code>, <code>&lt;m2&gt;</code>, <code>&lt;s&gt;</code>) are FASTQ files. FASTQ files usually have extension <code>.fq</code> or <code>.fastq</code>. FASTQ is the default format. See also: <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-solexa-quals"><code>--solexa-quals</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-int-quals"><code>--int-quals</code></a>.</th></tr></thead><tbody><tr><td><code>--tab5</code></td><td>Each read or pair is on a single line. An unpaired read line is <code>[name]\t[seq]\t[qual]\n</code>. A paired-end read line is <code>[name]\t[seq1]\t[qual1]\t[seq2]\t[qual2]\n</code>. An input file can be a mix of unpaired and paired-end reads and Bowtie 2 recognizes each according to the number of fields, handling each as it should.</td></tr><tr><td><code>--tab6</code></td><td>Similar to <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-tab5"><code>--tab5</code></a> except, for paired-end reads, the second end can have a different name from the first: <code>[name1]\t[seq1]\t[qual1]\t[name2]\t[seq2]\t[qual2]\n</code></td></tr><tr><td><code>--qseq</code></td><td>Reads (specified with <code>&lt;m1&gt;</code>, <code>&lt;m2&gt;</code>, <code>&lt;s&gt;</code>) are QSEQ files. QSEQ files usually end in <code>_qseq.txt</code>. See also: <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-solexa-quals"><code>--solexa-quals</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-int-quals"><code>--int-quals</code></a>.</td></tr><tr><td><code>-f</code></td><td>Reads (specified with <code>&lt;m1&gt;</code>, <code>&lt;m2&gt;</code>, <code>&lt;s&gt;</code>) are <a href="https://en.wikipedia.org/wiki/FASTA"><code>FASTA</code></a> files. <a href="https://en.wikipedia.org/wiki/FASTA"><code>FASTA</code></a> files usually have extension <code>.fa</code>, <code>.fasta</code>, <code>.mfa</code>, <code>.fna</code>or similar. <a href="https://en.wikipedia.org/wiki/FASTA"><code>FASTA</code></a> files do not have a way of specifying quality values, so when <code>-f</code> is set, the result is as if <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-ignore-quals"><code>--ignore-quals</code></a> is also set.</td></tr><tr><td><code>-r</code></td><td>Reads (specified with <code>&lt;m1&gt;</code>, <code>&lt;m2&gt;</code>, <code>&lt;s&gt;</code>) are files with one input sequence per line, without any other information (no read names, no qualities). When <code>-r</code> is set, the result is as if <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-ignore-quals"><code>--ignore-quals</code></a> is also set.</td></tr><tr><td><code>-F k:&lt;int&gt;,i:&lt;int&gt;</code></td><td>Reads are substrings (k-mers) extracted from a FASTA file <code>&lt;s&gt;</code>. Specifically, for every reference sequence in FASTA file <code>&lt;s&gt;</code>, Bowtie 2 aligns the k-mers at offsets 1, 1+i, 1+2i, â€¦ until reaching the end of the reference. Each k-mer is aligned as a separate read. Quality values are set to all Is (40 on Phred scale). Each k-mer (read) is given a name like <code>&lt;sequence&gt;_&lt;offset&gt;</code>, where <code>&lt;sequence&gt;</code> is the name of the FASTA sequence it was drawn from and <code>&lt;offset&gt;</code> is its 0-based offset of origin with respect to the sequence. Only single k-mers, i.e. unpaired reads, can be aligned in this way.</td></tr><tr><td><code>-c</code></td><td>The read sequences are given on command line. I.e. <code>&lt;m1&gt;</code>, <code>&lt;m2&gt;</code> and <code>&lt;singles&gt;</code> are comma-separated lists of reads rather than lists of read files. There is no way to specify read names or qualities, so <code>-c</code> also implies <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-ignore-quals"><code>--ignore-quals</code></a>.</td></tr><tr><td><code>-s/--skip &lt;int&gt;</code></td><td><strong>Skip (i.e. do not align) the first <code>&lt;int&gt;</code> reads or pairs in the input.</strong></td></tr><tr><td><code>-u/--qupto &lt;int&gt;</code></td><td><strong>Align the first <code>&lt;int&gt;</code> reads or read pairs from the input</strong> (after the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-s"><code>-s</code>&#x2F;<code>--skip</code></a> reads or pairs have been skipped), then stop. Default: no limit.</td></tr><tr><td><code>-5/--trim5 &lt;int&gt;</code></td><td><strong>Trim <code>&lt;int&gt;</code> bases from 5â€™ (left) end</strong> of each read before alignment (default: <strong>0</strong>).</td></tr><tr><td><code>-3/--trim3 &lt;int&gt;</code></td><td><strong>Trim <code>&lt;int&gt;</code> bases from 3â€™ (right) end</strong> of each read before alignment (default: <strong>0</strong>).</td></tr><tr><td>&#96;â€“trim-to [3:</td><td>5:]<int>&#96;</td></tr><tr><td><code>--phred33</code></td><td>Input qualities are ASCII chars equal to the <a href="http://en.wikipedia.org/wiki/Phred_quality_score">Phred quality</a> plus 33. This is also called the â€œPhred+33â€ encoding, which is <strong>used by the very latest Illumina pipelines.</strong></td></tr><tr><td><code>--phred64</code></td><td>Input qualities are ASCII chars equal to the <a href="http://en.wikipedia.org/wiki/Phred_quality_score">Phred quality</a> plus 64. This is also called the â€œPhred+64â€ encoding.</td></tr><tr><td><code>--solexa-quals</code></td><td>Convert input qualities from <a href="http://en.wikipedia.org/wiki/Phred_quality_score">Solexa</a> (which can be negative) to <a href="http://en.wikipedia.org/wiki/Phred_quality_score">Phred</a> (which canâ€™t). This scheme was used in older Illumina GA Pipeline versions (prior to 1.3). <strong>Default: off.</strong></td></tr><tr><td><code>--int-quals</code></td><td>Quality values are represented in the read input file as space-separated ASCII integers, e.g., <code>40 40 30 40</code>â€¦, rather than ASCII characters, e.g., <code>II?I</code>â€¦. Integers are treated as being on the <a href="http://en.wikipedia.org/wiki/Phred_quality_score">Phred quality</a> scale unless <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-solexa-quals"><code>--solexa-quals</code></a> is also specified. <strong>Default: off.</strong></td></tr></tbody></table><h4 id="Preset-options-in-end-to-end-mode"><a href="#Preset-options-in-end-to-end-mode" class="headerlink" title="Preset options in --end-to-end mode"></a>Preset options in <code>--end-to-end</code> mode</h4><table><thead><tr><th><code>--very-fast</code></th><th>Same as: <code>-D 5 -R 1 -N 0 -L 22 -i S,0,2.50</code></th></tr></thead><tbody><tr><td><code>--fast</code></td><td>Same as: <code>-D 10 -R 2 -N 0 -L 22 -i S,0,2.50</code></td></tr><tr><td><code>--sensitive</code></td><td>Same as: <code>-D 15 -R 2 -N 0 -L 22 -i S,1,1.15</code> (default in <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-end-to-end"><code>--end-to-end</code></a> mode)</td></tr><tr><td><code>--very-sensitive</code></td><td>Same as: <code>-D 20 -R 3 -N 0 -L 20 -i S,1,0.50</code></td></tr></tbody></table><h4 id="Preset-options-in-local-mode"><a href="#Preset-options-in-local-mode" class="headerlink" title="Preset options in --local mode"></a>Preset options in <code>--local</code> mode</h4><table><thead><tr><th><code>--very-fast-local</code></th><th>Same as: <code>-D 5 -R 1 -N 0 -L 25 -i S,1,2.00</code></th></tr></thead><tbody><tr><td><code>--fast-local</code></td><td>Same as: <code>-D 10 -R 2 -N 0 -L 22 -i S,1,1.75</code></td></tr><tr><td><code>--sensitive-local</code></td><td>Same as: <code>-D 15 -R 2 -N 0 -L 20 -i S,1,0.75</code> (default in <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-local"><code>--local</code></a> mode)</td></tr><tr><td><code>--very-sensitive-local</code></td><td>Same as: <code>-D 20 -R 3 -N 0 -L 20 -i S,1,0.50</code></td></tr></tbody></table><h4 id="Alignment-options"><a href="#Alignment-options" class="headerlink" title="Alignment options"></a>Alignment options</h4><table><thead><tr><th><code>-N &lt;int&gt;</code></th><th>Sets the number of mismatches to allowed in a seed alignment during <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#multiseed-heuristic">multiseed alignment</a>. Can be set to 0 or 1. Setting this higher makes alignment slower (often much slower) but increases sensitivity. Default: 0.</th></tr></thead><tbody><tr><td><code>-L &lt;int&gt;</code></td><td><strong>Sets the length of the seed substrings to align</strong> during <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#multiseed-heuristic">multiseed alignment</a>. <font color="red"><strong>Smaller values make alignment slower but more sensitive</strong></font>. Default: the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-sensitive"><code>--sensitive</code></a> preset is used by default, which sets <code>-L</code> to 22 and 20 in <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-end-to-end"><code>--end-to-end</code></a> mode and in <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-local"><code>--local</code></a> mode.</td></tr><tr><td><code>-i &lt;func&gt;</code></td><td>Sets a function governing the interval between seed substrings to use during <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#multiseed-heuristic">multiseed alignment</a>. For instance, if the read has 30 characters, and seed length is 10, and the seed interval is 6, the seeds extracted will be:<code>Read:      TAGCTACGCTCTACGCTATCATGCATAAAC Seed 1 fw: TAGCTACGCT Seed 1 rc: AGCGTAGCTA Seed 2 fw:       CGCTCTACGC Seed 2 rc:       GCGTAGAGCG Seed 3 fw:             ACGCTATCAT Seed 3 rc:             ATGATAGCGT Seed 4 fw:                   TCATGCATAA Seed 4 rc:                   TTATGCATGA</code>Since itâ€™s best to use longer intervals for longer reads, this parameter sets the interval as a function of the read length, rather than a single one-size-fits-all number. For instance, specifying <code>-i S,1,2.5</code> sets the interval function <code>f</code> to <code>f(x) = 1 + 2.5 * sqrt(x)</code>, where x is the read length. See also: <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#setting-function-options">setting function options</a>. If the function returns a result less than 1, it is rounded up to 1. Default: the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-sensitive"><code>--sensitive</code></a> preset is used by default, which sets <code>-i</code> to <code>S,1,1.15</code> in <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-end-to-end"><code>--end-to-end</code></a>mode to <code>-i S,1,0.75</code> in <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-local"><code>--local</code></a> mode.</td></tr><tr><td><code>--n-ceil &lt;func&gt;</code></td><td>Sets a function governing the maximum number of ambiguous characters (usually <code>N</code>s and&#x2F;or <code>.</code>s) allowed in a read as a function of read length. For instance, specifying <code>-L,0,0.15</code> sets the N-ceiling function <code>f</code> to <code>f(x) = 0 + 0.15 * x</code>, where x is the read length. See also: <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#setting-function-options">setting function options</a>. Reads exceeding this ceiling are <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#filtering">filtered out</a>. Default: <code>L,0,0.15</code>.</td></tr><tr><td><code>--dpad &lt;int&gt;</code></td><td>â€œPadsâ€ dynamic programming problems by <code>&lt;int&gt;</code> columns on either side to allow gaps. Default: 15.</td></tr><tr><td><code>--gbar &lt;int&gt;</code></td><td>Disallow gaps within <code>&lt;int&gt;</code> positions of the beginning or end of the read. Default: 4.</td></tr><tr><td><code>--ignore-quals</code></td><td>When calculating a mismatch penalty, always consider the quality value at the mismatched position to be the highest possible, regardless of the actual value. I.e. input is treated as though all quality values are high. This is also the default behavior when the input doesnâ€™t specify quality values (e.g. in <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-f"><code>-f</code></a>, <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-r"><code>-r</code></a>, or <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-c"><code>-c</code></a> modes).</td></tr><tr><td><code>--nofw/--norc</code></td><td>If <code>--nofw</code> is specified, <code>bowtie2</code> will not attempt to align unpaired reads to the forward (Watson) reference strand. If <code>--norc</code> is specified, <code>bowtie2</code> will not attempt to align unpaired reads against the reverse-complement (Crick) reference strand. In paired-end mode, <code>--nofw</code> and <code>--norc</code> pertain to the fragments; i.e. specifying <code>--nofw</code> causes <code>bowtie2</code> to explore only those paired-end configurations corresponding to fragments from the reverse-complement (Crick) strand. Default: both strands enabled.</td></tr><tr><td><code>--no-1mm-upfront</code></td><td>By default, Bowtie 2 will attempt to find either an exact or a 1-mismatch end-to-end alignment for the read <em>before</em> trying the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#multiseed-heuristic">multiseed heuristic</a>. Such alignments can be found very quickly, and many short read alignments have exact or near-exact end-to-end alignments. However, this can lead to unexpected alignments when the user also sets options governing the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#multiseed-heuristic">multiseed heuristic</a>, like <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-L"><code>-L</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-N"><code>-N</code></a>. For instance, if the user specifies <code>-N 0</code> and <code>-L</code> equal to the length of the read, the user will be surprised to find 1-mismatch alignments reported. This option prevents Bowtie 2 from searching for 1-mismatch end-to-end alignments before using the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#multiseed-heuristic">multiseed heuristic</a>, which leads to the expected behavior when combined with options such as <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-L"><code>-L</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-N"><code>-N</code></a>. This comes at the expense of speed.</td></tr><tr><td><code>--end-to-end</code></td><td>In this mode, Bowtie 2 requires that the entire read align from one end to the other, without any trimming (or â€œsoft clippingâ€) of characters from either end. The match bonus <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-ma"><code>--ma</code></a> always equals 0 in this mode, so all alignment scores are less than or equal to 0, and the greatest possible alignment score is 0. This is mutually exclusive with <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-local"><code>--local</code></a>. <code>--end-to-end</code> is the default mode.</td></tr><tr><td><code>--local</code></td><td>In this mode, Bowtie 2 does not require that the entire read align from one end to the other. Rather, some characters may be omitted (â€œsoft clippedâ€) from the ends in order to achieve the greatest possible alignment score. The match bonus <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-ma"><code>--ma</code></a>is used in this mode, and the best possible alignment score is equal to the match bonus (<a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-ma"><code>--ma</code></a>) times the length of the read. Specifying <code>--local</code> and one of the presets (e.g. <code>--local --very-fast</code>) is equivalent to specifying the local version of the preset (<code>--very-fast-local</code>). This is mutually exclusive with <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-end-to-end"><code>--end-to-end</code></a>. <code>--end-to-end</code> is the default mode.</td></tr></tbody></table><h4 id="Scoring-options"><a href="#Scoring-options" class="headerlink" title="Scoring options"></a>Scoring options</h4><table><thead><tr><th><code>--ma &lt;int&gt;</code></th><th>Sets the match bonus. In <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-local"><code>--local</code></a> mode <code>&lt;int&gt;</code> is added to the alignment score for each position where a read character aligns to a reference character and the characters match. Not used in <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-end-to-end"><code>--end-to-end</code></a> mode. Default: 2.</th></tr></thead><tbody><tr><td><code>--mp MX,MN</code></td><td>Sets the maximum (<code>MX</code>) and minimum (<code>MN</code>) mismatch penalties, both integers. A number less than or equal to <code>MX</code> and greater than or equal to <code>MN</code> is subtracted from the alignment score for each position where a read character aligns to a reference character, the characters do not match, and neither is an <code>N</code>. If <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-ignore-quals"><code>--ignore-quals</code></a> is specified, the number subtracted quals <code>MX</code>. Otherwise, the number subtracted is <code>MN + floor( (MX-MN)(MIN(Q, 40.0)/40.0) )</code> where Q is the Phred quality value. Default: <code>MX</code> &#x3D; 6, <code>MN</code> &#x3D; 2.</td></tr><tr><td><code>--np &lt;int&gt;</code></td><td>Sets penalty for positions where the read, reference, or both, contain an ambiguous character such as <code>N</code>. Default: 1.</td></tr><tr><td><code>--rdg &lt;int1&gt;,&lt;int2&gt;</code></td><td>Sets the read gap open (<code>&lt;int1&gt;</code>) and extend (<code>&lt;int2&gt;</code>) penalties. A read gap of length N gets a penalty of <code>&lt;int1&gt;</code> + N * <code>&lt;int2&gt;</code>. Default: 5, 3.</td></tr><tr><td><code>--rfg &lt;int1&gt;,&lt;int2&gt;</code></td><td>Sets the reference gap open (<code>&lt;int1&gt;</code>) and extend (<code>&lt;int2&gt;</code>) penalties. A reference gap of length N gets a penalty of <code>&lt;int1&gt;</code> + N * <code>&lt;int2&gt;</code>. Default: 5, 3.</td></tr><tr><td><code>--score-min &lt;func&gt;</code></td><td>Sets a function governing the minimum alignment score needed for an alignment to be considered â€œvalidâ€ (i.e. good enough to report). This is a function of read length. For instance, specifying <code>L,0,-0.6</code> sets the minimum-score function <code>f</code> to <code>f(x) = 0 + -0.6 * x</code>, where <code>x</code> is the read length. See also: <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#setting-function-options">setting function options</a>. The default in <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-end-to-end"><code>--end-to-end</code></a>mode is <code>L,-0.6,-0.6</code> and the default in <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-local"><code>--local</code></a> mode is <code>G,20,8</code>.</td></tr></tbody></table><h4 id="Reporting-options"><a href="#Reporting-options" class="headerlink" title="Reporting options"></a>Reporting options</h4><table><thead><tr><th><code>-k &lt;int&gt;</code></th><th>By default, <code>bowtie2</code> searches for distinct, valid alignments for each read. When it finds a valid alignment, it continues looking for alignments that are nearly as good or better. The best alignment found is reported (randomly selected from among best if tied). Information about the best alignments is used to estimate mapping quality and to set SAM optional fields, such as <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-opt-fields-as"><code>AS:i</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-opt-fields-xs"><code>XS:i</code></a>.When <code>-k</code> is specified, however, <code>bowtie2</code> behaves differently. Instead, it searches for at most <code>&lt;int&gt;</code> distinct, valid alignments for each read. The search terminates when it canâ€™t find more distinct valid alignments, or when it finds <code>&lt;int&gt;</code>, whichever happens first. All alignments found are reported in descending order by alignment score. The alignment score for a paired-end alignment equals the sum of the alignment scores of the individual mates. Each reported read or pair alignment beyond the first has the SAM â€˜secondaryâ€™ bit (which equals 256) set in its FLAGS field. For reads that have more than <code>&lt;int&gt;</code> distinct, valid alignments, <code>bowtie2</code>does not guarantee that the <code>&lt;int&gt;</code> alignments reported are the best possible in terms of alignment score. <code>-k</code> is mutually exclusive with <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-a"><code>-a</code></a>.Note: Bowtie 2 is not designed with large values for <code>-k</code> in mind, and when aligning reads to long, repetitive genomes large <code>-k</code> can be very, very slow.</th></tr></thead><tbody><tr><td><code>-a</code></td><td>Like <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-k"><code>-k</code></a> but with no upper limit on number of alignments to search for. <code>-a</code> is mutually exclusive with <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-k"><code>-k</code></a>.Note: Bowtie 2 is not designed with <code>-a</code> mode in mind, and when aligning reads to long, repetitive genomes this mode can be very, very slow.</td></tr></tbody></table><h4 id="Effort-options"><a href="#Effort-options" class="headerlink" title="Effort options"></a>Effort options</h4><table><thead><tr><th><code>-D &lt;int&gt;</code></th><th>Up to <code>&lt;int&gt;</code> consecutive seed extension attempts can â€œfailâ€ before Bowtie 2 moves on, using the alignments found so far. A seed extension â€œfailsâ€ if it does not yield a new best or a new second-best alignment. This limit is automatically adjusted up when -k or -a are specified. Default: 15.</th></tr></thead><tbody><tr><td><code>-R &lt;int&gt;</code></td><td><code>&lt;int&gt;</code> is the maximum number of times Bowtie 2 will â€œre-seedâ€ reads with repetitive seeds. When â€œre-seeding,â€ Bowtie 2 simply chooses a new set of reads (same length, same number of mismatches allowed) at different offsets and searches for more alignments. A read is considered to have repetitive seeds if the total number of seed hits divided by the number of seeds that aligned at least once is greater than 300. Default: 2.</td></tr></tbody></table><h4 id="Paired-end-options"><a href="#Paired-end-options" class="headerlink" title="Paired-end options"></a>Paired-end options</h4><table><thead><tr><th><code>-I/--minins &lt;int&gt;</code></th><th>The minimum fragment length for valid paired-end alignments. E.g. if <code>-I 60</code> is specified and a paired-end alignment consists of two 20-bp alignments in the appropriate orientation with a 20-bp gap between them, that alignment is considered valid (as long as <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-X"><code>-X</code></a> is also satisfied). A 19-bp gap would not be valid in that case. If trimming options <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-3"><code>-3</code></a> or <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-5"><code>-5</code></a>are also used, the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-I"><code>-I</code></a> constraint is applied with respect to the untrimmed mates.The larger the difference between <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-I"><code>-I</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-X"><code>-X</code></a>, the slower Bowtie 2 will run. This is because larger differences between <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-I"><code>-I</code></a>and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-X"><code>-X</code></a> require that Bowtie 2 scan a larger window to determine if a concordant alignment exists. For typical fragment length ranges (200 to 400 nucleotides), Bowtie 2 is very efficient.Default: 0 (essentially imposing no minimum)</th></tr></thead><tbody><tr><td><code>-X/--maxins &lt;int&gt;</code></td><td>The maximum fragment length for valid paired-end alignments. E.g. if <code>-X 100</code> is specified and a paired-end alignment consists of two 20-bp alignments in the proper orientation with a 60-bp gap between them, that alignment is considered valid (as long as <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-I"><code>-I</code></a> is also satisfied). A 61-bp gap would not be valid in that case. If trimming options <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-3"><code>-3</code></a> or <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-5"><code>-5</code></a> are also used, the <code>-X</code> constraint is applied with respect to the untrimmed mates, not the trimmed mates.The larger the difference between <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-I"><code>-I</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-X"><code>-X</code></a>, the slower Bowtie 2 will run. This is because larger differences between <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-I"><code>-I</code></a>and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-X"><code>-X</code></a> require that Bowtie 2 scan a larger window to determine if a concordant alignment exists. For typical fragment length ranges (200 to 400 nucleotides), Bowtie 2 is very efficient.Default: 500.</td></tr><tr><td><code>--fr/--rf/--ff</code></td><td>The upstream&#x2F;downstream mate orientations for a valid paired-end alignment against the forward reference strand. E.g., if <code>--fr</code> is specified and there is a candidate paired-end alignment where mate 1 appears upstream of the reverse complement of mate 2 and the fragment length constraints (<a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-I"><code>-I</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-X"><code>-X</code></a>) are met, that alignment is valid. Also, if mate 2 appears upstream of the reverse complement of mate 1 and all other constraints are met, that too is valid. <code>--rf</code> likewise requires that an upstream mate1 be reverse-complemented and a downstream mate2 be forward-oriented. <code>--ff</code> requires both an upstream mate 1 and a downstream mate 2 to be forward-oriented. Default: <code>--fr</code> (appropriate for Illuminaâ€™s Paired-end Sequencing Assay).</td></tr><tr><td><code>--no-mixed</code></td><td>By default, when <code>bowtie2</code> cannot find a concordant or discordant alignment for a pair, it then tries to find alignments for the individual mates. This option disables that behavior.</td></tr><tr><td><code>--no-discordant</code></td><td>By default, <code>bowtie2</code> looks for discordant alignments if it cannot find any concordant alignments. A discordant alignment is an alignment where both mates align uniquely, but that does not satisfy the paired-end constraints (<a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-fr"><code>--fr</code>&#x2F;<code>--rf</code>&#x2F;<code>--ff</code></a>, <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-I"><code>-I</code></a>, <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-X"><code>-X</code></a>). This option disables that behavior.</td></tr><tr><td><code>--dovetail</code></td><td>If the mates â€œdovetailâ€, that is if one mate alignment extends past the beginning of the other such that the wrong mate begins upstream, consider that to be concordant. See also: <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#mates-can-overlap-contain-or-dovetail-each-other">Mates can overlap, contain or dovetail each other</a>. Default: mates cannot dovetail in a concordant alignment.</td></tr><tr><td><code>--no-contain</code></td><td>If one mate alignment contains the other, consider that to be non-concordant. See also: <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#mates-can-overlap-contain-or-dovetail-each-other">Mates can overlap, contain or dovetail each other</a>. Default: a mate can contain the other in a concordant alignment.</td></tr><tr><td><code>--no-overlap</code></td><td>If one mate alignment overlaps the other at all, consider that to be non-concordant. See also: <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#mates-can-overlap-contain-or-dovetail-each-other">Mates can overlap, contain or dovetail each other</a>. Default: mates can overlap in a concordant alignment.</td></tr></tbody></table><h4 id="BAM-options"><a href="#BAM-options" class="headerlink" title="BAM options"></a>BAM options</h4><table><thead><tr><th><code>--align-paired-reads</code></th><th>Bowtie 2 will, by default, attempt to align unpaired BAM reads. Use this option to align paired-end reads instead.</th></tr></thead><tbody><tr><td><code>--preserve-tags</code></td><td>Preserve tags from the original BAM record by appending them to the end of the corresponding Bowtie 2 SAM output.</td></tr></tbody></table><h4 id="Output-options"><a href="#Output-options" class="headerlink" title="Output options"></a>Output options</h4><table><thead><tr><th><code>-t/--time</code></th><th>Print the wall-clock time required to load the index files and align the reads. This is printed to the â€œstandard errorâ€ (â€œstderrâ€) filehandle. Default: off.</th></tr></thead><tbody><tr><td><code>--un &lt;path&gt; --un-gz &lt;path&gt; --un-bz2 &lt;path&gt; --un-lz4 &lt;path&gt;</code></td><td>Write unpaired reads that fail to align to file at <code>&lt;path&gt;</code>. These reads correspond to the SAM records with the FLAGS <code>0x4</code> bit set and neither the <code>0x40</code> nor <code>0x80</code> bits set. If <code>--un-gz</code> is specified, output will be gzip compressed. If <code>--un-bz2</code>or <code>--un-lz4</code> is specified, output will be bzip2 or lz4 compressed. Reads written in this way will appear exactly as they did in the input file, without any modification (same sequence, same name, same quality string, same quality encoding). Reads will not necessarily appear in the same order as they did in the input.</td></tr><tr><td><code>--al &lt;path&gt; --al-gz &lt;path&gt; --al-bz2 &lt;path&gt; --al-lz4 &lt;path&gt;</code></td><td>Write unpaired reads that align at least once to file at <code>&lt;path&gt;</code>. These reads correspond to the SAM records with the FLAGS <code>0x4</code>, <code>0x40</code>, and <code>0x80</code> bits unset. If <code>--al-gz</code> is specified, output will be gzip compressed. If <code>--al-bz2</code> is specified, output will be bzip2 compressed. Similarly if <code>--al-lz4</code> is specified, output will be lz4 compressed. Reads written in this way will appear exactly as they did in the input file, without any modification (same sequence, same name, same quality string, same quality encoding). Reads will not necessarily appear in the same order as they did in the input.</td></tr><tr><td><code>--un-conc &lt;path&gt; --un-conc-gz &lt;path&gt; --un-conc-bz2 &lt;path&gt; --un-conc-lz4 &lt;path&gt;</code></td><td>Write paired-end reads that fail to align concordantly to file(s) at <code>&lt;path&gt;</code>. These reads correspond to the SAM records with the FLAGS <code>0x4</code> bit set and either the <code>0x40</code> or <code>0x80</code> bit set (depending on whether itâ€™s mate #1 or #2). <code>.1</code> and <code>.2</code>strings are added to the filename to distinguish which file contains mate #1 and mate #2. If a percent symbol, <code>%</code>, is used in <code>&lt;path&gt;</code>, the percent symbol is replaced with <code>1</code> or <code>2</code> to make the per-mate filenames. Otherwise, <code>.1</code> or <code>.2</code> are added before the final dot in <code>&lt;path&gt;</code> to make the per-mate filenames. Reads written in this way will appear exactly as they did in the input files, without any modification (same sequence, same name, same quality string, same quality encoding). Reads will not necessarily appear in the same order as they did in the inputs.</td></tr><tr><td><code>--al-conc &lt;path&gt; --al-conc-gz &lt;path&gt; --al-conc-bz2 &lt;path&gt; --al-conc-lz4 &lt;path&gt;</code></td><td>Write paired-end reads that align concordantly at least once to file(s) at <code>&lt;path&gt;</code>. These reads correspond to the SAM records with the FLAGS <code>0x4</code> bit unset and either the <code>0x40</code> or <code>0x80</code> bit set (depending on whether itâ€™s mate #1 or #2). <code>.1</code> and <code>.2</code> strings are added to the filename to distinguish which file contains mate #1 and mate #2. If a percent symbol, <code>%</code>, is used in <code>&lt;path&gt;</code>, the percent symbol is replaced with <code>1</code> or <code>2</code> to make the per-mate filenames. Otherwise, <code>.1</code> or <code>.2</code> are added before the final dot in <code>&lt;path&gt;</code> to make the per-mate filenames. Reads written in this way will appear exactly as they did in the input files, without any modification (same sequence, same name, same quality string, same quality encoding). Reads will not necessarily appear in the same order as they did in the inputs.</td></tr><tr><td><code>--quiet</code></td><td>Print nothing besides alignments and serious errors.</td></tr><tr><td><code>--met-file &lt;path&gt;</code></td><td>Write <code>bowtie2</code> metrics to file <code>&lt;path&gt;</code>. Having alignment metric can be useful for debugging certain problems, especially performance issues. See also: <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-met"><code>--met</code></a>. Default: metrics disabled.</td></tr><tr><td><code>--met-stderr &lt;path&gt;</code></td><td>Write <code>bowtie2</code> metrics to the â€œstandard errorâ€ (â€œstderrâ€) filehandle. This is not mutually exclusive with <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-met-file"><code>--met-file</code></a>. Having alignment metric can be useful for debugging certain problems, especially performance issues. See also: <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-met"><code>--met</code></a>. Default: metrics disabled.</td></tr><tr><td><code>--met &lt;int&gt;</code></td><td>Write a new <code>bowtie2</code> metrics record every <code>&lt;int&gt;</code> seconds. Only matters if either <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-met-stderr"><code>--met-stderr</code></a> or <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-met-file"><code>--met-file</code></a> are specified. Default: 1.</td></tr></tbody></table><h4 id="SAM-options"><a href="#SAM-options" class="headerlink" title="SAM options"></a>SAM options</h4><table><thead><tr><th><code>--no-unal</code></th><th>Suppress SAM records for reads that failed to align.</th></tr></thead><tbody><tr><td><code>--no-hd</code></td><td>Suppress SAM header lines (starting with <code>@</code>).</td></tr><tr><td><code>--no-sq</code></td><td>Suppress <code>@SQ</code> SAM header lines.</td></tr><tr><td><code>--rg-id &lt;text&gt;</code></td><td>Set the read group ID to <code>&lt;text&gt;</code>. This causes the SAM <code>@RG</code> header line to be printed, with <code>&lt;text&gt;</code> as the value associated with the <code>ID:</code> tag. It also causes the <code>RG:Z:</code> extra field to be attached to each SAM output record, with value set to <code>&lt;text&gt;</code>.</td></tr><tr><td><code>--rg &lt;text&gt;</code></td><td>Add <code>&lt;text&gt;</code> (usually of the form <code>TAG:VAL</code>, e.g. <code>SM:Pool1</code>) as a field on the <code>@RG</code> header line. Note: in order for the <code>@RG</code> line to appear, <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-rg-id"><code>--rg-id</code></a> must also be specified. This is because the <code>ID</code> tag is required by the <a href="http://samtools.sourceforge.net/SAM1.pdf">SAM Spec</a>. Specify <code>--rg</code> multiple times to set multiple fields. See the <a href="http://samtools.sourceforge.net/SAM1.pdf">SAM Spec</a> for details about what fields are legal.</td></tr><tr><td><code>--omit-sec-seq</code></td><td>When printing secondary alignments, Bowtie 2 by default will write out the <code>SEQ</code> and <code>QUAL</code> strings. Specifying this option causes Bowtie 2 to print an asterisk in those fields instead.</td></tr><tr><td><code>--soft-clipped-unmapped-tlen</code></td><td>Consider soft-clipped bases unmapped when calculating <code>TLEN</code>. Only available in <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-local"><code>--local</code></a> mode.</td></tr><tr><td><code>--sam-no-qname-trunc</code></td><td>Suppress standard behavior of truncating readname at first whitespace at the expense of generating non-standard SAM</td></tr><tr><td><code>--xeq</code></td><td>Use <code>&#39;=&#39;/&#39;X&#39;</code>, instead of <code>&#39;M&#39;</code>, to specify matches&#x2F;mismatches in SAM record</td></tr><tr><td><code>--sam-append-comment</code></td><td>Append FASTA&#x2F;FASTQ comment to SAM record, where a comment is everything after the first space in the read name.</td></tr></tbody></table><h4 id="Performance-options"><a href="#Performance-options" class="headerlink" title="Performance options"></a>Performance options</h4><table><thead><tr><th><code>-o/--offrate &lt;int&gt;</code></th><th>Override the offrate of the index with <code>&lt;int&gt;</code>. If <code>&lt;int&gt;</code> is greater than the offrate used to build the index, then some row markings are discarded when the index is read into memory. This reduces the memory footprint of the aligner but requires more time to calculate text offsets. <code>&lt;int&gt;</code> must be greater than the value used to build the index.</th></tr></thead><tbody><tr><td><code>-p/--threads NTHREADS</code></td><td>Launch <code>NTHREADS</code> parallel search threads (default: 1). Threads will run on separate processors&#x2F;cores and synchronize when parsing reads and outputting alignments. Searching for alignments is highly parallel, and speedup is close to linear. Increasing <code>-p</code> increases Bowtie 2â€™s memory footprint. E.g. when aligning to a human genome index, increasing <code>-p</code> from 1 to 8 increases the memory footprint by a few hundred megabytes. This option is only available if <code>bowtie</code> is linked with the <code>pthreads</code> library (i.e. if <code>BOWTIE_PTHREADS=0</code> is not specified at build time).</td></tr><tr><td><code>--reorder</code></td><td>Guarantees that output SAM records are printed in an order corresponding to the order of the reads in the original input file, even when <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-p"><code>-p</code></a> is set greater than 1. Specifying <code>--reorder</code> and setting <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-p"><code>-p</code></a> greater than 1 causes Bowtie 2 to run somewhat slower and use somewhat more memory than if <code>--reorder</code> were not specified. Has no effect if <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-p"><code>-p</code></a> is set to 1, since output order will naturally correspond to input order in that case.</td></tr><tr><td><code>--mm</code></td><td>Use memory-mapped I&#x2F;O to load the index, rather than typical file I&#x2F;O. Memory-mapping allows many concurrent <code>bowtie</code> processes on the same computer to share the same memory image of the index (i.e. you pay the memory overhead just once). This facilitates memory-efficient parallelization of <code>bowtie</code> in situations where using <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-p"><code>-p</code></a> is not possible or not preferable.</td></tr></tbody></table><h4 id="Other-options"><a href="#Other-options" class="headerlink" title="Other options"></a>Other options</h4><table><thead><tr><th><code>--qc-filter</code></th><th>Filter out reads for which the QSEQ filter field is non-zero. Only has an effect when read format is <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-qseq"><code>--qseq</code></a>. Default: off.</th></tr></thead><tbody><tr><td><code>--seed &lt;int&gt;</code></td><td>Use <code>&lt;int&gt;</code> as the seed for pseudo-random number generator. Default: 0.</td></tr><tr><td><code>--non-deterministic</code></td><td>Normally, Bowtie 2 re-initializes its pseudo-random generator for each read. It seeds the generator with a number derived from (a) the read name, (b) the nucleotide sequence, (c) the quality sequence, (d) the value of the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-seed"><code>--seed</code></a>option. This means that if two reads are identical (same name, same nucleotides, same qualities) Bowtie 2 will find and report the same alignment(s) for both, even if there was ambiguity. When <code>--non-deterministic</code> is specified, Bowtie 2 re-initializes its pseudo-random generator for each read using the current time. This means that Bowtie 2 will not necessarily report the same alignment for two identical reads. This is counter-intuitive for some users, but might be more appropriate in situations where the input consists of many identical reads.</td></tr><tr><td><code>--version</code></td><td>Print version information and quit.</td></tr><tr><td><code>-h/--help</code></td><td>Print usage information and quit.</td></tr></tbody></table><h2 id="SAM-output"><a href="#SAM-output" class="headerlink" title="SAM output"></a>SAM output</h2><p>Following is a brief description of the <a href="http://samtools.sourceforge.net/SAM1.pdf">SAM</a> format as output by <code>bowtie2</code>. For more details, see the <a href="http://samtools.sourceforge.net/SAM1.pdf">SAM format specification</a>.</p><p>By default, <code>bowtie2</code> prints a SAM header with <code>@HD</code>, <code>@SQ</code> and <code>@PG</code> lines. When one or more <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-rg"><code>--rg</code></a> arguments are specified, <code>bowtie2</code> will also print an <code>@RG</code> line that includes all user-specified <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-rg"><code>--rg</code></a> tokens separated by tabs.</p><p>Each subsequent line describes an alignment or, if the read failed to align, a read. Each line is a collection of at least 12 fields separated by tabs; from left to right, the fields are:</p><ol><li><p>Name of read that aligned.</p><p>Note that the <a href="http://samtools.sourceforge.net/SAM1.pdf">SAM specification</a> disallows whitespace in the read name. If the read name contains any whitespace characters, Bowtie 2 will truncate the name at the first whitespace character. This is similar to the behavior of other tools. The standard behavior of truncating at the first whitespace can be suppressed with <code>--sam-no-qname-trunc</code> at the expense of generating non-standard SAM.</p></li><li><p><font color="red">Sum of all applicable flags. Flags relevant to Bowtie are:</font></p><table><thead><tr><th><code>1</code></th><th>The read is one of a pair</th></tr></thead><tbody><tr><td><code>2</code></td><td>The alignment is one end of a proper paired-end alignment</td></tr><tr><td><code>4</code></td><td>The read has no reported alignments</td></tr><tr><td><code>8</code></td><td>The read is one of a pair and has no reported alignments</td></tr><tr><td><code>16</code></td><td>The alignment is to the reverse reference strand</td></tr><tr><td><code>32</code></td><td>The other mate in the paired-end alignment is aligned to the reverse reference strand</td></tr><tr><td><code>64</code></td><td>The read is mate 1 in a pair</td></tr><tr><td><code>128</code></td><td>The read is mate 2 in a pair</td></tr></tbody></table><p>Thus, an unpaired read that aligns to the reverse reference strand will have flag 16. A paired-end read that aligns and is the first mate in the pair will have flag 83 (&#x3D; 64 + 16 + 2 + 1).</p></li><li><p>Name of reference sequence where alignment occurs</p></li><li><p>1-based offset into the forward reference strand where leftmost character of the alignment occurs</p></li><li><p>Mapping quality</p></li><li><p>CIGAR string representation of alignment</p></li><li><p>Name of reference sequence where mateâ€™s alignment occurs. Set to <code>=</code> if the mateâ€™s reference sequence is the same as this alignmentâ€™s, or <code>*</code>if there is no mate.</p></li><li><p>1-based offset into the forward reference strand where leftmost character of the mateâ€™s alignment occurs. Offset is 0 if there is no mate.</p></li><li><p>Inferred fragment length. Size is negative if the mateâ€™s alignment occurs upstream of this alignment. Size is 0 if the mates did not align concordantly. However, size is non-0 if the mates aligned discordantly to the same chromosome.</p></li><li><p>Read sequence (reverse-complemented if aligned to the reverse strand)</p></li><li><p>ASCII-encoded read qualities (reverse-complemented if the read aligned to the reverse strand). The encoded quality values are on the <a href="http://en.wikipedia.org/wiki/Phred_quality_score">Phred quality</a> scale and the encoding is ASCII-offset by 33 (ASCII char <code>!</code>), similarly to a <a href="http://en.wikipedia.org/wiki/FASTQ_format">FASTQ</a> file.</p></li><li><p>Optional fields. Fields are tab-separated. <code>bowtie2</code> outputs zero or more of these optional fields for each alignment, depending on the type of the alignment:</p></li></ol><table><thead><tr><th><code>AS:i:&lt;N&gt;</code></th><th>Alignment score. Can be negative. Can be greater than 0 in <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-local"><code>--local</code></a> mode (but not in <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-end-to-end"><code>--end-to-end</code></a> mode). Only present if SAM record is for an aligned read.</th></tr></thead><tbody><tr><td><code>XS:i:&lt;N&gt;</code></td><td>Alignment score for the best-scoring alignment found other than the alignment reported. Can be negative. Can be greater than 0 in <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-local"><code>--local</code></a> mode (but not in <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-end-to-end"><code>--end-to-end</code></a> mode). Only present if the SAM record is for an aligned read and more than one alignment was found for the read. Note that, when the read is part of a concordantly-aligned pair, this score could be greater than <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-opt-fields-as"><code>AS:i</code></a>.</td></tr><tr><td><code>YS:i:&lt;N&gt;</code></td><td>Alignment score for opposite mate in the paired-end alignment. Only present if the SAM record is for a read that aligned as part of a paired-end alignment.</td></tr><tr><td><code>XN:i:&lt;N&gt;</code></td><td>The number of ambiguous bases in the reference covering this alignment. Only present if SAM record is for an aligned read.</td></tr><tr><td><code>XM:i:&lt;N&gt;</code></td><td>The number of mismatches in the alignment. Only present if SAM record is for an aligned read.</td></tr><tr><td><code>XO:i:&lt;N&gt;</code></td><td>The number of gap opens, for both read and reference gaps, in the alignment. Only present if SAM record is for an aligned read.</td></tr><tr><td><code>XG:i:&lt;N&gt;</code></td><td>The number of gap extensions, for both read and reference gaps, in the alignment. Only present if SAM record is for an aligned read.</td></tr><tr><td><code>NM:i:&lt;N&gt;</code></td><td>The edit distance; that is, the minimal number of one-nucleotide edits (substitutions, insertions and deletions) needed to transform the read string into the reference string. Only present if SAM record is for an aligned read.</td></tr><tr><td><code>YF:Z:&lt;S&gt;</code></td><td>String indicating reason why the read was filtered out. See also: <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#filtering">Filtering</a>. Only appears for reads that were filtered out.</td></tr><tr><td><code>YT:Z:&lt;S&gt;</code></td><td>Value of <code>UU</code> indicates the read was not part of a pair. Value of <code>CP</code> indicates the read was part of a pair and the pair aligned concordantly. Value of <code>DP</code> indicates the read was part of a pair and the pair aligned discordantly. Value of <code>UP</code> indicates the read was part of a pair but the pair failed to aligned either concordantly or discordantly.</td></tr><tr><td><code>MD:Z:&lt;S&gt;</code></td><td>A string representation of the mismatched reference bases in the alignment. See <a href="https://samtools.github.io/hts-specs/SAMtags.pdf">SAM Tags format specification</a> for details. Only present if SAM record is for an aligned read.</td></tr></tbody></table><h1 id="The-bowtie2-build-indexer"><a href="#The-bowtie2-build-indexer" class="headerlink" title="The bowtie2-build indexer"></a>The <code>bowtie2-build</code> indexer</h1><p><code>bowtie2-build</code> builds a Bowtie index from a set of DNA sequences. <code>bowtie2-build</code> outputs a set of 6 files with suffixes <code>.1.bt2</code>, <code>.2.bt2</code>, <code>.3.bt2</code>, <code>.4.bt2</code>, <code>.rev.1.bt2</code>, and <code>.rev.2.bt2</code>. In the case of a large index these suffixes will have a <code>bt2l</code> termination. These files together constitute the index: they are all that is needed to align reads to that reference. The original sequence <a href="https://en.wikipedia.org/wiki/FASTA"><code>FASTA</code></a> files are no longer used by Bowtie 2 once the index is built.</p><p>Bowtie 2â€™s <code>.bt2</code> index format is different from Bowtie 1â€™s <code>.ebwt</code> format, and they are not compatible with each other.</p><p>Use of Karkkainenâ€™s <a href="http://portal.acm.org/citation.cfm?id=1314852">blockwise algorithm</a> allows <code>bowtie2-build</code> to trade off between running time and memory usage. <code>bowtie2-build</code> has three options governing how it makes this trade: <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-p"><code>-p</code>&#x2F;<code>--packed</code></a>, <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-bmax"><code>--bmax</code></a>&#x2F;<a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-bmaxdivn"><code>--bmaxdivn</code></a>, and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-dcv"><code>--dcv</code></a>. By default, <code>bowtie2-build</code> will automatically search for the settings that yield the best running time without exhausting memory. This behavior can be disabled using the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-a"><code>-a</code>&#x2F;<code>--noauto</code></a> option.</p><p>The indexer provides options pertaining to the â€œshapeâ€ of the index, e.g. <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-o"><code>--offrate</code></a> governs the fraction of <a href="http://en.wikipedia.org/wiki/Burrows-Wheeler_transform">Burrows-Wheeler</a> rows that are â€œmarkedâ€ (i.e., the density of the suffix-array sample; see the original <a href="http://portal.acm.org/citation.cfm?id=796543">FM Index</a> paper for details). All of these options are potentially profitable trade-offs depending on the application. They have been set to defaults that are reasonable for most cases according to our experiments. See <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#performance-tuning">Performance tuning</a> for details.</p><p><code>bowtie2-build</code> can generate either <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#small-and-large-indexes">small or large indexes</a>. The wrapper will decide which based on the length of the input genome. If the reference does not exceed 4 billion characters but a large index is preferred, the user can specify <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-large-index"><code>--large-index</code></a> to force <code>bowtie2-build</code> to build a large index instead.</p><p>The Bowtie 2 index is based on the <a href="http://portal.acm.org/citation.cfm?id=796543">FM Index</a> of Ferragina and Manzini, which in turn is based on the <a href="http://en.wikipedia.org/wiki/Burrows-Wheeler_transform">Burrows-Wheeler</a> transform. The algorithm used to build the index is based on the <a href="http://portal.acm.org/citation.cfm?id=1314852">blockwise algorithm</a> of Karkkainen.</p><h2 id="Command-Line-1"><a href="#Command-Line-1" class="headerlink" title="Command Line"></a>Command Line</h2><p>Usage:</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">bowtie2-build [<span class="hljs-keyword">options</span>]* <span class="hljs-symbol">&lt;reference_in&gt;</span> <span class="hljs-symbol">&lt;bt2_base&gt;</span><br></code></pre></td></tr></table></figure><h3 id="Main-arguments-1"><a href="#Main-arguments-1" class="headerlink" title="Main arguments"></a>Main arguments</h3><table><thead><tr><th><code>&lt;reference_in&gt;</code></th><th>A comma-separated list of <a href="https://en.wikipedia.org/wiki/FASTA"><code>FASTA</code></a> files containing the reference sequences to be aligned to, or, if <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-c"><code>-c</code></a> is specified, the sequences themselves. E.g., <code>&lt;reference_in&gt;</code> might be <code>chr1.fa,chr2.fa,chrX.fa,chrY.fa</code>, or, if <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-c"><code>-c</code></a> is specified, this might be <code>GGTCATCCT,ACGGGTCGT,CCGTTCTATGCGGCTTA</code>.</th></tr></thead><tbody><tr><td><code>&lt;bt2_base&gt;</code></td><td>The basename of the index files to write. By default, <code>bowtie2-build</code> writes files named <code>NAME.1.bt2</code>, <code>NAME.2.bt2</code>, <code>NAME.3.bt2</code>, <code>NAME.4.bt2</code>, <code>NAME.rev.1.bt2</code>, and <code>NAME.rev.2.bt2</code>, where <code>NAME</code> is <code>&lt;bt2_base&gt;</code>.</td></tr></tbody></table><h3 id="Options-1"><a href="#Options-1" class="headerlink" title="Options"></a>Options</h3><table><thead><tr><th><code>-f</code></th><th>The reference input files (specified as <code>&lt;reference_in&gt;</code>) are <a href="https://en.wikipedia.org/wiki/FASTA"><code>FASTA</code></a> files (usually having extension <code>.fa</code>, <code>.mfa</code>, <code>.fna</code> or similar).</th></tr></thead><tbody><tr><td><code>-c</code></td><td>The reference sequences are given on the command line. I.e. <code>&lt;reference_in&gt;</code> is a comma-separated list of sequences rather than a list of <a href="https://en.wikipedia.org/wiki/FASTA"><code>FASTA</code></a> files.</td></tr><tr><td><code>--large-index</code></td><td>Force <code>bowtie2-build</code> to build a <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#small-and-large-indexes">large index</a>, even if the reference is less than ~ 4 billion nucleotides inlong.</td></tr><tr><td><code>-a/--noauto</code></td><td>Disable the default behavior whereby <code>bowtie2-build</code> automatically selects values for the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-bmax"><code>--bmax</code></a>, <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-dcv"><code>--dcv</code></a> and <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-p"><code>--packed</code></a> parameters according to available memory. Instead, user may specify values for those parameters. If memory is exhausted during indexing, an error message will be printed; it is up to the user to try new parameters.</td></tr><tr><td><code>-p/--packed</code></td><td>Use a packed (2-bits-per-nucleotide) representation for DNA strings. This saves memory but makes indexing 2-3 times slower. Default: off. This is configured automatically by default; use <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-a"><code>-a</code>&#x2F;<code>--noauto</code></a> to configure manually.</td></tr><tr><td><code>--bmax &lt;int&gt;</code></td><td>The maximum number of suffixes allowed in a block. Allowing more suffixes per block makes indexing faster, but increases peak memory usage. Setting this option overrides any previous setting for <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-bmax"><code>--bmax</code></a>, or <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-bmaxdivn"><code>--bmaxdivn</code></a>. Default (in terms of the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-bmaxdivn"><code>--bmaxdivn</code></a> parameter) is <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-bmaxdivn"><code>--bmaxdivn</code></a> 4 * number of threads. This is configured automatically by default; use <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-a"><code>-a</code>&#x2F;<code>--noauto</code></a> to configure manually.</td></tr><tr><td><code>--bmaxdivn &lt;int&gt;</code></td><td>The maximum number of suffixes allowed in a block, expressed as a fraction of the length of the reference. Setting this option overrides any previous setting for <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-bmax"><code>--bmax</code></a>, or <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-bmaxdivn"><code>--bmaxdivn</code></a>. Default: <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-bmaxdivn"><code>--bmaxdivn</code></a> 4 * number of threads. This is configured automatically by default; use <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-a"><code>-a</code>&#x2F;<code>--noauto</code></a> to configure manually.</td></tr><tr><td><code>--dcv &lt;int&gt;</code></td><td>Use <code>&lt;int&gt;</code> as the period for the difference-cover sample. A larger period yields less memory overhead, but may make suffix sorting slower, especially if repeats are present. Must be a power of 2 no greater than 4096. Default: 1024. This is configured automatically by default; use <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-a"><code>-a</code>&#x2F;<code>--noauto</code></a> to configure manually.</td></tr><tr><td><code>--nodc</code></td><td>Disable use of the difference-cover sample. Suffix sorting becomes quadratic-time in the worst case (where the worst case is an extremely repetitive reference). Default: off.</td></tr><tr><td><code>-r/--noref</code></td><td>Do not build the <code>NAME.3.bt2</code> and <code>NAME.4.bt2</code> portions of the index, which contain a bitpacked version of the reference sequences and are used for paired-end alignment.</td></tr><tr><td><code>-3/--justref</code></td><td>Build only the <code>NAME.3.bt2</code> and <code>NAME.4.bt2</code> portions of the index, which contain a bitpacked version of the reference sequences and are used for paired-end alignment.</td></tr><tr><td><code>-o/--offrate &lt;int&gt;</code></td><td>To map alignments back to positions on the reference sequences, itâ€™s necessary to annotate (â€œmarkâ€) some or all of the <a href="http://en.wikipedia.org/wiki/Burrows-Wheeler_transform">Burrows-Wheeler</a> rows with their corresponding location on the genome. <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-build-options-o"><code>-o</code>&#x2F;<code>--offrate</code></a> governs how many rows get marked: the indexer will mark every 2^<code>&lt;int&gt;</code> rows. Marking more rows makes reference-position lookups faster, but requires more memory to hold the annotations at runtime. The default is 5 (every 32nd row is marked; for human genome, annotations occupy about 340 megabytes).</td></tr><tr><td><code>-t/--ftabchars &lt;int&gt;</code></td><td>The ftab is the lookup table used to calculate an initial <a href="http://en.wikipedia.org/wiki/Burrows-Wheeler_transform">Burrows-Wheeler</a> range with respect to the first <code>&lt;int&gt;</code>characters of the query. A larger <code>&lt;int&gt;</code> yields a larger lookup table but faster query times. The ftab has size 4^(<code>&lt;int&gt;</code>+1) bytes. The default setting is 10 (ftab is 4MB).</td></tr><tr><td><code>--seed &lt;int&gt;</code></td><td>Use <code>&lt;int&gt;</code> as the seed for pseudo-random number generator.</td></tr><tr><td><code>--cutoff &lt;int&gt;</code></td><td>Index only the first <code>&lt;int&gt;</code> bases of the reference sequences (cumulative across sequences) and ignore the rest.</td></tr><tr><td><code>-q/--quiet</code></td><td><code>bowtie2-build</code> is verbose by default. With this option <code>bowtie2-build</code> will print only error messages.</td></tr><tr><td><code>--threads &lt;int&gt;</code></td><td>By default <code>bowtie2-build</code> is using only one thread. Increasing the number of threads will speed up the index building considerably in most cases.</td></tr><tr><td><code>-h/--help</code></td><td>Print usage information and quit.</td></tr><tr><td><code>--version</code></td><td>Print version information and quit.</td></tr></tbody></table><h1 id="The-bowtie2-inspect-index-inspector"><a href="#The-bowtie2-inspect-index-inspector" class="headerlink" title="The bowtie2-inspect index inspector"></a>The <code>bowtie2-inspect</code> index inspector</h1><p><code>bowtie2-inspect</code> extracts information from a Bowtie index about what kind of index it is and what reference sequences were used to build it. When run without any options, the tool will output a <a href="https://en.wikipedia.org/wiki/FASTA"><code>FASTA</code></a> file containing the sequences of the original references (with all non-<code>A</code>&#x2F;<code>C</code>&#x2F;<code>G</code>&#x2F;<code>T</code> characters converted to <code>N</code>s). It can also be used to extract just the reference sequence names using the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-inspect-options-n"><code>-n</code>&#x2F;<code>--names</code></a> option or a more verbose summary using the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-inspect-options-s"><code>-s</code>&#x2F;<code>--summary</code></a> option.</p><h2 id="Command-Line-2"><a href="#Command-Line-2" class="headerlink" title="Command Line"></a>Command Line</h2><p>Usage:</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">bowtie2-<span class="hljs-keyword">inspect</span> [<span class="hljs-keyword">options</span>]* &lt;bt2_base&gt;<br></code></pre></td></tr></table></figure><h3 id="Main-arguments-2"><a href="#Main-arguments-2" class="headerlink" title="Main arguments"></a>Main arguments</h3><table><thead><tr><th><code>&lt;bt2_base&gt;</code></th><th>The basename of the index to be inspected. The basename is name of any of the index files but with the <code>.X.bt2</code> or <code>.rev.X.bt2</code>suffix omitted. <code>bowtie2-inspect</code> first looks in the current directory for the index files, then in the directory specified in the <code>BOWTIE2_INDEXES</code> environment variable.</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><h3 id="Options-2"><a href="#Options-2" class="headerlink" title="Options"></a>Options</h3><table><thead><tr><th><code>-a/--across &lt;int&gt;</code></th><th>When printing <a href="https://en.wikipedia.org/wiki/FASTA"><code>FASTA</code></a> output, output a newline character every <code>&lt;int&gt;</code> bases (default: 60).</th></tr></thead><tbody><tr><td><code>-n/--names</code></td><td>Print reference sequence names, one per line, and quit.</td></tr><tr><td><code>-s/--summary</code></td><td>Print a summary that includes information about index settings, as well as the names and lengths of the input sequences. The summary has this format:<code>Colorspace  &lt;0 or 1&gt; SA-Sample   1 in &lt;sample&gt; FTab-Chars  &lt;chars&gt; Sequence-1  &lt;name&gt;  &lt;len&gt; Sequence-2  &lt;name&gt;  &lt;len&gt; ... Sequence-N  &lt;name&gt;  &lt;len&gt;</code>Fields are separated by tabs. Colorspace is always set to 0 for Bowtie 2.</td></tr><tr><td><code>-o/--output &lt;filename&gt;</code></td><td>Save output to user-specified filename (default: stdout)</td></tr><tr><td><code>-v/--verbose</code></td><td>Print verbose output (for debugging).</td></tr><tr><td><code>--version</code></td><td>Print version information and quit.</td></tr><tr><td><code>-h/--help</code></td><td>Print usage information and quit.</td></tr></tbody></table><h1 id="Getting-started-with-Bowtie-2-Lambda-phage-example"><a href="#Getting-started-with-Bowtie-2-Lambda-phage-example" class="headerlink" title="Getting started with Bowtie 2: Lambda phage example"></a>Getting started with Bowtie 2: Lambda phage example</h1><p>Bowtie 2 comes with some example files to get you started. The example files are not scientifically significant; we use the <a href="http://en.wikipedia.org/wiki/Lambda_phage">Lambda phage</a> reference genome simply because itâ€™s short, and the reads were generated by a computer program, not a sequencer. However, these files will let you start running Bowtie 2 and downstream tools right away.</p><p>First follow the manual instructions to <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#obtaining-bowtie-2">obtain Bowtie 2</a>. Set the <code>BT2_HOME</code> environment variable to point to the new Bowtie 2 directory containing the <code>bowtie2</code>, <code>bowtie2-build</code> and <code>bowtie2-inspect</code> binaries. This is important, as the <code>BT2_HOME</code> variable is used in the commands below to refer to that directory.</p><h2 id="Indexing-a-reference-genome"><a href="#Indexing-a-reference-genome" class="headerlink" title="Indexing a reference genome"></a>Indexing a reference genome</h2><p>To create an index for the <a href="http://en.wikipedia.org/wiki/Lambda_phage">Lambda phage</a> reference genome included with Bowtie 2, create a new temporary directory (it doesnâ€™t matter where), change into that directory, and run:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$BT2_HOME</span><span class="hljs-regexp">/bowtie2-build $BT2_HOME/</span>example<span class="hljs-regexp">/reference/</span>lambda_virus.fa lambda_virus<br></code></pre></td></tr></table></figure><p>The command should print many lines of output then quit. When the command completes, the current directory will contain four new files that all start with <code>lambda_virus</code> and end with <code>.1.bt2</code>, <code>.2.bt2</code>, <code>.3.bt2</code>, <code>.4.bt2</code>, <code>.rev.1.bt2</code>, and <code>.rev.2.bt2</code>. These files constitute the index - youâ€™re done!</p><p>You can use <code>bowtie2-build</code> to create an index for a set of <a href="https://en.wikipedia.org/wiki/FASTA"><code>FASTA</code></a> files obtained from any source, including sites such as <a href="http://genome.ucsc.edu/cgi-bin/hgGateway">UCSC</a>, <a href="http://www.ncbi.nlm.nih.gov/sites/genome">NCBI</a>, and <a href="http://www.ensembl.org/">Ensembl</a>. When indexing multiple <a href="https://en.wikipedia.org/wiki/FASTA"><code>FASTA</code></a> files, specify all the files using commas to separate file names. For more details on how to create an index with <code>bowtie2-build</code>, see the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#the-bowtie2-build-indexer">manual section on index building</a>. You may also want to bypass this process by obtaining a pre-built index. See <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#using-a-pre-built-index">using a pre-built index</a> below for an example.</p><h2 id="Aligning-example-reads"><a href="#Aligning-example-reads" class="headerlink" title="Aligning example reads"></a>Aligning example reads</h2><p>Stay in the directory created in the previous step, which now contains the <code>lambda_virus</code> index files. Next, run:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$BT2_HOME</span><span class="hljs-regexp">/bowtie2 -x lambda_virus -U $BT2_HOME/</span>example<span class="hljs-regexp">/reads/</span>reads_1.fq -S eg1.sam<br></code></pre></td></tr></table></figure><p>This runs the Bowtie 2 aligner, which aligns a set of unpaired reads to the <a href="http://en.wikipedia.org/wiki/Lambda_phage">Lambda phage</a> reference genome using the index generated in the previous step. The alignment results in SAM format are written to the file <code>eg1.sam</code>, and a short alignment summary is written to the console. (Actually, the summary is written to the â€œstandard errorâ€ or â€œstderrâ€ filehandle, which is typically printed to the console.)</p><p>To see the first few lines of the SAM output, run:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">head</span> eg1.sam<br></code></pre></td></tr></table></figure><p>You will see something like this:</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">@HD VN:<span class="hljs-number">1.0</span>  SO:unsorted<br>@SQ SN:gi|<span class="hljs-number">9626243</span>|<span class="hljs-keyword">ref</span>|NC_001416<span class="hljs-number">.1</span>|  LN:<span class="hljs-number">48502</span><br>@PG ID:bowtie2  PN:bowtie2  VN:<span class="hljs-number">2.0</span><span class="hljs-number">.1</span><br>r1  <span class="hljs-number">0</span>   gi|<span class="hljs-number">9626243</span>|<span class="hljs-keyword">ref</span>|NC_001416<span class="hljs-number">.1</span>| <span class="hljs-number">18401</span>   <span class="hljs-number">42</span>  <span class="hljs-number">122</span>M    *   <span class="hljs-number">0</span>   <span class="hljs-number">0</span>   TGAATGCGAACTCCGGGACGCTCAGTAATGTGACGATAGCTGAAAACTGTACGATAAACNGTACGCTGAGGGCAGAAAAAATCGTCGGGGACATTNTAAAGGCGGCGAGCGCGGCTTTTCCG  +&quot;@6&lt;:27(F&amp;5)9&quot;B):%B+A-%<span class="hljs-number">5</span>A?<span class="hljs-number">2</span>$HCB0B+<span class="hljs-number">0</span>=D&lt;<span class="hljs-number">7</span>E/&lt;<span class="hljs-number">.03</span>#!.F77@<span class="hljs-number">6</span>B==?C&quot;7&gt;;))%;,3-$.A06+&lt;-1/@@?,26&quot;&gt;=?*@<span class="hljs-string">&#x27;0;$:;??G+:#+(A?9+10!8!?()?7C&gt;  AS:i:-5 XN:i:0  XM:i:3  XO:i:0  XG:i:0  NM:i:3  MD:Z:59G13G21G26    YT:Z:UU</span><br><span class="hljs-string">r2  0   gi|9626243|ref|NC_001416.1| 8886    42  275M    *   0   0   NTTNTGATGCGGGCTTGTGGAGTTCAGCCGATCTGACTTATGTCATTACCTATGAAATGTGAGGACGCTATGCCTGTACCAAATCCTACAATGCCGGTGAAAGGTGCCGGGATCACCCTGTGGGTTTATAAGGGGATCGGTGACCCCTACGCGAATCCGCTTTCAGACGTTGACTGGTCGCGTCTGGCAAAAGTTAAAGACCTGACGCCCGGCGAACTGACCGCTGAGNCCTATGACGACAGCTATCTCGATGATGAAGATGCAGACTGGACTGC (#!!&#x27;</span>+!$&quot;&quot;%+(+)<span class="hljs-string">&#x27;%)%!+!(&amp;++)&#x27;&#x27;&quot;#&quot;#&amp;#&quot;!&#x27;</span>!(&quot;%&#x27;&quot;&quot;(&quot;+&amp;%$%*%%#$%#%#!)*<span class="hljs-string">&#x27;(#&quot;)(($&amp;$&#x27;</span>&amp;%+&amp;#%*)*#*%*<span class="hljs-string">&#x27;)(%+!%%*&quot;$%&quot;#+)$&amp;&amp;+)&amp;)*+!&quot;*)!*!(&quot;&amp;&amp;&quot;*#+&quot;&amp;&quot;&#x27;</span>(%)*(&quot;&#x27;!$*!!%$&amp;&amp;&amp;$!!&amp;&amp;&quot;(*&quot;$&amp;&quot;#&amp;!$%<span class="hljs-string">&#x27;%&quot;#)$#+%*+)!&amp;*)+(&quot;&quot;#!)!%*#&quot;*)*&#x27;</span>)&amp;&quot;)($+*%%)!*)!(&#x27;(%&quot;&quot;+%&quot;$##&quot;#+((&#x27;!*(($*&#x27;!&quot;*(<span class="hljs-string">&#x27;&quot;+)&amp;%#&amp;$+(&#x27;</span>**$$<span class="language-ruby">&amp;+*&amp;!<span class="hljs-comment">#%)&#x27;)&#x27;(+(!%+ AS:i:-14    XN:i:0  XM:i:8  XO:i:0  XG:i:0  NM:i:8  MD:Z:0A0C0G0A108C23G9T81T46 YT:Z:UU</span></span><br><span class="language-ruby">r3  <span class="hljs-number">16</span>  gi|<span class="hljs-params">9626243</span>|ref|<span class="hljs-params">NC_001416.1</span>| <span class="hljs-number">11599</span>   <span class="hljs-number">42</span>  338M    *   <span class="hljs-number">0</span>   <span class="hljs-number">0</span>   <span class="hljs-variable constant_">GGGCGCGTTACTGGGATGATCGTGAAAAGGCCCGTCTTGCGCTTGAAGCCGCCCGAAAGAAGGCTGAGCAGCAGACTCAAGAGGAGAAAAATGCGCAGCAGCGGAGCGATACCGAAGCGTCACGGCTGAAATATACCGAAGAGGCGCAGAAGGCTNACGAACGGCTGCAGACGCCGCTGCAGAAATATACCGCCCGTCAGGAAGAACTGANCAAGGCACNGAAAGACGGGAAAATCCTGCAGGCGGATTACAACACGCTGATGGCGGCGGCGAAAAAGGATTATGAAGCGACGCTGTAAAAGCCGAAACAGTCCAGCGTGAAGGTGTCTGCGGGCGAT</span>  7F<span class="hljs-variable">$%</span><span class="hljs-number">6</span>=<span class="hljs-variable">$:</span>9B@/F<span class="hljs-string">&#x27;&gt;=?!D?@0(:A*)7/&gt;9C&gt;6#1&lt;6:C(.CC;#.;&gt;;2&#x27;</span><span class="hljs-variable">$4D</span><span class="hljs-symbol">:<span class="hljs-string">?&amp;</span>B!&gt;</span><span class="hljs-number">689</span>?(<span class="hljs-number">0</span>(<span class="hljs-variable constant_">G7</span>+<span class="hljs-number">0</span>=<span class="hljs-variable">@37F</span>)<span class="hljs-variable constant_">GG</span>=&gt;<span class="hljs-string">?9</span>58.<span class="hljs-variable constant_">D2E04C</span>&lt;E,*<span class="hljs-variable constant_">AD</span>%<span class="hljs-variable constant_">G0</span>.%<span class="hljs-variable">$+</span><span class="hljs-symbol">A:</span><span class="hljs-string">&#x27;H;?8&lt;72:88?E6((CF)6DF#.)=&gt;B&gt;D-=&quot;C&#x27;</span><span class="hljs-variable constant_">B080E</span><span class="hljs-string">&#x27;5BH&quot;77&#x27;</span><span class="hljs-symbol">:<span class="hljs-string">&quot;@70#4%A5=6.2/1&gt;;9&quot;</span>&amp;-H6</span>)=<span class="hljs-variable">$/</span><span class="hljs-number">0</span>;5<span class="hljs-symbol">E:</span>&lt;8G!@<span class="hljs-symbol">:</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>?2DC7C*;@*<span class="hljs-comment">#.1C0.D&gt;H/20,!&quot;C-#,6@%&lt;+&lt;D(AG-).?&amp;#0.00&#x27;@)/F8?B!&amp;&quot;170,)&gt;:?&lt;A7#1(A@0E#&amp;A.*DC.E&quot;)AH&quot;+.,5,2&gt;5&quot;2?:G,F&quot;D0B8D-6$65D&lt;D!A/38860.*4;4B&lt;*31?6  AS:i:-22    XN:i:0  XM:i:8  XO:i:0  XG:i:0  NM:i:8  MD:Z:80C4C16A52T23G30A8T76A41   YT:Z:UU</span></span><br><span class="language-ruby">r4  <span class="hljs-number">0</span>   gi|<span class="hljs-params">9626243</span>|ref|<span class="hljs-params">NC_001416.1</span>| <span class="hljs-number">40075</span>   <span class="hljs-number">42</span>  184M    *   <span class="hljs-number">0</span>   <span class="hljs-number">0</span>   <span class="hljs-variable constant_">GGGCCAATGCGCTTACTGATGCGGAATTACGCCGTAAGGCCGCAGATGAGCTTGTCCATATGACTGCGAGAATTAACNGTGGTGAGGCGATCCCTGAACCAGTAAAACAACTTCCTGTCATGGGCGGTAGACCTCTAAATCGTGCACAGGCTCTGGCGAAGATCGCAGAAATCAAAGCTAAGT</span>(=8B)<span class="hljs-variable constant_">GD04</span>*G%&amp;4F,<span class="hljs-number">1</span><span class="hljs-string">&#x27;A&gt;.C&amp;7=F$,+#6!))43C,5/5+)?-/0&gt;/D3=-,2/+.1?@-&gt;;)00!&#x27;</span><span class="hljs-number">3</span>!7BH<span class="hljs-variable">$G</span>)<span class="hljs-variable constant_">HG</span>+<span class="hljs-variable constant_">ADC</span><span class="hljs-string">&#x27;#-9F)7&lt;7&quot;$?&amp;.&gt;0)@5;4,!0-#C!15CF8&amp;HB+B==H&gt;7,/)C5)5*+(F5A%D,EA&lt;(&gt;G9E0&gt;7&amp;/E?4%;#&#x27;</span><span class="hljs-number">92</span>)&lt;<span class="hljs-number">5</span>+<span class="hljs-variable">@7</span><span class="hljs-symbol">:A</span>.(<span class="hljs-variable constant_">BG</span><span class="hljs-variable">@BG8</span>6@.G <span class="hljs-variable constant_">AS</span><span class="hljs-symbol">:i</span><span class="hljs-symbol">:-</span><span class="hljs-number">1</span> <span class="hljs-variable constant_">XN</span><span class="hljs-symbol">:i</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span>  <span class="hljs-variable constant_">XM</span><span class="hljs-symbol">:i</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>  <span class="hljs-variable constant_">XO</span><span class="hljs-symbol">:i</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span>  <span class="hljs-variable constant_">XG</span><span class="hljs-symbol">:i</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span>  <span class="hljs-variable constant_">NM</span><span class="hljs-symbol">:i</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span>  <span class="hljs-variable constant_">MD</span><span class="hljs-symbol">:Z</span><span class="hljs-symbol">:</span>77C106 <span class="hljs-variable constant_">YT</span><span class="hljs-symbol">:Z</span><span class="hljs-symbol">:UU</span></span><br><span class="language-ruby">r5  <span class="hljs-number">0</span>   gi|<span class="hljs-params">9626243</span>|ref|<span class="hljs-params">NC_001416.1</span>| <span class="hljs-number">48010</span>   <span class="hljs-number">42</span>  138M    *   <span class="hljs-number">0</span>   <span class="hljs-number">0</span>   <span class="hljs-variable constant_">GTCAGGAAAGTGGTAAAACTGCAACTCAATTACTGCAATGCCCTCGTAATTAAGTGAATTTACAATATCGTCCTGTTCGGAGGGAAGAACGCGGGATGTTCATTCTTCATCACTTTTAATTGATGTATATGCTCTCTT</span>  <span class="hljs-number">9</span><span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">%&lt;D)A03E1-*7=),:F/0!6,D9:H,&lt;9D%:0B(%&#x27;E,(8EFG$E89B$27G8F*2+4,-!,0D5()&amp;=(FGG:5;3*@/.0F-G#5#3-&gt;</span>(<span class="hljs-string">&#x27;FDFEG?)5.!)&quot;AGADB3?6(@H(:B&lt;&gt;6!&gt;;&gt;6&gt;G,.&quot;?%  AS:i:0  XN:i:0  XM:i:0  XO:i:0  XG:i:0  NM:i:0  MD:Z:138    YT:Z:UU</span></span><br><span class="hljs-string"><span class="language-ruby">r6  16  gi|9626243|ref|NC_001416.1| 41607   42  72M2D119M   *   0   0   TCGATTTGCAAATACCGGAACATCTCGGTAACTGCATATTCTGCATTAAAAAATCAACGCAAAAAATCGGACGCCTGCAAAGATGAGGAGGGATTGCAGCGTGTTTTTAATGAGGTCATCACGGGATNCCATGTGCGTGACGGNCATCGGGAAACGCCAAAGGAGATTATGTACCGAGGAAGAATGTCGCT 1H#G;H&quot;$E*E#&amp;&quot;*)2%66?=9/9&#x27;</span>=;<span class="hljs-number">4</span>)<span class="hljs-number">4</span>/&gt;@%+<span class="hljs-number">5</span><span class="hljs-comment">#@#$4A*!&lt;D==&quot;8#1*A9BA=:(1+#C&amp;.#(3#H=9E)AC*5,AC#E&#x27;536*2?)H14?&gt;9&#x27;B=7(3H/B:+A:8%1-+#(E%&amp;$$</span></span>&amp;<span class="hljs-number">14</span>&quot;76D?&gt;7(&amp;20H5%*&amp;CF8!G5B+A4F$7(:&quot;<span class="hljs-string">&#x27;?0$?G+$)B-?2&lt;0&lt;F=D!38BH,%=8&amp;5@+ AS:i:-13    XN:i:0  XM:i:2  XO:i:1  XG:i:2  NM:i:4  MD:Z:72^TT55C15A47  YT:Z:UU</span><br><span class="hljs-string">r7  16  gi|9626243|ref|NC_001416.1| 4692    42  143M    *   0   0   TCAGCCGGACGCGGGCGCTGCAGCCGTACTCGGGGATGACCGGTTACAACGGCATTATCGCCCGTCTGCAACAGGCTGCCAGCGATCCGATGGTGGACAGCATTCTGCTCGATATGGACANGCCCGGCGGGATGGTGGCGGGG -&quot;/@*7A0)&gt;2,AAH@&amp;&quot;%B)*5*23B/,)90.B@%=FE,E063C9?,:26$-0:,.,1849&#x27;</span><span class="hljs-number">4.</span>;F&gt;FA;<span class="hljs-number">76</span>+<span class="hljs-number">5</span>&amp;$&lt;C&quot;:$!A*,&lt;B,&lt;)@&lt;&#x27;85D%C*:)30@85;?.B$05=@95DCDH&lt;53!8G:F:B7/A.E&#x27;:434&gt; AS:i:-6 XN:i:0  XM:i:2  XO:i:0  XG:i:0  NM:i:2  MD:Z:98G21C22   YT:Z:UU<br></code></pre></td></tr></table></figure><p>The first few lines (beginning with <code>@</code>) are SAM header lines, and the rest of the lines are SAM alignments, one line per read or mate. See the <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#sam-output">Bowtie 2 manual section on SAM output</a> and the <a href="http://samtools.sourceforge.net/SAM1.pdf">SAM specification</a> for details about how to interpret the SAM file format.</p><h2 id="Paired-end-example"><a href="#Paired-end-example" class="headerlink" title="Paired-end example"></a>Paired-end example</h2><p>To align paired-end reads included with Bowtie 2, stay in the same directory and run:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$BT2_HOME</span><span class="hljs-regexp">/bowtie2 -x lambda_virus -1 $BT2_HOME/</span>example<span class="hljs-regexp">/reads/</span>reads_1.fq -<span class="hljs-number">2</span> <span class="hljs-variable">$BT2_HOME</span><span class="hljs-regexp">/example/</span>reads/reads_2.fq -S eg2.sam<br></code></pre></td></tr></table></figure><p>This aligns a set of paired-end reads to the reference genome, with results written to the file <code>eg2.sam</code>.</p><h2 id="Local-alignment-example-1"><a href="#Local-alignment-example-1" class="headerlink" title="Local alignment example"></a>Local alignment example</h2><p>To use <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#end-to-end-alignment-versus-local-alignment">local alignment</a> to align some longer reads included with Bowtie 2, stay in the same directory and run:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$BT2_HOME</span><span class="hljs-regexp">/bowtie2 --local -x lambda_virus -U $BT2_HOME/</span>example<span class="hljs-regexp">/reads/</span>longreads.fq -S eg3.sam<br></code></pre></td></tr></table></figure><p>This aligns the long reads to the reference genome using local alignment, with results written to the file <code>eg3.sam</code>.</p><h2 id="Using-SAMtools-x2F-BCFtools-downstream"><a href="#Using-SAMtools-x2F-BCFtools-downstream" class="headerlink" title="Using SAMtools&#x2F;BCFtools downstream"></a>Using SAMtools&#x2F;BCFtools downstream</h2><p><a href="http://samtools.sourceforge.net/">SAMtools</a> is a collection of tools for manipulating and analyzing SAM and BAM alignment files. <a href="http://samtools.sourceforge.net/mpileup.shtml">BCFtools</a> is a collection of tools for calling variants and manipulating VCF and BCF files, and it is typically distributed with <a href="http://samtools.sourceforge.net/">SAMtools</a>. Using these tools together allows you to get from alignments in SAM format to variant calls in VCF format. This example assumes that <code>samtools</code> and <code>bcftools</code> are installed and that the directories containing these binaries are in your <a href="http://en.wikipedia.org/wiki/PATH_(variable)">PATH environment variable</a>.</p><p>Run the paired-end example:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$BT2_HOME</span><span class="hljs-regexp">/bowtie2 -x $BT2_HOME/</span>example<span class="hljs-regexp">/index/</span>lambda_virus -<span class="hljs-number">1</span> <span class="hljs-variable">$BT2_HOME</span><span class="hljs-regexp">/example/</span>reads<span class="hljs-regexp">/reads_1.fq -2 $BT2_HOME/</span>example<span class="hljs-regexp">/reads/</span>reads_2.fq -S eg2.sam<br></code></pre></td></tr></table></figure><p>Use <code>samtools view</code> to convert the SAM file into a BAM file. BAM is the binary format corresponding to the SAM text format. Run:</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">samtools view -bS e<span class="hljs-name">g2.</span>sam &gt; e<span class="hljs-name">g2.</span>bam<br></code></pre></td></tr></table></figure><p>Use <code>samtools sort</code> to convert the BAM file to a sorted BAM file.</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">samtools sort e<span class="hljs-name">g2.</span>bam -o e<span class="hljs-name">g2.</span>sorted.bam<br></code></pre></td></tr></table></figure><p>We now have a sorted BAM file called <code>eg2.sorted.bam</code>. Sorted BAM is a useful format because the alignments are (a) compressed, which is convenient for long-term storage, and (b) sorted, which is conveneint for variant discovery. To generate variant calls in VCF format, run:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">bcftools mpileup -f <span class="hljs-variable">$BT2_HOME</span><span class="hljs-regexp">/example/</span>reference/lambda_virus.fa eg2.sorted.bam | bcftools view -Ov - &gt; eg2.raw.bcf<br></code></pre></td></tr></table></figure><p>Then to view the variants, run:</p><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cos">bcftools <span class="hljs-keyword">view</span> eg2.raw.bcf<br></code></pre></td></tr></table></figure><p>See the official SAMtools guide to <a href="http://samtools.sourceforge.net/mpileup.shtml">Calling SNPs&#x2F;INDELs with SAMtools&#x2F;BCFtools</a> for more details and variations on this process.</p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mapping</tag>
      
      <tag>bowtie2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€blast+ã€‘</title>
    <link href="/GeekFocus/2022/03/20/2022-03-18-blast/"/>
    <url>/GeekFocus/2022/03/20/2022-03-18-blast/</url>
    
    <content type="html"><![CDATA[<p>Short introduction to using NCBI blast tools from the command line</p><span id="more"></span><p><a href="https://www.ncbi.nlm.nih.gov/books/NBK279690/">BLASTÂ® Command Line Applications User Manual</a></p><h2 id="Exercise-2-performing-a-basic-BLASTp-search"><a href="#Exercise-2-performing-a-basic-BLASTp-search" class="headerlink" title="Exercise 2: performing a basic BLASTp search"></a>Exercise 2: performing a basic BLASTp search</h2><p>BLAST+ search strategies are run by typing the type you want on the command line followed by the input options. This includes <strong>blastn, blastp, blastx, tblastn and tblastx</strong>. Ensure you know which search strategy is appropriate for your data and database type. You can find an extensive overview of these <a href="https://www.ncbi.nlm.nih.gov/books/NBK1734/">here</a>.</p><p>We will now search a few <strong>protein sequences against the database</strong> and <strong>retrieve the results</strong>. You can get download sample protein sequences for this tutorial <a href="https://raw.githubusercontent.com/conmeehan/conmeehan.github.io/master/proteins.fasta">here</a>. Save this page as proteins.fasta and put in the same directory as the pdbaa folder we downloaded earlier. We will perform a default BLASTp search on these to find out what proteins they are. The advantage of BLAST+ is that we can run BLASTp once using this file as an input and it will <strong>perform a search on all sequences within</strong>, meaning we <strong>do not have to do each sequence individually</strong>.</p><p>Navigate to the folder containing proteins.fasta. The <strong>pdbaa folder</strong> should be <strong>in this folder too.</strong> Type the following on the command line:</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">blastp -<span class="hljs-keyword">query</span> proteins.fasta -<span class="hljs-keyword">db</span> pdbaa/pdbaa -<span class="hljs-keyword">out</span> proteins_blastp.txt<br></code></pre></td></tr></table></figure><p>This will perform a blastp search, using all the sequences in proteins.fasta as queries, using the pdbaa database and output the results to proteins_blastp.txt. You will see the output looks quite like the website output with the overview first and the individual alignments next.</p><p>Q. Look at the file proteins_blastp.txt. What sequences do we appear to have?</p><p>There are many ways to modify how this is run. Type</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">blastp -<span class="hljs-built_in">help</span><br></code></pre></td></tr></table></figure><p>This will print to the screen a large amount of text, <strong>detailing all the flags (options) we can change during the BLAST search</strong>. We will modify some of these now.</p><h2 id="Exercise-3-modifying-the-defaults-and-output-types"><a href="#Exercise-3-modifying-the-defaults-and-output-types" class="headerlink" title="Exercise 3: modifying the defaults and output types"></a>Exercise 3: modifying the defaults and output types</h2><p>Often if we are working with <strong>many sequences</strong> we want to make it easier to <strong>get the best results</strong> in an easy to read format. We can do this by <strong>limiting the number of results returned</strong>. Often this is performed by changing the number of alignments displayed and&#x2F;or the <strong>e-value cut-off</strong>.</p><p>Lets run BLASTp, keeping all the overviews but only displaying the top hit alignment. We change the number of alignments displayed with the <strong>-num_alignments</strong> flag. To <strong>keep only the top hit alignment</strong> we can use</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">blastp -<span class="hljs-keyword">query</span> proteins.fasta -<span class="hljs-keyword">db</span> <span class="hljs-keyword">db</span>/pdbaa -<span class="hljs-keyword">out</span> proteins_blastp_1align.txt -num_alignments 1<br></code></pre></td></tr></table></figure><p>If you look in this file we can see that all the descriptions are retained but <strong>now we only have 1 alignment per query sequence</strong>. Another way to limit the results is to set an <strong>e-value cut-off</strong>. In the help output of each program you can see the default e-value (listed under â€˜general search optionsâ€™). You can see it is quite high (10). We will retain only those hits with an e-value of <strong>1e-30 or higher.</strong> We use the <strong>-evalue</strong> flag for this. Lets combines the above alignment display restriction with an <strong>evalue restriction</strong>. This done by typing:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">blastp</span> -query proteins.fasta -db db/pdbaa -out proteins_blastp_1align_1e-<span class="hljs-number">30</span>.txt -num_alignments <span class="hljs-number">1</span> -evalue <span class="hljs-number">1</span>e-<span class="hljs-number">30</span><br></code></pre></td></tr></table></figure><p>You can see now that we have a smaller number of hits, hopefully including only those we are certain are likely to be correct.</p><p>Often we <strong>dont need</strong> the output <strong>alignments</strong> but <strong>want all the details of each hit</strong> (e-value, bit score, percent identity etc) on 1 line. This is achieved by changing the <strong>output type</strong>. So far we have used the default output type but we can change this with the <strong>-outfmt</strong> flag. There are 11 output types (listed in the help output) but we <font color="blue"><strong>shall use type 6</strong></font>: tabular output. This gives you <strong>a line per hit with 12 columns</strong>:</p><ul><li>Query id</li><li><strong>Subject id</strong></li><li><strong>% identity</strong></li><li><strong>alignment length</strong></li><li><strong>mismatches</strong></li><li><strong>gap</strong> openings</li><li><strong>query start</strong></li><li><strong>query end</strong></li><li><strong>subject start</strong></li><li><strong>subject end</strong></li><li>e-value</li><li>bit score</li></ul><p>This saves a lot of space in the output but does not separate queries into separate sections. We no longer need to limit the number of alignments with this output format (as none are displayed) but we may still want to limit the e-value. We can do this by typing:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">blastp</span> -query proteins.fasta -db db/pdbaa -out proteins_blastp_1e-<span class="hljs-number">30</span>_table.txt -evalue <span class="hljs-number">1</span>e-<span class="hljs-number">30</span> -outfmt <span class="hljs-number">6</span><br></code></pre></td></tr></table></figure><p>We can see the output is much more compressed with queries all together, only separated by the name in the first column. You may notice however that the subject name (column 2) is truncated, with the information we want having been cut off. This is a known problem in the tabular output that supposedly NCBI are working on. You can see we do happen to have the GI included in the description which we can search the NCBI website for. When we create our own database we may wish to try have short names so that this is less of a problem. There is a way to switch between some output types even after you have run the analysis which I will outline briefly later.</p><p>A small note ( we will not do an exercise on this): There are different types of BLAST searches within the basic types. For example in blastn you can perform standard blastn, megablast or discontiguous megablast. These options are changed with the <strong>-task</strong> flag. Note that megablast is the default for blastn, not standard blastn.</p><h2 id="Excerise-4-Extracting-the-sequences-from-a-BLAST-database"><a href="#Excerise-4-Extracting-the-sequences-from-a-BLAST-database" class="headerlink" title="Excerise 4: Extracting the sequences from a BLAST database"></a>Excerise 4: Extracting the sequences from a BLAST database</h2><p>If you want to extract the sequences that are contained in a BLAST database, you can use the <strong>blastdbcmd</strong> command to do this. Lets extract all the sequences from the pdb database we have downloaded. Navigate to the folder that contains the database file (pdbaa in the above examples) and run:</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">blastdbcmd -<span class="hljs-keyword">entry</span> <span class="hljs-keyword">all</span> -db pdbaa -<span class="hljs-keyword">out</span> pdbaa.fasta<br></code></pre></td></tr></table></figure><p>This will extract all the sequences from the database named pdbaa and place them into a Fasta file named pdbaa.fasta.</p><h2 id="Exercise-5-creating-a-custom-database"><a href="#Exercise-5-creating-a-custom-database" class="headerlink" title="Exercise 5: creating a custom database"></a>Exercise 5: <font color="blue">creating a custom database</font></h2><p>Often we <strong>do not want to use all of NR</strong> or any of the pre-made databases supplied by NCBI. We may want to use <strong>a custom database of only species or genes we are interested in</strong>. If we have a fasta format file (unaligned) of these sequences we can create a database from this with the <strong>makeblastdb</strong> command. Lets create the pdb amino acid database from a fasta file, resulting in the database we already used.</p><p>Create a new folder called db2. Copy the file pdbaa.fasta you just created from the pdbaa folder to the db2 folder. Navigate into the db2 folder and create a protein database by typing:</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elm"><span class="hljs-title">makeblastdb</span> -<span class="hljs-keyword">in</span> pdbaa.fasta -title pdbaa -db<span class="hljs-keyword">type</span> prot -out pdbaa -parse_seqids<br></code></pre></td></tr></table></figure><p>The <strong>-in</strong> flag states the fasta file to create the database from, the <strong>-title</strong> flag gives the database a title, <strong>-dbtype</strong> says whether it is protein (prot) or nucleotide (nucl), <strong>-out</strong> is the name of the database and <strong>-parse_seqids</strong> states we want to <strong>retain the full names of each sequence</strong>. You will now see in db2 we have exactly the same files as in the db folder. We can use this as our database in exactly the same way we did for the original pdbaa database, just remember to use db2&#x2F;pdbaa for the database instead of pdbaa&#x2F;pdbaa.</p><h2 id="Exercise-6-BLASTing-against-a-remote-database"><a href="#Exercise-6-BLASTing-against-a-remote-database" class="headerlink" title="Exercise 6: BLASTing against a remote database"></a>Exercise 6: BLASTing against a remote database</h2><p>Instead of having to download the entirety of NR or other NCBI databases, we can BLAST against the version held on the website. This ensures we have the most up to date version but is also significantly slower. We use the <strong>-remote</strong>command to do this. Lets BLAST our sequences against NR held on the NCBI website by typing:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">blastp</span> -query proteins.fasta -remote -db nr -out proteins_nr.txt -outfmt <span class="hljs-number">6</span> -evalue <span class="hljs-number">1</span>e-<span class="hljs-number">30</span><br></code></pre></td></tr></table></figure><p>Q. Did weget the same sequences back from the nr database as we did from the pdb database?</p><h2 id="Exercise-7-Extracting-hits-from-the-BLAST-database"><a href="#Exercise-7-Extracting-hits-from-the-BLAST-database" class="headerlink" title="Exercise 7: Extracting hits from the BLAST database"></a>Exercise 7: Extracting hits from the BLAST database</h2><p>Once we have our BLAST results we may wish to go back and get the sequences for the hits from the database. For this we require a file of the sequence names of the hits (or parts of it, such as the section output from type 6 output) and the database used for the original BLAST (which must have been created with the -parse_seqids flag). Lets take 2 sequences from our hits against the pdbaa database. Copy the following into a file called hits.txt</p><table><thead><tr><th>gi</th><th>1942986</th><th>pdb</th><th>1OCC</th><th>A</th></tr></thead><tbody><tr><td>gi</td><td>40889823</td><td>pdb</td><td>1V54</td><td>A</td></tr></tbody></table><p>This is portions of 2 names of sequences we found to be good hits to our first query sequence. We will use the <strong>blastdbcmd</strong> program to get these sequences from the pdbaa database. Type:</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">blastdbcmd -<span class="hljs-keyword">db</span> <span class="hljs-keyword">db</span>/pdbaa -dbtype prot -entry_batch hits.txt -outfmt %f -<span class="hljs-keyword">out</span> hits.fasta <br></code></pre></td></tr></table></figure><p>This command is similar to in excerise 4 but instead of getting all the sequences in the database, we are <strong>getting a subselection</strong>. The <strong>-db</strong>, <strong>-dbtype</strong> and <strong>-out</strong> we have seen before, <strong>-entry_batch</strong> is the file containing the sequence names and <strong>-outfmt</strong> here says we want <strong>fasta formatted sequences (%f)</strong>. If you now open hits.fasta you should see the 2 sequences we requested.</p><h2 id="Exercise-8-Converting-output-format-types"><a href="#Exercise-8-Converting-output-format-types" class="headerlink" title="Exercise 8: Converting output format types"></a>Exercise 8: Converting output format types</h2><p>If you wish to change output formats after you have run a BLAST search we can use <strong>blast_formatter</strong>. This requires that the original run used <strong>-outfmt 11</strong> (archive type) and the database was made with the <strong>-parse_seqids</strong> flag. If we ran a BLAST such as</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">blastp -<span class="hljs-keyword">query</span> proteins.fasta -<span class="hljs-keyword">db</span> <span class="hljs-keyword">db</span>/pdbaa -<span class="hljs-keyword">out</span> protein_archive.txt -outfmt 11<br></code></pre></td></tr></table></figure><p>We could retrieve the results in out format 6 by typing</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nsis">blast_formatter -<span class="hljs-params">archive</span> protein_<span class="hljs-params">archive</span>.txt -outfmt <span class="hljs-number">6</span> -out proteins_tabular.txt<br></code></pre></td></tr></table></figure><p><strong>Thus a good way to run BLAST+ is to use -outfmt 11 and then after that use blast_formatter to change the output to different formats as needed.</strong></p><hr><p><a href="https://github.com/enormandeau/ncbi_blast_tutorial">https://github.com/enormandeau/ncbi_blast_tutorial</a></p><h2 id="install"><a href="#install" class="headerlink" title="install"></a>install</h2><p>Get the compiled executables from this URL:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">ftp:<span class="hljs-regexp">//</span>ftp.ncbi.nlm.nih.gov<span class="hljs-regexp">/blast/</span>executables<span class="hljs-regexp">/blast+/</span>LATEST/<br></code></pre></td></tr></table></figure><p>Decompress the archive. </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">tar</span> xvfz ncbi-blast-<span class="hljs-number">2</span>.<span class="hljs-number">9</span>.<span class="hljs-number">0</span>+-x64-linux.tar.gz<br></code></pre></td></tr></table></figure><p>Add the <code>bin</code> folder from the extracted archive to your path.</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">PATH</span>=<span class="hljs-string">&quot;/PATH/TO/ncbi-blast-2.9.0+/bin&quot;</span>:$PATH<br></code></pre></td></tr></table></figure><h2 id="Example-sequences-to-use-with-the-tutorial"><a href="#Example-sequences-to-use-with-the-tutorial" class="headerlink" title="Example sequences to use with the tutorial"></a>Example sequences to use with the tutorial</h2><p>In order to test blast, you need a test fasta file. Use the following files that come with the tutorial:</p><ul><li><code>sequences.fasta</code></li><li><code>reference.fasta</code></li></ul><h2 id="Create-blast-database"><a href="#Create-blast-database" class="headerlink" title="Create blast database"></a>Create blast database</h2><p>The different blast tools require a formatted database to search against. In order to create the database, we use the <code>makeblastdb</code> tool:</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">makeblastdb -<span class="hljs-keyword">in</span> <span class="hljs-built_in">ref</span>erence.fasta -title <span class="hljs-built_in">ref</span>erence -dbtype nucl -<span class="hljs-keyword">out</span> databases/<span class="hljs-built_in">ref</span>erence<br></code></pre></td></tr></table></figure><p>This will create a list of files in the <code>databases</code> folder. These are all part of the blast database.</p><h2 id="Blast"><a href="#Blast" class="headerlink" title="Blast"></a>Blast</h2><p>We can now <font color="blue"><strong>blast our sequences against the database</strong></font>. In this case, both our query sequences and database sequences are DNA sequences, so we use the <code>blastn</code> tool:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">blastn</span> -db databases/reference -query sequences.fasta -evalue <span class="hljs-number">1</span>e-<span class="hljs-number">3</span> -word_size <span class="hljs-number">11</span> -outfmt <span class="hljs-number">0</span> &gt; sequences.reference<br></code></pre></td></tr></table></figure><p>You can use different output formats with the <code>outmft</code> option:</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs tap">-outfmt &lt;String&gt;<br>  alignment view options:<br>   <span class="hljs-number"> 0 </span>= pairwise,<br>   <span class="hljs-number"> 1 </span>= query-anchored showing identities,<br>   <span class="hljs-number"> 2 </span>= query-anchored no identities,<br>   <span class="hljs-number"> 3 </span>= flat query-anchored, show identities,<br>   <span class="hljs-number"> 4 </span>= flat query-anchored, no identities,<br>   <span class="hljs-number"> 5 </span>= XML Blast output,<br>   <span class="hljs-number"> 6 </span>= tabular,<br>   <span class="hljs-number"> 7 </span>= tabular with comment lines,<br>   <span class="hljs-number"> 8 </span>= Text ASN.1,<br>   <span class="hljs-number"> 9 </span>= Binary ASN.1,<br>  <span class="hljs-number"> 10 </span>= Comma-separated values,<br>  <span class="hljs-number"> 11 </span>= BLAST archive format (ASN.1)<br></code></pre></td></tr></table></figure><h2 id="Blast-with-parallel"><a href="#Blast-with-parallel" class="headerlink" title="Blast with parallel"></a>Blast with parallel</h2><p>If you need to run your blasts faster (and who doesnâ€™t?), you can maximise CPU usage with <code>gnu parallel</code>. You will find it <a href="http://ftp.gnu.org/gnu/parallel/parallel-latest.tar.bz2">at this link</a>.</p><p>Download the archive, extract it (with <code>tar xvfB parallel-latest.tar.bz2</code>) and install it with the following commands:</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gauss">./configure<br><span class="hljs-built_in">make</span><br>sudo <span class="hljs-built_in">make</span> install<br></code></pre></td></tr></table></figure><p>We can now use <code>parallel</code> to speed up blast:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">time</span> cat sequences.fasta | parallel -k --block <span class="hljs-number">1</span>k --recstart &#x27;&gt;&#x27; --pipe &#x27;blastn -db databases/reference -query - -evalue <span class="hljs-number">1</span>e-<span class="hljs-number">3</span> -word_size <span class="hljs-number">11</span> -outfmt <span class="hljs-number">0</span>&#x27; &gt; sequences.reference<br></code></pre></td></tr></table></figure><h2 id="blast-distribution"><a href="#blast-distribution" class="headerlink" title="blast+ distribution"></a>blast+ distribution</h2><p>An exhaustive list of the programs that come with the blast+ distribution</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">blastdb_aliastool</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">blastdbcheck</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">blastdbcmd</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">blast_formatter</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">blastn</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">blastp</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">blastx</span><br><span class="hljs-keyword"></span>convert<span class="hljs-symbol">2b</span>lastmask<br>deltablast<br>dustmasker<br>legacy_blast.pl<br>makeblastdb<br>makembindex<br>makeprofiledb<br>psiblast<br>rpsblast<br>rpstblastn<br>segmasker<br>tblastn<br>tblastx<br>update_blastdb.pl<br>windowmasker<br></code></pre></td></tr></table></figure><hr><p><a href="https://ncbi.github.io/magicblast/cook/blastdb.html">https://ncbi.github.io/magicblast/cook/blastdb.html</a></p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>blast</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€CUT-Tagã€‘ã€ATAC-seqã€‘</title>
    <link href="/GeekFocus/2022/03/18/2022-03-19-CUT-Tag/"/>
    <url>/GeekFocus/2022/03/18/2022-03-19-CUT-Tag/</url>
    
    <content type="html"><![CDATA[<p>CUT&amp;RUN CUT&amp;Tag ChIP-seq ATAC-seq</p><span id="more"></span><p><a href="https://www.bilibili.com/video/BV11K4y147fN?from=search&seid=6789892139579942949&spm_id_from=333.337.0.0">å˜‰å› ç”Ÿç‰©</a></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/1.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/1.png" alt="img"></p><p><strong>æµ‹åºæ•°æ®é‡</strong></p><p>å‚è€ƒChIP-seq 20M&#x2F;40Mï¼ˆ2000ä¸‡readsï¼‰ï¼ˆå¯¹PE50çº¦ä¸º 6&#x2F;12Gï¼‰</p><p><strong>CUT&amp;Tag-å»é™¤æµ‹åºæ¥å¤´</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/2.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/2.png" alt="img"></p><p><strong>å»æ¥å¤´è½¯ä»¶</strong></p><p>Trimmomaticï¼›Cutadaptï¼›fastp</p><p><strong>å‚è€ƒåºåˆ—æ¯”å¯¹</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/3.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/3.png" alt="img"></p><p><strong>æ•°æ®è¿‡æ»¤</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/4.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/4.png" alt="img"></p><p><strong>CUT&amp;Tagç‰‡æ®µé•¿åº¦åˆ†å¸ƒ</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/5.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/5.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/6.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/6.png" alt="img"></p><p><strong>CUT&amp;Tag-ç»“åˆä½ç‚¹æ£€æµ‹ï¼ˆPeakCallingï¼‰</strong></p><p>MACS2 ä¸»æµ</p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/7.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/7.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/8.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/8.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/9.png" alt="9"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/9.png" alt="9"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/10.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/10.png" alt="img"></p><p>SEACR ç»“æœæ²¡é‚£ä¹ˆå¥½</p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/11.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/11.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/12.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/12.png" alt="img"></p><p><strong>CUT&amp;Tag-ç»“åˆä½ç‚¹ä¿¡å·åˆ†å¸ƒ</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/13.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/13.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/14.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/14.png" alt="img"></p><p><strong>CUT&amp;Tag-Peaks åŠŸèƒ½æ€§åŒºåŸŸæ³¨é‡Š</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/15.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/15.png" alt="img"></p><p><strong>CUT&amp;Tag-Motif Analysis</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/16.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/16.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/17.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/17.png" alt="img"></p><p><strong>CUT&amp;Tag-å…¶ä»–åˆ†æ</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/18.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/18.png" alt="img"></p><p><strong>CUT&amp;Tag-è”åˆRNA-seqåˆ†æ</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/19.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/19.png" alt="img"></p><p>BETA åŠŸèƒ½1ï¼Œ2ã€‚3ç”¨hommeræ›´å¤š</p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/20.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/20.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/21.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/21.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/22.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/22.png" alt="img"></p><p>Activating&#x2F;repressive function prediction</p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/23.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/23.png" alt="img"></p><p>Target gene</p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/24.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/24.png" alt="img"></p><p><strong>å¦‚ä½•è¯„ä¼°CUT&amp;Tagä¸­IgGçš„ä½œç”¨</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/25.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/25.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/26.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/26.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/27.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/27.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/28.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/28.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/29.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/29.png" alt="img"></p><p>ä¸ºä½•IgGä¿¡å·å’Œç»„è›‹ç™½ä¿¡å·åŒæ­¥å‡ºç°ï¼Ÿ</p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/30.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/30.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/31.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/31.png" alt="img"></p><p><strong>CUT&amp;Tag-Quality Control</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/32.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/32.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/33.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/33.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/34.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/34.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/35.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/35.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/36.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/36.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/37.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/37.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/38.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/38.png" alt="img"></p><p>ç»„è›‹ç™½ï¼Œè½¬å½•èµ·å§‹æ¿€æ´»markerï¼Œåœ¨èµ·å§‹TSSé«˜ï¼›<strong>æŠ‘åˆ¶</strong>çš„<strong>marker</strong>H3K36me3åœ¨<strong>genebodyåŒºåŸŸæ¯”è¾ƒé«˜</strong></p><p><strong>UCSC toolså·¥å…·</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/39.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/39.png" alt="img"></p><p><strong>Cistromeï¼šChIP-seqåœ¨çº¿åˆ†æå·¥å…·</strong></p><p>æå‰æŸ¥æ•°æ® </p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/40.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/40.png" alt="img"></p><p><strong>Motifæ•°æ®åº“JASPAR</strong></p><p><strong>Motifå·¥å…·MEME</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/41.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/41.png" alt="img"></p><p><a href="https://www.bilibili.com/video/BV1py4y1a7L5/?spm_id_from=333.788.recommend_more_video.2">FraserGen</a></p><p>ATACæµ‹åºï¼ŒIllumina PE150ï¼Œæµ‹åºæ•°æ®é‡æœ€ç»ˆå¯ç”¨æ¨èï¼š50Mï¼ˆå¼€æ”¾åŒºåŸŸï¼‰ï¼Œ200Mï¼ˆTFfootprintï¼‰</p><p><strong>ATAC-seqé¡¹ç›®å±•ç¤º åŠ¨ç‰©æ¤ç‰©</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/42.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/42.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/43.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/43.png" alt="img"></p><p>æ³¨æ„trimmomatic çš„NexteraPE-PE.fa;æ³¨æ„bowtie2 -X æœ€å¤§æ’å…¥ç‰‡æ®µé•¿åº¦è®¾ç½®1000&#x2F;2000.</p><p><strong>æ’å…¥ç‰‡æ®µé•¿åº¦ç»Ÿè®¡</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/44.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/44.png" alt="img"></p><p><strong>-f 0x40 åªç»Ÿè®¡reads1</strong>(ç»Ÿè®¡ä¸€æ¬¡indertsize)</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#Rscript plotInsertSize.R insertSize.txt insertSize.png</span><br><span class="hljs-comment">#plotInsertSize.R</span><br>cmd<span class="hljs-operator">=</span>commandArgs<span class="hljs-punctuation">(</span>trailingOnly<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span>;<br>input<span class="hljs-operator">=</span>cmd<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span>;<br>output<span class="hljs-operator">=</span>cmd<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span>;<br>d<span class="hljs-operator">=</span>read.table<span class="hljs-punctuation">(</span>input<span class="hljs-punctuation">)</span>;<br>png<span class="hljs-punctuation">(</span>file<span class="hljs-operator">=</span>output<span class="hljs-punctuation">)</span>;<br>hist<span class="hljs-punctuation">(</span>d<span class="hljs-operator">$</span>V1<span class="hljs-punctuation">,</span>mian<span class="hljs-operator">=</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span>ylab<span class="hljs-operator">=</span><span class="hljs-string">&quot;readCount&quot;</span><span class="hljs-punctuation">,</span>xlab<span class="hljs-operator">=</span><span class="hljs-string">&quot;insertsize&quot;</span><span class="hljs-punctuation">,</span>xaxt<span class="hljs-operator">=</span><span class="hljs-string">&quot;n&quot;</span><span class="hljs-punctuation">,</span>breaks<span class="hljs-operator">=</span>seq<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">max</span><span class="hljs-punctuation">(</span>d<span class="hljs-operator">$</span>V1<span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>;<br>axis<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span>;<br>dev.off;<br></code></pre></td></tr></table></figure><p><strong>Peak calling principle for atac</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/45.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/45.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/46.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/46.png" alt="img"></p><p>Shift -75 å¾€5â€˜ç«¯ç§»åŠ¨ï¼›<strong>nomodel ä¸å»ºç«‹åŒå³°æ¨¡å‹</strong>ï¼›**-SMPRå¯¹æ•°æ®é‡æ ‡å‡†åŒ–**</p><blockquote><p>å•ç«¯æµ‹åºæ—¶éœ€è¦å»ºç«‹åŒå³°æ¨¡å‹æ¨æµ‹DNAç‰‡æ®µçš„é•¿åº¦ã€‚åŒç«¯ä¸éœ€è¦</p><p>å¹³ç§»è®©Tn5åˆ‡å‰²æ–­ç‚¹å¤„äºreadsæ­£ä¸­å¿ƒ</p><p>-SMPR save signal per million reads</p></blockquote><p>BDG to BigWigã€ä½¿ç”¨BDGè½¬æ¢çš„bigwigæ–‡ä»¶å’Œbamè½¬åŒ–bwï¼Œç›´æ¥ä½¿ç”¨narrowpeakçš„åŒºåˆ«æ˜¯ã€‘</p><p>å»ºè®®ç”¨bdgè½¬æ¢çš„bigwigæ–‡ä»¶ï¼Œå› ä¸ºè¯¥æ–‡ä»¶åšäº†å¹³ç§»shiftå’Œå»¶ä¼¸extend</p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/47.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/47.png" alt="img"></p><p><strong>Data Quality Assesment</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/48.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/48.png" alt="img"></p><p><strong>Data Visualization</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/49.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/49.png" alt="img"></p><p><strong>Multiple Replicates</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/50.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/50.png" alt="img"></p><p>IDRæ‰€æœ‰ç‚¹ä»£è¡¨æœ‰overlapï¼Œçº¢ç‚¹è¡¨ç¤ºå¯Œé›†å€æ•°æœ‰å·®å¼‚ï¼Œé»‘ç‚¹è¡¨ç¤ºå¯Œé›†å€æ•°ä¸€è‡´ã€‚IDRåœ¨åŠ¨ç‰©é‡Œç®—å‡ºçš„ç»“æœè¾ƒå¥½ï¼Œæ¤ç‰©ç”±äºå®éªŒé—®é¢˜æ•ˆæœæ²¡é‚£ä¹ˆå¥½ï¼ˆä¸æ¨èï¼Ÿï¼‰ï¼Œæ¤ç‰©ç›´æ¥overlap-peakã€‚</p><p><strong>Peak annotation</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/51.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/51.png" alt="img"></p><p><strong>Motif analysis</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/52.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/52.png" alt="img"></p><p><strong>ä¸ªæ€§åŒ–åˆ†æ</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/53.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/53.png" alt="img"></p><p>TFç½‘ç»œéœ€è¦å¤šç»„æ•°æ®ä¸åŒå¤„ç†æ¡ä»¶ä¸‹</p><p><strong>è”åˆåˆ†æ</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/54.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/54.png" alt="img"></p><p>è¡¨è¾¾ç¨‹åº¦è¶Šé«˜ä¿¡å·è¶Šé«˜ã€‚</p><p><strong>æ¡ˆä¾‹</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/55.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/55.png" alt="img"></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/56.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/56.png" alt="img"></p><p>H3K27me3 genebody</p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/57.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/57.png" alt="img"></p><p>peak-to-gene link predictionã€å¤§æ ·æœ¬é‡çš„ATACå’ŒRNAseqå…³è”åˆ†æã€‘</p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/58.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/58.png" alt="img"></p><hr><p><strong>CUT&amp;Tag</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/59.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/59.png" alt="img"></p><p>ChIPå®éªŒæ–°æ–¹æ³•ï¼šCUT&amp;RUN å’Œ CUT&amp;Tag å‘¨æœŸå¿«ï¼›ææ–™éœ€æ±‚å°‘ï¼›æ•°æ®ä¿¡å™ªæ¯”é«˜</p><p><strong>C</strong>leavage <strong>U</strong>nder <strong>T</strong>argets and <strong>R</strong>elease <strong>U</strong>sing <strong>N</strong>uclease</p><p><strong>C</strong>leavage <strong>U</strong>nder <strong>T</strong>argets and <strong>Tag</strong>mentation</p><p><strong>åŸç†ä»‹ç»</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/60.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/60.png" alt="img"></p><p>è›‹ç™½ç£ç å¸é™„æ ¸è†œï¼Œç»†èƒç»‘å®šåœ¨ç£ç ä¸Šã€‚ç»†èƒè†œç©¿å­”ï¼ŒpAG-MNaseè¿›å…¥ï¼Œprimary AbæŠ—ä½“åŠ å…¥ã€‚å¤šä½™æŠ—ä½“å¤šä½™pAG-MNaseæ´—æ‰ï¼Œ<strong>pAG-MNase and primary Ab binding</strong>ã€‚åŠ å…¥é’™ç¦»å­æ¿€æ´»ï¼Œé¶å‘ä½ç‚¹åˆ‡å‰²ï¼Œæ•´ä¸ªåŸºå› ç»„å°‘éƒ¨åˆ†ä½ç½®åˆ‡å‰²ã€èƒŒæ™¯å™ªéŸ³é«˜ä½å–å†³äºæŠ—ä½“è´¨é‡å¥½åã€‘ã€‚åªæœ‰åˆ‡å‰²çš„å°ç‰‡æ®µä»å°å­”å‡ºæ¥(å¤§éƒ¨åˆ†èƒŒæ™¯é—ç•™åœ¨æ ¸å†…)ã€‚CUT&amp;RUNç”¨çš„pAG-MNaseä¾ç„¶è¦è¡¥å¹³åŠ æ¥å¤´ï¼Œæ›¿æ¢ä¸ºProtein-A-Tn5åˆ™å˜ä¸ºCUT&amp;Tagï¼Œä¸€å¤©ä»¥å†…å®Œæˆçš„â€ChIPâ€å®éªŒã€‚</p><p><strong>å®éªŒæµç¨‹</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/61.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/61.png" alt="img"></p><p>æ–‡åº“ç‰‡æ®µåˆ†å¸ƒå’ŒATACç±»ä¼¼ï¼ˆTn5ï¼Œæ ¸å°ä½“ï¼‰</p><p>IgGé˜´æ€§å¯¹ç…§å¸®åŠ©åˆ¤æ–­åˆ°åº•æ˜¯ChIPå³°è¿˜æ˜¯ATACå³°(å®éªŒæ˜¯å¦æˆåŠŸ)ã€‚æ¤ç‰©éš¾åº¦å¤§ï¼Œæ¤ç‰©ç”¨åŸç”Ÿè´¨ä½“ã€‚æ¤ç‰©æ¨èåšchipå°±è¡Œï¼ŸåŠ¨ç‰©å†»å­˜ç»„ç»‡å¯å°è¯•ï¼Œæ¤ç‰©å†»å­˜ä¸æ¨èã€‚CUTæŠ€æœ¯æ˜¯é’ˆå¯¹å°‘é‡ç»†èƒçš„ã€‚å°‘é‡ç»†èƒå¯èƒ½æ•°æ®é‡å°‘ã€‚CUT&amp;Tagç¼ºç‚¹æ˜¯ç”±äºTn5åªåšå¼€æ”¾åŒºåŸŸï¼Œè‹¥æ˜¯å¼‚æŸ“è‰²è´¨H3K9ï¼ŒH3K39ä¸‰ç”²åŸºåŒ–è¿™ç§markeråšä¸äº†</p><p><strong>CUT&amp;Tagæ•°æ®åˆ†æ</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/62.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/62.png" alt="img"></p><p><strong>æå‡CUT&amp;Tagæ•°æ®å…³é”®</strong></p><p>æŠ—ä½“è´¨é‡ï¼šChIP-gradeï¼›WesternéªŒè¯ï¼›æŠ—ä½“æ‰¹æ¬¡æ•ˆåº”</p><p>ç»†èƒè´¨é‡ï¼šæ´»ç»†èƒæ¯”ä¾‹&gt;95%(native chromatin )ï¼›ç»†èƒå‡ä¸€æ€§</p><p><strong>MACSè½¯ä»¶</strong></p><p>æ•°æ®å™ªéŸ³è¯„ä¼°</p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/63.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/63.png" alt="img"></p><p><strong>ï¼ï¼ï¼Peak calling for ATAC</strong></p><p><img src="/GeekFocus/2022-03-19-CUT-Tag/64.png" alt="img"><br><img src="/GeekFocus/img/2022-03-19-CUT-Tag/64.png" alt="img"></p><p><font color="red"><strong>å¯¹äºATACï¼Œä¸€æ¡DNA fragmentä»£è¡¨ä¸¤ä¸ªé…¶åˆ‡ä½ç‚¹ä¿¡æ¯ï¼Œè½¬bedæ ¼å¼ã€‚å¦‚æœç”¨bamæ–‡ä»¶ä¼šé»˜è®¤ä¸¢æ‰reads2</strong></font></p><p><strong>Code</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#step1 å»æ¥å¤´</span><br><br><span class="hljs-comment">#step2 å»ºç«‹index</span><br>ref.fa<br>genes.gtf<br>bowtie2 build<br>samtools faidx ref.fa<br><br><span class="hljs-comment">#step3 æ¯”å¯¹</span><br>bowtie2 -x index/ref -X 1000 -1 R1.fq -2 R2.fq -S .sam<br><br><span class="hljs-comment">#step4 æŒ‘é€‰å¯é æ¯”å¯¹ç»“æœ</span><br>samtools view -b -f 2 -q 30 -0 pairs.bam .sam<br><br><span class="hljs-comment">#step5 å»é™¤PCRé‡å¤</span><br>samtools <span class="hljs-built_in">sort</span> -o pairs.sorted.bam pairs.bam<br>picard.jar MarkDuplicates<br><br><span class="hljs-comment">#step6 æŸ¥çœ‹mito pt æ±¡æŸ“</span><br>samtools index pairs.sorted.dedup.bam<br>samtools idxstats pairs.sorted.dedup.bam<br><br><span class="hljs-comment">#step7 å»é™¤çº¿ç²’ä½“æ•°æ®</span><br>samtools view -h pairs.sorted.dedup.bam | grep -v <span class="hljs-string">&quot;chrM&quot;</span> | grep -v <span class="hljs-string">&quot;Pt&quot;</span> | samtools view -bS -o final.bam<br><br><span class="hljs-comment">#step8 ç»Ÿè®¡æ’å…¥ç‰‡æ®µé•¿åº¦åˆ†å¸ƒ</span><br>Rscript plotInsertSize final.bam final.insertsize<br><br><span class="hljs-comment">#step9 peak calling</span><br>bedtools bamtobed -1 final.bam &gt; final.bam.bed<br><br>macs2 callpeak -t final.bam.bed -n rep1 --<span class="hljs-built_in">shift</span> -100 --extsize 200 --nomodel -B --SPMR -g 2e<br><br><span class="hljs-comment">#step10 TSSå¯Œé›†</span><br><span class="hljs-comment">#BDG to BigWig</span><br><span class="hljs-comment">#UCSC utitlities</span><br><span class="hljs-comment">#å¯¹bdgæ–‡ä»¶æ’åº</span><br>bedSort treat.bdg treat.sort.bdg<br><span class="hljs-comment">#ç”ŸæˆåŸºå› ç»„å„æ¡åºåˆ—é•¿åº¦ä¿¡æ¯ï¼Œç›´æ¥ä»bamæ–‡ä»¶å¾—åˆ°</span><br>samtools view -H final.bam | perl -ne <span class="hljs-string">&#x27;if(/SN:(\S+)\s+LN:(\d+)/)&#123;print &quot;$1\t$2\n&quot;&#125;&#x27;</span> &gt; chrome.sizes<br><span class="hljs-comment">#ç”Ÿæˆbigwigæ–‡ä»¶</span><br>bedClip -<span class="hljs-built_in">truncate</span> treat.sort.bdg chrome.sizes stdout | perl -ane <span class="hljs-string">&#x27;print if($F[1]&lt;$F[2])&#x27;</span> &gt; treat.bdegraph<br>bedGraphToBigWig treat.bdegraph chrome.sizes treat.bw<br><br>computeMatrix reference-point -S Rep1.bw Rep2.bw -R .gtf -a 3000 -b 3000 -p 1 -o matrix.gz<br>plotHeatmap -m matrix.gz -o heatmap.png --colorMap Reds<br><br><span class="hljs-comment">#step11 peaké‡å¤æ€§</span><br>bedtools intersect -a .peak -b .peak | <span class="hljs-built_in">wc</span> -l<br>bedtools intersect -a .peak -b .peak -f 0.5 -F 0.5 | <span class="hljs-built_in">wc</span> -l<br>idr -s rep1.peak rep2.peak -o idr --plot<br><br><span class="hljs-comment">#step12 peakåœ¨åŸºå› ä¸Šçš„åˆ†å¸ƒ</span><br>Rscript PeakAnnotation.R .gtf rep1.peak Rep1<br><br></code></pre></td></tr></table></figure><hr><p>IgGï¼Ÿ</p>]]></content>
    
    
    <categories>
      
      <category>NGS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>atac-seq</tag>
      
      <tag>CUT-tag</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Assembly Gene Annotation</title>
    <link href="/GeekFocus/2022/03/18/2022-03-18-annotation/"/>
    <url>/GeekFocus/2022/03/18/2022-03-18-annotation/</url>
    
    <content type="html"><![CDATA[<p>Structural annotation and functional annotation</p><span id="more"></span><p><a href="https://phytozome-next.jgi.doe.gov/">https://phytozome-next.jgi.doe.gov</a></p><hr><h1 id="åŸºå› ç»„æ³¨é‡Šç®€ä»‹"><a href="#åŸºå› ç»„æ³¨é‡Šç®€ä»‹" class="headerlink" title="åŸºå› ç»„æ³¨é‡Šç®€ä»‹"></a>åŸºå› ç»„æ³¨é‡Šç®€ä»‹</h1><p>åŸºå› ç»„æ³¨é‡Šä¸»è¦åŒ…æ‹¬å››ä¸ªç ”ç©¶æ–¹å‘ï¼š<strong>é‡å¤åºåˆ—è¯†åˆ«</strong>ï¼›<strong>éç¼–ç RNAé¢„æµ‹</strong>ï¼›åŸºå› <strong>ç»“æ„é¢„æµ‹</strong>å’ŒåŸºå› <strong>åŠŸèƒ½æ³¨é‡Š</strong>ã€‚åˆ†åˆ«å¯¹å››ä¸ªé¢†åŸŸé˜è¿°ã€‚</p><h2 id="1ï¼šé‡å¤åºåˆ—çš„è¯†åˆ«"><a href="#1ï¼šé‡å¤åºåˆ—çš„è¯†åˆ«" class="headerlink" title="1ï¼šé‡å¤åºåˆ—çš„è¯†åˆ«"></a>1ï¼šé‡å¤åºåˆ—çš„è¯†åˆ«</h2><p><strong>é‡å¤åºåˆ—çš„ç ”ç©¶èƒŒæ™¯å’Œæ„ä¹‰ï¼š</strong>é‡å¤åºåˆ—å¯åˆ†ä¸º<font color="blue">ä¸²è”é‡å¤åºåˆ—ï¼ˆTendam repeatï¼‰</font>å’Œ<font color="blue">æ•£åœ¨é‡å¤åºåˆ—(Interpersed repeat)</font>ä¸¤å¤§ç±»ã€‚å…¶ä¸­<strong>ä¸²è”é‡å¤åºåˆ—</strong>åŒ…æ‹¬<font color="blue">å«æ˜ŸDNAï¼Œå¾®å«æ˜Ÿåºåˆ—ï¼Œå°å«æ˜Ÿåºåˆ—</font>ï¼›<strong>æ•£åœ¨é‡å¤åºåˆ—</strong>åˆç§°<font color="blue">è½¬åº§å­å…ƒä»¶</font>ï¼ŒåŒ…æ‹¬ä»¥DNA-DNAæ–¹å¼è½¬åº§çš„<font color="blue">DNAè½¬åº§å­å’Œåè½¬å½•è½¬åº§å­(retrotransposon)</font>ã€‚å¸¸è§çš„åè½¬å½•è½¬åº§å­ç±»åˆ«æœ‰<font color="blue">LTR,LINEå’ŒSINE</font>ã€‚</p><p><strong>é‡å¤åºåˆ—è¯†åˆ«çš„å‘å±•ç°çŠ¶ï¼š</strong>ç›®å‰ï¼Œè¯†åˆ«<font color="blue">é‡å¤åºåˆ—</font>å’Œ<font color="blue">è½¬åº§å­</font>çš„æ–¹æ³•ä¸º<font color="red"><strong>åºåˆ—æ¯”å¯¹</strong></font>å’Œ<font color="red"><strong>ä»å¤´é¢„æµ‹</strong></font>ä¸¤ç±»ã€‚<font color="blue"><strong>åºåˆ—æ¯”å¯¹</strong></font>æ–¹æ³•ä¸€èˆ¬é‡‡ç”¨<font color="red"><strong>Repeatmasker</strong></font>è½¯ä»¶ï¼Œ<font color="blue">è¯†åˆ«</font>ä¸å·²çŸ¥é‡å¤åºåˆ—<font color="blue">ç›¸ä¼¼</font>çš„åºåˆ—ï¼Œå¹¶å¯¹å…¶<font color="blue">åˆ†ç±»</font>ã€‚å¸¸ç”¨<font color="red"><strong>Repbase</strong>é‡å¤åºåˆ—æ•°æ®åº“</font>ã€‚<font color="blue"><strong>ä»å¤´é¢„æµ‹</strong></font>æ–¹æ³•åˆ©ç”¨é‡å¤åºåˆ—æˆ–è½¬åº§å­<font color="blue">è‡ªèº«çš„åºåˆ—æˆ–ç»“æ„ç‰¹å¾</font>æ„å»º<font color="blue"><strong>ä»å¤´é¢„æµ‹ç®—æ³•æˆ–è½¯ä»¶</strong></font>å¯¹åºåˆ—è¿›è¡Œ<font color="blue">è¯†åˆ«</font>ã€‚ä»å¤´é¢„æµ‹æ–¹æ³•çš„<font color="blue"><strong>ä¼˜ç‚¹</strong></font>åœ¨äºèƒ½å¤Ÿæ ¹æ®è½¬åº§å­å…ƒä»¶è‡ªèº«çš„ç»“æ„ç‰¹å¾è¿›è¡Œé¢„æµ‹ï¼Œ<font color="blue">ä¸ä¾èµ–</font>äºå·²æœ‰è½¬åº§å­æ•°æ®åº“ï¼Œèƒ½å¤Ÿ<font color="blue">å‘ç°æœªçŸ¥</font>çš„è½¬åº§å­å…ƒä»¶ã€‚å¸¸è§çš„ä»å¤´é¢„æµ‹æ–¹æ³•æœ‰<font color="red">Reconï¼ŒPilerï¼ŒRepeatscout,LTR-finderï¼ŒReAS</font>ç­‰ã€‚</p><p><strong>é‡å¤åºåˆ—è¯†åˆ«çš„ç ”ç©¶å†…å®¹ï¼š</strong>è·å¾—ç»„è£…å¥½çš„åŸºå› ç»„åºåˆ—åï¼Œ<font color="blue"><strong>é¦–å…ˆé¢„æµ‹</strong></font>åŸºå› ç»„ä¸­çš„<font color="blue">é‡å¤åºåˆ—å’Œè½¬åº§å­å…ƒä»¶</font>ã€‚ä¸€æ–¹é¢ï¼Œé‡‡ç”¨RepeatScoutã€LTR-finderã€Tendem Repeat Finderã€Repeatmoderlerã€Pilerç­‰ä»å¤´é¢„æµ‹è½¯ä»¶<font color="red"><strong>é¢„æµ‹é‡å¤åºåˆ—</strong></font>ã€‚ä¸ºäº†è·å¾—ä»å¤´é¢„æµ‹æ–¹æ³•å¾—åˆ°çš„é‡å¤åºåˆ—çš„ç±»åˆ«ä¿¡æ¯ï¼Œ<font color="blue">æŠŠè¿™äº›åºåˆ—<strong>ä¸Repbaseæ•°æ®åº“æ¯”å¯¹</strong></font>ï¼Œå°†èƒ½å¤Ÿå½’ç±»çš„é‡å¤åºåˆ—<font color="red">åˆ†ç±»</font>ã€‚å¦ä¸€æ–¹é¢ï¼Œåˆ©ç”¨<font color="red">Repeatmasker<strong>è¯†åˆ«</strong></font>ä¸å·²çŸ¥é‡å¤åºåˆ—<font color="blue"><strong>ç›¸ä¼¼</strong>çš„é‡å¤åºåˆ—æˆ–è›‹ç™½è´¨åºåˆ—</font>ã€‚é€šè¿‡æ„å»ºRepbaseæ•°æ®åº“åœ¨<font color="blue"><strong>DNAæ°´å¹³</strong>å’Œ<strong>è›‹ç™½è´¨æ°´å¹³</strong></font>çš„é‡å¤åºåˆ—ï¼ŒRepeatmaskeråˆ†åˆ«è¯†åˆ«åœ¨DNAæ°´å¹³å’Œè›‹ç™½è´¨æ°´å¹³é‡å¤çš„åºåˆ—ï¼Œæé«˜è¯†åˆ«ç‡ã€‚</p><p><strong>é‡å¤åºåˆ—è¯†åˆ«çš„å…³é”®æŠ€æœ¯éš¾ç‚¹ï¼š</strong></p><p>1ï¼‰ï¼š<font color="blue"><strong>äºŒä»£</strong></font>æµ‹åºæµ‹åŸºå› ç»„ï¼Œæˆæœ¬ä½ã€é€Ÿåº¦å¿«ã€‚ä½†è¯»é•¿ï¼ˆreadsï¼‰è¾ƒçŸ­ã€‚ç”±äºåŸºå› ç»„åºåˆ—é‡‡ç”¨kmerç®—æ³•è¿›è¡Œç»„è£…ï¼Œ<strong>é«˜åº¦ç›¸ä¼¼</strong>çš„<strong>é‡å¤åºåˆ—</strong>å¯èƒ½ä¼š<strong>è¢«å‹ç¼©åˆ°ä¸€èµ·</strong>ï¼Œå½±å“åç»­é‡å¤åºåˆ—è¯†åˆ«ã€‚</p><p>2ï¼‰ï¼šæŸäº›<strong>é«˜åº¦é‡å¤åºåˆ—</strong>ç”¨ç°æœ‰çš„ç»„è£…æ–¹æ³•<strong>éš¾ä»¥ç»„è£…</strong>ï¼Œæˆä¸ºæœªç»„è£…readsï¼ˆ<strong>unassembled reads</strong>ï¼‰ã€‚æœ‰å¿…è¦**åŒæ—¶åˆ†ææœªç»„è£…reads?**ä»¥å¾—åˆ°æ›´ä¸ºå®Œæ•´çš„é‡å¤åºåˆ—åˆ†å¸ƒå›¾ã€‚åå¤§å¼€å‘ReASè½¯ä»¶ï¼Œä¸“é—¨ç”¨äºè¯†åˆ«æœªç»„è£…readsä¸­çš„é‡å¤åºåˆ—ã€‚ä½†è¯¥è½¯ä»¶ç›®å‰åªèƒ½å¤„ç†ä¼ ç»Ÿæµ‹åºæŠ€æœ¯(å¦‚sangeræµ‹åº)ç”Ÿæˆçš„è¾ƒé•¿ç‰‡æ®µçš„readsï¼Œéœ€è¿›ä¸€æ­¥æ”¹è¿›æ–¹å¯ç”¨äºåˆ†æäºŒä»£readsã€‚åŒæ—¶ï¼Œæœªç»„è£…çš„çŸ­ç‰‡æ®µreadsé‡å¤åº¦æ›´é«˜ï¼Œè¯†åˆ«å…¶é‡å¤åŒºåŸŸå…·æœ‰è¾ƒå¤§éš¾åº¦ã€‚</p><p><strong>é‡å¤åºåˆ—è¯†åˆ«çš„ç ”ç©¶æ–¹å‘ï¼š</strong></p><p>1ï¼‰ï¼šæ•´åˆç°æœ‰çš„é‡å¤åºåˆ—é¢„æµ‹æ–¹æ³•ï¼Œå¯¹<font color="blue">ç»„è£…å¥½çš„åŸºå› ç»„åºåˆ—</font>è¿›è¡Œåˆ†æã€‚</p><p>2ï¼‰ï¼šç»¼åˆè€ƒè™‘å¹¶ç»“åˆçŸ­åºåˆ—ç»„è£…ç­–ç•¥ï¼Œ<font color="blue">æ ¡æ­£é‡å¤åºåˆ—è¯†åˆ«</font>çš„ç»“æœã€‚</p><p>3ï¼‰ï¼š<font color="blue">å¼€å‘è¯†åˆ«<strong>æœªç»„è£…reads</strong>é‡å¤åºåˆ—çš„ç®—æ³•å’Œæµç¨‹</font>å¹¶æ„å»ºä¸€è‡´æ€§åºåˆ—ã€‚</p><h2 id="2ï¼šéç¼–ç RNAåºåˆ—çš„é¢„æµ‹"><a href="#2ï¼šéç¼–ç RNAåºåˆ—çš„é¢„æµ‹" class="headerlink" title="2ï¼šéç¼–ç RNAåºåˆ—çš„é¢„æµ‹"></a>2ï¼šéç¼–ç RNAåºåˆ—çš„é¢„æµ‹</h2><p><strong>éç¼–ç RNAé¢„æµ‹çš„ç ”ç©¶èƒŒæ™¯å’Œæ„ä¹‰ï¼š</strong>éç¼–ç RNAï¼ŒæŒ‡ä¸è¢«ç¿»è¯‘æˆè›‹ç™½è´¨çš„RNAï¼Œå¦‚tRNA, rRNAç­‰ï¼Œè¿™äº›RNAä¸è¢«ç¿»è¯‘æˆè›‹ç™½è´¨ï¼Œä½†å…·æœ‰é‡è¦ç”Ÿç‰©å­¦åŠŸèƒ½ã€‚<font color="red"><strong>miRNA</strong></font>ç»“åˆå…¶é¶å‘åŸºå› çš„mRNAåºåˆ—ç»“åˆï¼Œå°†mRNAé™è§£æˆ–æŠ‘åˆ¶å…¶ç¿»è¯‘æˆè›‹ç™½è´¨ï¼Œå…·æœ‰<font color="blue"><strong>æ²‰é»˜åŸºå› </strong></font>çš„åŠŸèƒ½ã€‚<font color="red"><strong>tRNA</strong></font> (è½¬è¿RNA)æºå¸¦æ°¨åŸºé…¸è¿›å…¥æ ¸ç³–ä½“ï¼Œä½¿ä¹‹åœ¨mRNAæŒ‡å¯¼ä¸‹<font color="blue"><strong>åˆæˆè›‹ç™½è´¨</strong></font>ã€‚<font color="red"><strong>rRNA</strong></font>(æ ¸ç³–ä½“RNA)ä¸è›‹ç™½è´¨ç»“åˆ<font color="blue"><strong>å½¢æˆæ ¸ç³–ä½“</strong></font>ï¼Œå…¶åŠŸèƒ½æ˜¯ä½œä¸ºmRNAçš„æ”¯æ¶ï¼Œæä¾›mRNAç¿»è¯‘æˆè›‹ç™½è´¨çš„åœºæ‰€ã€‚<font color="red"><strong>snRNAï¼ˆå°æ ¸RNAï¼‰</strong></font>ä¸»è¦å‚ä¸<font color="blue"><strong>RNAå‰ä½“åŠ å·¥</strong></font>ï¼Œæ˜¯<font color="blue"><strong>RNAå‰ªåˆ‡ä½“</strong>ä¸»è¦æˆåˆ†</font>ã€‚</p><p><strong>éç¼–ç RNAé¢„æµ‹çš„å‘å±•ç°çŠ¶ï¼š</strong>ç”±äºncRNAç§ç±»ç¹å¤šï¼Œç‰¹å¾å„å¼‚ï¼Œç¼ºå°‘ç¼–ç è›‹ç™½è´¨çš„åŸºå› æ‰€å…·æœ‰çš„å…¸å‹ç‰¹å¾ï¼Œç°æœ‰çš„ncRNA<strong>é¢„æµ‹è½¯ä»¶</strong>ä¸€èˆ¬<strong>ä¸“æ³¨äºæœç´¢å•ä¸€ç§ç±»</strong>çš„ncRNAï¼Œå¦‚<font color="blue">tRNAScan-SE æœç´¢tRNAã€snoScan æœç´¢å¸¦C&#x2F;Dç›’çš„snoRNAsã€SnoGps æœç´¢å¸¦H&#x2F;ACA ç›’çš„snoRNAsã€mirScan æœç´¢microRNA</font>ç­‰ã€‚Sangerå®éªŒå®¤å¼€å‘äº†<font color="blue">Infernalè½¯ä»¶</font>ï¼Œ<font color="blue">å»ºç«‹1600å¤šä¸ªRNAå®¶æ—</font>ï¼Œå¹¶å¯¹æ¯ä¸ªå®¶æ—å»ºç«‹<font color="blue">ä¸€è‡´æ€§äºŒçº§ç»“æ„å’Œåæ–¹å·®æ¨¡å‹</font>ï¼Œå½¢æˆäº†<font color="red"><strong>Rfamæ•°æ®åº“</strong></font>ã€‚é‡‡ç”¨Rfamæ•°æ®åº“ä¸­çš„æ¯ä¸ªRNAçš„åæ–¹å·®æ¨¡å‹ï¼Œç»“åˆ<font color="blue">Infernal</font>è½¯ä»¶å¯ä»¥<font color="blue"><strong>é¢„æµ‹</strong>å·²æœ‰<strong>RNAå®¶æ—çš„æ–°æˆå‘˜</strong></font>ã€‚Rfam&#x2F;Infernalæ–¹æ³•åº”ç”¨å¹¿æ³›ï¼Œå¯ä»¥é¢„æµ‹å„ç§RNAå®¶æ—æˆå‘˜ï¼Œä½†<strong>ç‰¹å¼‚æ€§è¾ƒå·®</strong>ã€‚å»ºè®®ï¼šå¦‚æœæœ‰æ›´å¥½çš„ä¸“é—¨é¢„æµ‹æŸä¸€ç±»éç¼–ç RNAçš„è½¯ä»¶ï¼Œåˆ™é‡‡ç”¨è¯¥è½¯ä»¶é¢„æµ‹ï¼›å¦åˆ™ï¼Œä½¿ç”¨Rfam&#x2F;Infernalæµç¨‹ã€‚</p><p><strong>éç¼–ç RNAé¢„æµ‹çš„ç ”ç©¶å†…å®¹ï¼š</strong>åˆ©ç”¨Rfamå®¶æ—çš„åæ–¹å·®æ¨¡å‹ï¼Œé‡‡ç”¨Rfamè‡ªå¸¦çš„<font color="red"><strong>Infernalè½¯ä»¶é¢„æµ‹miRNA</strong>å’Œ<strong>snRNA</strong>åºåˆ—</font>ã€‚ç”±äºrRNAçš„ä¿å®ˆæ€§å¾ˆå¼ºï¼Œç”¨<font color="red"><strong>åºåˆ—æ¯”å¯¹</strong>å·²çŸ¥rRNAåºåˆ—è¯†åˆ«åŸºå› ç»„ä¸­çš„<strong>rRNA</strong></font>åºåˆ—ã€‚<font color="red"><strong>tRNAscan-SE</strong></font>å·¥å…·ç»¼åˆå¤šä¸ªè¯†åˆ«å’Œåˆ†æç¨‹åºï¼Œé€šè¿‡åˆ†æå¯åŠ¨å­å…ƒä»¶çš„ä¿å®ˆåºåˆ—æ¨¡å¼ã€tRNAäºŒçº§ç»“æ„çš„åˆ†æã€è½¬å½•æ§åˆ¶å…ƒä»¶åˆ†æå’Œé™¤å»ç»å¤§å¤šæ•°å‡é˜³æ€§çš„ç­›é€‰è¿‡ç¨‹ï¼Œæ®ç§°èƒ½è¯†åˆ«99%çš„çœŸtRNAåŸºå› ã€‚</p><p><strong>éç¼–ç RNAé¢„æµ‹ä¸­æ‹Ÿè§£å†³çš„å…³é”®æŠ€æœ¯éš¾ç‚¹ï¼š</strong></p><p><strong>è¯†åˆ«éç¼–ç RNAçš„å‡åŸºå› ï¼š</strong>åŸºå› ç»„ä¸­<font color="blue">å¾ˆå¤šåºåˆ—ç”±<strong>éç¼–ç RNAåŸºå› å¤åˆ¶</strong>è€Œæ¥ï¼Œä¸éç¼–ç RNAåŸºå› åºåˆ—<strong>ç›¸ä¼¼</strong>ï¼Œä½†<strong>ä¸å…·æœ‰éç¼–ç RNAçš„åŠŸèƒ½</strong></font>ã€‚ç›®å‰é‡‡ç”¨çš„éç¼–ç RNAåºåˆ—çš„é¢„æµ‹æ–¹æ³•éƒ½æ˜¯åŸºäºåºåˆ—æ¯”å¯¹å’Œç»“æ„é¢„æµ‹ï¼Œä¸èƒ½å¤Ÿå¾ˆå¥½çš„å»é™¤è¿™ç±»éç¼–ç RNAçš„å‡åŸºå› ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œè€ƒè™‘ç»“åˆRNAè¡¨è¾¾ä¿¡æ¯å¦‚<strong>RNA-seq</strong>æ•°æ®<strong>ç­›é€‰</strong>ã€‚</p><p><strong>éç¼–ç RNAé¢„æµ‹çš„ç ”ç©¶æ–¹å‘ï¼š</strong></p><p>1ï¼‰ï¼šä¸“é—¨æ£€æµ‹å°ç‰‡æ®µRNAåºåˆ—çš„æ–¹æ³•ç°åœ¨å·²ç»å¾—åˆ°å¹¿æ³›åº”ç”¨ï¼Œåˆ©ç”¨<strong>å°ç‰‡æ®µRNAåºåˆ—</strong>æ•°æ®è¿›è¡Œ<strong>éç¼–ç RNAçš„é¢„æµ‹</strong>æ˜¯é‡è¦ç ”ç©¶æ–¹å‘ã€‚</p><p>2ï¼‰ï¼šå¼€å‘<strong>miRNAé¶å‘åŸºå› é¢„æµ‹</strong>æµç¨‹ï¼šmiRNAé€šè¿‡è°ƒæ§å…¶é¶å‘åŸºå› çš„mRNAç¨³å®šæ€§æˆ–ç¿»è¯‘æ¥æ§åˆ¶ç”Ÿå‘½æ´»åŠ¨çš„è¿›ç¨‹ã€‚é¢„æµ‹miRNAé¶å‘åŸºå› èƒ½å¤Ÿç»™ç ”ç©¶miRNAåŠŸèƒ½å¸¦æ¥æç¤ºã€‚ç”±äºmiRNAåœ¨åŠ¨ç‰©å’Œæ¤ç‰©ä¸­å¯¹é¶å‘åŸºå› çš„è°ƒæ§æœºåˆ¶å·®åˆ«è¾ƒå¤§ï¼Œå»ºè®®<strong>å¯¹åŠ¨ç‰©å’Œæ¤ç‰©åˆ†åˆ«å»ºç«‹é¶å‘åŸºå› é¢„æµ‹æµç¨‹</strong>ï¼Œæé«˜é¢„æµ‹å‡†ç¡®åº¦ã€‚</p><h2 id="3ï¼šåŸºå› ç»“æ„é¢„æµ‹"><a href="#3ï¼šåŸºå› ç»“æ„é¢„æµ‹" class="headerlink" title="3ï¼šåŸºå› ç»“æ„é¢„æµ‹"></a>3ï¼šåŸºå› ç»“æ„é¢„æµ‹</h2><p><strong>åŸºå› ç»“æ„é¢„æµ‹çš„ç ”ç©¶èƒŒæ™¯å’Œæ„ä¹‰ï¼š</strong>é€šè¿‡åŸºå› ç»“æ„é¢„æµ‹ï¼Œèƒ½å¤Ÿè·å¾—åŸºå› ç»„è¯¦ç»†çš„<font color="blue">åŸºå› åˆ†å¸ƒå’Œç»“æ„ä¿¡æ¯</font>ï¼Œä¹Ÿå°†ä¸º<font color="blue">åŠŸèƒ½æ³¨é‡Šå’Œè¿›åŒ–åˆ†æ</font>å·¥ä½œæä¾›é‡è¦çš„åŸæ–™ã€‚åŸºå› ç»“æ„é¢„æµ‹åŒ…æ‹¬é¢„æµ‹åŸºå› ç»„ä¸­çš„<font color="red"><strong>åŸºå› ä½ç‚¹</strong>ã€<strong>å¼€æ”¾æ€§é˜…è¯»æ¡†æ¶</strong>ï¼ˆORFï¼‰ã€<strong>ç¿»è¯‘èµ·å§‹ä½ç‚¹å’Œç»ˆæ­¢ä½ç‚¹</strong>ã€<strong>å†…å«å­</strong>å’Œ<strong>å¤–æ˜¾å­</strong>ã€<strong>å¯åŠ¨å­</strong>ã€<strong>å¯å˜å‰ªåˆ‡ä½ç‚¹</strong>ä»¥åŠè›‹ç™½è´¨<strong>ç¼–ç åºåˆ—</strong></font>ç­‰ç­‰ã€‚</p><p><strong>åŸºå› ç»“æ„é¢„æµ‹çš„å‘å±•ç°çŠ¶ï¼š</strong> <font color="blue">åŸæ ¸ç”Ÿç‰©</font>åŸºå› çš„å„ç§ä¿¡å·ä½ç‚¹ï¼ˆå¦‚<font color="blue">å¯åŠ¨å­å’Œç»ˆæ­¢å­</font>ä¿¡å·ä½ç‚¹ï¼‰<font color="blue">ç‰¹å¼‚æ€§è¾ƒå¼º</font>ä¸”å®¹æ˜“è¯†åˆ«ï¼Œå› æ­¤ç›¸åº”çš„åŸºå› é¢„æµ‹æ–¹æ³•å·²åŸºæœ¬<font color="blue">æˆç†Ÿ</font>ã€‚<font color="blue">Glimmer</font>æ˜¯åº”ç”¨æœ€å¹¿æ³›çš„<font color="blue">åŸæ ¸</font>ç”Ÿç‰©åŸºå› ç»“æ„é¢„æµ‹è½¯ä»¶ï¼Œå‡†ç¡®åº¦é«˜ã€‚è€ŒçœŸæ ¸ç”Ÿç‰©çš„åŸºå› é¢„æµ‹éš¾åº¦å¤§å¤§å¢åŠ ã€‚é¦–å…ˆï¼ŒçœŸæ ¸ç”Ÿç‰©ä¸­çš„<font color="blue">å¯åŠ¨å­å’Œç»ˆæ­¢å­ç­‰ä¿¡å·ä½ç‚¹æ›´ä¸ºå¤æ‚</font>ï¼Œéš¾ä»¥è¯†åˆ«ã€‚å…¶æ¬¡ï¼ŒçœŸæ ¸ç”Ÿç‰©<font color="blue">å¹¿æ³›å­˜åœ¨å¯å˜å‰ªåˆ‡</font>ï¼Œä½¿<font color="blue">å¤–æ˜¾å­å’Œå†…å«å­å®šä½æ›´å›°éš¾</font>ã€‚å› æ­¤ï¼Œé¢„æµ‹çœŸæ ¸ç”Ÿç‰©çš„åŸºå› ç»“æ„éœ€è¦è¿ç”¨æ›´ä¸ºå¤æ‚çš„ç®—æ³•ï¼Œå¸¸ç”¨çš„æœ‰<font color="red">éšé©¬å°”ç§‘å¤«æ¨¡å‹</font>ç­‰ã€‚å¸¸ç”¨çš„è½¯ä»¶æœ‰<font color="red"><strong>Genscanã€SNAPã€GeneMarkã€Twinscan</strong></font>ç­‰ã€‚</p><p><strong>åŸºå› ç»“æ„é¢„æµ‹çš„ç ”ç©¶å†…å®¹ï¼š</strong>åŸºå› ç»“æ„é¢„æµ‹ä¸»è¦é€šè¿‡<font color="red"><strong>åºåˆ—æ¯”å¯¹ç»“åˆä»å¤´é¢„æµ‹</strong></font>ã€‚åºåˆ—æ¯”å¯¹æ–¹æ³•é‡‡ç”¨blatå’Œpasaç­‰æ¯”å¯¹æ–¹æ³•ï¼Œå°†åŸºå› ç»„åºåˆ—ä¸å¤–éƒ¨æ•°æ®è¿›è¡Œæ¯”å¯¹ï¼Œä»¥æ‰¾åˆ°å¯èƒ½çš„åŸºå› ä½ç½®ä¿¡æ¯ã€‚å¸¸ç”¨çš„æ•°æ®åŒ…æ‹¬<font color="blue"><strong>ç‰©ç§è‡ªèº«</strong>æˆ–å…¶<strong>è¿‘ç¼˜ç‰©ç§</strong>çš„<strong>è›‹ç™½è´¨åºåˆ—</strong>ã€<strong>ESTåºåˆ—</strong>ã€<strong>å…¨é•¿cDNAåºåˆ—</strong>ã€<strong>unigeneåºåˆ—</strong></font>ç­‰ã€‚æ­¤æ–¹æ³•æ•°æ®<strong>ä¾èµ–æ€§å¾ˆé«˜</strong>ï¼Œå¹¶ä¸”åœ¨é€‰æ‹©æ•°æ®çš„åŒæ—¶è¦å……åˆ†<strong>è€ƒè™‘åˆ°</strong>ç‰©ç§ä¹‹é—´çš„<strong>äº²ç¼˜å…³ç³»å’Œè¿›åŒ–è·ç¦»</strong>ã€‚åŸºå› <font color="blue">ä»å¤´é¢„æµ‹</font>æ–¹æ³•åˆ™æ˜¯é€šè¿‡æœç´¢åŸºå› ç»„ä¸­çš„é‡è¦ä¿¡å·ä½ç‚¹è¿›è¡Œçš„ã€‚å¸¸ç”¨çš„è½¯ä»¶æœ‰<font color="red"><strong>Genscanã€SNAPã€Augustusã€Glimmerã€GlimmerHMM</strong></font>ç­‰ç­‰ã€‚åŒæ—¶é‡‡ç”¨<font color="blue"><strong>å¤šç§æ–¹æ³•</strong></font>è¿›è¡ŒåŸºå› é¢„æµ‹å°†äº§ç”Ÿä¼—å¤šç»“æœï¼Œå› æ­¤æœ€åéœ€è¦å¯¹ç»“æœè¿›è¡Œ<font color="blue"><strong>æ•´åˆ</strong></font>ä»¥å¾—åˆ°åŸºå› çš„ä¸€è‡´æ€§åºåˆ—ã€‚å¸¸ç”¨è½¯ä»¶æœ‰<font color="blue"><strong>Gleanï¼ŒEVM</strong></font>ç­‰ã€‚</p><p><strong>åŸºå› ç»“æ„é¢„æµ‹ä¸­æ‹Ÿè§£å†³çš„å…³é”®æŠ€æœ¯éš¾ç‚¹ï¼š</strong></p><p>çœŸæ ¸ç”Ÿç‰©çš„åŸºå› ç»“æ„é¢„æµ‹æ–¹æ³•ä»æœ‰è¾ƒå¤§æ”¹è¿›ç©ºé—´ï¼Œä¸»è¦é¢ä¸´ä»¥ä¸‹çš„æŠ€æœ¯éš¾ç‚¹ã€‚</p><p>1ï¼‰ï¼šå¦‚ä½•åˆ©ç”¨ç°æœ‰çš„æ•°æ®å’Œç®—æ³•ï¼Œ<font color="blue">æ›´å¥½åœ°è¯†åˆ«åŸºå› çš„<strong>å¯å˜æ€§å‰ªåˆ‡ä½ç‚¹</strong></font>ã€‚</p><p>2ï¼‰ï¼šéšç€æµ‹åºå·¥ä½œçš„è¿›å±•ï¼Œè®¸å¤šç›®å‰ç ”ç©¶è¾ƒå°‘çš„ç‰©ç§ä¹Ÿå°†æä¸Šæµ‹åºæ—¥ç¨‹ã€‚å¤§å¤šåŸºå› ç»“æ„çš„ä»å¤´é¢„æµ‹ç®—æ³•éœ€è¦<font color="blue">é¢„å…ˆè®­ç»ƒé¢„æµ‹å‚æ•°</font>ã€‚<font color="blue">ç°æœ‰èµ„æºå’Œæ•°æ®ç¨€ç¼ºçš„ç‰©ç§</font>å°†å¾ˆ<font color="blue">éš¾</font>è·å¾—é¢„æµ‹å‚æ•°ã€‚</p><p>3ï¼‰ï¼šå…‹æœ<font color="blue">ç»„è£…é”™è¯¯</font>å¯¹åŸºå› ç»“æœé¢„æµ‹çš„å½±å“</p><p>4ï¼‰ï¼šå»ºç«‹åŸºå› ç»“æ„é¢„æµ‹çš„<font color="blue">è¯„ä»·ç³»ç»Ÿ</font>ã€‚</p><p>å¯å˜æ€§å‰ªåˆ‡ä½ç‚¹çš„é¢„æµ‹è¾ƒä¸ºå›°éš¾ã€‚å¦‚ä½•<strong>ç»“åˆRNA-seqæ•°æ®</strong>è¿›è¡Œ<strong>å¯å˜å‰ªåˆ‡é¢„æµ‹</strong>å°†æ˜¯é‡è¦çš„å·¥ä½œæ–¹å‘å’Œéš¾ç‚¹ã€‚</p><p><strong>åŸºå› ç»“æ„é¢„æµ‹çš„ç ”ç©¶æ–¹å‘ï¼š</strong></p><p>1ï¼‰ï¼šåˆ©ç”¨<font color="red">RNA-seqã€ESTç­‰æ•°æ®<strong>æ ¡æ­£</strong>åŸºå› ç»“æ„é¢„æµ‹</font>ï¼Œè¯†åˆ«å¯å˜å‰ªåˆ‡ä½ç‚¹ã€‚</p><p>2ï¼‰ï¼šå¯¹äº<font color="red">ç ”ç©¶è¾ƒå°‘ç‰©ç§</font>ï¼Œå»ºè®®åˆ©ç”¨<font color="red">è¿‘ç¼˜ç‰©ç§çš„åŒæºåŸºå› æ•°æ®</font>ä»¥è®­ç»ƒåŸºå› ç»“æ„é¢„æµ‹è½¯ä»¶ã€‚</p><p>3ï¼‰ï¼šåˆ©ç”¨<font color="red">åŒæºåŸºå› ç»„ä¹‹é—´çš„å…±çº¿æ€§ä¿¡æ¯ï¼Œè¾…åŠ©åŸºå› ç»“æ„é¢„æµ‹</font>ã€‚</p><h2 id="4ï¼šåŸºå› åŠŸèƒ½æ³¨é‡Š"><a href="#4ï¼šåŸºå› åŠŸèƒ½æ³¨é‡Š" class="headerlink" title="4ï¼šåŸºå› åŠŸèƒ½æ³¨é‡Š"></a>4ï¼šåŸºå› åŠŸèƒ½æ³¨é‡Š</h2><p><strong>åŸºå› åŠŸèƒ½æ³¨é‡Šçš„ç ”ç©¶èƒŒæ™¯å’Œæ„ä¹‰ï¼š</strong>è·å¾—åŸºå› ç»“æ„ä¿¡æ¯åï¼Œå¸Œæœ›è¿›ä¸€æ­¥è·å¾—åŸºå› åŠŸèƒ½ä¿¡æ¯ã€‚åŸºå› åŠŸèƒ½æ³¨é‡Šæ–¹å‘åŒ…æ‹¬<font color="red">é¢„æµ‹åŸºå› ä¸­çš„<strong>æ¨¡åº</strong>å’Œ<strong>ç»“æ„åŸŸ</strong>ã€<strong>è›‹ç™½è´¨çš„åŠŸèƒ½</strong>å’Œæ‰€åœ¨<strong>ç”Ÿç‰©å­¦é€šè·¯</strong>ç­‰</font>ã€‚</p><p><strong>åŸºå› åŠŸèƒ½æ³¨é‡Šçš„å‘å±•ç°çŠ¶ï¼š</strong>å…¨åŸºå› ç»„æµ‹åºå°†äº§ç”Ÿå¤§é‡æ•°æ®ï¼Œè€Œå®éªŒæ–¹æ³•ç”±äºæˆæœ¬è¾ƒé«˜ï¼Œä¸é€‚ç”¨äºå…¨åŸºå› ç»„æµ‹åºçš„åç»­åŠŸèƒ½åˆ†æã€‚ç›®å‰æ™®éé‡‡ç”¨<font color="red"><strong>æ¯”å¯¹æ–¹æ³•</strong></font>å¯¹å…¨åŸºå› ç»„æµ‹åºçš„åŸºå› åŠŸèƒ½è¿›è¡Œæ³¨é‡Šã€‚<strong>KEGGå’ŒGene Ontology</strong>æ˜¯ç›®å‰ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„è›‹ç™½è´¨<strong>åŠŸèƒ½æ•°æ®åº“</strong>ï¼Œåˆ†åˆ«å¯¹è›‹ç™½è´¨çš„ç”Ÿç‰©å­¦é€šè·¯å’ŒåŠŸèƒ½è¿›è¡Œæ³¨é‡Šã€‚<font color="blue"><strong>Interpro</strong></font>é€šè¿‡<font color="blue">æ•´åˆå¤šä¸ªè®°å½•è›‹ç™½è´¨ç‰¹å¾çš„æ•°æ®åº“</font>ï¼Œæ ¹æ®è›‹ç™½è´¨<font color="blue">åºåˆ—æˆ–ç»“æ„ä¸­çš„ç‰¹å¾</font>å¯¹<font color="blue">è›‹ç™½è´¨åˆ†ç±»</font>ã€‚</p><p><strong>åŸºå› åŠŸèƒ½æ³¨é‡Šçš„ç ”ç©¶å†…å®¹ï¼š</strong>ç›®å‰åˆ©ç”¨å››ä¸ªå¸¸ç”¨çš„æ•°æ®åº“è¿›è¡ŒåŸºå› åŠŸèƒ½æ³¨é‡Šã€‚ä½¿ç”¨çš„æ•°æ®åº“æœ‰<font color="red"><strong>Uniprotè›‹ç™½è´¨åºåˆ—æ•°æ®åº“</strong>ã€<strong>KEGGç”Ÿç‰©å­¦é€šè·¯æ•°æ®åº“</strong>ã€<strong>Interproè›‹ç™½è´¨å®¶æ—æ•°æ®åº“</strong>å’Œ<strong>Gene OntologyåŸºå› åŠŸèƒ½æ³¨é‡Šæ•°æ®åº“</strong></font>ã€‚</p><p>1ï¼‰ï¼šä¸Uniprotè›‹ç™½è´¨åºåˆ—æ•°æ®åº“æ¯”å¯¹ï¼Œè·å¾—<font color="blue">åºåˆ—åˆæ­¥ä¿¡æ¯</font>ã€‚</p><p>2ï¼‰ï¼šä¸KEGGæ•°æ®åº“æ¯”å¯¹ï¼Œé¢„æµ‹è›‹ç™½è´¨å¯èƒ½å…·æœ‰çš„<font color="blue">ç”Ÿç‰©å­¦<strong>é€šè·¯</strong>ä¿¡æ¯</font>ã€‚</p><p>3ï¼‰ï¼šä¸Interproæ•°æ®åº“æ¯”å¯¹å°†è·å¾—è›‹ç™½è´¨çš„<font color="blue"><strong>ä¿å®ˆæ€§åºåˆ—ï¼Œæ¨¡åºå’Œç»“æ„åŸŸ</strong></font>ç­‰ã€‚</p><p>4ï¼‰ï¼šé¢„æµ‹è›‹ç™½è´¨çš„åŠŸèƒ½ã€‚Interproè¿›ä¸€æ­¥å»ºç«‹äº†ä¸Gene Ontologyçš„äº¤äº’ç³»ç»Ÿï¼š<font color="blue">Interpro2GO</font>ã€‚è¯¥ç³»ç»Ÿè®°å½•äº†æ¯ä¸ªè›‹ç™½è´¨å®¶æ—ä¸Gene Ontologyä¸­çš„åŠŸèƒ½èŠ‚ç‚¹çš„å¯¹åº”å…³ç³»ï¼Œé€šè¿‡æ­¤ç³»ç»Ÿä¾¿èƒ½é¢„æµ‹è›‹ç™½è´¨æ‰§è¡Œçš„ç”Ÿç‰©å­¦åŠŸèƒ½ã€‚</p><p><strong>åŸºå› åŠŸèƒ½æ³¨é‡Šä¸­æ‹Ÿè§£å†³çš„å…³é”®æŠ€æœ¯éš¾ç‚¹</strong>ï¼š</p><p>ç›®å‰åŠŸèƒ½æ³¨é‡Šå·¥ä½œæ˜¯å»ºç«‹åœ¨æ¯”å¯¹åŸºç¡€ä¸Šï¼Œè¿™å°†ä¼šå¸¦æ¥ä¸¤ä¸ªæ¯”è¾ƒå¤§çš„é—®é¢˜ã€‚é¦–å…ˆæ­¤æ–¹æ³•<strong>ä¸¥é‡ä¾èµ–äºå¤–éƒ¨æ•°æ®</strong>ï¼Œå¯¹æŸäº›<strong>ç ”ç©¶è¾ƒå°‘çš„ç‰©ç§é™åˆ¶å¾ˆå¤§</strong>ã€‚å…¶æ¬¡ï¼Œ<strong>åºåˆ—ç›¸ä¼¼å¹¶ä¸è¡¨ç¤ºå®é™…ç”Ÿç‰©å­¦åŠŸèƒ½ç›¸ä¼¼</strong>ï¼Œè€ƒè™‘å¼•å…¥åºåˆ—<strong>æ¯”å¯¹ä¹‹å¤–çš„æ–¹æ³•</strong>ï¼Œè¿›ä¸€æ­¥å®Œå–„åŸºå› åŠŸèƒ½æ³¨é‡Šå·¥ä½œã€‚</p><p>åŸºå› åŠŸèƒ½æ³¨é‡Šçš„ç ”ç©¶æ–¹å‘ï¼šè€ƒè™‘å¼•å…¥åºåˆ—æ¯”å¯¹ä¹‹å¤–çš„æ•°æ®ï¼ˆå¦‚è›‹ç™½è´¨äº’ä½œç½‘ç»œã€åŸºå› è¡¨è¾¾è°±ç­‰ï¼‰ï¼Œåˆ©ç”¨æ¦‚ç‡æ¨¡å‹ç®—æ³•è¿›è¡Œæ•´åˆ? å®Œå–„åŸºå› åŠŸèƒ½æ³¨é‡Šå·¥ä½œã€‚</p><hr><h1 id="example"><a href="#example" class="headerlink" title="example"></a>example</h1><p><a href="https://blog.csdn.net/u012110870/article/details/82500684">https://blog.csdn.net/u012110870/article/details/82500684</a></p><p>åŸºå› ç»„ç»„è£…å®Œæˆåï¼Œæˆ–è€…æ˜¯å®Œæˆäº†è‰å›¾ï¼Œå°±ä¸å¯é¿å…é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œéœ€è¦å¯¹åŸºå› ç»„åºåˆ—è¿›è¡Œæ³¨é‡Šã€‚<strong>æ³¨é‡Šä¹‹å‰</strong>é¦–å…ˆå¾—<strong>æ„å»ºåŸºå› æ¨¡å‹</strong>ï¼Œæœ‰ä¸‰ç§ç­–ç•¥ï¼š</p><ul><li><font color="red">ä»å¤´æ³¨é‡Š(de novo prediction)</font>ï¼šé€šè¿‡å·²æœ‰çš„æ¦‚ç‡æ¨¡å‹æ¥é¢„æµ‹åŸºå› ç»“æ„ï¼Œåœ¨<font color="blue">é¢„æµ‹<strong>å‰ªåˆ‡ä½ç‚¹å’ŒUTRåŒºå‡†ç¡®æ€§è¾ƒä½</strong></font></li><li><font color="red">åŒæºé¢„æµ‹(homology-based prediction)</font>ï¼šæœ‰ä¸€äº›åŸºå› è›‹ç™½åœ¨<font color="blue">ç›¸è¿‘ç‰©ç§é—´ä¿å®ˆæ€§é«˜</font>ï¼Œå¯ä½¿ç”¨å·²æœ‰çš„<font color="blue">é«˜è´¨é‡è¿‘ç¼˜ç‰©ç§æ³¨é‡Šä¿¡æ¯</font>é€šè¿‡<font color="blue"><strong>åºåˆ—è”é…</strong></font>çš„æ–¹å¼ç¡®å®š<font color="blue"><strong>å¤–æ˜¾å­è¾¹ç•Œ</strong>å’Œ<strong>å‰ªåˆ‡ä½ç‚¹</strong></font></li><li><font color="red">åŸºäºè½¬å½•ç»„é¢„æµ‹(transcriptome-based prediction)</font>ï¼šé€šè¿‡ç‰©ç§çš„RNA-seqæ•°æ®è¾…åŠ©æ³¨é‡Šï¼Œèƒ½å¤Ÿè¾ƒä¸ºå‡†ç¡®çš„<font color="blue">ç¡®å®š<strong>å‰ªåˆ‡ä½ç‚¹</strong>å’Œ<strong>å¤–æ˜¾å­åŒºåŸŸ</strong></font>ã€‚<br>æ¯ç§æ–¹æ³•éƒ½æœ‰è‡ªå·±çš„ä¼˜ç¼ºç‚¹ï¼Œæ‰€ä»¥æœ€åéœ€è¦ç”¨<font color="blue"><strong>EvidenceModeler(EVM)<strong>å’Œ</strong>GLEAN</strong>å·¥å…·<strong>æ•´åˆ</strong></font>ï¼Œåˆå¹¶æˆå®Œæ•´çš„åŸºå› ç»“æ„ã€‚<font color="red">åŸºäº<strong>å¯é çš„åŸºå› ç»“æ„</strong>ï¼Œåç»­å¯æ‰æ˜¯<strong>åŠŸèƒ½æ³¨é‡Š</strong>ï¼Œ<strong>è›‹ç™½åŠŸèƒ½åŸŸæ³¨é‡Š</strong>ï¼Œ<strong>GOæ³¨é‡Š</strong>ï¼Œ<strong>é€šè·¯æ³¨é‡Š</strong></font>ç­‰ã€‚</li></ul><p>é‚£ä¹ˆåŸºå› æ³¨é‡Šé‡è¦å—ï¼Ÿéå¸¸é‡è¦ï¼å°¤å…¶æ˜¯é«˜é€šé‡æµ‹åºä»·æ ¼ä¸‹é™ã€‚èŠ±ä¸åˆ°ä¸€ä¸‡çš„ä»·æ ¼å¯¹600Mçš„ç‰©ç§è¿›è¡Œ100Xçš„æ™®é€šæ–‡åº“æµ‹åºï¼Œç„¶åæ‹¼æ¥å‡ºè‰å›¾ã€‚ä½†æ˜¯è¿™ä¸ªè‰å›¾çš„ä»·å€¼è¿˜éœ€è¦æ³¨é‡Šåæ‰èƒ½æ˜¾ç°ã€‚<br>ä»æ¡ˆä¾‹ä¸­å­¦ä¹ å¥—è·¯</p><p>é™†åœ°æ£‰åŸºå› ç»„æ³¨é‡Š</p><p>æ–‡ç« æ ‡é¢˜ä¸ºâ€œSequencing of allotetraploid cotton (Gossypium hirsutum L. acc. TM-1) provides a resource for fiber improvementâ€.</p><p><font color="blue">åŒæºæ³¨é‡Š</font>ï¼šä»Phytozomeä¸Šä¸‹è½½äº†7ä¸ªæ¤ç‰©çš„<font color="blue">åŸºå› ç»„è›‹ç™½åºåˆ—</font>(Arabidopsis thaliana, Carica papaya, Glycine max, G. raimondii, Populus trichocarpa, Theobroma cacao and Vitis vinifera), ä½¿ç”¨<font color="blue"> <strong>TblastN</strong></font> å°†<font color="blue">è›‹ç™½åºåˆ—æ¯”å¯¹åˆ°ç»„è£…åºåˆ—</font>ï¼ŒE-valueçš„é˜ˆå€¼ä¸º<font color="blue"><strong>1e-5</strong></font>. å°†ä¸åŒè›‹ç™½çš„BLASTçš„<font color="blue">hits</font>ç”¨ <font color="blue"><strong>Solar</strong> è½¯ä»¶åˆå¹¶</font>ã€‚<font color="blue"><strong>GeneWise</strong></font> æ ¹æ®æ¯ä¸ªBLAST hitçš„å¯¹åº”åŸºå› åŒºåŸŸé¢„æµ‹å®Œæ•´çš„åŸºå› ç»“æ„ã€‚</p><p><font color="blue">ä»å¤´é¢„æµ‹</font>ï¼š<strong>å…ˆ</strong>å¾—æ„å»º<strong>repeat-mask</strong> genomeï¼Œ åœ¨è¿™ä¸ªåŸºç¡€ä¸Šå°±ç”¨ <strong>August</strong>, Genescan, GlimmerHMM, Geneid å’Œ <strong>SNAP</strong> é¢„æµ‹ç¼–ç åŒº</p><p><font color="blue">è½¬å½•ç»„é¢„æµ‹</font>ï¼šç”¨<strong>Tophatå°†RNA-seqæ•°æ®</strong>æ¯”å¯¹åˆ°ç»„è£…åºåˆ—ä¸Šï¼Œç„¶åç”¨<strong>cufflinks</strong>ç»„è£…è½¬å½•æœ¬å½¢æˆåŸºå› æ¨¡å‹ã€‚</p><p>ç»¼ä¸Šï¼Œä½¿ç”¨ EvidenceModeler(EVM) å°†ä¸Šé¢çš„ç»“æœç»„è£…æˆéå†—ä½™çš„åŸºå› ç»“æ„ã€‚è¿›ä¸€æ­¥æ ¹æ®Cscore &gt; 0.5ï¼Œpeptide coverage &gt; 0.5 å’ŒCDS overlaping with TEè¿›è¡Œç­›é€‰ã€‚è¿˜æœ‰è¿‡æ»¤æ‰è¶…è¿‡30%ç¼–ç åŒºè¢«Pfamæˆ–Interprot TE domainçš„æ³¨é‡Šçš„åŸºå› æ¨¡å‹ã€‚</p><p>è¿™äº›åŸºå› æ¨¡å‹ä½¿ç”¨<strong>BLASTPè¿›è¡ŒåŠŸèƒ½æ³¨é‡Š</strong>ï¼Œæ‰€ç”¨æ•°æ®åº“ä¸ºSWiss-Protå’ŒTrEMBL.<font color="blue">è›‹ç™½åŠŸèƒ½</font>ä½¿ç”¨InterProScanå’ŒHMMERæ³¨é‡Šï¼Œæ•°æ®åº“ä¸ºInterProå’ŒPfamã€‚<font color="blue">GOæ³¨é‡Š</font>åˆ™æ˜¯ç›´æ¥é›‡ä½£InterProå’ŒPfamæ³¨é‡Šå¾—åˆ°çš„å¯¹åº”entryã€‚<font color="blue">é€šè·¯æ³¨é‡Š</font>ä½¿ç”¨KEGGæ•°æ®åº“ã€‚</p><p>Cardamine hirsutaåŸºå› ç»„æ³¨é‡Š</p><p>æ–‡ç« æ ‡é¢˜ä¸ºâ€œThe Cardamine hirsuta genome offers insight into the evolution of morphological diversityâ€ã€‚</p><p>åŒæºæ³¨é‡Šï¼šä½¿ç”¨ GenomeThreader ä»¥æ‹Ÿå—èŠ¥ä¸ºå‰ªåˆ‡æ¨¡å‹ï¼Œä»¥åŠPlantsGDB resourcä¸Š Brassica rapa (v1.1), A. thaliana(TAIR10), A. lyrata (v6), tomato (v3.6), poplar (v2) å’Œ A. thaliana (version PUT-169), B. napus (version PUT-172) EST assemblies çš„å®Œæ•´çš„ä»£è¡¨æ€§è›‹ç™½é›†ã€‚</p><p>è½¬å½•æœ¬é¢„æµ‹ï¼š å°† C. hirsuta RNA-seqæ•°æ®æ¯”å¯¹åˆ°åŸºå› åºåˆ—ï¼Œç„¶åç”¨cufflinksæ‹¼æ¥</p><p>ä»å¤´é¢„æµ‹ï¼šè½¬å½•æœ¬é¢„æµ‹å¾—åˆ°çš„æ½œåœ¨è›‹ç™½ç¼–ç è½¬å½•æœ¬ä½¿ç”¨ç½‘é¡µå·¥å…· ORFpredictor è¿›è¡Œé¢„æµ‹ï¼Œ åŒæ—¶ç”¨ blastx å’Œ A. thalina è¿›è¡Œæ¯”è¾ƒï¼Œé€‰æ‹©90%åºåˆ—ç›¸ä¼¼åº¦å’Œæœ€é«˜5%é•¿åº¦å·®å¼‚çš„éƒ¨åˆ†ä»è€Œä¿è¯ä¿ç•™å®Œæ•´çš„ç¼–ç æ¡†(æœ‰å¯åŠ¨å­å’Œç»ˆæ­¢å­)ã€‚ è¿™äº›åŸºå› æ¨¡å‹æ ¹æ®ç›¸äº’ä¹‹é—´çš„ç›¸ä¼¼åº¦å’Œé‡å åº¦è¿›è¡Œèšç±»ï¼Œé«˜åº¦ç›¸ä¼¼(&gt;95)ä»èšç±»ä¸­å‰”é™¤ï¼Œä¿è¯éå†—ä½™è®­ç»ƒé›†ã€‚ä¸ºäº†è®­ç»ƒgene finder, å®ƒä»¬é€‰éšæœºé€‰å–äº†2000ä¸ªä½ç‚¹ï¼Œ20%æ˜¯å•ä¸ªå¤–æ˜¾å­åŸºå› ã€‚ä»å¤´é¢„æµ‹å·¥å…·ä¸º August , GlimmerHMM, Geneid å’Œ SNAP . æ­¤å¤–è¿˜ç”¨äº†Fgenesh+, ä»¥åŒå­å¶ç‰¹å¼‚çŸ©é˜µä¸ºå‚æ•°è¿›è¡Œé¢„æµ‹ã€‚</p><p>æœ€åä½¿ç”¨JIGSAWç®—æ³•æ ¹æ®ä»¥ä¸Šç»“æœè¿›è¡Œè®­ç»ƒï¼Œéšåå†æ¬¡ç”¨JIGSAWå¯¹æ¯ä¸ªåŸºå› æ¨¡å‹è®¡ç®—ç»Ÿè®¡å­¦æƒé‡ã€‚</p><p>å¯å˜å‰ªåˆ‡æ¨¡å‹åˆ™æ˜¯åŸºäºè‹—ã€å¶ã€èŠ±å’Œæœå®çš„RNA-seqæ¯”å¯¹ç»„è£…ç»“æœã€‚</p><p>GOæ³¨é‡Šä½¿ç”¨AHRDæµç¨‹</p><p>å°ç»“</p><p>ä¸¾çš„2ä¸ªä¾‹å­éƒ½æ˜¯æ¤ç‰©ï¼Œä¸»è¦æ˜¯æ¤ç‰©åŸºå› ç»„ä¸ä»…æ˜¯ç»„è£…ï¼Œæ³¨é‡Šéƒ½æ˜¯ä¸€å¤§éš¾é¢˜ã€‚å› ä¸ºæ¤ç‰©åŸºå› ç»„æœ‰å¤§é‡çš„é‡å¤åŒºï¼Œå‡åŸºå› ï¼Œè¿˜æœ‰å¾ˆå¤šæ–°çš„è›‹ç™½ç¼–ç åŸºå› å’Œéç¼–ç åŸºå› ï¼Œæ¯”å¦‚è¯´ç‰ç±³åŸºå› ç»„80%ä»¥ä¸Šéƒ½æ˜¯é‡å¤åŒºåŸŸã€‚ç„¶åå½“æˆ‘æ£€ç´¢è¿™ä¸¤ç¯‡æ–‡ç« æ‰€ç”¨å·¥å…·çš„æ—¶å€™ï¼Œæˆ‘ä¸ç»æ„æˆ–è€…è¯´ä¸å¯é¿å…å°±é‡åˆ°äº†è¿™ä¸ªç½‘ç«™ <a href="http://www.plantgdb.org/">http://www.plantgdb.org/</a> , ä¸€ä¸ªæ•´åˆæ¤ç‰©åŸºå› ç»„å­¦å·¥å…·å’Œèµ„æºçš„ç½‘ç«™ï¼Œä½†æ˜¯è¿™ä¸ªç½‘ç«™ä¼¼ä¹2å¹´æ²¡æœ‰æ›´æ–°äº†ã€‚å½“ç„¶è¿™ä¸ªç½‘ç«™ä¹ŸæŒºä¸é”™,<a href="http://bioservices.usd.edu/gsap.html">http://bioservices.usd.edu/gsap.html</a>, ä»–ç»™å‡ºäº†ä¸€å¥—å®Œæ•´çš„æ³¨é‡Šæµç¨‹ä»¥åŠæ¯ä¸€æ­¥çš„è¾“å…¥å’Œè¾“å‡ºæƒ…å†µã€‚</p><p>æ­¤å¤–ï¼Œ2017å¹´åœ¨ã€ŠBriefings in Bioinformaticsã€‹å‘è¡¨çš„â€Plant genome and transcriptome annotations: from misconceptions to simple solutionâ€ åˆ™æ˜¯ä»äº”ä¸ªè§’åº¦å¯¹æ¤ç‰©åŸºå› ç»„æ³¨é‡Šåšäº†å¾ˆå®Œæ•´çš„æ€»ç»“</p><p>æ¤ç‰©ç§‘å­¦çš„å¸¸è§æœ¬ä½“<br>åŠŸèƒ½æ³¨é‡Šçš„å¸¸ç”¨æ•°æ®åº“å’Œèµ„æº<br>å·²æ³¨é‡Šçš„æ¤ç‰©åŸºå› ç»„æ„å‘³ç€ä»€ä¹ˆ<br>ä¸€ä¸ªè‡ªåŠ¨åŒ–æ³¨é‡Šæµç¨‹<br>ä¸€ä¸ªå‚è€ƒæµç¨‹å›¾ï¼Œç”¨æ¥è¯´æ˜ä½¿ç”¨å…¬ç”¨æ•°æ®åº“æ³¨é‡Šæ¤ç‰©åŸºå› ç»„&#x2F;è½¬å½•ç»„çš„å¸¸è§„æ­¥éª¤<br><img src="/GeekFocus/2022-03-18-annotation/1.png" alt="æ³¨é‡Šæµç¨‹å›¾"></p><p><img src="/GeekFocus/img/2022-03-18-annotation/1.png" alt="æ³¨é‡Šæµç¨‹å›¾"></p><p>åŸºå› ç»„æ³¨é‡Š</p><p>å½“æˆ‘ä»¬è°ˆåˆ°åŸºå› æ³¨é‡Šçš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸è®¤ä¸ºæ³¨é‡Šæ˜¯æŒ‡â€œå¯¹åŸºå› åŠŸèƒ½çš„æè¿°â€ï¼Œæ¯”å¦‚è¯´AåŸºå› åœ¨ç»†èƒçš„é‚£ä¸ªéƒ¨åˆ†ï¼Œé€šè¿‡æ‹›å‹ŸBæ¥è°ƒæ§Cï¼Œä»è€Œå¼•èµ·ç—…å˜ã€‚ä½†æ˜¯åŸºå› ç»“æ„ä¹Ÿæ˜¯æ³¨é‡Šçš„ä¸€ç§å½¢å¼ï¼Œè€Œä¸”æ˜¯å…ˆå†³æ¡ä»¶ï¼Œä¹Ÿå°±æ˜¯åœ¨çœ‹ä¼¼éšæœºçš„ATCGçš„ç¢±åŸºæ’åˆ—ä¸­æ‰¾åˆ°ç‰¹æ®Šçš„éƒ¨åˆ†ï¼Œè€Œè¿™äº›ç‰¹æ®Šçš„åŒºåŸŸæœ‰ç€ä¸ä¸€æ ·çš„åŠŸèƒ½ã€‚<br><img src="/GeekFocus/2022-03-18-annotation/2.png" alt="gene structure"></p><p><img src="/GeekFocus/img/2022-03-18-annotation/2.png" alt="gene structure"></p><p>åœ¨<font color="blue">æ­£å¼å¯åŠ¨åŸºå› ç»„æ³¨é‡Š</font>é¡¹ç›®ä¹‹å‰ï¼Œéœ€è¦å…ˆæ£€æŸ¥ç»„è£…æ˜¯å¦åˆæ ¼ï¼Œæ¯”å¦‚contig N50çš„é•¿åº¦æ˜¯å¦å¤§äºåŸºå› çš„å¹³å‡é•¿åº¦ï¼Œä½¿ç”¨BUSCO&#x2F;CEGMAæ£€æŸ¥åŸºå› çš„å®Œæ•´æ€§ï¼Œå¦‚æœä¸æ»¡è¶³è¦æ±‚ï¼Œå¯èƒ½è¾“å‡ºç»“æœä¸­å¤§éƒ¨åˆ†çš„contigä¸­éƒ½ä¸å­˜åœ¨ä¸€ä¸ªå®Œæ•´çš„åŸºå› ç»“æ„ã€‚å½“ç»„è£…å¾—åˆ°çš„contigç¬¦åˆè¦æ±‚æ—¶ï¼Œå°±å¯ä»¥å¼€å§‹åŸºå› ç»„æ³¨é‡Šç¯èŠ‚ï¼Œè¿™ä¸€æ­¥åˆ†ä¸ºä¸‰æ­¥ï¼š<font color="blue"><strong>åŸºå› ç»“æ„é¢„æµ‹</strong>ï¼ŒåŸºå› <strong>åŠŸèƒ½æ³¨é‡Š</strong>ï¼Œ<strong>å¯è§†åŒ–</strong>å’Œ<strong>è´¨æ§</strong></font>ã€‚<br>åŸºå› ç»„ç»“æ„æ³¨é‡Š</p><p>åŸºå› ç»“æ„æ³¨é‡Šåº”æ˜¯åŠŸèƒ½æ³¨é‡Šçš„å…ˆå†³æ¡ä»¶ï¼Œå®Œæ•´çš„çœŸæ ¸ç”Ÿç‰©åŸºå› ç»„æ³¨é‡Šæµç¨‹éœ€è¦å¦‚ä¸‹æ­¥éª¤ï¼š</p><ul><li><p>å¿…è¦çš„åŸºå› ç»„<font color="blue">é‡å¤åºåˆ—å±è”½</font></p></li><li><p><font color="blue">ä»å¤´å¯»æ‰¾åŸºå› </font>, å¯ç”¨å·¥å…·ä¸º: GeneMarkHMM, FGENESH, Augustus, SNAP, GlimmerHMM, Genscan</p></li><li><p><font color="blue">åŒæºè›‹ç™½é¢„æµ‹, å†…å«å­åˆ†æ</font>: GeneWIse, Exonerate, GenomeThreader</p></li><li><p>å°†ESTåºåˆ—ï¼Œå…¨é•¿cDNAåºåˆ—å’ŒTrinity&#x2F;Cufflinks&#x2F;Stringtieç»„è£…çš„è½¬å½•ç»„å’ŒåŸºå› ç»„<font color="blue">è”é…</font></p></li><li><p>å¦‚æœç¬¬4æ­¥ç”¨åˆ°äº†å¤šä¸ªæ•°æ®æ¥æºï¼Œä½¿ç”¨<font color="blue">PASAåŸºäºé‡å æƒ…å†µè¿›è¡Œè”é…</font></p></li><li><p>ä½¿ç”¨<font color="blue">EvidenceModler</font>æ ¹æ®ä¸Šè¿°ç»“æœè¿›è¡Œæ•´åˆ</p></li><li><p>ä½¿ç”¨PASAæ›´æ–°EVMçš„ä¸€è‡´æ€§é¢„æµ‹ï¼Œå¢åŠ UTRæ³¨é‡Šå’Œå¯å˜å‰ªåˆ‡æ³¨é‡Š</p></li><li><p>å¿…è¦çš„äººå·¥æ£€æŸ¥</p><p>åŸºæœ¬ä¸Šæ˜¯å¥—è·¯åŒ–çš„åˆ†ææµç¨‹ï¼Œä¹Ÿå°±æœ‰ä¸€äº›å·¥å…·é€šè¿‡æ•´åˆå‡ æ­¥å¼€å‘äº†æµç¨‹ç®¡ç†å·¥å…·ï¼Œæ¯”å¦‚è¯´<font color="blue">BRAKERç»“åˆGeneMarkå’ŒAugustus</font>ï¼Œ<font color="blue">MAKER2æ•´åˆäº†SNAP,Exonerate</font>ï¼Œè™½ç„¶BRAKERè¯´è‡ªå·±çš„æ•ˆæœæ¯”MAKER2å¥½ï¼Œä½†æ˜¯ç”¨çš„äººä¼¼ä¹ä¸å¤šï¼Œæ ¹æ®web of knowledgeç»Ÿè®¡ï¼Œä¸¤è€…çš„å¼•ç”¨ç‡åˆ†åˆ«æ˜¯44,283, å½“ç„¶BRAKERæ˜¯2016ï¼ŒMAKER2æ˜¯2011ï¼Œåè€…åœ¨æ—¶é—´ä¸Šæœ‰ä¼˜åŠ¿ã€‚</p></li></ul><p>è¿™é‡Œå‡†å¤‡å…ˆæŒ‰éƒ¨å°±ç­çš„æŒ‰ç…§æµç¨‹è¿›è¡Œæ³¨é‡Šï¼Œæ‰€ç”¨çš„æ•°æ®æ˜¯ Cardamine hirsuta , æ•°æ®ä¸‹è½½æ–¹å¼å¦‚ä¸‹</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># Cardamine hirsutatã€åŸºå› ç»„æ•°æ®ã€‘</span><br><span class="hljs-built_in">mkdir</span> chi_annotation &amp;&amp; <span class="hljs-built_in">cd</span> chi_annotation<br>wget http://chi.mpipz.mpg.de/download/sequences/chi_v1.fa<br><span class="hljs-built_in">cat</span> chi_v1.fa | <span class="hljs-built_in">tr</span> <span class="hljs-string">&#x27;atcg&#x27;</span> <span class="hljs-string">&#x27;ATCG&#x27;</span> &gt; chi_unmasked.fa<br><span class="hljs-comment"># ã€æ³¨é‡Šç»“æœã€‘</span><br>wget http://chi.mpipz.mpg.de/download/annotations/carhr38.gff<br><span class="hljs-comment"># Cardamine hirsutatã€è½¬å½•ç»„æ•°æ®ã€‘</span><br><span class="hljs-built_in">mkdir</span> rna-seq &amp;&amp; <span class="hljs-built_in">cd</span> rna-seq<br>wget -4 -q -A <span class="hljs-string">&#x27;*.fastq.gz&#x27;</span> -np -nd -r 2 http://chi.mpipz.mpg.de/download/fruit_rnaseq/cardamine_hirsuta/ &amp;<br>wget -4 -q -A <span class="hljs-string">&#x27;*.fastq.gz&#x27;</span> -np -nd -r 2 http://chi.mpipz.mpg.de/download/leaf_rnaseq/cardamine_hirsuta/ &amp;<br><br><br></code></pre></td></tr></table></figure><p>è½¯ä»¶å®‰è£…ä¸åœ¨æ­£æ–‡ä¸­å‡ºç°ï¼Œä¼šæ”¾åœ¨é™„å½•ä¸­ï¼Œé™¤äº†æŸäº›ç‰¹åˆ«å¤æ‚çš„è½¯ä»¶ã€‚</p><h2 id="01-é‡å¤åºåˆ—å±è”½RepeatMasker"><a href="#01-é‡å¤åºåˆ—å±è”½RepeatMasker" class="headerlink" title="01-é‡å¤åºåˆ—å±è”½RepeatMasker"></a><strong>01-é‡å¤åºåˆ—å±è”½RepeatMasker</strong></h2><p>é‡å¤å±è”½ï¼šçœŸæ ¸ç”Ÿç‰©çš„åŸºå› ç»„å­˜åœ¨å¤§é‡çš„é‡å¤åºåˆ—ï¼Œæ¤ç‰©åŸºå› ç»„çš„é‡å¤åºåˆ—ç”šè‡³å¯ä»¥é«˜è¾¾80%ã€‚å°½ç®¡é‡å¤åºåˆ—å¯¹ç»´æŒæŸ“è‰²ä½“çš„ç©ºé—´ç»“æ„ã€åŸºå› çš„è¡¨è¾¾è°ƒæ§ã€é—ä¼ é‡ç»„ç­‰éƒ½å…·æœ‰é‡è¦ä½œç”¨ï¼Œä½†æ˜¯å´ä¼šå¯¼è‡´BLASTçš„ç»“æœå‡ºç°å¤§é‡å‡é˜³æ€§ï¼Œå¢åŠ åŸºå› ç»“æ„çš„é¢„æµ‹çš„è®¡ç®—å‹åŠ›ç”šè‡³å½±å“æ³¨é‡Šæ­£ç¡®æ€§ã€‚åŸºå› ç»„ä¸­çš„é‡å¤æŒ‰ç…§åºåˆ—ç‰¹å¾å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š<font color="blue">ä¸²è”é‡å¤(tandem repeats)å’Œæ•£åœ¨é‡å¤(interspersed repeats)</font>.<br><img src="/GeekFocus/2022-03-18-annotation/3.png" alt="äººç±»ä¸­çš„é‡å¤åºåˆ—åˆ’åˆ†"></p><p><img src="/GeekFocus/img/2022-03-18-annotation/3.png" alt="äººç±»ä¸­çš„é‡å¤åºåˆ—åˆ’åˆ†"></p><p>é‰´å®šåŸºå› ç»„é‡å¤åŒºåŸŸçš„æ–¹æ³•æœ‰ä¸¤ç§ï¼šä¸€ç§åŸºäº<font color="blue">æ–‡åº“(library)çš„åŒæº(homology)</font>æ–¹æ³•ï¼Œè¯¥æ–‡åº“æ”¶é›†äº†<font color="blue">å…¶ä»–ç‰©ç§çš„æŸä¸€ç§é‡å¤çš„ä¸€è‡´æ€§åºåˆ—</font>ï¼Œé€šè¿‡<font color="blue">ç›¸ä¼¼æ€§é‰´å®šé‡å¤</font>ï¼›å¦ä¸€ç§æ˜¯<font color="blue">ä»å¤´é¢„æµ‹(de novo)</font>ï¼Œå°†åºåˆ—å’Œè‡ªå·±æ¯”è¾ƒæˆ–è€…æ˜¯<font color="blue">é«˜é¢‘K-mer</font>æ¥é‰´å®šé‡å¤ã€‚</p><p>ç›®å‰é‡å¤åºåˆ—æ³¨é‡Šä¸»è¦è½¯ä»¶å°±æ˜¯<font color="red"><strong>RepeatMasker</strong>å’Œ<strong>RepeatModel</strong></font>ã€‚è¿™é‡Œè¦æ³¨æ„åˆ†æçš„<strong>fastaçš„IDä¸èƒ½è¿‡é•¿</strong>ï¼Œä¸ç„¶ä¼šæŠ¥é”™ã€‚å¦‚æœåºåˆ—IDè¿‡é•¿å¯ä»¥ä½¿ç”¨bioawkè¿›è¡Œè½¬æ¢ï¼Œåç»­ç”¨åˆ°RepatModelä¸æ”¯æŒå¤šè¡Œå­˜æ”¾åºåˆ—çš„fastaæ ¼å¼ã€‚</p><p>ç›´æ¥ä½¿ç”¨<font color="blue">åŒæºæ³¨é‡Šå·¥å…·RepeatMasker</font>å¯»æ‰¾é‡å¤åºåˆ—ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">mkdir</span> 00-RepeatMask<br>~/opt/biosoft/RepeatMasker/RepeatMasker -e ncbi -species arabidopsis -pa 40 -gff -<span class="hljs-built_in">dir</span> 00-RepeatMask/ chi_unmasked.fa<br><span class="hljs-comment"># -e ncbi</span><br><span class="hljs-comment"># -species é€‰æ‹©ç‰©ç§ ç”¨~/opt/biosoft/RepeatMasker/util/queryRepeatDatabase.pl -tree äº†è§£</span><br><span class="hljs-comment"># -lib å¢åŠ é¢å¤–æ•°æ®åº“,</span><br><span class="hljs-comment"># -pa å¹¶è¡Œè®¡ç®—</span><br><span class="hljs-comment"># -gff è¾“å‡ºgffæ³¨é‡Š</span><br><span class="hljs-comment"># -dir è¾“å‡ºè·¯å¾„</span><br><span class="hljs-comment"># annotation with the library produced by RepeatModel</span><br><span class="hljs-comment">#-dir æŒ‡å®šçš„è¾“å‡ºç»“æœè·¯å¾„ï¼Œå¿…é¡»æå‰å»ºç«‹å¥½ï¼Œå¦åˆ™æ— ç»“æœ</span><br><span class="hljs-comment">#ä¸€å®šè¦é€šè¿‡ -species æŒ‡å®šç‰©ç§ï¼Œå¦åˆ™é»˜è®¤æ¯”å¯¹çš„æ˜¯äººç±»é‡å¤åºåˆ—æ•°æ®åº“</span><br><span class="hljs-comment">#å¦‚æœä½¿ç”¨æœ¬åœ°çš„å‚è€ƒåº“ï¼Œé€šè¿‡ -lib æŒ‡å®šï¼Œæ›¿ä»£ -species</span><br><span class="hljs-comment">#-sã€-qã€-qq ç­‰å‚æ•°å¯æ§åˆ¶åºåˆ—æ¯”å¯¹çš„çµæ•åº¦ï¼Œå¦‚æœä½ çš„ç›®æ ‡ç‰©ç§å’Œå‚è€ƒç‰©ç§ä¸æ˜¯å¾ˆè¿‘ï¼Œå¯èƒ½éœ€è¦æå‡çµæ•åº¦</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœä¸­ä¸»è¦å…³æ³¨å¦‚ä¸‹ä¸‰ä¸ª(å…¶ä¸­xxxè¡¨ç¤ºä¸€ç±»æ–‡ä»¶å)</p><ul><li>xxx.fa.masked, å°†é‡å¤åºåˆ—ç”¨Nä»£æ›¿</li><li>xxx.fa.out.gff, ä»¥gff2å½¢å¼å­˜æ”¾é‡å¤åºåˆ—å‡ºç°çš„ä½ç½®</li><li>xxx.fa.tbl, è¯¥æ–‡ä»¶è®°å½•ç€åˆ†ç±»ä¿¡æ¯</li></ul><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-section">cat 00-RepeatMask/chi_unmasked.fa.tbl</span><br><span class="hljs-section">==================================================</span><br>file name: chi_unmasked.fa<br>sequences:           624<br>total length:  198654690 bp  (191241357 bp excl N/X-runs)<br>GC level:         35.24 %<br><span class="hljs-section">bases masked:   35410625 bp ( 17.83 %)</span><br><span class="hljs-section">==================================================</span><br><br></code></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´è¯¥ç‰©ç§198Mä¸­æœ‰å°†<font color="blue">è¿‘18%çš„é‡å¤åºåˆ—</font>ï¼Œä½œä¸ºå‚è€ƒï¼Œæ‹Ÿå—èŠ¥125Mb 14%é‡å¤åºåˆ—, æ°´ç¨»389Mï¼Œ36%é‡å¤ï¼Œäººç±»åŸºå› ç»„æ˜¯3Gï¼Œ50%å·¦å³çš„é‡å¤åºåˆ—ã€‚</p><p>ä½¿ç”¨æœ€åçš„<font color="blue">chi_unmasked.fa.masked</font>ç”¨äº<font color="blue">ä¸‹ä¸€æ­¥çš„åŸºå› ç»“æ„é¢„æµ‹</font>ã€‚</p><h3 id="RepeatMaskerä½¿ç”¨æ³¨æ„"><a href="#RepeatMaskerä½¿ç”¨æ³¨æ„" class="headerlink" title="RepeatMaskerä½¿ç”¨æ³¨æ„"></a>RepeatMasker<a href="https://www.jianshu.com/p/ffdbedae80fa">ä½¿ç”¨æ³¨æ„</a></h3><p>é¦–å…ˆç¡®å®šæ•°æ®åº“ä¸­æ˜¯å¦æ”¶å½•äº†ç›®æ ‡ç‰©ç§<br>ï¼ˆä¸€ï¼‰Repbaseé…ç½®å¥½åï¼Œç›´æ¥é€šè¿‡å®‰è£…ç›®å½•ä¸­çš„â€œRepeatMasker&#x2F;util&#x2F;queryRepeatDatabase.plâ€ï¼Œå³å¯æŸ¥çœ‹å½“å‰åº“ä¸­å·²å­˜åœ¨çš„ç‰©ç§ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#æŸ¥çœ‹ç‰©ç§åˆ—è¡¨</span><br><span class="hljs-built_in">cd</span> RepeatMasker<br>./util/queryRepeatDatabase.pl -tree &gt; species.txt<br>less -S species.txt<br><span class="hljs-comment">#ç›®æ ‡ç‰©ç§ï¼Œè¿™é‡Œä¸º Fusarium tricinctumï¼Œæˆ‘ä»¬å¯ç›´æ¥æŸ¥çœ‹ Fusarium å±æ‰€æœ‰çš„</span><br>grep <span class="hljs-string">&#x27;Fusarium&#x27;</span> species.txt<br></code></pre></td></tr></table></figure><p>ï¼ˆäºŒï¼‰æˆ–è€…å‚çœ‹â€œRepeatMasker&#x2F;Libraries&#x2F;taxonomy.datâ€ä¸­çš„ç‰©ç§ä¿¡æ¯ï¼Œæ‰€æœ‰å·²æ”¶å½•ç‰©ç§çš„åç§°éƒ½å­˜å‚¨åœ¨è¯¥æ–‡ä»¶ä¸­ã€‚</p><p>ï¼ˆä¸‰ï¼‰è‹¥æ— æ³•åœ¨ç°æœ‰çš„Repbaseåº“ä¸­æ‰¾åˆ°åˆé€‚å‚è€ƒé›†ï¼Œé™¤äº†<strong>ä½¿ç”¨è¿‘ç¼˜ç‰©ç§ä»£æ›¿</strong>å¤–ï¼Œè¿˜å¯è€ƒè™‘åŸºäºå½“å‰çš„å…¨åŸºå› ç»„åºåˆ—ï¼Œæ‰§è¡Œ<strong>é‡å¤åºåˆ—çš„denovoé¢„æµ‹</strong>ï¼Œå¦‚<a href="https://links.jianshu.com/go?to=http://blog.sciencenet.cn/blog-3406804-1202562.html">RepeatModeler</a>ç­‰å·¥å…·ï¼Œè®­ç»ƒé‡å¤åºåˆ—é›†æ„å»º<strong>æœ¬åœ°repeat library</strong>ï¼Œè¿è¡ŒRepeatMaskeræ—¶é€šè¿‡â€œ**-lib<strong>â€å‚æ•°</strong>æŒ‡å®šæœ¬åœ°repeat library**ã€‚</p><p>æ­¤å¤–ï¼Œä¹Ÿå¹¶ä¸æ˜¯è¯´æ‰¾åˆ°å‚è€ƒç‰©ç§å°±å®Œå…¨å¯è¡Œã€‚<font color="blue">å‚è€ƒåº“ä¸­çš„ä¿¡æ¯å¯èƒ½å¹¶ä¸å…¨ï¼Œæ²¡æœ‰å°†ç›®æ ‡ç‰©ç§åŸºå› ç»„è¦†ç›–å®Œå…¨ï¼Œç”±æ­¤ä¼šå¯¼è‡´åŸºå› ç»„é‡å¤åºåˆ—<strong>è¯†åˆ«è¾ƒå°‘</strong></font>ã€‚<font color="blue"><strong>åŒæ—¶å¤šæ‰¾å‡ ä¸ªè¿‘ç¼˜ç‰©ç§</strong></font>çš„å‚è€ƒåº“ä½œæ¯”å¯¹ï¼Œæ›´æ”¹RepeatMaskerå‚æ•°æŠŠçµæ•åº¦è°ƒé«˜ï¼ˆæˆ–è€…å°†RMBlastæ›¿æ¢ä¸ºæ›´çµæ•çš„å·¥å…·ï¼‰ç­‰ï¼Œ<font color="blue"><strong>å°½å¯èƒ½æ‰¾åˆ°æ›´å¤šçš„é‡å¤åºåˆ—</strong></font>ã€‚å¦‚æœæœ€å¤§åŸå› ä»æ˜¯<font color="blue">æ•°æ®åº“æœ¬èº«ä¸å…¨</font>æ‰€è‡´ï¼Œå…¶å®æ›´æ”¹å‚æ•°ä¹‹ç±»çš„æå‡æ•ˆæœä¹Ÿç”šå¾®ã€‚æ­¤æ—¶å¯èƒ½<strong>éœ€è¦è€ƒè™‘æ‰§è¡Œé‡å¤åºåˆ—çš„denovoé¢„æµ‹</strong>ï¼Œå¦‚RepeatScoutã€<strong>RepeatModeler</strong></p><h2 id="RepeatModel"><a href="#RepeatModel" class="headerlink" title="RepeatModel"></a>RepeatModel</h2><p>æ³¨ï¼šå½“ç„¶ä¹Ÿå¯ä»¥ç”¨<font color="blue">RepeatModelè¿›è¡Œ<strong>ä»å¤´é¢„æµ‹</strong></font>ï¼Œå¾—åˆ°çš„é¢„æµ‹ç»“æœåç»­å¯ä»¥æ•´åˆåˆ°RepeatMasker</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># de novo predict</span><br>/programs/RepeatModeler/BuildDatabase -name pyu -engine ncbi pyu_contig.fasta /programs/RepeatModeler/RepeatModeler -pa 2 -engine ncbi -database pyu &gt;&amp; repeatmodeler.log<br></code></pre></td></tr></table></figure><p>è¿™ä¸€æ­¥é€Ÿåº¦<font color="blue">æå…¶æ…¢??</font>ï¼Œç”±äºç›®çš„åªæ˜¯<strong>è·å–å±è”½ååºåˆ—é™ä½åç»­ä»å¤´é¢„æµ‹çš„å‹åŠ›</strong>ï¼Œæ‰€ä»¥å¯å…ˆ<strong>ä¸åš</strong>è¿™ä¸€æ­¥ã€‚åœ¨åç»­åˆ†æé‡å¤åºåˆ—åœ¨åŸºå› ç»„è¿›åŒ–ä¸Šçš„ä½œç”¨æ—¶å¯ä»¥åšè¿™ä¸€æ­¥ã€‚</p><p>å¦‚æœä»å¤´é¢„æµ‹çš„ç»“æœä¸åŒæºé¢„æµ‹çš„ç»“æœæœ‰30%ä»¥ä¸Šçš„overlapï¼Œå¹¶ä¸”åˆ†ç±»ä¸ä¸€è‡´ï¼Œä¼šæŠŠä»å¤´é¢„æµ‹çš„ç»“æœè¿‡æ»¤æ‰ã€‚ä»å¤´é¢„æµ‹ä¸åŒæºé¢„æµ‹ç»“æœæœ‰overlapï¼Œä½†æ˜¯åˆ†ç±»ä¸€è‡´çš„ï¼Œéƒ½ä¼šä¿ç•™ã€‚ä½†æ˜¯ç»Ÿè®¡çš„æ—¶å€™ä¸ä¼šé‡å¤ç»Ÿè®¡ã€‚</p><h2 id="02-ä»å¤´-ab-initio-é¢„æµ‹åŸºå› "><a href="#02-ä»å¤´-ab-initio-é¢„æµ‹åŸºå› " class="headerlink" title="02-ä»å¤´(ab initio)é¢„æµ‹åŸºå› "></a><strong>02-ä»å¤´(ab initio)é¢„æµ‹åŸºå› </strong></h2><p>åŸºäºå·²æœ‰æ¨¡å‹æˆ–æ— ç›‘ç£è®­ç»ƒ</p><p>ç›®å‰çš„<font color="blue">ä»å¤´é¢„æµ‹è½¯ä»¶å¤§å¤šæ˜¯åŸºäºHMM(éšé©¬å°”ç§‘å¤«é“¾)å’Œè´å¶æ–¯ç†è®º</font>ï¼Œé€šè¿‡<font color="blue">å·²æœ‰ç‰©ç§æ³¨é‡Šä¿¡æ¯å¯¹è½¯ä»¶è¿›è¡Œè®­ç»ƒ</font>ï¼Œä»è®­ç»ƒç»“æœä¸­å»æ¨æ–­ä¸€æ®µåŸºå› åºåˆ—ä¸­å¯èƒ½çš„ç»“æ„ï¼Œåœ¨è¿™æ–¹é¢åšçš„æœ€å¥½çš„å·¥å…·æ˜¯<font color="red"><strong>AUGUSTUS</strong></font> å®ƒå¯ä»¥ä»…ä½¿ç”¨åºåˆ—ä¿¡æ¯è¿›è¡Œé¢„æµ‹ï¼Œä¹Ÿå¯ä»¥æ•´åˆEST, cDNA, RNA-seqæ•°æ®ä½œä¸ºå…ˆéªŒæ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚</p><h3 id="AUGUSTUS"><a href="#AUGUSTUS" class="headerlink" title="AUGUSTUS"></a>AUGUSTUS</h3><p>AUGUSTUSçš„æ— rootå®‰è£…æ¯”è¾ƒéº»çƒ¦ï¼Œæˆ‘æŠ˜è…¾äº†å¥½å‡ å¤©æœ€åå’ï¼Œä¸è¿‡è¾›äºæœ‰biocondaï¼Œ<font color="blue">conda create -n annotation augustus&#x3D;3.3</font>.</p><p>å®ƒçš„ä½¿ç”¨çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ä¸€æ®µæ‹Ÿå—èŠ¥å·²çŸ¥çš„åŸºå› åºåˆ—è®©å…¶é¢„æµ‹ï¼Œæ¯”å¦‚å‰8kåºåˆ—</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">seqkit faidx TAIR10<span class="hljs-selector-class">.fa</span> Chr1:<span class="hljs-number">1</span>-<span class="hljs-number">8000</span> &gt; test<span class="hljs-selector-class">.fa</span><br>augustus <span class="hljs-attr">--speices</span>=arabidopsis test<span class="hljs-selector-class">.fa</span> &gt; test.gff<br></code></pre></td></tr></table></figure><p>å¦‚æœä»…ä»…çœ‹ä¸¤è€…çš„CDSåŒºï¼Œç»“æœå®Œå…¨ä¸€è‡´ï¼Œç›¸å½“äºçœ‹è¿‡ä¸€éå‚è€ƒç­”æ¡ˆå»åšé¢˜ç›®ï¼Œé¢˜ç›®éƒ½åšå¯¹äº†ã€‚<font color="blue">augustus â€“species&#x3D;help</font></p><blockquote><p>æ³¨:å·²ç»è¢«è®­ç»ƒçš„ç‰©ç§ä¿¡æ¯å¯ä»¥ç”¨<code>augustus --species=help</code>æŸ¥çœ‹ã€‚</p></blockquote><p><img src="/GeekFocus/2022-03-18-annotation/4.png" alt="ç»“æœæ¯”è¾ƒ"></p><p><img src="/GeekFocus/img/2022-03-18-annotation/4.png" alt="ç»“æœæ¯”è¾ƒ"></p><p>åœ¨<strong>ä¸ä½¿ç”¨RNA-seqæ•°æ®</strong>çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åŸºäºæ‹Ÿå—èŠ¥çš„è®­ç»ƒæ¨¡å‹è¿›è¡Œé¢„æµ‹ï¼Œé‡‡ç”¨ä¸‹é¢çš„æ–¹å¼<font color="blue">å¤šæ¡æŸ“è‰²ä½“å¹¶è¡Œaugustus</font></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-built_in">mkdir</span> <span class="hljs-number">01</span>-augustsus &amp;&amp; <span class="hljs-keyword">cd</span> <span class="hljs-number">01</span>-augustsus<br><span class="hljs-keyword">ln</span> ../<span class="hljs-number">00</span>-RepeatMask/chi_unmasked.fa.masked genome.fa<br>seqkit <span class="hljs-keyword">split</span> genome.fa #ç»“æœæ–‡ä»¶åœ¨genome.fa.<span class="hljs-keyword">split</span><br><span class="hljs-keyword">find</span> genome.fa.<span class="hljs-keyword">split</span>/ -<span class="hljs-built_in">type</span> <span class="hljs-keyword">f</span> -name <span class="hljs-string">&quot;*.fa&quot;</span> | parallel -<span class="hljs-keyword">j</span> <span class="hljs-number">30</span> augustus --species=arabidopsis --gff3=<span class="hljs-keyword">on</span> &gt;&gt; temp.gff #å¹¶è¡Œå¤„ç†<br>join_aug_pred.pl &lt; temp.gff  | <span class="hljs-keyword">grep</span> -v <span class="hljs-string">&#x27;^#&#x27;</span> &gt; temp.joined.gff<br>bedtools <span class="hljs-keyword">sort</span> -i temp.joined.gff &gt; augustsus.gff<br><br></code></pre></td></tr></table></figure><h3 id="GeneMark-ES-x2F-ET"><a href="#GeneMark-ES-x2F-ET" class="headerlink" title="GeneMark-ES&#x2F;ET"></a>GeneMark-ES&#x2F;ET</h3><p>AUGUSTUSä¾èµ–äºå·²æœ‰çš„æ¨¡å‹ï¼Œè€Œ<strong>GeneMark-ES&#x2F;ET</strong>åˆ™æ˜¯å”¯ä¸€ä¸€æ¬¾æ”¯æŒ<font color="blue">æ— ç›‘ç£è®­ç»ƒæ¨¡å‹</font>ï¼Œä¹‹åå†è¯†åˆ«çœŸæ ¸åŸºå› ç»„è›‹ç™½ç¼–ç åŒºçš„å·¥å…·ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">gmes_petap<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--ES</span> <span class="hljs-attr">--sequence</span> genome<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--cores</span> <span class="hljs-number">50</span><br></code></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°çš„æ˜¯genemark.gtfï¼Œæ˜¯æ ‡å‡†çš„GTFæ ¼å¼ï¼Œå¯ä»¥ä½¿ç”¨Sequence Ontology Projectæä¾›çš„<font color="blue">gtf2gff3.pl</font>è¿›è¡Œè½¬æ¢</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">wget http:<span class="hljs-regexp">//g</span>enes.mit.edu<span class="hljs-regexp">/burgelab/mi</span>so<span class="hljs-regexp">/scripts/g</span>tf2gff3.pl<br>chmod <span class="hljs-number">755</span> gtf2gff3.pl<br>gtf2gff3.pl genemark.gtf | bedtools sort -i - &gt; genemark.gff<br><br></code></pre></td></tr></table></figure><p>ä¸åŒä»å¤´é¢„æµ‹è½¯ä»¶çš„å®é™…æ•ˆæœå¯ä»¥é€šè¿‡åœ¨<font color="red">IGVä¸­åŠ è½½æ–‡ç« <strong>æä¾›çš„gffæ–‡ä»¶</strong>å’Œ<strong>é¢„æµ‹åçš„gffæ–‡ä»¶</strong>è¿›è¡Œæ¯”è¾ƒ</font>ï¼Œä¸€èˆ¬ä¼šå­˜åœ¨å¦‚ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p><ul><li><p>åŸºå› å¤šäº†ï¼Œæˆ–è€…å°‘äº†ï¼Œä¹Ÿå°±æ˜¯å‡é˜³æ€§å’Œå‡é˜´æ€§ç°è±¡</p></li><li><p><font color="red">UTRåŒºåŸŸéš¾ä»¥é¢„æµ‹ï¼Œæ¯”è¾ƒæ­£å¸¸</font></p></li><li><p>æœªæ­£ç¡®è¯†åˆ«å¯å˜å‰ªåˆ‡ä½ç‚¹ï¼Œå¯¼è‡´å‰åå‡ ä¸ªåŸºå› è¯†åˆ«æˆä¸€ä¸ªåŸºå› </p><p>è€ƒè™‘åˆ°è½¬å½•ç»„æµ‹åºå·²ç»éå¸¸ä¾¿å®œï¼Œå¯ä»¥é€šè¿‡è¯¥ç‰©ç§çš„RNA-seqæä¾›è¦†ç›–åº¦ä¿¡æ¯è¿›è¡Œé¢„æµ‹ã€‚</p></li></ul><h3 id="Maker"><a href="#Maker" class="headerlink" title="Maker"></a>Maker</h3><p>Genome annotation with Maker</p><p><a href="https://training.galaxyproject.org/training-material/topics/genome-annotation/tutorials/annotation-with-maker/tutorial.html">https://training.galaxyproject.org/training-material/topics/genome-annotation/tutorials/annotation-with-maker/tutorial.html</a></p><h2 id="åŸºäºè½¬å½•ç»„æ•°æ®é¢„æµ‹"><a href="#åŸºäºè½¬å½•ç»„æ•°æ®é¢„æµ‹" class="headerlink" title="åŸºäºè½¬å½•ç»„æ•°æ®é¢„æµ‹"></a>åŸºäºè½¬å½•ç»„æ•°æ®é¢„æµ‹</h2><p>æ ¹æ®å·²æœ‰çš„æ¨¡å‹æˆ–è€…è‡ªè®­ç»ƒå¯ä»¥æ­£ç¡®é¢„æµ‹å¾ˆå¤§ä¸€éƒ¨åˆ†çš„åŸºå› ï¼Œä½†å¦‚æœéœ€è¦æé«˜é¢„æµ‹çš„æ­£ç¡®æ€§ï¼Œè¿˜éœ€è¦é¢å¤–çš„ä¿¡æ¯ã€‚åœ¨è¿‡å»å°±éœ€è¦æä¾›ç‰©ç§æœ¬èº«çš„cDNA, ESTï¼Œè€Œç°åœ¨æ›´å¤šçš„æ˜¯åŸºäºè½¬å½•ç»„åºåˆ—è¿›è¡Œè®­ç»ƒã€‚å°½ç®¡<font color="blue">RNA-seqæ•°æ®åœ¨åŸºå› ç»„ä¸Šçš„<strong>æ¯”å¯¹</strong>æƒ…å†µèƒ½å¤Ÿ<strong>æ¨æµ‹å†…å«å­</strong>ä½ç½®ï¼Œæ ¹æ®<strong>è¦†ç›–åº¦</strong>å¯ä»¥æ¨æµ‹å‡º<strong>å¤–æ˜¾å­å’Œéç¼–ç åŒº</strong>çš„è¾¹ç•Œ</font>ï¼Œä½†æ˜¯ä»…<font color="blue">ä»…ä¾èµ–äºRNA-seqçš„è¦†ç›–<strong>ä¸èƒ½å¯ä¿¡åœ°æ¨æµ‹å‡ºè›‹ç™½ç¼–ç åŒº</strong></font>(Hoff K.J. Stanke M. 2015).</p><p><font color="red">AUGUSTUS</font>å¯ä»¥åˆ©ç”¨è½¬å½•ç»„æ¯”å¯¹æ•°æ®ä¸­çš„<strong>ä½ç½®ä¿¡æ¯</strong>æ¥è®­ç»ƒæ¨¡å‹ï¼Œ<font color="red">GeneMark-ET</font>å¯ä»¥åˆ©ç”¨RNA-seqå¾—åˆ°çš„<strong>å†…å«å­ä½ç‚¹</strong>ä¿¡æ¯è‡ªæˆ‘è®­ç»ƒHMMå‚æ•°ï¼Œè¿›è¡ŒåŸºå› é¢„æµ‹ã€‚<font color="red"><strong>BRAKER2</strong></font>å°†ä¸¤è€…è¿›è¡Œæ•´åˆï¼Œä½¿ç”¨GeneMark-ETæ ¹æ®RNA-seqæ— ç›‘ç£è®­ç»ƒæ¨¡å‹å¯»æ‰¾åŸºå› ï¼Œç„¶åç”¨AUGUSTUSè¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œæœ€åå®ŒæˆåŸºå› é¢„æµ‹<br><img src="/GeekFocus/2022-03-18-annotation/5.png" alt="BRAKERæµç¨‹"></p><p><img src="/GeekFocus/img/2022-03-18-annotation/5.png" alt="BRAKERæµç¨‹"></p><p>é¦–å…ˆä½¿ç”¨hisat2æ ¹æ®<font color="blue"><strong>å±è”½</strong>åçš„å‚è€ƒåºåˆ—å»ºç«‹ç´¢å¼•</font>ï¼Œè¿›è¡Œ<strong>æ¯”å¯¹</strong>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># é¡¹ç›®æ ¹ç›®å½•</span><br><span class="hljs-built_in">mkdir</span> index<br>hisat2-build 01-augustus/genome.fa index/chi_masked<br><br>hisat2 -p 20 -x index/chi_masked -1 rna-seq/leaf_ox_r1_1.fastq.gz -2 rna-seq/leaf_ox_r1_2.fastq.gz | samtools <span class="hljs-built_in">sort</span> -@ 10 &gt; 02-barker/leaf_ox_r1.bam &amp;<br><br>hisat2 -p 20 -x index/chi_masked -1 rna-seq/ox_flower9_rep1_1.fastq.gz -2 rna-seq/ox_flower9_rep1_2.fastq.gz | samtools <span class="hljs-built_in">sort</span> -@ 10 &gt; 02-barker/ox_flower9.bam &amp;<br><br>hisat2 -p 20 -x index/chi_masked -1 rna-seq/ox_flower16_rep1_1.fastq.gz -2 rna-seq/ox_flower16_rep1_2.fastq.gz | samtools <span class="hljs-built_in">sort</span> -@ 10 &gt; 02-barker/ox_flower16.bam &amp;<br><br></code></pre></td></tr></table></figure><p>ç„¶åï¼Œä»¥<font color="blue"><strong>æœªå±è”½é‡å¤åºåˆ—çš„å‚è€ƒåºåˆ—</strong>å’Œ<strong>BAM</strong>æ–‡ä»¶ä½œä¸ºè¾“å…¥</font>ï¼Œè®©BRAKER2ï¼ˆå®‰è£…ä¼šç¨æ˜¾éº»çƒ¦ï¼Œå› ä¸ºä¾èµ–è®¸å¤šè½¯ä»¶ï¼‰è¿›è¡Œ<strong>é¢„æµ‹</strong>ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros">braker.pl --gff3 --cores 50 <span class="hljs-attribute">--species</span>=carhr <span class="hljs-attribute">--genome</span>=chi_unmasked.fa <span class="hljs-attribute">--bam</span>=02-barker/leaf_ox_r1.bam,02-barker/ox_flower16.bam,02-barker/ox_flower9.bam<br><span class="hljs-comment"># --gff3: è¾“å‡ºGFF3æ ¼å¼</span><br><span class="hljs-comment"># --genome: åŸºå› ç»„åºåˆ—</span><br><span class="hljs-comment"># --bam: æ¯”å¯¹åçš„BAMæ–‡ä»¶ï¼Œã€å…è®¸å¤šä¸ªã€‘</span><br><span class="hljs-comment"># --cores: å¤„ç†æ ¸å¿ƒæ•°</span><br><br></code></pre></td></tr></table></figure><p>æœ€åä¼šå¾—åˆ°å¦‚ä¸‹è¾“å‡ºæ–‡ä»¶</p><ul><li><p>hintsfile.gff: ä»RNA-seqæ¯”å¯¹ç»“æœçš„<strong>BAMæ–‡ä»¶ä¸­æå–</strong>ï¼Œå…¶ä¸­å†…å«å­ç”¨äºè®­ç»ƒGeneMark-EX, ä½¿ç”¨æ‰€æœ‰ç‰¹å¾è®­ç»ƒAUGUSTUS</p></li><li><p>GeneMark-ET&#x2F;genemark.gtf: <strong>GeneMark-EX</strong>æ ¹æ®<strong>RNA-seq</strong>æ•°æ®<strong>è®­ç»ƒåé¢„æµ‹</strong>çš„åŸºå› </p></li><li><p>augustus.hints.gff: <strong>AUGUSTUSè¾“å‡º</strong>æ–‡ä»¶</p><p>å°†augustus.hints.gff3å’Œæ–‡ç« çš„æ³¨é‡Šæ–‡ä»¶(carhr38.gtf)æ¯”è¾ƒï¼Œè§ä¸‹å›¾ï¼š<br><img src="/GeekFocus/2022-03-18-annotation/6.png" alt="ç»“æœæ¯”è¾ƒ"></p><p><img src="/GeekFocus/img/2022-03-18-annotation/6.png" alt="ç»“æœæ¯”è¾ƒ"></p></li></ul><p>å…¶å®ä¸éš¾å‘ç°ï¼Œåœ¨ä¸è€ƒè™‘UTRåŒºåŸŸæƒ…å†µä¸‹ï¼Œä¸¤è€…çš„å·®åˆ«å…¶å®æ›´å¤šè¡¨ç°æ˜¯åŸºå› æ•°ç›®ä¸Šï¼Œå…¶å®ä¹Ÿå°±æ˜¯åˆ©ç”¨è½¬å½•ç»„æ•°æ®æ¨æµ‹ç»“æ„çš„é—®é¢˜æ‰€åœ¨ï¼Œæ²¡æœ‰è¦†ç›–çš„åŒºåŸŸåˆ°åº•æ˜¯çœŸçš„æ²¡æœ‰åŸºå› ï¼Œè¿˜æ˜¯æœ‰åŸºå› ç»“æ„åªä¸è¿‡æ‰€ç”¨ç»„ç»‡æ²¡æœ‰è¡¨è¾¾ï¼Œæˆ–è€…è¯´é‚£ä¸ªåŒºåŸŸå…¶å®æ˜¯å‡åŸºå› ï¼Ÿæ­¤å¤–ï¼Œå¦‚æœåŸºå› é—´éš”åŒºåŸŸå¾ˆçŸ­ï¼Œæœ‰æ—¶å€™è¿˜ä¼šé”™è¯¯åœ°æŠŠä¸¤ä¸ªä¸åŒçš„åŸºå› é¢„æµ‹ä¸ºä¸€ä¸ªåŸºå› ã€‚å› æ­¤ï¼Œåº”è¯¥æ³¨é‡RNA-seqæ•°æ®åœ¨å‰ªåˆ‡ä½ç‚¹è¯†åˆ«å’Œå¤–æ˜¾å­è¾¹ç•Œç¡®å®šçš„ä¼˜åŠ¿ã€‚</p><h2 id="03-åŒæºé¢„æµ‹åŸºå› ç»“æ„"><a href="#03-åŒæºé¢„æµ‹åŸºå› ç»“æ„" class="headerlink" title="03-åŒæºé¢„æµ‹åŸºå› ç»“æ„"></a><strong>03-åŒæºé¢„æµ‹åŸºå› ç»“æ„</strong></h2><p>åŒæºé¢„æµ‹(homology prediction)åˆ©ç”¨è¿‘ç¼˜ç‰©ç§<strong>å·²çŸ¥åŸºå› è¿›</strong>è¡Œ<strong>åºåˆ—æ¯”å¯¹</strong>ï¼Œæ‰¾åˆ°åŒæºåºåˆ—ã€‚ç„¶ååœ¨åŒæºåºåˆ—çš„åŸºç¡€ä¸Šï¼Œæ ¹æ®åŸºå› ä¿¡å·å¦‚<strong>å‰ªåˆ‡ä¿¡å·</strong>ã€<strong>åŸºå› èµ·å§‹å’Œç»ˆæ­¢å¯†ç å­</strong>å¯¹åŸºå› ç»“æ„è¿›è¡Œé¢„æµ‹</p><p>ç›¸å¯¹äºä»å¤´é¢„æµ‹çš„â€œå¤§æµ·æé’ˆâ€ï¼ŒåŒæºé¢„æµ‹ç›¸å½“äºå…ˆç”¨ä¸€å—ç£é“åœ¨åŸºå› ç»„å¤§æµ·ä¸­ç¼©å°å¯èƒ½åŒºåŸŸï¼Œç„¶åä»å¯èƒ½åŒºåŸŸä¸­é‰´å®šåŸºå› ç»“æ„ã€‚<strong>10å¹´å‰</strong>ï¼Œå½“æ—¶RNA-seqè¿˜æ²¡æœ‰æ™®åŠ, åªæœ‰<strong>å°‘éƒ¨åˆ†ç‰©ç§</strong>æ‰æœ‰<strong>ESTåºåˆ—å’ŒcDNAåºåˆ—</strong>çš„æƒ…å†µä¸‹ï¼Œè¿™çš„ç¡®æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„ç­–ç•¥ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œç°åœ¨è¿˜éœ€è¦è¿›è¡Œè¿™ä¸€æ­¥å—ï¼Œå¦‚æœéœ€è¦æ˜¯å‡ºäºé‚£ç§è§’åº¦è€ƒè™‘å‘¢?</p><p>åœ¨åŒæºé¢„æµ‹ä¸Šï¼Œç›®å‰å¤§éƒ¨åˆ†åŸºå› ç»„æ–‡ç« éƒ½æ˜¯åŸºäº<strong>TBLASTN + GeneWise</strong>ï¼Œå› ä¸ºå¤§éƒ¨åˆ†åŸºå› ç»„æ–‡ç« éƒ½æ˜¯å›½å†…åšçš„ï¼Œè¿™äº›æ³¨é‡Šæ˜¯å…¬å¸çš„æµç¨‹ï¼Œå›½å†…å…¬å¸å¤§å¤šæ•°åˆå’ŒæŸä¸€å®¶å…¬å¸æœ‰å…³ç³»? ä¸è¿‡æœ€è¿‘çš„3010æ°´ç¨»æ³›åŸºå› ç»„ç”¨çš„æ˜¯<strong>MAKER</strong>, æ„Ÿè°¢éƒ¨åˆ†æåˆ°è¿™éƒ¨åˆ†å·¥ä½œæ˜¯ç”±M. Roa(Philippine Genome Center Core Facilities for Bioinformatics, Department of Science)åšçš„ã€‚<strong>Cardamine hirsutaæ–‡ç« </strong>ï¼ŒåŒæºæ³¨é‡Šéƒ¨åˆ†ç”¨çš„æ˜¯<strong>GenomeThreader</strong>ã€‚</p><p>GeneWiseç½‘ç«™ç›®å‰ç”±Ewan Birneyç»´æŠ¤ï¼Œä¸ç»§ç»­å¼€å‘ï¼Œå› ä¸ºGuy Slaterå¼€å‘<strong>Exonerate</strong>è§£å†³GeneWiseå­˜åœ¨çš„å¾ˆå¤šé—®é¢˜ï¼Œå¹¶ä¸”é€Ÿåº¦å¿«1000å€ã€‚è€ƒè™‘åˆ°ç›®å‰åªæœ‰GeneWiseèƒ½åˆ©ç”¨HMMæ ¹æ®è›‹ç™½æ‰¾DNAï¼Œè€Œä¸”ENSEMBLçš„æ³¨é‡Šæµç¨‹ä¹Ÿæœ‰ä¸€äº›æ ¸å¿ƒæ¨¡å—ç”¨åˆ°äº†å®ƒï¼Œæ‰€ä»¥ä½œè€…ä¾æ—§åœ¨ç¼“æ…¢çš„å¼€å‘è¿™ä¸ªå·¥å…·(è‡ª2.4.1å·²ç»10å¤šå¹´æ²¡æœ‰æ›´æ–°äº†)ï¼Œå½“ç„¶è¿™ä¸ªå·¥å…·ä¹Ÿæ˜¯éå¸¸çš„æ…¢ã€‚å°½ç®¡è¿™ä¸€æ­¥ä¸ä¼šç”¨åˆ°GeneWiseä½œä¸ºæˆ‘ä»¬çš„åŒæºæ³¨é‡Šé€‰é¡¹ï¼Œä½†æ˜¯å¯ä»¥å°è¯•ç”¨<strong>GeneWiseæ‰‹å·¥æ³¨é‡Šä¸€ä¸ªåŸºå› </strong>ï¼Œä¸»è¦æ­¥éª¤å¦‚ä¸‹</p><ul><li>ç¬¬ä¸€æ­¥ï¼šä½¿ç”¨BLASTXï¼Œæ ¹æ®DNAåºåˆ—æœç´¢è›‹ç™½è´¨åºåˆ—ï¼Œåªéœ€ç¬¬ä¸€ä¸ªæœ€ä½³æ¯”å¯¹ç»“æœ</li><li>ç¬¬äºŒæ­¥ï¼šå…ˆæ‹©æœ€ä½³æ¯”å¯¹çš„æ°¨åŸºé…¸åºåˆ—</li><li>ç¬¬ä¸‰æ­¥ï¼šå°†DNAåºåˆ—å‰åå»¶é•¿2kbï¼Œä¸æ°¨åŸºé…¸åºåˆ—ä¸€å¹¶ä¼ å…¥genewiseè¿›è¡ŒåŒæºé¢„æµ‹</li></ul><p><strong>(1)</strong> æå–å‰5Kåºåˆ—ï¼Œç„¶åé€‰æ‹©åœ¨TAIRä¸Šç”¨<strong>BLASTX</strong>è¿›è¡Œæ¯”å¯¹</p><blockquote><p>seqkit faidx chi_unmasked.fa Chr1:1-5000 &gt; chr1_5k.fa</p></blockquote><p><font color="green"><strong>æå–åºåˆ— 30ï¼Œ0000ï½40ï¼Œ0000 ï¼šseqkit faidx chi_unmasked.fa Chr1:300000-400000</strong></font></p><p><img src="/GeekFocus/2022-03-18-annotation/7.png" alt="BLASTX"></p><p><img src="/GeekFocus/img/2022-03-18-annotation/7.png" alt="BLASTX"></p><p><strong>(2)</strong> é€‰æ‹©ç¬¬ä¸€ä¸ªæ¯”å¯¹ç»“æœä¸­çš„æ°¨åŸºé…¸åºåˆ—ï¼Œå’Œå‰5kçš„DNAåºåˆ—ä¸€å¹¶ä½œä¸ºGeneWiseçš„è¾“å…¥</p><p><img src="/GeekFocus/2022-03-18-annotation/8.png" alt="GeneWise2"></p><p><img src="/GeekFocus/img/2022-03-18-annotation/8.png" alt="GeneWise2"></p><p>æœ€åçš„ç»“æœå‡ºä¹äº†æˆ‘çš„æ„æ–™</p><p><img src="/GeekFocus/2022-03-18-annotation/9.png" alt="é¢„æµ‹ç»“æœ"></p><p><img src="/GeekFocus/img/2022-03-18-annotation/9.png" alt="é¢„æµ‹ç»“æœ"></p><p>è®©æˆ‘ä»¬è·³è¿‡è¿™ä¸ªå°´å°¬çš„ç¯èŠ‚ï¼Œæ¯•ç«Ÿå¾ˆå¯èƒ½æ˜¯æˆ‘ä¸å¤ªç†Ÿç»ƒä½¿ç”¨å·¥ä½œæ‰€è‡´ã€‚è¿™é‡Œè¯´ç‚¹æˆ‘çš„çœ‹æ³•ï¼Œé™¤éä½ çœŸçš„æ²¡æœ‰è½¬å½•ç»„æ•°æ®ï¼Œå¿…é¡»è¦ç”¨åˆ°åŒæºç‰©ç§çš„è›‹ç™½è¿›è¡Œé¢„æµ‹ï¼Œæˆ–è€…ä½ æ‰‹åŠ¨å¤„ç†å‡ ä¸ªåŸºå› ï¼Œå¦åˆ™ä¸å»ºè®®ä½¿ç”¨è¿™ä¸ªå·¥å…·ï¼Œå› ä¸ºä½ å¯èƒ½è¿å®‰è£…éƒ½æä¸å®šã€‚</p><p>ç”¨<strong>GenomeThreader</strong>åŸºäºä¸Šé¢çš„<strong>DNAåºåˆ—</strong>å’Œæ°¨åŸºé…¸åºåˆ—<strong>è¿›è¡ŒåŒæºåŸºå› ç»“æ„é¢„æµ‹</strong></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">gth</span> -genomic chr1_5k.fa -protein cer.fa -intermediate -gff3out<br><span class="hljs-comment"># å…¶ä¸­cer.faå°±æ˜¯AT1G02205.2çš„æ°¨åŸºé…¸åºåˆ—</span><br></code></pre></td></tr></table></figure><p>ç»“æœä¸€è‡´ï¼Œå¹¶ä¸”ä»RNA-seqçš„è¦†ç›–æƒ…å†µä¹Ÿç¬¦åˆé¢„æœŸ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Chr1</span>gthexon<span class="hljs-number">1027</span><span class="hljs-number">1197</span>Parent=gene1Chr1    MIPS_CARH_v3.<span class="hljs-number">8</span>  exon    <span class="hljs-number">1027</span>    <span class="hljs-number">1197</span><br><span class="hljs-attribute">Chr1</span>gthexon<span class="hljs-number">1275</span><span class="hljs-number">1448</span>Parent=gene1Chr1    MIPS_CARH_v3.<span class="hljs-number">8</span>  exon    <span class="hljs-number">1275</span>    <span class="hljs-number">1448</span><br><span class="hljs-attribute">Chr1</span>gthexon<span class="hljs-number">1541</span><span class="hljs-number">1662</span>Parent=gene1Chr1    MIPS_CARH_v3.<span class="hljs-number">8</span>  exon    <span class="hljs-number">1555</span>    <span class="hljs-number">1662</span><br><span class="hljs-attribute">Chr1</span>gthexon<span class="hljs-number">1807</span><span class="hljs-number">2007</span>Parent=gene1Chr1    MIPS_CARH_v3.<span class="hljs-number">8</span>  exon    <span class="hljs-number">1807</span>    <span class="hljs-number">2007</span><br><span class="hljs-attribute">Chr1</span>gthexon<span class="hljs-number">2085</span><span class="hljs-number">2192</span>Parent=gene1Chr1    MIPS_CARH_v3.<span class="hljs-number">8</span>  exon    <span class="hljs-number">2085</span>    <span class="hljs-number">2192</span><br><span class="hljs-attribute">Chr1</span>gthexon<span class="hljs-number">2294</span><span class="hljs-number">2669</span>Parent=gene1Chr1    MIPS_CARH_v3.<span class="hljs-number">8</span>  exon    <span class="hljs-number">2294</span>    <span class="hljs-number">2669</span><br><span class="hljs-attribute">Chr1</span>gthexon<span class="hljs-number">3636</span><span class="hljs-number">3855</span>Parent=gene1Chr1    MIPS_CARH_v3.<span class="hljs-number">8</span>  exon    <span class="hljs-number">3636</span>    <span class="hljs-number">3855</span><br><span class="hljs-attribute">Chr1</span>gthexon<span class="hljs-number">3971</span><span class="hljs-number">4203</span>Parent=gene1Chr1    MIPS_CARH_v3.<span class="hljs-number">8</span>  exon    <span class="hljs-number">3971</span>    <span class="hljs-number">4203</span><br><span class="hljs-attribute">Chr1</span>gthexon<span class="hljs-number">4325</span><span class="hljs-number">4548</span>Parent=gene1Chr1    MIPS_CARH_v3.<span class="hljs-number">8</span>  exon    <span class="hljs-number">4325</span>    <span class="hljs-number">4548</span><br><span class="hljs-attribute">Chr1</span>gthexon<span class="hljs-number">4676</span><span class="hljs-number">4735</span>Parent=gene1Chr1    MIPS_CARH_v3.<span class="hljs-number">8</span>  exon    <span class="hljs-number">4676</span>    <span class="hljs-number">4735</span><br><br><br></code></pre></td></tr></table></figure><p>å…¨åŸºå› ç»„èŒƒå›´é¢„æµ‹æµç¨‹å¦‚ä¸‹ï¼š</p><p><strong>å‡†å¤‡cDNAå’Œæˆ–proteinåºåˆ—</strong>ï¼šåœ¨<a href="https://phytozome.jgi.doe.gov/p%E4%B8%8B%E8%BD%BD**%E9%9D%A0%E8%B0%B1%E7%9A%84%E7%89%A9%E7%A7%8D%E7%9A%84%E8%9B%8B%E7%99%BD%E8%B4%A8%E5%BA%8F%E5%88%97**%EF%BC%8C%E5%A6%82">https://phytozome.jgi.doe.gov/pä¸‹è½½**é è°±çš„ç‰©ç§çš„è›‹ç™½è´¨åºåˆ—**ï¼Œå¦‚</a> Arabidopsis thaliana, Oryza sativa, Brassica rapa, æŸ¥æ‰¾æ–‡çŒ®å¯»æ‰¾ç›®å‰è¯¥ç‰©ç§çš„<strong>å·²æœ‰EST&#x2F;cDNAåºåˆ—</strong>ï¼Œæˆ–è€…RNA-seqä»å¤´ç»„è£…è½¬å½•ç»„ã€‚è¿™é‡Œä»…è€ƒè™‘ç”¨åŒæºç‰©ç§çš„è›‹ç™½åºåˆ—è¿›è¡Œæ¯”å¯¹åˆ†æï¼Œè½¬å½•ç»„ä»å¤´ç»„è£…æ•°æ®ç”¨äºPASAæ•´ä½“æ¯”å¯¹åˆ°å‚è€ƒåŸºå› ç»„å’Œæ›´æ–°å·²æœ‰çš„åŸºå› ç»“æ„ã€‚</p><p>åˆ†åˆ«æµ‹è¯•ä¸‹ä¸åŒç‰©ç§çš„åŒæºæ³¨é‡Šç»“æœ</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-id">#run</span> seperately<br>gth -species arabidopsis -translationtable <span class="hljs-number">1</span> -gff3 -intermediate -protein ~/db/protein_db/Athaliana_167_TAIR10<span class="hljs-selector-class">.protein</span><span class="hljs-selector-class">.fa</span><span class="hljs-selector-class">.gz</span> -genomic chi_unmasked<span class="hljs-selector-class">.fa</span> -o <span class="hljs-number">03</span>-genomethreader/Athaliana<span class="hljs-selector-class">.gff3</span> &amp;<br>gth -species arabidopsis -translationtable <span class="hljs-number">1</span> -gff3 -intermediate -protein ~/db/protein_db/BrapaFPsc_277_v1.<span class="hljs-number">3</span><span class="hljs-selector-class">.protein</span><span class="hljs-selector-class">.fa</span><span class="hljs-selector-class">.gz</span> -genomic chi_unmasked<span class="hljs-selector-class">.fa</span> -o <span class="hljs-number">03</span>-genomethreader/Brapa<span class="hljs-selector-class">.gff3</span> &amp;<br>gth -species arabidopsis -translationtable <span class="hljs-number">1</span> -gff3 -intermediate -protein ~/db/protein_db/Osativa_323_v7.<span class="hljs-number">0</span><span class="hljs-selector-class">.protein</span><span class="hljs-selector-class">.fa</span><span class="hljs-selector-class">.gz</span> -genomic chi_unmasked<span class="hljs-selector-class">.fa</span> -o <span class="hljs-number">03</span>-genomethreader/Osativa<span class="hljs-selector-class">.gff3</span> &amp;<br><br></code></pre></td></tr></table></figure><p>åœ¨å®šæ€§è§’åº¦ä¸Šæ¥çœ‹ï¼ŒåŒæºæ³¨é‡Šçš„ç»“æœå’Œä»å¤´é¢„æµ‹çš„æ²¡å•¥å·®åˆ«, å…¶ä¸­B. rapaå’ŒA. thalianaå’ŒC. hirsutaéƒ½å±äºåå­—èŠ±ç§‘ï¼Œè€ŒO. sativaæ˜¯ç¦¾æœ¬ç§‘, æ‰€ä»¥å‰ä¸¤è€…é¢„æµ‹çš„æ•ˆæœå¥½ã€‚</p><p><img src="/GeekFocus/2022-03-18-annotation/10.png" alt="IGVå±•ç¤º"></p><p><img src="/GeekFocus/img/2022-03-18-annotation/10.png" alt="IGVå±•ç¤º"></p><p>å½“ç„¶å®é™…çš„åŒæºæ³¨é‡Šæµç¨‹ä¸­ä¸èƒ½æ˜¯å•ä¸ªç‰©ç§åˆ†åˆ«é¢„æµ‹ï¼Œåº”è¯¥æ˜¯å°†<strong>æ‰€æœ‰è›‹ç™½åºåˆ—è¿›è¡Œåˆå¹¶</strong>ï¼Œç„¶åç”¨BLASTXæ‰¾åˆ°æœ€ä¼˜çš„è”é…ï¼Œä¹‹åç”¨<strong>GenomeThreader</strong>è¿›è¡Œé¢„æµ‹ã€‚PASAæµç¨‹æåˆ°çš„UniRef90ä½œä¸ºåŒæºæ³¨é‡Šçš„æœç´¢æ•°æ®åº“å¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œç”±äºUniRefä¼˜å…ˆé€‰æ‹©å“ªäº›äººå·¥å®¡æŸ¥ã€æ³¨é‡Šè´¨é‡é«˜ã€æ¥æºäºæ¨¡å¼åŠ¨æ¤ç‰©çš„è›‹ç™½ï¼Œæ‰€ä»¥å¯é æ€§ç›¸å¯¹äºç›´æ¥ä½¿ç”¨åŒæºç‰©ä¸­å¯èƒ½æ›´é«˜ã€‚</p><blockquote><p>BLASTX + GenomeThreaderçš„ä»£ç æ¢ç´¢ä¸­</p></blockquote><h2 id="04-RNA-seqçš„ä¸¤ç§ä½¿ç”¨ç­–ç•¥"><a href="#04-RNA-seqçš„ä¸¤ç§ä½¿ç”¨ç­–ç•¥" class="headerlink" title="04-RNA-seqçš„ä¸¤ç§ä½¿ç”¨ç­–ç•¥"></a><strong>04-RNA-seqçš„ä¸¤ç§ä½¿ç”¨ç­–ç•¥</strong></h2><p>å¯¹äºRNA-seqæ•°æ®ï¼Œæœ‰ä¸¤ç§ä½¿ç”¨ç­–ç•¥ï¼Œä¸€ç§æ˜¯ä½¿ç”¨HISAT2 + StringTieå…ˆæ¯”å¯¹å†ç»„è£…, ä¸€ç§æ˜¯ä»å¤´ç»„è£…ï¼Œç„¶åä½¿ç”¨PASAå°†è½¬å½•æœ¬æ¯”å¯¹åˆ°åŸºå› ç»„ä¸Šã€‚</p><h3 id="åŸºäºHISAT2-StringTie"><a href="#åŸºäºHISAT2-StringTie" class="headerlink" title="åŸºäºHISAT2 + StringTie"></a>åŸºäºHISAT2 + StringTie</h3><p>é¦–å…ˆï¼Œä½¿ç”¨HISAT2å°†RNA-seqæ•°æ®æ¯”å¯¹åˆ°å‚è€ƒåŸºå› ç»„, è¿™ä¸€æ­¥å’Œä¹‹å‰ç›¸ä¼¼ï¼Œä½†æ˜¯è¦å¢åŠ ä¸€ä¸ªå‚æ•°â€“dtaï¼Œä½¿å¾—StingTieèƒ½æ›´å¥½çš„åˆ©ç”¨åŒç«¯ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">hisat2-build 01-augustus/genome.fa index/chi_masked<br>hisat2 --dta -p 20 -x index/chi_masked -1 rna-seq/leaf_ox_r1_1.fastq.gz -2 rna-seq/leaf_ox_r1_2.fastq.gz | samtools <span class="hljs-built_in">sort</span> -@ 10 &gt; rna-seq/leaf_ox_r1.bam &amp;<br>hisat2 --dta -p 20 -x index/chi_masked -1 rna-seq/ox_flower9_rep1_1.fastq.gz -2 rna-seq/ox_flower9_rep1_2.fastq.gz | samtools <span class="hljs-built_in">sort</span> -@ 10 &gt; rna-seq/ox_flower9.bam &amp;<br>hisat2 --dta -p 20 -x index/chi_masked -1 rna-seq/ox_flower16_rep1_1.fastq.gz -2 rna-seq/ox_flower16_rep1_2.fastq.gz | samtools <span class="hljs-built_in">sort</span> -@ 10 &gt; rna-seq/ox_flower16.bam &amp;<br>samtools merge -@ 10 rna-seq/merged.bam rna-seq/leaf_ox_r1.bam rna-seq/ox_flower9.bam rna-seq/ox_flower16.bam<br><br></code></pre></td></tr></table></figure><p>ç„¶åç”¨StringTieè¿›è¡Œè½¬å½•æœ¬é¢„æµ‹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">stringtie -p <span class="hljs-number">10</span> -o rna-seq<span class="hljs-regexp">/merged.gtf rna-seq/m</span>erged.bam<br></code></pre></td></tr></table></figure><p>å¯¹äºåç»­çš„<strong>EvidenceModeler</strong>è€Œè¨€ï¼Œå®ƒ<strong>ä¸éœ€è¦UTR</strong>ä¿¡æ¯ï¼Œ<strong>åªéœ€è¦ç¼–ç åŒºCDS</strong>ï¼Œéœ€è¦ç”¨<strong>TransDecoder</strong>è¿›è¡Œç¼–ç åŒºé¢„æµ‹</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs stylus">util/cufflinks_gtf_genome_to_cdna_fasta<span class="hljs-selector-class">.pl</span> merged<span class="hljs-selector-class">.gtf</span> input/chi_masked<span class="hljs-selector-class">.fa</span> &gt; transcripts<span class="hljs-selector-class">.fasta</span><br>util/cufflinks_gtf_to_alignment_gff3<span class="hljs-selector-class">.pl</span> merged<span class="hljs-selector-class">.gtf</span> &gt; transcripts<span class="hljs-selector-class">.gff3</span><br>TransDecoder<span class="hljs-selector-class">.LongOrfs</span> -t transcripts<span class="hljs-selector-class">.fasta</span><br>TransDecoder<span class="hljs-selector-class">.Predict</span> -t transcripts<span class="hljs-selector-class">.fasta</span><br>util/cdna_alignment_orf_to_genome_orf<span class="hljs-selector-class">.pl</span> \<br>     transcripts<span class="hljs-selector-class">.fasta</span><span class="hljs-selector-class">.transdecoder</span><span class="hljs-selector-class">.gff3</span> \<br>     transcripts<span class="hljs-selector-class">.gff3</span> \<br>     transcripts<span class="hljs-selector-class">.fasta</span> &gt; transcripts<span class="hljs-selector-class">.fasta</span><span class="hljs-selector-class">.transdecoder</span><span class="hljs-selector-class">.genome</span><span class="hljs-selector-class">.gff3</span><br><br></code></pre></td></tr></table></figure><p>æœ€åç»“æœ<code>transcripts.fasta.transdecoder.gff3</code>ç”¨äºæä¾›ç»™EvidenceModeler</p><h3 id="åŸºäºPASA"><a href="#åŸºäºPASA" class="headerlink" title="åŸºäºPASA"></a><strong>åŸºäºPASA</strong></h3><p>åœ¨å¤šå¹´ä»¥å‰ï¼Œé‚£ä¸ªåŸºå› ç»„ç»„è£…è¿˜æ²¡æœ‰ç™½èœä»·ï¼Œåªæœ‰å‡ ä¸ªæ¨¡å¼ç‰©ç§åŸºå› ç»„çš„æ—¶ä»£ï¼Œå¯¹äºä¸€ä¸ªæœªæµ‹åºçš„åŸºå› ç»„ï¼Œç ”ç©¶è€…å¦‚æœè¦ç ”ç©¶æŸä¸€ä¸ªåŸºå› çš„åŠŸèƒ½ï¼Œå¤§å¤šä¼šé€šè¿‡åŒæºç‰©ç§ç›¸ä¼¼åŸºå› è®¾è®¡PCRå¼•ç‰©ï¼Œç„¶åå»æ‰©å¢cDNA. å¦‚æœæ˜¯ä¸€ä¸ªå·²çŸ¥åŸºå› ç»„çš„ç‰©ç§ï¼Œå¦‚æœè¦å¤§è§„æ¨¡è¯†åˆ«åŸºå› , ç ”ç©¶è€…é€šå¸¸ä¼šä½¿ç”¨EST(expressed sequence tags)åºåˆ—ã€‚</p><p>ç›¸å¯¹äºåŸºäºç®—æ³•çš„ä»å¤´é¢„æµ‹ï¼ŒcDNAå’ŒESTåºåˆ—æ›´èƒ½å¤ŸçœŸå®çš„ååº”å‡ºä¸€ä¸ªåŸºå› çš„çœŸå®ç»“æ„ï¼Œå¦‚å¯å˜å‰ªåˆ‡ã€UTRå’ŒPoly-Aä½ç‚¹ã€‚PASA(Progam to Assemble Spliced Alignments)æµç¨‹æœ€æ—©ç”¨äºæ‹Ÿå—èŠ¥åŸºå› ç»„æ³¨é‡Šï¼Œæœ€åˆçš„è®¾è®¡æ˜¯é€šè¿‡å°†å…¨é•¿(full-length)cDNAå’ŒESTæ¯”å¯¹åˆ°å‚è€ƒåŸºå› ç»„ä¸Šï¼Œå»å‘ç°å’Œæ›´æ–°åŸºå› ç»„æ³¨é‡Šã€‚å…¶ä¸­FL-cDNAå’ŒESTåºåˆ—å¯¹æœ€åç»“æœçš„æƒé‡ä¸åŒã€‚</p><p>è¿™æ˜¯ä»¥å‰çš„æ•…äº‹ï¼Œç°åœ¨çš„æ•…äº‹æ˜¯äºŒä»£è½¬å½•ç»„ä»¥åŠä¸€äº›ä¸‰ä»£è½¬å½•ç»„æ•°æ®ï¼Œé‚£ä¹ˆå¦‚ä½•å¤„ç†è¿™äº›æ•°æ®å‘¢ï¼Ÿæˆ‘è®¤ä¸ºä¸‰ä»£è½¬å½•ç»„ç›¸å¯¹äºè¿‡å»çš„FL-cDNAï¼Œè€ŒäºŒä»£è½¬å½•ç»„æ•°æ®ç»è¿‡æ‹¼æ¥åå¯ä»¥çœ‹ä½œæ˜¯æ›´é•¿çš„ESTåºåˆ—ã€‚ç”±äºç›®å‰æœ€æ™®åŠçš„è¿˜æ˜¯æ™®é€šçš„mRNA-seq, ä¹Ÿå°±åªä»‹ç»è¿™éƒ¨åˆ†æµç¨‹ã€‚</p><blockquote><p>è€ƒè™‘åˆ°æˆ‘è¿˜æ²¡æœ‰ç ”ç©¶è¿‡ä¸‰ä»£çš„å…¨é•¿è½¬å½•ç»„ï¼Œåˆ†æè¿‡æ•°æ®ï¼Œè¿™é‡Œçš„æ€è€ƒææœ‰å¯èƒ½å‡ºé”™ï¼Œåç»­å¯èƒ½ä¼šä¿®æ”¹è¿™ä¸€éƒ¨åˆ†æ€è€ƒã€‚</p></blockquote><p>è½¬å½•ç»„ç»„è£…ä½¿ç”¨Trinity(condaå®‰è£…)</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">cd rna-seq<br>Trinity <span class="hljs-attr">--seqType</span> fq <span class="hljs-attr">--CPU</span> <span class="hljs-number">50</span> <span class="hljs-attr">--max_memory</span> <span class="hljs-number">64</span>G <span class="hljs-attr">--left</span> leaf_ox_r1_1<span class="hljs-selector-class">.fastq</span><span class="hljs-selector-class">.gz</span>,ox_flower16_rep1_1<span class="hljs-selector-class">.fastq</span><span class="hljs-selector-class">.gz</span>,ox_flower9_rep1_1<span class="hljs-selector-class">.fastq</span><span class="hljs-selector-class">.gz</span> <span class="hljs-attr">--right</span> leaf_ox_r1_2<span class="hljs-selector-class">.fastq</span><span class="hljs-selector-class">.gz</span>,ox_flower16_rep1_2<span class="hljs-selector-class">.fastq</span><span class="hljs-selector-class">.gz</span>,ox_flower9_rep1_2<span class="hljs-selector-class">.fastq</span><span class="hljs-selector-class">.gz</span> &amp;<br><br></code></pre></td></tr></table></figure><p>PASAæ˜¯ç”±30å¤šä¸ªå‘½ä»¤ç»„æˆçš„æµç¨‹ï¼Œç›¸å…³å‘½ä»¤ä½äº<code>PASApipeline/scripts</code>ï¼Œä¸ºäº†é€‚åº”ä¸åŒçš„åˆ†æï¼Œæœ‰äº›å‚æ•°éœ€è¦é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶æ›´æ”¹,</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros">cp ~/opt/biosoft/PASApipeline/pasa_conf/pasa.alignAssembly.Template.txt alignAssembly.config<br><span class="hljs-comment"># ä¿®æ”¹å¦‚ä¸‹å†…å®¹</span><br><span class="hljs-attribute">DATABASE</span>=database.sqlite<br>validate_alignments_in_db.dbi:<span class="hljs-attribute">--MIN_PERCENT_ALIGNED</span>=80<br>validate_alignments_in_db.dbi:<span class="hljs-attribute">--MIN_AVG_PER_ID</span>=80<br><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°å‡ è¡Œé…ç½®æ–‡ä»¶è¡¨æ˜SQLite3æ•°æ®åº“çš„åå­—ï¼Œè®¾ç½®äº†<code>scripts/validate_alignments_in_db.dbi</code>çš„å‡ ä¸ªå‚æ•°, è¡¨ç¤ºè”é…ç¨‹åº¦å’Œç›¸ä¼¼ç¨‹åº¦ã€‚åç»­ä»¥Trinityç»„è£…ç»“æœå’Œå‚è€ƒåŸºå› ç»„ä½œä¸ºè¾“å…¥ï¼Œè¿è¡Œç¨‹åºï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">~<span class="hljs-regexp">/opt/</span>biosoft<span class="hljs-regexp">/PASApipeline/</span>scripts<span class="hljs-regexp">/Launch_PASA_pipeline.pl -c alignAssembly.config -C -R -g ../</span>chi_unmasked.fa -t ..<span class="hljs-regexp">/rna-seq/</span>trinity_out_dir/Trinity.fasta --ALIGNERS blat,gmap<br><br></code></pre></td></tr></table></figure><p>æœ€åç»“æœå¦‚ä¸‹ï¼š</p><ul><li>database.sqlite.pasa_assemblies_described.txt</li><li>database.sqlite.pasa_assemblies.gff3</li><li>database.sqlite.pasa_assemblies.gtf</li><li>database.sqlite.pasa_assemblies.bed<br>å…¶ä¸­gff3æ ¼å¼ç”¨äºåç»­çš„åˆ†æ</li></ul><blockquote><p>ç›®å‰çš„ä¸€äº›æƒ³æ³•ï¼Œ å°†ä»å¤´ç»„è£…çš„è½¬å½•æœ¬æ¯”å¯¹åˆ°å‚è€ƒåŸºå› ç»„ä¸Šå¾ˆå¤§ä¾èµ–ç»„è£…ç»“æœï¼Œæ‰€ä»¥å’ŒESTåºåˆ—å’ŒcDNAç›¸æ¯”ï¼Œè´¨é‡ä¸Šè¿˜æœ‰ä¸€ç‚¹å·®è·ã€‚</p></blockquote><h2 id="05-æ•´åˆé¢„æµ‹ç»“æœ"><a href="#05-æ•´åˆé¢„æµ‹ç»“æœ" class="headerlink" title="05-æ•´åˆé¢„æµ‹ç»“æœ"></a><strong>05-æ•´åˆé¢„æµ‹ç»“æœ</strong></h2><p>ä»å¤´é¢„æµ‹ï¼ŒåŒæºæ³¨é‡Šå’Œè½¬å½•ç»„æ•´åˆéƒ½ä¼šå¾—åˆ°ä¸€ä¸ªé¢„æµ‹ç»“æœï¼Œç›¸å½“äºæ”¶é›†äº†å¤§é‡è¯æ®ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯é€šè¿‡è¿™äº›è¯æ®å®šä¹‰å‡ºæ›´åŠ å¯é çš„åŸºå› ç»“æ„ï¼Œè¿™ä¸€æ­¥å¯ä»¥é€šè¿‡äººå·¥æ’æŸ¥ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨EVidenceModeler(EVM). EVMåªæ¥å—ä¸‰ç±»è¾“å…¥æ–‡ä»¶ï¼š</p><ul><li><p>gene_prediction.gff3: æ ‡å‡†çš„GFF3æ ¼å¼ï¼Œå¿…é¡»è¦æœ‰gene, mRNA, exon, CDSè¿™äº›ç‰¹å¾ï¼Œç”¨EVidenceModeler-1.1.1&#x2F;EvmUtils&#x2F;gff3_gene_prediction_file_validator.pléªŒè¯</p></li><li><p>protein_alignments.gff3: æ ‡å‡†çš„GFF3æ ¼å¼ï¼Œç¬¬9åˆ—è¦æœ‰IDä¿¡å’Œå’Œtargetä¿¡æ¯, æ ‡æ˜æ˜¯æ¯”å¯¹ç»“æœ</p></li><li><p>transcript_alignments.gff3:æ ‡å‡†çš„GFF3æ ¼å¼ï¼Œç¬¬9åˆ—è¦æœ‰IDä¿¡å’Œå’Œtargetä¿¡æ¯ï¼Œæ ‡æ˜æ˜¯æ¯”å¯¹ç»“æœ</p><p>EVMå¯¹gene_prediction.gff3æœ‰ç‰¹æ®Šçš„è¦æ±‚ï¼Œå°±æ˜¯GFFæ–‡ä»¶éœ€è¦åæ˜ å‡ºä¸€ä¸ªåŸºå› çš„ç»“æ„ï¼Œgene-&gt;(mRNA -&gt; (exon-&gt;cds(?))(+))(+), è¡¨ç¤ºä¸€ä¸ªåŸºå› å¯ä»¥æœ‰å¤šä¸ªmRNAï¼Œå³åŸºå› çš„å¯å˜å‰ªæ¥, ä¸€ä¸ªmRNAéƒ½å¯ä»¥ç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªexon(å¤–æ˜¾å­), å¤–æ˜¾å­å¯ä»¥æ˜¯éç¿»è¯‘åŒº(UTR),ä¹Ÿå¯ä»¥æ˜¯ç¼–ç åŒº(CDS). è€ŒGlimmerHMM, SNAPç­‰</p></li></ul><p>è¿™ä¸‰ç±»æ ¹æ®äººä¸ºç»éªŒæ¥ç¡®å®šå…¶å¯ä¿¡åº¦ï¼Œä»ç›´è§‰ä¸Šå°±æ˜¯ç”¨PASAæ ¹æ®mRNAå¾—åˆ°çš„ç»“æœé«˜äºä»å¤´é¢„æµ‹ã€‚<br>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæƒé‡æ–‡ä»¶,ç¬¬ä¸€åˆ—æ˜¯æ¥æºç±»å‹(ABINITIO_PREDICTION, PROTEIN, TRANSCRIPT), ç¬¬äºŒåˆ—å¯¹åº”ç€GFF3æ–‡ä»¶çš„ç¬¬äºŒåˆ—ï¼Œç¬¬ä¸‰åˆ—åˆ™æ˜¯æƒé‡.æˆ‘è¿™é‡Œç”¨äº†<strong>ä¸‰</strong>ä¸ªæ¥æºçš„æ•°æ®ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">mkdir</span> <span class="hljs-number">05</span>-EVM &amp;&amp; cd <span class="hljs-number">05</span>-EVM<br><span class="hljs-comment">#vim weights.txt</span><br><span class="hljs-attribute">ABINITIO_PREDICTION</span>      augustus       <span class="hljs-number">4</span><br><span class="hljs-attribute">TRANSCRIPT</span>      assembler-database.sqlite      <span class="hljs-number">7</span><br><span class="hljs-attribute">OTHER_PREDICTION</span>  transdecoder  <span class="hljs-number">8</span><br><br></code></pre></td></tr></table></figure><blockquote><p>æˆ‘è§‰å¾—æ ¹æ®åŸºå› ç»„å¼•å¯¼ç»„è£…çš„ORFçš„å¯ä¿¡åº¦é«˜äºç»„è£…åæ¯”å¯¹ï¼Œæ‰€ä»¥å¾—åˆ†å’ŒPASAå·®ä¸å¤šä¸€æ ·é«˜ã€‚ä»å¤´é¢„æµ‹æƒé‡ä¸€èˆ¬éƒ½æ˜¯1ï¼Œä½†æ˜¯BRAKERå¯ä¿¡åº¦ç¨å¾®é«˜ä¸€ç‚¹ï¼Œå¯ä»¥åœ¨2~5ä¹‹é—´ã€‚</p></blockquote><p>ç¬¬äºŒæ­¥ï¼šåˆ†å‰²åŸå§‹æ•°æ®, ç”¨äºåç»­å¹¶è¡Œ. ä¸ºäº†é™ä½å†…å­˜æ¶ˆè€—ï¼Œâ€“segmentsSizeè®¾ç½®çš„å¤§å°éœ€è¦å°‘äº1Mb(è¿™é‡Œæ˜¯100k)ï¼Œ â€“overlapSizeçš„ä¸èƒ½å¤ªå°ï¼Œå¦‚æœæ•°å­¦å¥½ï¼Œå¯ç”¨è®¾ç½®æˆåŸºå› å¹³å‡é•¿åº¦åŠ ä¸Š2ä¸ªæ ‡å‡†å·®ï¼Œæ•°å­¦ä¸å¥½ï¼Œå°±è®¾ç½®æˆ10Kå§</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">cat transcripts<span class="hljs-selector-class">.fasta</span><span class="hljs-selector-class">.transdecoder</span><span class="hljs-selector-class">.genome</span><span class="hljs-selector-class">.gff3</span> ../braker/carhr/augustus<span class="hljs-selector-class">.hints</span><span class="hljs-selector-class">.gff3</span> &gt; gene_predictions<span class="hljs-selector-class">.gff3</span><br>ln ../<span class="hljs-number">04</span>-align-transcript/database<span class="hljs-selector-class">.sqlite</span><span class="hljs-selector-class">.pasa_assemblies</span><span class="hljs-selector-class">.gff3</span> transcript_alignments<span class="hljs-selector-class">.gff3</span><br>~/opt/biosoft/EVidenceModeler-<span class="hljs-number">1.1</span>.<span class="hljs-number">1</span>/EvmUtils/partition_EVM_inputs<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span> ../chi_unmasked<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--gene_predictions</span> gene_predictions<span class="hljs-selector-class">.gff3</span> <span class="hljs-attr">--transcript_alignments</span> transcript_alignments<span class="hljs-selector-class">.gff3</span> <span class="hljs-attr">--segmentSize</span> <span class="hljs-number">100000</span> <span class="hljs-attr">--overlapSize</span> <span class="hljs-number">10000</span> <span class="hljs-attr">--partition_listing</span> partitions_list<span class="hljs-selector-class">.out</span><br><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºå¹¶è¡Œè¿ç®—å‘½ä»¤å¹¶ä¸”æ‰§è¡Œ</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">~/opt/biosoft/EVidenceModeler-<span class="hljs-number">1.1</span>.<span class="hljs-number">1</span>/EvmUtils/write_EVM_commands<span class="hljs-selector-class">.pl</span> <span class="hljs-attr">--genome</span> ../chi_unmasked<span class="hljs-selector-class">.fa</span> <span class="hljs-attr">--weights</span> `pwd`/weights<span class="hljs-selector-class">.txt</span> \<br>      <span class="hljs-attr">--gene_predictions</span> gene_predictions<span class="hljs-selector-class">.gff3</span> \<br>      <span class="hljs-attr">--transcript_alignments</span> transcript_alignments<span class="hljs-selector-class">.gff3</span> \<br>      <span class="hljs-attr">--output_file_name</span> evm<span class="hljs-selector-class">.out</span>  <span class="hljs-attr">--partitions</span> partitions_list<span class="hljs-selector-class">.out</span> &gt;  commands<span class="hljs-selector-class">.list</span><br>parallel <span class="hljs-attr">--jobs</span> <span class="hljs-number">10</span> &lt; commands<span class="hljs-selector-class">.list</span><br><br></code></pre></td></tr></table></figure><p>ç¬¬å››æ­¥ï¼šåˆå¹¶å¹¶è¡Œç»“æœ</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">~<span class="hljs-regexp">/opt/</span>biosoft<span class="hljs-regexp">/EVidenceModeler-1.1.1/</span>EvmUtils/recombine_EVM_partial_outputs.pl --partitions partitions_list.out --output_file_name evm.out<br></code></pre></td></tr></table></figure><p>ç¬¬äº”æ­¥ï¼šç»“æœè½¬æ¢æˆGFF3</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gradle">~<span class="hljs-regexp">/opt/</span>biosoft<span class="hljs-regexp">/EVidenceModeler-1.1.1/</span>EvmUtils<span class="hljs-regexp">/convert_EVM_outputs_to_GFF3.pl  --partitions partitions_list.out --output evm.out  --genome ../</span>chi_unmasked.fa<br><span class="hljs-keyword">find</span> . -regex <span class="hljs-string">&quot;.*evm.out.gff3&quot;</span> -exec cat &#123;&#125; \; | bedtools <span class="hljs-keyword">sort</span> -i - &gt; EVM.all.gff<br><br></code></pre></td></tr></table></figure><p>å½“å‰æƒé‡è®¾ç½®ä¸‹ï¼ŒEVMçš„ç»“æœæ›´åŠ ä¸¥æ ¼ï¼Œéœ€è¦æŒ‰ç…§å®é™…æƒ…å†µè°ƒæ•´ï¼Œå¢åŠ å…¶ä»–è¯æ®ã€‚</p><h2 id="06-å¯é€‰æ­¥éª¤"><a href="#06-å¯é€‰æ­¥éª¤" class="headerlink" title="06-å¯é€‰æ­¥éª¤"></a><strong>06-å¯é€‰æ­¥éª¤</strong></h2><p>æ³¨é‡Šè¿‡æ»¤ï¼šå¯¹äºåˆæ­¥é¢„æµ‹å¾—åˆ°çš„åŸºå› ï¼Œè¿˜å¯ä»¥ç¨å¾®ä¼˜åŒ–ä¸€ä¸‹ï¼Œä¾‹å¦‚å‰”é™¤ç¼–ç å°‘äº50ä¸ªAAçš„é¢„æµ‹ç»“æœï¼Œå°†è½¬åº§å­å•ç‹¬æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­(è½¯ä»¶æœ‰TransposonPSI)ã€‚</p><p>è¿™é‡ŒåŸºäºgffreadå…ˆæ ¹æ®æ³¨é‡Šä¿¡æ¯æå–æ‰€æœ‰çš„CDSåºåˆ—ï¼Œè¿‡æ»¤å‡ºé•¿åº¦ä¸è¶³50AAçš„åºåˆ—ï¼ŒåŸºäºè¿™äº›åºåˆ—è¿‡æ»¤åŸæ¥çš„çš„æ³¨é‡Š</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nsis">gffread EVM.<span class="hljs-literal">all</span>.gff -g input/genome.fa -y tr_cds.fa<br>bioawk -c fastx <span class="hljs-string">&#x27;length(<span class="hljs-variable">$seq</span>) &lt; 50 &#123;print <span class="hljs-variable">$comment</span>&#125;&#x27;</span> tr_cds.fa | cut -d <span class="hljs-string">&#x27;=&#x27;</span> -f <span class="hljs-number">2</span> &gt; short_aa_gene_list.txt<br>grep -v -w -f short_aa_gene_list.txt EvM.<span class="hljs-literal">all</span>.gff &gt; filter.gff<br><span class="hljs-comment"># é•¿åº¦è®¡ç®—é”™è¯¯ï¼ŒåŸæ–‡å†™çš„æ˜¯$seq&lt;50 è®¢æ­£ä¸º length($seq)&lt;50</span><br></code></pre></td></tr></table></figure><p><strong>ä½¿ç”¨PASAæ›´æ–°EVMç»“æœ</strong>ï¼šEVMç»“æœä¸åŒ…æ‹¬UTRåŒºåŸŸå’Œå¯å˜å‰ªåˆ‡çš„æ³¨é‡Šä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨PASAè¿›è¡Œæ›´æ–°ã€‚ç„¶è€Œè¿™éƒ¨åˆ†å·²ç»æ— æ³•é€ƒé¿MySQL, æœåŠ¡å™¨ä¸Šå¹¶æ²¡æœ‰MySQLçš„æƒé™ï¼Œæˆ‘éœ€è¦å­¦ä¹ Perlè„šæœ¬è¿›è¡Œä¿®æ”¹ã€‚å› æ­¤åŸºå› ç»“æ„æ³¨é‡Šåˆ°æ­¤å…ˆæ”¾ä¸€æ”¾ã€‚</p><p><strong>07-åŸºå› ç¼–å·</strong></p><p>å¯¹æ¯ä¸ªåŸºå› å®ç°ç¼–å·ï¼Œå½¢å¦‚ABCD000010çš„æ•ˆæœï¼Œæ–¹ä¾¿åç»­åˆ†æã€‚å¦‚ä¸‹ä»£ç æ˜¯åŸºäºEVM.all.gffï¼Œä½¿ç”¨æ–¹æ³•ä¸º<code>python gffrename.py EVM_output.gff prefix &gt; renamed.gff</code>.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &lt; <span class="hljs-number">3</span>:<br>    sys.exit()<br><br>gff = <span class="hljs-built_in">open</span>(sys.argv[<span class="hljs-number">1</span>])<br>prf = sys.argv[<span class="hljs-number">2</span>]<br><br>count = <span class="hljs-number">0</span><br>mRNA  = <span class="hljs-number">0</span><br>cds   = <span class="hljs-number">0</span><br>exon  = <span class="hljs-number">0</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;##gff-version 3.2.1&quot;</span>)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> gff:<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> line.startswith(<span class="hljs-string">&quot;\n&quot;</span>):<br>        records = line.split(<span class="hljs-string">&quot;\t&quot;</span>)<br>        records[<span class="hljs-number">1</span>] = <span class="hljs-string">&quot;.&quot;</span><br>    <span class="hljs-keyword">if</span> re.search(<span class="hljs-string">r&quot;\tgene\t&quot;</span>, line):<br>        count = count + <span class="hljs-number">10</span><br>        mRNA  = <span class="hljs-number">0</span><br>        gene_id = prf + <span class="hljs-built_in">str</span>(count).zfill(<span class="hljs-number">6</span>)<br>        records[<span class="hljs-number">8</span>] = <span class="hljs-string">&quot;ID=&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(gene_id)<br>    <span class="hljs-keyword">elif</span> re.search(<span class="hljs-string">r&quot;\tmRNA\t&quot;</span>, line):<br>        cds   = <span class="hljs-number">0</span><br>        exon  = <span class="hljs-number">0</span><br>        mRNA  = mRNA + <span class="hljs-number">1</span><br>        mRNA_id    = gene_id + <span class="hljs-string">&quot;.&quot;</span> + <span class="hljs-built_in">str</span>(mRNA)<br>        records[<span class="hljs-number">8</span>] = <span class="hljs-string">&quot;ID=&#123;&#125;;Parent=&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(mRNA_id, gene_id)<br>    <span class="hljs-keyword">elif</span> re.search(<span class="hljs-string">r&quot;\texon\t&quot;</span>, line):<br>        exon     = exon + <span class="hljs-number">1</span><br>        exon_id  = mRNA_id + <span class="hljs-string">&quot;_exon_&quot;</span> + <span class="hljs-built_in">str</span>(exon)<br>        records[<span class="hljs-number">8</span>] = <span class="hljs-string">&quot;ID=&#123;&#125;;Parent=&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(exon_id, mRNA_id)<br>    <span class="hljs-keyword">elif</span> re.search(<span class="hljs-string">r&quot;\tCDS\t&quot;</span>, line):<br>        cds     = cds + <span class="hljs-number">1</span><br>        cds_id  = mRNA_id + <span class="hljs-string">&quot;_cds_&quot;</span> + <span class="hljs-built_in">str</span>(cds)<br>        records[<span class="hljs-number">8</span>] = <span class="hljs-string">&quot;ID=&#123;&#125;;Parent=&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(cds_id, mRNA_id)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">continue</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\t&quot;</span>.join(records))<br><br>gff.close()<br><br></code></pre></td></tr></table></figure><p><strong>ä¸€äº›ç»éªŒ</strong></p><p>å¦‚æœæœ‰è½¬å½•ç»„æ•°æ®ï¼Œæ²¡å¿…é¡»è¦ä½¿ç”¨å¤ªå¤šçš„ä»å¤´é¢„æµ‹å·¥å…·ï¼Œbraker2 åŠ  GlimmerHMMå¯èƒ½å°±å¤Ÿç”¨äº†, æ›´å¤šæ˜¯ä½¿ç”¨PASAå’ŒStringTieåˆ©ç”¨å¥½è½¬å½•ç»„æ•°æ®è¿›è¡Œæ³¨é‡Šã€‚</p><p>åŸºå› åŠŸèƒ½æ³¨é‡Š</p><p>åŸºå› åŠŸèƒ½çš„æ³¨é‡Šä¾èµ–äºä¸Šä¸€æ­¥çš„åŸºå› ç»“æ„é¢„æµ‹ï¼Œæ ¹æ®é¢„æµ‹ç»“æœä»åŸºå› ç»„ä¸Šæå–ç¿»è¯‘åçš„ è›‹ç™½åºåˆ— å’Œä¸»æµçš„æ•°æ®åº“è¿›è¡Œæ¯”å¯¹ï¼Œå®ŒæˆåŠŸèƒ½æ³¨é‡Šã€‚å¸¸ç”¨æ•°æ®åº“ä¸€å…±æœ‰ä»¥å‡ ç§ï¼š</p><ul><li>Nrï¼šNCBIå®˜æ–¹éå†—ä½™è›‹ç™½æ•°æ®åº“ï¼ŒåŒ…æ‹¬PDB, Swiss-Prot, PIR, PRF; å¦‚æœè¦ç”¨DNAåºåˆ—ï¼Œå°±æ˜¯ntåº“</li><li>Pfam: è›‹ç™½ç»“æ„åŸŸæ³¨é‡Šçš„åˆ†ç±»ç³»ç»Ÿ</li><li>Swiss-Prot: é«˜è´¨é‡çš„è›‹ç™½æ•°æ®åº“ï¼Œè›‹ç™½åºåˆ—å¾—åˆ°å®éªŒçš„éªŒè¯</li><li>KEGG: ä»£è°¢é€šè·¯æ³¨é‡Šæ•°æ®åº“.</li><li>GO: åŸºå› æœ¬ä½“è®ºæ³¨é‡Šæ•°æ®åº“</li></ul><p>é™¤äº†ä»¥ä¸Šå‡ ä¸ªæ¯”è¾ƒé€šç”¨çš„æ•°æ®åº“å¤–ï¼Œå…¶å®è¿˜æœ‰å¾ˆå¤šå°ä¼—æ•°æ®åº“ï¼Œåº”è¯¥æ ¹æ®è¯¾é¢˜ç ”ç©¶å’ŒèƒŒæ™¯è¿›è¡Œé€‰æ‹©ã€‚æ³¨æ„ï¼Œæ•°æ®åº“æœ¬èº«å¹¶ä¸èƒ½è¿›è¡Œæ³¨é‡Šï¼Œä½ åªæ˜¯é€šè¿‡åºåˆ—ç›¸ä¼¼æ€§è¿›è¡Œæœç´¢ï¼Œè€Œè¿”å›çš„ç»“æœä½ ç§°ä¹‹ä¸ºæ³¨é‡Šã€‚å› æ­¤æ•°æ®åº“å’Œæœç´¢å·¥å…·è¦è¿›è¡ŒåŒºåˆ†ï¼Œæ‰€ä»¥ä½ éœ€è¦å•ç‹¬ä¸‹è½½æ•°æ®åº“å’Œæœç´¢å·¥å…·ï¼Œæˆ–è€…æ˜¯åŒæ—¶ä¸‹è½½åŒ…å«æ•°æ®åº“å’Œæœç´¢å·¥å…·çš„å®‰è£…åŒ…ã€‚</p><blockquote><p>æ³¨æ„ï¼Œåç»­åˆ†æä¸­ä¸€å®šè¦ä¿è¯ä½ çš„è›‹ç™½åºåˆ—ä¸­ä¸èƒ½æœ‰ä»£è¡¨æ°¨åŸºé…¸å­—ç¬¦ä»¥å¤–çš„å­—ç¬¦ï¼Œæ¯”å¦‚è¯´æœ‰äº›è½¯ä»¶ä¼šæŠŠæœ€åä¸€ä¸ªç»ˆæ­¢å¯†ç å­ç¿»è¯‘æˆâ€.â€œæˆ–è€…â€*â€</p></blockquote><p><strong>BLASTP</strong></p><p>è¿™ä¸€éƒ¨åˆ†ç”¨åˆ°çš„æ•°æ®åº“éƒ½æ˜¯ç”¨BLASTPè¿›è¡Œæ£€ç´¢ï¼ŒåŸºæœ¬éƒ½æ˜¯å››æ­¥å‘ï¼šä¸‹è½½æ•°æ®åº“ï¼Œæ„å»ºBLASTPç´¢å¼•ï¼Œæ•°æ®åº“æ£€ç´¢ï¼Œç»“æœæ•´ç†ã€‚å…¶ä¸­ç»“æœæ•´ç†éœ€è¦æ ¹æ®BLASTPçš„è¾“å‡ºæ ¼å¼è°ƒæ•´ã€‚</p><p>Nrçš„NCBIæ”¶é›†çš„æœ€å…¨çš„è›‹ç™½åºåˆ—æ•°æ®åº“ï¼Œä½†æ˜¯æ— è®ºæ˜¯ç”¨NCBIçš„BLASTè¿˜æ˜¯ç”¨é€Ÿåº¦æ¯”è¾ƒå¿«DIAMONDå¯¹nrè¿›è¡Œæœç´¢ï¼Œå…¶å®éƒ½æ²¡æœ‰åˆ©ç”¨å¥½ç‰©ç§æœ¬èº«çš„ä¿¡æ¯ã€‚å› æ­¤åœ¨RefSeqä¸Šä¸‹è½½å¯¹åº”ç‰©ç§çš„è›‹ç™½åºåˆ—, ç”¨BLASTPè¿›è¡Œæ³¨é‡Šå³å¯ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># download</span><br>wget -<span class="hljs-number">4</span>  -nd -np -r <span class="hljs-number">1</span> -A *.faa.gz ftp:<span class="hljs-regexp">//</span>ftp.ncbi.nlm.nih.gov<span class="hljs-regexp">/refseq/</span>release<span class="hljs-regexp">/plant/</span><br>mkdir -p ~<span class="hljs-regexp">/db/</span>RefSeq<br>zcat *.gz &gt; ~<span class="hljs-regexp">/db/</span>RefSeq/plant.protein.faa<br><span class="hljs-comment"># build index</span><br>~<span class="hljs-regexp">/opt/</span>biosoft<span class="hljs-regexp">/ncbi-blast-2.7.1+/</span>bin/makeblastdb -<span class="hljs-keyword">in</span> plant.protein.faa -dbtype prot -parse_seqids -title RefSeq_plant -out plant<br><span class="hljs-comment"># search</span><br>~<span class="hljs-regexp">/opt/</span>biosoft<span class="hljs-regexp">/ncbi-blast-2.7.1+/</span>bin<span class="hljs-regexp">/blastp -query protein.fa -out RefSeq_plant_blastp.xml -db ~/</span>db<span class="hljs-regexp">/RefSeq/u</span>niprot_sprot.fasta -evalue <span class="hljs-number">1</span>e-<span class="hljs-number">5</span> -outfmt <span class="hljs-number">5</span> -num_threads <span class="hljs-number">50</span> &amp;<br><br></code></pre></td></tr></table></figure><p><a href="http://www.uniprot.org/downloads">Swiss-Prot</a>é‡Œæ”¶é›†äº†ç›®å‰å¯ä¿¡åº¦æœ€é«˜çš„è›‹ç™½åºåˆ—ï¼Œä¸€å…±æœ‰55wæ¡è®°å½•ï¼Œæ•°æ®é‡æ¯”è¾ƒå°ï¼Œ</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># download</span><br>wget -<span class="hljs-number">4</span> -q ftp:<span class="hljs-regexp">//</span>ftp.uniprot.org<span class="hljs-regexp">/pub/</span>databases<span class="hljs-regexp">/uniprot/</span>current_release<span class="hljs-regexp">/knowledgebase/</span>complete/uniprot_sprot.fasta.gz<br>gzip -d uniprot_sprot.fasta.gz<br><span class="hljs-comment"># builid index</span><br>~<span class="hljs-regexp">/opt/</span>biosoft<span class="hljs-regexp">/ncbi-blast-2.7.1+/</span>bin/makeblastdb -<span class="hljs-keyword">in</span> uniprot_sprot.fasta -dbtype prot -title swiss_prot -parse_seqids<br><span class="hljs-comment"># search</span><br>~<span class="hljs-regexp">/opt/</span>biosoft<span class="hljs-regexp">/ncbi-blast-2.7.1+/</span>bin<span class="hljs-regexp">/blastp -query protein.fa -out swiss_prot.xml -db ~/</span>db<span class="hljs-regexp">/swiss_prot/u</span>niprot_sprot.fasta -evalue <span class="hljs-number">1</span>e-<span class="hljs-number">5</span> -outfmt <span class="hljs-number">5</span> -num_threads <span class="hljs-number">50</span> &amp;<br><br></code></pre></td></tr></table></figure><p>å…³äºç»“æœæ•´ç†ï¼Œå·²ç»æœ‰å¾ˆå¤šäººå†™äº†è„šæœ¬ï¼Œæ¯”å¦‚è¯´æˆ‘æœç´¢BLAST XML CSVï¼Œå°±æ‰¾åˆ°äº†<a href="https://github.com/Sunhh/NGS_data_processing/blob/master/annot_tools/blast_xml_parse.py">https://github.com/Sunhh/NGS_data_processing/blob/master/annot_tools/blast_xml_parse.py</a>, æ‰€ä»¥å°±ä¸è¿‡å¤šä»‹ç»ã€‚</p><p><strong>InterProScan</strong></p><p>ä¸‹é¢ä»‹ç»çš„å·¥å…·æ˜¯InterProScan, ä»å®ƒçš„9Gçš„ä½“é‡å°±å¯ä»¥æ„Ÿå—å®ƒçš„å¼ºå¤§ä¹‹å¤„ï¼Œä¸€æ¬¡è¿è¡ŒåŒæ—¶å®ç°å¤šä¸ªä¿¡æ¯æ³¨é‡Šã€‚</p><ul><li>InterProæ³¨é‡Š</li><li>Pfamæ•°æ®åº“æ³¨é‡Š(å¯ä»¥é€šè¿‡hmmscanæœç´¢pfamæ•°æ®åº“å®Œæˆ)</li><li>GOæ³¨é‡Š(å¯ä»¥åŸºäºNRå’ŒPfamç­‰æ•°æ®åº“ï¼Œç„¶åBLAST2GOå®Œæˆ,)</li><li>Reactomeé€šè·¯æ³¨é‡Šï¼Œä¸åŒäºKEGG</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">./interproscan-<span class="hljs-number">5.29</span>-<span class="hljs-number">68.0</span>/interproscan<span class="hljs-selector-class">.sh</span> -appl Pfam  -f TSV -<span class="hljs-selector-tag">i</span> sample<span class="hljs-selector-class">.fa</span> -cpu <span class="hljs-number">50</span> -<span class="hljs-selector-tag">b</span> sample -goterms -iprlookup -pa<br></code></pre></td></tr></table></figure><p><code>-appl</code>å‘Šè¯‰è½¯ä»¶è¦æ‰§è¡Œå“ªäº›æ•°æ®åˆ†æï¼Œå‹¾é€‰çš„è¶Šå¤šï¼Œåˆ†æé€Ÿåº¦è¶Šæ…¢ï¼ŒPfamå°±è¡Œã€‚</p><p>KEGG</p><p>KEGGæ•°æ®åº“ç›®å‰æœ¬åœ°ç‰ˆæ”¶è´¹ï¼Œåœ¨çº¿ç‰ˆæ”¶è´¹ï¼Œæ‰€ä»¥åªèƒ½å°†è›‹ç™½åºåˆ—åœ¨KEGGæœåŠ¡å™¨ä¸Šè¿è¡Œã€‚å› æ­¤ä½ éœ€è¦åœ¨<a href="http://www.genome.jp/tools/kaas/%E9%80%89%E6%8B%A9%E5%90%88%E9%80%82%E7%9A%84%E5%B7%A5%E5%85%B7%E8%BF%9B%E8%A1%8C%E5%90%8E%E7%BB%AD%E7%9A%84%E5%88%86%E6%9E%90%E3%80%82%E6%88%91%E4%B8%8A%E4%BC%A0%E7%9A%8450M%E5%A4%A7%E5%B0%8F%E8%9B%8B%E7%99%BD%E5%BA%8F%E5%88%97%EF%BC%8C%E5%9C%A8KEGG%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E5%8F%AA%E9%9C%80%E8%A6%81%E8%BF%90%E8%A1%8C8%E4%B8%AA%E5%B0%8F%E6%97%B6%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E6%99%9A%E4%B8%8A%E6%8F%90%E4%BA%A4%E4%BB%BB%E5%8A%A1%EF%BC%8C%E7%99%BD%E5%A4%A9%E5%9B%9E%E6%9D%A5%E5%B9%B2%E6%B4%BB%E3%80%82">http://www.genome.jp/tools/kaas/é€‰æ‹©åˆé€‚çš„å·¥å…·è¿›è¡Œåç»­çš„åˆ†æã€‚æˆ‘ä¸Šä¼ çš„50Må¤§å°è›‹ç™½åºåˆ—ï¼Œåœ¨KEGGæœåŠ¡å™¨ä¸Šåªéœ€è¦è¿è¡Œ8ä¸ªå°æ—¶ï¼Œä¹Ÿå°±æ˜¯æ™šä¸Šæäº¤ä»»åŠ¡ï¼Œç™½å¤©å›æ¥å¹²æ´»ã€‚</a><br><img src="/GeekFocus/2022-03-18-annotation/11.png" alt="è¿è¡Œæ—¶é—´"></p><p><img src="/GeekFocus/img/2022-03-18-annotation/11.png" alt="è¿è¡Œæ—¶é—´"></p><p><strong>é™„å½•</strong></p><p>åŸºå› ç»„æ³¨é‡Šçš„å¸¸ç”¨è½¯ä»¶ï¼š</p><ul><li><p>é‡å¤åŒºåŸŸ</p><ul><li><p>RepeatMaskerï¼šè¯†åˆ«åŸºå› ç»„ä¸­çš„å¯èƒ½é‡å¤</p></li><li><p>RepeatModeler: è¯†åˆ«æ–°çš„é‡å¤åºåˆ—</p></li><li><p>LTR-FINDER: <a href="http://tlife.fudan.edu.cn/ltr_finder/">http://tlife.fudan.edu.cn/ltr_finder/</a></p></li></ul></li><li><p>ä»å¤´é¢„æµ‹</p><ul><li><strong>Augustus</strong></li><li>Fgenesh</li></ul></li><li><p>åŒæºé¢„æµ‹</p><ul><li>GeneWise</li><li><strong>Exonerate</strong></li><li>Trinity</li><li>GenomeThreader? failed</li></ul></li><li><p>æ³¨é‡Šåˆå¹¶</p><ul><li>GLEANï¼šå·²ç»è½ä¼äºæ—¶ä»£äº†</li><li><strong>EvidenceModeler</strong>ï¼š ä¸æ—¶ä¿±è¿›</li></ul></li><li><p>æµç¨‹</p><ul><li>PASAï¼šçœŸæ ¸ç”Ÿç‰©åŸºå› çš„<strong>è½¬å½•æœ¬å¯å˜å‰ªåˆ‡è‡ªåŠ¨åŒ–æ³¨é‡Šé¡¹ç›®</strong>ï¼Œéœ€è¦æä¾›ç‰©ç§çš„ESTæˆ–RNA-seqæ•°æ®</li><li><strong>MAKER</strong></li><li><strong>BRAKER1</strong>: ä½¿ç”¨GeneMark-ETå’ŒAUGUSTUSåŸºäºRNA-Seqæ³¨é‡ŠåŸºå› ç»“æ„</li><li>EuGene</li></ul></li><li><p>å¯è§†åŒ–</p><ul><li>IGV</li><li>JBrowse&#x2F;GBrowse</li></ul></li></ul><p><strong>å‚è€ƒæ–‡çŒ®å’Œæ¨èé˜…è¯»ï¼š</strong></p><ul><li>NCBIçœŸæ ¸ç”Ÿç‰©åŸºå› ç»„æ³¨é‡Šæµç¨‹<a href="https://www.ncbi.nlm.nih.gov/genome/annotation_euk/process/">https://www.ncbi.nlm.nih.gov/genome/annotation_euk/process/</a></li><li>çœŸæ ¸åŸºå› ç»„æ³¨é‡Šå…¥é—¨: â€œA beginnerâ€™s guide to eukaryotic genome annotationâ€</li><li>äºŒä»£æµ‹åºæ³¨é‡Šæµç¨‹:Comparative Gene Finding: â€œAnnotation Pipelines for Next-Generation Sequencing Projectsâ€</li><li>åŸºå› ç»„è½¬å½•ç»„æ³¨é‡Šç­–ç•¥: â€œPlant genome and transcriptome annotations: from misconceptions to simple solutionâ€</li><li>é‡å¤åºåˆ—ç»¼è¿°: â€œRepetitive DNA and next-generation sequencing: computational challenges and solutionsâ€</li><li>JGSæµç¨‹: <a href="https://genome.jgi.doe.gov/programs/fungi/FungalGenomeAnnotationSOP.pdf">https://genome.jgi.doe.gov/programs/fungi/FungalGenomeAnnotationSOP.pdf</a></li></ul><p>ç¯å¢ƒå‡†å¤‡</p><p>æ•°æ®ä¸‹è½½</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># Cardamine hirsutatåŸºå› ç»„æ•°æ®</span><br>mkdir chi_annotation &amp;&amp; cd chi_annotation<br>wget http:<span class="hljs-regexp">//</span>chi.mpipz.mpg.de<span class="hljs-regexp">/download/</span>sequences/chi_v1.fa<br>cat chi_v1.fa | tr <span class="hljs-string">&#x27;atcg&#x27;</span> <span class="hljs-string">&#x27;ATCG&#x27;</span> &gt; chi_unmasked.fa<br><span class="hljs-comment"># Cardamine hirsutatè½¬å½•ç»„æ•°æ®</span><br>wget -<span class="hljs-number">4</span> -q -A <span class="hljs-string">&#x27;*.fastq.gz&#x27;</span> -np -nd -r <span class="hljs-number">2</span> http:<span class="hljs-regexp">//</span>chi.mpipz.mpg.de<span class="hljs-regexp">/download/</span>fruit_rnaseq<span class="hljs-regexp">/cardamine_hirsuta/</span> &amp;<br>wget -<span class="hljs-number">4</span> -q -A <span class="hljs-string">&#x27;*.fastq.gz&#x27;</span> -np -nd -r <span class="hljs-number">2</span> http:<span class="hljs-regexp">//</span>chi.mpipz.mpg.de<span class="hljs-regexp">/download/</span>leaf_rnaseq<span class="hljs-regexp">/cardamine_hirsuta/</span> &amp;<br><br></code></pre></td></tr></table></figure><h2 id="è½¯ä»¶å®‰è£…"><a href="#è½¯ä»¶å®‰è£…" class="headerlink" title="è½¯ä»¶å®‰è£…"></a><strong>è½¯ä»¶å®‰è£…</strong></h2><h3 id="RepeatMaskerâˆš"><a href="#RepeatMaskerâˆš" class="headerlink" title="RepeatMaskerâˆš?"></a><strong>RepeatMasker</strong>âˆš?</h3><p>ç”¨äºæ³¨é‡ŠåŸºå› ç»„çš„é‡å¤åŒºï¼Œéœ€è¦å®‰è£…RMBlast, TRFï¼Œä»¥åŠåœ¨<a href="http://www.girinst.org/">http://www.girinst.org</a>æ³¨å†Œä»¥ä¸‹è½½Repbase</p><p>å®‰è£…RepeatMasker</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#useful</span><br><span class="hljs-comment">#cd ~/src</span><br><span class="hljs-built_in">cd</span> RepeatMasker<br>wget http://tandem.bu.edu/trf/downloads/trf409.linux64<br><span class="hljs-comment">#mv trf409.linux64 ~/opt/bin/trf</span><br><span class="hljs-built_in">mv</span> trf409.linux64 opt/bin/trf<br><span class="hljs-comment">#chmod a+x ~/opt/bin/trf</span><br><span class="hljs-built_in">chmod</span> a+x opt/bin/trf<br><br><span class="hljs-comment"># RMBlast -failed</span><br><span class="hljs-comment">#cd ~/src</span><br>wget ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/2.6.0/ncbi-blast-2.6.0+-src.tar.gz<br>wget http://www.repeatmasker.org/isb-2.6.0+-changes-vers2.patch.gz<br>tar xf ncbi-blast-2.6.0+-src<br>gunzip isb-2.6.0+-changes-vers2.patch.gz<br><span class="hljs-built_in">cd</span> ncbi-blast-2.6.0+-src<br>patch -p1 &lt; ../isb-2.6.0+-changes-vers2.patch<br><span class="hljs-built_in">cd</span> c++<br><span class="hljs-comment">#./configure --with-mt --prefix=~/opt/biosoft/rmblast --without-debug &amp;&amp; make &amp;&amp; make install</span><br><br>!!failed<br><span class="hljs-comment"># RepeatMasker</span><br><span class="hljs-built_in">cd</span> ~/src<br>wget http://repeatmasker.org/RepeatMasker-open-4-0-7.tar.gz<br>tar xf RepeatMasker-open-4-0-7.tar.gz<br><span class="hljs-built_in">mv</span> RepeatMasker ~/opt/biosoft/<br><span class="hljs-built_in">cd</span> ~/opt/biosoft/RepeatMasker<br><span class="hljs-comment">## è§£å‹repbaseæ•°æ®åˆ°Librariesä¸‹</span><br><span class="hljs-comment">## é…ç½®RepatMasker</span><br>perl ./configure<br><br>--my ã€follow official webã€‘<br>http://repeatmasker.org/RepeatMasker/<br>Latest Released Version: 04/1/21: RepeatMasker-4.1.2-p1.tar.gz<br>æœªæ›´æ–°Dfamã€the complete dfam mey be download? è¡¥å……15Gï¼Ÿåç¼–è¯‘ï¼Œä¸ä¹‹å‰çš„ç»“æœæ¯”è¾ƒã€‘ï¼ŒRepBase RepeatMasker Editionç”¨çš„è€ç‰ˆæœ¬2017<br>ã€æ›´æ–°2018ã€‘https://www.jianshu.com/p/ffdbedae80fa<br>---RMBlast  ä¸Šé¢çš„configure error<br>https://blog.csdn.net/woodcorpse/article/details/73148464<br>åœ¨RepeatMaskerçš„é¡µé¢ä¸Šæœ‰æœ€è¿‘ncbi-blast-2.6.0+-srcæºä»£ç å’Œè¡¥å®šï¼ŒæŒ‰è¦æ±‚å®‰è£…ï¼Œå³æœ¬æ–‡ä¸­çš„æ“ä½œï¼Œmakeç¼–è¾‘æˆåŠŸï¼Œä½†make installæœ‰é”™è¯¯ï¼Œä¸è¿‡å…³é”®ç¨‹åºrmblastnå·²ç»æˆåŠŸï¼Œå¯æ­£å¸¸ä½¿ç”¨ï¼›<br>å¦‚æœæ–°ç‰ˆå®‰è£…å¤±è´¥ï¼Œå¯å°è¯•å®‰è£…2.2.28çš„é¢„è¯‘ç‰ˆ<br><span class="hljs-built_in">cd</span> /usr/local<br>wget ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/2.2.28/ncbi-blast-2.2.28+-x64-linux.tar.gz<br>wget ftp://ftp.ncbi.nlm.nih.gov/blast/executables/rmblast/2.2.28/ncbi-rmblastn-2.2.28-x64-linux.tar.gz<br>tar zxvf ncbi-blast-2.2.28+-x64-linux.tar.gz<br>tar zxvf ncbi-rmblastn-2.2.28-x64-linux.tar.gz<br><span class="hljs-built_in">cp</span> -R ncbi-rmblastn-2.2.28/* ncbi-blast-2.2.28+/<br><span class="hljs-built_in">rm</span> -rf ncbi-rmblastn-2.2.28<br><span class="hljs-built_in">mv</span> ncbi-blast-2.2.28+ rmblast-2.2.28<br>/usr/local/rmblast-2.2.28/bin/rmblastn -h<br>---error Repeatmasker <span class="hljs-string">&quot;Can&#x27;t locate Text/Soundex.pm in @INC</span><br><span class="hljs-string">https://github.com/rmhubley/RepeatMasker/issues/81</span><br><span class="hljs-string">2.12ç‰ˆæœ¬å¥½äº†</span><br><span class="hljs-string">https://anaconda.org/conda-forge/perl-text-soundex å®‰è£…ä¹Ÿæœªè§£å†³</span><br><span class="hljs-string">---error ModuleNotFoundError: No module named &#x27;h5py&#x27;</span><br><span class="hljs-string">https://github.com/keras-team/keras/issues/3426ï¼›https://docs.h5py.org/en/latest/build.html</span><br><span class="hljs-string">ã€conda install -c anaconda h5pyã€‘</span><br><span class="hljs-string">---error Can&#x27;t locate strict.pm</span><br><span class="hljs-string">ã€perlçš„é—®é¢˜ï¼Œloginalæœ‰é—®é¢˜ï¼Œæ¢è‡ªå·±çš„perlæ²¡é—®é¢˜ã€‘</span><br><span class="hljs-string">---</span><br><span class="hljs-string">å¦‚æœåå¤æç¤ºä»¥ä¸‹å…³äºâ€œText::Soundex moduleâ€æ¨¡å—çš„é”™è¯¯ï¼ˆå³ä¾¿ä½ è¿™ä¸ªperlæ¨¡å—ç¡®å®å®‰è£…å¥½äº†ï¼‰ï¼Œå»ºè®®å°†perlç¯å¢ƒæ›´æ”¹ä¸º/usr/binä¸‹çš„perlï¼ˆå¯¹ï¼Œä¸å»ºè®®ä½¿ç”¨condaä¸­çš„perlï¼‰ï¼Œå¹¶sudo cpané‡æ–°å®‰è£…è¯¥æ¨¡å—åï¼Œå†é‡æ–°å®‰è£…RepeatMaskerï¼ˆå®‰è£…æ—¶æŒ‡å®šç³»ç»Ÿ/usr/binä¸‹çš„perlï¼‰ï¼Œå°±è§£å†³äº†ã€‚ã€4.12æ²¡é—®é¢˜ã€‘</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><h3 id="Repeatmodelerâˆšï¼Ÿ"><a href="#Repeatmodelerâˆšï¼Ÿ" class="headerlink" title="Repeatmodelerâˆšï¼Ÿ"></a>Repeatmodelerâˆšï¼Ÿ</h3><p>åœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šå®‰è£…<strong>RepeatModel</strong></p><p><a href="https://www.jianshu.com/p/7cd5d8ab7290">https://www.jianshu.com/p/7cd5d8ab7290</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs sh">ã€ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼å¿…é¡»fat no condaã€‘ã€<span class="hljs-built_in">local</span> no conda errorã€‘<br>1-3ã€RepeatMaskerã€TRFã€åºåˆ—æœç´¢å¼•æ“<br><span class="hljs-comment"># RECON</span><br><span class="hljs-built_in">cd</span> ~/src<br>wget -4 http://repeatmasker.org/RepeatModeler/RECON-1.08.tar.gz<br>tar xf RECON-1.08.tar.gz<br><span class="hljs-built_in">cd</span> RECON-1.08/src<br>make &amp;&amp; make install<br><span class="hljs-built_in">cd</span> ~/src<br><span class="hljs-built_in">mv</span> RECON-1.08 ~/opt/biosoft<br><span class="hljs-comment"># nesg</span><br><span class="hljs-built_in">cd</span> ~/src<br><span class="hljs-built_in">mkdir</span> nesg &amp;&amp; <span class="hljs-built_in">cd</span> nesg<br>wget -4 ftp://ftp.ncbi.nih.gov/pub/seg/nseg/*<br>make<br><span class="hljs-built_in">mv</span> nmerge nseg ~/opt/bin/<br><span class="hljs-comment"># RepeatScout</span><br>http://www.repeatmasker.org/RepeatScout-1.0.5.tar.gz<br><span class="hljs-comment">#githubï¼šhttps://github.com/mmcco/RepeatScout</span><br>git <span class="hljs-built_in">clone</span> https://github.com/mmcco/RepeatScout.git<br><span class="hljs-built_in">cd</span> RepeatScout<br><span class="hljs-built_in">chmod</span> 755 *<br>make <br><span class="hljs-comment">#æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚RepeatScoutå®‰è£…åœ¨â€œ/home/my/software/RepeatScoutâ€</span><br><span class="hljs-built_in">export</span> PATH=/home/my/software/RepeatScout:<span class="hljs-variable">$PATH</span><br><br><span class="hljs-comment"># RepeatModel</span><br>wget  http://repeatmasker.org/RepeatModeler/RepeatModeler-open-1.0.11.tar.gz<br>tar xf RepeatModeler-open-1.0.11.tar.gz<br><span class="hljs-built_in">mv</span> RepeatModeler-open-1.0.11 ~/opt/biosoft/<br><span class="hljs-built_in">cd</span> ~/opt/biosoft/RepeatModeler-open-1.0.11<br><span class="hljs-comment"># é…ç½®</span><br>perl ./configure<br>---<br>conda perl error<br><br>â€œ./configureâ€æ‰§è¡Œåï¼Œæ ¹æ®æç¤ºä¿¡æ¯ä¸€æ­¥æ­¥æ¥ã€‚<br><br>é¦–å…ˆæ˜¯perlç¯å¢ƒï¼Œæ¨èä½¿ç”¨/usr/binç¯å¢ƒä¸‹çš„perlï¼Œå³ç³»ç»Ÿperlï¼Œã€ã€ä½¿ç”¨condaä¸­çš„perlåé¢æ€»å‡ºé—®é¢˜ã€‘ã€‘å›è½¦ç»§ç»­ã€‚<br>RepeatModelerå®‰è£…è·¯å¾„ï¼Œé»˜è®¤è‡ªåŠ¨æŒ‡å®šå®‰è£…è·¯å¾„ï¼Œå›è½¦ç»§ç»­ã€‚<br><br>æŒ‡å®šRepeatMaskerçš„å®‰è£…è·¯å¾„ï¼Œå›è½¦ç»§ç»­ã€‚<br>/software/biosoft/software/RepeatMasker/ è¯†åˆ«äº†ä¹Ÿfailï¼Œä¸å®Œæ•´library<br>ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿè‡ªå·±è·¯å¾„è¯†åˆ«ä¸å‡ºæ¥<br>MASKER checks xxx/RepeatMasker/Libraries/RepeatMaskerLib.embl <span class="hljs-keyword">for</span> Repbase.<br>If you have older versions of Repbase like RMRBSeqs.embl, create symlink <span class="hljs-keyword">in</span> xxx/RepeatMasker/Libraries/. For example, <span class="hljs-built_in">ln</span> -s RMRBSeqs.embl RepeatMaskerLib.embl. But <span class="hljs-keyword">in</span> that <span class="hljs-keyword">case</span>, model_org= should be <span class="hljs-built_in">set</span> to the org that exists <span class="hljs-keyword">in</span> the database, instead of all. CAUTION: I don<span class="hljs-string">&#x27;t know whether the result is reliable enough in this way.</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">æŒ‡å®šRECONçš„å®‰è£…è·¯å¾„ï¼Œå›è½¦ç»§ç»­ã€‚</span><br><span class="hljs-string">æŒ‡å®šRepeatScoutçš„å®‰è£…è·¯å¾„ï¼Œå›è½¦ç»§ç»­ã€‚</span><br><span class="hljs-string">æŒ‡å®šNSEGçš„å®‰è£…è·¯å¾„ï¼Œå›è½¦ç»§ç»­ã€‚</span><br><span class="hljs-string">æŒ‡å®šTRFçš„å®‰è£…è·¯å¾„ï¼ˆè¿™ä¸ªåŒæ—¶ä¹Ÿæ˜¯RepeatMaskerå®‰è£…å¿…éœ€çš„ï¼‰ï¼Œå›è½¦ç»§ç»­ã€‚</span><br><span class="hljs-string">æœ€åæ˜¯åºåˆ—æœç´¢å¼•æ“ï¼ˆè¿™ä¸ªåŒæ—¶ä¹Ÿæ˜¯RepeatMaskerå®‰è£…å¿…éœ€çš„ï¼‰ï¼Œä¾‹å¦‚æˆ‘ä»¬è¿™é‡Œé€‰æ‹©2ï¼ŒæŒ‡å®šRMBlastä¸»ç¨‹åºæ‰€åœ¨è·¯å¾„ï¼Œå›è½¦è¿”å›ä¸»ç•Œé¢åï¼Œå†é€‰æ‹©3ï¼Œå°±å®Œæˆäº†ã€‚</span><br><span class="hljs-string">ä½ ä¹Ÿå¯ä»¥æŒ‡å®šå¤šç§åºåˆ—æœç´¢å¼•æ“åï¼Œå†é€‰æ‹©3ï¼Œä¸è¿‡å®é™…è¿è¡Œæ—¶ï¼Œä¸€æ¬¡åªèƒ½é€‰æ‹©ä¸€ç§åºåˆ—æ¯”å¯¹æ–¹å¼ã€‚</span><br><span class="hljs-string">ç»ˆäºæŠŠä¸€äº›åˆ—çš„ç¯å¢ƒæ·»åŠ å®Œäº†ï¼Œæœ€åé…ç½®ç¯å¢ƒå˜é‡ã€‚</span><br><span class="hljs-string">Enter Selection: 3</span><br><span class="hljs-string"> -- Setting perl interpreter and version...</span><br><span class="hljs-string"></span><br><span class="hljs-string">Congratulations!  RepeatModeler is now ready to use.</span><br><span class="hljs-string">Simply place:</span><br><span class="hljs-string">   ~/software/opt/biosoft/RepeatModeler-open-1.0.11</span><br><span class="hljs-string">in your user&#x27;</span>s path and review the RepeatModeler documentation here:<br>   ~/software/opt/biosoft/RepeatModeler-open-1.0.11/README<br><br><span class="hljs-built_in">export</span> PATH=/home/my/software/RepeatModeler-open-1.0.11:<span class="hljs-variable">$PATH</span><br> <br><span class="hljs-comment">#è¿™æ—¶å€™æ²¡å•¥é—®é¢˜çš„è¯åº”è¯¥å¯ä»¥çœ‹åˆ°å¸®åŠ©ç•Œé¢äº†</span><br>RepeatModeler -h<br><br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment">#å»ºç«‹åŸºå› ç»„ç´¢å¼•</span><br><span class="hljs-attribute">BuildDatabase</span> -name Silkworm -engine ncbi genomic.fna<br><br><span class="hljs-comment">#æ„å»º libraryï¼Œè¿™æ­¥éå¸¸è€—æ—¶ï¼Œå¥½åƒæå‡çº¿ç¨‹ä¹Ÿæ²¡å•¥ç”¨ï¼Œ#è·å¾—ä¸¤ä¸ªä¸»è¦æ–‡ä»¶ï¼Œ*-families.faã€*-families.stk</span><br><span class="hljs-attribute">RepeatModeler</span> -pa <span class="hljs-number">4</span> -database Silkworm -engine ncbi<br><br><span class="hljs-comment">#ä¸‹æ–¹ä½œä¸ºæµ‹è¯•ï¼Œåªä½¿ç”¨äº†ä¸»è¦çš„å‚æ•°ï¼Œå…¶ä¸­é€šè¿‡ -lib å‚æ•°æŒ‡å®šæœ¬åœ°åº“</span><br><span class="hljs-attribute">RepeatMasker</span> -pa <span class="hljs-number">4</span> -gff -lib Silkworm-families.fa -dir repeat2 genomic.fna<br></code></pre></td></tr></table></figure><p>fastaæ–‡ä»¶â€œ-families.faâ€ä¸ºè®­ç»ƒå¾—åˆ°çš„å…±è¯†é‡å¤åºåˆ—ï¼Œåºåˆ—idåä¼šæ ‡æ³¨å®ƒå±äºå“ªç§é‡å¤åºåˆ—å®¶æ—ï¼Œè‹¥æ— æ³•å½’ç±»åˆ™ç”¨æ ‡æ³¨ä¸ºâ€œUnkownâ€ã€‚<br>â€œ-families.stkâ€ä¸ºç§å­è”é…ï¼ˆSeed alignmentsï¼‰æ–‡ä»¶ï¼Œæ˜¯Dfamå…¼å®¹çš„Stockholmæ ¼å¼ï¼Œå¯ä»¥ä½¿ç”¨RepeatModeler å®‰è£…è·¯å¾„ä¸­è‡ªå¸¦çš„å·¥å…·â€œRepeatModeler&#x2F;util&#x2F;dfamConsensusTool.plâ€ä¸Šä¼ åˆ°Dfam_consensusæ•°æ®åº“ä¸­ã€‚<br>è¯¦è§ï¼š<a href="http://www.repeatmasker.org/RepeatModeler/dfamConsensusTool">http://www.repeatmasker.org/RepeatModeler/dfamConsensusTool</a>. æŸ¥çœ‹è¾“å‡ºç»“æœâ€œ*.tblâ€ã€‚</p><p>RepeatModeler é¢„æµ‹åŸºå› ç»„é‡å¤åºåˆ—ï¼Œä¸ºä¸‹ä¸€æ­¥çš„RepeatMaskerå»ºç«‹é‡å¤åºåˆ—æ•°æ®åº“</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#å»ºåº“ï¼Œåˆ©ç”¨rice ä¸€ä¸ªå®ä¾‹fastaæ–‡ä»¶</span><br>BuildDatablase â€“name ricedb â€“engine ncbi  rice.sample.2.fa<br><br><span class="hljs-comment">#å‚æ•°è¯´æ˜</span><br>-name &lt;database name&gt;<br>        The name of the database to create.<br>-engine &lt;engine name&gt;<br>        The name of the search engine we are using. I.e abblast/wublast or rmblast.<br>-<span class="hljs-built_in">dir</span> &lt;directory&gt;<br>        The name of a directory containing fasta files to be processed. The<br>        files are recognized by their suffix. Only *.fa and *.fasta files<br>        are processed.<br>-batch &lt;file&gt;<br>        The name of a file <span class="hljs-built_in">which</span> contains the names of fasta files to<br>        process. The files names are listed one per line and should be fully<br>        qualified.<br><br>RepeatModeler -database ricedb  -pa 5<br><br><span class="hljs-comment">#å‚æ•°è¯´æ˜</span><br>-database<br>        The name of the sequence database to run an analysis on. This is the<br>        name that was provided to the BuildDatabase script using the <span class="hljs-string">&quot;-name&quot;</span><br>        option.<br>-pa <span class="hljs-comment">#</span><br>        Specify the number of parallel search <span class="hljs-built_in">jobs</span> to run. RMBlast <span class="hljs-built_in">jobs</span> will<br>        use 4 cores each and ABBlast <span class="hljs-built_in">jobs</span> will use a single core each. i.e.<br>        on a machine with 12 cores and running with RMBlast you would use<br>        -pa 3 to fully utilize the machine.<br>-recoverDir &lt;Previous Output Directory&gt;<br>        If a run fails <span class="hljs-keyword">in</span> the middle of processing, it may be possible<br>        recover some results and <span class="hljs-built_in">continue</span> <span class="hljs-built_in">where</span> the previous run left off.<br>        Simply supply the output directory <span class="hljs-built_in">where</span> the results of the failed<br>        run were saved and the program will attempt to recover and <span class="hljs-built_in">continue</span><br>        the run.<br></code></pre></td></tr></table></figure><p>ï¼ˆ1.1ï¼‰RepeatModelerç»“æœæ–‡ä»¶</p><p>consensi.faï¼šè‡ªèº«æ¯”å¯¹æ‰¾åˆ°çš„ä¸€è‡´æ€§åºåˆ—<br>consensi.fa.classifiedï¼šé‡å¤åºåˆ—åˆ†ç±»ç»“æœï¼Œâ€œ#â€åé¢çš„å­—ç¬¦ä¸²æ˜¯åˆ†ç±»ç»“æœ<br>consensi.fa.maskedï¼šå±è”½åçš„åºåˆ—ï¼Œä¸å¤ªä½¿ç”¨<br>ï¼ˆ2ï¼‰RepeatMaskerï¼›å±è”½DNAåºåˆ—ä¸­è½¬åº§å­æˆ–è€…ä½å¤æ‚åº¦é‡å¤åºåˆ—ï¼Œè¾“å‡ºçš„åºåˆ—æŠŠå·²çŸ¥çš„é‡å¤åºåˆ—éƒ½å±è”½æˆNæˆ–Xï¼Œå¹¶ç»™å‡ºç›¸åº”çš„ä½ç½®å’Œç»Ÿè®¡ä¿¡æ¯</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#å°†ä¸Šä¸€æ­¥çš„ç»“æœæ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼Œä»¥â€œRMâ€å¼€å¤´ï¼‰é‡Œé¢çš„consensi.fa.classifiedä¸ºlibiraryï¼Œå¯¹å‚è€ƒåºåˆ—è¿›è¡Œåºåˆ—å±è”½</span><br><span class="hljs-comment">#è¿è¡Œ</span><br>RepeatMasker -nolow  -e ncbi -pa 5 -norna -<span class="hljs-built_in">dir</span> ./  -lib consensi.fa.classified rice.sample.fa<br><br><span class="hljs-comment">#é‡è¦å‚æ•°</span><br>-nolow. (ä¸å±è”½ä½å¤æ‚åºåˆ—ï¼Œæ‹…å¿ƒå±è”½åä½¿å¾—åŸºå› ç»“æ„å—åˆ°å½±å“)<br>        Does not mask low_complexity DNA or simple repeats<br>-lib [filename] è‡ªå·±åˆ¶å®šçš„é‡å¤åºåˆ—åº“<br>        Allows use of a custom library (e.g. from another species)<br> -e(ngine) [crossmatch|wublast|abblast|ncbi|rmblast|hmmer]<br>        Use an alternate search engine to the default.<br>-pa(rallel) [number]<br>        The number of sequence batch <span class="hljs-built_in">jobs</span> [50kb minimum] to run <span class="hljs-keyword">in</span> parallel.<br>-norna<br>        Does not mask small RNA (pseudo) genes<br>-<span class="hljs-built_in">dir</span> [directory name] è¾“å‡ºæ–‡ä»¶ä½ç½®<br>        Writes output to this directory (default is query file directory,<br>        <span class="hljs-string">&quot;-dir .&quot;</span> will write to current directory).<br>-gff<br>        Creates an additional Gene Feature Finding format output<br></code></pre></td></tr></table></figure><p>ï¼ˆ2.1ï¼‰RepeatMaskerè¾“å‡ºç»“æœ</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-comment">*.outï¼šé‡å¤åºåˆ—è¯¦ç»†æ¯”å¯¹ç»“æœ</span><br><span class="hljs-comment">*.maskedï¼šå±è”½åçš„åºåˆ—</span><br><span class="hljs-comment">*.tblï¼šé‡å¤åºåˆ—ç»Ÿè®¡æ–‡ä»¶</span><br><span class="hljs-comment">*.catï¼šå’Œoutå·®ä¸å¤š</span><br></code></pre></td></tr></table></figure><p>ï¼ˆ2.2ï¼‰*.out æ¯ä¸€åˆ—å«ä¹‰</p><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs erlang">ç¬¬ä¸€åˆ—ï¼šæ¯”å¯¹åˆ†å€¼ï¼ŒSW score<br>ç¬¬äºŒåˆ—ï¼šæ›¿ä»£ç‡ perc <span class="hljs-keyword">div</span>.<br>ç¬¬ä¸‰åˆ—ï¼šç¢±åŸºç¼ºå¤±ç™¾åˆ†ç‡<br>ç¬¬å››åˆ—ï¼šåœ¨é‡å¤åºåˆ—ä¸­ç¢±åŸºç¼ºå¤±ç™¾åˆ†ç‡<br>ç¬¬äº”åˆ—ï¼š<span class="hljs-keyword">query</span> sequence<br>ç¬¬å…­åˆ—ï¼šæŸ¥è¯¢åºåˆ—èµ·å§‹ä½ç½®<br>ç¬¬ä¸ƒåˆ—ï¼šæŸ¥è¯¢åºåˆ—ç»ˆæ­¢ä½ç½®<br>ç¬¬å…«åˆ—ï¼šæŸ¥è¯¢åŒºåŸŸä¸­è¶…å‡ºæ¯”å¯¹åŒºåŸŸç¢±åŸºçš„æ•°ç›®ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰æ¯”å¯¹ä¸Šçš„ç¢±åŸºæ•°<br>ç¬¬ä¹åˆ—ï¼š+/-(C)<br>ç¬¬ååˆ—ï¼šæ¯”ä¸Šçš„é‡å¤åºåˆ—åç§°ï¼Œç±»å‹å‘½å<br>ç¬¬åä¸€åˆ—ï¼šæ¯”ä¸Šé‡å¤åºåˆ—çš„åˆ†ç±»ï¼Œå’Œrepeatmolder ä¸­*.classed æ˜¯ä¸€æ ·çš„<br>ç¬¬åäºŒåˆ—ï¼šæ¯”ä¸Šçš„åœ¨æ•°æ®åº“ä¸­çš„èµ·å§‹ä½ç½®<br>ç¬¬åä¸‰åˆ—ï¼šæ¯”ä¸Šçš„åœ¨æ•°æ®åº“ä¸­çš„ç»ˆæ­¢ä½ç½®<br>ç¬¬åå››åˆ—ï¼šåœ¨ç¬¬ååˆ—ä¸Šè¶…å‡ºæ¯”å¯¹åŒºåŸŸç¢±åŸºçš„æ•°ç›®ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰æ¯”å¯¹ä¸Šçš„ç¢±åŸºæ•°<br>ç¬¬åäº”åˆ—ï¼šæ¯”å¯¹åŒºåŸŸçš„IDï¼Œéšæœºç»™çš„<br></code></pre></td></tr></table></figure><p>ï¼ˆ2.3ï¼‰æœ€åå°†outæ–‡ä»¶å¯è½¬ä¸ºGFFæ–‡ä»¶ï¼Œå³å®ŒæˆåŸºå› ç»„é‡å¤åºåˆ—çš„é‰´å®š</p><p>BLAST**ï¼ŒBLASTæœ‰ä¸¤ä¸ªç‰ˆæœ¬å¯ä¾›é€‰æ‹©, WuBLASTæˆ–è€…NCBI-BLASTï¼Œæˆ‘ä¸ªäººå€¾å‘äºNCBI-BLASTï¼Œå¹¶ä¸”æ¨èä½¿ç”¨ç¼–è¯‘åäºŒè¿›åˆ¶ç‰ˆæœ¬ï¼Œå› ä¸ºç¼–è¯‘å®åœ¨æ˜¯å¤ªèŠ±æ—¶é—´äº†</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk">cd ~/src<br>wget ftp:<span class="hljs-regexp">//</span>ftp.ncbi.nlm.nih.gov<span class="hljs-regexp">/blast/</span>executables<span class="hljs-regexp">/blast+/</span>LATEST/ncbi-blast-<span class="hljs-number">2.7</span>.<span class="hljs-number">1</span>+-x64-linux.tar.gz<br>tar xf ncbi-blast-<span class="hljs-number">2.7</span>.<span class="hljs-number">1</span>+-x64-linux.tar.gz -C ~<span class="hljs-regexp">/opt/</span>biosoft<br><span class="hljs-comment"># ç¯å¢ƒå˜é‡</span><br>export PATH=~<span class="hljs-regexp">/opt/</span>biosoft<span class="hljs-regexp">/ncbi-blast-2.7.1+/</span>bin:<span class="hljs-variable">$PATH</span><br><span class="hljs-comment"># ç”¨äºåç»­çš„BRAKER2</span><br>conda create -n annotation blast=<span class="hljs-number">2.2</span>.<span class="hljs-number">31</span><br><br></code></pre></td></tr></table></figure><h3 id="AUGUSTUS-âˆš"><a href="#AUGUSTUS-âˆš" class="headerlink" title="AUGUSTUS âˆš?"></a><strong>AUGUSTUS</strong> âˆš?</h3><p> å¯ä»¥è¯´æ˜¯æœ€å¥½çš„é¢„æµ‹è½¯ä»¶ï¼Œä½¿ç”¨condaå®‰è£…</p><p><a href="https://github.com/Gaius-Augustus/Augustus">https://github.com/Gaius-Augustus/Augustus</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">UnsatisfiableError: The following specifications were found to be incompatible with your system:?????<br><br>  - feature:/linux-64::__glibc==2.17=0<br>  - augustus=3.4.0 -&gt; libgcc-ng[version=<span class="hljs-string">&#x27;&gt;=9.3.0&#x27;</span>] -&gt; __glibc[version=<span class="hljs-string">&#x27;&gt;=2.17&#x27;</span><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">source</span> activate annotation<br><span class="hljs-comment">#conda install augustus=3.3 failed</span><br>conda search -c bioconda augustus<br>conda install -c bioconda augustus=3.2.2 failed ï¼š libboost_iostream.so.1.60.0<br>conda install -c bioconda augustus=3.1<br></code></pre></td></tr></table></figure><h3 id="GeneMark-ES-x2F-ETâˆš"><a href="#GeneMark-ES-x2F-ETâˆš" class="headerlink" title="GeneMark-ES&#x2F;ETâˆš?"></a><strong>GeneMark-ES&#x2F;ET</strong>âˆš?</h3><p>æ˜¯å”¯ä¸€ä¸€æ¬¾æ”¯æŒæ— ç›‘ç£è®­ç»ƒæ¨¡å‹, è½¯ä»¶ä¸‹è½½éœ€è¦ç™»è®°</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk">cd ~/src<br>wget http:<span class="hljs-regexp">//</span>topaz.gatech.edu<span class="hljs-regexp">/GeneMark/</span>tmp<span class="hljs-regexp">/GMtool_Qg87n/gm</span>_et_linux_64.tar.gz<br>tar xf gm_et_linux_64.tar.gz<br>mv gm_et_linux_64<span class="hljs-regexp">/gmes_petap/</span> ~<span class="hljs-regexp">/opt/</span>biosoft<br>wget http:<span class="hljs-regexp">//</span>topaz.gatech.edu<span class="hljs-regexp">/GeneMark/</span>tmp<span class="hljs-regexp">/GMtool_Qg87n/gm</span>_key_64.gz<br>gzip -dc gm_key_64.gz &gt; ~/.gm_key<br>cpan YAML Hash::Merge Logger::Simple Parallel::ForkManager<br>echo <span class="hljs-string">&quot;export PATH=$PATH:~/opt/biosoft/gmes_petap/&quot;</span> &gt;&gt; ~/.bashrc<br><br></code></pre></td></tr></table></figure><h3 id="GlimmerHMM"><a href="#GlimmerHMM" class="headerlink" title="GlimmerHMM:"></a><strong>GlimmerHMM</strong>:</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">cd ~/src<br>wget -<span class="hljs-number">4</span> ftp:<span class="hljs-regexp">//</span>ccb.jhu.edu<span class="hljs-regexp">/pub/</span>software<span class="hljs-regexp">/glimmerhmm/</span>GlimmerHMM-<span class="hljs-number">3.0</span>.<span class="hljs-number">4</span>.tar.gz<br>tar xf GlimmerHMM-<span class="hljs-number">3.0</span>.<span class="hljs-number">4</span>.tar.gz -C ~<span class="hljs-regexp">/opt/</span>biosoft<br></code></pre></td></tr></table></figure><h3 id="SNAP-âˆš"><a href="#SNAP-âˆš" class="headerlink" title="SNAP: âˆš?"></a><strong>SNAP</strong>: âˆš?</h3><p>åŸºå› ä»å¤´é¢„æµ‹å·¥å…·ï¼Œåœ¨å¤„ç†å«æœ‰é•¿å†…å«å­ä¸Šçš„åŸºå› ç»„ä¸Šè¡¨ç°æ¬ ä½³</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># å®‰è£…</span><br>cd ~/src<br>git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/KorfLab/</span>SNAP.git<br>cd SNP<br>make<br>cd ..<br>mv SNAP ~<span class="hljs-regexp">/opt/</span>biosoft<br><span class="hljs-comment"># ç¯å¢ƒå˜é‡</span><br>export Zoe=~<span class="hljs-regexp">/opt/</span>biosoft<span class="hljs-regexp">/SNAP/</span>Zoe<br>export PATH=~<span class="hljs-regexp">/opt/</span>biosoft/SNAP:<span class="hljs-variable">$PATH</span><br><br></code></pre></td></tr></table></figure><h3 id="Exonerate-2-2-âˆš-cluster"><a href="#Exonerate-2-2-âˆš-cluster" class="headerlink" title="Exonerate 2.2: âˆš? cluster"></a><strong>Exonerate 2.2</strong>: âˆš? cluster</h3><p>é…å¯¹åºåˆ—æ¯”å¯¹å·¥å…·ï¼Œæä¾›äºŒè¿›åˆ¶ç‰ˆæœ¬, åŠŸèƒ½ç±»ä¼¼äºGeneWiseï¼Œèƒ½å¤Ÿ<font color="blue">å°†cDNAæˆ–è›‹ç™½ä»¥gao alignçš„æ–¹å¼å’ŒåŸºå› ç»„åºåˆ—è”é…</font>ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> ~/src<br>wget http://ftp.ebi.ac.uk/pub/software/vertebrategenomics/exonerate/exonerate-2.2.0-x86_64.tar.gz<br>tar xf exonerate-2.2.0-x86_64.tar.gz<br><span class="hljs-built_in">mv</span> exonerate-2.2.0-x86_64 ~/opt/biosoft/exonerate-2.2.0<br><span class="hljs-comment"># .bashrcæ·»åŠ ç¯å¢ƒå˜é‡</span><br><span class="hljs-built_in">export</span> PATH=~/opt/biosoft/exonerate-2.2.0:<span class="hljs-variable">$PATH</span><br><span class="hljs-comment"># æˆ–</span><br>conda install -c bioconda exonerate<br>---ä¸‹è½½æœ€æ–°ç‰ˆæœ¬2.4.0<br>sudo?<br><br></code></pre></td></tr></table></figure><h3 id="GenomeThreader-1-703-failed-âˆš"><a href="#GenomeThreader-1-703-failed-âˆš" class="headerlink" title="GenomeThreader 1.703 failed: âˆš?"></a>GenomeThreader 1.703 failed: âˆš?</h3><p>åŒæºé¢„æµ‹è½¯ä»¶ï¼Œ1.7.0ç‰ˆæœ¬æ›´æ–°äº2018å¹´2æœˆ</p><p><a href="https://genomethreader.org/download.html">https://genomethreader.org/download.html</a> 1.7.3-2020-01</p><p>error:gth: &#x2F;lib64&#x2F;libc.so.6: version &#96;GLIBC_2.27â€™ not found (required by gth)</p><p>1.7.1</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#wget -4 http://genomethreader.org/distributions/gth-1.7.0-Linux_x86_64-64bit.tar.gz</span><br><span class="hljs-comment">#tar xf gth-1.7.0-Linux_x86_64-64bit.tar.gz -C ~/opt/biosoft</span><br>tar xf gth-1.7.3-Linux_x86_64-64bit.tar.gz -C ./<br><span class="hljs-comment"># ä¿®æ”¹.bashrcå¢åŠ å¦‚ä¸‹è¡Œ</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$HOME</span>/opt/biosoft/gth-1.7.0-Linux_x86_64-64bit/bin<br><span class="hljs-built_in">export</span> BSSMDIR=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/opt/biosoft/gth-1.7.0-Linux_x86_64-64bit/bin/bssm&quot;</span><br><span class="hljs-built_in">export</span> GTHATADIR=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/opt/biosoft/gth-1.7.0-Linux_x86_64-64bit/bin/gthdata&quot;</span><br><br></code></pre></td></tr></table></figure><h3 id="BRAKER2"><a href="#BRAKER2" class="headerlink" title="BRAKER2:"></a><strong>BRAKER2</strong>:</h3><p>ä¾èµ–AUGUSTUS 3.3, GeneMark-EX 4.33, BAMTOOLS 2.5.1, NCBI BLAST+ 2.2.31+(å¯é€‰ SAMTOOLS 1.74+, GenomeThreader 1.70)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh">cpan File::Spec::Functions Module::Load::Conditional POSIX Scalar::Util::Numeric YAML File::Which Logger::Simple Parallel::ForkManager<br><span class="hljs-built_in">cd</span> ~/src<br>wget -4 http://exon.biology.gatech.edu/GeneMark/Braker/BRAKER2.tar.gz<br>tar xf BRAKER2.tar.gz -C ~/opt/biosoft<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;export PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$HOME</span>/opt/biosoft/BRAKER_v2.1.0/&quot;</span> &gt;&gt; ~/.bashrc<br><span class="hljs-comment"># åœ¨~/.bashrcè®¾ç½®å¦‚ä¸‹è½¯ä»¶æ‰€åœ¨ç¯å¢ƒå˜é‡</span><br><span class="hljs-built_in">export</span> AUGUSTUS_CONFIG_PATH=<span class="hljs-variable">$HOME</span>/miniconda3/envs/annotation/config/<br><span class="hljs-built_in">export</span> AUGUSTUS_SCRIPTS_PATH=<span class="hljs-variable">$HOME</span>/miniconda3/envs/annotation/bin/<br><span class="hljs-built_in">export</span> BAMTOOLS_PATH=<span class="hljs-variable">$HOME</span>/miniconda3/envs/annotation/bin/<br><span class="hljs-built_in">export</span> GENEMARK_PATH=<span class="hljs-variable">$HOME</span>/opt/biosoft/gmes_petap/<br><span class="hljs-built_in">export</span> SAMTOOLS_PATH=<span class="hljs-variable">$HOME</span>/miniconda3/envs/annotation/bin/<br><span class="hljs-built_in">export</span> ALIGNMENT_TOOL_PATH=<span class="hljs-variable">$HOME</span>/opt/biosoft/gth-1.7.0-Linux_x86_64-64bit/bin/<br><br></code></pre></td></tr></table></figure><p>å‚è€ƒ<a href="https://www.cnblogs.com/jessepeng/p/14806266.html">https://www.cnblogs.com/jessepeng/p/14806266.html</a></p><h3 id="TransDecoder"><a href="#TransDecoder" class="headerlink" title="TransDecoder"></a>TransDecoder</h3><p>ç¼–ç åŒºåŸŸé¢„æµ‹å·¥å…·ï¼Œéœ€è¦é¢„å…ˆå®‰è£…NCBI-BLAST</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">cpan</span> URI::Escape<br><span class="hljs-attribute">cd</span> ~/src<br><span class="hljs-attribute">wget</span> -<span class="hljs-number">4</span> https://github.com/TransDecoder/TransDecoder/archive/TransDecoder-v5.<span class="hljs-number">3</span>.<span class="hljs-number">0</span>.zip<br><span class="hljs-attribute">unzip</span> TransDecoder-v5.<span class="hljs-number">3</span>.<span class="hljs-number">0</span>.zip<br><span class="hljs-attribute">cd</span> TransDecoder-v5.<span class="hljs-number">3</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">make</span> test<br><br></code></pre></td></tr></table></figure><h3 id="MAKER"><a href="#MAKER" class="headerlink" title="MAKER:"></a><strong>MAKER</strong>:</h3><p>Conda failed</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh">conda create -n maker<br>conda activate<br>conda search -c bioconda maker<br>conda install -c bioconda maker=3.01.03<br>UnsatisfiableError: The following specifications were found to be incompatible with your system:<br><br>  - feature:/linux-64::__glibc==2.17=0<br>  - maker=3.01.03 -&gt; libgcc-ng[version=<span class="hljs-string">&#x27;&gt;=9.3.0&#x27;</span>] -&gt; __glibc[version=<span class="hljs-string">&#x27;&gt;=2.17&#x27;</span>]<br><br></code></pre></td></tr></table></figure><h3 id="PASA"><a href="#PASA" class="headerlink" title="PASA:"></a>PASA:</h3><p> ä¾èµ–äºä¸€ä¸ªæ•°æ®åº“(MySQLæˆ–SQLite), Perlæ¨¡å—(DBD::mysqlæˆ–DBD::SQLite), GMAP, BLAT, Fasta3ã€‚ç”±äºMySQLåœ¨HPCé›†ç¾¤ä¸­çš„è¡¨ç°ä¸å¦‚SQLiteï¼Œä»¥åŠå®‰è£…MySQLè¿˜éœ€è¦å„ç§ç®¡ç†å‘˜æƒé™ï¼Œäºæ˜¯å°±æœ‰äººè¿›è¡Œäº†ä¿®æ”¹ï¼Œå¢åŠ äº†feature&#x2F;sqliteåˆ†æ”¯, è§Add support for SQLite</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs awk">cpan DB_File URI::Escape DBI DBD::SQLite<br><span class="hljs-comment"># GMAP</span><br>wget http:<span class="hljs-regexp">//</span>research-pub.gene.com<span class="hljs-regexp">/gmap/</span>src/gmap-gsnap-<span class="hljs-number">2017</span>-<span class="hljs-number">11</span>-<span class="hljs-number">15</span>.tar.gz<br>tar xf gmap-gsnap-<span class="hljs-number">2017</span>-<span class="hljs-number">11</span>-<span class="hljs-number">15</span>.tar.gz<br>cd gmap-<span class="hljs-number">2017</span>-<span class="hljs-number">11</span>-<span class="hljs-number">15</span><br>.<span class="hljs-regexp">/configure --prefix=$HOME/</span>opt/gmap<br>make &amp;&amp; make install<br><span class="hljs-comment"># BLAT</span><br>cd ~<span class="hljs-regexp">/opt/</span>bin<br>wget http:<span class="hljs-regexp">//</span>hgdownload.soe.ucsc.edu<span class="hljs-regexp">/admin/</span>exe<span class="hljs-regexp">/linux.x86_64/</span>blat<span class="hljs-regexp">/blat &amp;&amp; chmod 755 ./</span>blat<br><span class="hljs-comment"># Fasta3</span><br>wget -<span class="hljs-number">4</span> http:<span class="hljs-regexp">//</span>faculty.virginia.edu<span class="hljs-regexp">/wrpearson/</span>fasta<span class="hljs-regexp">/fasta36/</span>fasta-<span class="hljs-number">36.3</span>.<span class="hljs-number">8</span>g.tar.gz &amp;&amp; \<br>        tar zxvf fasta-<span class="hljs-number">36.3</span>.<span class="hljs-number">8</span>g.tar.gz &amp;&amp; \<br>        cd .<span class="hljs-regexp">/fasta-36.3.8g/</span>src &amp;&amp; \<br>        make -f ..<span class="hljs-regexp">/make/</span>Makefile.linux_sse2 all &amp;&amp; \<br>        cp ..<span class="hljs-regexp">/bin/</span>fasta36 ~<span class="hljs-regexp">/opt/</span>bin<br><span class="hljs-comment"># ä»¥ä¸Šç¨‹åºéœ€æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­</span><br><span class="hljs-comment"># PASApipeline</span><br>cd ~<span class="hljs-regexp">/opt/</span>biosoft<br>git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/PASApipeline/</span>PASApipeline.git<br>cd PASApipeline &amp;&amp; \<br>git checkout feature/sqlite &amp;&amp; \<br>git submodule init &amp;&amp; git submodule update &amp;&amp; \<br>make<br><br></code></pre></td></tr></table></figure><p><a href="https://links.jianshu.com/go?to=http://weatherby.genetics.utah.edu/MAKER/wiki/index.php/The_MAKER_control_files_explained">http://weatherby.genetics.utah.edu/MAKER/wiki/index.php/The_MAKER_control_files_explained</a></p><h3 id="EVidenceModeler-âˆš"><a href="#EVidenceModeler-âˆš" class="headerlink" title="EVidenceModeler: âˆš?"></a><strong>EVidenceModeler</strong>: âˆš?</h3><p> æ•´åˆä¸åŒæ¥æºçš„æ³¨é‡Šç»“æœï¼Œæ‰¾åˆ°å¯é çš„åŸºå› ç»“æ„</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">cd</span> ~/src<br><span class="hljs-attribute">wget</span> -<span class="hljs-number">4</span> https://github.com/EVidenceModeler/EVidenceModeler/archive/v1.<span class="hljs-number">1</span>.<span class="hljs-number">1</span>.tar.gz<br><span class="hljs-attribute">tar</span> xf v1.<span class="hljs-number">1</span>.<span class="hljs-number">1</span>.tar.gz<br><span class="hljs-attribute">mv</span> EVidenceModeler-<span class="hljs-number">1</span>.<span class="hljs-number">1</span>.<span class="hljs-number">1</span> ~/opt/biosoft/<br><br></code></pre></td></tr></table></figure><hr><h1 id="The-NCBI-Eukaryotic-Genome-Annotation-Pipeline"><a href="#The-NCBI-Eukaryotic-Genome-Annotation-Pipeline" class="headerlink" title="The NCBI Eukaryotic Genome Annotation Pipeline"></a><a href="https://www.ncbi.nlm.nih.gov/genome/annotation_euk/process/">The NCBI Eukaryotic Genome Annotation Pipeline</a></h1><hr><p><a href="https://github.com/meiyang12/Genome-annotation-pipeline">https://github.com/meiyang12/Genome-annotation-pipeline</a></p><hr><p><a href="https://github.com/fohebert/GenomeAnnotation">https://github.com/fohebert/GenomeAnnotation</a></p><hr>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>annotation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Organelle assembly</title>
    <link href="/GeekFocus/2022/03/18/2022-03-18-mito-chro/"/>
    <url>/GeekFocus/2022/03/18/2022-03-18-mito-chro/</url>
    
    <content type="html"><![CDATA[<p>organelle assembly</p><span id="more"></span><h1 id="Mitochondrial-Genome-Assembly"><a href="#Mitochondrial-Genome-Assembly" class="headerlink" title="Mitochondrial Genome Assembly"></a><strong>Mitochondrial Genome Assembly</strong></h1><h2 id="æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„-ç‰¹ç‚¹ï¼Œæˆå› å’Œåæœ"><a href="#æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„-ç‰¹ç‚¹ï¼Œæˆå› å’Œåæœ" class="headerlink" title="æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„ ç‰¹ç‚¹ï¼Œæˆå› å’Œåæœ"></a><a href="https://www.zhihu.com/question/65471820#:~:text=%E6%A4%8D%E7%89%A9%E7%BA%BF%E7%B2%92%E4%BD%93%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%9A%84%E4%B8%BB%E8%A6%81%E7%89%B9%E7%82%B9%E6%98%AF%EF%BC%9A%20%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%A4%A7%E5%B0%8F%E5%92%8C%E7%BB%93%E6%9E%84%E5%8F%98%E5%BC%82%E5%B7%A8%E5%A4%A7%EF%BC%8C%E5%9F%BA%E5%9B%A0%E5%8D%B4%E6%9E%81%E5%BA%A6%E4%BF%9D%E5%AE%88%EF%BC%9B%E5%9F%BA%E5%9B%A0%E5%88%86%E5%B8%83%E9%9D%9E%E5%B8%B8%E7%A8%80%E7%96%8F%EF%BC%8C%E5%90%AB%E6%9C%89%E5%A4%A7%E9%87%8F%E9%9D%9E%E7%BC%96%E7%A0%81%E5%BA%8F%E5%88%97%EF%BC%9B%E5%AD%98%E5%9C%A8%E5%A4%A7%E9%87%8F%E7%9A%84RNA%E7%BC%96%E8%BE%91%E3%80%82,%E5%A4%A7%E9%83%A8%E5%88%86%E5%8A%A8%E7%89%A9%E7%9A%84%E7%8E%AF%E7%8A%B6%E7%BA%BF%E7%B2%92%E4%BD%93%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%9A%84%E5%A4%A7%E5%B0%8F%E7%BA%A615-17kb%EF%BC%8C%E4%B8%94%E7%BB%93%E6%9E%84%E7%9B%B8%E5%AF%B9%E4%BF%9D%E5%AE%88%EF%BC%8C%E5%9F%BA%E5%9B%A0%E6%8E%92%E5%88%97%E7%B4%A7%E5%87%91%EF%BC%8C%E8%BF%99%E4%BA%9B%E7%89%B9%E7%82%B9%E9%83%BD%E8%B7%9F%E6%A4%8D%E7%89%A9%E5%8F%B6%E7%BB%BF%E4%BD%93%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%9B%B8%E4%BB%BF%EF%BC%8C%E6%A4%8D%E7%89%A9%E7%9A%84%E5%8F%B6%E7%BB%BF%E4%BD%93%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%A4%A7%E5%B0%8F%E5%9C%A8100-200kb%E4%B9%8B%E9%97%B4%E3%80%82%20%E7%84%B6%E8%80%8C%E6%A4%8D%E7%89%A9%E7%BA%BF%E7%B2%92%E4%BD%93%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%8D%B4%E8%B7%9F%E5%89%8D%E4%B8%A4%E8%80%85%E6%9C%89%E7%9D%80%E8%BF%A5%E7%84%B6%E4%B8%8D%E5%90%8C%E7%9A%84%E7%89%B9%E6%80%A7%EF%BC%8C%E5%85%B6%E5%A4%A7%E5%B0%8F%E4%B8%80%E8%88%AC%E5%9C%A8200-750kb%E4%B9%8B%E9%97%B4%E3%80%82">æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„ ç‰¹ç‚¹ï¼Œæˆå› å’Œåæœ</a></h2><p>æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼š<strong>åŸºå› ç»„å¤§å°å’Œç»“æ„å˜å¼‚å·¨å¤§ï¼ŒåŸºå› å´æåº¦ä¿å®ˆï¼›åŸºå› åˆ†å¸ƒéå¸¸ç¨€ç–ï¼Œå«æœ‰å¤§é‡éç¼–ç åºåˆ—ï¼›å­˜åœ¨å¤§é‡çš„RNAç¼–è¾‘ã€‚</strong></p><ul><li><p>å¤§éƒ¨åˆ†<strong>åŠ¨ç‰©ç¯çŠ¶çº¿ç²’ä½“åŸºå› ç»„</strong>å¤§å°çº¦<strong>15-17kb</strong>ï¼Œä¸”<strong>ç»“æ„ç›¸å¯¹ä¿å®ˆ</strong>ï¼Œ<strong>åŸºå› æ’åˆ—ç´§å‡‘</strong></p></li><li><p>åŠ¨ç‰©çº¿ç²’ä½“è·Ÿ<strong>æ¤ç‰©å¶ç»¿ä½“åŸºå› ç»„ç›¸ä»¿</strong>ï¼Œ<strong>æ¤ç‰©å¶ç»¿ä½“åŸºå› ç»„</strong>å¤§å°åœ¨<strong>100-200kbä¹‹é—´</strong></p></li><li><p><strong>æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„</strong>å´è·Ÿå‰ä¸¤è€…è¿¥ç„¶ä¸åŒï¼Œå¤§å°åœ¨<strong>200-750kb</strong>ä¹‹é—´ã€‚<strong>é»„ç“œ</strong>çº¿ç²’ä½“åŸºå› ç»„è¾¾<strong>1556kb</strong>ã€‚<strong>è¿‘ç¼˜</strong>ç‰©ç§é—´<strong>ä¹Ÿå·®å¼‚å·¨å¤§</strong>ã€‚å¦‚è‡å­è‰å±ï¼ˆ<em>Silene</em>ï¼‰ä¸­ï¼Œå¤œèŠ±è‡å­è‰ï¼ˆ<em>S. noctiflora</em>ï¼‰çº¿ç²’ä½“åŸºå› ç»„<strong>6.728kb</strong>ï¼Œè€Œå‰ææ¡è‡å­è‰ï¼ˆ<em>S. latifolia</em>ï¼‰çº¿ç²’ä½“åŸºå› ç»„<strong>253kb</strong>ï¼Œ<strong>åŒå±</strong>æ¤ç‰©å·®å¼‚30å€ã€‚å³ä½¿<strong>åŒä¸€ç‰©ç§</strong>ï¼Œå·®å¼‚ä¹Ÿæ˜¾è‘—ã€‚å¦‚ç™½ç‰è‰ï¼ˆ<em>S. vulgaris</em>ï¼‰ï¼Œä»»ä½•<strong>ä¸åŒç§ç¾¤</strong>ä¸¤ä¸¤ä¹‹é—´åªæœ‰çº¦ä¸€åŠçš„çº¿ç²’ä½“åŸºå› ç»„åºåˆ—ç›¸åŒã€‚</p></li><li><p>æ¤ç‰©çº¿ç²’ä½“<strong>åŸºå› ç»„åºå¤§</strong>ï¼Œä½†<strong>ç¼–ç åŸºå› å´ä¸å¤š</strong>ï¼Œæ’åˆ—ç¨€ç–ã€‚<strong>æ¤ç‰©å¶ç»¿ä½“åŸºå› ç»„</strong>ä¸Šçº¦<strong>100ä¸ªåŸºå› </strong>ï¼Œä½†æ¯”å¶ç»¿ä½“åŸºå› ç»„å¤§çš„<strong>æ‹Ÿå—èŠ¥çº¿ç²’ä½“åŸºå› ç»„</strong>ï¼Œå´åªæœ‰çº¦<strong>50å¤šä¸ªåŸºå› </strong>ï¼Œè€Œäººçº¿ç²’ä½“åŸºå› ç»„37ä¸ªåŸºå› ã€‚æ‹Ÿå—èŠ¥<strong>çº¿ç²’ä½“åŸºå› æ•°é‡</strong>ä¸åˆ°äººçš„<strong>ä¸¤å€</strong>ï¼Œå…¶<strong>åŸºå› ç»„å¤§å°</strong>å´æ˜¯<strong>22å€</strong>ã€‚æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„å¤§éƒ¨åˆ†æ˜¯<strong>éç¼–ç åºåˆ—</strong>ï¼Œè¿™äº›åºåˆ—å åˆ°<strong>60%ä»¥ä¸Š</strong>ã€‚è¿™äº›éç¼–ç åºåˆ—ç”±<strong>é‡å¤ç‰‡æ®µã€å¶ç»¿ä½“åŸºå› ç»„å’Œå’ŒåŸºå› ç»„è½¬ç§»è€Œæ¥</strong>çš„åºåˆ—ï¼Œç”šè‡³æ˜¯<strong>åŸºå› æ°´å¹³è½¬ç§»</strong>è·å¾—çš„å…¶å®ƒç‰©ç§åºåˆ—ã€‚å¦‚æœ€<strong>å¤è€çš„è¢«å­æ¤ç‰©äº’å¶æ¢…</strong>ï¼ˆ<em>Amborella trichopoda</em>ï¼‰çš„çº¿ç²’ä½“åŸºå› ç»„ä¸­ï¼Œå°±æœ‰<strong>å¤§é‡æ¥è‡ªè‹”è—“ã€ç»¿è—»å’Œå…¶å®ƒè¢«å­æ¤ç‰©çš„åºåˆ—ç‰‡æ®µ</strong>ï¼ˆRice, 2013ï¼‰ã€‚</p></li><li><p>æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„<strong>ç»“æ„å˜å¼‚å·¨å¤§</strong>ï¼Œçº¿ç²’ä½“<strong>åŸºå› </strong>å´<strong>æåº¦ä¿å®ˆ</strong>ï¼Œåœ¨<strong>æ¤ç‰©ä¸‰å¥—åŸºå› ç»„ä¸­æœ€ä¿å®ˆæ¼”åŒ–é€Ÿç‡æœ€æ…¢</strong>ã€‚é»„ç“œå¦‚æ­¤åºå¤§çº¿ç²’ä½“åŸºå› ç»„åªæ¯”æ‹Ÿå—èŠ¥å¤šå››ä¸ªåŸºå› ã€‚ç”±äºæ¤ç‰©çº¿ç²’ä½“åŸºå› <strong>éå¸¸ä¿å®ˆï¼ŒåŒºåˆ†åº¦ä¸è¶³</strong>ï¼Œä¸€èˆ¬<strong>ä¸é€‰ä½œç³»ç»Ÿå­¦ç ”ç©¶</strong>çš„<strong>åˆ†å­æ ‡è®°</strong>ã€‚è·ŸåŠ¨ç‰©æ­£å¥½ç›¸åï¼Œ<strong>åŠ¨ç‰©çš„çº¿ç²’ä½“åŸºå› æ¼”åŒ–é€Ÿç‡è¾ƒå¿«</strong>ï¼Œæ‰€ä»¥åœ¨åŠ¨ç‰©ç³»ç»Ÿå­¦ç ”ç©¶ä¸­ï¼Œæ˜¯<strong>æœ€å¸¸ç”¨çš„åˆ†å­æ ‡è®°</strong>ã€‚</p></li><li><p><strong>æ˜¯ä»€ä¹ˆå¯¼è‡´æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„å¦‚æ­¤åºå¤§ï¼Œå¦‚æ­¤å¤šéç¼–ç åºåˆ—ï¼Ÿçº¿ç²’ä½“åŸºå› ç»„åŸºå› ä¿å®ˆåŸå› æ˜¯ï¼Ÿç›®å‰ç†è®ºæ˜¯å‘ç”Ÿåœ¨çº¿ç²’ä½“éç¼–ç åŒºå’Œç¼–ç åŒºçš„ä¸¤å¥—ä¸åŒDNAä¿®å¤æœºåˆ¶ã€‚</strong></p></li><li><p>æ¤ç‰©çº¿ç²’ä½“<strong>ç¼–ç åŒº</strong>è¿›è¡Œçš„æ˜¯<strong>ç¢±åŸºå‰ªåˆ‡ä¿®å¤</strong>ï¼ˆBase excision repairï¼‰å’Œ<strong>åŸºå› è½¬æ¢</strong>ï¼ˆgene conversionï¼‰ä»‹å¯¼çš„<strong>ç²¾ç¡®</strong>ä¿®å¤ï¼Œè€Œåœ¨éç¼–ç åŒºè¿›è¡Œçš„æ˜¯<strong>éåŒæºæ€§æœ«ç«¯è¿æ¥</strong>ï¼ˆnon-homologous end joiningï¼‰å’Œ<strong>æ–­è£‚è¯±å¯¼å¤åˆ¶</strong>ï¼ˆBreak-induced replicationï¼‰ä»‹å¯¼çš„<strong>éç²¾ç¡®</strong>ä¿®å¤ï¼ˆChristensen, 2013ï¼‰</p></li></ul><p><img src="/GeekFocus/2022-03-18-mito-chro/1.png" alt="img"><br><img src="/GeekFocus/img/2022-03-18-mito-chro/1.png" alt="img"></p><ul><li>ç¼–ç åŒºç²¾ç¡®ä¿®å¤å¯¼è‡´çº¿ç²’ä½“åŸºå› å˜å¼‚ç¨€å°‘ï¼Œæ¼”åŒ–é€Ÿç‡éå¸¸æ…¢ã€‚éç¼–ç åŒºéç²¾ç¡®ä¿®å¤ï¼Œä¿®å¤è¿‡ç¨‹å¸¦æ¥å¾ˆå¤šå¤–æ¥åºåˆ—ï¼Œä½¿å¾—éç¼–ç åŒºéå¸¸åŒ…å®¹ï¼Œä¸æ–­å¸æ”¶ç§¯ç´¯éç¼–ç åºåˆ—</li><li>åæœã€‚æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„ä¸­å¤§é‡éç¼–ç åºåˆ—ï¼Œå…¶ä¸­å¾ˆå¤šé‡å¤ç‰‡æ®µï¼Œå¯¼è‡´æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„ æ˜“é‡ç»„ã€‚å¶ç»¿ä½“åŸºå› ç»„åœ¨ç»†èƒå†…å¸¸ä»¥å®Œæ•´ç¯çŠ¶å­˜åœ¨ï¼Œæ¤ç‰©çº¿ç²’ä½“ä¼šé‡ç»„å½¢æˆçº¿çŠ¶ç»“æ„ï¼Œç”šè‡³å¾ˆå¤šå¤§å°ä¸ä¸€çš„ç¯ã€‚é»„ç“œæœ‰1.6M+84k+45kçº¿ç²’ä½“åŸºå› ç»„(å¤§å°ç¯)ã€‚å®Œæ•´æµ‹å‡ºçš„mito è¿œå°äºchro</li></ul><h2 id="æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„æµ‹åº"><a href="#æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„æµ‹åº" class="headerlink" title="æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„æµ‹åº"></a>æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„æµ‹åº</h2><p><a href="http://www.genepioneer.com/display.php?id=353">http://www.genepioneer.com/display.php?id=353</a></p><ul><li><p>åŠ¨ç‰©çº¿ç²’ä½“åŸºå› ç»„è¾ƒå°ï¼Œé€šå¸¸åœ¨10-39kbï¼Œè€Œæ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„å¤§å°åœ¨200-750kbã€‚æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼šåŸºå› ç»„å¤§å°å’Œç»“æ„å˜å¼‚å·¨å¤§ï¼›åŸºå› å´æåº¦ä¿å®ˆï¼›åŸºå› åˆ†å¸ƒéå¸¸ç¨€ç–ï¼›å«æœ‰å¤§é‡éç¼–ç åºåˆ—ï¼›å­˜åœ¨å¤§é‡çš„RNAç¼–è¾‘</p></li><li><p>å…¬å¸å¥—è·¯ï¼šäºŒä»£+ä¸‰ä»£æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„æµ‹åº</p><ul><li><strong>åŸºå› ç»„æ³¨é‡Š</strong>è¿›è¡Œ<strong>åŸºå› åºåˆ—ç»„æˆåˆ†æ</strong>æ¥ç ”ç©¶<strong>ç‰©ç§åŠŸèƒ½ç‰¹å¾</strong></li><li><strong>æ¯”è¾ƒåŸºå› ç»„å­¦</strong>ç ”ç©¶ç‰©<strong>ç§é—´åŸºå› ç»„ç»“æ„å˜åŒ–</strong>æ¢è®¨ç‰©<strong>ç§çš„ç¯å¢ƒé€‚åº”æ€§ç‰¹å¾</strong></li><li><strong>ç¾¤ä½“åŸºå› ç»„ç ”ç©¶</strong>å†…å®¹æ›´å¹¿ï¼š<strong>ç‰©ç§èµ·æºã€äº²ç¼˜åˆ†ç±»ã€ç³»ç»Ÿå‘è‚²ã€è°±ç³»åœ°ç†</strong>ç­‰</li></ul></li><li><p>å…¬å¸å¸¸è§„åˆ†æ</p><ul><li>çº¿ç²’ä½“åŸºå› ç»„ç»“æ„æ³¨é‡Š</li><li>çº¿ç²’ä½“åŸºå› ç»„å›¾è°±</li><li>RSCUåˆ†æ</li><li>æ•£åœ¨é‡å¤åºåˆ—åˆ†æ</li><li>ç¢±åŸºåç§»åˆ†æ</li></ul></li><li><p>å…¬å¸é«˜çº§åˆ†æ</p><ul><li>KaKsåˆ†æ</li><li>çº¿ç²’ä½“ç»“æ„æ¯”è¾ƒåˆ†æ</li><li>è¿›åŒ–æ ‘åˆ†æ</li><li>åºåˆ—åŒæºåŠå…±çº¿æ€§åˆ†æ</li><li>åŸºå› æ°´å¹³è½¬ç§»åˆ†æ</li></ul></li><li><p>æ¡ˆä¾‹1</p><ul><li><a href="doi.org/10.1186/s12862-020-1582-1">ç´«è¡«çº¿ç²’ä½“åŸºå› ç»„</a>ï¼š8ä¸ªè›‹ç™½åŸºå› è½¬ç§»åˆ°æ ¸åŸºå› ç»„ã€‚å¯¹ç´«è¡«çº¿ç²’ä½“åŸºå› ç»„æµ‹åºï¼Œå¾—åˆ°å…¨é•¿<font color="blue"><strong>468,924bp</strong></font>çº¿ç²’ä½“åŸºå› ç»„åºåˆ—ä¸<strong>å…¶å®ƒ4ä¸ªè£¸å­æ¤ç‰©è°±ç³»</strong>çš„<strong>çº¿ç²’ä½“åŸºå› ç»„</strong>æ¯”è¾ƒã€‚ç»“æœè¡¨æ˜è£¸å­æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„åœ¨<strong>å¤§å°ã€ç»“æ„ã€åŸºå› å’Œå†…å«å­å«é‡ã€å¤–æºåºåˆ—ã€çªå˜ç‡</strong>ç­‰æ–¹é¢ä¸<strong>è¢«å­æ¤ç‰©</strong>çº¿ç²’ä½“åŸºå› ç»„<strong>å­˜åœ¨å·®å¼‚</strong>ã€‚</li><li><a href="DOI%EF%BC%9A10.7717/peerj.3148">çº¢æŸ³çº¿ç²’ä½“å…¨åŸºå› ç»„åºåˆ—çš„ç»„è£…ä¸æ¯”è¾ƒåˆ†æ</a> : ç»„è£…å¾—åˆ°å…¨é•¿<font color="blue"><strong>644,437bp</strong></font>å®Œæ•´çš„çº¢æŸ³çº¿ç²’ä½“ (mt) åºåˆ—ã€‚ç¼–ç <font color="blue"><strong>58ä¸ªç‹¬ç‰¹åŸºå› </strong></font>ï¼ˆ32ä¸ªè›‹ç™½ç¼–ç åŸºå› ã€23ä¸ªtRNAåŸºå› å’Œ3ä¸ªrRNAåŸºå› ï¼‰ã€‚é€šè¿‡å¯¹35ç§æ¨æ ‘çš„23ä¸ªè›‹ç™½ç¼–ç åŸºå› <strong>ç³»ç»Ÿå‘è‚²åˆ†æ</strong>ï¼Œè¯æ˜<strong>çº¢æŸ³æ˜¯æ¨æ ‘çš„å§Šå¦¹</strong>ã€‚</li></ul></li></ul><h2 id="software-2019review-DOI-10-16288-x2F-j-yczz-19-227"><a href="#software-2019review-DOI-10-16288-x2F-j-yczz-19-227" class="headerlink" title="[software-2019review](DOI: 10.16288&#x2F;j.yczz.19-227)"></a>[software-2019review](DOI: 10.16288&#x2F;j.yczz.19-227)</h2><ul><li>ç‰¹æ®Šä¸”å®¹æ˜“è·å–çš„é—ä¼ æ ‡è®°ï¼Œé«˜çªå˜é€Ÿç‡(not plant)ã€æ— åŸºå› é‡ç»„ã€é«˜æ‹·è´æ•°å’Œæ¯ç³»é—ä¼ ç­‰</li><li>è¿›åŒ–ç”Ÿç‰©å­¦ã€ç¾¤ä½“é—ä¼ å­¦ç­‰æ­ç¤ºç‰©ç§çš„èµ·æºå’Œæ‰©æ•£å†å²å‘æŒ¥ä½œç”¨ã€‚æ ¸åŸºå› å’Œçº¿ç²’ä½“è¡¨ç°ä¸ä¸€è‡´çš„è°±ç³»å…³ç³»ï¼Œç‰¹åˆ«æ˜¯å…·æœ‰å¤æ‚çš„ç¾¤ä½“å†å²çš„ç±»ç¾¤(å¦‚<strong>åŸºå› äº¤æµ</strong>ã€<strong>é—ä¼ æ¼‚å˜</strong>ã€<strong>åå‘æ€§è¿å¾™</strong>å’Œ<strong>ç¥–å…ˆè°±ç³»åˆ†æ‹£</strong>ç­‰)ã€‚</li><li>æœ‰å‚ï¼šè¿‘ç¼˜ç‰©ç§çš„çº¿ç²’ä½“åŸºå› ç»„æˆ–éƒ¨åˆ†ç‰‡æ®µä½œä¸ºå‚è€ƒåºåˆ—ï¼Œä»ç ”ç©¶ç±»ç¾¤å…¨åŸºå› ç»„æ•°æ®ä¸­æ•è·çº¿ç²’ä½“readsã€‚(1)åŸºäºçº¿ç²’ä½“<strong>æ•´ä¸ª</strong>åŸºå› ç»„çš„æ‹¼è£…ç­–ç•¥ï¼›(2)åŸºäºçº¿ç²’ä½“<strong>ç‰‡æ®µ</strong>çš„æ‹¼è£…ç­–ç•¥ã€‚ä½¿ç”¨æ¯”å¯¹å·¥å…·(å¦‚BWA)å°†æ€»readsæ˜ å°„(mapping)åˆ°çº¿ç²’ä½“å‚è€ƒåºåˆ—ï¼Œæ ¹æ®<strong>åºåˆ—çš„ç›¸ä¼¼æ€§æ•è·</strong>çº¿ç²’ä½“readsï¼Œç„¶åä½¿ç”¨ä¸åŒåºåˆ—å»¶é•¿ç­–ç•¥å¯¹æ•è·çš„çº¿ç²’ä½“readsåºåˆ—å»¶ä¼¸ï¼Œç›´åˆ°å»¶é•¿åˆ°å®Œæ•´çš„çº¿ç²’ä½“åŸºå› ç»„é•¿åº¦ã€‚<strong>MIA</strong>ç”¨ç°ä»£äººçº¿ç²’ä½“åŸºå› ç»„ä½œå‚è€ƒç ”ç©¶å°¼å®‰å¾·ç‰¹äººã€‚</li><li>denovoï¼šçº¿ç²’ä½“contigåˆ†æ‹£</li></ul><table><thead><tr><th>è½¯ä»¶åç§°</th><th>æ˜¯å¦éœ€è¦å‚è€ƒåºåˆ—&#x2F; å‚è€ƒåºåˆ—ç±»å‹</th><th>é€‚ç”¨ ç‰©ç§</th><th>è¾“å…¥æ–‡ä»¶æ ¼å¼ã€ ç±»å‹</th><th>å˜å¼‚ æ³¨é‡Š</th><th>ç»“æ„å¯ è§†åŒ–</th><th>è¿è¡Œ ç¯å¢ƒ</th><th>ç¼–ç¨‹ è¯­è¨€</th></tr></thead><tbody><tr><td>MIA</td><td>æ˜¯&#x2F;è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td><td>ä»»æ„ ç‰©ç§</td><td>Fastqã€SE readså’Œ PE reads</td><td>Ã—</td><td>Ã—</td><td>CUI</td><td>C&#x2F;C++</td></tr><tr><td>MitoBamAnnotator</td><td>æ˜¯&#x2F; rCRS</td><td>äºº</td><td>Bam</td><td>âˆš</td><td>âˆš</td><td>Web</td><td>Java</td></tr><tr><td>MitoSeek</td><td>æ˜¯&#x2F;rCRSå’Œhg19</td><td>äºº</td><td>Bam</td><td>âˆš</td><td>Ã—</td><td>GUI</td><td>Perl</td></tr><tr><td>mtDNA- profiler</td><td>æ˜¯&#x2F;rCRS</td><td>äºº</td><td>Fasta</td><td>Ã—</td><td>âˆš</td><td>Web</td><td>Java</td></tr><tr><td>MITObim</td><td>æ˜¯&#x2F;è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td><td>ä»»æ„ ç‰©ç§</td><td>Bam</td><td>Ã—</td><td>Ã—</td><td>CUI</td><td>Perl</td></tr><tr><td>Mit-o-matic</td><td>æ˜¯&#x2F;rCRS</td><td>äºº</td><td>Fastqã€SE readså’Œ PE reads</td><td>âˆš</td><td>âˆš</td><td>Web&#x2F;GUI</td><td>Java</td></tr><tr><td>MToolBox</td><td>æ˜¯&#x2F;rCRSå’ŒRSRS</td><td>äºº</td><td>Fastq&#x2F;Bam&#x2F;Samã€ SE readså’ŒPE reads</td><td>âˆš</td><td>Ã—</td><td>Web&#x2F;CUI</td><td>Python</td></tr><tr><td>ARC</td><td>æ˜¯&#x2F;è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td><td>ä»»æ„ ç‰©ç§</td><td>Fastqã€SE readså’Œ PE reads</td><td>Ã—</td><td>Ã—</td><td>Web&#x2F;CUI</td><td>Python</td></tr><tr><td>Phy-Mer</td><td>æ˜¯&#x2F;è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td><td>ä»»æ„ ç‰©ç§</td><td>Fasta&#x2F;fastq&#x2F;Bamã€ SE readså’ŒPE reads</td><td>Ã—</td><td>âˆš</td><td>CUI</td><td>Python</td></tr><tr><td>mtDNA- Server</td><td>æ˜¯&#x2F;rCRSå’ŒRSRS</td><td>äºº</td><td>Fastq&#x2F;Bam&#x2F;VCFã€ SE readså’ŒPE reads</td><td>âˆš</td><td>âˆš</td><td>Web</td><td>Java</td></tr><tr><td>IOGA</td><td>æ˜¯&#x2F;è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td><td>ä»»æ„ ç‰©ç§</td><td>Fastqã€SE readså’Œ PE reads</td><td>Ã—</td><td>Ã—</td><td>CUI</td><td>Python</td></tr><tr><td>NOVOPlasty</td><td>æ˜¯&#x2F;è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td><td>ä»»æ„ ç‰©ç§</td><td>Fastq&#x2F;fastaã€SE reads å’ŒPE reads</td><td>Ã—</td><td>Ã—</td><td>Web&#x2F;CUI</td><td>Perl</td></tr><tr><td>Norgal</td><td>å¦</td><td>ä»»æ„ ç‰©ç§</td><td>Fastqã€SE readså’Œ PE reads</td><td>Ã—</td><td>Ã—</td><td>CUI</td><td>Python&#x2F; Java</td></tr><tr><td>Organelle- PBA</td><td>æ˜¯&#x2F;è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td><td>ä»»æ„ ç‰©ç§</td><td>PacBio reads</td><td>Ã—</td><td>Ã—</td><td>CUI</td><td>Perl</td></tr><tr><td>MitoSuite</td><td>æ˜¯&#x2F;rCRS, RSRS, hg19, GRCh37å’Œ38</td><td>äºº</td><td>Bam&#x2F;Sam</td><td>âˆš</td><td>âˆš</td><td>GUI</td><td>Python</td></tr><tr><td>ORG.Asm</td><td>æ˜¯&#x2F;è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td><td>ä»»æ„ ç‰©ç§</td><td>Fastqã€SE readså’Œ PE reads</td><td>Ã—</td><td>Ã—</td><td>CUI</td><td>Python</td></tr><tr><td>MitoZ</td><td>å¦</td><td>ä»»æ„ ç‰©ç§</td><td>Fastqã€SE readså’Œ PE reads</td><td>âˆš</td><td>âˆš</td><td>CUI</td><td>Python</td></tr><tr><td><strong>GetOrganelle</strong></td><td>æ˜¯&#x2F;è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td><td>ä»»æ„ ç‰©ç§</td><td>Fastqã€SE readså’Œ PE reads</td><td>Ã—</td><td>Ã—</td><td><strong>CUI</strong></td><td>Python</td></tr><tr><td>Trimitomics</td><td>æ˜¯&#x2F;è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td><td>ä»»æ„ ç‰©ç§</td><td>RNA-seq readsã€ PE reads</td><td>Ã—</td><td>Ã—</td><td>Unknown</td><td>Unknown</td></tr></tbody></table><h2 id="è½¯ä»¶GetOrganelle"><a href="#è½¯ä»¶GetOrganelle" class="headerlink" title="è½¯ä»¶GetOrganelle"></a>è½¯ä»¶GetOrganelle</h2><p><a href="https://zhuanlan.zhihu.com/p/428949195">https://zhuanlan.zhihu.com/p/428949195</a></p><p><a href="https://github.com/Kinggerm/GetOrganelle">https://github.com/Kinggerm/GetOrganelle</a></p><p>GetOrganelleæ˜¯ä¸­ç§‘é™¢æ˜†æ¤æ‰€é‡‘å»ºå†›å’Œéƒæ–‡å½¬è€å¸ˆå…±åŒå¼€å‘çš„<strong>è´¨ä½“ç»„è£…è½¯ä»¶</strong>ï¼Œ<strong>2020-Genome Biology</strong>ã€‚</p><h3 id="æ ¸å¿ƒæµç¨‹"><a href="#æ ¸å¿ƒæµç¨‹" class="headerlink" title="æ ¸å¿ƒæµç¨‹"></a>æ ¸å¿ƒæµç¨‹</h3><p>1ï¼‰é€šè¿‡â€œç§å­â€åºåˆ—è·å¾—éƒ¨åˆ†ç›®æ ‡ç›¸å…³readsï¼›</p><p>2ï¼‰å»¶ä¼¸readsè·å¾—æ‰€æœ‰ç›®æ ‡ç›¸å…³readsï¼›</p><p>3ï¼‰å¯¹readsè¿›è¡Œä»å¤´ç»„è£…å¾—åˆ°ç»„è£…å›¾å½¢ï¼›</p><p>4ï¼‰è¿‡æ»¤ç»„è£…å›¾å½¢ï¼›</p><p>5ï¼‰è¯†åˆ«ç»†èƒå™¨ç»„åˆ†å¹¶è‡ªåŠ¨å¯¼å‡ºæ‰€æœ‰å¯èƒ½çš„ç»†èƒå™¨åŸºå› ç»„ç»“æ„ã€‚</p><p><img src="/GeekFocus/2022-03-18-mito-chro/2.png" alt="img"><br><img src="/GeekFocus/img/2022-03-18-mito-chro/2.png" alt="img"></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">conda create -n getorganelle<br>conda activate getorganelle<br>conda install getorganelle<br></code></pre></td></tr></table></figure><p><strong>ä¸‹è½½å‚è€ƒåºåˆ—åº“</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">get_organelle_config.py --add embplant_pt,embplant_mt<br><span class="hljs-comment">#embplant_pt(é«˜ç­‰æ¤ç‰©å¶ç»¿ä½“)</span><br><span class="hljs-comment">#embplant_mt(é«˜ç­‰æ¤ç‰©çº¿ç²’ä½“)</span><br><span class="hljs-comment">#embplant_nr(é«˜ç­‰æ¤ç‰©æ ¸ç³–ä½“ RNA)</span><br><span class="hljs-comment">#animal_mt (åŠ¨ç‰©çº¿ç²’ä½“)</span><br><span class="hljs-comment">#fungus_mt (çœŸèŒçº¿ç²’ä½“)</span><br></code></pre></td></tr></table></figure><p>If connection keeps failing, please manually download the latest database from <a href="https://github.com/Kinggerm/GetOrganelleDB">GetOrganelleDB</a> and <a href="https://github.com/Kinggerm/GetOrganelle/wiki/Initialization#option-2-initialization-from-local-files">initialization from local files</a>.</p><p>The database will be located at <code>~/.GetOrganelle</code> by default, which can be changed via the command line parameter <code>--config-dir</code>, or via the shell environment variable <code>GETORG_PATH</code> (see more <a href="https://github.com/Kinggerm/GetOrganelle/wiki/Initialization">here</a>).</p><h3 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh">-1 åŒç«¯æµ‹åºçš„R1<br>-2 åŒç«¯æµ‹åºçš„R2<br>-o ç»“æœæ–‡ä»¶ï¼Œç»“æœè¾“å‡ºä¿å­˜çš„ç›®å½•(æ–‡ä»¶å¤¹)åç§°<br>-F æ•°æ®åº“ï¼Œè®¾å®šè¦ç»„è£…çš„åŸºå› ç»„ç±»å‹<br>-s å‚è€ƒåºåˆ—<br>-t çº¿ç¨‹æ•°<br>-R æœ€å¤§çš„ä¸€ä¸ªæ‰©å……å¾ªç¯çš„æ•°ï¼Œä¸€èˆ¬é»˜è®¤15ï¼Œæå–åŸºå›  reads çš„è½®æ¬¡(è½®æ¬¡è¶Šå¤š,è€—æ—¶è¶Šé•¿)<br>-k kmerçš„ä¸€ä¸ªå‚æ•°ï¼Œè°ƒç”¨SPAdesè¿›è¡Œdenovoç»„è£…çš„k-mer,æ•°å€¼å¿…é¡»æ˜¯å¥‡æ•°, æœ€å¤§å€¼æ˜¯127<br>-w æå–å¶ç»¿ä½“åŸºå› reads æ—¶ä½¿ç”¨çš„é•¿åº¦æ¯”ä¾‹æˆ–å®é™…é•¿åº¦<br><span class="hljs-comment">#word-sizeï¼šæå–å¶ç»¿ä½“åŸºå› reads æ—¶ï¼Œå¯ä»¥ä½¿ç”¨reads é•¿åº¦çš„æ¯”ä¾‹(ratio)ï¼Œä¹Ÿå¯ä»¥è®¾ç½®å®é™…é•¿åº¦çš„word-sizeã€‚ä¾‹å¦‚ï¼šå¦‚æœä½¿ç”¨ratio=0.6, å³ readsé•¿åº¦æ˜¯150bpæ—¶ï¼Œè®¾ç½®çš„word-size = 90bpï¼Œç­‰åŒäºè®¾ç½® â€œ-w 90â€ã€‚</span><br></code></pre></td></tr></table></figure><h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><p><strong>Starting from reads</strong></p><p>The <font color="green"><strong>green workflow</strong></font> in the flowchart  shows the processes of <code>get_organelle_from_reads.py</code>.</p><ul><li><p><strong>Input data</strong></p><p>Currently, <code>get_organelle_from_reads.py</code> was written for <strong>illumina pair-end&#x2F;single-end data</strong> (fastq or fastq.gz). We recommend using <strong>adapter-trimmed</strong> raw reads without quality control. Usually, <strong>&gt;1G</strong> per end is enough for <strong>plastome</strong> for most normal angiosperm samples, and <strong>&gt;5G</strong> per end is enough for <strong>mitochondria</strong> genome assembly. Since v1.6.2, <code>get_organelle_from_reads.py</code> will <strong>automatically estimate the read data it needs</strong>, without user assignment nor data reducing (see flags <code>--reduce-reads-for-coverage</code> and <code>--max-reads</code>).</p></li><li><p><strong>Main Options</strong></p><ul><li><code>-w</code> The value word size, like the kmer in assembly, is crucial to the <strong>feasibility and efficiency</strong> of this process. The <strong>best word size changes upon data and will be affected</strong> by read length, read quality, base coverage, organ DNA percent and other factors. By default, GetOrganelle would <strong>automatically estimate a proper word siz</strong>e based on the data characters. Although the automatically-estimated word size value does not ensure the best performance nor the best result, <font color="green">you do not need to adjust this value</font> (<code>-w</code>) if a complete&#x2F;circular organelle genome assembly is produced, because the circular result generated by GetOrganelle is highly consistent under different options and seeds. The automatically estimated word size may be screwy in some animal mitogenome data due to inaccurate coverage estimation, for which you fine-tune it instead.</li><li><code>-k</code> The best kmer(s) depend on a wide variety of factors too. Although more kmer values add the time consuming, you are recommended to use a wide range of kmers to benefit from the power of SPAdes. Empirically, you should include <strong>at least</strong> including <strong>one small</strong> kmer (e.g. <code>21</code>) and <strong>one large</strong> kmer (<code>105</code>) for a successful organelle genome assembly.</li><li><code>-s</code> GetOrganelle takes the seed (fasta format; if this was not provided, the default is <code>GetOrganelleLib/SeedDatabase/*.fasta</code>) as probe, the script would recruit target reads in successive rounds (extending process). <strong>The default seed works for most samples</strong>, but using a complete organelle genome sequence of a <strong>related species as the seed would help the assembly</strong> in many cases (e.g. degraded DNA samples, fastly-evolving in animal&#x2F;fungal samples; see more <a href="https://github.com/Kinggerm/GetOrganelle/wiki/FAQ#how-to-assemble-a-target-organelle-genome-using-my-own-reference">here</a>).</li></ul></li><li><p><strong>Key Results</strong></p><p>The key output files include</p><ul><li><code>*.path_sequence.fasta</code>, each fasta file represents one type of genome structure</li><li><code>*.selected_graph.gfa</code>, the <a href="https://github.com/Kinggerm/GetOrganelle/wiki/Terminology">organelle-only assembly graph</a></li><li><code>get_org.log.txt</code>, the log file</li><li><code>extended_K*.assembly_graph.fastg</code>, the raw assembly graph</li><li><code>extended_K*.assembly_graph.fastg.extend_embplant_pt-embplant_mt.fastg</code>, a simplified assembly graph</li><li><code>extended_K*.assembly_graph.fastg.extend_embplant_pt-embplant_mt.csv</code>, a tab-format contig label file for bandage visualization</li></ul><p>You may delete the files other than above if the resulting genome is complete (indicated in the log file and the name of the <code>*.fasta</code>). You are expected to obtain the complete organelle genome assembly for most animal&#x2F;fungal mitogenomes and plant chloroplast genomes (see <a href="https://github.com/Kinggerm/GetOrganelle/wiki/FAQ#why-does-getorganelle-generate-a-circular-genome-for-embplant_nrfungus_nr">here for nuclear ribosomal DNAs</a>) with the recommended recipes.</p><p>If GetOrganelle <strong>failed</strong> to <strong>generate the complete circular genome</strong> (produce <code>*scaffolds*path_sequence.fasta</code>), please follow <a href="https://github.com/Kinggerm/GetOrganelle/wiki/FAQ#what-should-i-do-with-incomplete-resultbroken-assembly-graph">here</a> to <strong>adjust your parameters for a second run</strong>. You could also use the incomplete sequence to conduct downstream analysis.</p></li></ul><p>#æ¤ç‰©2Gå·¦å³æ•°æ®ï¼Œ<strong>ç»„è£…å¶ç»¿ä½“åŸºå› ç»„</strong>ç”¨</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -o plastome_output -R 15 -k 21,45,65,85,105 -F embplant_pt<br></code></pre></td></tr></table></figure><p>#æ›´å¿«çš„æ–¹æ³•</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -o plastome_output --fast -k 21,65,105 -w 0.68 -F embplant_pt<br></code></pre></td></tr></table></figure><p>#ç»„è£…<strong>æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -o mitochondria_output -R 50 -k 21,45,65,85,105 -P 1000000 -F embplant_mt<br><span class="hljs-comment"># -P pre grouping value. default 20 0000</span><br><span class="hljs-comment"># 1. please use the ã€FASTG file as the final outputã€‘ for downstream manual processing. until further updates, the FASTA output of plant mitochondria genome of numerous repeats may be error-prone</span><br><span class="hljs-comment"># 2. embplant_mt mode was not tested in the GetOrganelle paper due to the complexity of plant mitogenomes and the defects of short reads</span><br></code></pre></td></tr></table></figure><p>#ç»„è£…<strong>æ¤ç‰©æ ¸æ ¸ç³–ä½“DNA</strong>ç‰‡æ®µ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -o nr_output -R 10 -k 35,85,115 -F embplant_nr<br></code></pre></td></tr></table></figure><p>#ç»„è£…çœŸèŒçº¿ç²’ä½“</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -R 10 -k 21,45,65,85,105 -F fungus_mt -o fungus_mt_out<br></code></pre></td></tr></table></figure><p>#ç»„è£…åŠ¨ç‰©çº¿ç²’ä½“</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -R 10 -k 21,45,65,85,105 -F animal_mt -o animal_mt_out<br></code></pre></td></tr></table></figure><p>å¾—åˆ°çš„æ–‡ä»¶æœ‰completeä»£è¡¨æ‹¼æ¥æˆç¯ã€‚</p><p><strong>GetOrganelle â€“assembly å¼€å§‹</strong></p><p>The <font color="blue"><strong>blue workflow</strong></font> in the chat shows the processes of <code>get_organelle_from_assembly.py</code>.</p><ul><li><p><strong>Input data &amp; Main Options</strong></p><ul><li><code>-g</code> The input must be a FASTG or GFA formatted assembly graph file.</li><li>If you input an assembly graph assembled from total DNA sequencing using third-party a de novo assembler (e.g. Velvet), the assembly graph may includes a great amount of non-target contigs. You may want to use <code>--min-depth</code> and <code>--max-depth</code> to greatly reduce the computational burden for target extraction.</li><li>If you input an <a href="https://github.com/Kinggerm/GetOrganelle/wiki/Terminology">organelle-equivalent assembly graph</a> (e.g. manually curated and exported using Bandage), you may use <code>--no-slim</code>.</li></ul></li><li><p><strong>Key Results</strong></p><p>The key output files include</p><ul><li><code>*.path_sequence.fasta</code>, one fasta file represents one type of genome structure</li><li><code>*.selected_graph.gfa</code>, the <a href="https://github.com/Kinggerm/GetOrganelle/wiki/Terminology">organelle-only assembly graph</a></li><li><code>get_org.log.txt</code>, the log file</li></ul></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">get_organelle_from_assembly.py -g assembly_graph.fastg -F embplant_pt -o output-plastome<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">-g      SPAdesç»„è£…å¾—åˆ°çš„FASTGçš„assembly graph<br>-F      è®¾å®šè¦ç»„è£…çš„åŸºå› ç»„ç±»å‹<br>-o      ç»“æœè¾“å‡ºä¿å­˜çš„ç›®å½•(æ–‡ä»¶å¤¹)åç§°<br>--min-depth  å‰”é™¤graphä¸­depthä½äºé˜ˆå€¼çš„contigs<br>--max-depth    å‰”é™¤graphä¸­depthé«˜äºé˜ˆå€¼çš„contigs<br>--min-depth 10 å’Œâ€œ--max-depth10000â€è¿™ä¸¤æ¡å‘½ä»¤æ˜¯å¤‡é€‰çš„ï¼Œå…·ä½“çš„depthéœ€è¦å¯ä»¥è‡ªè¡Œè®¾å®šã€‚<br></code></pre></td></tr></table></figure><p><strong>GetOrganelle â€“graph.gfaå¼€å§‹</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">gfa_to_fastg.py graph.gfa<br>get_organelle_from_assembly.py -g graph.gfa.fastg -F embplant_pt -o output-plastome --no-slim<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">-g     Bandageæ¢³ç†åè½¬æ¢ä¸ºfastgçš„graph*<br>-F     è®¾å®šè¦ç»„è£…çš„åŸºå› ç»„ç±»ç¾¤:embplant_pt(å¶ç»¿ä½“),embplant_mt(çº¿ç²’ä½“)å’Œembplant_nr(æ ¸ç³–ä½“ RNA)<br>-o     ç»“æœè¾“å‡ºä¿å­˜çš„ç›®å½•(æ–‡ä»¶å¤¹)åç§°<br></code></pre></td></tr></table></figure><blockquote><p>*ï¼Œä½¿ç”¨Bandageç¼–è¾‘åï¼Œå¯ä»¥â€œmerge all possible nodesâ€ï¼Œç„¶åå†è¾“å‡ºçš„æ–‡ä»¶æ ¼å¼gfaå›¾å½¢æ–‡ä»¶ï¼Œgfaæ–‡ä»¶å¯ä»¥ç”¨gfa_to_fastg.pyåšä¸€ä¸‹è½¬æ¢ã€‚è™½ç„¶gfaä¹Ÿæ˜¯å›¾å½¢æ–‡ä»¶ï¼Œä½†æ˜¯å›¾å½¢å†…å®¹ä¸fastgæœ‰å·®å¼‚äº›å¤æ‚å›¾å½¢ä¼šè¾“å‡ºå¤±è´¥ã€‚</p></blockquote><h1 id="Chloroplast-Genome-Assembly"><a href="#Chloroplast-Genome-Assembly" class="headerlink" title="Chloroplast Genome Assembly**"></a>Chloroplast Genome Assembly**</h1>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€hifi mappingã€‘ã€purge_dupsã€‘</title>
    <link href="/GeekFocus/2022/03/18/2022-03-18-purgedups/"/>
    <url>/GeekFocus/2022/03/18/2022-03-18-purgedups/</url>
    
    <content type="html"><![CDATA[<p>purge haplotigs and overlaps in an assembly based on read depth</p><span id="more"></span><p><a href="https://github.com/dfguan/purge_dups">https://github.com/dfguan/purge_dups</a></p><h1 id="overview"><a href="#overview" class="headerlink" title="overview"></a>overview</h1><p>purge_dups is designed to remove haplotigs and contig overlaps in a <em>de novo</em> assembly based on read depth.</p><p><img src="/GeekFocus/2022-03-18-purgedups/1.png" alt="img"><br><img src="/GeekFocus/img/2022-03-18-purgedups/1.png" alt="img"></p><p><code>purge_dups</code>æ ¹æ®readæ·±åº¦åˆ†æç»„è£…ä¸­haplotigså’Œoverlapsã€‚ç›¸å¯¹äº<code>purge_haplotigs</code>ï¼Œè¿è¡Œé€Ÿåº¦æ›´å¿«ï¼Œè€Œä¸”<strong>è‡ªåŠ¨ç¡®å®šé˜ˆå€¼</strong>ã€‚</p><p><code>purge_dups</code>åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œ<strong>ç¬¬ä¸€éƒ¨åˆ†</strong>æ˜¯å°†åºåˆ—<strong>å›è´´</strong>åˆ°åŸºå› ç»„å¹¶åˆ†æ<strong>è¦†ç›–åº¦ç¡®å®šé˜ˆå€¼</strong>ï¼Œ<strong>ç¬¬äºŒéƒ¨åˆ†</strong>æ˜¯å°†<strong>ç»„è£…è‡ªæˆ‘æ¯”å¯¹</strong>ï¼Œ<strong>ç¬¬ä¸‰éƒ¨åˆ†</strong>æ˜¯åˆ©ç”¨å‰ä¸¤éƒ¨åˆ†å¾—åˆ°çš„ä¿¡æ¯<strong>é‰´å®š</strong>åŸæ¥åºåˆ—ä¸­çš„<strong>haplotigså’Œoverlaps</strong>.</p><h1 id="Directory-Structure"><a href="#Directory-Structure" class="headerlink" title="Directory Structure"></a>Directory Structure</h1><ul><li>scripts&#x2F;pd_config.py: script to generate a configuration file used by run_purge_dups.py.</li><li>scripts&#x2F;run_purge_dups.py: script to run the <strong>purge_dups pipeline</strong>.</li><li>scripts&#x2F;run_busco: script to run busco, dependency: busco.</li><li>scripts&#x2F;run_kcm: script to make k-mer comparison plot.</li><li>scripts&#x2F;sub.sh: shell script to submit a <strong>farm</strong> job.</li><li>src: purge_dups source files.</li><li><font color="blue"><strong>src&#x2F;split_fa</strong></font>: split fasta file by â€˜Nâ€™s.</li><li><font color="blue"><strong>src&#x2F;pbcstat</strong></font>: create <strong>read depth histogram and base-level read depth</strong> for an assembly based on <strong>pacbio</strong> data.</li><li><font color="blue"><strong>src&#x2F;ngstat</strong></font>: create read depth histogram and base-level read detph for an assembly based on <strong>illumina</strong> data.</li><li><font color="blue"><strong>src&#x2F;calcuts</strong></font>: <strong>calculate coverage cutoffs</strong>.</li><li><font color="blue"><strong>src&#x2F;purge_dups</strong></font>: <strong>purge haplotigs and overlaps</strong> for an <strong>assembly</strong>.</li><li><font color="blue"><strong>src&#x2F;get_seqs</strong></font>: <strong>obtain seqeuences after purging</strong>.</li><li>bin&#x2F;* : all purge_dups excutables.</li></ul><h1 id="installation"><a href="#installation" class="headerlink" title="installation"></a>installation</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">git <span class="hljs-built_in">clone</span> https://github.com/dfguan/purge_dups.git<br><span class="hljs-built_in">cd</span> purge_dups/src &amp;&amp; make<br><span class="hljs-comment">#è„šæœ¬åœ¨scriptsç›®å½•ï¼Œç¼–è¯‘ç¨‹åºåœ¨binç›®å½•</span><br></code></pre></td></tr></table></figure><h1 id="Pipeline-Guide"><a href="#Pipeline-Guide" class="headerlink" title="Pipeline Guide"></a>Pipeline Guide</h1><p>Given a primary assembly <em><strong>pri_asm</strong></em> and an alternative assembly <em><strong>hap_asm</strong></em> (<strong>optional</strong>, if you have one), follow the steps shown below to build your own purge_dups pipeline, steps with same number can be run simultaneously. Among all the steps, although <strong>step 5 is optional</strong>, we <strong>highly recommend</strong> our users to do so, because <strong>assemblers may produce overrepresented seqeuences</strong>. In such a case, The final <strong>step 5</strong> can be applied to <strong>remove those seqeuences</strong>.</p><h2 id="Step-1-Run-minimap2-to-align-pacbio-data-and-generate-paf-files-then-calculate-read-depth-histogram-and-base-level-read-depth-æ ¹æ®è¦†ç›–åº¦è®¡ç®—åˆ†ç•Œç‚¹-cutoff"><a href="#Step-1-Run-minimap2-to-align-pacbio-data-and-generate-paf-files-then-calculate-read-depth-histogram-and-base-level-read-depth-æ ¹æ®è¦†ç›–åº¦è®¡ç®—åˆ†ç•Œç‚¹-cutoff" class="headerlink" title="Step 1. Run minimap2 to align pacbio data and generate paf files, then calculate read depth histogram and base-level read depth. æ ¹æ®è¦†ç›–åº¦è®¡ç®—åˆ†ç•Œç‚¹(cutoff)"></a>Step 1. Run minimap2 to align pacbio data and generate paf files, then calculate read depth histogram and base-level read depth. æ ¹æ®è¦†ç›–åº¦è®¡ç®—åˆ†ç•Œç‚¹(cutoff)</h2><p>For PacBio CLR reads</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">$pb_list</span><br><span class="hljs-keyword">do</span><br>minimap2 -xmap-pb <span class="hljs-variable">$pri_asm</span> <span class="hljs-variable">$i</span> | gzip -c - &gt; <span class="hljs-variable">$i</span>.paf.gz<br><span class="hljs-keyword">done</span><br>bin/pbcstat *.paf.gz (produces PB.base.cov and PB.<span class="hljs-built_in">stat</span> files)<br>bin/calcuts PB.<span class="hljs-built_in">stat</span> &gt; cutoffs 2&gt;calcults.log<br></code></pre></td></tr></table></figure><p><strong>For PacBio CCS reads</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># gzipå¯ä»¥æ›¿æ¢æˆpigz, è¿›è¡Œå¤šçº¿ç¨‹å‹ç¼©</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">$pb_list</span><br><span class="hljs-keyword">do</span><br>minimap2 -xasm20 <span class="hljs-variable">$pri_asm</span> <span class="hljs-variable">$i</span> | gzip -c - &gt; <span class="hljs-variable">$i</span>.paf.gz<br><span class="hljs-keyword">done</span><span class="hljs-comment"># ç»Ÿè®¡paf, è¾“å‡ºPB.base.covå’ŒPB.statæ–‡ä»¶</span><br>bin/pbcstat *.paf.gz (produces PB.base.cov and PB.<span class="hljs-built_in">stat</span> files)<br>bin/calcuts PB.<span class="hljs-built_in">stat</span> &gt; cutoffs 2&gt;calcults.log<br></code></pre></td></tr></table></figure><p><strong>Notice</strong> If you have a large genome, please set minimap2 <code>-I</code> option to ensure the genome can be indexed once, otherwise read depth can be wrong.</p><p>äºŒä»£æµ‹åºï¼Œç”¨<code>bwa mem</code>è¿›è¡Œæ¯”å¯¹ï¼Œç„¶åç”¨<code>bin/ngscstat</code>ç»Ÿè®¡bamè¦†ç›–åº¦ï¼Œç„¶åç”¨<code>bin/calcuts</code>è®¡ç®—åˆ†ç•Œç‚¹ã€‚</p><h2 id="Step-2-Split-an-assembly-and-do-a-self-self-alignment-Commands-are-following"><a href="#Step-2-Split-an-assembly-and-do-a-self-self-alignment-Commands-are-following" class="headerlink" title="Step 2. Split an assembly and do a self-self alignment. Commands are following:"></a>Step 2. Split an assembly and do a self-self alignment. Commands are following:</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#å°†assemblyã€ä»Nå¤„æ‰“æ–­ã€‘ï¼Œå¦‚æœassemblyä¸­æ²¡æœ‰Nå°±ä¸æ‰“æ–­ï¼Œç„¶åç”¨minimap2è¿›è¡Œcontigè‡ªæˆ‘æ¯”å¯¹ã€‚</span><br><span class="hljs-comment"># Split an assembly</span><br>bin/split_fa <span class="hljs-variable">$pri_asm</span> &gt; <span class="hljs-variable">$pri_asm</span>.<span class="hljs-built_in">split</span><br><span class="hljs-comment"># do a self-self alignment</span><br>minimap2 -xasm5 -DP <span class="hljs-variable">$pri_asm</span>.<span class="hljs-built_in">split</span> <span class="hljs-variable">$pri_asm</span>.<span class="hljs-built_in">split</span> | gzip -c - &gt; <span class="hljs-variable">$pri_asm</span>.split.self.paf.gz<br></code></pre></td></tr></table></figure><p>run step1&amp;step2 simultaneously</p><h2 id="Step-3-Purge-haplotigs-and-overlaps-with-the-following-command"><a href="#Step-3-Purge-haplotigs-and-overlaps-with-the-following-command" class="headerlink" title="Step 3. Purge haplotigs and overlaps with the following command."></a>Step 3. Purge haplotigs and overlaps with the following command.</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">æ ¹æ®æ¯ä¸ªç¢±åŸºè¦†ç›–åº¦ä»¥åŠç»„è£…è‡ªæˆ‘æ¯”å¯¹ç»“æœå¯¹contigåˆ†ç±»<br><span class="hljs-comment"># purge haplotigs and overlap</span><br>bin/purge_dups -2 -T cutoffs -c PB.base.cov <span class="hljs-variable">$pri_asm</span>.split.self.paf.gz &gt; dups.bed 2&gt; purge_dups.log<br></code></pre></td></tr></table></figure><p>dups.bed<strong>ç¬¬å››åˆ—</strong>æ˜¯æ¯ä¸ª<strong>contigçš„åˆ†ç±»ä¿¡æ¯</strong>ï¼Œåˆ†ä¸º**â€JUNKâ€, â€œHIGHCOVâ€, â€œHAPLOTIGâ€, â€œPRIMARYâ€, â€œREPEATâ€, â€œOVLPâ€** 6ç±»ï¼Œ<code>purge_dups</code>å¯ä»¥å…ˆä»¥é»˜è®¤å‚æ•°è¿è¡Œï¼Œå¦‚æœç»“æœä¸ç†æƒ³ï¼Œå¯ä»¥è°ƒæ•´å¦‚ä¸‹å‚æ•°</p><ul><li><code>-f</code>é»˜è®¤æ˜¯.8, æ ¹æ®80%åŒºåŸŸçš„è¦†ç›–åº¦æ¥å¯¹contigè¿›è¡Œåˆ†ç±»ã€‚ä¾‹å¦‚80%çš„åŒºåŸŸéƒ½ä½äº5xï¼Œå°†è¯¥åºåˆ—å®šä¹‰ä¸ºJUNKã€‚å¯¹åº”æºç ä¸­çš„<code>classify_seq</code>å‡½æ•°çš„<code>min_frac</code>å‚æ•°</li><li><code>-a</code>å’Œ<code>-b</code>è¿‡æ»¤alignment, å¯¹äºæºç ä¸­çš„<code>flt_by_bm_mm</code>çš„<code>min_bmf</code>å’Œ<code>min_mmf</code>å‚æ•°</li><li><code>-m</code>è¡¨ç¤ºå°†ä¸¤ä¸ªè”é…è¡”æ¥æ—¶ï¼Œæœ€ä½çš„åŒ¹é…ç¢±åŸºæ•°</li><li><code>-M</code>å’Œ<code>-G</code>:åˆ†åˆ«è¡¨ç¤ºç¬¬ä¸€è½®å’Œç¬¬äºŒè½®å°†å‰åä¸¤ä¸ªè”é…è¡”æ¥æ—¶æœ€å¤§ç©ºç¼ºå¤§å°</li><li><code>-E</code>è¡¨ç¤º å¦‚æœåˆå¹¶ä¹‹åçš„alignmentåœ¨contigæœ«å°¾çš„å‰15kå†…ï¼Œé‚£ä¹ˆå°±æŠŠalignmentå»¶ä¼¸è‡³contigæœ«å°¾</li><li><code>-l</code>: ç”¨äºæ§åˆ¶overlapçš„å¤§å°ï¼Œè¯¥å€¼è¶Šå°ï¼Œoverlapè¶Šå¤š</li></ul><h2 id="Step-4-Get-purged-primary-and-haplotig-sequences-from-draft-assembly"><a href="#Step-4-Get-purged-primary-and-haplotig-sequences-from-draft-assembly" class="headerlink" title="Step 4. Get purged primary and haplotig sequences from draft assembly."></a>Step 4. Get purged primary and haplotig sequences from draft assembly.</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">bin/get_seqs -e dups.bed <span class="hljs-variable">$pri_asm</span> <br><span class="hljs-comment"># If you also want to remove the duplications in the middle, please remove ã€`-e`ã€‘ option at your own risk, it may delete false positive duplications. For more options, please refer to `get_seqs -h`.</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„purged.faå°±æ˜¯æœ€ç»ˆç»“æœï¼Œjunk, haplotigå’Œduplicationéƒ½ä¼šåœ¨hap.faä¸­ã€‚</p><p>å¯é€‰æ­¥éª¤: å°†<strong>alternative assemblyå’Œè¾“å‡ºhap.faè¿›è¡Œåˆå¹¶</strong>ï¼Œç„¶åè¿è¡Œä¸Šé¢å››æ­¥ï¼Œå¾—åˆ°çš„<strong>purge.faå°±æ˜¯æ–°çš„alternative assembly</strong>ï¼Œè€Œ<strong>å†æ¬¡è¾“å‡ºçš„hap.faåˆ™æ˜¯junkæˆ–overrepresentedåºåˆ—</strong>ã€‚</p><p>PS: èƒ½ä¸èƒ½ç”¨æ¥è¿‡æ»¤çº¯åˆåŸºå› ç»„ç»„è£…çš„åƒåœ¾åºåˆ—å‘¢ï¼Ÿæ ¹æ®ç‰©ç§æµ‹è¯•ï¼Œè¿‡æ»¤å‰åçš„BUSCOå€¼ï¼Œå‡ ä¹æ²¡æœ‰å˜åŒ–ï¼Œmissing rateåªæé«˜äº†0.1%ï¼Œ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># è¿è¡Œå‰</span><br>C:98.8%[S:96.3%,D:2.5%],F:0.5%,M:0.7%,n:1375<br><span class="hljs-comment"># è¿è¡Œå</span><br>C:98.7%[S:96.3%,D:2.4%],F:0.5%,M:0.8%,n:1375<br></code></pre></td></tr></table></figure><p>ç”¨æ³•å¯è¡Œï¼Œä¸”Canuçš„ä½œè€…å»ºè®®ç”¨<code>purge_dups</code>å¤„ç†ï¼Œå‚è€ƒ<a href="https://links.jianshu.com/go?to=https://github.com/marbl/canu/issues/1717%23issuecomment-629644894">canu-issues-1717</a>ã€‚</p><p>ä½œè€…å°šæœªåœ¨ONTå’ŒIlluminaæ•°æ®ä¸­æµ‹è¯•è½¯ä»¶ï¼Œä½†æ˜¯ä½œè€…è®¤ä¸ºåªéœ€è¦ä¿®æ”¹<code>minimap2</code>çš„<code>-x map-pb</code>ä¸º<code>-x map-ont</code>å°±å¯ä»¥ç”¨åœ¨ONTæ•°æ®ä¸Šã€‚</p><p><strong>Notice</strong> this command will only remove haplotypic duplications at the ends of the contigs. If you also want to remove the duplications in the middle, please remove <code>-e</code> option at your own risk, it may delete false positive duplications. For more options, please refer to <code>get_seqs -h</code>.</p><h2 id="Step-5-Merge-hap-fa-and-hap-asm-and-redo-the-above-steps-to-get-a-decent-haplotig-set"><a href="#Step-5-Merge-hap-fa-and-hap-asm-and-redo-the-above-steps-to-get-a-decent-haplotig-set" class="headerlink" title="Step 5. Merge hap.fa and $hap_asm and redo the above steps to get a decent haplotig set."></a>Step 5. Merge hap.fa and $hap_asm and redo the above steps to get a decent haplotig set.</h2><h1 id="Limitation"><a href="#Limitation" class="headerlink" title="Limitation"></a>Limitation</h1><ul><li>Read depth cutoffs calculation: the coverage cutoffs can be larger for a low heterozygosity species, which causes the purged assembly size smaller than expected. In such a case, please use script&#x2F;hist_plot.py to make the histogram plot and set coverage cutoffs manually.</li><li>Repeats: purge_dups has a limited ability to process repeats.</li></ul><h1 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h1><p><strong>Q:</strong> Can I use purge_dups with <strong>short reads</strong>?</p><p><strong>A:</strong> Yes, purge_dups does have a program to process Illumina reads, itâ€™s called <strong>ngscstat</strong> under the bin directory. But I have not got time to test it. If you want to play with it, please follow this workflow:</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">bwa</span> mem <span class="hljs-variable">$pri_asm</span> <span class="hljs-variable">$sr_1</span>.fq <span class="hljs-variable">$sr_2</span>.fq | samtools view -b -o - &gt; <span class="hljs-variable">$sr</span>.bam <br>ngscstat <span class="hljs-variable">$sr</span>.bam... <span class="hljs-comment"># The program will generate two/three outputs, TX.stat and TX.base.cov which functions the same way as PB.stat and PB.base.cov respectively.  </span><br></code></pre></td></tr></table></figure><p>After you get the TX.stat and TX.base.cov file, you can following the normal purge_dups routine to clean your assembly.</p><p><strong>Q1:</strong> Can I validate the cutoffs used by purge_dups?</p><p><strong>A1:</strong> Yes, we also recommend this step. A script â€œhist_plot.pyâ€ under the scripts directory is available, you can also use it to manually select the cutoffs.</p><p><strong>Q2:</strong> How can I <strong>validate the purged assembly?</strong> Is it clean enough or overpurged?</p><p><strong>A2:</strong> There are many ways to validate the purged assembly. One way is to make a coverage plot for it which can also be <strong>hist_plot.py</strong>, the 2nd way is to run <strong>BUSCO</strong> and another way is to make a KAT plot with KAT (<a href="https://github.com/TGAC/KAT">https://github.com/TGAC/KAT</a>) or KMC (<a href="https://github.com/dfguan/KMC">https://github.com/dfguan/KMC</a>, use this if you only have a small memory machine) if short reads or some accurate reads are available.</p><p><strong>Q3:</strong> Why do I get <strong>much fewer haplotypic duplications</strong> than expected?</p><p><strong>A3:</strong> First check the original contig names, they should not contain any colons. Then check the cutoffs, if purge_dups automatically use <strong>a fairly low read depth for haplotypic duplications</strong>, it may <strong>remove nothing</strong>. In this case, you <strong>need to set the cutoffs manually.</strong></p><p><strong>Q4:</strong> why does purge_dups remove <strong>middle sequence in a contig?</strong></p><p><strong>A4:</strong> <strong>Some of them are real, while others may not</strong>. We are currently investigating them. Please use <code>-e</code> for <code>get_seqs</code> command if you <strong>only want to remove the duplications at the ends of the contigs.</strong></p><hr><p>Ref:<a href="https://www.jianshu.com/p/e218a1192d12">https://www.jianshu.com/p/e218a1192d12</a></p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Hi-Cã€‘ã€Juiceboxã€‘</title>
    <link href="/GeekFocus/2022/03/17/2022-03-17-juicebox/"/>
    <url>/GeekFocus/2022/03/17/2022-03-17-juicebox/</url>
    
    <content type="html"><![CDATA[<p>Juicerbox guidline</p><span id="more"></span><ul><li><p>é€šè¿‡<code>File</code>-&gt;<code>open</code>å¯¼å…¥åç¼€ä¸º<code>hic</code>çš„æ–‡ä»¶æŸ¥çœ‹ï¼Œå¯å¯¼å…¥æœ¬åœ°çš„æ–‡ä»¶ï¼Œä¹Ÿå¯è¾“å…¥urlã€‚è½¯ä»¶å†…ç½®ENCODEçš„æ•°æ®é›†</p></li><li><p>è‡ªåŠ¨å±•ç¤ºæ‰€æœ‰æŸ“è‰²ä½“çš„HI-Cå›¾è°±ï¼Œé€šè¿‡å·¥å…·æ <font color="blue"><strong>é€‰æ‹©æŸ“è‰²è´¨</strong></font>ï¼Œ<font color="blue"><strong>è°ƒæ•´åˆ†è¾¨ç‡</strong></font>ï¼Œå¯¹äº¤äº’çŸ©é˜µ<font color="blue"><strong>å½’ä¸€åŒ–</strong></font>ï¼Œè°ƒæ•´æ˜¾ç¤ºçš„æŸ“è‰²è´¨åŒºåŸŸã€‚ä»¥17å·æŸ“è‰²è´¨ä½“ä¸ºä¾‹ï¼Œåœ¨<code>Chromosomes</code>ä¸€æ ä¸­ï¼Œä¸¤åˆ—éƒ½é€‰æ‹©17å·æŸ“è‰²ä½“ï¼Œä»£è¡¨äº¤äº’çŸ©é˜µçš„è¡Œå’Œåˆ—éƒ½æ˜¯17å·æŸ“è‰²ä½“ï¼Œç„¶åç‚¹å‡»åˆ·æ–°ï¼Œç»“æœå¦‚ä¸‹</p></li></ul><p><img src="/GeekFocus/2022-03-17-juicebox/1.png" alt="img"><br><img src="/GeekFocus/img/2022-03-17-juicebox/1.png" alt="img"></p><ul><li>é€šè¿‡<font color="blue"><strong>Normalization</strong></font>å·¥å…·è°ƒæ•´å½’ä¸€åŒ–æ–¹æ³•(æ¨èbanlancedï¼Ÿ)ï¼›é€šè¿‡<font color="blue"><strong>Resolution</strong></font>å·¥å…·è°ƒæ•´åˆ†è¾¨ç‡ï¼›é€šè¿‡<font color="blue"><strong>Goto</strong></font>å·¥å…·è°ƒæ•´æ˜¾ç¤ºçš„æŸ“è‰²ä½“åŒºåŸŸã€‚</li><li>é€šè¿‡ç®€å•æ“ä½œå°±å¯æŸ¥çœ‹å’Œå±•ç¤ºHi-Cå›¾è°±ï¼Œé™¤åŸºæœ¬åŠŸèƒ½å¤–ï¼Œè¿˜æ”¯æŒå¯¼å…¥<font color="blue">æ³¨é‡Šæ–‡ä»¶</font>ï¼Œé€šè¿‡<code>View</code>-&gt;<font color="blue">Show Annotation Panel</font>å¯æ‰“å¼€æ³¨é‡Šæ–‡ä»¶é¢æ¿ï¼Œæ³¨é‡Šä¿¡æ¯åˆ†<strong>1Då’Œ2D</strong>ä¸¤ç§ï¼Œ1Dä¸»è¦æŒ‡chip_seq,RNA_seqç­‰ä¿¡æ¯ï¼Œ2DæŒ‡TAD,æŸ“è‰²è´¨ç¯ç­‰ä¿¡æ¯ï¼Œé€šè¿‡<code>Load ENCODE</code>ä»¥å¯¼å…¥ENCODE<a href="https://cloud.tencent.com/solution/database?from=10680">æ•°æ®åº“</a>ä¸­çš„ä¸€ç»´æ³¨é‡Šï¼Œç¤ºæ„å¦‚ä¸‹</li></ul><p><img src="/GeekFocus/2022-03-17-juicebox/2.png" alt="img"><br><img src="/GeekFocus/img/2022-03-17-juicebox/2.png" alt="img"></p><ul><li>å‹¾é€‰éœ€è¦å¯¼å…¥çš„æ³¨é‡Šä¿¡æ¯ï¼Œé€šè¿‡Loadå¯¼å…¥</li></ul><p><img src="/GeekFocus/2022-03-17-juicebox/3.png" alt="img"><br><img src="/GeekFocus/img/2022-03-17-juicebox/3.png" alt="img"></p><ul><li>æ¯ä¸ªå¯¼å…¥çš„trackçš„é¢œè‰²ç­‰é…ç½®å¯åœ¨é¢æ¿ä¸­è°ƒæ•´</li></ul><p><img src="/GeekFocus/2022-03-17-juicebox/4.png" alt="img"><br><img src="/GeekFocus/img/2022-03-17-juicebox/4.png" alt="img"></p><ul><li>é€šè¿‡<code>Load Loops/Domain</code>å¯å¯¼å…¥2Dçš„æ³¨é‡Šä¿¡æ¯</li></ul><p><img src="/GeekFocus/2022-03-17-juicebox/5.png" alt="img"><br><img src="/GeekFocus/img/2022-03-17-juicebox/5.png" alt="img"></p><ul><li>å¯¼å…¥ååœ¨Hi-Cå›¾è°±ä¸­çœ‹åˆ°å¯¹åº”çš„æ ‡è®°</li></ul><p><img src="/GeekFocus/2022-03-17-juicebox/6.png" alt="img"><br><img src="/GeekFocus/img/2022-03-17-juicebox/6.png" alt="img"></p><p>é»„è‰²åŒºåŸŸæ ‡è®°çš„æ˜¯TAD, æµ…è“è‰²åŒºåŸŸæ ‡è®°çš„æ˜¯æŸ“è‰²è´¨ç¯ï¼Œè°ƒæ•´å¥½ä¹‹åçš„å›¾ç‰‡ä¹Ÿå¯ä»¥å¯¼å‡ºæˆPDFæˆ–è€…SVGæ ¼å¼ã€‚</p><ul><li>å¯¼å…¥asmåè“è‰²åŒºåˆ†å‡æŸ“è‰²ä½“ï¼Œç»¿è‰²åŒºåˆ†scaffold</li><li>æŒ‰ä½shifté€‰ä¸­contig</li><li>ç»¿è‰²ä¸èƒ½å¤ªç¢</li></ul><p><strong>æ“ä½œï¼š</strong></p><ul><li><p>æ‰€æœ‰çº é”™æ“ä½œéƒ½åŸºäºshifté”®</p></li><li><p>æ“ä½œä¸ç†Ÿç»ƒï¼Œä½ å¯èƒ½éœ€è¦åå¤undoå’Œredoï¼ˆå³é”®ï¼‰</p></li><li><p>é€‰æ¡†æ—¶ï¼Œä½ åªè¦åœ¨æœ¬æ¡†èŒƒå›´å†…æ‹–åŠ¨ï¼ˆæŒ‰shiftä¸è¦æ¾ï¼‰ï¼Œéƒ½ä¼šé€‰ä¸­è¿™ä¸ªæ¡†ï¼ˆé€‰ä¸­åä¸ºå¸¦é»‘é»„è‰²çš„çº¿ï¼‰ï¼Œå¹¶ä¸è¦å¾ˆç²¾ç¡®åœ°é€‰åœ¨æ¡†è¾¹ç¼˜ï¼ˆå› ä¸ºä½ æŠŠæ¡ä¸å¥½ï¼Œæœ‰å¯èƒ½è¿™ä¸ªè¾¹ç¼˜æ˜¯å¦ä¸€ä¸ªæ¡†çš„èŒƒå›´ï¼Œè¿™æ—¶å°±ä¼šé€‰é”™ï¼‰</p></li><li><p>é€‰æ‹©æ¡†æ—¶ï¼Œå°½å¯èƒ½æ”¾å¤§ï¼ˆåŒå‡»ï¼Œæˆ–èœå•æ BPï¼Œä¸€èˆ¬25kb-50kbï¼‰</p></li><li><p>å¦‚æœä½ çš„æŸ“è‰²ä½“æ•°ç›®ä¸å¯¹ã€‚æ‹†åˆ†æŸ“è‰²ä½“ï¼šå…ˆé€‰ä¸­è¦æ‹†åˆ†åŒºåŸŸï¼Œå³å‡»addæŸ“è‰²ä½“ï¼Œå†é€‰ä¸­ï¼Œå³å‡»removeæŸ“è‰²ä½“</p></li></ul><ul><li>ä»æŸä¸€ä¸ªåœ°æ–¹å‰ªæ‰æ¡†ï¼šé€‰ä¸­ï¼Œå‡ºç°å‰ªåˆ€ç¬¦å·ï¼Œå•å‡»</li><li>æ—‹è½¬æ¡†ï¼šé€‰ä¸­ï¼Œå‡ºç°æ—‹è½¬ç¬¦å·ï¼Œå•å‡»</li><li>ä»ä¸€ä¸ªåœ°æ–¹ç§»åŠ¨ï¼šé€‰ä¸­ï¼Œé¼ æ ‡ç§»åˆ°è¦æ’å…¥çš„contigæ¡†é¡¶ç‚¹ï¼Œå•å‡»</li></ul><p>Juice_boxè°ƒå›¾æ˜¯ä¸ªç»†è‡´çš„ä½“åŠ›æ´»ã€‚ä¸€æƒ³åˆ°æˆ‘çš„åŸºå› ç»„æ˜¯è¿™ä¹ˆäººä¸ºè°ƒå‡ºæ¥çš„ï¼Œæˆ‘è‡ªå·±å¯¹ç»“æœéƒ½äº§ç”Ÿäº†æ€€ç–‘ã€‚å¦‚æœæ˜¯3D-DNAï¼Œå†ç®€å•çš„åŸºå› ç»„ä¹Ÿè¿˜æ˜¯ä¼šæœ‰å¾ˆå¤šç¢çš„ï¼Œå› ä¸ºå®ƒæ‰‹è´±é‡æ–°æ‰“ç¢äº†ã€‚æ‰€ä»¥è¯´å¦‚æœä½ åŸå§‹ç»„è£…çš„contigæ•°ç›®æ¯”3d-dnaè·‘å‡ºçš„FINAL.fastaä¸­çš„contigæ•°ç›®å°‘ï¼Œç”šè‡³æ¯”æ‰‹å·¥çº é”™åå†è·‘3D-DNAçš„æ•°ç›®å°‘ï¼Œä¹Ÿä¸è¦æ„Ÿåˆ°æƒŠè®¶ã€‚åæ­£æˆ‘æ˜¯è¶Šçº è¶Šå·®ï¼ŒåŸºå› ç»„è¶Šæ¥è¶Šå°ã€‚å¯èƒ½æ˜¯æˆ‘ä¸ä¼šè°ƒç»†èŠ‚å§ï¼Œå†æ¬¡åæ§½ï¼Œè¿™ä¸ªè½¯ä»¶æˆ‘æ˜¯çœŸçš„è®¨åŒã€‚</p><hr><p>ref <a href="https://www.jianshu.com/p/4483eece598d">https://www.jianshu.com/p/4483eece598d</a></p><p>æ³¨æ„äº‹é¡¹ï¼š</p><ol><li>Juiceboxçš„ç¼–è¾‘åŠŸèƒ½åœ¨å¯¼å…¥äº†assemblyæ–‡ä»¶åæ”¾å¤§scaffoldå—ï¼Œæ”¾å¤§åˆ°è¶³å¤Ÿå¤§çš„æ—¶å€™æ‰èƒ½å‡ºç°ç¼–è¾‘çš„å‰ªåˆ€ï¼Œè¿›è¡Œåˆ†å‰²æŸ“è‰²ä½“åŒºåŸŸ</li><li>å¦‚æœè¦å»æ‰æŸäº›æ•£åœ¨åŒºå—ä¸­çš„ç©ºç™½åŒºåŸŸåˆ™éœ€è¦æ”¾å¤§åˆ°è¶³å¤Ÿå¤§åï¼Œç”¨shift+å·¦é”®é€‰ä¸­ç©ºç™½çš„åŒºåŸŸè¿›è¡Œå‰ªåˆ‡å»æ‰</li><li>è¿™äº›éœ€è¦å‰ªåˆ‡çš„ç©ºç™½åŒºåŸŸå…¶å®æ˜¯è¡¨æ˜è¿™äº›contigå’Œè°éƒ½æ²¡æœ‰å…³è”ï¼Œä¼šåœ¨1-3.hicçš„æ­¥éª¤ä¸­è¢«å»é™¤ï¼Œç›¸åº”çš„æœ€ç»ˆçš„.hicæ–‡ä»¶å¾—åˆ°çš„hicç»„è£…ç»“æœèƒ½æŒ‚è½½åˆ°çš„åŸºå› ä¼šå‡å°‘</li></ol><ul><li><strong>ä½†æ˜¯å¦‚æœ0.hicçš„ç»“æœå¤ªå·®ï¼Œå¯ä»¥è¯•ç”¨3.hicçš„ç»“æœï¼Œä¹Ÿè®¸ä¼šæ›´å¥½ï¼Œæœ‰æå‡åŠŸèƒ½ï¼Œå¦‚æœæŒ‚è½½çš„åŸºå› ä¸å¤ªå°‘çš„è¯ï¼Œä¼šå¾ˆå¥½</strong></li></ul><ol start="4"><li>hicçš„æœ€ç»ˆassemblyæ˜¯ï¼ˆrawchrom.assemblyï¼‰</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-number">00</span><span class="hljs-selector-class">.nextpolish</span><span class="hljs-selector-class">.final</span><span class="hljs-selector-class">.assembly</span> -&gt; <span class="hljs-number">00</span><span class="hljs-selector-class">.nextpolish</span><span class="hljs-selector-class">.rawchrom</span><span class="hljs-selector-class">.assembly</span><br></code></pre></td></tr></table></figure><ol start="5"><li>é€šå¸¸æ¥è®²ï¼Œç”¨0.hicå¯¹åº”çš„ç»“æœå»è¿›è¡ŒæŸ“è‰²ä½“åŒºå—ç¼–è¾‘åå†è¿›è¡ŒæŸ“è‰²ä½“æ°´å¹³çš„åŸºå› ç»„ç»„è£…<code>run-asm-pipeline-post-review.sh</code>ï¼Œå¾—åˆ°fastaçš„æ–‡ä»¶ï¼Œç„¶åå†é€šè¿‡å·²ç»æ³¨é‡Šçš„contigç‰ˆæœ¬çš„åŸºå› ç»„åŸºå› çš„åæ ‡ä¿¡æ¯ï¼Œå¯¹åº”ä¸ŠæŸ“è‰²ä½“æ°´å¹³çš„åŸºå› ç»„åŸºå› ä¿¡æ¯</li></ol><p>ï¼Ÿå…³äºALLHiCç»„è£…ï¼Œå¯ä»¥ç”¨3d-dnaå¾—åˆ°çš„æœ€ç»ˆåŸºå› ç»„fastaç»“æœå†ç”¨ALLHiCè¿›è¡Œç»„è£…ï¼Œç›¸å½“äºåŸºå› ç»„å·²ç»ç»è¿‡äº†3d-dnaçš„çº é”™ï¼Œå¾—åˆ°çš„å¯èƒ½æ˜¯æ›´åŠ å‡†ç¡®çš„åŒ…å«Nçš„åŸºå› ç»„åºåˆ—ï¼Œå†ç»è¿‡ALLHiCè¿›è¡Œæ‰“æ–­å»é™¤Nï¼Œå¾—åˆ°æ›´å¥½çš„ç»“æœ</p><hr><p><a href="https://www.bilibili.com/video/BV1ph411X7wj">https://www.bilibili.com/video/BV1ph411X7wj</a></p><p><img src="/GeekFocus/2022-03-17-juicebox/7.png" alt="img"><br><img src="/GeekFocus/img/2022-03-17-juicebox/7.png" alt="img"></p><p><strong>1. æŒ‚è½½ç‡</strong></p><p><img src="/GeekFocus/2022-03-17-juicebox/8.png" alt="img"><br><img src="/GeekFocus/img/2022-03-17-juicebox/8.png" alt="img"></p><p><strong>2. åŸºå› ç»„è‰å›¾ä¸­ç»„è£…é”™è¯¯å¤ªå¤š</strong></p><p><img src="/GeekFocus/2022-03-17-juicebox/9.png" alt="img"><br><img src="/GeekFocus/img/2022-03-17-juicebox/9.png" alt="img"></p><p><strong>3. æ ·æœ¬æ‚è´¨æ±¡æŸ“</strong></p><p><img src="/GeekFocus/2022-03-17-juicebox/10.png" alt="img"><br><img src="/GeekFocus/img/2022-03-17-juicebox/10.png" alt="img"></p><p><strong>4. é«˜æ‚åˆåŸºå› ç»„</strong></p><p><img src="/GeekFocus/2022-03-17-juicebox/11.png" alt="img"><br><img src="/GeekFocus/img/2022-03-17-juicebox/11.png" alt="img"></p><p>HiCç»„è£…åç»­</p><p><img src="/GeekFocus/2022-03-17-juicebox/12.png" alt="img"><br><img src="/GeekFocus/img/2022-03-17-juicebox/12.png" alt="img"></p><p>ä¸¤ä¸ªcontigä¹‹é—´å¯èƒ½æ˜¯ç”±500ä¸ªNè¿æ¥ï¼Œhicå…³ç³»å†³å®š</p><blockquote><p>Q: 3D-DNA åçš„ç»“æœæ–‡ä»¶å¯ç»§ç»­ç”¨äºALLHiC</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Hi-Cã€‘ã€Lachesisã€‘</title>
    <link href="/GeekFocus/2022/03/17/2022-03-17-LACHESIS/"/>
    <url>/GeekFocus/2022/03/17/2022-03-17-LACHESIS/</url>
    
    <content type="html"><![CDATA[<p>Lachesis</p><span id="more"></span><p><a href="https://www.plob.org/article/24852.html">https://www.plob.org/article/24852.html</a></p><p><strong>æŸ“è‰²ä½“ç–†åŸŸ</strong></p><p>æŸ“è‰²è´¨åœ¨ç»†èƒæ ¸å†…åˆ†å¸ƒçš„å¹¶ä¸æ˜¯éšæœºåˆ†å¸ƒçš„ï¼Œè€Œæ˜¯ä¸åŒæŸ“è‰²ä½“å æ®ä¸åŒçš„ç©ºé—´ã€‚</p><p><img src="/GeekFocus/2022-03-17-LACHESIS/1.png"><br><img src="/GeekFocus/img/2022-03-17-LACHESIS/1.png" alt="ä¸‰ç»´åŸºå› ç»„æŠ€æœ¯ï¼ˆäºŒï¼‰ï¼šHi-Cè¾…åŠ©ç»„è£…ä¸Lachesisçš„ä½¿ç”¨"></p><p><strong>Hi-Cå®éªŒåŸç†</strong></p><p><img src="/GeekFocus/2022-03-17-LACHESIS/2.png"><br><img src="/GeekFocus/img/2022-03-17-LACHESIS/2.png" alt="ä¸‰ç»´åŸºå› ç»„æŠ€æœ¯ï¼ˆäºŒï¼‰ï¼šHi-Cè¾…åŠ©ç»„è£…ä¸Lachesisçš„ä½¿ç”¨"></p><p><strong>åŸºå› ç»„äº’ä½œè¡°å‡</strong></p><p>æŸ“è‰²ä½“å†…äº’ä½œå¼ºåº¦è¾ƒå¼ºï¼Œä½†ä¹Ÿéšç€ç©ºé—´è·ç¦»çš„å¢å¤§äº’ä½œå¼ºåº¦åœ¨è¡°å‡ã€‚äº’ä½œä¸‰å®šå¾‹</p><ul><li>1.<strong>æŸ“è‰²ä½“å†…äº’ä½œå¯Œé›†</strong>ï¼ˆIntrachromosomal interaction enrichmentï¼‰</li><li>2.<strong>äº’ä½œéšè·ç¦»è¡°å‡</strong>ï¼ˆdistance-dependent interaction decayï¼‰</li><li>3.<strong>å±€éƒ¨äº’ä½œå¹³æ»‘</strong>ï¼ˆlocal interaction smoothnessï¼‰</li></ul><p><strong>Hic ä¼˜åŠ¿</strong></p><ul><li>é€šè¿‡Scaffoldé—´çš„äº¤äº’é¢‘ç‡å¤§å°ï¼Œå¯ä»¥å¯¹å·²ç»„è£…çš„åŸºå› ç»„åºåˆ—è¿›è¡Œçº é”™ã€‚</li><li>åŸºå› ä¿¡æ¯ä¸å†ä»…ä»…æ˜¯contigç‰‡æ®µï¼Œè€Œæ˜¯è¢«åˆ’åˆ†è‡³æŸ“è‰²ä½“ä¸Šï¼Œæˆä¸ºæŸ“è‰²ä½“æ°´å¹³ã€‚</li><li>æ— éœ€è¾›è‹¦çš„æ„å»ºç¾¤ä½“ï¼Œå•ä¸€ä¸€ä¸ªä½“å°±èƒ½å®ç°æŸ“è‰²ä½“å®šä½ã€‚</li><li>ç›¸æ¯”é—ä¼ å›¾è°±ï¼Œæ ‡è®°å¯†åº¦æ›´å¤§ï¼Œåºåˆ—å®šä½æ›´å®Œæ•´ã€‚</li><li>å¯ä»¥å¼€å±•æŸ“è‰²ä½“é‡æ’ç­‰ç»“æ„å˜å¼‚ç ”ç©¶ã€‚</li><li>QTLã€GWASå¯ä»¥å®šä½åŒºé—´åˆ°æŸä¸ªæŸ“è‰²ä½“ã€‚</li><li>å¯ä»¥è§£æè¯¥ç‰©ç§çš„ä¸‰ç»´åŸºå› ç»“æ„ã€æŸ“è‰²ä½“äº’ä½œåŠåŠ¨æ€å˜åŒ–ã€‚</li></ul><p><strong>HiCè¾…åŠ©ç»„è£…</strong></p><p>å°†contigsç»„è£…åˆ°<strong>å‡æŸ“è‰²ä½“</strong>å±‚é¢ï¼Œå®ç°åŸºå› ç»„ç»„è£…åˆ°æŸ“è‰²ä½“å±‚é¢</p><p><strong>Lachesisè¾…åŠ©ç»„è£…æ­¥éª¤</strong></p><ul><li>**Cluster(èšç±»)**ã€‚å› ä¸ºæŸ“è‰²è´¨å†…çš„äº’ ä½œå¼ºåº¦è¦é«˜äºæŸ“è‰²è´¨é—´çš„äº’ä½œå¼ºåº¦ï¼Œæ‰€ ä»¥å…ˆå¯¹contig&#x2F;scaffoldè¿›è¡Œèšç±»æˆæŸ“è‰²ä½“ç¾¤ã€‚</li><li>**Order(æ’åº)**ã€‚ç¡®å®šæ¯ä¸ªæŸ“è‰²ä½“ç¾¤ä¸­contig&#x2F;scaffoldçš„é¡ºåº</li><li>**Orient(å®šå‘)**ã€‚ç¡®å®šæ¯ä¸ª contig&#x2F;scaffoldçš„æ–¹å‘ä¸‰ä¸ªæ­¥éª¤æŒ‰ç…§äº’ä½œå¼ºåº¦ä¾æ¬¡</li></ul><p><img src="/GeekFocus/2022-03-17-LACHESIS/3.png"><br><img src="/GeekFocus/img/2022-03-17-LACHESIS/3.png" alt="ä¸‰ç»´åŸºå› ç»„æŠ€æœ¯ï¼ˆäºŒï¼‰ï¼šHi-Cè¾…åŠ©ç»„è£…ä¸Lachesisçš„ä½¿ç”¨"></p><p><strong>clusterèšç±»åŸç†</strong></p><p><img src="/GeekFocus/2022-03-17-LACHESIS/4.png"><br><img src="/GeekFocus/img/2022-03-17-LACHESIS/4.png" alt="ä¸‰ç»´åŸºå› ç»„æŠ€æœ¯ï¼ˆäºŒï¼‰ï¼šHi-Cè¾…åŠ©ç»„è£…ä¸Lachesisçš„ä½¿ç”¨"></p><p><strong>orderæ’åºåŸç†</strong></p><p><img src="/GeekFocus/2022-03-17-LACHESIS/5.png"><br><img src="/GeekFocus/img/2022-03-17-LACHESIS/5.png" alt="ä¸‰ç»´åŸºå› ç»„æŠ€æœ¯ï¼ˆäºŒï¼‰ï¼šHi-Cè¾…åŠ©ç»„è£…ä¸Lachesisçš„ä½¿ç”¨"></p><p><strong>orientå®šå‘åŸç†</strong></p><p><img src="/GeekFocus/2022-03-17-LACHESIS/6.png"><br><img src="/GeekFocus/img/2022-03-17-LACHESIS/6.png" alt="ä¸‰ç»´åŸºå› ç»„æŠ€æœ¯ï¼ˆäºŒï¼‰ï¼šHi-Cè¾…åŠ©ç»„è£…ä¸Lachesisçš„ä½¿ç”¨"></p><hr><p><a href="https://lxz9.com/2021/08/05/ALLHIC/">https://lxz9.com/2021/08/05/ALLHIC/</a> ALLHiC</p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Hi-Cã€‘ã€3D-DNAã€‘</title>
    <link href="/GeekFocus/2022/03/17/2022-03-17-3D-DNA/"/>
    <url>/GeekFocus/2022/03/17/2022-03-17-3D-DNA/</url>
    
    <content type="html"><![CDATA[<p>äºŒå€ä½“ç‰©ç§ç›®å‰3D-DNAåº”è¯¥æ˜¯ç»„è£…æ•ˆæœæ¯”è¾ƒå¥½çš„è½¯ä»¶ã€‚ALL-HiCå¯¹å¤šå€ä½“æ•ˆæœå¾ˆå¥½</p><span id="more"></span><h1 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h1><p>ç»„è£…ï¼ŒJuiceråˆ†æHi-Cæ•°æ®ï¼Œ3D-DNA scaffoldingï¼ŒJBAT å¯¹ç»„è£…ç»“æœæ‰‹å·¥çº æ­£ï¼Œæœ€ç»ˆå¾—åˆ°å‡†æŸ“è‰²ä½“æ°´å¹³åŸºå› ç»„ã€‚</p><p><img src="/GeekFocus/2022-03-17-3D-DNA/1.png" alt="img"><br><img src="/GeekFocus/img/2022-03-17-3D-DNA/1.png" alt="img"></p><p><strong>CPU-version juicer installation</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> ~/soft<br>git <span class="hljs-built_in">clone</span> https://github.com/theaidenlab/juicer.git<br><span class="hljs-built_in">cd</span> juicer<br><span class="hljs-built_in">ln</span> -s CPU scripts<br><span class="hljs-built_in">cd</span> scripts/common<br>wget https://hicfiles.tc4ga.com/public/juicer/juicer_tools.1.9.9_jcuda.0.8.jar<br><span class="hljs-built_in">ln</span> -s juicer_tools.1.9.9_jcuda.0.8.jar  juicer_tools.jar<br></code></pre></td></tr></table></figure><p>alignedç›®å½•ï¼Œå…¶ä¸­â€merged_nodups.txtâ€æ˜¯ä¸‹ä¸€æ­¥3D-DNAçš„è¾“å…¥æ–‡ä»¶ä¹‹ä¸€ã€‚</p><p><strong>3D-DNA installation</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> ~/soft<br>git <span class="hljs-built_in">clone</span> https://github.com/theaidenlab/3d-dna.git<br></code></pre></td></tr></table></figure><hr><p>å¦‚æœåŸºå› ç»„<strong>ä¸æ˜¯å¤æ‚åŸºå› ç»„</strong>ï¼Œæ¯”å¦‚è¯´é«˜æ‚åˆï¼Œé«˜é‡å¤åºåˆ—ï¼Œæˆ–è€…Hi-Cæ•°æ®æµ‹å¤ªå°‘ï¼Œé‚£ä¹ˆ3d-dnaçš„æµç¨‹æ›´åŠ ç®€å•, run-asm-pipeline.sh -håªæœ‰<font color="blue"><strong>å››ä¸ªå‚æ•°éœ€è¦æ”¹</strong></font>:</p><ul><li>-i|â€“input: è¿‡æ»¤é•¿åº¦ä½äºç»™å®šé˜ˆå€¼çš„contig&#x2F;scaffold, <strong>é»˜è®¤æ˜¯15000</strong></li><li>-r|â€“round: åŸºå› ç»„ä¸­misjoinçš„<strong>çº é”™è½®æ•°</strong>ï¼Œ<strong>é»˜è®¤æ˜¯2</strong>ï¼Œå½“åŸºå› ç»„<strong>æ¯”è¾ƒå‡†ç¡®</strong>ï¼Œè®¾ç½®ä¸º<strong>0</strong>ï¼Œç„¶ååœ¨JABTä¸­è°ƒæ•´ä¼šæ›´å¥½</li><li>-m|â€“mode: æ˜¯å¦è°ƒç”¨mergeæ¨¡å—ï¼Œ<strong>å½“ä¸”ä»…å½“åœ¨æ‚åˆåº¦æ¯”è¾ƒé«˜çš„æƒ…å†µä¸‹ä½¿ç”¨</strong>ï¼Œä¹Ÿå°±æ˜¯ç»„è£…ç»“æœçš„å•å€å‹åŸºå› ç»„æ˜æ˜¾åå¤§ï¼ˆå’Œé¢„æœŸestimated æ¯”è¾ƒï¼‰</li><li>-s|â€“stage: ä»polish, split, seal, merge æˆ–finalize çš„æŸä¸€ä¸ªé˜¶æ®µå¼€å§‹</li></ul><hr><p><strong>åŸºå› ç»„å¤æ‚</strong>ï¼Œéœ€è¦è°ƒæ•´å‚æ•°éå¸¸å¤š, run-asm-pipeline.sh â€“helpä¼šè¾“å‡ºæ›´å¤šçš„ä¿¡æ¯ï¼Œä½ éœ€è¦æ ¹æ®å½“å‰ç»“æœå»ç¡®å®šæ¯ä¸ªé˜¶æ®µçš„å‚æ•°åº”è¯¥å¦‚ä½•è°ƒæ•´ã€‚<br>æœ€ç»ˆçš„è¾“å‡ºæ–‡ä»¶æœ€å…³é”®çš„æ˜¯ä¸‹é¢ä¸‰ç±»:</p><ul><li>.fasta: ä»¥<strong>FINALæ ‡è®°çš„æ˜¯æœ€ç»ˆç»“æœ</strong></li><li>.hic: <strong>å„ä¸ªé˜¶æ®µ</strong>éƒ½ä¼šæœ‰è¾“å‡ºç»“æœï¼Œç”¨äºåœ¨JABTä¸­å±•ç¤º</li><li>.assembly: <strong>å„ä¸ªé˜¶æ®µ</strong>éƒ½ä¼šæœ‰è¾“å‡ºï¼Œä¸€å…±ä¸¤åˆ—ï¼Œå­˜æ”¾contigçš„ç»„è£…é¡ºåº</li></ul><hr><h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><p>Juicerçš„è¾“å‡ºç»“æœåˆ°3D-DNAï¼Œåˆ†ææµç¨‹è§ä¸‹å›¾ã€‚3D-DNAå…ˆæ ¹æ®Hi-Cæ•°æ®åˆ†æcontigä¸­çš„<strong>misjoin</strong>ï¼Œå¯¹å…¶è¿›è¡Œçº é”™ã€‚ä¹‹åé€šè¿‡å››æ­¥,åˆ†åˆ«æ˜¯Polish, Split, Sealå’ŒMerge, å¾—åˆ°æœ€ç»ˆçš„åŸºå› ç»„åºåˆ—</p><p><img src="/GeekFocus/2022-03-17-3D-DNA/2.png"><br><img src="/GeekFocus/img/2022-03-17-3D-DNA/2.png" alt="3d-dnaæµç¨‹"></p><h1 id="ä½¿ç”¨juicerboxæ‰‹å·¥çº é”™"><a href="#ä½¿ç”¨juicerboxæ‰‹å·¥çº é”™" class="headerlink" title="ä½¿ç”¨juicerboxæ‰‹å·¥çº é”™"></a>ä½¿ç”¨juicerboxæ‰‹å·¥çº é”™</h1><p>å…³äºjuicerboxçš„ç”¨æ³•ï¼Œå¯ä»¥çœ‹hoptopçš„<a href="https://links.jianshu.com/go?to=https://www.bilibili.com/video/av65134634">https://www.bilibili.com/video/av65134634</a><br>æœ€å¸¸è§çš„å‡ ç§ç»„è£…é”™è¯¯:</p><ul><li>misjoin: åˆ‡å‰²</li><li>translocations: ç§»åŠ¨</li><li>inversions: ç¿»è½¬</li><li>chromosome boundaries: ç¡®å®šæŸ“è‰²ä½“çš„è¾¹ç•Œ</li></ul><p>è¿™äº›é”™è¯¯çš„åˆ¤æ–­ä¾èµ–äºç»éªŒï¼Œæ‰€ä»¥åªèƒ½é è‡ªå·±å¤šè¯•è¯•äº†ã€‚<br>æœ€åè¾“å‡ºgenome.review.assemblyç”¨äºä¸‹ä¸€æ­¥çš„åˆ†æ</p><h1 id="å†æ¬¡è¿è¡Œ3d-dna"><a href="#å†æ¬¡è¿è¡Œ3d-dna" class="headerlink" title="å†æ¬¡è¿è¡Œ3d-dna"></a>å†æ¬¡è¿è¡Œ3d-dna</h1><p>æ ¹æ®JABTæ‰‹å·¥çº æ­£çš„ç»“æœ, genome.review.assembly, ä½¿ç”¨run-asm-pipeline-post-review.shé‡æ–°ç»„è£…åŸºå› ç»„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp">~/soft/<span class="hljs-number">3</span>d-dna/run-<span class="hljs-keyword">asm</span>-pipeline-post-review.sh \<br>    -r genome.review.assembly genome.fa aligned/merged_nodups.txt &amp;&gt; <span class="hljs-number">3</span>d.log &amp;<br></code></pre></td></tr></table></figure><p>è¿™æ¬¡ä½¿ç”¨<code>run-asm-pipeline-post-review.sh</code>è„šæœ¬ï¼Œç”¨äºåœ¨Juicebox Assembly Toolsæ¨¡å—ï¼ˆç”±review.Assemblyæ–‡ä»¶è¡¨ç¤ºï¼‰ä¸­è¿›è¡Œå®¡é˜…ï¼Œå°†ç¨‹åºé›†ï¼ˆç”±ä¹‹å‰å¯¹é½çš„Hi-C readså’ŒJuicer pipelineç”Ÿæˆçš„ï¼‰æœ€ç»ˆç¡®å®šä¸ºæŸ“è‰²ä½“é•¿åº¦çš„fastaåºåˆ—ã€‚è¯¥è„šæœ¬å°†ç”Ÿæˆä¸€ä¸ªè¾“å‡ºfastaæ–‡ä»¶ã€æœ€ç»ˆè£…é…Hi-C mapçš„assemblyæ–‡ä»¶å’Œä¸€äº›è¡¥å……æ³¨é‡Šæ–‡ä»¶ï¼Œä¾¿äºåœ¨Juiceboxä¸­æŸ¥çœ‹ç»“æœã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh">USAGE: ./run-asm-pipeline-post-review.sh [options] -r &lt;review.assembly&gt; &lt;path_to_input_fasta&gt; &lt;path_to_input_mnd&gt;<br><span class="hljs-comment"># &lt;review.assembly&gt; è¾“å…¥juiceboxè°ƒæ•´ä¹‹åå¾—åˆ°çš„genome.rawchrom.assembly</span><br><span class="hljs-comment"># &lt;path_to_input_fasta&gt; è¾“å…¥å‚è€ƒåŸºå› ç»„åºåˆ—æ–‡ä»¶</span><br><span class="hljs-comment"># &lt;path_to_input_mnd&gt; ä¹‹å‰å¾—åˆ°çš„merged_nodups.txt</span><br><span class="hljs-comment"># -r æŸ¥çœ‹â€œ.assemblyâ€æ–‡ä»¶çš„è·¯å¾„ã€‚</span><br>å¯é€‰å‚æ•°<br><span class="hljs-comment"># -i input_size æŒ‡å®šé˜ˆå€¼è¾“å…¥Contigs/scaffoldsï¼ˆé»˜è®¤å€¼ä¸º15000ï¼‰ã€‚å°äºè¾“å…¥é˜ˆå€¼çš„Contigs/scaffoldsçš„å°†è¢«å¿½ç•¥ã€‚åº”ä¸è¿è¡ŒåŸå§‹è„šæœ¬æ—¶ä½¿ç”¨çš„ç›¸åŒã€‚</span><br><span class="hljs-comment"># -g gap_size è¦åœ¨æœ€ç»ˆæŸ“è‰²ä½“é•¿åº¦æ”¯æ¶ä¸­çš„æ”¯æ¶åºåˆ—ä¹‹é—´æ·»åŠ çš„é—´éš™å¤§å°ï¼ˆé»˜è®¤å€¼ä¸º500ï¼‰ã€‚</span><br><span class="hljs-comment"># --sort-output é€‰æ‹©æŒ‰å¤§å°æŒ‰é™åºæ’åˆ—æŸ“è‰²ä½“é•¿åº¦æ”¯æ¶ã€‚</span><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">nohup</span> bash ~/software/3d-dna/run-asm-pipeline-post-review.sh -r genome.rawchrom.assembly genome.fa hic/aligned/merged_nodups.txt &amp;&gt; 3d.<span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure><p>å¾—å‡ºæœ€ç»ˆçš„æŸ“è‰²ä½“æ°´å¹³æ–‡ä»¶ genome.FINAL.fasta</p><p><strong>æœ€åä¸€æ­¥æé€Ÿ</strong></p><p>å› ä¸º<code>run-asm-pipeline-post-review.sh</code>åŸå§‹çš„é€Ÿåº¦å¤ªæ…¢äº†ã€‚æ‰€ä»¥å»ºè®®å»ä¿®æ”¹ä¸€ä¸‹æºæ–‡ä»¶å†…å®¹ï¼Œå¤§å¤§æå‡æœ€åä¸€æ­¥çš„é€Ÿåº¦ï¼Œå¯ä»¥<a href="https://hub.fastgit.org/aidenlab/3d-dna/pull/58">å‚è€ƒé“¾æ¥</a></p><h1 id="è¯„ä»·"><a href="#è¯„ä»·" class="headerlink" title="è¯„ä»·"></a>è¯„ä»·</h1><p>juicerä»£ç è‡³å°‘ä»¥ä¸‹å‡ ä¸ªåœ°æ–¹éƒ½éœ€è¦æ”¹ï¼š</p><p>ä¸´æ—¶æ–‡ä»¶ä¸åŠæ—¶åˆ é™¤<br>bwaå¾—åˆ°çš„SAMæ–‡ä»¶å¤„ç†æ–¹å¼æœ‰å¾…ä¼˜åŒ–ï¼Œä½¿ç”¨BAMèƒ½æ›´å¿«çš„å¹¶è¡Œè®¡ç®—<br>å‚æ•°å‘½ä»¤åˆ¤æ–­å¾ˆå·®ï¼Œç”¨-zåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸º0ï¼Œè€Œä¸æ˜¯ç”¨-fæˆ–-då»åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨<br>Linuxçš„sortæ”¯æŒå¤šçº¿ç¨‹ï¼Œä½†æ˜¯æ²¡çœ‹åˆ°ç”¨<br>è„šæœ¬ä¸­æœ‰äº›é™é€Ÿæ­¥éª¤çš„awkä»£ç ï¼Œä¸ç®—é«˜æ•ˆ<br>å‰ä¸¤æ¡å¯¼è‡´äº†è¿è¡Œè¿‡ç¨‹å ç”¨å¤§é‡ç¡¬ç›˜ï¼Œæ‰€ä»¥<strong>ä¸å‡†å¤‡2Tå·¦å³çš„ç¡¬ç›˜ï¼Œå¾ˆå®¹æ˜“å‡ºé”™</strong>ã€‚ç¬¬ä¸‰æ¡æ˜¯ä¸€äº›æŠ¥é”™ä¸ä¼šåŠæ—¶åœæ­¢è¿ç®—ï¼Œä¹Ÿä¸å®¹æ˜“æ’æŸ¥ã€‚ä¼°è®¡å…¬å¸ä»æ•ˆç‡è§’åº¦å‡ºå‘ï¼Œåº”è¯¥æ˜¯å†™äº†å¾ˆå¤šè„šæœ¬æ¥æ›¿æ¢åŸæ¥çš„awkè„šæœ¬</p><p>å¦å¤–ï¼Œjuiceråœ¨å¤šå€ä½“ç‰©ç§è¡¨ç°å¾ˆå·®ï¼Œå»ºè®®ä½¿ç”¨ALLHiC</p><hr><p>refï¼š<a href="https://blog.csdn.net/u012110870/article/details/115511969">https://blog.csdn.net/u012110870/article/details/115511969</a></p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Hi-Cã€‘ã€Juicerã€‘</title>
    <link href="/GeekFocus/2022/03/16/2022-03-16-juicer/"/>
    <url>/GeekFocus/2022/03/16/2022-03-16-juicer/</url>
    
    <content type="html"><![CDATA[<p>Juicer is a platform for analyzing kilobase resolution Hi-C data. In this distribution, we include the pipeline for <strong>generating Hi-C maps from fastq raw data</strong> files and <strong>command line tools for feature annotation on the Hi-C maps</strong>.</p><span id="more"></span><p><a href="https://github.com/aidenlab/juicer">https://github.com/aidenlab/juicer</a></p><h1 id="Read-this-first"><a href="#Read-this-first" class="headerlink" title="Read this first!!"></a>Read this first!!</h1><p>To access Juicer 1.6 (last <strong>stable</strong> release), please see <a href="https://github.com/aidenlab/juicer/releases/tag/1.6">the Github Release</a>. If you clone the Juicer repo directly from Github, it will clone Juicer 2, which is under active development. If you encounter any bugs, please let us know.</p><h1 id="About-Juicer"><a href="#About-Juicer" class="headerlink" title="About Juicer"></a>About Juicer</h1><p>Juicer is a platform for analyzing kilobase resolution Hi-C data. In this distribution, we include the pipeline for <strong>generating Hi-C maps from fastq raw data files</strong> and <strong>command line tools for feature annotation on the Hi-C maps</strong>.</p><p><strong>If you use Juicer in your research, please cite: Neva C. Durand, Muhammad S. Shamim, Ido Machol, Suhas S. P. Rao, Miriam H. Huntley, Eric S. Lander, and Erez Lieberman Aiden. â€œJuicer provides a one-click system for analyzing loop-resolution Hi-C experiments.â€ Cell Systems 3(1), 2016.</strong></p><h1 id="Documentation"><a href="#Documentation" class="headerlink" title="Documentation"></a>Documentation</h1><p>Please see <a href="https://github.com/aidenlab/juicer/wiki">the wiki</a> for extensive documentation.</p><h1 id="Questions"><a href="#Questions" class="headerlink" title="Questions?"></a>Questions?</h1><p>For FAQs, or for asking new questions, please see our forum: <a href="http://aidenlab.org/forum.html">aidenlab.org&#x2F;forum.html</a>.</p><hr><h2 id="Distribution"><a href="#Distribution" class="headerlink" title="Distribution"></a>Distribution</h2><p>In this repository, we include the scripts for running Juicer on AWS, LSF, Univa Grid Engine, SLURM, and a single CPU</p><p>&#x2F;AWS - scripts for running pipeline and postprocessing on AWS</p><p>&#x2F;UGER - scripts for running pipeline and postprocessing on UGER (Univa)</p><p>&#x2F;SLURM - scripts for running pipeline and postprocessing on SLURM</p><p>&#x2F;LSF - scripts for running pipeline and postprocessing on LSF <strong>BETA</strong></p><p>&#x2F;CPU - scripts for running pipeline and postprocessing on a single CPU <strong>BETA</strong></p><p>&#x2F;misc - miscellaneous helpful scripts</p><hr><h2 id="Hardware-and-Software-Requirements"><a href="#Hardware-and-Software-Requirements" class="headerlink" title="Hardware and Software Requirements"></a>Hardware and Software Requirements</h2><p>Juicer is a pipeline optimized for parallel computation on a cluster. Juicer consists of two parts: <strong>the pipeline that creates Hi-C files from raw data</strong>, and <strong>the post-processing command line tools</strong>.</p><h3 id="Cluster-requirements"><a href="#Cluster-requirements" class="headerlink" title="Cluster requirements:"></a>Cluster requirements:</h3><p>Juicer requires the use of a cluster, with <strong>ideally &gt;&#x3D; 4 cores</strong> (min 1 core) and <strong>&gt;&#x3D; 64 GB RAM</strong> (min 16 GB RAM)</p><p>Juicer currently works with the following resource management software:</p><ul><li><a href="http://www.openlava.org/">OpenLava</a></li><li><a href="https://www.ibm.com/systems/spectrum-computing/products/lsf">LSF</a></li><li><a href="https://slurm.schedmd.com/download.html">SLURM</a></li><li>GridEngine (Univa, etc. any flavor)</li></ul><h3 id="Juicer-tools-requirements"><a href="#Juicer-tools-requirements" class="headerlink" title="Juicer tools requirements"></a>Juicer tools requirements</h3><p>The minimum software requirement to run Juicer is a working Java installation (version &gt;&#x3D; 1.8) on Windows, Linux, and Mac OSX. We recommend using the latest Java version available, but please do not use the Java Beta Version. Minimum system requirements for running Java can be found at<a href="https://java.com/en/download/help/sysreq.xml">https://java.com/en/download/help/sysreq.xml</a></p><p>To download and install the latest Java Runtime Environment (JRE), please go to <a href="https://www.java.com/download">https://www.java.com/download</a></p><h3 id="GNU-CoreUtils"><a href="#GNU-CoreUtils" class="headerlink" title="GNU CoreUtils"></a>GNU CoreUtils</h3><p>The latest version of GNU coreutils can be downloaded from <a href="https://www.gnu.org/software/coreutils/manual/">https://www.gnu.org/software/coreutils/manual/</a></p><h3 id="Burrows-Wheeler-Aligner-BWA"><a href="#Burrows-Wheeler-Aligner-BWA" class="headerlink" title="Burrows-Wheeler Aligner (BWA)"></a>Burrows-Wheeler Aligner (BWA)</h3><p>The <strong>latest version of BWA</strong> should be installed from <a href="http://bio-bwa.sourceforge.net/">http://bio-bwa.sourceforge.net/</a></p><h3 id="CUDA-for-HiCCUPS-peak-calling"><a href="#CUDA-for-HiCCUPS-peak-calling" class="headerlink" title="CUDA (for HiCCUPS peak calling)"></a>CUDA (for HiCCUPS peak calling)</h3><p>You must have an NVIDIA GPU to install CUDA.</p><p>Instructions for installing the latest version of CUDA can be found on the <a href="https://developer.nvidia.com/cuda-downloads">NVIDIA Developer site</a>.</p><p>The native libraries included with Juicer are compiled for CUDA 7 or CUDA 7.5. See the <a href="https://github.com/theaidenlab/juicer/wiki/Download">download page for Juicer Tools</a>.</p><p>Other versions of CUDA can be used, but you will need to download the respective native libraries from <a href="http://www.jcuda.org/downloads/downloads.html">JCuda</a>.</p><p>For best performance, use a dedicated GPU. You may also be able to obtain access to GPU clusters through Amazon Web Services or a local research institution.</p><p>If you cannot access a GPU, you can run the <a href="https://github.com/aidenlab/juicer/wiki/CPU-HiCCUPS">CPU version of HiCCUPS</a> directly using the <code>.hic</code> file and Juicer Tools.</p><h3 id="Building-new-jars"><a href="#Building-new-jars" class="headerlink" title="Building new jars"></a>Building new jars</h3><p>See the Juicebox documentation at <a href="https://github.com/theaidenlab/Juicebox">https://github.com/theaidenlab/Juicebox</a> for details on building new jars of the juicer_tools.</p><hr><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a><font color="red">Quick Start</font></h2><p>Run the Juicer pipeline on your cluster of choice with â€œjuicer.sh [options]â€</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs sh">Usage: juicer.sh [-g genomeID] [-d topDir] [-q queue] [-l long queue] [-s site]<br>                 [-a about] [-R end] [-S stage] [-p chrom.sizes path]<br>                 [-y restriction site file] [-z reference genome file]<br>                 [-C chunk size] [-D Juicer scripts directory]<br>                 [-Q queue time <span class="hljs-built_in">limit</span>] [-L long queue time <span class="hljs-built_in">limit</span>] [-e] [-h] [-x]<br>* [-g genomeID] must be defined <span class="hljs-keyword">in</span> the script, e.g. <span class="hljs-string">&quot;hg19&quot;</span> or <span class="hljs-string">&quot;mm10&quot;</span> (default<br>  <span class="hljs-string">&quot;hg19&quot;</span>); alternatively, it can be defined using the -z <span class="hljs-built_in">command</span><br>* [<span class="hljs-string">&#x27;-d topDir&#x27;</span>] is the top level directory (default<br>  <span class="hljs-string">&quot;/Users/nchernia/Downloads/neva-muck/UGER&quot;</span>)<br>     [topDir]/fastq must contain the fastq files<br>     [topDir]/splits will be created to contain the temporary <span class="hljs-built_in">split</span> files<br>     [topDir]/aligned will be created <span class="hljs-keyword">for</span> the final alignment<br>* [-q queue] is the queue <span class="hljs-keyword">for</span> running alignments (default <span class="hljs-string">&quot;short&quot;</span>)<br>* [-l long queue] is the queue <span class="hljs-keyword">for</span> running longer <span class="hljs-built_in">jobs</span> such as the hic file<br>  creation (default <span class="hljs-string">&quot;long&quot;</span>)<br>* [site] must be defined <span class="hljs-keyword">in</span> the script, e.g.  <span class="hljs-string">&quot;HindIII&quot;</span> or <span class="hljs-string">&quot;MboI&quot;</span><br>  (default <span class="hljs-string">&quot;none&quot;</span>)<br>* [about]: enter description of experiment, enclosed <span class="hljs-keyword">in</span> single quotes<br>* [stage]: must be one of <span class="hljs-string">&quot;chimeric&quot;</span>, <span class="hljs-string">&quot;merge&quot;</span>, <span class="hljs-string">&quot;dedup&quot;</span>, <span class="hljs-string">&quot;final&quot;</span>, <span class="hljs-string">&quot;postproc&quot;</span>, or <span class="hljs-string">&quot;early&quot;</span>.<br>    -Use <span class="hljs-string">&quot;chimeric&quot;</span> when alignments are <span class="hljs-keyword">done</span> but chimeric handling has not finished<br>    -Use <span class="hljs-string">&quot;merge&quot;</span> when alignment has finished but the merged_sort file has not<br>     yet been created.<br>    -Use <span class="hljs-string">&quot;dedup&quot;</span> when the files have been merged into merged_sort but<br>     merged_nodups has not yet been created.<br>    -Use <span class="hljs-string">&quot;final&quot;</span> when the reads have been deduped into merged_nodups but the<br>     final stats and hic files have not yet been created.<br>    -Use <span class="hljs-string">&quot;postproc&quot;</span> when the hic files have been created and only<br>     postprocessing feature annotation remains to be completed.<br>    -Use <span class="hljs-string">&quot;early&quot;</span> <span class="hljs-keyword">for</span> an early <span class="hljs-built_in">exit</span>, before the final creation of the stats and<br>     hic files<br>* [<span class="hljs-string">&#x27;chrom.sizes path&#x27;</span>]: enter path <span class="hljs-keyword">for</span> chrom.sizes file<br>* [<span class="hljs-string">&#x27;restriction site file&#x27;</span>]: enter path <span class="hljs-keyword">for</span> restriction site file (locations of<br>  restriction sites <span class="hljs-keyword">in</span> genome; can be generated with the script<br>  (misc/generate_site_positions.py) )<br>* [<span class="hljs-string">&#x27;reference genome file&#x27;</span>]: enter path <span class="hljs-keyword">for</span> reference sequence file, BWA index<br>  files must be <span class="hljs-keyword">in</span> same directory<br>* [chunk size]: number of lines <span class="hljs-keyword">in</span> <span class="hljs-built_in">split</span> files, must be multiple of 4<br>  (default 90000000, <span class="hljs-built_in">which</span> equals 22.5 million reads)<br>* [<span class="hljs-string">&#x27;Juicer scripts directory&#x27;</span>]: <span class="hljs-built_in">set</span> the Juicer directory,<br>  <span class="hljs-built_in">which</span> should have scripts/ references/ and restriction_sites/ underneath it<br>  (default /broad/aidenlab)<br>* [queue time <span class="hljs-built_in">limit</span>]: time <span class="hljs-built_in">limit</span> <span class="hljs-keyword">for</span> queue, i.e. -W 12:00 is 12 hours<br>  (default 1200)<br>* [long queue time <span class="hljs-built_in">limit</span>]: time <span class="hljs-built_in">limit</span> <span class="hljs-keyword">for</span> long queue, i.e. -W 168:00 is one week<br>  (default 3600)<br>* -f: include fragment-delimited maps from hic file creation<br>* -e: early <span class="hljs-built_in">exit</span><br>* -h: <span class="hljs-built_in">print</span> this <span class="hljs-built_in">help</span> and <span class="hljs-built_in">exit</span><br></code></pre></td></tr></table></figure><hr><h2 id="Juicer-Usage"><a href="#Juicer-Usage" class="headerlink" title="Juicer Usage"></a>Juicer Usage</h2><ul><li><strong>Running Juicer with no arguments</strong> will run it with genomeID hg19 and site MboI</li><li><strong>Providing a genome ID</strong>: if not defined in the script, you can either directly modify the script or provide the script with the files needed. You would provide the script with the files needed via â€œ-z reference_sequence_pathâ€ (needs to have the BWA index files in same directory), â€œ-p chrom_sizes_pathâ€ (these are the chromosomes you want included in .hic file), and â€œ-s site_fileâ€ (this is the listing of all the restriction site locations, one line per chromosome). Note that ligation junction wonâ€™t be defined in this case. The script (misc&#x2F;generate_site_positions.py) can help you generate the file</li><li><strong>Providing a restriction enzyme</strong>: if not defined in the script, you can either directly modify the script or provide the files needed via the â€œ-s site_fileâ€ flag, as above. Alternatively, if you donâ€™t want to do any fragment-level analysis (as with a DNAse experiment), you should assign the site â€œnoneâ€, as in <code>juicer.sh -s none</code></li><li><strong>Directory structure</strong>: Juicer expects the fastq files to be stored in a directory underneath the top-level directory. E.g. HIC001&#x2F;fastq. By default, the top-level directory is the directory where you are when you launch Juicer; you can change this via the -d flag. Fastqs can be zipped. [topDir]&#x2F;splits will be created to contain the temporary split files and should be deleted once your run is completed. [topDir]&#x2F;aligned will be created for the final files, including the hic files, the statistics, the valid pairs (merged_nodups), the collisions, and the feature annotations.</li><li><strong>Queues</strong> are complicated and itâ€™s likely that youâ€™ll have to modify the script for your system, though we did our best to avoid this. By default thereâ€™s a short queue and a long queue. We also allow you to pass in wait times for those queues; this is currently ignored by the UGER and SLURM versions. The short queue should be able to complete alignment of one split file. The long queue is for jobs that we expect to take a while, like writing out the merged_sort file</li><li><strong>Chunk size</strong> is intimitely associated with your queues; a smaller chunk size means more alignment jobs that complete in a faster time. If you have a hard limit on the number of jobs, you donâ€™t want too small of a chunk size. If your short queue has a very limited runtime ceiling, you donâ€™t want too big of a chunk size. Run time for alignment will also depend on the particulars of your cluster. We launch ~5 jobs per chunk. Chunk size must be a multiple of 4.</li><li><strong>Relaunch</strong> via the same script. Type <code>juicer.sh [options] -S stage</code> where â€œstageâ€ is one of merge, dedup, final, postproc, or early. â€œmergeâ€ is for when alignment has finished but merged_sort hasnâ€™t been created; â€œdedupâ€ is for when merged_sort is there but not merged_nodups (this will relaunch all dedup jobs); â€œfinalâ€ is for when merged_nodups is there and you want the stats and hic files; â€œpostprocâ€ is for when you have the hic files and just want feature annotations; and â€œearlyâ€ is for early exit, before hic file creation. If your jobs failed at the alignment stage, run <code>relaunch_prep.sh</code> and then run juicer.sh.</li><li><strong>Miscelleaneous options</strong> include -a â€˜experiment descriptionâ€™, which will add the experiment description to the statistics file and the meta data in the hic file; -r, which allows you to use bwa aln instead of bwa mem, useful for shorter reads; -R [end], in case you have one read end thatâ€™s short and one thatâ€™s long and you want to align the short end with bwa aln and the long end with bwa mem; and -D [Juicer scripts directory], to set an alternative Juicer directory; must have scripts&#x2F;, references&#x2F;, and restriction_sites&#x2F; underneath it</li></ul><hr><h2 id="Command-Line-Tools-Usage"><a href="#Command-Line-Tools-Usage" class="headerlink" title="Command Line Tools Usage"></a>Command Line Tools Usage</h2><p>Detailed documentation about the command line tools can be found on the wiki:</p><ul><li><a href="https://github.com/aidenlab/juicer/wiki/Feature-Annotation">Annotating features with Arrowhead, HiCCUPS, MotifFinder, APA, Eigenvector, and Pearsons</a></li><li><a href="https://github.com/aidenlab/juicer/wiki/Pre">Creating .hic with Pre</a></li><li><a href="https://github.com/aidenlab/straw">Extracting data from .hic files with straw</a></li></ul><p>To launch the command line tools, use the shell script â€œjuicer_toolsâ€ on Unix&#x2F;MacOS or type</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">java </span>-<span class="hljs-keyword">jar </span><span class="hljs-keyword">juicer_tools.jar </span>(command...) [flags...] &lt;parameters...&gt;`<br></code></pre></td></tr></table></figure><p>In the command line tools, there are several analysis functions:</p><ol><li><code>apa</code> for conducting aggregate peak analysis</li><li><code>hiccups</code> for annotating loops</li><li><code>motifs</code> for finding CTCF motifs</li><li><code>arrowhead</code> for annotating contact domains</li><li><code>eigenvector</code> for calculating the eigenvector (first PC) of the Pearsonâ€™s</li><li><code>pearsons</code> for calculating the Pearsonâ€™s</li></ol><p>The <code>juicer_tools</code> (Unix&#x2F;MacOS) script can be used in place of the unwieldy <code>java -Djava.library.path=path/to/natives/ -jar juicer_tools.jar</code></p><hr><h1 id="juicerçš„å·¥ä½œç›®å½•ç»“æ„"><a href="#juicerçš„å·¥ä½œç›®å½•ç»“æ„" class="headerlink" title="juicerçš„å·¥ä½œç›®å½•ç»“æ„"></a>juicerçš„å·¥ä½œç›®å½•ç»“æ„</h1><p>è¦æ±‚å›ºå®šç›®å½•ç»“æ„ï¼Œæ–°å»º<code>juicer</code>ç›®å½•ï¼Œè¯¥ç›®å½•ä¸ºè½¯ä»¶å®‰è£…ç›®å½•ï¼Œç›®å½•ä¸‹å¿…é¡»æœ‰4ä¸ªå­ç›®å½•</p><p><code>references</code>ç›®å½•å­˜æ”¾å‚è€ƒåŸºå› ç»„æ–‡ä»¶ï¼Œ<code>work</code>å­˜æ”¾æ ·æœ¬åºåˆ—æ–‡ä»¶å’Œåˆ†æç»“æœï¼Œ<code>scripts</code>å­˜æ”¾è½¯ä»¶è¿è¡Œè„šæœ¬ï¼Œ<code>restriction_sites</code>å­˜æ”¾å‚è€ƒåŸºå› ç»„é…¶åˆ‡å›¾è°±ã€‚</p><h1 id="ä¸‹è½½æºç "><a href="#ä¸‹è½½æºç " class="headerlink" title="ä¸‹è½½æºç "></a>ä¸‹è½½æºç </h1><p>ä»githubä¸Šä¸‹è½½juicerå’Œjcudaçš„æºä»£ç ï¼Œæ”¾ç½®åˆ°<code>scripts</code>ç›®å½•ã€‚</p><p>å…¶ä¸­çš„<code>CPU</code>ç›®å½•å°±æ˜¯å•æœºæœåŠ¡å™¨ï¼Œè€Œ<code>AWS</code>, <code>LSF</code>, <code>PBS</code>ç­‰å¯¹åº”å…¬æœ‰äº‘å’Œä¸åŒçš„é›†ç¾¤ç³»ç»Ÿã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">cd</span> scripts/common<br><span class="hljs-attribute">wget</span> https://hicfiles.tc4ga.com/public/juicer/juicer_tools.<span class="hljs-number">1</span>.<span class="hljs-number">9</span>.<span class="hljs-number">9</span>_jcuda.<span class="hljs-number">0</span>.<span class="hljs-number">8</span>.jar<br><span class="hljs-attribute">ln</span> -s juicer_tools.<span class="hljs-number">1</span>.<span class="hljs-number">9</span>.<span class="hljs-number">9</span>_jcuda.<span class="hljs-number">0</span>.<span class="hljs-number">8</span>.jar  juicer_tools.jar<br></code></pre></td></tr></table></figure><h1 id="å‚è€ƒåŸºå› ç»„ï¼Œé…¶åˆ‡å›¾è°±"><a href="#å‚è€ƒåŸºå› ç»„ï¼Œé…¶åˆ‡å›¾è°±" class="headerlink" title="å‚è€ƒåŸºå› ç»„ï¼Œé…¶åˆ‡å›¾è°±"></a>å‚è€ƒåŸºå› ç»„ï¼Œé…¶åˆ‡å›¾è°±</h1><p>fastaåºåˆ—æ–‡ä»¶å’Œbwa ç´¢å¼•</p><p>juicer&#x2F;misc&#x2F;generate_site_positions.pyå¯ä»¥è¾“å‡º4ç§å†…åˆ‡é…¶çš„é…¶åˆ‡å›¾è°±ã€‚HindIIIï¼›DpnIIï¼›MboIï¼›Sau3AI</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">generate_site_positions.py HindIII hg19 hg19.fasta<br>python ..<span class="hljs-regexp">/juicer/mi</span>sc<span class="hljs-regexp">/generate_site_positions.py  MboI  hg38_MboI ../</span>references/Homo_sapiens_assembly38.fasta <span class="hljs-comment"># ç”Ÿæˆäº† hg38_MboI.txt æ–‡ä»¶</span><br>awk <span class="hljs-string">&#x27;BEGIN&#123;OFS=&quot;\t&quot;&#125;&#123;print $1, $NF&#125;&#x27;</span> hg38_MboI.txt &gt; hg38.chrom.sizes<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°å†…åˆ‡é…¶åç§°ï¼Œç¬¬äºŒä¸ªå‚æ•°è‡ªå®šä¹‰åŸºå› ç»„ç‰ˆæœ¬ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°åŸºå› ç»„fastaæ–‡ä»¶è·¯å¾„ï¼Œè¾“å‡ºæ–‡ä»¶åç§°ä¸ºç¬¬äºŒä¸ªå‚æ•°å’Œç¬¬ä¸€ä¸ªå‚æ•°ç”¨ä¸‹åˆ’çº¿é“¾æ¥ï¼Œåç¼€ä¸º<code>txt</code></p><h1 id="åºåˆ—"><a href="#åºåˆ—" class="headerlink" title="åºåˆ—"></a>åºåˆ—</h1><p>è½¯ä»¶è¿è¡Œæ—¶å¯¹æ ·æœ¬æ–‡ä»¶çš„å­˜æ”¾ä½ç½®ä¹Ÿæœ‰è¦æ±‚ï¼Œå¿…é¡»ä½äº<code>work</code>ç›®å½•ä¸‹ï¼Œä»¥æ ·æœ¬åä½œä¸ºä¸€ä¸ªå­ç›®å½•ï¼Œåºåˆ—æ–‡ä»¶å­˜æ”¾äº<code>fastq</code>ç›®å½•ä¸‹ï¼Œç¤ºæ„å¦‚ä¸‹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/opt/</span>juicer<span class="hljs-regexp">/work/</span>MBR19/fastq<br><span class="hljs-regexp">/opt/</span>juicer<span class="hljs-regexp">/work/</span>MBR19<span class="hljs-regexp">/fastq/</span>chr19_R1.fastq.gz<br><span class="hljs-regexp">/opt/</span>juicer<span class="hljs-regexp">/work/</span>MBR19<span class="hljs-regexp">/fastq/</span>chr19_R2.fastq.gz<br></code></pre></td></tr></table></figure><hr><h1 id="è½¯ä»¶æ¯”è¾ƒ"><a href="#è½¯ä»¶æ¯”è¾ƒ" class="headerlink" title="è½¯ä»¶æ¯”è¾ƒ"></a>è½¯ä»¶æ¯”è¾ƒ</h1><p><img src="/GeekFocus/2022-03-16-juicer/1.png"><br><img src="/GeekFocus/img/2022-03-16-juicer/1.png" alt="img"></p><h1 id="è„šæœ¬åŸç†ï¼ˆjuicer-shï¼‰"><a href="#è„šæœ¬åŸç†ï¼ˆjuicer-shï¼‰" class="headerlink" title="è„šæœ¬åŸç†ï¼ˆjuicer.shï¼‰"></a>è„šæœ¬åŸç†ï¼ˆjuicer.shï¼‰</h1><p>fastqç­‰æ–‡ä»¶è¾“å…¥ â€”ã€‹bwaæ¯”å¯¹ â€”ã€‹æ’åº â€”ã€‹åˆå¹¶ â€”ã€‹å»PCRé‡å¤ â€”ã€‹ç”Ÿæˆ hicæ–‡ä»¶</p><p>Juicerçš„å·¥ä½œæµç¨‹è§ä¸‹å›¾ï¼Œè¾“å…¥<strong>åŸå§‹</strong>fastqæ–‡ä»¶ï¼Œå¤„ç†å¾—åˆ°<strong>ä¸­é—´</strong>æ–‡ä»¶.hic, ä¹‹åå¯¹.hicæ–‡ä»¶ç”¨äº<strong>ä¸‹æ¸¸</strong>åˆ†æï¼ŒåŒ…æ‹¬</p><p>Arrowhead: å¯»æ‰¾å­˜åœ¨å…³è”çš„åŒºåŸŸ<br>HiCCUPS: åˆ†æå±€éƒ¨å¯Œé›†peaks<br>MotifFinder: ç”¨äºé”šå®špeaks<br>Persons: è®¡ç®—è§‚æµ‹&#x2F;æœŸæœ›çš„çš®å°”æ£®ç›¸å…³ç³»æ•°çŸ©é˜µ<br>Eigenvector: ç¡®å®šåˆ†éš”</p><p><img src="/GeekFocus/2022-03-16-juicer/2.png"><br><img src="/GeekFocus/img/2022-03-16-juicer/2.png" alt="juicerå·¥ä½œæµç¨‹"></p><h1 id="ç»“æœæ–‡ä»¶"><a href="#ç»“æœæ–‡ä»¶" class="headerlink" title="ç»“æœæ–‡ä»¶"></a>ç»“æœæ–‡ä»¶</h1><p>ç»“æœæ–‡ä»¶éƒ½åœ¨ aligned ä¸­ï¼Œä¸»è¦æ–‡ä»¶æ˜¯ .hic æ–‡ä»¶ï¼Œå…¶ä¸­inter_30.hic æ˜¯è®¾ç½®äº† mapq threshold &gt;30 çš„ç»“æœã€‚å¦‚æœ GPU ï¼ˆcuddï¼‰å¯ç”¨ï¼Œè½¯ä»¶ä¼šè‡ªåŠ¨ä½¿ç”¨è‡ªå¸¦ <strong>HiCCUPS</strong> ç®—æ³•è®¡ç®— contact domains å¹¶ä¿å­˜åœ¨ inter_30_contact_domains æ–‡ä»¶å¤¹ã€‚å¦‚æœGPUä¸å¯ç”¨ï¼Œå¯æ‰‹åŠ¨ç”¨è‡ªå¸¦çš„ <strong>CPU HiCCUPS</strong> ç®—æ³•æ¥è®¡ç®—ï¼Œåé¢ç« èŠ‚æœ‰ä»‹ç»ã€‚</p><p>hicæ–‡ä»¶æ ¼å¼è¯·çœ‹ <a href="https://links.jianshu.com/go?to=https://github.com/theaidenlab/juicebox/blob/master/HiC_format_v8.docx">https://github.com/theaidenlab/juicebox/blob/master/HiC_format_v8.docx</a></p><h1 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh">juicer.sh \<br>-z references/hg19.fa \<br>-p restriction_sites/hg19.chrom.sizes \<br>-y restriction_sites/hg19_HindIII.txt \<br>-d /home/pub/software/juicer/work/HIC003/ \<br>-D /home/pub/software/juicer \<br>-t 5<br><br>-d: juicerçš„ç›®å½• å®‰è£…åœ¨/soft/ï¼Œè®¾ç½®ä¸º/soft/juicer<br>-D: juicer scriptsçš„ç›®å½•ï¼Œå®‰è£…åœ¨/soft/ï¼Œè®¾ç½®ä¸º/soft/juicer/CPU<br></code></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„, æŒ‡å®šæ–‡ä»¶è·¯å¾„æ—¶ï¼Œæœ€å¥½æŒ‡å®šç»å¯¹è·¯å¾„ï¼Œç‰¹åˆ«æ˜¯fastqæ–‡ä»¶è·¯å¾„ã€‚å› ä¸ºè½¯ä»¶è¿è¡Œè¿‡ç¨‹ä¸­ä¼šä½¿ç”¨è½¯é“¾æ¥ï¼Œç›¸å¯¹è·¯å¾„ä¼šå‡ºé”™ã€‚</p><p><code>splits</code>ç›®å½•ä¸‹å­˜æ”¾ä¸­é—´ç»“æœï¼Œç”±äºhi-Cæ•°æ®é‡å¾ˆå¤§ï¼Œæ‰€ä»¥ä¼šå°†åŸå§‹åºåˆ—<strong>æ‹†åˆ†æˆå¤šä»½</strong>ï¼Œ<strong>å¹¶è¡Œè¿ç®—åŠ å¿«é€Ÿåº¦</strong>ã€‚é»˜è®¤æ¯ä»½åŒ…å«22.5Mçš„reads, å¯ä»¥é€šè¿‡<code>-C</code>å‚æ•°è°ƒæ•´ï¼Œè¯¥å‚æ•°æŒ‡å®šæ‹†åˆ†æ–‡ä»¶çš„è¡Œæ•°ï¼Œé»˜è®¤æ˜¯90000000?ï¼Œ æ³¨æ„fastqæ–‡ä»¶4è¡Œä»£è¡¨ä¸€æ¡åºåˆ—ï¼Œæ‰€ä»¥è¿™ä¸ªå‚æ•°çš„å€¼å¿…é¡»æ˜¯4çš„å€æ•°ã€‚æ‹†åˆ†ååºåˆ—çš„R1å’ŒR2ç«¯åˆ†åˆ«é€šè¿‡bwaæ¯”å¯¹åŸºå› ç»„ï¼Œç„¶ååˆå¹¶ï¼Œç­›é€‰åµŒåˆä½“åºåˆ—ï¼Œå»é‡å¤ï¼Œç”Ÿæˆé¢„å¤„ç†åçš„ç»“æœæ–‡ä»¶ã€‚</p><p><code>aligned</code>ç›®å½•ä¸‹å­˜æ”¾çš„æ˜¯æœ€ç»ˆç»“æœï¼ŒåŒ…å«äº†å¯ä»¥å¯¼å…¥juiceboxçš„åç¼€ä¸º<code>hic</code>çš„å›¾è°±æ–‡ä»¶, <code>inter.hic</code>å’Œ<code>inter_30.hic</code>ï¼Œ 30è¡¨ç¤ºé€šè¿‡<code>MAPQ &gt; 30</code>è¿‡æ»¤ä¹‹åçš„ç»“æœã€‚å®Œæ•´æµç¨‹è¿˜ä¼šè¿›è¡Œåç»­å¤„ç†ï¼ŒåŒ…æ‹¬è¯†åˆ«TAD, æŸ“è‰²è´¨ç¯ç­‰ç»“æ„ã€‚å…¶ä¸­è¯†åˆ«æŸ“è‰²è´¨ç¯çš„HICCUPsç®—æ³•å¿…é¡»é€šè¿‡<a href="https://cloud.tencent.com/product/gpu?from=10680">GPU</a>åŠ é€Ÿè¿è¡Œæ‰å¯ä»¥ï¼Œæ‰€ä»¥æ²¡æœ‰å®‰è£…GPUå¡çš„æ™®é€šæœåŠ¡å™¨æ— æ³•è¿è¡Œè¿™ä¸ªæ­¥éª¤ã€‚</p><p>ä¸Šè¿°è¿‡ç¨‹å¯çœ‹åˆ°ï¼Œjuicerä½¿ç”¨ç®€å•ã€‚ç”±äºHi-Cæ•°æ®æµ‹åºé‡éå¸¸å¤§ï¼Œä»¥åŠåç»­åˆ†æç®—æ³•çš„å¤æ‚åº¦ï¼Œå¯¹æœåŠ¡å™¨è®¡ç®—èµ„æºçš„è¦æ±‚ç›¸å½“é«˜ï¼Œå¿…é¡»é«˜æ€§èƒ½æœåŠ¡å™¨æ‰èƒ½æ»¡è¶³è¦æ±‚ï¼Œè€Œè¯¥è½¯ä»¶æ‰€éœ€çš„GPUå¡æˆæœ¬ä¹Ÿéå¸¸é«˜ï¼Œä¸€å—çš„æˆæœ¬åœ¨2ä¸‡å…ƒå·¦å³ï¼Œè¿™äº›å› ç´ ä¸€å®šç¨‹åº¦åˆ¶çº¦äº†Hi-Cçš„æ™®åŠå’Œå‘å±•ã€‚</p><h1 id="juicerä¸‹æ¸¸åˆ†æ"><a href="#juicerä¸‹æ¸¸åˆ†æ" class="headerlink" title="juicerä¸‹æ¸¸åˆ†æ"></a>juicerä¸‹æ¸¸åˆ†æ</h1><p><a href="https://zhuanlan.zhihu.com/p/341206245">https://zhuanlan.zhihu.com/p/341206245</a></p><p>ç›®å‰é’ˆå¯¹Hi-Cæ•°æ®çš„ç ”ç©¶ä¸»è¦æ˜¯ä¸‰ä¸ªæ–¹é¢ï¼Œåˆ†åˆ«æ˜¯<code>A/B comparment</code> ï¼Œ<code>TADS</code>ï¼Œ<code>Loops</code>ã€‚</p><p><code>juicer_tools.jar</code> åŠŸèƒ½ä»‹ç»</p><p><code>arrowhead</code> æ³¨é‡ŠTAD</p><p><code>hiccups</code> æ³¨é‡Šloop</p><p><code>motigs</code> å®šä½CTCFå…ƒä»¶</p><p><code>hiccupsdiff</code> ä»å¤šä¸ªloosæ–‡ä»¶ä¸­æ‰¾åˆ°ä¸åŒçš„loop</p><p><code>apa</code> èšåˆå³°çš„åˆ†æ</p><p><code>pearsons</code> è®¡ç®—O&#x2F;Eçš„çš®å°”æ£®ç›¸å…³ç³»æ•°</p><p><code>eigenvector</code> è®¡ç®—ç‰¹å¾å‘é‡çš„çš®å°”æ£®ç›¸å…³ç³»æ•°</p><p><code>dump</code> .hicæ–‡ä»¶äº’ä½œçŸ©é˜µæå–</p><p><code>pre</code> éjuiceræ•°æ®è½¬.hicæ–‡ä»¶</p><h1 id="hicæ•°æ®å¯è§†åŒ–"><a href="#hicæ•°æ®å¯è§†åŒ–" class="headerlink" title="hicæ•°æ®å¯è§†åŒ–"></a>hicæ•°æ®å¯è§†åŒ–</h1><ul><li><p><strong>åŠ è½½.hicæ–‡ä»¶</strong></p></li><li><p><strong>åŠ è½½ä¸€ç»´æ³¨é‡Š</strong></p></li><li><p><strong>åŠ è½½äºŒç»´æ³¨é‡Šï¼Œé»„çš„çš„æ˜¯TADï¼Œå¤©è“è‰²çš„æ˜¯loop</strong></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€long reads mappingã€‘ã€minimap2ã€‘</title>
    <link href="/GeekFocus/2022/03/16/2022-03-16-minimap2/"/>
    <url>/GeekFocus/2022/03/16/2022-03-16-minimap2/</url>
    
    <content type="html"><![CDATA[<p>Minimap2 is a versatile sequence alignment program that aligns DNA or mRNA sequences against a large reference database. </p><span id="more"></span><p><a href="https://github.com/lh3/minimap2">https://github.com/lh3/minimap2</a></p><ul><li>å°†PacBioæˆ–OXford Nanoporeçš„readå’Œå·²æœ‰å‚è€ƒåŸºå› ç»„ï¼ˆå¦‚äººç±»ï¼‰è¿›è¡Œæ¯”å¯¹(<strong>long reads mapping</strong>)</li><li>å¯»æ‰¾é«˜é”™è¯¯ç‡read(15%)ä¹‹é—´çš„overlap</li><li>å°†PacBio Iso-Seq æˆ–Nanopore cDNAæˆ–RNAåºåˆ—æ¯”å¯¹åˆ°å‚è€ƒåŸºå› ç»„(splicing aware)</li><li>å°†<strong>illumina</strong> å•ç«¯æˆ–è€…åŒç«¯åºåˆ—æ¯”å¯¹åˆ°å‚è€ƒåŸºå› ç»„</li><li><strong>ç»„è£…ä¹‹é—´</strong>çš„æ¯”å¯¹</li><li><strong>ä¸´è¿‘ç‰©ç§</strong>çš„å…¨åŸºå› ç»„æ¯”å¯¹</li></ul><h2 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sh">git <span class="hljs-built_in">clone</span> https://github.com/lh3/minimap2<br><span class="hljs-built_in">cd</span> minimap2 &amp;&amp; make<br><span class="hljs-comment"># long sequences against a reference genome</span><br>./minimap2 -a <span class="hljs-built_in">test</span>/MT-human.fa <span class="hljs-built_in">test</span>/MT-orang.fa &gt; test.sam<br><span class="hljs-comment"># create an index first and then map</span><br>./minimap2 -x map-ont -d MT-human-ont.mmi <span class="hljs-built_in">test</span>/MT-human.fa<br>./minimap2 -a MT-human-ont.mmi <span class="hljs-built_in">test</span>/MT-orang.fa &gt; test.sam<br><span class="hljs-comment"># use presets (no test data)</span><br>./minimap2 -ax map-pb ref.fa pacbio.fq.gz &gt; aln.sam       <span class="hljs-comment"># PacBio CLR genomic reads</span><br>./minimap2 -ax map-ont ref.fa ont.fq.gz &gt; aln.sam         <span class="hljs-comment"># Oxford Nanopore genomic reads</span><br>./minimap2 -ax map-hifi ref.fa pacbio-ccs.fq.gz &gt; aln.sam <span class="hljs-string">&#x27;PacBio HiFi/CCS genomic reads (v2.19 or later)&#x27;</span><br>./minimap2 -ax asm20 ref.fa pacbio-ccs.fq.gz &gt; aln.sam    <span class="hljs-string">&#x27;PacBio HiFi/CCS genomic reads (v2.18 or earlier)&#x27;</span><br>./minimap2 -ax sr ref.fa read1.fa read2.fa &gt; aln.sam      <span class="hljs-comment"># short genomic paired-end reads</span><br>./minimap2 -ax splice ref.fa rna-reads.fa &gt; aln.sam       <span class="hljs-comment"># spliced long reads (strand unknown)</span><br>./minimap2 -ax splice -uf -k14 ref.fa reads.fa &gt; aln.sam  <span class="hljs-comment"># noisy Nanopore Direct RNA-seq</span><br>./minimap2 -ax splice:hq -uf ref.fa query.fa &gt; aln.sam    <span class="hljs-comment"># Final PacBio Iso-seq or traditional cDNA</span><br>./minimap2 -ax splice --junc-bed anno.bed12 ref.fa query.fa &gt; aln.sam  <span class="hljs-comment"># prioritize on annotated junctions</span><br>./minimap2 -cx asm5 asm1.fa asm2.fa &gt; aln.paf             <span class="hljs-string">&#x27;intra-species asm-to-asm alignment&#x27;</span><br>./minimap2 -x ava-pb reads.fa reads.fa &gt; overlaps.paf     <span class="hljs-comment"># PacBio read overlap</span><br>./minimap2 -x ava-ont reads.fa reads.fa &gt; overlaps.paf    <span class="hljs-comment"># Nanopore read overlap</span><br><span class="hljs-comment"># man page for detailed command line options</span><br>man ./minimap2.1<br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="Usersâ€™-Guide"><a href="#Usersâ€™-Guide" class="headerlink" title="Usersâ€™ Guide"></a>Usersâ€™ Guide</h2><p>Minimap2 is a versatile sequence alignment program that aligns <strong>DNA or mRNA</strong> sequences <strong>against</strong> a large <strong>reference</strong> database. </p><p>Typical use cases include: </p><p>(1) <strong>mapping PacBio</strong> or Oxford <strong>Nanopore</strong> genomic <strong>reads</strong> to the human genome;</p><p>(2) <strong>finding overlaps between long read</strong>s with <strong>error rate</strong> up to ~15%;</p><p>(3) <strong>splice-aware alignment</strong> of PacBio Iso-Seq or Nanopore cDNA or Direct RNA reads <strong>against</strong> a <strong>reference</strong> genome;</p><p>(4) aligning <strong>Illumina</strong> single- or paired-end reads; </p><p>(5) <strong>assembly-to-assembly alignment</strong>; </p><p>(6) <strong>full-genome alignment</strong> between <strong>two closely related species</strong> with <strong>divergence below ~15%</strong>.</p><p>For ~10kb noisy reads sequences, minimap2 is <strong>tens of times faster</strong> than mainstream long-read mappers such as BLASR, BWA-MEM, NGMLR and GMAP. It is <strong>more accurate</strong> on simulated long reads and produces biologically meaningful alignment ready for downstream analyses. For &gt;100bp <strong>Illumina short reads</strong>, minimap2 is <strong>three times</strong> as fast as <strong>BWA-MEM</strong> and <strong>Bowtie2</strong>, and as accurate on simulated data. Detailed evaluations are available from the <a href="https://doi.org/10.1093/bioinformatics/bty191">minimap2 paper</a> or the <a href="https://arxiv.org/abs/1708.01492">preprint</a>.</p><h3 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">cd</span> minimap2 &amp;&amp; <span class="hljs-keyword">make</span><br></code></pre></td></tr></table></figure><h3 id="PAF-a-Pairwise-mApping-Format"><a href="#PAF-a-Pairwise-mApping-Format" class="headerlink" title="PAF: a Pairwise mApping Format"></a>PAF: a Pairwise mApping Format</h3><p>PAF is a text format describing the <strong>approximate mapping positions</strong> between two set of sequences. PAF is TAB-delimited with each line consisting of the following predefined fields:</p><table><thead><tr><th>Col</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>1</td><td>string</td><td>Query sequence name</td></tr><tr><td>2</td><td>int</td><td>Query sequence length</td></tr><tr><td>3</td><td>int</td><td>Query start (0-based; BED-like; closed)</td></tr><tr><td>4</td><td>int</td><td>Query end (0-based; BED-like; open)</td></tr><tr><td>5</td><td>char</td><td>Relative strand: â€œ+â€ or â€œ-â€œ</td></tr><tr><td>6</td><td>string</td><td>Target sequence name</td></tr><tr><td>7</td><td>int</td><td>Target sequence length</td></tr><tr><td>8</td><td>int</td><td>Target start on original strand (0-based)</td></tr><tr><td>9</td><td>int</td><td>Target end on original strand (0-based)</td></tr><tr><td>10</td><td>int</td><td>Number of residue matches</td></tr><tr><td>11</td><td>int</td><td>Alignment block length</td></tr><tr><td>12</td><td>int</td><td>Mapping quality (0-255; 255 for missing)</td></tr></tbody></table><p>If PAF is generated from an alignment, <strong>column 10 equals the number of sequence matches</strong>, and <strong>column 11 equals the total number of sequence matches, mismatches, insertions and deletions in the alignment</strong>. If alignment is not available, column 10 and 11 are still required but may be highly inaccurate.</p><p>A PAF file may optionally contain SAM-like typed key-value pairs at the end of each line.</p><h3 id="General-usage"><a href="#General-usage" class="headerlink" title="General usage"></a>General usage</h3><p>Without any options, minimap2 takes a <strong>reference</strong> database and a <strong>query sequence</strong> file as input and produce approximate mapping, without base-level alignment (i.e. coordinates are only approximate and no CIGAR in output), in the PAF format:</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">minimap2 <span class="hljs-keyword">ref</span>.fa query.fq &gt; approx-<span class="hljs-keyword">mapping</span>.paf<br></code></pre></td></tr></table></figure><p>You can ask minimap2 to generate CIGAR at the <code>cg</code> tag of PAF with:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">minimap2 -c ref<span class="hljs-selector-class">.fa</span> query<span class="hljs-selector-class">.fq</span> &gt; alignment.paf<br></code></pre></td></tr></table></figure><p>or to output alignments in the <a href="https://samtools.github.io/hts-specs/SAMv1.pdf">SAM format</a>:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">minimap2 -<span class="hljs-selector-tag">a</span> ref<span class="hljs-selector-class">.fa</span> query<span class="hljs-selector-class">.fq</span> &gt; alignment.sam<br></code></pre></td></tr></table></figure><p>Minimap2 seamlessly works with <strong>gzipâ€™d FASTA</strong> and <strong>FASTQ</strong> formats as input. You <strong>donâ€™t need to convert</strong> between FASTA and FASTQ or decompress gzipâ€™d files first.</p><p>For the human reference genome, minimap2 takes a few minutes to generate a minimizer index for the reference before mapping. To <strong>reduce indexing time</strong>, you can optionally save the index with option <strong>-d</strong> and <strong>replace the reference sequence file with the index file</strong> on the minimap2 command line:</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">minimap2 -d <span class="hljs-keyword">ref</span>.mmi <span class="hljs-keyword">ref</span>.fa                     <span class="hljs-comment"># indexing</span><br>minimap2 -<span class="hljs-keyword">a ref</span>.mmi reads.fq &gt; alignment.sam   <span class="hljs-comment"># alignment</span><br></code></pre></td></tr></table></figure><p><em><strong>Importantly</strong></em>, it should be noted that once you build the index, indexing parameters such as <strong>-k</strong>, <strong>-w</strong>, <strong>-H</strong> and <strong>-I</strong> canâ€™t be changed during mapping. If you are running minimap2 for <strong>different data types</strong>, you will probably need to keep <strong>multiple indexes generated</strong> with different parameters. This makes minimap2 different from BWA which always uses the same index regardless of query data types.</p><h3 id="Use-cases"><a href="#Use-cases" class="headerlink" title="Use cases"></a>Use cases</h3><p>Minimap2 uses the same base algorithm for all applications. However, due to the different data types it supports (e.g. short vs long reads; DNA vs mRNA reads), minimap2 needs to be tuned for optimal performance and accuracy. It is usually recommended to choose a preset with option <strong>-x</strong>, which <strong>sets multiple parameters</strong> at the same time. The default setting is the same as <code>map-ont</code>.</p><h4 id="Map-long-noisy-genomic-reads"><a href="#Map-long-noisy-genomic-reads" class="headerlink" title="Map long noisy genomic reads"></a>Map long noisy genomic reads</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">minimap2 -ax map-pb  ref.fa pacbio-reads.fq &gt; aln.sam   <span class="hljs-comment"># for ã€PacBio CLRã€‘ reads</span><br>minimap2 -ax map-ont ref.fa ont-reads.fq &gt; aln.sam      <span class="hljs-comment"># for ã€Oxford Nanoporeã€‘ reads</span><br></code></pre></td></tr></table></figure><p>The difference between <code>map-pb</code> and <code>map-ont</code> is that <code>map-pb</code> uses homopolymer-compressed (HPC) minimizers as <strong>seeds</strong>, while <code>map-ont</code> uses ordinary minimizers as seeds. Emperical evaluation suggests HPC minimizers improve performance and sensitivity when aligning PacBio CLR reads, but hurt when aligning Nanopore reads.</p><h4 id="Map-long-mRNA-x2F-cDNA-reads"><a href="#Map-long-mRNA-x2F-cDNA-reads" class="headerlink" title="Map long mRNA&#x2F;cDNA reads"></a>Map long mRNA&#x2F;cDNA reads</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs perl">minimap2 -ax <span class="hljs-keyword">splice</span>:hq -uf ref.fa iso-seq.fq &gt; aln.sam       <span class="hljs-comment"># PacBio Iso-seq/traditional cDNA</span><br>minimap2 -ax <span class="hljs-keyword">splice</span> ref.fa nanopore-cdna.fa &gt; aln.sam        <span class="hljs-comment"># Nanopore 2D cDNA-seq</span><br>minimap2 -ax <span class="hljs-keyword">splice</span> -uf -k14 ref.fa direct-rna.fq &gt; aln.sam  <span class="hljs-comment"># Nanopore Direct RNA-seq</span><br>minimap2 -ax <span class="hljs-keyword">splice</span> --<span class="hljs-keyword">splice</span>-flank=<span class="hljs-keyword">no</span> SIRV.fa SIRV-seq.fa    <span class="hljs-comment"># mapping against SIRV control</span><br></code></pre></td></tr></table></figure><p>There are different long-read RNA-seq technologies, including tranditional full-length cDNA, EST, PacBio Iso-seq, Nanopore 2D cDNA-seq and Direct RNA-seq. They produce data of varying quality and properties. By default, <code>-x splice</code> <strong>assumes the read orientation relative to the transcript strand is unknown</strong>. It tries two rounds of alignment to infer the orientation and write the strand to the <code>ts</code> SAM&#x2F;PAF tag if possible. For <strong>Iso-seq, Direct RNA-seq</strong> and tranditional full-length <strong>cDNAs</strong>, it would be desired to apply <code>-u f</code> to force minimap2 to <strong>consider the forward transcript strand only</strong>. This speeds up alignment with slight improvement to accuracy. For <strong>noisy Nanopore Direct RNA-seq reads</strong>, it is recommended to use a smaller k-mer size for increased sensitivity to the first or the last exons.</p><p>Minimap2 rates an alignment by the score of the max-scoring sub-segment, <em>excluding</em> introns, and marks the best alignment as primary in SAM. When a <strong>spliced gene also has unspliced pseudogenes</strong>, minimap2 does not intentionally prefer spliced alignment, though in practice it more often marks the spliced alignment as the primary. By default, minimap2 outputs up to five secondary alignments (i.e. likely pseudogenes in the context of RNA-seq mapping). This can be tuned with option <strong>-N</strong>.</p><p>For <strong>long RNA-seq reads</strong>, minimap2 may produce chimeric alignments potentially caused by gene fusions&#x2F;structural variations or by an intron longer than the max intron length <strong>-G</strong> (200k by default). For now, it is not recommended to apply an excessively large <strong>-G</strong> as this slows down minimap2 and sometimes leads to false alignments.</p><p>It is worth noting that by default <code>-x splice</code> prefers GT[A&#x2F;G]..[C&#x2F;T]AG over GT[C&#x2F;T]..[A&#x2F;G]AG, and then over other splicing signals. Considering one additional base improves the junction accuracy for noisy reads, but reduces the accuracy when aligning against the widely used SIRV control data. This is because SIRV does not honor the evolutionarily conservative splicing signal. If you are studying <strong>SIRV</strong>, you may apply <code>--splice-flank=no</code> to let minimap2 only model GT..AG, ignoring the additional base.</p><p>Since v2.17, minimap2 can optionally <strong>take annotated genes as input</strong> and prioritize on annotated splice junctions. To use this feature, you can</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">paftools<span class="hljs-selector-class">.js</span> gff2bed anno<span class="hljs-selector-class">.gff</span> &gt; anno<span class="hljs-selector-class">.bed</span><br>minimap2 -ax splice <span class="hljs-attr">--junc-bed</span> anno<span class="hljs-selector-class">.bed</span> ref<span class="hljs-selector-class">.fa</span> query<span class="hljs-selector-class">.fa</span> &gt; aln.sam<br></code></pre></td></tr></table></figure><p>Here, <code>anno.gff</code> is the gene annotation in the GTF or GFF3 format (<code>gff2bed</code> automatically tests the format). The output of <code>gff2bed</code> is in the 12-column BED format, or the BED12 format. With the <code>--junc-bed</code> option, minimap2 adds a bonus score (tuned by <code>--junc-bonus</code>) if an aligned junction matches a junction in the annotation. Option <code>--junc-bed</code> also takes 5-column BED, including the strand field. In this case, each line indicates an oriented junction.</p><h4 id="Find-overlaps-between-long-reads"><a href="#Find-overlaps-between-long-reads" class="headerlink" title="Find overlaps between long reads"></a>Find overlaps between long reads</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">minimap2</span> -x ava-pb  reads.fq reads.fq &gt; ovlp.paf    <span class="hljs-comment"># PacBio ã€CLR readã€‘ overlap</span><br>minimap2 -x ava-ont reads.fq reads.fq &gt; ovlp.paf    <span class="hljs-comment"># Oxford ã€Nanopore readã€‘ overlap</span><br></code></pre></td></tr></table></figure><p>Similarly, <code>ava-pb</code> uses HPC minimizers while <code>ava-ont</code> uses ordinary minimizers. It is usually not recommended to perform base-level alignment in the overlapping mode because it is slow and may produce false positive overlaps. However, if performance is not a concern, you may try to add <code>-a</code> or <code>-c</code> anyway.</p><h4 id="Map-short-accurate-genomic-reads"><a href="#Map-short-accurate-genomic-reads" class="headerlink" title="Map short accurate genomic reads"></a>Map short accurate genomic reads</h4><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript">minimap2 -ax sr <span class="hljs-keyword">ref</span>.fa reads-se.fq &gt; aln.sam           <span class="hljs-comment"># single-end alignment</span><br>minimap2 -ax sr <span class="hljs-keyword">ref</span>.fa read1.fq read2.fq &gt; aln.sam     <span class="hljs-comment"># paired-end alignment</span><br>minimap2 -ax sr <span class="hljs-keyword">ref</span>.fa reads-interleaved.fq &gt; aln.sam  <span class="hljs-comment"># paired-end alignment</span><br></code></pre></td></tr></table></figure><p>When two read files are specified, minimap2 reads from each file in turn and merge them into an interleaved stream internally. Two reads are considered to be paired if they are adjacent in the input stream and have the same name (with the <code>/[0-9]</code> suffix trimmed if present). Single- and paired-end reads can be mixed.</p><p>Minimap2 <strong>does not work well with short spliced reads</strong>. There are many capable RNA-seq mappers for short reads.</p><h4 id="Full-genome-x2F-assembly-alignment"><a href="#Full-genome-x2F-assembly-alignment" class="headerlink" title="Full genome&#x2F;assembly alignment"></a><font color="blue">Full genome&#x2F;assembly alignment</font></h4><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs d">minimap2 -ax asm5 <span class="hljs-keyword">ref</span>.fa <span class="hljs-keyword">asm</span>.fa &gt; aln.sam       # assembly to assembly/<span class="hljs-keyword">ref</span> alignment<br></code></pre></td></tr></table></figure><p>For <strong>cross-species</strong> full-genome alignment, the scoring system needs to be tuned according to the sequence divergence.</p><h3 id="Advanced-features"><a href="#Advanced-features" class="headerlink" title="Advanced features"></a>Advanced features</h3><h4 id="Working-with-gt-65535-CIGAR-operations"><a href="#Working-with-gt-65535-CIGAR-operations" class="headerlink" title="Working with &gt;65535 CIGAR operations"></a>Working with &gt;65535 CIGAR operations</h4><p>Due to a design flaw, BAM does not work with CIGAR strings with &gt;65535 operations (SAM and CRAM work). However, for <strong>ultra-long nanopore reads</strong> minimap2 may align ~1% of read bases with long CIGARs beyond the capability of BAM. If you convert such SAM&#x2F;CRAM to BAM, Picard and recent samtools will throw an error and abort. Older samtools and other tools may create corrupted BAM.</p><p>To avoid this issue, you can add option <code>-L</code> at the minimap2 command line. This option moves a long CIGAR to the <code>CG</code> tag and leaves a fully clipped CIGAR at the SAM CIGAR column. Current tools that donâ€™t read CIGAR (e.g. merging and sorting) still work with such BAM records; tools that read CIGAR will effectively ignore these records. It has been decided that future tools will seamlessly recognize long-cigar records generated by option <code>-L</code>.</p><p><strong>TL;DR</strong>: if you work with ultra-long reads and use tools that only process BAM files, please add option <code>-L</code>.</p><h4 id="The-cs-optional-tag"><a href="#The-cs-optional-tag" class="headerlink" title="The cs optional tag"></a>The cs optional tag</h4><p>The <code>cs</code> SAM&#x2F;PAF tag encodes bases at mismatches and INDELs. It matches regular expression <code>/(:[0-9]+|\*[a-z][a-z]|[=\+\-][A-Za-z]+)+/</code>. Like CIGAR, <code>cs</code> consists of series of operations. Each leading character specifies the operation; the following sequence is the one involved in the operation.</p><p>The <code>cs</code> tag is enabled by command line option <code>--cs</code>. The following alignment, for example:</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">CGATCGATAAATAGAGTAG---GAATAGCA<br>||||||<span class="hljs-string">   </span>||||||||||<span class="hljs-string">   </span>||||<span class="hljs-string"> </span>|||<br>CGATCG---AATAGAGTAGGTCGAATtGCA<br></code></pre></td></tr></table></figure><p>is represented as <code>:6-ata:10+gtc:4*at:3</code>, where <code>:[0-9]+</code> represents an identical block, <code>-ata</code> represents a deletion, <code>+gtc</code> an insertion and <code>*at</code> indicates reference base <code>a</code> is substituted with a query base <code>t</code>. It is similar to the <code>MD</code> SAM tag but is standalone and easier to parse.</p><p>If <code>--cs=long</code> is used, the <code>cs</code> string also contains identical sequences in the alignment. The above example will become <code>=CGATCG-ata=AATAGAGTAG+gtc=GAAT*at=GCA</code>. The long form of <code>cs</code> <strong>encodes both reference and query sequences in one string</strong>. The <code>cs</code> tag also encodes <strong>intron positions</strong> and <strong>splicing signals</strong> (see the <a href="https://lh3.github.io/minimap2/minimap2.html#10">minimap2 manpage</a> for details).</p><h4 id="Working-with-the-PAF-format"><a href="#Working-with-the-PAF-format" class="headerlink" title="Working with the PAF format"></a><font color="red">Working with the PAF format</font></h4><p>Minimap2 also comes with a (java)script <a href="https://github.com/lh3/minimap2/blob/master/misc/paftools.js">paftools.js</a> that processes alignments in the PAF format. It calls variants from assembly-to-reference alignment, lifts over BED files based on alignment, converts between formats and provides utilities for various evaluations. For details, please see <a href="https://github.com/lh3/minimap2/blob/master/misc/README.md">misc&#x2F;README.md</a>.</p><h3 id="Algorithm-overview"><a href="#Algorithm-overview" class="headerlink" title="Algorithm overview"></a>Algorithm overview</h3><p>In the following, minimap2 command line options have a dash ahead and are highlighted in bold. The description may help to tune minimap2 parameters.</p><ol><li>Read <strong>-I</strong> [&#x3D;<em>4G</em>] reference bases, extract (<strong>-k</strong>,<strong>-w</strong>)-minimizers and index them in a hash table.</li><li>Read <strong>-K</strong> [&#x3D;<em>200M</em>] query bases. For each query sequence, do step 3 through 7:</li><li>For each (<strong>-k</strong>,<strong>-w</strong>)-minimizer on the query, check against the reference index. If a reference minimizer is not among the top <strong>-f</strong> [&#x3D;<em>2e-4</em>] most frequent, collect its the occurrences in the reference, which are called <em>seeds</em>.</li><li>Sort seeds by position in the reference. Chain them with dynamic programming. Each chain represents a potential mapping. For read overlapping, report all chains and then go to step 8. For reference mapping, do step 5 through 7:</li><li>Let <em>P</em> be the set of primary mappings, which is an empty set initially. For each chain from the best to the worst according to their chaining scores: if on the query, the chain overlaps with a chain in <em>P</em> by <strong>â€“mask-level</strong> [&#x3D;<em>0.5</em>] or higher fraction of the shorter chain, mark the chain as <em>secondary</em> to the chain in <em>P</em>; otherwise, add the chain to <em>P</em>.</li><li>Retain all primary mappings. Also retain up to <strong>-N</strong> [&#x3D;<em>5</em>] top secondary mappings if their chaining scores are higher than <strong>-p</strong> [&#x3D;<em>0.8</em>] of their corresponding primary mappings.</li><li>If alignment is requested, filter out an internal seed if it potentially leads to both a long insertion and a long deletion. Extend from the left-most seed. Perform global alignments between internal seeds. Split the chain if the accumulative score along the global alignment drops by <strong>-z</strong> [&#x3D;<em>400</em>], disregarding long gaps. Extend from the right-most seed. Output chains and their alignments.</li><li>If there are more query sequences in the input, go to step 2 until no more queries are left.</li><li>If there are more reference sequences, reopen the query file from the start and go to step 1; otherwise stop.</li></ol><h3 id="Getting-help"><a href="#Getting-help" class="headerlink" title="Getting help"></a>Getting help</h3><p>Manpage <a href="https://lh3.github.io/minimap2/minimap2.html">minimap2.1</a> provides detailed description of minimap2 command line options and optional tags. The <a href="https://github.com/lh3/minimap2/blob/master/FAQ.md">FAQ</a>page answers several frequently asked questions. If you encounter bugs or have further questions or requests, you can raise an issue at the <a href="https://github.com/lh3/minimap2/issues">issue page</a>. There is not a specific mailing list for the time being.</p><h2 id="Limitations"><a href="#Limitations" class="headerlink" title="Limitations"></a>Limitations</h2><ul><li>Minimap2 may produce <strong>suboptimal alignments</strong> through <strong>long low-complexity regions</strong> where seed positions may be suboptimal. This should not be a big concern because even the optimal alignment may be wrong in such regions.</li><li>Minimap2 requires SSE2 instructions on x86 CPUs or NEON on ARM CPUs. It is possible to add non-SIMD support, but it would make minimap2 slower by several times.</li><li>Minimap2 <strong>does not work</strong> with a single query or database sequence ~<strong>2 billion bases or longer</strong> (2,147,483,647 to be exact). The total length of all sequences can well exceed this threshold.</li><li>Minimap2 often <strong>misses small exons</strong>.</li></ul><h2 id="methods"><a href="#methods" class="headerlink" title="methods"></a>methods</h2><p>Minimap2 follows a typical <strong>seed-chain-align procedure</strong> as is used by most full-genome aligners. It <strong>collects minimizers</strong> (Roberts <em>et al</em>., 2004) of the <strong>reference sequences</strong> and <strong>indexes them in a hash table</strong>, with the <strong>key</strong> being the hash of a minimizer and the <strong>value</strong> being a list of locations of the minimizer copies. Then for <strong>each query sequence</strong>, minimap2 takes query minimizers as <em>seeds</em>, finds exact matches (i.e. <em>anchors</em>) to the reference, and identifies sets of colinear anchors as <em>chains</em>. If base-level alignment is requested, minimap2 applies <strong>dynamic programming</strong> (DP) to extend from the ends of chains and to close regions between adjacent anchors in chains.</p><p>Minimap2 uses indexing and seeding algorithms similar to minimap (Li, 2016), and furthers the predecessor with more accurate chaining, the ability to produce base-level alignment and the support of spliced alignment.</p><h1 id="asm-vs-asm"><a href="#asm-vs-asm" class="headerlink" title="asm vs asm"></a>asm vs asm</h1><h2 id="Difference-of-SNP-amp-indel-between-asm-vs-asm"><a href="#Difference-of-SNP-amp-indel-between-asm-vs-asm" class="headerlink" title="Difference of SNP&amp;indel between asm vs asm"></a>Difference of SNP&amp;indel between asm vs asm</h2><p><a href="https://bleepcoder.com/cn/minimap2/296555096/a-best-practices-document-for-assembly-to-assembly">ref</a></p><p><code>paftools.js call</code>ç°åœ¨æ”¯æŒ VCF è¾“å‡ºã€‚ è¦ä½¿ç”¨å®ƒï¼Œè¯·å°†<code>-f ref.fa</code>åŠ åˆ°å‘½ä»¤è¡Œä¸­ï¼š</p><p>å¯¹åŒä¸€ç‰©ç§çš„asmä½¿ç”¨<code>asm5</code> ã€‚ å¦‚æœç•¥æœ‰ä¸åŒï¼Œè¯·ä½¿ç”¨<code>asm10</code> ã€‚ å¦‚æœåºåˆ—å·®å¼‚å¾ˆå¤§ï¼Œè¯·ä½¿ç”¨<code>-a</code> ã€‚</p><p>variant calling</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh">git <span class="hljs-built_in">clone</span> https://github.com/lh3/minimap2   <span class="hljs-comment"># you need the latest version; not from conda</span><br><span class="hljs-built_in">cd</span> minimap2 &amp;&amp; make<br><br>curl -L https://github.com/attractivechaos/k8/releases/download/v0.2.4/k8-0.2.4.tar.bz2 | tar -jxf -<br><span class="hljs-built_in">cp</span> k8-0.2.4/k8-`<span class="hljs-built_in">uname</span> -s` k8   <span class="hljs-comment"># or copy it to a directory on you $PATH</span><br><br>./minimap2 -c --cs ref.fa query.fa \<br>  | <span class="hljs-built_in">sort</span> -k6,6 -k8,8n \<br>  | ./k8 misc/paftools.js call -f ref.fa -L20000 - &gt; var.vcf<br></code></pre></td></tr></table></figure><p>ä¸¤asmå·®å¼‚å¤ªå¤§ã€‚ å¯ä»¥å…ˆå°è¯•ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">./minimap2 -c --cs ref.fa query.fa | <span class="hljs-built_in">sort</span> -k6,6 -k8,8n | ./k8 misc/paftools.js call -L20000 - &gt; var.txt<br></code></pre></td></tr></table></figure><p>ç”Ÿæˆvcfæ–¹æ³•</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">git <span class="hljs-built_in">clone</span> https://github.com/lh3/htsbox<br>(<span class="hljs-built_in">cd</span> htsbox &amp;&amp; make)<br>minimap2 -axasm5 wt_minion.fasta wt_pacbio.fasta | samtool <span class="hljs-built_in">sort</span> - &gt; sorted.bam<br>htsbox/htsbox pileup -q5 -S10000 -vcf wt_minion.fasta sorted.bam &gt; diff.vcf<br></code></pre></td></tr></table></figure><h2 id="convert-sam-asm-vs-asm-to-paf"><a href="#convert-sam-asm-vs-asm-to-paf" class="headerlink" title="convert sam(asm vs asm) to paf"></a>convert sam(asm vs asm) to paf</h2><p><a href="https://www.biostars.org/p/479287/">ref</a></p><p>Looks like no one has actually read the question correctly. <font color="blue"><strong>PAF is missing lots of information compared to SAM</strong></font>, because it is <font color="blue"><strong>a summary of alignment</strong></font>, but it also has <font color="blue">easy access to the <strong>alignment start</strong> and <strong>stop coordinates</strong>, <strong>sequences length</strong></font>, etc. Since <font color="blue">PAF is less information-dense you <strong>cannot convert in both directions</strong></font>.</p><p>There are several options:</p><ol><li>Use Heng Liâ€™s experimental toolkit, <font color="blue">htsbox samview -p in.bam</font>: <a href="https://github.com/lh3/htsbox">https://github.com/lh3/htsbox</a></li><li>Use <font color="green"><strong>paftools.js sam2paf</strong></font>: <a href="https://github.com/lh3/minimap2/blob/master/misc/README.md#introduction">https://github.com/lh3/minimap2/blob/master/misc/README.md#introduction</a></li><li>Use this <font color="blue">python</font> library: <a href="https://bioconvert.readthedocs.io/en/master/_modules/bioconvert/sam2paf.html">https://bioconvert.readthedocs.io/en/master/_modules/bioconvert/sam2paf.html</a></li></ol><h2 id="visualization-of-PAF-file-obtained-from-asm-vs-asm-in-minimap2"><a href="#visualization-of-PAF-file-obtained-from-asm-vs-asm-in-minimap2" class="headerlink" title="visualization of PAF file obtained from asm_vs_asm in minimap2"></a>visualization of PAF file obtained from asm_vs_asm in minimap2</h2><p><a href="https://www.jianshu.com/p/befb3a440aed">Ref</a></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs r">source<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;.paf.R&quot;</span><span class="hljs-punctuation">)</span><br>df <span class="hljs-operator">&lt;-</span> read.paf<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;./asm_vs_ref.paf&quot;</span><span class="hljs-punctuation">)</span><br>plot_synteny<span class="hljs-punctuation">(</span>df<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><blockquote><p>gridç³»ç»Ÿé‡Œé¢çš„è§†å›¾(viewport)å¯ä»¥ç»§ç»­åˆ†ä¸ºå¤šä¸ªå›¾å±‚ï¼Œæ¯ä¸ªå›¾å±‚å¯æœ‰ä¸åŒçš„åæ ‡ç³»ç»Ÿã€‚</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><code class="hljs r">read.paf <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>file<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;\t&quot;</span><span class="hljs-punctuation">,</span><br>                     header <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span><br>                     MQ <span class="hljs-operator">=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span><br>                     ...<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  data <span class="hljs-operator">&lt;-</span> readLines<span class="hljs-punctuation">(</span>file<span class="hljs-punctuation">)</span><br>  <br>  dataSize <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span><br>  <span class="hljs-comment"># initialize </span><br>  qName   <span class="hljs-operator">&lt;-</span> vector<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;character&quot;</span><span class="hljs-punctuation">,</span> dataSize<span class="hljs-punctuation">)</span><br>  qLength <span class="hljs-operator">&lt;-</span> vector<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;integer&quot;</span><span class="hljs-punctuation">,</span> dataSize<span class="hljs-punctuation">)</span><br>  qStart  <span class="hljs-operator">&lt;-</span> vector<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;integer&quot;</span><span class="hljs-punctuation">,</span> dataSize<span class="hljs-punctuation">)</span><br>  qEnd    <span class="hljs-operator">&lt;-</span> vector<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;integer&quot;</span><span class="hljs-punctuation">,</span> dataSize<span class="hljs-punctuation">)</span><br>  strand  <span class="hljs-operator">&lt;-</span> vector<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;character&quot;</span><span class="hljs-punctuation">,</span> dataSize<span class="hljs-punctuation">)</span><br>  tName   <span class="hljs-operator">&lt;-</span> vector<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;character&quot;</span><span class="hljs-punctuation">,</span> dataSize<span class="hljs-punctuation">)</span><br>  tLength <span class="hljs-operator">&lt;-</span> vector<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;integer&quot;</span><span class="hljs-punctuation">,</span> dataSize<span class="hljs-punctuation">)</span><br>  tStart  <span class="hljs-operator">&lt;-</span> vector<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;integer&quot;</span><span class="hljs-punctuation">,</span> dataSize<span class="hljs-punctuation">)</span><br>  tEnd    <span class="hljs-operator">&lt;-</span> vector<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;integer&quot;</span><span class="hljs-punctuation">,</span> dataSize<span class="hljs-punctuation">)</span><br>  reMatch <span class="hljs-operator">&lt;-</span> vector<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;integer&quot;</span><span class="hljs-punctuation">,</span> dataSize<span class="hljs-punctuation">)</span><br>  bLength <span class="hljs-operator">&lt;-</span> vector<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;integer&quot;</span><span class="hljs-punctuation">,</span> dataSize<span class="hljs-punctuation">)</span><br>  mQuality<span class="hljs-operator">&lt;-</span> vector<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;integer&quot;</span><span class="hljs-punctuation">,</span> dataSize<span class="hljs-punctuation">)</span><br><br>  i <span class="hljs-operator">&lt;-</span> 1<br>  j <span class="hljs-operator">&lt;-</span> 0<br>  <span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> seq<span class="hljs-punctuation">(</span>dataSize<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>    items   <span class="hljs-operator">&lt;-</span> strsplit<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> split <span class="hljs-operator">=</span> sep<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br>    <br>    quality <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>items<span class="hljs-punctuation">[</span><span class="hljs-number">12</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-comment">#Mapping Quality 0-255</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>quality <span class="hljs-operator">&lt;</span> MQ<span class="hljs-punctuation">)</span><br>      <span class="hljs-keyword">next</span><br>    j <span class="hljs-operator">&lt;-</span> j <span class="hljs-operator">+</span> <span class="hljs-number">1</span><br>    qName<span class="hljs-punctuation">[</span>j<span class="hljs-punctuation">]</span>   <span class="hljs-operator">&lt;-</span> items<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-comment"># Query sequence name</span><br>    qLength<span class="hljs-punctuation">[</span>j<span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.integer</span><span class="hljs-punctuation">(</span>items<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>    qStart<span class="hljs-punctuation">[</span>j<span class="hljs-punctuation">]</span>  <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.integer</span><span class="hljs-punctuation">(</span>items<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <span class="hljs-number">1L</span><br>    qEnd<span class="hljs-punctuation">[</span>j<span class="hljs-punctuation">]</span>    <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.integer</span><span class="hljs-punctuation">(</span>items<span class="hljs-punctuation">[</span><span class="hljs-number">4</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <span class="hljs-number">1L</span> <span class="hljs-comment"># convert 0-based to 1-based</span><br>    strand<span class="hljs-punctuation">[</span>j<span class="hljs-punctuation">]</span>  <span class="hljs-operator">&lt;-</span> items<span class="hljs-punctuation">[</span><span class="hljs-number">5</span><span class="hljs-punctuation">]</span> <span class="hljs-comment"># Relative strand: &quot;+&quot; or &quot;-&quot;</span><br>    tName<span class="hljs-punctuation">[</span>j<span class="hljs-punctuation">]</span>   <span class="hljs-operator">&lt;-</span> items<span class="hljs-punctuation">[</span><span class="hljs-number">6</span><span class="hljs-punctuation">]</span> <span class="hljs-comment"># Target sequence name</span><br>    tLength<span class="hljs-punctuation">[</span>j<span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.integer</span><span class="hljs-punctuation">(</span>items<span class="hljs-punctuation">[</span><span class="hljs-number">7</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>    tStart<span class="hljs-punctuation">[</span>j<span class="hljs-punctuation">]</span>  <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.integer</span><span class="hljs-punctuation">(</span>items<span class="hljs-punctuation">[</span><span class="hljs-number">8</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <span class="hljs-number">1L</span><br>    tEnd<span class="hljs-punctuation">[</span>j<span class="hljs-punctuation">]</span>    <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.integer</span><span class="hljs-punctuation">(</span>items<span class="hljs-punctuation">[</span><span class="hljs-number">9</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <span class="hljs-number">1L</span><br>    reMatch<span class="hljs-punctuation">[</span>j<span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.integer</span><span class="hljs-punctuation">(</span>items<span class="hljs-punctuation">[</span><span class="hljs-number">10</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment">#Number of residue matches</span><br>    bLength<span class="hljs-punctuation">[</span>j<span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.integer</span><span class="hljs-punctuation">(</span>items<span class="hljs-punctuation">[</span><span class="hljs-number">11</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-comment">#Alignment block length</span><br>    mQuality<span class="hljs-punctuation">[</span>j<span class="hljs-punctuation">]</span><span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.integer</span><span class="hljs-punctuation">(</span>items<span class="hljs-punctuation">[</span><span class="hljs-number">12</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-comment">#Alignment block length</span><br>  <span class="hljs-punctuation">&#125;</span> <br>    pafDataframe <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span>qName <span class="hljs-operator">=</span> qName<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>j<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> qStart <span class="hljs-operator">=</span> qStart<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>j<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> qEnd <span class="hljs-operator">=</span> qEnd<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>j<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                               tName <span class="hljs-operator">=</span> tName<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>j<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> tStart <span class="hljs-operator">=</span> tStart<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>j<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> tEnd <span class="hljs-operator">=</span> tEnd<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>j<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                               qLength <span class="hljs-operator">=</span> qLength<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>j<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> tLength <span class="hljs-operator">=</span> tLength<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>j<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br>                               strand  <span class="hljs-operator">=</span> strand<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>j<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                               reMatch <span class="hljs-operator">=</span> reMatch<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>j<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> bLength <span class="hljs-operator">=</span> bLength<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>j<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                               mQuality <span class="hljs-operator">=</span> mQuality<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>j<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                               stringsAsFactors <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span>pafDataframe<span class="hljs-punctuation">)</span> <br><span class="hljs-punctuation">&#125;</span><br><br><br>plot_synteny <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>df<span class="hljs-punctuation">,</span> contigs <span class="hljs-operator">=</span> <span class="hljs-number">20</span><span class="hljs-punctuation">,</span><br>                         lineSize <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span><br>                         borderCol <span class="hljs-operator">=</span> <span class="hljs-string">&quot;#5496ff&quot;</span><span class="hljs-punctuation">,</span>... <span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  <br>  <span class="hljs-comment"># select the top N contig</span><br>  x <span class="hljs-operator">&lt;-</span> df<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;qName&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;qLength&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>  x <span class="hljs-operator">&lt;-</span> x<span class="hljs-punctuation">[</span><span class="hljs-operator">!</span>duplicated<span class="hljs-punctuation">(</span>x<span class="hljs-operator">$</span>qName<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>  x <span class="hljs-operator">&lt;-</span> x<span class="hljs-punctuation">[</span>order<span class="hljs-punctuation">(</span>x<span class="hljs-operator">$</span>qLength<span class="hljs-punctuation">,</span> decreasing <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>contigs<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>  y <span class="hljs-operator">&lt;-</span> df<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;tName&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;tLength&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>  y <span class="hljs-operator">&lt;-</span> y<span class="hljs-punctuation">[</span><span class="hljs-operator">!</span>duplicated<span class="hljs-punctuation">(</span>y<span class="hljs-operator">$</span>tName<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>  y <span class="hljs-operator">&lt;-</span> y<span class="hljs-punctuation">[</span>order<span class="hljs-punctuation">(</span>y<span class="hljs-operator">$</span>tLength<span class="hljs-punctuation">,</span> decreasing <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>contigs<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>  <br>  <span class="hljs-comment"># make new page for ploting</span><br>  grid<span class="hljs-operator">::</span>grid.newpage<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>  <br>  <span class="hljs-comment"># allot the ratio of each contig</span><br>  x_frac <span class="hljs-operator">&lt;-</span> x<span class="hljs-operator">$</span>qLength <span class="hljs-operator">/</span> <span class="hljs-built_in">sum</span><span class="hljs-punctuation">(</span>x<span class="hljs-operator">$</span>qLength<span class="hljs-punctuation">)</span><br>  y_frac <span class="hljs-operator">&lt;-</span> y<span class="hljs-operator">$</span>tLength <span class="hljs-operator">/</span> <span class="hljs-built_in">sum</span><span class="hljs-punctuation">(</span>y<span class="hljs-operator">$</span>tLength<span class="hljs-punctuation">)</span><br>  <br>  <span class="hljs-comment"># draw the contig name</span><br>  grid<span class="hljs-operator">::</span>pushViewport<span class="hljs-punctuation">(</span>grid<span class="hljs-operator">::</span>viewport<span class="hljs-punctuation">(</span>height <span class="hljs-operator">=</span> <span class="hljs-number">0.7</span><span class="hljs-punctuation">,</span><br>                        width <span class="hljs-operator">=</span>  <span class="hljs-number">0.7</span><span class="hljs-punctuation">,</span><br>                        gp <span class="hljs-operator">=</span> grid<span class="hljs-operator">::</span>gpar<span class="hljs-punctuation">(</span>cex <span class="hljs-operator">=</span> <span class="hljs-number">0.75</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                        name <span class="hljs-operator">=</span> <span class="hljs-string">&quot;contigName&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>  x_pos <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">cumsum</span><span class="hljs-punctuation">(</span>x_frac<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-punctuation">(</span>contigs<span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>  y_pos <span class="hljs-operator">&lt;-</span> 1<span class="hljs-operator">-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">cumsum</span><span class="hljs-punctuation">(</span>y_frac<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-punctuation">(</span>contigs<span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-built_in">seq.int</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span>contigs<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>    grid<span class="hljs-operator">::</span>grid.text<span class="hljs-punctuation">(</span>label <span class="hljs-operator">=</span> x<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br>              x <span class="hljs-operator">=</span> grid<span class="hljs-operator">::</span>unit<span class="hljs-punctuation">(</span>x_pos<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>              y <span class="hljs-operator">=</span> grid<span class="hljs-operator">::</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>              just <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;left&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;bottom&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>              rot <span class="hljs-operator">=</span> <span class="hljs-number">35</span><br>              <span class="hljs-punctuation">)</span><br>    grid<span class="hljs-operator">::</span>grid.text<span class="hljs-punctuation">(</span>label <span class="hljs-operator">=</span> y<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>              x <span class="hljs-operator">=</span> grid<span class="hljs-operator">::</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>              y <span class="hljs-operator">=</span> grid<span class="hljs-operator">::</span>unit<span class="hljs-punctuation">(</span>y_pos<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>              just <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;left&quot;</span><span class="hljs-punctuation">)</span><br>              <span class="hljs-punctuation">)</span><br>    <br>  <span class="hljs-punctuation">&#125;</span><br>  <br>  vplay <span class="hljs-operator">&lt;-</span> grid<span class="hljs-operator">::</span>grid.layout<span class="hljs-punctuation">(</span>contigs<span class="hljs-punctuation">,</span> contigs<span class="hljs-punctuation">,</span> <br>                       widths  <span class="hljs-operator">=</span> x_frac<span class="hljs-punctuation">,</span><br>                       heights <span class="hljs-operator">=</span> y_frac<span class="hljs-punctuation">)</span><br>  grid<span class="hljs-operator">::</span>pushViewport<span class="hljs-punctuation">(</span>grid<span class="hljs-operator">::</span>viewport<span class="hljs-punctuation">(</span>layout <span class="hljs-operator">=</span> vplay<span class="hljs-punctuation">,</span><br>                        name <span class="hljs-operator">=</span> <span class="hljs-string">&quot;vplay&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>  <br>  <br>  <span class="hljs-comment"># line represent the synteny</span><br>  <span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span> i <span class="hljs-keyword">in</span> seq<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> contigs<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>j <span class="hljs-keyword">in</span> seq<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> contigs<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>      <br>      <span class="hljs-comment"># get the name and length for subsetting</span><br>      xName   <span class="hljs-operator">&lt;-</span> x<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>      xLength <span class="hljs-operator">&lt;-</span> x<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>      yName   <span class="hljs-operator">&lt;-</span> y<span class="hljs-punctuation">[</span>j<span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <br>      yLength <span class="hljs-operator">&lt;-</span> y<span class="hljs-punctuation">[</span>j<span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>      <br>      <span class="hljs-comment"># push view port for plot Collinearity</span><br>      grid<span class="hljs-operator">::</span>pushViewport<span class="hljs-punctuation">(</span>grid<span class="hljs-operator">::</span>viewport<span class="hljs-punctuation">(</span>layout.pos.col <span class="hljs-operator">=</span> i<span class="hljs-punctuation">,</span><br>                            layout.pos.row <span class="hljs-operator">=</span> j<span class="hljs-punctuation">,</span><br>                            xscale <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> xLength<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                            yscale <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> yLength<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                            name <span class="hljs-operator">=</span> paste0<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;pos&quot;</span><span class="hljs-punctuation">,</span>i<span class="hljs-punctuation">,</span>j<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>  <br>      grid<span class="hljs-operator">::</span>grid.rect<span class="hljs-punctuation">(</span>gp<span class="hljs-operator">=</span>grid<span class="hljs-operator">::</span>gpar<span class="hljs-punctuation">(</span>col<span class="hljs-operator">=</span>borderCol<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>      <span class="hljs-comment"># select the data</span><br>      plot_df <span class="hljs-operator">&lt;-</span> df<span class="hljs-punctuation">[</span>df<span class="hljs-operator">$</span>qName <span class="hljs-operator">==</span> xName <span class="hljs-operator">&amp;</span> df<span class="hljs-operator">$</span>tName <span class="hljs-operator">==</span> yName<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span> <br>      blocks <span class="hljs-operator">&lt;-</span> nrow<span class="hljs-punctuation">(</span>plot_df<span class="hljs-punctuation">)</span><br>      <span class="hljs-comment">#cat(sprintf(&quot;block size is %d\n&quot;, blocks))</span><br>      <br>      <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>blocks <span class="hljs-operator">==</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>        grid<span class="hljs-operator">::</span>upViewport<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <br>        <span class="hljs-keyword">next</span><br>      <span class="hljs-punctuation">&#125;</span><br>      <br>      <span class="hljs-comment"># plot the line</span><br>      <span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>k <span class="hljs-keyword">in</span> seq<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> blocks<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>plot_df<span class="hljs-operator">$</span>strand<span class="hljs-punctuation">[</span>k<span class="hljs-punctuation">]</span> <span class="hljs-operator">==</span> <span class="hljs-string">&quot;+&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>          grid<span class="hljs-operator">::</span>grid.lines<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span>plot_df<span class="hljs-operator">$</span>qStart<span class="hljs-punctuation">[</span>k<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> plot_df<span class="hljs-operator">$</span>qEnd<span class="hljs-punctuation">[</span>k<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                     y <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span>plot_df<span class="hljs-operator">$</span>tStart<span class="hljs-punctuation">[</span>k<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> plot_df<span class="hljs-operator">$</span>tEnd<span class="hljs-punctuation">[</span>k<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                     gp<span class="hljs-operator">=</span>grid<span class="hljs-operator">::</span>gpar<span class="hljs-punctuation">(</span>lwd <span class="hljs-operator">=</span> lineSize<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                     default.units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;native&quot;</span><span class="hljs-punctuation">)</span><br>        <span class="hljs-punctuation">&#125;</span> <span class="hljs-keyword">else</span> <span class="hljs-punctuation">&#123;</span><br>          grid<span class="hljs-operator">::</span>grid.lines<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span>plot_df<span class="hljs-operator">$</span>qStart<span class="hljs-punctuation">[</span>k<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> plot_df<span class="hljs-operator">$</span>qEnd<span class="hljs-punctuation">[</span>k<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                     y <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span>plot_df<span class="hljs-operator">$</span>tEnd<span class="hljs-punctuation">[</span>k<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> plot_df<span class="hljs-operator">$</span>tStart<span class="hljs-punctuation">[</span>k<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                     gp<span class="hljs-operator">=</span>grid<span class="hljs-operator">::</span>gpar<span class="hljs-punctuation">(</span>lwd <span class="hljs-operator">=</span> lineSize<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                     default.units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;native&quot;</span><span class="hljs-punctuation">)</span><br>        <span class="hljs-punctuation">&#125;</span><br><br>      <span class="hljs-punctuation">&#125;</span><br>      <br>      grid<span class="hljs-operator">::</span>upViewport<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>denovo-III</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HiFi-7-[HiFi+HiC-assembly-method]</title>
    <link href="/GeekFocus/2022/03/16/2022-03-16-HiFi-7-HiC-assembly2/"/>
    <url>/GeekFocus/2022/03/16/2022-03-16-HiFi-7-HiC-assembly2/</url>
    
    <content type="html"><![CDATA[<p>è¾…åŠ©ç»„è£…æ¡ˆä¾‹2</p><span id="more"></span><p>searchï¼šHiFi Hi-C  <a href="https://pubmed.ncbi.nlm.nih.gov/?term=HiFi%20Hi-C&amp;page=2">https://pubmed.ncbi.nlm.nih.gov/?term=HiFi%20Hi-C&amp;page=2</a></p><h1 id="1-2021-09-äºšéº»çº¤ç»´"><a href="#1-2021-09-äºšéº»çº¤ç»´" class="headerlink" title="1. 2021.09 äºšéº»çº¤ç»´"></a>1. 2021.09 äºšéº»çº¤ç»´</h1><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8473814/#">Front Genet.</a> 2021; 12: 735690.  cite1</p><p>Published online 2021 Sep 13. doi: <a href="https://dx.doi.org/10.3389%2Ffgene.2021.735690">10.3389&#x2F;fgene.2021.735690</a></p><blockquote><p>Chromosome-Level Genome Assembly and Annotation of the Fiber Flax (<em>Linum usitatissimum</em>) Genome</p></blockquote><p><strong>Genome Assembly</strong></p><p>The HiFi long reads were assembled by <strong>Hifiasm</strong> v0.13-r308 with the <strong>default parameters</strong>. Then the <strong>HiFi reads were mapped back to the assembly</strong> to generate a <strong>coverage distribution plot</strong> using <strong>minimap2</strong> 2.17-r941. According to the <strong>covering depth</strong>, <strong>purge_dups</strong> v1.2.5 (Guan et al., <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8473814/#B22">2020</a>) was applied to <strong>remove redundant haplotigs</strong>. The <strong>Juicer v1.6</strong> (Durand et al., <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8473814/#B15">2016</a>) and <strong>3D-DNA</strong> v180922 (Dudchenko et al., <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8473814/#B13">2017</a>) pipelines were used to process the <strong>Hi-C data and scaffold the assembly</strong>. The results were polished using the <strong>Juicebox Assembly Tools</strong> v1.11.08 (Dudchenko et al., <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8473814/#B14">2018</a>). The CDC Bethune v2 assembly has made most use of the long continuity of optical maps. To further improve the accuracy of order and orient in our assembly, we integrated information from the <strong>Hi-C scaffolding</strong> and the CDC Bethune v2 assembly using the ALLMAPS pipeline (Tang et al., <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8473814/#B55">2015b</a>) implemented in jcvi utility libraries (Tang et al., <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8473814/#B54">2015a</a>).</p><h1 id="2-2021-06-ç«ç‘°ğŸŒ¹"><a href="#2-2021-06-ç«ç‘°ğŸŒ¹" class="headerlink" title="2. 2021.06 ç«ç‘°ğŸŒ¹"></a>2. 2021.06 ç«ç‘°ğŸŒ¹</h1><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8213826/#">Hortic Res.</a> 2021; 8: 141.  cite4</p><p>Published online 2021 Jun 18. doi: <a href="https://dx.doi.org/10.1038%2Fs41438-021-00594-z">10.1038&#x2F;s41438-021-00594-z</a></p><blockquote><p>A chromosome-level genome assembly of rugged rose (<em>Rosa rugosa</em>) provides insights into its evolution, ecology, and floral characteristics</p></blockquote><p><strong>Genome assembly and quality evaluation</strong></p><p>Approximately 59.2â€‰Gb of raw HiFi sequencing reads was obtained from the rosa DNA library. We first used <strong>HiCanu</strong> v2.2.1 for preliminary assembly of the rosa genome. Then, <strong>Redundans</strong> v 0.14a<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8213826/#CR27">27</a> was performed to <strong>remove the redundant sequences</strong>. A total of 150.6â€‰Gb of <strong>Hi-C data</strong> were obtained to <strong>anchor</strong> the contig onto the chromosome. We <strong>aligned Hi-C</strong> reads to assembly by <strong>BWA</strong> v 0.7.17-r1188<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8213826/#CR28">28</a>. Next, the <strong>draft assembly genome</strong> was <strong>scaffolded with Hi-C reads by 3D-DNA</strong> v180114<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8213826/#CR29">29</a>. Then, <strong>Juicer</strong> was used to <strong>filter the sequence and cluster it</strong>, and the <strong>Juicerbox tool</strong><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8213826/#CR30">30</a> was applied to <strong>manually adjust chromosome construction</strong>. We finally <strong>anchored the scaffolds on seven chromosomes</strong>. In addition, the <strong>BUSCO</strong> v3.0.2pipeline was used to assess the completeness and accuracy of the <em>R. rugosa</em> genome with the embryophyte_odb10 dataset, which contains 1614 BUSCO gene sets.</p><h1 id="3-2022-02-é¦™è‡"><a href="#3-2022-02-é¦™è‡" class="headerlink" title="3. 2022.02 é¦™è‡"></a>3. 2022.02 é¦™è‡</h1><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8877449/#">J Fungi (Basel).</a> 2022 Feb; 8(2): 167. </p><p>Published online 2022 Feb 9. doi: <a href="https://dx.doi.org/10.3390%2Fjof8020167">10.3390&#x2F;jof8020167</a></p><blockquote><p>Haplotype-Resolved Genome Analyses Reveal Genetically Distinct Nuclei within a Commercial Cultivar of <em>Lentinula edodes</em></p></blockquote><p><strong>Genome Sequencing and Assembly</strong></p><p>SMRTbell libraries were sequenced on a PacBio Sequel II system, and consensus reads (HiFi reads) were generated using ccs software (<a href="https://github.com/pacificbiosci-ences/unanimity">https://github.com/pacificbiosci-ences/unanimity</a>, accessed on 22 December 2021) with the parameter â€œâ€“inPasses 3â€. We generated 8.65 Gb and 5.35 Gb PacBio HiFi reads of SP3 and SP30, respectively. These long (~15 kb) and highly accurate (&gt;99%) HiFi reads were assembled using <strong>HiCanu</strong> [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8877449/#B18-jof-08-00167">18</a>] for both strains with <strong>default parameters</strong>.</p><p>The vegetative mycelia of SP3 and SP30 were also used to generate Hi-C DNA libraries at the Frasergen Enterprise (Wuhan, China). The Hi-C libraries were quantified and sequenced on the Illumina Nova-seq platform (San Diego, CA, USA). The chimeric fragments from the original cross-linked long-distance physical interactions were then isolated and processed into libraries. For anchored contigs, 34,909,404 and 31,267,524 clean <strong>reads</strong> were generated from the Hi-C library and were <strong>mapped</strong> to the SP3 and SP30 <strong>preliminary assembly</strong> using <strong>Juicer</strong> [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8877449/#B20-jof-08-00167">20</a>] with default parameters. Paired reads mapped to different contigs were used for the Hi-C associated scaffolding. Self-ligated, non-ligated, and other invalid reads were filtered out. We applied <strong>3D-DNA</strong> to <strong>order</strong> and <strong>orient</strong> the clustered contigs. Then, <strong>Juicer</strong> was used to filter the sequences and cluster them, and the <strong>Juicebox</strong> was applied to <strong>adjust chromosome construction manually</strong> (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8877449/#app1-jof-08-00167">Figure S2</a>). We finally <strong>anchored the scaffolds on ten chromosomes</strong>. In addition, the BUSCO v3.0.231 pipeline was used to assess the completeness and accuracy of the SP3 and SP30 genomes.</p><p><img src="/GeekFocus/2022-03-16-HiFi-7-HiC-assembly2/1.png"><br><img src="/GeekFocus/img/2022-03-16-HiFi-7-HiC-assembly2/1.png"></p><h1 id="4-2021-04-benchmark"><a href="#4-2021-04-benchmark" class="headerlink" title="4 2021.04 benchmark"></a>4 2021.04 benchmark</h1><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#">Mol Med Rep.</a> 2021 Apr; 23(4): 251. </p><p>Published online 2021 Feb 2. doi: <a href="https://dx.doi.org/10.3892%2Fmmr.2021.11890">10.3892&#x2F;mmr.2021.11890</a></p><blockquote><p>Benchmarking of next and third generation sequencing technologies and their associated algorithms for <em>de novo</em> genome assembly</p></blockquote><p><strong>Genome assembly</strong> </p><p>In order to assess the hybrid assembly strategy, the present study chose to evaluate two pipelines, MaSuRCA (version 3.3.5) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b27-mmr-0-0-11890">27</a>,<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b28-mmr-0-0-11890">28</a>) and Wengan (version 0.1) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b29-mmr-0-0-11890">29</a>). MaSuRCA workflow offers three different assemblers, CABOG (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b30-mmr-0-0-11890">30</a>), SOAPdenovo (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b31-mmr-0-0-11890">31</a>) and Flye (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b32-mmr-0-0-11890">32</a>). The pipeline was tested using CABOG and Flye assemblers, which are designed for long-read assembly. Wengan pipeline is based on DiscovarDenovo assembler (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b33-mmr-0-0-11890">33</a>).</p><p>Canu (version 2.0) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b34-mmr-0-0-11890">34</a>) is a long-read assembler, designed to use long high-noise single-molecule sequencing data, such as Nanopore and PacBio reads. Its workflow is based on the Celera assembler (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b35-mmr-0-0-11890">35</a>) which was used in the Human Genome Project to produce the first draft of the human genome. <strong>Hifiasm</strong> (version 0.13) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b36-mmr-0-0-11890">36</a>) and <strong>HiCanu</strong> (Canu version 2.1.1) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b37-mmr-0-0-11890">37</a>) are long-read assemblers exclusively <strong>for HiFi reads.</strong> The <strong>main difference</strong> between HiFi assemblers and the ones mentioned previously, is that <strong>Hifiasm and HiCanu produce phased assemblies</strong>. A phased assembly is a <strong>haplotype-resolved assembly</strong>, where <strong>high complexity regions</strong>, such as <strong>genes</strong>, will be <strong>separated into two different alleles</strong> (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b36-mmr-0-0-11890">36</a>,<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b38-mmr-0-0-11890">38</a>). HiCanu is a modified version of Canu, adapted to take advantage of the characteristics of HiFi reads. <strong>Hifiasm</strong> produces <strong>two different files</strong> for the <strong>primary</strong> and <strong>alternative</strong> assembly, whereas <strong>HiCanu</strong> <strong>combines</strong> the <strong>primary and the alternative</strong> assembly in the <strong>same FASTA file</strong>.</p><p><strong>Scaffolding</strong> </p><p>In order to test the necessity of scaffolding, a scaffolder was used to improve the assembly <strong>continuity</strong> and <strong>completeness</strong>, as follows: <strong>Hi-C data are mapped</strong> to the <strong>primary assembly</strong> by <strong>Arima</strong> mapping pipeline (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b39-mmr-0-0-11890">39</a>), to produce a BAM file which is consequently converted to a BED file. <strong>SALSA</strong> (version 2.2) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b40-mmr-0-0-11890">40</a>) uses this BED file which contains the mapping information of Hi-C reads on the assembly, <strong>to scaffold</strong> the primary assembly.</p><p><strong>Quality control metrics</strong></p><p>QUAST (version 5.0.2)</p><p><strong>Genome consistency plots</strong></p><p>JupiterPlot (version 1.0) </p><h1 id="5-2022-02-PJ-ç•ªèŒ„ğŸ…"><a href="#5-2022-02-PJ-ç•ªèŒ„ğŸ…" class="headerlink" title="5. 2022.02-PJ ç•ªèŒ„ğŸ…"></a>5. 2022.02-PJ ç•ªèŒ„ğŸ…</h1><blockquote><p>A chromosome scale tomato genome built from complementary PacBio and Nanopore sequences alone reveals extensive linkage drag during breeding</p></blockquote><p><a href="https://pubmed.ncbi.nlm.nih.gov/35106855/">https://pubmed.ncbi.nlm.nih.gov/35106855/</a></p><p>PacBio HiFi reads were independently assembled using Hifiasm and Canu, with respective N50 values of 31.3 and 17â€‰Mbp (Tableâ€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-tbl-0002">2</a>). Both HiFi assemblies <strong>contained single contigs that spanned the full length of the SL4.0 reference chromosome 5</strong> (Figureâ€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#support-information-section">S1</a>). We checked for the completeness of the assembly of gene sequences by Benchmarking Universal Single Copy Orthologs (BUSCO) analysis which showed both assemblies were almost gene complete (both 98.4%), slightly improving upon the SL4.0 genome and comparable to the <em>S. pimpinellifolium</em> â€˜LA2093â€™ genome.</p><p><strong>Hifiasm</strong> v0.14.2 (Cheng etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0013">2021</a>) was used to assemble the HiFi reads with default settings. Canu v2.1.1 was used to assemble the HiFi reads in â€˜HiCanuâ€™ mode (Nurk etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0050">2020</a>) with an estimated genome size of 916â€‰Mbp based on kmer counting of the raw HiFi data using Jellyfish v2.2.6 (MarÃ§ais &amp; Kingsford,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0044">2011</a>).</p><p><strong>Quast</strong> v5.0.2 (Mikheenko etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0047">2018</a>) and GAAS v1.1.0 (<a href="https://github.com/NBISweden/GAAS">https://github.com/NBISweden/GAAS</a>) were used to <strong>calculate statistics on fasta files</strong>. BUSCO was calculated using BUSCO v5.2.1 (Seppey etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0068">2019</a>) depending on hmmsearch v3.1, and metaeuk v4.a0f584d was used with lineage datasets solanales (<a href="https://busco-data.ezlab.org/v5/data/lineages/solanales_odb10.2020-08-05.tar.gz">https://busco-data.ezlab.org/v5/data/lineages/solanales_odb10.2020-08-05.tar.gz</a>) and eudicots (<a href="https://busco-data.ezlab.org/v5/data/lineages/eudicots_odb10.2020-09-10.tar.gz">https://busco-data.ezlab.org/v5/data/lineages/eudicots_odb10.2020-09-10.tar.gz</a>) to obtain evolutionarily informed expectations of gene content. To assess the LAI, LTR retriever v2.9.0 (Ou etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0051">2018</a>) was run with default settings on the respective genome assemblies.</p><p>We ran one single round of <strong>Salsa</strong> v2.2 (Ghurye etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0026">2019</a>) with optional settings: <strong>-e DNASE -m yes -p yes</strong>.</p><p>A modified version of the <strong>convert.sh</strong> script was used to convert the Salsa2 output to a Hi-C file, which was used within a local installation of <strong>Juicebox</strong> (<a href="https://github.com/aidenlab/Juicebox">https://github.com/aidenlab/Juicebox</a>) v1.11.08 to generate a <strong>Hi-C contact plot.</strong></p><p>The MbTMV genome assembly was aligned to SL4.0 (Hosmani etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0030">2019</a>) using <strong>Minimap2</strong> v2.17 (Li,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0039">2018</a>) with default settings, followed by running RaGOO v1.11 (Alonge etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0003">2019</a>) with default options.</p><h1 id="6-2021-09-gpb-æ‹Ÿå—èŠ¥"><a href="#6-2021-09-gpb-æ‹Ÿå—èŠ¥" class="headerlink" title="6. 2021.09-gpb æ‹Ÿå—èŠ¥"></a>6. 2021.09-gpb æ‹Ÿå—èŠ¥</h1><blockquote><p>High-quality Arabidopsis thaliana Genome Assembly with Nanopore and HiFi Long Reads</p></blockquote><p><a href="https://pubmed.ncbi.nlm.nih.gov/34487862/">https://pubmed.ncbi.nlm.nih.gov/34487862/</a></p><p><strong>HiFi sequencing and assembly</strong></p><p>Sequencing was performed on a PacBio Sequel II instrument with Sequencing Primer V2 and Sequel II Binding Kit 2.0 at the Genome Center of Grandomics. A total of 22.90 Gb of HiFi reads with âˆ¼157 Ã— coverage were generated, and N50 of the reads was 15,424 bp. HiFi reads were assembled using <strong>hifiasm</strong> v. 0.14-r312 [<a href="https://www.sciencedirect.com/science/article/pii/S1672022921001741?via=ihub#b0085">17]</a>with <strong>default parameters</strong>, and the <strong>gfatools</strong> (<a href="https://github.com/lh3/gfatools">https://github.com/lh3/gfatools</a>) was used to convert sequence graphs in the <strong>GFA to FASTA</strong> format.</p><p><strong>Hi-C sequencing and scaffolding</strong></p><p>Hi-C library was prepared from cross-linked chromatins of plant cells using a standard Hi-C protocol; the library was then sequenced using Illumina NovaSeq 6000. A total of 21.14 Gb of Hi-C reads with âˆ¼158 Ã— coverage were generated. The Hi-C sequencing data were used to <strong>anchor</strong> all contigs using <strong>Juicer</strong> v. 1.5 [<a href="https://www.sciencedirect.com/science/article/pii/S1672022921001741?via=ihub#b0220">44]</a>, <strong>followed by a 3D-DNA scaffolding pipeline</strong> [<a href="https://www.sciencedirect.com/science/article/pii/S1672022921001741?via=ihub#b0225">45]</a>. Scaffolds were then <strong>manually checked and refined</strong> with <strong>Juicebox</strong> v. 1.11.08 [<a href="https://www.sciencedirect.com/science/article/pii/S1672022921001741?via=ihub#b0230">46]</a>.</p><h1 id="7-2021-11-J-Hered-èŒ±è¸"><a href="#7-2021-11-J-Hered-èŒ±è¸" class="headerlink" title="7. 2021.11-J Hered èŒ±è¸"></a>7. 2021.11-J Hered èŒ±è¸</h1><p><strong>Nuclear Genome Assembly</strong></p><p>We assembled the genome of the big berry manzanita following a <strong>protocol</strong> adapted from <strong>Rhie et al</strong>. (2021) as part of the CCGP assembly efforts. The CCGP assembly protocol version 1.0 uses PacBio <strong>HiFi</strong> reads and <strong>Hi-C</strong> chromatin capture data for the generation of high-quality and highly contiguous nuclear genome assemblies. The output corresponding to a diploid assembly consists of <strong>two pseudo haplotypes</strong> (<strong>primary</strong> and <strong>alternate</strong>). The <strong>primary</strong> assembly is <strong>more complete</strong> and consists of <strong>longer phased blocks</strong>. The <strong>alternate</strong> consists of <strong>haplotigs</strong> (contigs of clones with the same haplotype) in <strong>heterozygous regions</strong> and is not as complete and more fragmented. Given the characteristics of the latter, it <strong>cannot be considered on its own</strong> but as <strong>a complement of the primary assembly</strong> (<a href="https://lh3.github.io/2021/04/17/concepts-in-phased-assemblies">https://lh3.github.io/2021/04/17/concepts-in-phased-assemblies</a>, <a href="https://www.ncbi.nlm.nih.gov/grc/help/definitions/">https://www.ncbi.nlm.nih.gov/grc/help/definitions/</a>).</p><p>To generate this assembly, we <strong>removed remnant adapter</strong> sequences from the PacBio HiFi dataset using <strong>HiFiAdapterFilt</strong> and assembled the initial set of contigs with the filtered PacBio reads using <strong>HiFiasm</strong> (see Table 1 for assembly pipeline and relevant software). Next, we <strong>identified sequences corresponding to haplotypic duplications and contig overlaps</strong> on the <strong>primary assembly</strong> with <strong>purge_dups</strong> [Version 1.0.1] (Guan et al. 2020) and transferred them to the alternate assembly. We a<strong>ligned the Hi-C data</strong> to both <strong>primary and alternate assemblies</strong> using the <strong>Arima Genomics Mapping Pipeline</strong> (<a href="https://github.com/ArimaGenomics/mapping_pipeline">https://github.com/ArimaGenomics/mapping_pipeline</a>) and <strong>scaffolded</strong> the genomes using <strong>SALSA</strong> [Version 2, options â€“e GATCGATC] (Ghurye et al. 2017; Ghurye et al. 2019). We <strong>closed the generated gaps</strong> in both <strong>assemblies</strong> using the PacBio <strong>HiFi</strong> reads and <strong>YAGCloser</strong> (<a href="https://github.com/merlyescalona/yagcloser">https://github.com/merlyescalona/yagcloser</a>). The <strong>primary assembly</strong> was <strong>manually curated</strong> by <strong>iteratively generating and analyzing</strong> Hi-C <strong>contact maps</strong>. To generate the contact maps, we <strong>aligned</strong> the <strong>Hi-C</strong> data against the corresponding reference with <strong>bwa</strong> mem, identified ligation junctions, and generated <strong>Hi-C pairs</strong> using <strong>pairtools</strong> [Version 0.3.0] (Goloborodko et al. 2018). We generated a multi-resolution <strong>Hi-C matrix</strong> in binary form with <strong>cooler</strong> [Version 0.8.10] (Abdennur and Mirny 2020) and balanced it with <strong>hicExplorer</strong> [Version 3.6] (RamÃ­rez et al. 2018). We used <strong>HiGlass</strong> [Version 2.1.11] (Kerpedjiev et al. 2018) and the <strong>PretextSuite</strong> (<a href="https://github.com/wtsi-hpag/PretextView">https://github.com/wtsi-hpag/PretextView</a>; <a href="https://github.com/wtsihpag/PretextMap">https://github.com/wtsihpag/PretextMap</a>; <a href="https://github.com/wtsi-hpag/PretextSnapshot">https://github.com/wtsi-hpag/PretextSnapshot</a>) to <strong>visualize the contact maps</strong>. Assemblies were then checked for contamination using the <strong>BlobToolKit Framework</strong> [Version 2.3.3] (Challis et al. 2020), and <strong>trimmed</strong> for remnants of sequence adaptors and <strong>mitochondrial</strong> contamination.</p><p>Table1 Assembly pipeline and software usage. Software citations are listed in the text</p><table><thead><tr><th>Assembly</th><th align="left">Software</th><th align="left">Version</th></tr></thead><tbody><tr><td>Filtering PacBio HiFi adapters</td><td align="left">HiFiAdapterFilt   <a href="https://github.com/sheinasim/HiFiAdapterFilt">https://github.com/sheinasim/HiFiAdapterFilt</a></td><td align="left">Commit 64d1c7b</td></tr><tr><td>K-mer counting</td><td align="left">Meryl</td><td align="left">1</td></tr><tr><td>Estimation of genome size and heterozygosity</td><td align="left"><font color="green"><strong>GenomeScope</strong> </font></td><td align="left">2</td></tr><tr><td><em>De novo</em> assembly (contiging)</td><td align="left"><font color="green"><strong>HiFiasm</strong> </font></td><td align="left">0.13-r308</td></tr><tr><td>Long read, genome-genome alignment</td><td align="left"><font color="green"><strong>minimap2</strong> </font></td><td align="left">2.16</td></tr><tr><td>Remove low-coverage, duplicated contigs</td><td align="left"><font color="green"><strong>purge_dups</strong></font></td><td align="left">1.0.1</td></tr><tr><td><strong>Scaffolding</strong></td><td align="left"></td><td align="left"></td></tr><tr><td>Hi-C mapping for SALSA</td><td align="left"><font color="green"><strong>Arima</strong></font> Genomics mapping pipeline   <a href="https://github.com/ArimaGenomics/mapping_pipeline">https://github.com/ArimaGenomics/mapping_pipeline</a></td><td align="left">2e74ea4</td></tr><tr><td>Hi-C Scaffolding</td><td align="left"><font color="green"><strong>SALSA</strong> </font></td><td align="left">2</td></tr><tr><td>Gap closing</td><td align="left">YAGCloser?   <a href="https://github.com/merlyescalona/yagcloser">https://github.com/merlyescalona/yagcloser</a></td><td align="left">20e2769</td></tr><tr><td><strong>Hi-C contact map generation</strong></td><td align="left"></td><td align="left"></td></tr><tr><td>Short-read alignment</td><td align="left">bwa</td><td align="left">0.7.17-r1188</td></tr><tr><td>SAM&#x2F;BAM processing</td><td align="left">samtools</td><td align="left">1.11</td></tr><tr><td>SAM&#x2F;BAM filtering</td><td align="left">pairtools</td><td align="left">0.3.0</td></tr><tr><td>Pairs indexing</td><td align="left">pairix</td><td align="left">0.3.7</td></tr><tr><td>Matrix generation</td><td align="left">Cooler</td><td align="left">0.8.10</td></tr><tr><td>Matrix balancing</td><td align="left">hicExplorer</td><td align="left">3.6</td></tr><tr><td>Contact map visualization</td><td align="left">HiGlass</td><td align="left">2.1.11</td></tr><tr><td></td><td align="left">PretextMap</td><td align="left">0.1.4</td></tr><tr><td></td><td align="left">PretextView</td><td align="left">0.1.5</td></tr><tr><td></td><td align="left">PretextSnapshot</td><td align="left">0.0.3</td></tr><tr><td><strong>Organelle assembly</strong></td><td align="left"></td><td align="left"></td></tr><tr><td>Sequence similarity search</td><td align="left"><font color="green">BLAST+ </font></td><td align="left">2.10</td></tr><tr><td>Long read alignment</td><td align="left"><font color="green">Pbmm2</font> (<a href="https://github.com/PacificBiosciences/pbmm2">https://github.com/PacificBiosciences/pbmm2</a>)</td><td align="left">1.4.0</td></tr><tr><td>Variant calling and consensus</td><td align="left">bcftools</td><td align="left">1.11-5</td></tr><tr><td>Extraction of sequences</td><td align="left">seqtk</td><td align="left">1.3-r115</td></tr><tr><td>Circular-aware long-read alignment</td><td align="left"><font color="green">racon </font></td><td align="left">1.4.19</td></tr><tr><td>Sequence polishing</td><td align="left">raptor</td><td align="left">0.20.3</td></tr><tr><td>Sequence alignment</td><td align="left">lastz</td><td align="left">1.04.08</td></tr><tr><td>Gene annotation</td><td align="left">MitoFinder</td><td align="left">1.4</td></tr><tr><td><strong>Genome quality assessment</strong></td><td align="left"></td><td align="left"></td></tr><tr><td>Basic assembly metrics</td><td align="left"><font color="green"><strong>QUAST</strong> </font></td><td align="left">5.0.2</td></tr><tr><td>Assembly completeness</td><td align="left"><font color="green"><strong>BUSCO</strong> </font></td><td align="left">5.0.0</td></tr><tr><td></td><td align="left">Merqury</td><td align="left">1</td></tr><tr><td><strong>Contamination screening</strong></td><td align="left"></td><td align="left"></td></tr><tr><td>General contamination screening</td><td align="left">BlobToolKit</td><td align="left">2.3.3</td></tr></tbody></table><p><strong>Mitochondrial Genome Assembly</strong></p><p>We identified <strong>a subset of mitochondrial reads from the PacBio HiFi</strong> dataset using <strong>BLAST+</strong>  by identifying regions of similarity between the reads and the mitochondrial <strong>(mito) database</strong> (NCBI). These mitochondrial reads were used as input in <strong>HiFiasm</strong> [Version 0.13-r308] to generate the <strong>mitochondrial</strong> <strong>assembly</strong>. Given the circularity of the mitochondrial genome, we carried out self-alignment of the sequence using <strong>lastz</strong> [Version 1.04.08] (Harris 2007) to <strong>manually identify and remove duplicated regions</strong>. We aligned the subset of mitochondrial reads to the assembly using <strong>raptor</strong> [Version 0.20.3-171e0f1] (<a href="https://github.com/isovic/raptor">https://github.com/isovic/raptor</a>) and <strong>polished</strong> it with <strong>racon</strong> [Version 1.14.] (<a href="https://github.com/isovic/racon">https://github.com/isovic/racon</a>). We searched for <strong>matches</strong> of the resulting <strong>mitochondrial assembly</strong> sequence in the nuclear genome assembly using <strong>BLAST+</strong> and <strong>filtered out scaffolds from the nuclear genome</strong> with a percentage of <strong>sequence identity &gt;99%</strong> and <strong>size smaller than the mitochondrial assembly sequence</strong>. From the <strong>subset of mitochondrial reads</strong> used for the assembly, we analyzed the <strong>BLAST</strong> output and <strong>the species of the closest mitochondrial sequence</strong> available in the NCBI GenBank database, <em>Vaccinium macrocarpon</em> (Accession number: <a href="https://www.ncbi.nlm.nih.gov/nuccore/NC_023338.1">NC_023338.1</a>). We used the mitochondrial assembly of <em>V. macrocarpon</em> as a <strong>guide</strong> for the <strong>mitochondrial gene annotation</strong> generated with <strong>MitoFinder</strong> [Version 1.4] (Allio et al. 2020).</p><p><strong>Chloroplast Genome Assembly</strong></p><p>We identified chloroplast reads from the PacBio HiFi dataset with BLAST+ using the plastids RefSeq genomes [v4.1] (Oâ€™Leary et al. 2016). From this subset, we analyzed the matches and identified the species of the closest chloroplast sequence available in the NCBI database as <em>Camellia taliensis</em> (NC_022264.1). Next, we found matches of the <em>C. taliensis</em> chloroplast genome sequence in the nuclear genome assembly with BLAST+ and filtered out scaffolds from the nuclear genome assembly with length smaller than the <em>C. taliensis</em> length, sequence identity &gt;90%, and <em>e</em>-value &lt;0.00001. We aligned the filtered scaffolds to the <em>C. taliensis</em> chloroplast genome with minimap2 (Li 2018) and generated a consensus sequence with bcftools (Li 2011). We manually curated the sequence using lastz. Finally, we polished the last assembly version using raptor and racon and annotated it using the web platform GeSeq (Tillich et al. 2017).</p><h1 id="8-2022-02-pj-æ¾³æ´²åšæœ-value"><a href="#8-2022-02-pj-æ¾³æ´²åšæœ-value" class="headerlink" title="8. 2022.02-pj æ¾³æ´²åšæœ value"></a>8. 2022.02-pj æ¾³æ´²åšæœ value</h1><blockquote><p> De novo chromosome level assembly of a plant genome from long read sequence data</p></blockquote><p><a href="https://pubmed.ncbi.nlm.nih.gov/34784084/">https://pubmed.ncbi.nlm.nih.gov/34784084/</a></p><p>We now report the use of <strong>HiFiasm</strong> to assemble the genome of Macadamia jansenii, a genome that has been used as a model to test sequencing and assembly. This achieved <strong>almost complete chromosome level assembly</strong> from the sequence data alone <strong>without</strong> the need for <strong>higher level chromosome map information</strong>. <strong>Eight of the 14 chromosomes were represented by a single large contig</strong> (six with telomere repeats at both ends) and the <strong>other six assembled from two to four main contigs</strong>. The small number of chromosome breaks appears to be the result of <strong>highly repetitive regions</strong> including ribosomal genes that cannot be assembled by these approaches. </p><p>Table 1. HiFiasm contigs in different size categories and comparison of primary and haploid assemblies generated from HiFiasm genome assembler tool</p><table><thead><tr><th align="left">Number of contigs</th><th align="left">Assembly length (Mb)</th><th align="left">N50 (Mb)</th><th align="left">N75 (Mb)</th><th align="left">busco(%)</th><th></th></tr></thead><tbody><tr><td align="left">HiFiasm assembly</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td></td></tr><tr><td align="left">Total contigs</td><td align="left">779</td><td align="left">826</td><td align="left">46</td><td align="left">25</td><td>99.6</td></tr><tr><td align="left">Contigs &gt;40â€‰Mb</td><td align="left">10</td><td align="left">524</td><td align="left">50</td><td align="left">46</td><td>68.7</td></tr><tr><td align="left">Contigs &gt;10â€‰Mb</td><td align="left">19</td><td align="left">746</td><td align="left">48</td><td align="left">39</td><td>93.9</td></tr><tr><td align="left">Contigs &gt;1â€‰Mb</td><td align="left">30</td><td align="left">784</td><td align="left">46</td><td align="left">30</td><td>99.1</td></tr><tr><td align="left">Contigs &gt;100â€‰kb</td><td align="left">94</td><td align="left">805</td><td align="left">46</td><td align="left">27</td><td>99.0</td></tr><tr><td align="left">Between 100â€‰kb and 1â€‰Mb</td><td align="left">64</td><td align="left">20</td><td align="left">0.49</td><td align="left">0.22</td><td>0.20</td></tr><tr><td align="left">Between 10â€‰kb and 100â€‰kb</td><td align="left">685</td><td align="left">22</td><td align="left">0.032</td><td align="left">0.028</td><td>0.00</td></tr><tr><td align="left">Comparison of HiFiasm primary and haploid assemblies</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td></td></tr><tr><td align="left">Primary assembly</td><td align="left">779</td><td align="left">827</td><td align="left">46.1</td><td align="left">25</td><td>99.60</td></tr><tr><td align="left">Hap 1_assembly</td><td align="left">879</td><td align="left">816</td><td align="left">24.4</td><td align="left">8.9</td><td>98.80</td></tr><tr><td align="left">Hap 2_assembly</td><td align="left">363</td><td align="left">776</td><td align="left">14.3</td><td align="left">5.4</td><td>97.90</td></tr><tr><td align="left">Hap 1 &gt;1â€‰Mb</td><td align="left">96</td><td align="left">736</td><td align="left">16.4</td><td align="left">6.8</td><td>96.70</td></tr><tr><td align="left">Hap 2 &gt;1â€‰Mb</td><td align="left">72</td><td align="left">766</td><td align="left">24.5</td><td align="left">12.3</td><td>98.10</td></tr></tbody></table><p><strong>HiFiasm assembly</strong></p><p>For assembly, <strong>24 core</strong> processing units and <strong>120â€‰Gb of memory</strong> was employed. Default settings of the HiFiasm assembler were used to assemble heterozygous genomes with <strong>built-in duplication purging parameters</strong>. The HiFiasm output directory consists of two haploid (1 and 2), one primary contig and one alternate haplotig GFA graph files. Each halplotig and one primary contig GFA file was converted to FASTA format using the <strong>awk</strong> command.</p><p><strong>Analysis of assembly</strong></p><p>The primary HiFiasm assembly of <em>M. jansenii</em> included 779 contigs that were categorised into three subsets: (i) contigs &lt;1â€‰Mb size; (ii) contigs &lt;1â€‰Mb and more than 100â€‰kb size; and (iii) contigs &lt;100â€‰kb size. Along with the <strong>main primary and two haploid assemblies</strong>, all <strong>three</strong> sets of primary contig subsets were <strong>passed</strong> through analysis using <strong>quast</strong> (Gurevich etâ€‰al., <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0010">2013</a>), <strong>busco</strong> (SimÃ£o etâ€‰al., <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0028">2015</a>) and <strong>repeatmodeler</strong> (Humann etâ€‰al., <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0012">2019</a>). The <strong>telomere sequences</strong> in the HiFiasm <strong>contigs</strong> were identified using the <strong>bioserf platform</strong> (<a href="https://bioserf.org/">https://bioserf.org</a>) (Somanathan and Baysdorfer, <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0029">2018</a>). <strong>Ribosomal RNA</strong> and <strong>other protein coding genes</strong> at the <strong>terminal</strong> end of the HiFiasm contigs were identified using an <strong>ncbi blast search</strong> (<a href="https://blast.ncbi.nlm.nih.gov/">https://blast.ncbi.nlm.nih.gov</a>). Ribosomal RNA in the contigs was identified using <strong>Barrnap</strong> (<a href="https://github.com/tseemann/barrnap">https://github.com/tseemann/barrnap</a>) (Seemann, <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0023">2013</a>) with default settings for eukaryotes.</p><p><strong>Comparison with Hi-C assembly</strong></p><p>The HiFiasm contigs were compared with the <em>M. jansenii</em> 14 pseudo-molecules from the Hi-C assembly (Sharma etâ€‰al., <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0026">2021b</a>) using the online interactive D-Genies dotplot tool (Cabanettes and Klopp, <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0003">2018</a>) to <strong>compare two genomes using Minimap2</strong> and, for <strong>alignments</strong>, dotplot images were created after selecting the â€˜sort contigsâ€™ option, selecting the â€˜minimum identityâ€™ parameter at 0.75 and checking the â€˜strong precisionâ€™ tick box.</p><p><strong>Characterisation of organelle genomes content of HiFiasm contigs</strong></p><p>A reference <font color="red"><strong>mitochondrial</strong> genome, <strong>chloroplast</strong> genome and <strong>nuclear ribosomal RNA</strong> sequence</font> from this sample were assembled from <strong>Illumina raw reads</strong> (Murigneux etâ€‰al., <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0020">2020</a>) using the <strong>GetOrganelle toolkit</strong> (Jin etâ€‰al., <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0013">2020</a>) with default parameters. The <strong>HiFiasm contigs</strong> (779) were <strong>compared with</strong> the <strong>organellar and ribosomal sequences</strong> in dotplots.</p><h1 id="9-2021-04-Mol-Ecol-Resour-ç™¾é¦™æœ"><a href="#9-2021-04-Mol-Ecol-Resour-ç™¾é¦™æœ" class="headerlink" title="9. 2021.04-Mol Ecol Resour ç™¾é¦™æœ"></a>9. 2021.04-Mol Ecol Resour ç™¾é¦™æœ</h1><p><a href="https://onlinelibrary.wiley.com/doi/10.1111/1755-0998.13310">https://onlinelibrary.wiley.com/doi/10.1111/1755-0998.13310</a></p><blockquote><p>Chromosome-level reference genome assembly provides insights into aroma biosynthesis in passion fruit (Passiflora edulis)</p></blockquote><p>The assembled reference genome is 1.28 Gb size with a scaffold N50 of 126.4 Mb and 99.22% sequences anchored onto nine pseudochromosomes. ä»¥å¾€çš„æ ¸å‹åˆ†æè¡¨æ˜ç™¾é¦™æœæ˜¯ä¸€ç§äºŒå€ä½“ï¼Œ9å¯¹æŸ“è‰²ä½“</p><p><strong>Genome survey and assembly</strong><br>A total of 89.12 Gb of high-quality paired-end reads were obtained by <strong>Illumina</strong> genomic sequencing (~70.35X coverage, Table S1). The genome size, heterozygosity and repeat content were estimated based on k-mer distribution using <strong>21-mers</strong> extracted from the Illumina short reads. The estimated genome size was further validated using <strong>flow cytometr</strong>y. A total of 223.91 Gb raw PacBio subreads were filtered and corrected using pbccs pipeline with default parameters (<a href="https://github.com/PacificBiosciences/ccs">https://github.com/PacificBiosciences/ccs</a>). The resulted CCS reads were subjected to hifiasm for de novo assembly. We <font color="red"><strong>corrected</strong> the <strong>primary contigs</strong> by the <strong>Pilon</strong></font> (version1.18) (Utturkar, Klingeman, Hurt, &amp; Brown, 2017) program <strong>using 89.12 Gb (70.35Ã—) of Illumina paired-end reads</strong>. BWA (version0.7.10-r789) (Li, 2013) and SAMtools (version1.9) (Li et al., 2009) were used for reads alignment and SAM&#x2F;BAM format conversion. <strong>BUSCO</strong> (version3.0) (Simao, Waterhouse, Ioannidis, Kriventseva, &amp; Zdobnov, 2015) program with embryophyta_odb10 database were used to assess the completeness of genome and gene annotation .</p><p><strong>Chromosome assembly using Hi-C</strong></p><p>Approximately 96.4 Gb of Hi-C data were generated. The raw data were filtered using perl script as implemented in the software <strong>LACHESIS</strong> (Burton et al., 2013). BWA software was used to <strong>map the Hi-C reads to the draft assembly</strong> and <strong>uniquely mapped reads were selected for furtheranalysis</strong>. We further applied our newly developed <strong>ALLHiC pipeline</strong> to link the contigs into <strong>nine pseudo-chromosomes</strong>. <strong>HiC-pro</strong> (version2.10.0) (Servant et al., 2015) program was used to <strong>calculate Hi-C mapping rate and evaluate the quality of Hi-C scaffolding</strong>.</p><h1 id="10-2021-10-MolEcolResour-ç‰¡è›ğŸ¦ª"><a href="#10-2021-10-MolEcolResour-ç‰¡è›ğŸ¦ª" class="headerlink" title="10. 2021-10-MolEcolResour ç‰¡è›ğŸ¦ª"></a>10. 2021-10-MolEcolResour ç‰¡è›ğŸ¦ª</h1><blockquote><p>Chromosome-level genome and population genomic analysis provide insights into the evolution and environmental adaptation of Jinjiang oyster Crassostrea ariakensis</p></blockquote><p><a href="https://pubmed.ncbi.nlm.nih.gov/34800349/">https://pubmed.ncbi.nlm.nih.gov/34800349/</a></p><p>The C. ariakensis genome was 662.9 Mb with contig N50 length of 5.9 Mb using PacBio HiFi-CCS long reads, and 99.83% sequences were anchored onto 10 pseudochromosomes using Hi-C data.</p><h1 id="11-2021-10-Front-Genet-æ€èŒ…æ¾æ¯›è™«"><a href="#11-2021-10-Front-Genet-æ€èŒ…æ¾æ¯›è™«" class="headerlink" title="11. 2021.10-Front Genet æ€èŒ…æ¾æ¯›è™«"></a>11. 2021.10-Front Genet æ€èŒ…æ¾æ¯›è™«</h1><blockquote><p>Chromosome-Level Genome Assembly Reveals Significant Gene Expansion in the Toll and IMD Signaling Pathways of <em>Dendrolimus kikuchii</em></p></blockquote><p>forest pests</p><p>Overall, a final genome assembly of 705.51 Mb with contig and scaffold N50 values of 20.89 and 24.73 Mb, respectively, was obtained. Of these contigs, 95.89% had unique locations on 29 chromosomes.</p><p><strong>Genome Assembly and Polish</strong></p><p>After quality control of raw reads, the pass reads were used for <em>de novo</em> genome assembly of using an <strong>OLC (overlap layout-consensus)&#x2F;string graph method</strong> with NextDenovo (v2.3.0) with reads_cutoff:1 k and seed_cutoff:30 k. Firstly, self-correction of the original subreads was finished by NextCorrect to obtain consistent sequences (CNS reads). Then, CNS reads were used to obtain preliminary assembly through NextGraph (default parameter). The ONT, CCS and Hi-C data were used to correct the preliminary assembly using Racon (v1.3.1, default, CCS data) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B66">Vaser et al., 2017</a>)and Nextpolish (v1.2.4, default, ONT and Hi-C data) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B24">Hu et al., 2020</a>). <strong>BlastN was used to check the genome contamination</strong> (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#s10">Supplementary information S2</a>).</p><p>Completeness of the genome assembly was assessed using <strong>BUSCO</strong> v4.0.5 (Benchmarking universal Single-Copy Orthologs) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B58">Simao et al., 2015</a>) and CEGMA (Core Eukaryotic Gene Mapping Approach) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B55">Parra et al., 2007</a>). <strong>To evaluate the accuracy of the assembly</strong>, all <strong>paired-end reads were mapped to the assembled</strong> genome using <strong>BWA</strong>  (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B39">Li and Durbin, 2010</a>) and the <strong>mapping rate</strong> and the genome coverage of sequencing reads were both assessed using SAMtools v0.1.1855 (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B40">Li et al., 2009</a>). In addition, the base accuracy of the assembly was calculated using bcftools (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B13">Danecek and Mccarthy, 2017</a>). Coverage of the expressed genes of the assembly was examined by aligning all the RNA-seq reads against the assembly using HISAT with default parameters. <strong>To ensure that mitochondrial sequences were not included in the assembly,</strong> the draft genome assembly was submitted to the <strong>NT library</strong> and matching sequences were eliminated.</p><p><strong>Genome Anchoring to Chromosome</strong></p><p>The read quality (370 million paired-end reads) was controlled using Hi-C-Pro. Firstly low-quality sequences (quality scores &lt;20), adaptor sequences, and sequences shorter than 30 bp were filtered out using <strong>fastp</strong> (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B10">Chen et al., 2018</a>). Next, clean reads were mapped to the draft assembled sequence using <strong>bowtie2</strong> (v2.3.2) (-end-to-end â€“very-sensitive -L 30) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B37">Langmead and Salzberg, 2012</a>) to obtain the unique mapped paired-end reads. Invalid read pairs were filtered using <strong>HiC-Pro</strong> (v2.8.1) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B57">Servant et al., 2015</a>). The scaffolds were further <strong>clustered, ordered, and oriented onto chromosomes</strong> by <strong>LACHESIS</strong> (<a href="https://github.com/shendurelab/LACHESIS">https://github.com/shendurelab/LACHESIS</a>), with parameters <strong>CLUSTER_MIN_RE_SITES &#x3D; 100, CLUSTER_MAX_LINK_DENSITY &#x3D; 2.5, CLUSTER NONINFORMATIVE RATIO &#x3D; 1.4, ORDER MIN N RES IN TRUNK &#x3D; 60, ORDER MIN N RES IN SHREDS &#x3D; 60.</strong> Lastly, placement and orientation errors exhibiting obvious discrete chromatin interaction patterns were <strong>manually adjusted</strong>.</p><p><strong>Synteny</strong> of the <em>D. kikuchii</em> <strong>genome</strong> with the <em>D. punctatus</em> <strong>genomes</strong> was analyzed using <strong>Minimap2</strong> and <strong>dotPlotly</strong> to identify chromosome structural changes among the two species.</p>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
      <tag>paper</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HiFi-6-[HiFi-HiC-assembly-method]</title>
    <link href="/GeekFocus/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/"/>
    <url>/GeekFocus/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/</url>
    
    <content type="html"><![CDATA[<p>è¾…åŠ©ç»„è£…æ¡ˆä¾‹</p><span id="more"></span><h1 id="1-2016-05-np-ç¢§å†¬èŒ„"><a href="#1-2016-05-np-ç¢§å†¬èŒ„" class="headerlink" title="1. 2016.05-np ç¢§å†¬èŒ„"></a>1. 2016.05-np ç¢§å†¬èŒ„</h1><p><strong>Insight into the evolution of the Solanaceae from the parental genomes of Petunia hybrida</strong></p><h2 id="Genome-sequencing-assembly-and-annotation"><a href="#Genome-sequencing-assembly-and-annotation" class="headerlink" title="Genome sequencing, assembly and annotation."></a>Genome sequencing, assembly and annotation.</h2><p>Plants were grown and DNA was extracted following the methods described at Supplementary Note 1.</p><p>Illumina libraries with 0.17-, 0.35-, 0.5-, 0.8-, 1-, 2-, 5-, 8- and 15-kb inserts were sequenced at BGI-Shenzghen and University of Illinois, Roy J. Carver Biotechnology. PacBio P. axillaris DNA library was sequenced with P4&#x2F;C2 chemistry.</p><p>Illumina reads were processed using <strong>Fastq-mcf</strong> (<strong>quality filtering</strong>; <a href="https://code.google.com/p/eautils/wiki/FastqMcf">https://code.google.com/p/eautils/wiki/FastqMcf</a>), <strong>PRINSEQ</strong> (<strong>duplication filtering</strong>; http:&#x2F;&#x2F; prinseq.sourceforge.net&#x2F;) and <strong>Musket</strong> (<strong>error correction</strong>; <a href="http://musket.sourceforge/">http://musket.sourceforge</a>. net&#x2F;). <strong>Pacbio reads</strong> were processed using the <strong>SMRT Analysis pipeline</strong> (v.2.0.1; <a href="https://github.com/PacificBiosciences/SMRT-Analysis">https://github.com/PacificBiosciences/SMRT-Analysis</a>).</p><p>Both genomes were assembled with <strong>SOAPdenovo</strong> with different k-mer sizes. For both genomes, <strong>k-mer &#x3D; 79</strong> showed the best statistics. Gaps between contigs were completed using <strong>GapCloser</strong> . Additionally for P. axillaris, <strong>PacBio reads</strong> were integrated in <strong>four different steps</strong>: (1) <strong>Rescaffolding</strong> of the <strong>Illumina contigs</strong> using the <strong>PacBio reads</strong> and the <strong>AHA assembler</strong>; (2) <strong>Gap filling</strong> using <strong>PBJelly</strong>; (3) <strong>Rescaffolding</strong> using the Illumina <strong>pair data</strong> and <strong>SSPACE</strong>; (4) Last round of <strong>gap filling</strong> using <strong>PBJelly</strong> . </p><p><strong>Genome size estimation</strong> was performed through the k-mers abundance distribution (<strong>k-mer &#x3D; 31</strong>). <strong>Heterozygosity</strong> was <strong>estimated</strong> mapping the Illumina reads to the assemblies using <strong>Bowtie2</strong>, calling SNPs using <strong>FreeBayes</strong> and  annotating the SNPs using <strong>SnpEff</strong> .</p><p>The genome structural annotation was performed using <strong>Maker-P</strong>: (1) <strong>SNAP</strong> and <strong>Augustus</strong> as ab initio gene predictors; (2) Exonerate as experimental based predictor with 454 and Illumina RNASeq reads and protein sequences from different protein datasets. RNAseq Illumina data was mapped using <strong>Tophat2</strong> . tRNAs were annotated using <strong>tRNAscan</strong> (<a href="http://lowelab.ucsc.edu/tRNAscan-SE/">http://lowelab.ucsc.edu/tRNAscan-SE/</a>).</p><p>The <strong>gene functional annotation</strong> was performed by <strong>sequence homology search</strong> with different protein datasets using <strong>BlastP</strong> and protein domains search using <strong>InterProScan</strong> . Functional annotations were integrated using <strong>AHRD</strong> (<a href="https://github.com/groupschoof/AHRD">https://github.com/groupschoof/AHRD</a>). See Supplementary Note 1.</p><h2 id="Repetitive-elements-analysis"><a href="#Repetitive-elements-analysis" class="headerlink" title="Repetitive elements analysis"></a>Repetitive elements analysis</h2><p>Repeat annotation was performed using RepeatModeler (v1.0.8; <a href="http://www.repeatmasker.org/RepeatModeler.html">http://www.repeatmasker.org/RepeatModeler.html</a>), RepeatMasker (v4.0.5; <a href="http://www.repeatmasker.org/">http://www.repeatmasker.org</a>) with the repeat database Repbase (release 20140131; <a href="http://www.girinst.org/repbase/">http://www.girinst.org/repbase/</a>) and Geneious (v7.1.4; <a href="http://www.geneious.com/">http://www.geneious.com</a>). Identification of PVCV-like and EPRV elements was performed using BlastN and TBlastN . The identified sequences were aligned with ClustalW (MEGA5 package;<a href="http://www.megasoftware.net/">http://www.megasoftware.net/</a>) and then manually curated. RepeatExplorer (<a href="http://www.repeatexplorer.org/">http://www.repeatexplorer.org/</a>) and other methods were used to extend the analysis to unassembled repeats. Fluorescent in situ hybridization was performed in root tips from young P. axillaris and P. inflata plants for 5S rDNA and three PVCV viral probes following the procedure described in Supplementary Note 2.</p><p>The detection of dTph1 loci in P. hybrida W138 was performed through a BLAST40 search of the P. axillaris and P. inflata dTph1 elements including the 500 bp of flanking sequence against the TFS W138 collection. Polymorphisms found in the genomic flanking regions were used to identify the species of origin. dTph1 elements were identified in a P. axillaris population using a modification of the methodology described in Supplementary Note 3.</p><p>##Whole-genome duplication, tandem duplications and gene family analysis</p><p>Whole-genome collinear analysis was performed using SynMap and microsynteny analysis were performed using GEvo in the comparative genomics platform, CoGe .See Supplementary Note 5.</p><p>The gene family analysis included Solanum lycopersicum, S. tuberosum, Nicotiana benthamiana and Arabidopsis thaliana protein sets using BlastP (v2.2.27) on an all-versus-all comparison and grouping the genes into families with OrthoMCL, v2.0.8. See Supplementary Note 4.</p><h2 id="Gene-data-mining"><a href="#Gene-data-mining" class="headerlink" title="Gene data mining"></a>Gene data mining</h2><p>The specific identification of genes for P. axillaris and P. inflata genomes for colour and scent, root-specific pathways, self-incompatibility and circadian clock was performed through a BlastN&#x2F;BlastP sequence homology search. Blast GUI, JBrowser (<a href="http://jbrowse.org/">http://jbrowse.org/</a>) and WebApollo (<a href="http://genomearchitect/">http://genomearchitect</a>. org&#x2F;) were installed in a server to search and manually curate the gene structures of the identified genes. See Supplementary Notes 7, 8 and 10â€“12.</p><h1 id="2-2017-04-ng-å±±ç¾ŠğŸ"><a href="#2-2017-04-ng-å±±ç¾ŠğŸ" class="headerlink" title="2. 2017.04-ng å±±ç¾ŠğŸ"></a>2. 2017.04-ng å±±ç¾ŠğŸ</h1><p>Published in final edited form as:Nat Genet. 2017 April ; 49(4): 643â€“650. doi:10.1038&#x2F;ng.3802.</p><p><strong>Single-molecule sequencing and chromatin conformation capture enable</strong> <strong>de novo</strong> <strong>reference assembly of the domestic goat genome</strong></p><p>â€‹é¦–æ¬¡åœ¨äººä¹‹å¤–çš„ç‰©ç§ä¸­ç›´æ¥de novoç»„è£…å‡ºæŸ“è‰²ä½“æ°´å¹³çš„åŸºå› ç»„ã€‚åˆ©ç”¨<font color="blue"><strong>Pacbio+BioNano+Hi-C+Illumina</strong> å¤šå±‚çº§</font>çš„ç­–ç•¥ï¼Œç»„è£…äº†ä¸€åªå±±ç¾Š(Capra hircus)çš„åŸºå› ç»„ï¼Œè·å¾—<font color="blue"><strong>31</strong>ä¸ª<strong>scaffold</strong>ï¼Œ<strong>663</strong>ä¸ª<strong>gap</strong>åŒºï¼Œscaffold <strong>N50</strong> æƒŠäººåœ°è¾¾åˆ°<strong>87M</strong>ï¼Œå‡ ä¹<strong>one scaffold one chromosome</strong></font>ï¼Œå¹¶ä¸”æˆåŠŸåœ°ç»„è£…å‡º<font color="blue"><strong>å…ç–«åŸºå› åŒº</strong>å’Œ<strong>å¤§éƒ¨åˆ†é‡å¤åºåˆ—å®¶æ—</strong></font>ã€‚</p><p>â€‹<font color="red">äººçš„GRCh38ç‰ˆæœ¬æœ‰<strong>24</strong>ä¸ª<strong>scaffold</strong>ï¼Œ<strong>169</strong>ä¸ª<strong>unplacedscaffold</strong>ï¼Œ<strong>832ä¸ªgap</strong>åŒº</font>ã€‚</p><p>â€‹ä»<strong>96å¤´</strong>å±±ç¾Š(<strong>6ä¸ªå“ç§</strong>)ä¸­ï¼Œåˆ©ç”¨Illuminaçš„ Caprine53K <font color="blue"><strong>SNP èŠ¯ç‰‡ç­›é€‰</strong></font>å‡º<font color="blue"><strong>åŸºå› å‹çº¯å’Œåº¦æœ€é«˜</strong></font>çš„ä¸ªä½“ç”¨æ¥<font color="blue"><strong>ç»„è£…</strong></font>(San Clemente breed)ã€‚</p><h2 id="data"><a href="#data" class="headerlink" title="data"></a>data</h2><ol><li><p>Pacbioæ•°æ®</p><p>ä¸€å…±äº§ç”Ÿ465ä¸ªSMRT cellçš„æ•°æ®ã€‚å…¶ä¸­ä½¿ç”¨P5-C3è¯•å‰‚çš„311ä¸ªcell;ä½¿ç”¨P4-C2è¯•å‰‚çš„142ä¸ªcellï¼ŒXL-C2è¯•å‰‚çš„12ä¸ªcellã€‚æ•°æ®é‡194Gï¼Œè¦†ç›–æ·±åº¦è¾¾<strong>69X</strong>ï¼Œ<strong>subread</strong>çš„<strong>å¹³å‡</strong>é•¿åº¦ä¸º<strong>5,110bp</strong>ã€‚</p></li><li><p>BioNano æ•°æ®</p><p>ç”±äºé‡‡æ ·æ‰€ç”¨å±±ç¾Šæ„å¤–æ­»äº¡ï¼Œå…¶DNAä¸èƒ½æ»¡è¶³Irsy optical mapping æµ‹åºéœ€æ±‚ï¼Œåªå¥½ç”¨å…¶<strong>é›„æ€§åä»£</strong>é‡‡æ ·ã€‚Optical mapä¸€å…±äº§ç”Ÿ256Gbæ•°æ®ï¼Œè¦†ç›–<strong>98 X</strong>ã€‚</p></li><li><p>Hi-Cæ•°æ®</p><p>é‡‡æ ·åŠ¨ç‰©æ˜¯æœ€åˆé‚£åªå±±ç¾Šã€‚Hi-Cå»ºåº“ï¼Œåºåˆ—ç”¨ç‰©ç†æ–¹æ³•æ‰“æ–­æˆ300-500bpé•¿åº¦ï¼ŒPE101æµ‹åºï¼Œäº§ç”Ÿ<strong>115M reads</strong>çš„æ•°æ®é‡ã€‚</p></li><li><p>Illumina æ•°æ®</p><p>é‡‡æ ·æœ€åˆé‚£åªå±±ç¾Šï¼ŒPE251å»ºåº“æµ‹åºï¼Œè·å¾—<strong>23X</strong>çš„æ•°æ®è¦†ç›–ï¼Œç”¨æ¥åšæœ€åçš„<font color="red"><strong>é”™è¯¯æ ¡æ­£</strong></font></p></li></ol><h2 id="ç»„è£…ç­–ç•¥åŠç»„è£…ç»“æœ"><a href="#ç»„è£…ç­–ç•¥åŠç»„è£…ç»“æœ" class="headerlink" title="ç»„è£…ç­–ç•¥åŠç»„è£…ç»“æœ"></a><strong>ç»„è£…ç­–ç•¥åŠç»„è£…ç»“æœ</strong></h2><ul><li><p>å…ˆç”¨Pacbioçš„ long-read æ•°æ®æ„å»ºcontigï¼Œ ä½¿ç”¨<font color="blue"><strong>Celera Assembler</strong> PacBio corrected Reads æµç¨‹</font>ç»„è£…ã€‚è·å¾—<font color="blue"><strong>3,074</strong>ä¸ªcontig(2.63G)ï¼Œ<strong>N50 4.159M</strong>b</font>ã€‚</p></li><li><p>æ¥ä¸‹æ¥é‡‡ç”¨<font color="blue"><strong>Irys optical mapping</strong>æ•°æ®æ„å»º<strong>scaffold</strong></font>ï¼Œä½¿ç”¨è½¯ä»¶ä¸º<font color="blue"><strong>IrysView</strong></font>. äº§ç”Ÿ<font color="blue"><strong>842</strong>ä¸ªscaffoldï¼Œscaffold N50ä¸º<strong>13.4M</strong>bï¼Œcontig N50ä¸º10.858Mï¼Œæœ€é•¿scaffoldä¸º66.728Mb</font>ã€‚ åˆ©ç”¨<font color="red"><strong>radiation hybrid(RH) mapæ¯”è¾ƒ</strong>å‘ç°</font>ï¼Œ<font color="blue">PacBio-Irys è”åˆ</font>çš„æ–¹æ³•å·²ç»<font color="blue">å®Œæ•´ç»„è£…å‡º<strong>20å·æŸ“è‰²ä½“</strong></font>ã€‚</p></li><li><p>æ¥ä¸‹æ¥ç”¨Hi-Cæ•°æ®ï¼Œè°ƒç”¨ç”¨<font color="red"><strong>Lachesisè½¯ä»¶åŒ…</strong></font>ï¼Œç»“åˆPacBio-Irysçš„ç»“æœï¼Œå³æ•´åˆçš„PacBio-Irys-PGA (PBIP)æ–¹æ³•ï¼Œè·å¾—è¾ƒå®Œç¾çš„ç»„è£…ç»“æœã€‚<font color="blue">Scaffold N50</font> è¾¾åˆ°æƒŠäººçš„<font color="blue"><strong>87.347Mb</strong></font>(è¿œè¶…ä»Šå¹´å°–å»é²ˆï¼Œå¤§çŒ©çŒ©N50 20Mbçš„é«˜èµ·ç‚¹)ï¼Œæ€»å…±è·å¾—<font color="blue"><strong>31æ¡</strong>scaffold</font>ï¼Œ(<font color="red">31,261æ¡&lt;50kbpçš„**degenerate scaffold**ä¸è®¡å…¥</font> )ã€‚</p></li><li><p>æœ€ååˆ©ç”¨Illuminaæ•°æ®åš<font color="red"><strong>ä¸€è‡´æ€§æ ¡æ­£</strong>å’Œæœ€åçš„<strong>è¡¥æ´</strong></font>ï¼Œæœ€åä½¿å¾—contigçš„æ•°ç›®ä¸‹é™åˆ°680æ¡ï¼Œäº§ç”Ÿçš„gapæ•°ç›®ä¸º663ä¸ªã€‚</p></li><li><p>åˆ©ç”¨Kraken v0.10.5 <font color="red">å»é™¤æœ‰<strong>ç—…æ¯’å’Œç»†èŒæ±¡æŸ“</strong>çš„åºåˆ—</font>ï¼Œå»æ‰æœ‰NCBI vectoræ±¡æŸ“çš„åºåˆ—ã€‚è·å¾—æœ€ç»ˆçš„åŸºå› ç»„ ç‰ˆæœ¬<strong>ARS1</strong>ã€‚</p></li></ul><h2 id="ç»„è£…è¯„ä¼°åŠæ¯”è¾ƒåˆ†æ"><a href="#ç»„è£…è¯„ä¼°åŠæ¯”è¾ƒåˆ†æ" class="headerlink" title="ç»„è£…è¯„ä¼°åŠæ¯”è¾ƒåˆ†æ"></a><strong>ç»„è£…è¯„ä¼°åŠæ¯”è¾ƒåˆ†æ</strong></h2><p>ç”±äºå±±ç¾Šä¹‹å‰å·²ç»äº§ç”Ÿè¿‡ä¸¤ä¸ªåŸºå› ç»„ç‰ˆæœ¬<strong>CHIR_1.0ã€CHIR_2.0</strong>ï¼Œå¯ä»¥ç”¨æ¥åšæ¯”è¾ƒ åˆ†æï¼Œå¹¶ä¸”æœ‰RH mappingæ•°æ®ç”¨æ¥è¯„ä¼°ã€æ ¡æ­£ARS1çš„ç»„è£…ç‰ˆæœ¬ã€‚ <strong>é€šè¿‡å„ç§å‚æ•°æ¯”è¾ƒå‘ç°ï¼ŒARS1å‡ä¼˜äºCHIR_2.0ç‰ˆæœ¬ã€‚</strong></p><p>1ã€é€šè¿‡æ¯”å¯¹å‘ç°ï¼ŒCHIR_2.0 æ¯”CHIR_1.0æœ‰æ›´å°‘çš„putative deletion(2,735 vs 1 0,256)å’Œduplication(115 vs 290)ã€‚è€Œ2.0ç‰ˆæœ¬ç›¸è¾ƒ1.0æœ‰æ›´å¤šçš„inversion(215 v s 4)ã€‚é€šè¿‡æ¯”è¾ƒï¼Œå‘ç°ARS1ç‰ˆæœ¬æœ‰å¤§å¹…åº¦åœ°æå‡ï¼Œè¾ƒ2.0ç‰ˆæœ¬å°‘4å€çš„deletionï¼Œ å°‘50å€inversionã€‚</p><p>2ã€CHIR_2.0èƒ½å¡«è¡¥CHIR_1.0 94.6%çš„gapï¼Œè€Œå‰©ä¸‹çš„é‚£äº›gapé€šè¿‡åˆ†æARS1å¾—çŸ¥ï¼Œæ˜¯CHIR_1.0çš„ç»„è£…é”™è¯¯ï¼Œè€ŒRHæ•°æ®ä¹Ÿæ”¯æŒäº†è¿™ä¸€è®ºæ–­ã€‚ 3ã€BUSCOæ˜¯åˆ©ç”¨å•æ‹·è´orthologæ¥è¯„ä¼°ç»„è£…çš„å¯é æ€§ï¼Œå’ŒCHIR_2.0ç›¸æ¯”ï¼ŒARS1æœ‰æ›´é«˜çš„BUSCO scoreã€‚</p><p>4ã€å±±ç¾Š52k SNP èŠ¯ç‰‡ä¸­ï¼Œæœ‰1,723ä¸ªSNPæ¢é’ˆç›®å‰åªèƒ½å®šä½åœ¨CHIR_2.0ç»„è£…ç‰ˆæœ¬ ä¸­çš„unplaced contigsä¸Šã€‚è€ŒARS1ç‰ˆæœ¬èƒ½æŠŠå…¶ä¸­çš„90%(1,552&#x2F;1,723)ä»¥ä¸Šçš„S NPæ¢é’ˆå®šä½åœ¨æŸ“è‰²ä½“ä¸Šã€‚å¦å¤–å‘ç°æœ‰26ä¸ªlow call-rate çš„SNPmarkeråœ¨ARS1ç»„è£…ç‰ˆæœ¬ä¸Šå®šä½æ¯”è¾ƒæ¨¡æ£±ä¸¤å¯ã€‚è¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆè¿™äº›makeråœ¨èŠ¯ç‰‡ä¸Šæœ‰è¾ƒå·®çš„call -rate. </p><p>5ã€é€šè¿‡æ¯”è¾ƒå‘ç°ï¼ŒCHIR_2.0ç‰ˆæœ¬ä¸­çš„3,495ä¸ªå†…å«å­æˆ–å¤–æ˜¾å­æœ‰gapçš„åŸºå› ï¼Œåœ¨ARS1ä¸­éƒ½å¾—åˆ°è¡¥å…¨ã€‚åŒæ—¶ä¹Ÿç¡®è®¤1,926ä¸ªé¢„æµ‹çš„å¤–æ˜¾å­åœ¨CHIR_1.0æˆ–è€…2.0ä¸­æœ‰gapï¼Œ ä½†åœ¨ARS1ä¸­å¾—åˆ°ä¿®å¤ã€‚ </p><p>6ã€ç”±äºå…ç–«åŸºå› åŒºé«˜åº¦å¤šæ€æ€§å’Œé‡å¤æ€§ï¼Œç”¨äºŒä»£æµ‹åºæ•°æ®å¾ˆéš¾ç»„è£…èµ·æ¥ï¼Œä½†æ˜¯é€šè¿‡ åˆ†æå‘ç°ï¼ŒARS1ç‰ˆæœ¬å°±å¾ˆå¥½åœ°æŠŠLRCå’ŒNKCåŸºå› (å…ç–«åŠŸèƒ½ç›¸å…³åŸºå› )å®šä½åœ¨ä¸€ä¸ªç‹¬ç«‹çš„å¸¸æŸ“è‰²ä½“scaffoldä¸Šã€‚ </p><p>7ã€é€šè¿‡å’Œä¸€ä»£ã€äºŒä»£ç»„è£…ç­–ç•¥ç›¸æ¯”ï¼ŒARS1ç‰ˆæœ¬åœ¨é‡å¤åºåˆ—çš„ç»„è£…ä¸Šè·å¾—äº†æå¤§è¿›æ­¥ã€‚å¯¹æŸäº›å¼‚æŸ“è‰²ä½“æˆ–å¼‚æŸ“è‰²è´¨çš„åŒºåŸŸä¹Ÿè·å¾—äº†è¾ƒå¥½çš„ç»„è£…è¦†ç›–ã€‚æ¯”å¦‚ï¼Œåœ¨6æ¡å¸¸ æŸ“è‰²ä½“ä¸Šç»„è£…å‡º&gt;5kbpçš„ç«¯ç²’åºåˆ—ã€‚é€šè¿‡åˆ†æå‘ç°ï¼Œ 15æ¡æŸ“è‰²ä½“scaffoldï¼Œåœ¨ç€ä¸ç²’åŒºåŸŸç»„è£…å‡ºå¤§äº2kbpé•¿åº¦çš„é‡å¤åŒºï¼Œè€Œå…¶ä¸­çš„7æ¡ï¼Œæ›´æ˜¯è£…å‡ºæ¥8kbpä»¥ä¸Šçš„é‡å¤åŒºã€‚æ›´ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œ19å·å’Œ23å·æŸ“è‰²ä½“éƒ½ç»„è£…å‡ºé«˜åº¦é‡å¤çš„ç€ä¸ç²’å’Œç«¯ç²’åŒºåŸŸï¼Œ è´¯é€šäº†æœ‰ç»“æ„æ€§å¼‚æŸ“è‰²è´¨åŒºçš„æŸ“è‰²ä½“ã€‚ </p><p>8ã€åœ¨ARS1ç‰ˆæœ¬ä¸­é‰´å®šå‡ºå¤§äº12kbpçš„é‡å¤æ¨¡å¼åºåˆ—å¤šè¾¾105æ¡ã€‚å¯¹äºé‡å¤åºåˆ—å®¶ æ—çš„é‰´å®šï¼Œåœ¨ARS1ä¸­è·å¾—çš„æ¥è¿‘å…¨é•¿çš„BovB LINE åºåˆ—æ¯”CHIR_2.0å¤š60%ä»¥ä¸Šã€‚ åœ¨CHIR_2.0ç‰ˆæœ¬é‡Œï¼Œè¢«ARS1æˆåŠŸè¡¥å…¨çš„gapä¸­çš„43.6%ä¸BovBé‡å¤åºåˆ—ä¸€è‡´(é•¿ åº¦å¤§äº3.5kbp)ï¼Œå³æ„å‘³ç€äºŒä»£æµ‹åºçš„gapåŒºå¤§å¤šéƒ½æ˜¯é‡å¤åºåˆ—ï¼Œç”¨ä¸‰ä»£å°±èƒ½è¾ƒå®¹æ˜“æµ‹é€šã€‚ </p><p>9ã€å…³äºæ€§æŸ“è‰²ä½“çš„åˆ†æã€‚é€šè¿‡æ¯”å¯¹å‘ç°ï¼Œä¸¤ä¸ªä¸åŒçš„scaffoldæ¯”å¯¹åˆ°XæŸ“è‰²ä½“çš„ä¸åŒä½†è¿ç»­çš„åŒºåŸŸï¼Œå é¢„æœŸXæŸ“è‰²ä½“å¤§å°(150Mb)çš„86%å·¦å³ã€‚é€šè¿‡å’Œè‡ªå·±çš„ã€è·¨ç‰©ç§ç‰›çš„YæŸ“è‰²ä½“æ¯”å¯¹ï¼Œæœ€ç»ˆç¡®å®šå‡º10MbåŒºåŸŸçš„åºåˆ—ï¼Œå YæŸ“è‰²ä½“é¢„ä¼°å¤§å°çš„50% å·¦å³ã€‚é€šè¿‡æ¯”å¯¹ç‰›å’Œç¾Šçš„YæŸ“è‰²ä½“ä¸Šçš„åŸºå› ï¼Œå‘ç°åœ¨ç›®å‰çš„scaffoldä¸­èƒ½æ‰¾åˆ°16%ï¼Œ è€Œåœ¨å…ˆå‰è¿‡æ»¤æ‰çš„degenerate contigä¸­èƒ½æ‰¾åˆ°84%çš„åŸºå› ã€‚è€ƒè™‘åˆ°YæŸ“è‰²ä½“çš„å¼‚æŸ“ è‰²è´¨å±æ€§åŠX,YæŸ“è‰²ä½“çš„æ‹Ÿå¸¸æŸ“è‰²åŒºåŸŸç»å¸¸å‘ç°äº¤æ¢ï¼Œå®åœ¨å¤ªè¿‡å¤æ‚ï¼Œè¶…å‡ºç›®å‰çš„ç»„è£…å’Œè®¤çŸ¥æ°´å¹³ï¼Œè¡¨ç¤ºå®åœ¨æ— èƒ½ä¸ºåŠ›ã€‚</p><p>10ã€åˆ©ç”¨ä¹‹å‰RH mapping dataï¼Œå¯¹ç»„è£…çš„å¤§éƒ¨åˆ†ç¯èŠ‚è¿›è¡Œäº†æ ¡æ­£åŠè¯„ä¼°ã€‚æ¯”å¦‚å¤šæ¬¡è¾…åŠ©è§£å†³scaffold conflictçš„é—®é¢˜ã€‚</p><h2 id="åŸºå› ç»„æ³¨é‡Š"><a href="#åŸºå› ç»„æ³¨é‡Š" class="headerlink" title="åŸºå› ç»„æ³¨é‡Š"></a><strong>åŸºå› ç»„æ³¨é‡Š</strong></h2><p>å¤šç§æ–¹æ³•ç»“åˆæ³¨é‡ŠåŸºå› é›†ã€‚<br>1.<strong>RNA-seqçš„æ–¹æ³•:</strong> 6ä¸ªç»„ç»‡(å¤§å¤šå’Œè„‘ç»„ç»‡ç›¸å…³)RNA-seqæµ‹åºã€13ä¸ªSRAä¸‹è½½ æ•°æ®ï¼Œåˆ©ç”¨stringtieã€cufflinkså’ŒTrinity(åŸºäºæ— å‚ç»„è£…)ã€‚æœ€åç”¨PASAè½¯ä»¶æ•´åˆåœ¨ä¸€èµ·;</p><p>2.<strong>ç”¨exonerateå’Œtblastn è½¯ä»¶</strong>æ¯”å¯¹åˆ°å‡ ä¸ªè¿‘ç¼˜ç‰©ç§çš„EnsemblåŸºå› é›†ä¸Šï¼Œè·å¾—åŒ æºé¢„æµ‹åŸºå› é›†;</p><p>3.<strong>ç”¨Braker1åšAb initio é¢„æµ‹</strong>;</p><p>4.<strong>CHIR_1.0 ç‰ˆæœ¬çš„æ³¨é‡ŠåŸºå› é›†</strong>; æœ€åç”¨<strong>EVM+PASA</strong>æŠŠä»¥ä¸Š4ç§æ•°æ®æ•´åˆæˆä¸€ä¸ªæœ€ç»ˆçš„åŸºå› é›†(è®¾ç½®çš„æƒé‡ä¸ºRNAseq &gt; cDNA&#x2F;protein &gt; ab initio gene predictions)ã€‚</p><h2 id="å¯ç¤ºå½•"><a href="#å¯ç¤ºå½•" class="headerlink" title="å¯ç¤ºå½•"></a><strong>å¯ç¤ºå½•</strong></h2><p>1ã€Pacbio RSIIæ˜¯ä¸€ä¸ªè¾ƒä¸ºç†æƒ³ç»„è£…å¹³å°ï¼Œäº§ç”Ÿå¹³å‡14Kbpå·¦å³çš„è¯»é•¿ï¼Œæœ€é«˜åˆ°60 Kbpï¼Œå¯ä»¥ç»„è£…å‡ºè¾ƒä¸ºç†æƒ³çš„åŸºå› ç»„ç‰ˆæœ¬ã€‚ç”±äºä¸‰ä»£çš„é•¿è¯»é•¿ä¼˜åŠ¿ï¼ŒåŒæ—¶å¯ä»¥è¾ƒå¥½åœ°ç»„è£…å‡ºåŸºå› ç»„ä¸­å¤§éƒ¨åˆ†é«˜åº¦é‡å¤åŒº(ä¸»è¦é›†ä¸­åœ¨ç€ä¸ç²’å’Œç«¯ç²’åŒºåŸŸ);</p><p>2ã€BioNano çš„Irys optical mapping æ˜¯ä¸€ç§éå¸¸æœ‰æ•ˆçš„ï¼Œæˆæœ¬æ¯”è¾ƒé€‚ä¸­çš„æ„å»ºscaffoldçš„å¹³å°ã€‚å’ŒHi-Cæ¯”ä¼˜åŠ¿åœ¨äºå®šä½é”™è¯¯è¾ƒå°‘ï¼Œç¼ºç‚¹æ˜¯å¯¹N50çš„æé«˜å¹¶ä¸æ˜¯ç‰¹åˆ«æ˜¾è‘—ï¼Œä¸€èˆ¬åœ¨2å€å·¦å³ã€‚å¦‚æœæ­£åé“¾çš„Nt.BsqIé…¶åˆ‡ä½ç‚¹ç¦»å¾—æ¯”è¾ƒè¿‘ï¼Œå¸¸å¸¸å¯¼è‡´åŒé“¾ æ–­è£‚ï¼Œé™åˆ¶äº†Optical Map scaffoldçš„å¤§å°ã€‚æ‰€ä»¥ï¼ŒBioNanoå¯¹è¾ƒé•¿çš„scaffoldæ•ˆæœæ¯”è¾ƒå¥½ã€‚ç”±äºOptical mapå’Œpacbioäº§ç”Ÿçš„é”™è¯¯ç‰¹å¾å¹¶ä¸ä¸€æ ·ï¼Œä¸¤è€…ç»“åˆï¼Œå¯ä»¥ ç›¸äº’æ ¡æ­£ï¼Œè·å¾—è¾ƒå¥½çš„ç»„è£…æŒ‡æ ‡;</p><p>3ã€Hi-Cæ˜¯ç›®å‰éå¸¸ç«çˆ†çš„ä¸€ä¸ªæŠ€æœ¯ï¼Œåœ¨å¤šä¸ªé¢†åŸŸéƒ½æœ‰å¾ˆå¥½çš„åº”ç”¨ã€‚åœ¨ç»„è£…æ–¹é¢ï¼Œ å®ƒèƒ½è·å¾—æŸ“è‰²ä½“çº§åˆ«çš„scaffoldï¼Œä½†æ˜¯ä¹Ÿå®¹æ˜“è·å¾—è¾ƒé«˜çš„contigå®šå‘é”™è¯¯ã€‚è¿™ä¹Ÿæ˜¯ ä¸ºä»€ä¹ˆæ–‡ç« ä¸­ï¼Œå…ˆç”¨optical mappingï¼Œåç”¨Hi-Cåšscaffoldingçš„é‡è¦åŸå› ä¹‹ä¸€ã€‚ ä½œè€…å»ºè®®åœ¨ä»¥åçš„å®éªŒä¸­ï¼Œå¯ä»¥é€‰æ‹©è¾ƒçŸ­çš„è¯†åˆ«ä½ç‚¹çš„é™åˆ¶å†…åˆ‡é…¶(æˆ–è€…DNase Hi -C)æ¥æé«˜Hi-Cäº¤è”çš„å¯†åº¦ï¼Œé™ä½å®šå‘é”™è¯¯ã€‚</p><p>4ã€åˆ©ç”¨åŒæ ·çš„æ–¹æ³•å’Œå¹³å°ï¼Œåšç±»ä¼¼çš„åŸºå› ç»„é¡¹ç›®ï¼Œç”¨Pacbioå¹³å°å’Œscaffoldingå¹³ å°ï¼Œç›®å‰å¤§çº¦èŠ±è´¹åœ¨$100,000ä¸Šä¸‹,è€Œä¸€èˆ¬çš„çŸ­readså¹³å°æµ‹åºåŠ scaffolding å¹³å°ï¼Œåªéœ€è¦å…¶ä¸‰åˆ†ä¹‹ä¸€çš„ä»·æ ¼ã€‚ä½†æ˜¯ç”¨Pacbioå¹³å°å´è·å¾—äº†é«˜è´¨é‡çš„ã€è¿ç»­æ€§å¥½çš„åŸºå› ç»„åºåˆ—ã€‚ç›®å‰Pacbio æ–°ä¸€ä»£çš„sequelå¹³å°å·²ç»æ¨å‡ºï¼Œå•ä¸ªcellçš„äº§é‡æ¯”RSIIæ é«˜7å€ä»¥ä¸Šï¼Œæµ‹åºæˆæœ¬å°†ä¼šå¾—åˆ°å¤§å¹…åº¦é™ä½ï¼Œç›¸ä¿¡ä¼šæˆä¸ºæœªæ¥åŸºå› ç»„ç ”ç©¶çš„ä¸»æµå·¥å…·ä¹‹ä¸€ã€‚</p><p>5ã€æœ¬æ–‡çš„ç ”ç©¶ç­–ç•¥ç¡®å®ä¼šå¯è¿ªåæ¥çš„ç ”ç©¶è€…ï¼Œä¸ºde novoç»„è£…æ ‘ç«‹æ–°æ ‡æ†ã€‚Pacbio æµ‹åºæŠ€æœ¯è”åˆå¤šç§scaffolding å¹³å°(æ¯”å¦‚BioNanoã€Hi-Cï¼Œmating-pairedlibr aryï¼Œ10X genomics)çš„ä½¿ç”¨ï¼Œ ä¼šå¼•é¢†de novo ç»„è£…è¿›å…¥ near finished genome æˆ–è€…finished genomeçš„æ–°æ—¶ä»£ã€‚</p><p>6ã€ä½†æ˜¯ï¼Œå°½ç®¡åšäº†å¾ˆå¤šåŠªåŠ›ï¼ŒARS1ä»ç„¶æ˜¯ä¸€ä¸ªå•ä½“å‹æ··åˆå‹çš„ç»„è£…ç‰ˆæœ¬ã€‚åœ¨æœªæ¥ï¼Œå¯ä»¥åˆ©ç”¨single moleculeå’ŒHi-CæŠ€æœ¯è·å¾—å•ä½“å‹åˆ†æœŸ(haplotype phasing) çš„å‚è€ƒåŸºå› ç»„ã€‚å¯¹äºç»„æˆå‹å¼‚æŸ“è‰²è´¨åŒºï¼Œå°¤å…¶æ˜¯ç€ä¸ç²’å’Œç«¯ç²’éƒ¨åˆ†ï¼Œä»ç„¶æ˜¯ç»„è£…çš„ç›²åŒºï¼Œå³ä½¿åœ¨äººçš„åŸºå› ç»„ä¸­è¿™äº›åŒºåŸŸä¹Ÿæ²¡æœ‰è¢«å®Œæ•´ç»„è£…å‡ºæ¥ã€‚</p><h1 id="3-2020-09-cell-å¤§è±†æ³›åŸºå› ç»„"><a href="#3-2020-09-cell-å¤§è±†æ³›åŸºå› ç»„" class="headerlink" title="3. 2020.09-cell å¤§è±†æ³›åŸºå› ç»„"></a>3. 2020.09-cell å¤§è±†æ³›åŸºå› ç»„</h1><p>Pan-Genome of Wild and Cultivated Soybeans</p><p>Soybean is one of the most important vegetable oil and protein feed crops. To capture the entire genomic diversity, it is needed to construct a complete high-quality pan-genome from diverse soybean accessions. In this study, we performed individual de novo genome assemblies for <strong>26 representative soybeans</strong> that were selected from <strong>2,898 deeply sequenced accessions</strong>. Using these assembled genomes together with <strong>three previously reported genomes</strong>, we constructed a <strong>graph-based genome</strong> and performed pan-genome analysis, which identified <strong>numerous genetic variations that cannot be detected by direct mapping of short sequence reads onto a single reference genome</strong>. The <strong>structural variations</strong> from the 2,898 accessions that were <strong>genotyped</strong> based on the graph-based genome and the <strong>RNA-seq data</strong> from the representative 26 accessions helped to <strong>link genetic variations to candidate genes</strong> that are responsible for important traits. This pan-genome resource will promote evolutionary and functional genomics studies in soybean.</p><h2 id="SNP-Calling-and-Phylogenetic-Analyses"><a href="#SNP-Calling-and-Phylogenetic-Analyses" class="headerlink" title="SNP Calling and Phylogenetic Analyses"></a>SNP Calling and Phylogenetic Analyses</h2><h2 id="Genome-Assembly"><a href="#Genome-Assembly" class="headerlink" title="Genome Assembly"></a>Genome Assembly</h2><p><em>De novo</em> assembly was conducted referring to a <font color="blue"><strong>reported pipeline</strong></font> (Du and Liang, 2019; Shen et al., 2019). In brief, <font color="red"><strong>Canu</strong></font> (Koren et al., 2017) v1.7.1 was used to assemble PacBio subreads to PacBio contigs, after which <font color="red"><strong>HiSeq</strong></font> reads were used for <font color="red"><strong>error correction</strong></font>. <strong>Bio-nano optical maps</strong> were assembled into consensus physical maps by <strong>BioNano Solve</strong> v3.0.1 (<a href="https://bionanogenomics.com/">https://bionanogenomics.com/</a>, Solve_06082017Rel). Then <font color="red"><strong>HERA</strong></font> (Du and Liang, 2019) was used to combine PacBio contigs and Bionano based physical maps to <font color="blue"><strong>PacBio-BioNano hybrid scaffolds</strong></font>. To <font color="red"><strong>anchor</strong></font> hybrid scaffolds <font color="blue">into <strong>chromosomes</strong></font>, the <font color="blue"><strong>Hi-C</strong></font> sequencing data were <font color="red"><strong>aligned into scaffolds</strong></font> by <font color="red"><strong>Juicer</strong></font> (Durand et al., 2016) v1.5 and <font color="red"><strong>3D-DNA</strong></font> (Dudchenko et al., 2017).</p><h2 id="Repeat-Analysis-and-Gene-Annotation"><a href="#Repeat-Analysis-and-Gene-Annotation" class="headerlink" title="Repeat Analysis and Gene Annotation"></a>Repeat Analysis and Gene Annotation</h2><h2 id="Synteny-Analysis"><a href="#Synteny-Analysis" class="headerlink" title="Synteny Analysis"></a>Synteny Analysis</h2><p>Structural Variation Identification</p><p>Genetic Variation Analysis</p><p>Gene and miRNA Expression</p><p>Core and Dispensable Gene Family Clustering</p><p>CHS gene unit identification</p><p>Gene Fusion Event Identification</p><p>QUANTIFICATION AND STATISTICAL ANALYSIS</p><h1 id="4-2019-nc-å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ1"><a href="#4-2019-nc-å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ1" class="headerlink" title="4. 2019-nc å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ1"></a>4. 2019-nc å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ1</h1><p>HERA</p><h1 id="5-2019-09-scienceChina-å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ2"><a href="#5-2019-09-scienceChina-å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ2" class="headerlink" title="5. 2019.09-scienceChina å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ2"></a>5. 2019.09-scienceChina å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ2</h1><p><img src="/GeekFocus/2022-03-14-HiFi-6-HiC-assembly/1.png" alt="1"><br><img src="/GeekFocus/img/2022-03-14-HiFi-6-HiC-assembly/1.png" alt="1"></p><p>For genome assembly, we sequenced additional 40 Gb SMRT reads from 5 cells for this update. Therefore, a total of <strong>120Ã— PacBio reads</strong>, <strong>365Ã— Bionano optical maps</strong> marked by BssSI, <strong>275Ã— Bionano optical maps</strong> marked by BspQI, <strong>45Ã— HiSeq</strong> reads and <strong>125Ã—</strong> chromosome conformation capture sequencing (<strong>Hi-C</strong>) reads were used for the new genome assembly (Figure 1A). To make best of the sequencing data, we also <font color="red"><strong>adopted a new genome assembly pipeline</strong> by <strong>adding HERA</strong></font> (Du and Liang, 2018) to improve the sequence contiguity and reduce errors by accurately assembling the repetitive genome regions (Figure 1A). Briefly, <font color="blue">the whole assembly process <strong>differed from</strong> previous pipeline</font> at </p><p>(1) using <font color="red"><strong>CANU</strong></font> (v1.7.1) to replace Smrtmake for assembling PacBio subreads to PacBio contigs; </p><p>(2) using <font color="red"><strong>HERA</strong></font> to generate longer contigs; </p><p>(3) using <font color="red"><strong>Juicer and 3D-DNA to replace HiC-Pro and LACHESIS</strong></font> to anchor the hybrid scaffolds into chromosomes with Hi-C reads.</p><h1 id="6-2020-05-nc-åŒæºå››å€ä½“ç´«èŠ±è‹œè“¿"><a href="#6-2020-05-nc-åŒæºå››å€ä½“ç´«èŠ±è‹œè“¿" class="headerlink" title="6. 2020.05-nc åŒæºå››å€ä½“ç´«èŠ±è‹œè“¿"></a>6. 2020.05-nc åŒæºå››å€ä½“ç´«èŠ±è‹œè“¿</h1><p>HiFiåŠ©åŠ›åŒæºå››å€ä½“ç´«èŠ±è‹œè“¿åŸºå› ç»„ç»„è£…ï¼ŒNC</p><blockquote><p>Allele-aware chromosome-level genome assembly and efficient transgene-free genome editing for the autotetraploid cultivated alfalfa</p></blockquote><p>ï¼ˆ1ï¼‰ä½¿ç”¨Canué»˜è®¤å‚æ•°ï¼Œåˆ©ç”¨CCS clean readsç»„è£…contigsã€‚ç»„è£…å¾—åˆ°çš„Contig N50å€¼ä¸º459kbï¼Œæ€»é•¿åº¦ä¸º3.15GBã€‚</p><blockquote><p>We assembled contigs from CCS clean reads using Canu, with default parameters. The N50 values of the contig sets were 459 kb, with total lengths 3154 Mb.</p></blockquote><p>ï¼ˆ2ï¼‰ä½¿ç”¨HiC-Proå°†Hi-C readsä¸contigs è¿›è¡Œæ¯”å¯¹ï¼Œäº§ç”Ÿæ¯”å¯¹BAMæ–‡ä»¶ã€‚</p><blockquote><p>Hi-C reads were aligned to contigs using <a href="https://pubmed.ncbi.nlm.nih.gov/26619908/">HiC-Pro(2015)</a>, yielding an alignment BAM file.</p></blockquote><p>ï¼ˆ3ï¼‰ä½¿ç”¨æ³¨é‡Šçš„è’ºè—œè‹œè“¿è›‹ç™½ä½œä¸ºå‚è€ƒï¼Œå®Œå…¨åŸºäºåŒæºçš„ç­–ç•¥æ³¨é‡Šcontigsã€‚å¯¹138,729ä¸ªåŒæºåŸºå› è¿›è¡Œäº†ç»“æ„æ³¨é‡Šã€‚ç”¨MCscanç”¨äºé‰´å®šcontigså’Œå‚è€ƒåŸºå› ç»„ä¹‹é—´çš„å…±çº¿æ€§ã€‚æ˜¾ç¤ºç´«èŠ±è‹œè“¿å’Œè’ºè—œè‹œè“¿ä¹‹é—´çš„é«˜å…±çº¿æ€§ã€‚ã€ä¸‹è½½çˆ¶æ¯æœ¬petunia refã€‘</p><blockquote><p>Contigs were annotated with a <font color="red"><strong>solely homology-based strategy</strong></font>, using annotated Medicago truncatula proteins as references. 138,729 homologous genes were structurally annotated. <font color="red"><strong>MCscan</strong> in <strong>Jcvi</strong></font> (<a href="https://zenodo.org/record/31631#.XpkUyTOeask">https://zenodo.org/record/31631#.XpkUyTOeask</a>) was used to identify <font color="red"><strong>synteny blocks</strong></font> between <strong>contigs and the reference</strong> genome. <font color="red"><strong>Contigs syntenic</strong> to M. truncatula were <strong>stacked and aligned</strong> to M. truncatula chromosomes</font>. The syntenic contigs are summarized in Supplementary Table 4.</p></blockquote><p>ï¼ˆ4ï¼‰ä½¿ç”¨å†…éƒ¨è„šæœ¬å¤„ç†BAMæ–‡ä»¶ï¼Œå»é™¤ç­‰ä½åŸºå› contigsä¹‹é—´çš„linksã€‚ä½¿ç”¨ALLHiCè½¯ä»¶ï¼Œ<font color="red">æå–ã€èšç±»å’Œé‡æ’Contigs</font> (Contigs syntenicä¸è’ºè—œè‹œè“¿æŸ“è‰²ä½“ä¸€è‡´)ï¼Œå¾—åˆ°åŸå§‹çš„scaffoldsã€‚</p><blockquote><p>An <strong>in-house script</strong> was used to <font color="red">prune the BAM</font> file and <font color="red">discard links between allelic contigs</font>. Contigs syntenic to one chromosome of M. truncatula, e.g., chr1, were extracted, sub-clustered and reordered using <font color="red">ALLHiC</font>, yielding a raw scaffold set.</p></blockquote><p>ï¼ˆ5ï¼‰<a href="https://pubmed.ncbi.nlm.nih.gov/27467250/">Juicebox</a>ç”¨äºä»¥å›¾å½¢å’Œäº¤äº’æ–¹å¼å¾®è°ƒç»„è£…çš„scaffoldsã€‚å‰ªè£äº†40ä¸ªæ€»é•¿åº¦è¾¾1800Mbçš„scaffolds ã€‚</p><blockquote><p>Juicebox45 was used for fine-tuning assembled scaffolds in a graphic and inter-active fashion. Forty scaffolds with a total length of 1800 Mb were cropped (Supplementary Table 5).</p></blockquote><p>ï¼ˆ6ï¼‰ åŸºäºç»„è£…çš„scaffoldï¼Œé€šè¿‡Hi-Cæ•°æ®ï¼Œæ¯ä¸ªunplaced contigè¢«åˆ†é…åˆ°äº’ä½œæœ€å¼ºçš„é‚£äº›contig clusteré‡Œã€‚</p><blockquote><p>Based on this scaffold assembly, each unplaced contig was assigned to the contig cluster, to which the contig was most connected by Hi-C data.</p></blockquote><p>ï¼ˆ7ï¼‰ä½¿ç”¨ALLHiCå¯¹é‚£äº›contig clusterså†æ¬¡è¿›è¡Œé‡æ’å’Œæ„å»ºscaffoldã€‚</p><blockquote><p>Those contig clusters were reordered and scaffolded using ALLHiC. </p></blockquote><p>ï¼ˆ8ï¼‰ä½¿ç”¨Juiceboxå¯¹scaffoldsè¿›è¡Œå¾®è°ƒï¼Œå¹¶ä»scaffoldsä¸Šå»é™¤ä¸ä¸€è‡´çš„contigsï¼Œäº§ç”Ÿæœ€ç»ˆçš„æŸ“è‰²ä½“åŸºå› ç»„ï¼Œå…¶åŒ…å«32æ¡æŸ“è‰²ä½“(8ä¸ªåŒæºç»„ï¼Œæ¯ä¸ªç»„ä¸­æœ‰4ä¸ªç­‰ä½åŸºå› æŸ“è‰²ä½“)ï¼Œæ€»é•¿åº¦ä¸º2738Mbï¼Œå’Œ419MbæœªæŒ‚è½½åˆ°æŸ“è‰²ä½“æ°´å¹³çš„åºåˆ—ã€‚</p><blockquote><p>Using Juicebox, scaffolds were fine-tuned and discordant contigs were removed from scaffolds, and the final chromosome assembly was generated, containing 32 chromosomes with a total length of 2738 Mb (Supplementary Table 6).</p></blockquote><h1 id="7-2021-11-gb-æ¤°å­ğŸ¥¥"><a href="#7-2021-11-gb-æ¤°å­ğŸ¥¥" class="headerlink" title="7. 2021.11-gb æ¤°å­ğŸ¥¥"></a>7. 2021.11-gb æ¤°å­ğŸ¥¥</h1><p>High-quality reference genome sequences of two coconut cultivars provide insights into evolution of monocot chromosomes and differentiation of fiber content and plant height</p><p>è¯¥ç ”ç©¶ç»˜åˆ¶ä¸¤ä¸ªå‚è€ƒçº§åˆ«æ¤°å­åŸºå› ç»„ã€‚æ­ç¤ºå•å­å¶æ¤ç‰©æŸ“è‰²ä½“çš„è¿›åŒ–è¿‡ç¨‹å’Œæ¤°å­æŸ“è‰²ä½“çš„å½¢æˆè¿‡ç¨‹ï¼Œåˆ†æé«˜çŸ®ä¸¤ç§æ¤°å­è€ç›ï¼Œæ ªé«˜ï¼Œçº¤ç»´å’Œè„‚è´¨å«é‡ç­‰å…³é”®æ€§çŠ¶çš„é—ä¼ å·®å¼‚ï¼ŒåŒæ—¶å‘ç°æ¤°å­è¿›åŒ–è¿‡ç¨‹ä¸­çº¦åœ¨400ä¸‡å¹´å‰è‡ªç„¶å‘ç”Ÿçš„ç»¿è‰²é©å‘½ã€‚é«˜æ¤°å­2.39GçŸ®æ¤°å­2.40Gã€‚åŸºäºæ¤°å­ï¼Œç´«èï¼Œè èç­‰åŸºå› ç»„çš„å…±çº¿æ€§å…³ç³»ï¼Œé‡æ–°æ„å»ºäº†å«æœ‰10æ¡æŸ“è‰²ä½“çš„å¤å•å­å¶æ¤ç‰©åŸºå› ç»„æ ¸å‹ï¼Œå¹¶å¯¹åŸºå› ç»„æ ¸å‹çš„è¿›åŒ–è·¯çº¿è¿›è¡Œæ¨æ–­ã€‚è¿›ä¸€æ­¥åˆ©ç”¨å¶é—´è·è¡¨å‹è¿›è¡Œå…¨åŸºå› ç»„å…³è”åˆ†æï¼Œé‰´å®šå‡º12å·æŸ“è‰²ä½“ä¸ŠGA20oxåŸºå› ä¸æ¤°å­æ ªé«˜æ˜¾è‘—ç›¸å…³ï¼Œå¹¶å­˜åœ¨æ‹·è´æ•°å˜å¼‚ï¼›æ•´åˆå¤šç§æ‰‹æ®µéªŒè¯HA20oxä»¥åŠèµ¤éœ‰ç´ ä»£è°¢é€”å¾„åœ¨é«˜çŸ®ç§çš„å·®å¼‚å¹¶å¯¼è‡´æ ªé«˜å·®å¼‚ã€‚400ä¸‡å¹´å‰ï¼Œç»¿è‰²é©å‘½ã€‚</p><h2 id="Hi-C-based-genome-assembly"><a href="#Hi-C-based-genome-assembly" class="headerlink" title="Hi-C-based genome assembly"></a>Hi-C-based genome assembly</h2><p>Both Cn. tall and Cn. dwarf genomes were assembled de novo using SMARTdenovo (<a href="https://github.com/ruanjue/smartdenovo">https://github.com/ruanjue/smartdenovo</a>) [-k 19 -J 3000] based on <font color="red"><strong>Nanopore long reads</strong></font> <strong>corrected</strong> with <font color="red"><strong>NextDenovo</strong></font> (<a href="https://github.com/Nextomics/NextDenovo">https://github.com/Nextomics/NextDenovo</a>). Raw contigs were <font color="blue"><strong>polished</strong></font> using <font color="blue"><strong>Nanopore long reads</strong></font> and <font color="blue"><strong>Illumina short reads</strong></font> with <font color="red"><strong>Next-Polish</strong></font> (v1.2.2) [49]. Then polished contigs were <font color="blue"><strong>anchored</strong></font> into chromosomes by using <font color="red"><strong>HiC-Pro (v2.11.1)</strong></font> [50] and <font color="red"><strong>LACHESIS</strong></font>[51]. Finally, the assembled genomes were <font color="blue"><strong>manual correction</strong></font> with <font color="red"><strong>Juicebox</strong></font> (v1.11.08).</p><p>To assess the quality of assembled genomes, raw Illumina <font color="blue"><strong>paired-end</strong> reads and <strong>RNA-seq</strong></font> reads from multiple tissues were <font color="blue"><strong>mapping</strong></font> to the genomes using <font color="red"><strong>BWA (v0.7.17-r1188)</strong></font> [52] and <font color="red"><strong>HISAT2 (v2.1.0)</strong></font> [53], respectively. In addition, Benchmarking Universal Single-Copy Orthologs (<font color="red"><strong>BUSCO</strong></font>) was also used to assess the genome completeness base on Embryophyta Plant database (odb10) [54].</p><h1 id="8-2021-11-nc-é‡‘ç²Ÿå…°åŸºå› ç»„"><a href="#8-2021-11-nc-é‡‘ç²Ÿå…°åŸºå› ç»„" class="headerlink" title="8. 2021.11-nc é‡‘ç²Ÿå…°åŸºå› ç»„"></a>8. 2021.11-nc é‡‘ç²Ÿå…°åŸºå› ç»„</h1><p>å¡«è¡¥æ ¸å¿ƒè¢«å­æ¤ç‰©æœ€åä¸»è¦åˆ†æ”¯-é‡‘ç²Ÿå…°ç›®çš„åŸºå› ç»„ä¿¡æ¯ï¼Œæä¾›è¢«å­æ¤ç‰©æ—©æœŸæ¼”åŒ–è¯æ®ã€‚åˆ˜å»ºå…¨å›¢é˜Ÿè‡´åŠ›äºè§£æç±»ç¾¤æ¼”åŒ–ï¼Œæ¢ç©¶ä¸åŒç‰©ç§é—´åˆ†åŒ–é€‚åº”é—ä¼ æœºåˆ¶ã€‚</p><p>è¢«å­æ¤ç‰©ï¼ˆAngiosperms or flowering plantsï¼‰æ˜¯åœ°çƒä¸Šåˆ†å¸ƒèŒƒå›´æœ€å¹¿ã€å¤šæ ·åŒ–æœ€é«˜ã€é€‚åº”æ€§æœ€å¼ºçš„é™†ç”Ÿæ¤ç‰©ç±»ç¾¤ï¼Œæå¤§åœ°å½±å“äº†å…¶ä»–ç”Ÿç‰©ç±»ç¾¤çš„æ¼”åŒ–è¿›ç¨‹ï¼Œç„¶è€Œï¼Œç”±äºè¢«å­æ¤ç‰©åœ¨æ—©æœŸç»å†äº†å¿«é€Ÿçš„è¾å°„è¿›åŒ–ï¼Œå…¶å†…éƒ¨æ¼”åŒ–å…³ç³»è¿Ÿè¿Ÿæœªè¢«è§£å†³ï¼Œè¿™ä¸€é—®é¢˜ä¹Ÿè¢«ç§°ä¸ºè¾¾å°”æ–‡çš„â€œæ¼äººä¹‹è°œâ€ã€‚ç»è¿‡å‰äººé•¿æ—¶æœŸçš„åŠªåŠ›ï¼Œç›®å‰è¢«å­æ¤ç‰©è¢«åˆ’åˆ†ä¸ºï¼šæ— æ²¹æ¨Ÿç›®ã€ç¡è²ç›®ã€æœ¨å…°è—¤ç›®å’Œæ ¸å¿ƒè¢«å­æ¤ç‰©ï¼ˆMesangiospermaeï¼‰ã€‚æ— æ²¹æ¨Ÿç›®ã€ç¡è²ç›®ã€æœ¨å…°è—¤ç›®å…±åŒè¢«ç§°ä¸ºANA gradeï¼Œæ˜¯è¢«å­æ¤ç‰©çš„åŸºéƒ¨ç±»ç¾¤ï¼Œç³»ç»Ÿå‘è‚²å…³ç³»ç›¸å¯¹ç¨³å®šï¼Œè€Œæ ¸å¿ƒè¢«å­æ¤ç‰©åŒ…å«äº†~99.95%çš„è¢«å­æ¤ç‰©ï¼Œåˆå¯è¢«åˆ’åˆ†ä¸º5å¤§ç±»ç¾¤ï¼šåŒå­å¶ã€å•å­å¶ã€æœ¨å…°ç±»ã€é‡‘é±¼è—»ç›®å’Œé‡‘ç²Ÿå…°ç›®ï¼Œå®ƒä»¬ä¹‹é—´çš„æ¼”åŒ–å…³ç³»ä¸€ç›´å­˜åœ¨äº‰è®®ã€‚è¿‘å¹´æ¥ï¼Œéšç€å„ç±»ç¾¤ä»£è¡¨ç‰©ç§å…¨åŸºå› ç»„æµ‹åºç›¸ç»§å®Œæˆï¼Œå…¶å„è‡ªçš„è¿›åŒ–å†ç¨‹å‡æœ‰äº†åšå®è€Œå¯é çš„è¯æ®ï¼Œåˆ˜å»ºå…¨å›¢é˜Ÿåœ¨2020å¹´é¦–æ¬¡æŠ¥é“äº†é‡‘é±¼è—»å’ŒèŠ¡å®çš„åŸºå› ç»„ï¼Œè¯æ˜äº†æ ¸å¿ƒè¢«å­æ¤ç‰©å†…éƒ¨å­˜åœ¨å¹¿æ³›çš„ä¸å®Œå…¨è°±ç³»åˆ†é€‰å’Œæ‚äº¤äº‹ä»¶æ˜¯å¯¼è‡´æ ‘å½¢å†²çªçš„ä¸»è¦åŸå› ã€‚ä½†æ˜¯é‡‘ç²Ÿå…°ç›®ä¸€ç›´æœªæœ‰åŸºå› ç»„æŠ¥é“ï¼Œå…¶æ¼”åŒ–å†ç¨‹ä»¥åŠæ•´ä¸ªæ ¸å¿ƒè¢«å­æ¤ç‰©çš„æ¼”åŒ–è¿‡ç¨‹è¿˜æœ‰å¾…æ·±å…¥åˆ†æã€‚ä¸ºæ­¤è¯¥å›¢é˜Ÿå†æ¬¡åˆ©ç”¨Nanoporeã€Illuminaå’ŒHi-CæŠ€æœ¯ï¼Œæ„å»ºäº†ç¬¬ä¸€ä¸ªé‡‘ç²Ÿå…°ç›®æ¤ç‰©ï¼ˆå››å·é‡‘ç²Ÿå…°ï¼Œ<em>Chloranthus sessilifolius</em>ï¼‰çš„é«˜è´¨é‡æŸ“è‰²ä½“çº§åˆ«åŸºå› ç»„ï¼ŒContig N50é«˜è¾¾53.74 Mbï¼ˆå›¾1ï¼‰ï¼Œä½¿ç”¨å¤šç§åˆ†ææ–¹æ³•å¯¹ä¸Šè¿°é—®é¢˜è¿›è¡Œäº†æ·±å…¥çš„é˜è¿°ã€‚</p><p>é€šè¿‡ä½¿ç”¨å¤šç§ç³»ç»Ÿå‘è‚²åŸºå› ç»„å­¦åˆ†æï¼ŒåŒ…æ‹¬å•æ‹·è´åŸºå› ã€ä½æ‹·è´åŸºå› å’Œå…±çº¿æ€§åŸºå› æ•°æ®é›†ï¼Œè¿›è¡Œäº†ä¸²è”æ ‘å’Œæº¯ç¥–æ ‘çš„æ„å»ºï¼ŒåŒæ—¶è¯„ä¼°äº†é•¿æå¸å¼•ã€ç‰©ç§é€‰æ‹©å’ŒåŒæºèšç±»æ–¹æ³•ç­‰çš„å½±å“ï¼Œä½¿ç”¨å¤šå¥—æ•°æ®é›†åˆå’Œå¤šç§åˆ†ææ–¹æ³•ï¼Œè·å¾—äº†é«˜å¯ä¿¡åº¦çš„æ‹“æ‰‘ç»“æ„ï¼Œå³é‡‘ç²Ÿå…°ç›®å’Œæœ¨å…°ç±»å…·æœ‰æœ€è¿‘çš„äº²ç¼˜å…³ç³»ï¼Œä¸”ä»–ä»¬ä¸€èµ·ä¸é‡‘é±¼è—»ç›®+åŒå­å¶æ¤ç‰©æ„æˆå§Šå¦¹å…³ç³»ï¼Œè€Œå•å­å¶æ¤ç‰©æ˜¯å…¶å®ƒæ‰€æœ‰æ ¸å¿ƒè¢«å­æ¤ç‰©çš„å§Šå¦¹æï¼ˆå›¾2ï¼‰ã€‚</p><p>åŒæ—¶ï¼Œä½œè€…ä¹Ÿå‘ç°äº†å¤§é‡çš„åŸºå› æ ‘æˆ–å¶ç»¿ä½“æ ‘ä¸ç‰©ç§æ ‘ä¸ä¸€è‡´çš„æƒ…å†µï¼Œå› æ­¤ç€é‡è¯„ä¼°äº†ä¸å®Œå…¨è°±ç³»åˆ†é€‰ï¼ˆILSï¼‰å’Œæ‚äº¤äº‹ä»¶å¯¹æ­¤å†²çªçš„è´¡çŒ®ã€‚é€šè¿‡PhyloNetworksåˆ†æé‰´å®šåˆ°äº†ä¸‰æ¬¡å¯èƒ½çš„æ‚äº¤äº‹ä»¶ï¼Œå¯ä»¥è§£æéƒ¨åˆ†çš„æ ‘å½¢å†²çªã€‚ç„¶è€Œå€¼å¾—æ³¨æ„çš„æ˜¯äº”å¤§ç±»ç¾¤ä¹‹é—´çš„åˆ†åŒ–æ—¶é—´ä»…æœ‰23ä¸ªç™¾ä¸‡å¹´ï¼ˆ158~135 Myaï¼‰ï¼Œå¦‚æ­¤çŸ­çš„åˆ†åŒ–æ—¶é—´ï¼ŒILSå¯èƒ½å‘æŒ¥äº†æ›´ä¸ºä¸»è¦çš„ä½œç”¨ã€‚ä½¿ç”¨thetaå‚æ•°å¯¹æ¯ä¸ªå†…éƒ¨åˆ†æ”¯å‘ç”ŸILSçš„æ¦‚ç‡è¿›è¡Œè¯„ä¼°å‘ç°ï¼Œé™¤äº†æœ¨å…°ç±»å’Œé‡‘ç²Ÿå…°ç›®çš„å§Šå¦¹å…³ç³»è¾ƒä¸ºç¨³å®šå¤–ï¼Œå…¶ä»–ç±»ç¾¤é—´éƒ½å…·æœ‰è¾ƒé«˜çš„thetaå€¼ï¼Œè€Œé‡‘é±¼è—»ç›®+åŒå­å¶çš„ç¥–å…ˆåˆ†æå…·æœ‰è¾ƒé«˜çš„tehtaå€¼ï¼Œå‡è¡¨æ˜äº†ILSåœ¨æ ¸å¿ƒè¢«å­æ¤ç‰©å†…éƒ¨çš„æ¼”åŒ–ä¸­å‘æŒ¥äº†é‡è¦ä½œç”¨ï¼ˆå›¾3 aå’Œbï¼‰ã€‚åŸºäºPhyabseå’ŒDendroPyè¿›è¡Œæ ‘å½¢æ¨¡æ‹Ÿè¡¨æ˜ï¼Œå½“å­˜åœ¨ILSæ—¶æ¨¡æ‹Ÿçš„æ ‘å½¢å’ŒçœŸå®æ ‘å½¢å…·æœ‰é«˜åº¦ä¸€è‡´æ€§ï¼ˆR2ï¼0.99ï¼‰ï¼Œè€Œä¸å­˜åœ¨ILSçš„æ¨¡æ‹Ÿæ ‘å½¢ä¸çœŸå®æ ‘å½¢åˆ™å…·æœ‰è¾ƒä½çš„ç›¸å…³æ€§ï¼Œè¿›ä¸€æ­¥è¡¨æ˜äº†ILSåœ¨æ ¸å¿ƒè¢«å­æ¤ç‰©çš„å¿«é€Ÿè¾å°„ä¸­å‘æŒ¥äº†é‡è¦ä½œç”¨ï¼ˆå›¾3 c-fï¼‰ã€‚è¿›ä¸€æ­¥å¯¹æ ‘å½¢å¼‚è´¨æ€§è¿›è¡ŒåŒºåˆ†è¡¨æ˜ï¼ŒILSå¯åŸºæœ¬è§£é‡Šé‡‘é±¼è—»ç›®+åŒå­å¶çš„ç¥–å…ˆæä¸Šçš„æ ‘å½¢å†²çªï¼Œä¹Ÿå°±æ˜¯é‡‘é±¼è—»ç›®+åŒå­å¶ã€æœ¨å…°ç±»+é‡‘ç²Ÿå…°å’Œå•å­å¶ä¹‹é—´çš„å†²çªï¼Œè€Œå…¶ä»–æ ¸å¿ƒè¢«å­æ¤ç‰©ç±»ç¾¤é—´çš„å†²çªè¿˜æœ‰å…¶ä»–å› ç´ ï¼ˆä¾‹å¦‚æ‚äº¤ï¼‰çš„å‚ä¸ã€‚</p><p>æ­¤å¤–ï¼Œæœ¬ç ”ç©¶è¿˜é‰´å®šäº†å››å·é‡‘ç²Ÿå…°ç‹¬æœ‰çš„ä¸€æ¬¡WGDäº‹ä»¶ï¼ŒåŒæ—¶5å¤§æ ¸å¿ƒè¢«å­æ¤ç‰©åˆ†æçš„åŠ å€äº‹ä»¶éƒ½ä¸å…±äº«ï¼›é‰´å®šäº†èŠ±å‘è‚²ç›¸å…³çš„åŸºå› å®¶æ—ï¼Œè§£æäº†å…¶ç‰¹æœ‰èŠ±å™¨å®˜çš„å¯èƒ½å½¢æˆåŸå› ï¼›é‰´å®šäº†èœç±»åˆæˆå’Œæœ¨è´¨éƒ¨å½¢æˆç›¸å…³çš„åŸºå› å®¶æ—ï¼Œä¸ºä»Šåç ”ç©¶å…¶ç®€å•æœ¨è´¨éƒ¨å½¢æˆå’Œèœç±»ç‰©ç§åˆæˆé€šè·¯æ¼”åŒ–æä¾›äº†åŸºç¡€ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ç ”ç©¶æŠ¥é“äº†é«˜è´¨é‡çš„å››å·é‡‘ç²Ÿå…°åŸºå› ç»„ï¼Œå¡«è¡¥äº†æ ¸å¿ƒè¢«å­æ¤ç‰©é‡‘ç²Ÿå…°ç›®çš„åŸºå› ç»„ä¿¡æ¯ï¼Œå¹¶é€šè¿‡å¤šç§åˆ†æç­–ç•¥å’Œæ–¹æ³•ï¼Œæ·±å…¥çš„æ­ç¤ºäº†æ ¸å¿ƒè¢«å­æ¤ç‰©é—´çš„å¤æ‚æ¼”åŒ–å†ç¨‹ï¼Œè¯¥æˆæœå¯¹äºæ—©æœŸè¢«å­æ¤ç‰©çš„èµ·æºã€è¾å°„è¿›åŒ–ä»¥åŠé€‚åº”æ€§æ¼”åŒ–æä¾›æ•°æ®æ”¯æ’‘å’Œç†è®ºåŸºç¡€ã€‚</p><h2 id="Genome-size-estimate-and-assembly"><a href="#Genome-size-estimate-and-assembly" class="headerlink" title="Genome size estimate and assembly."></a>Genome size estimate and assembly.</h2><p>To estimate the genome size of C. sessilifolius, we surveyed 150 bp paired-end reads, computed 21 bp K-mer frequencies using <font color="red"><strong>Jellyfish</strong></font>, and exported the resulting histogram into <font color="red">findGSE</font>. <font color="red"><strong>Nextdenovo</strong></font> (https:&#x2F;&#x2F; github.com&#x2F;Nextomics&#x2F;Nextdenovo) was selected for <font color="blue"><strong>correcting reads</strong></font> with para- meters â€œread_cutoff&#x3D;2k, seed_cutoff&#x3D;30k, blocksize&#x3D;1.5gâ€ and then <font color="red"><strong>Smartdenovo</strong></font> (<a href="https://github.com/ruanjue/smartdenovo">https://github.com/ruanjue/smartdenovo</a>) for <font color="blue"><strong>de novo assembly</strong></font> with parameters â€œwtpre -J 3,000; wtzmo-k 21 -z 10 -Z 16 -U -1 -m 0.1 -A 1000; wtclp -d 3 -k 300 -m 0.1 -FT; wtlay -w 300 -s 200 -m 0.1 -r 0.95 -c 1â€. <font color="blue">The preliminary contigs were further <strong>polished</strong> by aligning the Illumina <strong>short</strong> <strong>reads</strong> to the contigs</font> using <font color="red"><strong>Nextpolish</strong></font>. After four rounds of successive iterative correction, the final genome sequence was obtained. The GC content and sequencing coverage analyses were applied to evaluate the presence of contamination. The quality of the genome assembly was also assessed using <font color="red"><strong>BUSCO</strong></font> (Benchmarking Universal Single-Copy Orthologs) with the embry- ophyta_odb10 database. The clean <font color="blue">Hi-C</font> data were mapped to contig sequences by <font color="red"><strong>Bowtie2</strong></font> and 354 Mb valid interaction pairs were extracted. Based on those chromatin interactions, <font color="red"><strong>LACHESIS</strong></font> was employed to <font color="blue"><strong>cluster</strong>, <strong>order</strong>, and <strong>orient</strong> the <strong>contigs</strong> into <strong>pseudo-chromosomes</strong></font>.</p><h1 id="9-2022-01-gb-æ²¹èŒ¶"><a href="#9-2022-01-gb-æ²¹èŒ¶" class="headerlink" title="9. 2022.01-gb æ²¹èŒ¶"></a>9. 2022.01-gb æ²¹èŒ¶</h1><blockquote><p>The genome of oil-Camellia and population genomics analysis provide insights into seed oil domestication</p></blockquote><p>æ²¹èŒ¶æ˜¯æˆ‘å›½ä¼ ç»Ÿæœ¨æœ¬æ²¹æ–™æ ‘ç§ï¼Œå…·æœ‰2300ä½™å¹´æ ½åŸ¹é£Ÿç”¨å†å²ã€‚è‡ªä¸Šä¸–çºªèµ·ï¼Œç»è¿‡å››ä»£ç§‘æŠ€å·¥ä½œè€…è‰°è‹¦åŠªåŠ›ï¼Œæˆ‘å›½æ²¹èŒ¶ä¸»æ ½è‰¯ç§è¡ç”Ÿå‡ºæ•°ç™¾ä¸ªå“ç§ã€‚ä½†å—åˆ¶äº<font color="blue">å¤šå€æ€§ã€é•¿æ—¶æ•ˆ</font>ç‰¹æ€§ï¼Œæ²¹èŒ¶è‚²ç§å·¥ä½œæ•ˆç‡ä¸é«˜ã€‚</p><p>2022å¹´1æœˆ10æ—¥ï¼Œä¸­å›½æ—ä¸šç§‘å­¦ç ”ç©¶é™¢äºšçƒ­å¸¦æ—ä¸šç ”ç©¶æ‰€ï¼ˆäºšæ—æ‰€ï¼‰ç ”ç©¶å‘˜<strong>å§šå°åå›¢é˜Ÿ</strong>å’Œ<strong>æ®·æ’ç¦å›¢é˜Ÿ</strong>åœ¨<strong>ã€ŠåŸºå› ç»„ç”Ÿç‰©å­¦ã€‹ï¼ˆGenome Biologyï¼‰</strong>å‘è¡¨æœ€æ–°è®ºæ–‡ã€‚</p><p>è¯¥ç ”ç©¶æˆåŠŸç»„è£…å…¨çƒé¦–ä¸ªæŸ“è‰²ä½“çº§åˆ«é«˜è´¨é‡æ²¹èŒ¶åŸºå› ç»„ï¼Œæ­ç¤º<font color="red">æ²¹èŒ¶ç‰©ç§<strong>è¿›åŒ–å†å²</strong>åŠå…¶<strong>ç§å­å«é«˜æ²¹è„‚</strong>ã€<strong>é«˜ä¸é¥±å’Œè„‚è‚ªé…¸</strong>çš„<strong>é©¯åŒ–æœºåˆ¶</strong></font>ï¼Œå»ºç«‹äº†æ²¹è„‚æ€§çŠ¶æ—©æœŸé€‰æ‹©æŠ€æœ¯ä½“ç³»ï¼Œä¸ºåŠ å¿«è‰¯ç§é€‰è‚²æ•ˆç‡ã€ä¿éšœæˆ‘å›½ç²®æ²¹å®‰å…¨å¥ å®šäº†åŸºç¡€ã€‚</p><h2 id="æŠ±å­æ€€èƒçš„æ²¹èŒ¶è‰¯ç§è‚²ç§ç¼“æ…¢"><a href="#æŠ±å­æ€€èƒçš„æ²¹èŒ¶è‰¯ç§è‚²ç§ç¼“æ…¢" class="headerlink" title="æŠ±å­æ€€èƒçš„æ²¹èŒ¶è‰¯ç§è‚²ç§ç¼“æ…¢"></a>æŠ±å­æ€€èƒçš„æ²¹èŒ¶è‰¯ç§è‚²ç§ç¼“æ…¢</h2><p>è‰¯ç§æ˜¯å†œä¸šç”Ÿäº§çš„â€œèŠ¯ç‰‡â€ã€‚ä½œä¸ºæˆ‘å›½å››å¤§æ²¹æ–™ä½œç‰©ä¹‹ä¸€ï¼Œæ²¹èŒ¶æ˜¯å†œæ°‘å¢æ”¶ã€ç²®æ²¹å®‰å…¨ã€ç”Ÿæ€å»ºè®¾çš„â€œé‡è¦æ³•å®â€ã€‚æˆ‘å›½æ²¹èŒ¶è‚²ç§å†ç»äº†é€‰æ‹©è‚²ç§å’Œå®šå‘æ‚äº¤è‚²ç§é˜¶æ®µï¼Œä¸»æ ½è‰¯ç§ç”±å®¶ç³»å“ç§ã€å†œå®¶å“ç§èµ°å‘æ— æ€§ç³»è‰¯ç§ï¼Œè¡ç”Ÿå‡ºæ•°ç™¾ä¸ªå“ç§ï¼Œæ„æˆäº†æˆ‘å›½æ²¹èŒ¶äº§ä¸šçš„å‘å±•åŸºç¡€ã€‚</p><p>ä½†ç”±äºæ²¹èŒ¶ç»“å®ä¹‹å‰è¦ç»å†æ¼«é•¿çš„ç«¥æœŸï¼Œè€Œä¸”ä»<font color="blue">å¼€èŠ±åˆ°æœå®æˆç†Ÿéœ€è¦æ•´æ•´1å¹´æ—¶é—´</font>ï¼Œä¿—ç§°â€˜æŠ±å­æ€€èƒâ€™ï¼Œå¯¼è‡´æ²¹èŒ¶è‚²ç§å¹´é™é•¿ï¼Œæ–°å“ç§é€‰è‚²ç¼“æ…¢ï¼Œè‰¯ç§é€‰è‚²é€Ÿåº¦æ— æ³•æ»¡è¶³äº§ä¸šå‘å±•çš„éœ€æ±‚ï¼Œå·²æˆä¸ºé˜»ç¢æ²¹èŒ¶äº§ä¸šå‘å±•çš„é‡è¦å› ç´ ã€‚</p><p>æˆ‘å›½é•¿æœŸé¢ä¸´é£Ÿç”¨æ²¹ä¾›éœ€å‹åŠ›ï¼Œå¯¹å¤–ä¾å­˜åº¦é«˜è¾¾60%ã€‚æ²¹èŒ¶èƒ½å¤Ÿåˆ©ç”¨æˆ‘å›½äºšçƒ­å¸¦åŒºåŸŸçš„å®œæ—å±±åœ°ç§æ¤ï¼Œä¸ä¸ç²®äº‰åœ°ï¼Œæ˜¯ä¿éšœæˆ‘å›½ç²®æ²¹å®‰å…¨ã€å®ç°ä¹¡æ‘æŒ¯å…´çš„é‡è¦æŠ“æ‰‹ã€‚</p><p>æ²¹èŒ¶æ³›æŒ‡å±±èŒ¶ç§‘å±±èŒ¶å±æ¤ç‰©ä¸­æ²¹è„‚å«é‡é«˜ï¼Œå…·æœ‰ä¸€å®šæ ½åŸ¹é¢ç§¯çš„ï¼Œæœ‰ç»æµæ ½åŸ¹ä»·å€¼çš„ç‰©ç§çš„æ€»ç§°ï¼Œæ˜¯æˆ‘å›½ä¸»æ¨çš„é‡è¦æœ¨æœ¬æ²¹æ–™æ ‘ç§ã€‚æˆ‘å›½ç°æœ‰æ²¹èŒ¶ç§æ¤é¢ç§¯7000ä¸‡äº©ï¼Œä»¥æ™®é€šæ²¹èŒ¶ï¼ˆCamellia oleiferaï¼‰ä¸ºä¸»ï¼Œå¹´æ€»äº§å€¼1200äº¿å…ƒå·¦å³ã€‚</p><p>æ²¹èŒ¶ç±½æ²¹ä¸­ä¸é¥±å’Œè„‚è‚ªé…¸è¾¾90%ä»¥ä¸Šï¼Œå…¶ä¸­ä»¥å•ä¸é¥±å’Œè„‚è‚ªé…¸æ²¹é…¸ä¸ºä¸»ï¼Œå¯Œå«è§’é²¨çƒ¯ã€ç»´ç”Ÿç´ Eã€ç”¾é†‡ã€å¤šé…šç­‰åŠŸèƒ½æˆåˆ†ï¼Œå…·æœ‰æé«˜çš„ä¿å¥ä»·å€¼ï¼Œè¢«èª‰ä¸ºâ€œæ¶²ä½“é»„é‡‘â€ã€‚</p><p>ç„¶è€Œç ”ç©¶å‘ç°, æ²¹èŒ¶åŸºå› ç»„å…·æœ‰<font color="red"><strong>æ‚åˆç‡é«˜ã€é‡å¤åºåˆ—å æ¯”å¤§</strong>çš„ç‰¹ç‚¹ï¼Œå…¶æ‚åˆç‡è¾¾åˆ°äº†<strong>2.52%</strong></font>ï¼Œè¿œé«˜äºå¤§éƒ¨åˆ†å·²æµ‹åºçš„ç‰©ç§ï¼Œè¿™ä¸ºåŸºå› ç»„ç»„è£…å¸¦æ¥äº†å·¨å¤§æŒ‘æˆ˜ã€‚</p><h2 id="æŸ“è‰²ä½“çº§åˆ«ç»„è£…"><a href="#æŸ“è‰²ä½“çº§åˆ«ç»„è£…" class="headerlink" title="æŸ“è‰²ä½“çº§åˆ«ç»„è£…"></a>æŸ“è‰²ä½“çº§åˆ«ç»„è£…</h2><p>ç»è¿‡å››å¹´å¤šçš„åŠªåŠ›ï¼Œè¯¥å›¢é˜Ÿè·å¾—å¤§å°ä¸º<font color="red">2.95 GBï¼ŒContig N50ä¸º<strong>1.002 MB</strong></font>çš„äºŒå€ä½“æ²¹èŒ¶ï¼ˆCONï¼‰çš„åŸºå› ç»„å›¾è°±ï¼Œå¹¶å°†åŸºå› ç»„<font color="red">é”šå®šåˆ°15æ¡æŸ“è‰²ä½“</font>ï¼Œé”šå®šç‡è¾¾åˆ°<font color="red">91.33%</font>ï¼Œè·å¾—äº†è´¨é‡ä¼˜è‰¯çš„æ²¹èŒ¶åŸºå› ç»„å›¾è°±ã€‚</p><p><img src="/GeekFocus/2022-03-14-HiFi-6-HiC-assembly/2.png"><br><img src="/GeekFocus/img/2022-03-14-HiFi-6-HiC-assembly/2.png" alt="æ²¹èŒ¶åŸºå› ç»„å›¾è°±åŠå…¶è¿›åŒ–"></p><p>åŒæ—¶ï¼Œåˆ©ç”¨æ§åˆ¶æ‚äº¤çš„ç¾¤ä½“å»ºç«‹<font color="red"><strong>é«˜å¯†åº¦çš„é—ä¼ æ ‡è®°è¿é”å›¾è°±</strong></font>ï¼Œå¯¹<font color="red">åŸºå› ç»„<strong>å›¾è°±ç»„è£…</strong>è¿›è¡Œè¿›ä¸€æ­¥<strong>æ ¡æ­£</strong></font>ï¼Œä¸ºæœªæ¥é‡è¦æ€§çŠ¶çš„åŸºå› å®šä½æä¾›æ”¯æ’‘ã€‚</p><p>æ²¹èŒ¶ç‰©ç§èµ·æºä¸åˆ†å¸ƒä¸»è¦é›†ä¸­åœ¨æˆ‘å›½å—æ–¹äºšçƒ­å¸¦åœ°åŒºã€‚é€šè¿‡å¯¹æ²¹èŒ¶åŸºå› ç»„çš„æ¯”è¾ƒåˆ†æï¼Œå‘ç°æ²¹èŒ¶åŸºå› ç»„å…±å‘ç”Ÿ<font color="red"><strong>ä¸¤æ¬¡å…¨åŸºå› ç»„å¤åˆ¶</strong>äº‹ä»¶</font>ï¼šç¬¬ä¸€æ¬¡ä¸ºå¤è€çš„<font color="red">Î³å¤åˆ¶</font>ï¼Œç¬¬äºŒæ¬¡å‘ç”Ÿåœ¨<font color="red"><strong>å±±èŒ¶å±ä¸çŒ•çŒ´æ¡ƒå±</strong>åˆ†åŒ–å‰ä¸ä¹…</font>ã€‚</p><p>è€Œå±±èŒ¶å±å½¢æˆä¹‹åå¹¶æ²¡æœ‰å‘ç”Ÿç‰¹æ®Šçš„å…¨åŸºå› ç»„å¤åˆ¶äº‹ä»¶ã€‚é€šè¿‡å±±èŒ¶â€”çŒ•çŒ´æ¡ƒã€å±±èŒ¶â€”æŸ¿ã€æŸ¿â€”çŒ•çŒ´æ¡ƒ<font color="red"><strong>å±é—´åŒæºçªå˜ç‡çš„æ¯”è¾ƒ</strong></font>å°è¯è¿™ä¸€è§‚ç‚¹ã€‚</p><p><img src="/GeekFocus/2022-03-14-HiFi-6-HiC-assembly/3.png"><br><img src="/GeekFocus/img/2022-03-14-HiFi-6-HiC-assembly/3.png" alt="æ²¹èŒ¶åŸºå› ç»„é‡å¤åºåˆ—åˆ†æ"></p><p>å±±èŒ¶å±åŒ…æ‹¬200å¤šä¸ªç‰©ç§ï¼ŒåŒ…æ‹¬ä»¥<strong>æ™®é€šæ²¹èŒ¶</strong>ä¸ºä»£è¡¨çš„æ²¹èŒ¶ç»„ã€ä»¥<strong>èŒ¶</strong>ä¸ºä»£è¡¨çš„èŒ¶ç»„å’Œä»¥<strong>å±±èŒ¶èŠ±</strong>ä¸ºä»£è¡¨çš„å±±èŒ¶ç»„ç­‰ã€‚ç³»ç»Ÿå‘è‚²å’Œåˆ†å­é’Ÿæ ‡å®šåˆ†æå‘ç°ï¼Œ<strong>æ²¹èŒ¶å’ŒèŒ¶çš„åˆ†åŒ–</strong>å‘ç”Ÿåœ¨å¤§çº¦17.3ç™¾ä¸‡å¹´å‰ã€‚</p><p>åœ¨é•¿æœŸæ ½åŸ¹é©¯åŒ–ä¸­ï¼ŒåŒºåˆ«äºä»¥å¶ç”¨ä¸ºç›®çš„çš„èŒ¶å’Œä»¥è§‚èµä¸ºç›®çš„çš„å±±èŒ¶ï¼Œæ²¹èŒ¶åœ¨äººå·¥é€‰æ‹©ä½œç”¨ä¸‹è¿›åŒ–æˆä»¥ç§å­æ²¹è„‚ä¸ºä¸»è¦æ ½åŸ¹ç›®çš„çš„æœ¨æœ¬æ²¹æ–™æ ‘ç§ï¼Œä½¿å¾—æ²¹èŒ¶æˆä¸ºç ”ç©¶æ¤ç‰©ç§å­<font color="red"><strong>æ²¹è„‚æ€§çŠ¶é©¯åŒ–</strong></font>çš„ç»ä½³ææ–™ã€‚</p><p>ä¸ºè¿›ä¸€æ­¥æ­ç¤ºæ²¹èŒ¶æ²¹è„‚æ€§çŠ¶é©¯åŒ–çš„åˆ†å­æœºåˆ¶ï¼Œè¯¥å›¢é˜Ÿåˆ©ç”¨å…¨å›½åˆ†å¸ƒåŒºå†…çš„<font color="red">221ä¸ªä»£è¡¨å“ç§</font>å¼€å±•<font color="red"><strong>ç¾¤ä½“è½¬å½•ç»„æµ‹åºå’Œå…³è”åˆ†æ</strong></font>ã€‚ç»“æœå‘ç°åœ¨é•¿æœŸ<strong>é©¯åŒ–</strong>è¿‡ç¨‹ä¸­ï¼Œæ²¹èŒ¶æœå®é€æ¸<strong>å¢å¤§</strong>ï¼Œç§ä»æ²¹è„‚å«é‡æ˜¾è‘—<strong>æé«˜</strong>ï¼Œæ²¹è„‚å“è´¨ä¸æ–­<strong>ä¼˜åŒ–</strong>ï¼Œå½¢æˆäº†ç›®å‰ä¸»æ ½çš„æœå¤§ã€å«æ²¹ç‡é«˜ã€æ²¹è„‚å“è´¨ä¼˜è‰¯çš„æ ½åŸ¹ç±»å‹ã€‚</p><p>è¿›ä¸€æ­¥åˆ†æå‘ç°é©¯åŒ–è¿‡ç¨‹ä¸­ï¼Œæ²¹èŒ¶åŸºå› ç»„ä¸­<font color="red"><strong>æ²¹è„‚ä»£è°¢é€šè·¯</strong>ä¸­çš„å¤šä¸ª<strong>åŸºå› </strong>å—åˆ°äº†<strong>æ˜¾è‘—çš„äººå·¥é€‰æ‹©</strong></font>ã€‚æ­¤å¤–ï¼Œ<font color="red">èƒè¿«åº”ç­”ã€æ¿€ç´ ç”Ÿç‰©åˆæˆ</font>ç­‰é€šè·¯ä¹Ÿå—åˆ°æ˜¾è‘—é€‰æ‹©ã€‚</p><p>ä¸ºäº†æŒ–æ˜é«˜åº¦å¯ä¿¡çš„æ²¹è„‚ä»£è°¢å…³é”®åŸºå› ï¼Œè”åˆé‡‡ç”¨<font color="red"><strong>åŸºå› ç»„é—ä¼ å˜å¼‚ã€åŸºå› è¡¨è¾¾æ°´å¹³å’Œè¡¨å‹æ€§çŠ¶å˜å¼‚å…³è”åˆ†æ</strong></font>ã€‚ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œåœ¨<font color="red">ç­›é€‰å‡ºçš„<strong>21ä¸ªå€™é€‰</strong>åŸºå› </font>ä¸­ï¼Œæœ‰<font color="red"><strong>14ä¸ª</strong></font>å±äºæ²¹è„‚åˆæˆå’Œåˆ†è§£ä»£è°¢é€šè·¯åŸºå› ã€‚</p><p><img src="/GeekFocus/2022-03-14-HiFi-6-HiC-assembly/4.png"><br><img src="/GeekFocus/img/2022-03-14-HiFi-6-HiC-assembly/4.png" alt="æ²¹èŒ¶å“ç§ç¾¤ä½“å…³è”åˆ†æå‘æ˜æ²¹è„‚äº§é‡ä¸å“è´¨çš„è°ƒæ§åŸºå› "></p><p>å…¶ä¸­ï¼Œæ²¹è„‚ä»£è°¢é€šè·¯ä¸­çš„8ä¸ªåŸºå› å’Œæ¤ç‰©æ¿€ç´ ç›¸å…³è½¬å½•å› å­IAA26åœ¨é•¿æœŸ<strong>æ ½åŸ¹é©¯åŒ–</strong>è¿‡ç¨‹ä¸­<strong>å½¢æˆ</strong><font color="red"><strong>æ˜¾è‘—</strong>çš„<strong>å•æ ¸è‹·é…¸å¤šæ€æ€§</strong>å’Œ<strong>è¡¨è¾¾æ°´å¹³å·®å¼‚</strong></font>ã€‚â€œè¿™8ä¸ªåŸºå› æ—¢åŒ…æ‹¬<font color="red">æ²¹è„‚åˆæˆ</font>åŸºå› ï¼Œä¹Ÿæœ‰<font color="red">æ²¹è„‚åˆ†è§£ä»£è°¢</font>åŸºå› ï¼Œè¿™è¡¨æ˜æ²¹èŒ¶<font color="red"><strong>æ²¹è„‚æ€§çŠ¶</strong></font>æ˜¯ç”±å‚ä¸åˆæˆå’Œåˆ†è§£çš„<font color="red"><strong>ä¸¤ç±»åŸºå› ååŒè°ƒæ§</strong></font>çš„ç»“æœã€‚</p><h2 id="Genome-sequencing-de-novo-assembly-and-annotation"><a href="#Genome-sequencing-de-novo-assembly-and-annotation" class="headerlink" title="Genome sequencing, de novo assembly, and annotation"></a>Genome sequencing, de novo assembly, and annotation</h2><p>The genomic DNA of CON was prepared by using the young <strong>leaves</strong>. Ten 20 kb de novo SMRTbell libraries were constructed according to the standard manufacturerâ€™s protocol and used for <font color="red">SMRT PacBio</font> genome sequencing. A total of 27,876,348 reads (total size of <strong>320 G</strong>) were generated and used for initial assembly by the <font color="red"><strong>Falcon</strong></font> (v0.3.0) pipeline. The <font color="red"><strong>HaploMerger2</strong></font> (v20180603) program (default parameters) was used to <strong>reduce the redundancy</strong>, and <font color="red"><strong>Arrow program</strong></font> with default parameters was used to <strong>correct</strong> the sequencing <strong>errors</strong>. Further, a total of <font color="red">210 G</font> clean data generated by the <strong>Illumina</strong> Nova- Seq6000 platform was used to <font color="red">correct</font> the PacBio reads.</p><p>To circumvent the high heterozygosity of the CON genome, a <font color="red"><strong>hybrid assembly of strategy</strong></font> was used to construct the high-quality reference genome. The details of the <font color="red"><strong>BioNano, 10X Genomics, and Hi-C</strong></font> sequencing procedures were described in the Additional File 3: Method S1; and the hybrid assembly approach was described in <strong>Additional File 2</strong>: Fig. S3. Finally, to construct a chromosome-scale reference genome, the Hi-C chromosomal interaction was created using HiC-pro [38] software (v2.5.0) (<strong>Additional File 2</strong>: Fig. S4). </p><p>The <font color="red">repetitive elements</font> in the CON genome, including tandem repeats and interspersed repeats, were identified. Tandem repeats were discovered by <font color="red"><strong>Tandem Repeats Finder</strong></font> v4.07b. Interspersed repeats in the genome were identified using an integration of <strong>independent homology searching and de novo predictions</strong> (See details in Additional File 3: Method S2). Non-coding RNA genes (ncRNA) were annotated in this study (see details in Additional File 3: Method S2) and the results were shown in Additional File 1: Table S4.</p><p>We <font color="red">annotated</font> the assembled genome through combining three different approaches: <font color="red"><strong>ab initio prediction, homology-based prediction,</strong> and <strong>transcriptome alignment</strong></font>. To ob- tain the transcriptome data, the total RNA of seven different tissues from CON was se- quenced using the Illumina NovaSeq platform. The transcripts homolog prediction was performed initially by MAKER (v2.31.10); Augustus (v3.3.1) and SNAP (v2006-07-28) were used for de novo prediction. Finally, both homolog and de novo prediction results were integrated using MAKER and resulted in the final gene models (Additional File 1: Table S5; see details in Additional File 3: Method S2)</p><p><font color="red"><strong>Functional annotation</strong></font> was achieved by comparing predicted proteins against public databases, including NCBI non-redundant protein sequences database (Nr), SwissProt (201709) [39], eggNOG [39], KEGG (v84) [40], Interpro (v5.16-55.0) [41], and GO [42] using Blast (v2.2.3) [43].</p><p><img src="/GeekFocus/2022-03-14-HiFi-6-HiC-assembly/5.png" alt="5"><br><img src="/GeekFocus/img/2022-03-14-HiFi-6-HiC-assembly/5.png" alt="5"></p><p>PacBio+illumina : Falcon+Arrow+BWA+Pilon+HaploMerger-&gt;contigs</p><p>scaffold+HiC : <font color="red"><strong>JUICER+3D-DNA</strong></font></p><h1 id="10-2022-01-HorticRes-ç”˜èŠ"><a href="#10-2022-01-HorticRes-ç”˜èŠ" class="headerlink" title="10. 2022.01-HorticRes ç”˜èŠ"></a>10. 2022.01-HorticRes ç”˜èŠ</h1><p><strong>The</strong> <em><strong>chrysanthemum lavandulifolium</strong></em> <strong>genome and the molecular mechanism underlying diverse capitulum types</strong></p><p><strong>èŠèŠ±</strong>(<em>Chrysanthemum Ã—morifolium</em> Ramat.)æ˜¯ä¸–ç•Œè‘—åçš„è§‚èµæ¤ç‰©ï¼Œå…·æœ‰åƒå§¿ç™¾æ€çš„èŠ±å‹ã€‚å®é™…èŠèŠ±çš„èŠ±æ˜¯æŒ‡ç”±<font color="red"><strong>å¤–å›´çš„èˆŒçŠ¶èŠ±</strong></font>å’Œ<font color="red"><strong>ç›˜å¿ƒçš„ç®¡çŠ¶èŠ±</strong></font>å…±åŒæ„æˆçš„<font color="red"><strong>å¤´çŠ¶èŠ±åº</strong></font>ã€‚å…¶èŠ±å‹ç”±å¤´çŠ¶èŠ±åºä¸ŠèˆŒçŠ¶èŠ±å’Œç®¡çŠ¶èŠ±çš„å½¢æ€å’Œç›¸å¯¹æ•°é‡å†³å®šã€‚è§£æåŒä¸€å¤´çŠ¶èŠ±åºä¸ŠèˆŒçŠ¶èŠ±å’Œç®¡çŠ¶èŠ±åˆ†åŒ–çš„åˆ†å­è°ƒæ§æœºåˆ¶ä¸ä»…å¯ä»¥ä¸ºé˜æ˜èŠèŠ±å¤æ‚çš„å¤´çŠ¶èŠ±åºå½¢æ€å¥ å®šåŸºç¡€ï¼Œä¹Ÿå°†ä¸ºèŠç§‘æ¤ç‰©å¤´çŠ¶èŠ±åºå‘è‚²æä¾›æ–°è§è§£ã€‚ä½†ç›®å‰å…³äºèŠèŠ±èŠ±å‹çš„ç ”ç©¶å—åˆ°å…¶å¤æ‚é—ä¼ èƒŒæ™¯çš„é™åˆ¶ï¼Œå¯¼è‡´æ— æ³•å……åˆ†åˆ©ç”¨èŠèŠ±ä¸°å¯Œçš„åŸºå› èµ„æºè¿›è¡ŒèŠ±å‹å®šå‘è‚²ç§ã€‚å› æ­¤ï¼Œè·å¾—é«˜è´¨é‡çš„èŠèŠ±åŠå…¶è¿‘ç¼˜ç§çš„åŸºå› ç»„ä¿¡æ¯å¹¶åœ¨æ­¤åŸºç¡€ä¸Š<font color="red">ç ”ç©¶<strong>å¤´çŠ¶èŠ±åºå‘è‚²</strong>çš„<strong>åˆ†å­è°ƒæ§æœºåˆ¶</strong></font>æ˜¾å¾—å°¤ä¸ºå¿…è¦ã€‚</p><p>è¿‘æ—¥ï¼Œ<em><strong>Horticulture Research</strong></em>åœ¨çº¿å‘è¡¨äº†<strong>åŒ—äº¬æ—ä¸šå¤§å­¦æˆ´æ€å…°å›¢é˜Ÿ</strong>é¢˜ä¸º<em><strong>The Chrysanthemum lavandulifolium genome and the molecular mechanism underlying diverse capitulum types</strong></em> çš„ç ”ç©¶è®ºæ–‡ã€‚è¯¥è®ºæ–‡å®Œæˆ<font color="red"><strong>èŠèŠ±è¿‘ç¼˜é‡ç”Ÿç§</strong>ä¹‹ä¸€<strong>ç”˜èŠ</strong></font>(C. lavandulifolium)çš„å…¨åŸºå› æµ‹åºå·¥ä½œï¼Œè·å¾—äº†æŸ“è‰²ä½“æ°´å¹³ä¸Šçš„é«˜è´¨é‡ç”˜èŠå‚è€ƒåŸºå› ç»„ï¼Œç»“åˆ<font color="red"><strong>3ç§ä¸åŒç±»å‹èŠç§‘æ¤ç‰©å¤´çŠ¶èŠ±åº</strong>çš„<strong>è½¬å½•ç»„æ•°æ®</strong></font>åˆæ­¥è§£æäº†å¤´çŠ¶èŠ±åºå‘è‚²çš„<strong>åˆ†å­è°ƒæ§æœºåˆ¶</strong>ï¼Œä¸ºå®ç°äººå·¥è°ƒæ§èŠèŠ±èŠ±å‹å¥ å®šäº†åšå®çš„åˆ†å­ç†è®ºåŸºç¡€ã€‚</p><p>ç”˜èŠä¸ºèŠå±æ¤ç‰©ä¸­çš„<strong>äºŒå€ä½“ç‰©ç§</strong>ï¼Œé‡‡ç”¨<strong>Illumina + Pacbio + Hi-C</strong>æµ‹åºæŠ€æœ¯å¯¹å…¶è¿›è¡Œå…¨åŸºå› æµ‹åºï¼Œè·å¾—äº†2.60 Gbçš„æŸ“è‰²ä½“æ°´å¹³çš„å‚è€ƒåŸºå› ç»„ã€‚å…¶ä¸­<font color="red">94.46%çš„åºåˆ—é”šå®šåˆ°<strong>9æ¡æŸ“è‰²ä½“</strong>ä¸Š</font>ã€‚ç”˜èŠåŸºå› ç»„ä¸­é‡å¤åºåˆ—å åŸºå› ç»„çš„67.69%ï¼Œ<em>Cypsy</em>å’Œ<em>Copia</em>çš„å æ¯”åˆ†åˆ«ä¸º37.92%å’Œ29.06%ï¼Œæ’å…¥æ—¶é—´åœ¨1.25ç™¾ä¸‡å¹´å‰ã€‚<font color="red"><strong>æ¯”è¾ƒåŸºå› ç»„åˆ†æ</strong></font>ç»“æœè¡¨æ˜ï¼Œç”˜èŠç»å†äº†<font color="red"><strong>ä¸¤æ¬¡å…¨åŸºå› ç»„å¤åˆ¶(WGD)äº‹ä»¶</strong></font>ï¼Œå…¶ä¸­<font color="red"><strong>æœ€è¿‘ä¸€æ¬¡</strong>æ˜¯æ‰€æœ‰<strong>èŠç§‘æ¤ç‰©å…±æœ‰</strong></font>ï¼Œè€Œ<font color="red"><strong>è¾ƒæ—©ä¸€æ¬¡</strong>æ˜¯æ ¸å¿ƒåŒå­å¶æ¤ç‰©å…±æœ‰çš„<strong>Î³äº‹ä»¶</strong></font>ï¼Œ**ç”˜èŠè‡ªèº«æ²¡æœ‰å‘ç”ŸWGDï¼Œå…¶åŸºå› ç»„æ¼”åŒ–çš„åŠ¨åŠ›æ¥æºä¸»è¦æ˜¯<font color="red">ä¸²è”é‡å¤äº‹ä»¶</font>**ã€‚</p><p><img src="/GeekFocus/2022-03-14-HiFi-6-HiC-assembly/6.png"><br><img src="/GeekFocus/img/2022-03-14-HiFi-6-HiC-assembly/6.png" alt="overview and genome evolution"></p><p>åŸºäº<font color="blue">ç”˜èŠå¤´çŠ¶èŠ±åºå‘è‚²çš„6ä¸ªé‡è¦æ—¶æœŸ</font>å’Œ<font color="blue">å…¶ä»–èŠç§‘æ¤ç‰©ä¸åŒç±»å‹å¤´çŠ¶èŠ±åºå‘è‚²å…³é”®æ—¶æœŸ</font>çš„<font color="red">è½¬å½•ç»„</font>æœ‰å‚åˆ†æå‘ç°ï¼ŒMADS-boxã€TCPã€NACå’ŒLOBåŸºå› å®¶æ—<font color="red">å¯èƒ½å‚ä¸<strong>ç®¡çŠ¶èŠ±å’ŒèˆŒçŠ¶èŠ±çš„åˆ†åŒ–</strong></font>ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<em>NAM</em>å’Œ<em>LOB30</em>é«˜è¡¨è¾¾äºèˆŒç®¡å…¼å¤‡å‹çš„å¤´çŠ¶èŠ±åºä¸­ï¼Œè€Œåœ¨å…¨èˆŒå‹å’Œå…¨ç®¡å‹çš„å¤´çŠ¶èŠ±åºä¸­è¡¨è¾¾é‡ç›¸å¯¹è¾ƒä½ï¼Œè¿™è¡¨æ˜å…¶å¯èƒ½æ˜¯å‚ä¸ä¸¤ç±»å°èŠ±åˆ†åŒ–çš„å…³é”®åŸºå› ã€‚ç»“åˆå…³é”®åŸºå› åœ¨å…¨èˆŒå‹ã€å…¨ç®¡å‹ä»¥åŠèˆŒç®¡å…¼å¤‡å‹çš„å¤´çŠ¶èŠ±åºä¸­çš„è¡¨è¾¾æ¨¡å¼å’Œè›‹ç™½äº’ä½œæ¨¡å¼ï¼Œåˆæ­¥æ¨æµ‹å¹¶æ„å»ºäº†ä¸åŒç±»å‹å¤´çŠ¶èŠ±åºå‘è‚²å¯èƒ½çš„è°ƒæ§æœºåˆ¶ã€‚åœ¨å…¨ç®¡å‹å¤´çŠ¶èŠ±åºä¸­ï¼Œ<em>CUC2</em>ä¸<em>LFY</em>å’Œ<em>AG</em><font color="red"><strong>å…±åŒè°ƒæ§</strong>ç®¡çŠ¶èŠ±åŸåŸºçš„èµ·å§‹</font>ã€‚è€ŒCUC2å’ŒCUC3çš„<font color="red"><strong>äº’ä½œåŠååŒè¡¨è¾¾</strong>åˆ™ä¼š<strong>ä¿ƒè¿›</strong>å…¨èˆŒå‹å¤´çŠ¶èŠ±åºä¸­èˆŒçŠ¶èŠ±åŸåŸºçš„èµ·å§‹</font>ã€‚åœ¨èˆŒç®¡å…¼å¤‡å‹çš„å¤´çŠ¶èŠ±åºä¸­ï¼Œ<em>NAM</em>å’Œ<em>LOB30</em>çš„è¡¨è¾¾åˆ™å‚ä¸<font color="red"><strong>è°ƒæ§</strong>èˆŒçŠ¶èŠ±å’Œç®¡çŠ¶èŠ±åŸåŸºçš„åˆ†åŒ–</font>ã€‚LOB30å¯ä»¥ä¸LFY, TFL1, CUC2, CUC3å’ŒNAMäº’ä½œï¼Œè¡¨æ˜å…¶åœ¨åŸºå› è°ƒæ§ç½‘ç»œä¸­çš„æ ¸å¿ƒä½ç½®ã€‚æ€»ä¹‹ï¼Œ<em>NAM</em>å’Œ<em>LOB</em>ä¸ä»…å¯ä»¥ä¸èŠ±åºåˆ†ç”Ÿç»„ç»‡ç›¸å…³åŸºå› å¦‚<em>LFY</em> ç­‰äº’ä½œï¼Œä¹Ÿå¯ä»¥ä¸ä¸¤ç±»å°èŠ±èº«ä»½å†³å®šåŸºå› å¦‚<em>CYC2</em>-<em>LIKE</em>ç­‰åŸºå› äº’ä½œï¼Œè¿™è¡¨æ˜<em><strong>NAM</strong></em><strong>å’ŒLOB30åœ¨å¤´çŠ¶èŠ±åºä¸ŠèˆŒçŠ¶èŠ±å’Œç®¡çŠ¶èŠ±åŸåŸºåˆ†åŒ–è°ƒæ§ä¸­çš„å…³é”®è§’è‰²</strong>ã€‚</p><p><img src="/GeekFocus/2022-03-14-HiFi-6-HiC-assembly/7.png"><br><img src="/GeekFocus/img/2022-03-14-HiFi-6-HiC-assembly/7.png" alt="The expression patterns of NAM/CUC and LOB30 homologous genes in ten asteraceae species"></p><p><img src="/GeekFocus/2022-03-14-HiFi-6-HiC-assembly/8.png"><br><img src="/GeekFocus/img/2022-03-14-HiFi-6-HiC-assembly/8.png" alt="the probable gene regulation mechanism in the development of different capitula types"></p><p><strong>é«˜è´¨é‡ç”˜èŠå‚è€ƒåŸºå› ç»„çš„è·å¾—ä¸ä»…å¯ä»¥ä¸ºæ ½åŸ¹èŠèŠ±åŸºå› ç»„çš„ç ´è¯‘æä¾›æœ‰æ•ˆçš„å‚è€ƒï¼Œæ›´ä¸ºè§£æèŠèŠ±ä¹ƒè‡³èŠç§‘æ¤ç‰©å¤šæ ·çš„ç”Ÿç‰©å­¦æ€§çŠ¶æä¾›ä¸°å¯Œçš„åŸºå› èµ„æºã€‚</strong></p><p>åŒ—äº¬æ—ä¸šå¤§å­¦æˆ´æ€å…°è¯¾é¢˜ç»„ä¸€ç›´è‡´åŠ›äºèŠèŠ±ç ”ç©¶ï¼ŒåŸºäº<font color="blue">æ¤ç‰©ç³»ç»Ÿå­¦ç ”ç©¶æ–¹æ³•</font>å¯¹<font color="blue">èŠå±æ¤ç‰©ç§é—´<strong>äº²ç¼˜å…³ç³»</strong>å’ŒèŠèŠ±<strong>å“ç§èµ·æº</strong></font>è¿›è¡Œæ¢ç´¢ï¼Œåœ¨<font color="red"><strong>ç§è´¨èµ„æºè¯„ä»·ï¼ŒèŠ±è‰²ã€èŠ±å‹ã€å¼€èŠ±æœŸ</strong>å’Œ<strong>æŠ—é€†æ€§</strong>ç­‰è§‚èµæ€§çŠ¶å½¢æˆçš„<strong>åˆ†å­æœºç†</strong></font>ï¼ŒèŠèŠ±<font color="blue">ä¼˜å¼‚ç§è´¨åˆ›åˆ¶</font>ä»¥åŠ<font color="blue">äº§ä¸šåŒ–æ ½åŸ¹æŠ€æœ¯</font>ç­‰å¼€å±•å…¨é¢ç ”ç©¶ï¼Œå–å¾—äº†ä¸€ç³»åˆ—é‡è¦çªç ´æ€§è¿›å±•å’Œç ”ç©¶æˆæœã€‚</p><p>2.6Gï¼šscaffold Num 178ï¼›scaN50 300Mï¼›N90 212Mï¼›Longest 322M</p><h2 id="Genome-assembly-and-quality-assessment"><a href="#Genome-assembly-and-quality-assessment" class="headerlink" title="Genome assembly and quality assessment"></a><strong>Genome assembly and quality assessment</strong></h2><p>For the <font color="blue">PacBio RSII</font> platform data, <font color="blue">longer subreads were <strong>selected</strong></font> by the <font color="blue">error correction module</font> of <font color="red"><strong>canu v1.5</strong></font> [35]. <font color="blue">Raw overlapping subreads were <strong>detected</strong></font> through the highly sensitive overlap detection program <font color="red"><strong>MHAP v2.1</strong></font> [36], and the <font color="blue">error correction of these data was <strong>carried</strong></font> out by the <font color="red"><strong>Falcon</strong></font> sense method v0.40 (â€œcorrect- edErrorRate &#x3D; 0.025â€) [37]. The error-corrected subreads were used to <font color="blue">generate a <strong>draft assembly</strong></font> in <font color="red"><strong>WTDBG v2.5</strong></font> (<a href="https://github.com/ruanjue/wtdbg">https://github.com/ruanjue/wtdbg</a>). <font color="blue"><strong>Iterative polishing</strong></font> by <font color="red"><strong>Pilon v1.22</strong></font> [38] was achieved by <font color="blue"><strong>aligning</strong></font> adapter-trimmed and paired-end <font color="blue">Illumina <strong>reads</strong> to the <strong>PacBio draft genome</strong></font>. <font color="red"><strong>Clean nanopore data</strong></font> were acquired via sequencing on the PromethION platform, and these data were <font color="blue">corrected with the same method</font> described above. The draft genome assembled by <font color="red"><strong>WTDBG v2.5</strong></font> (https:&#x2F;&#x2F; github.com&#x2F;ruanjue&#x2F;wtdbg) was <font color="blue"><strong>corrected</strong> three times</font> by <font color="red"><strong>Racon v1.3.3</strong></font> [39] by aligning adapter-trimmed and paired-end Illumina reads to the <font color="blue"><strong>Nanopore draft genome</strong></font>. Then, the <font color="blue">PacBio draft genome as a <strong>query input</strong></font> was <font color="blue"><strong>aligned against</strong> the <strong>Nanopore draft genome</strong></font> using <font color="red"><strong>MUMmer v4.0.0</strong></font> [40]. The PacBio draft genome and Nanopore <font color="blue"><strong>draft genome</strong></font> were then <font color="blue"><strong>merged</strong></font> using <font color="red"><strong>quickmerge v0.3.0</strong></font> [21]. This <font color="blue"><strong>merged draft genome</strong></font> was <font color="blue"><strong>polished</strong></font> by <font color="red"><strong>Racon v1.3.3</strong></font> [39] and <font color="red"><strong>Pilon v1.22</strong></font> [38]. The <font color="blue">mapping depth</font> was obtained by <font color="blue"><strong>aligning</strong> corrected Nanopore sequencing data</font> to the merged assembly by <font color="red"><strong>minimap2 v2.17</strong></font> [41] with default parameters. Then, <font color="red"><strong>purge haplotigs v1.0.4</strong></font> [22] was used to <font color="blue"><strong>eliminate</strong> redundancy according to the <strong>coverage depth</strong></font> and obtain the <font color="blue"><strong>purged haplotig genome</strong></font>. Ultimately, a <em>C. lavandulifolium</em> genome with a total length of <strong>3.10 G</strong>b was obtained. The second-generation sequencing data, core gene completeness and BUSCOs were evaluated to verify the accuracy of the genome assembly.</p><h2 id="Hi-C-sequencing-and-assistant-assembly"><a href="#Hi-C-sequencing-and-assistant-assembly" class="headerlink" title="Hi-C sequencing and assistant assembly"></a><strong>Hi-C sequencing and assistant assembly</strong></h2><p>Hi-C is a technology derived from chromosome conformation capture technology that utilizes high- throughput sequencing data and is mainly used to assist in genome assembly. We constructed Hi-C fragment libraries with insert sizes of 300â€“700 bp, as illustrated in Rao et al. [42], and sequenced them using the Illumina platform [42]. <font color="blue"><strong>Before</strong> <strong>chromosome assembly</strong>, we first performed a <strong>preassembly</strong> for the <strong>error correction of scaffolds</strong>, which required <strong>splitting the scaffolds into segments of 50 kb</strong>, on average</font>. Then, the Hi-C data were <font color="blue">mapped</font> to these segments using <font color="red"><strong>BWA</strong></font> aligner v0.7.10-r789 [43]. We <font color="red"><strong>retained</strong> the <strong>uniquely mapped</strong> data</font> to assemble the genome using <font color="red"><strong>LACHESIS</strong></font> [44] with the following <font color="green"><strong>parameters</strong>: CLUSTER_MIN_RE_SITES &#x3D; 80; CLUSTER_MAX_LINK_DENSITY &#x3D; 2; CLUSTER_NONINFORMATIVE_RATIO &#x3D; 2; ORDER_MIN_N_RES_IN_TRUN &#x3D; 16; ORDER_MIN_N_RES_IN_SHREDS &#x3D; 16</font>. To further address the redundant sequences, we manually checked any two segments that showed inconsistent connections with the raw scaffold. The detailed workflow schema for the assembly pipeline of the chromosome-scale <em>C. lavandulifolium</em> genome is shown in Supplementary Figure 24.</p><p><img src="/GeekFocus/2022-03-14-HiFi-6-HiC-assembly/9.png" alt="9"><br><img src="/GeekFocus/img/2022-03-14-HiFi-6-HiC-assembly/9.png" alt="9"></p><h1 id="11-2022-01-HorticRes-ç²‰è‘›"><a href="#11-2022-01-HorticRes-ç²‰è‘›" class="headerlink" title="11. 2022.01-HorticRes ç²‰è‘›"></a>11. 2022.01-HorticRes ç²‰è‘›</h1><p><em><strong>Chromosomal-level genome and multi-omics dataset of Pueraria lobata var. thomsonii provide new insights into legume family and the isoflavone and puerarin biosynthesis pathways</strong></em> </p><p>ç²‰è‘›åŸºå› ç»„åŠå¤šç»„å­¦åˆ†æä¸º<font color="red">è‘›æ ¹ç´ </font>ç­‰åŠŸæ•ˆæˆåˆ†çš„ç”Ÿç‰©åˆæˆç ”ç©¶æä¾›æ–°è§è§£</p><p>å¹¿è¥¿å£®æ—è‡ªæ²»åŒºå†œä¸šç§‘å­¦é™¢ç»æµä½œç‰©ç ”ç©¶æ‰€ä¸¥åå…µå›¢é˜Ÿã€‚è¯¥ç ”ç©¶åˆ©ç”¨<strong>PacBio</strong>ã€<strong>Illumina</strong>æµ‹åºä»¥åŠ<strong>Hi-C</strong>æŠ€æœ¯æµ‹åºç»„è£…ï¼Œ<strong>è·å¾—äº†é¦–ä¸ª<font color="red">è±†ç§‘è‘›å±è¯é£ŸåŒæºæ¤ç‰©ç²‰è‘›</font>æŸ“è‰²ä½“çº§åˆ«çš„åŸºå› ç»„</strong>ï¼Œæ ‡å¿—ç€ç²‰è‘›ç ”ç©¶è¿ˆå…¥åŸºå› ç»„æ—¶ä»£ï¼Œå¼€å¯äº†<font color="blue">è‘›å±<strong>è¿›åŒ–</strong>ã€é‡è‘›<strong>é©¯åŒ–</strong>ã€ç²‰è‘›<strong>å“ç§æ”¹è‰¯</strong></font>ä¹‹æ—…ï¼ŒåŠ©åŠ›å¹¿è¥¿ç‰¹è‰²ä¼˜åŠ¿ç²‰è‘›äº§ä¸šé«˜è´¨é‡å‘å±•ã€‚</p><p>é‰´äºç²‰è‘›<font color="blue">æ‚åˆåº¦è¾ƒé«˜</font>ï¼Œç ”ç©¶è€…é€‰ç”¨äº†PacBioå’ŒHi-Cæµ‹åºï¼Œæ„å»ºçš„ç²‰è‘›åŸºå› ç»„å¤§å°ä¸º<strong>1.38Gb</strong>ï¼Œ<font color="blue">Contig N50&#x3D;598kb</font>ï¼Œå¹¶å°†<font color="blue">99.3%çš„åºåˆ—<strong>é”šå®š</strong>åˆ°11æ¡æŸ“è‰²ä½“ä¸Š</font>ï¼ŒBUSCOè¯„ä¼°<font color="blue">92.9%</font>ã€‚é€šè¿‡æ³¨é‡Šï¼Œå…±è·å¾—45270ä¸ªè›‹ç™½ç¼–ç åŸºå› ï¼Œå…¶ä¸­<font color="blue"><strong>94.4%çš„åŸºå› </strong>å¯ä»¥å¾—åˆ°<strong>åŠŸèƒ½æ³¨é‡Š</strong></font>ï¼ŒåŸºå› ç»„ä¸­<font color="blue">é‡å¤åºåˆ—</font>å æ¯”ä¸º62.7%ã€‚å°†ç²‰è‘›<font color="red">ä¸<strong>16ä¸ªè¿‘ç¼˜ç‰©ç§</strong>(åŒ…å«5ä¸ªè±†ç§‘æ¤ç‰©)è¿›è¡Œ<strong>æ¯”è¾ƒåŸºå› ç»„</strong>åˆ†æ</font>ï¼Œç»“æœè¡¨æ˜6ä¸ªè±†ç§‘æ¤ç‰©å…±æœ‰åŸºå› å®¶æ—ä¸º11204ä¸ªï¼Œç²‰è‘›åŸºå› ç»„ä¸­<font color="blue"><strong>æ˜¾è‘—æ‰©å¼ çš„4743ä¸ªåŸºå› å®¶æ—</strong>ä¸»è¦å¯Œé›†åœ¨ä¸<strong>ç±»é»„é…®ã€ç”Ÿç‰©ç¢±ã€ç”¾é†‡å’Œèœç±»</strong>ç­‰ç”Ÿç‰©åˆæˆç›¸å…³çš„é€šè·¯</font>ï¼›ç²‰è‘›<font color="red"><strong>ç‰¹æœ‰</strong>åŸºå› å®¶æ—</font>ä¸º2373ä¸ªï¼Œä¸»è¦<font color="blue">å¯Œé›†åœ¨ä¸<strong>èœç±»</strong>ç”Ÿç‰©åˆæˆç›¸å…³çš„é€šè·¯</font>ï¼›ç²‰è‘›åŸºå› ç»„ä¸­å—åˆ°<font color="blue"><strong>æ˜¾è‘—æ­£é€‰æ‹©</strong>çš„åŸºå› </font>å…±æœ‰34ä¸ªï¼Œå¯Œé›†åœ¨<font color="blue"><strong>æ˜¼å¤œèŠ‚å¾‹ã€åŒæºé‡ç»„ã€æ·€ç²‰ä»£è°¢å’Œè”—ç³–ä»£è°¢</strong></font>ç­‰é€”å¾„ã€‚</p><p><font color="red"><strong>ç³»ç»Ÿè¿›åŒ–åˆ†æ</strong></font>è¡¨æ˜ï¼Œç²‰è‘›<strong>ä¸å¤§è±†äº²ç¼˜å…³ç³»æœ€è¿‘</strong>ï¼Œä¸¤è€…åœ¨20.1ä¸ªç™¾ä¸‡å¹´å‰äº§ç”Ÿåˆ†åŒ–ã€‚é€šè¿‡<font color="red"><strong>Ks</strong>å’Œ<strong>4DTVåˆ†æ</strong></font>ï¼Œ<strong>ç²‰è‘›å…±ç»å†ä¸¤æ¬¡WGDäº‹ä»¶</strong>ï¼Œä¸€æ¬¡WGDäº‹ä»¶æ˜¯<font color="blue">å¤§è±†ä¸ç²‰è‘›<strong>å…±æœ‰</strong></font>ï¼Œå‘ç”Ÿåœ¨44.5ä¸ªç™¾ä¸‡å¹´å‰ï¼›å¦ä¸€æ¬¡WGDäº‹ä»¶æ˜¯åœ¨ç²‰è‘›ä¸å¤§è±†åˆ†åŒ–åï¼Œ<font color="blue">ç²‰è‘›<strong>ç‹¬è‡ª</strong>ç»å†</font>ï¼Œå‘ç”Ÿæ—¶é—´å¤§è‡´åœ¨4.8ä¸ªç™¾ä¸‡å¹´å‰ã€‚</p><p>é€šè¿‡å¯¹é«˜è‘›æ ¹ç´ ZG-19å’Œä½è‘›æ ¹ç´ ZG-39è¿›è¡Œ<font color="red"><strong>è½¬å½•ç»„</strong>å’Œ<strong>ä»£è°¢ç»„</strong>åˆ†æ</font>ï¼Œç ”ç©¶è€…æ£€æµ‹åˆ°äº†614ç§225ç§å·®å¼‚ä»£è°¢ç‰©(DMs)ï¼Œ1814ä¸ªå·®å¼‚è¡¨è¾¾åŸºå› (DEG)ï¼ŒDMså’ŒDEGçš„ä¸°å¯ŒåŠŸèƒ½ç±»åˆ«<strong>é‡å </strong>ï¼Œè¿™è¯´æ˜å®ƒä»¬éƒ½æ˜¯ä¸<font color="blue">ç±»é»„é…®ã€å¼‚é»„é…®å’ŒABCè½¬è¿ç›¸å…³çš„åŸºå› æˆ–ä»£è°¢ç‰©</font>ã€‚è¿›ä¸€æ­¥åˆ†æä»£è°¢ç‰©ä¸åŸºå› è¡¨è¾¾çš„ç›¸å…³ç³»æ•°ï¼Œç»“æœè¡¨æ˜ä»£è°¢ç‰©å’ŒåŸºå› å¯¹åœ¨æ ·æœ¬ä¸­é«˜åº¦ç›¸å…³ï¼Œ60%çš„æ˜¾è‘—ç›¸å…³æ€§æ¶‰åŠä¸Šè°ƒçš„ä»£è°¢ç‰©å’Œä¸‹è°ƒæˆ–ä¸å˜çš„åŸºå› ï¼Œåœ¨15%çš„æ˜¾è‘—ç›¸å…³æ€§ä¸­ï¼Œä»£è°¢ç‰©å’ŒåŸºå› è¡¨è¾¾çš„å˜åŒ–æ–¹å‘ç›¸åŒã€‚æ­¤å¤–ï¼Œç ”ç©¶è€…åœ¨å¼‚é»„é…®ç”Ÿç‰©åˆæˆé€”å¾„ä¸­å‘ç°äº†å¤§é‡çš„DMså’ŒDEGã€‚<strong>è¿™å……åˆ†è§£æäº†ç²‰è‘›ä¸­å¼‚é»„é…®çš„ç”Ÿç‰©åˆæˆé€”å¾„ã€‚</strong></p><p>é€šè¿‡<font color="red"><strong>åŒæºåŸºå› æœç´¢</strong></font>ï¼Œç ”ç©¶è€…å‘ç°<font color="blue">ç¼–ç <strong>è‘›æ ¹ç´ åˆæˆé€”å¾„</strong>ä¸­å…³é”®é…¶çš„9ä¸ªåŸºå› å®¶æ—</font>åœ¨ç²‰è‘›ä¸­éƒ½æœ‰æ‰€<font color="blue">æ‰©å¼ </font>ï¼›é€šè¿‡åˆ†æç³–åŸºè½¬ç§»é…¶å®¶æ—ä¸­å‚¬åŒ–ç³–åŸºåŒ–ä¿®é¥°çš„åŸºå› ï¼Œå…±é‰´å®šå‡º104ä¸ªGTåŸºå› ï¼Œæœ‰13ä¸ªåŸºå› ä¸8-C-è‘¡è„ç³–åŸºè½¬ç§»é…¶(8-C-GT)åŒæºï¼Œå…¶ä¸­6ä¸ªä¸å…ˆå‰ç ”ç©¶çš„å‚¬åŒ–å¤§è±†è‹·å…ƒC-ç³–åŸºåŒ–ä¸ºè‘›æ ¹ç´ çš„PIUGT43åŸºå› åŒæºï¼›ç¼–ç å¤§è±†å¼‚é»„é…®åˆé…¶(IFS)çš„åŸºå› (CHR11G3854.1)å‚¬åŒ–ç€è‘›æ ¹ç´ åˆæˆçš„ä¸­é—´ä»£è°¢ç‰©å¤§è±†è‹·å…ƒçš„åˆæˆï¼Œè¢«é‰´å®šä¸ºä¸è‘›æ ¹ç´ çš„åˆæˆé€”å¾„é«˜åº¦ç›¸å…³ã€‚æ€»ä¹‹ï¼Œä¸Šè¿°åˆ†æ<strong>åˆæ­¥è§£æäº†ç²‰è‘›ä¸­è‘›æ ¹ç´ çš„ç”Ÿç‰©åˆæˆé€”å¾„ã€‚</strong></p><p><strong>ç»¼ä¸Šï¼Œè¯¥ç ”ç©¶é€šè¿‡æ„å»ºé«˜è´¨é‡çš„ç²‰è‘›åŸºå› ç»„è§£æäº†ç²‰è‘›åŸºå› ç»„çš„<font color="red">è¿›åŒ–ç‰¹å¾</font>ï¼›é€šè¿‡å¤šç»„å­¦åˆ†ææ·±å…¥è§£æäº†ç²‰è‘›ä¸­<font color="red">é‡è¦æ¬¡ç”Ÿä»£è°¢ç‰©å¼‚é»„é…®ã€è‘›æ ¹ç´ ç­‰ç”Ÿç‰©åˆæˆé€”å¾„</font>ï¼Œä»è€Œä¸ºç²‰è‘›çš„èµ„æºåˆ©ç”¨ã€é—ä¼ è‚²ç§ç­‰ç ”ç©¶æä¾›äº†æ–°è§è§£ã€‚</strong></p><p><strong>ä¸¥åå…µç ”ç©¶å‘˜å›¢é˜Ÿåœ¨è‘›æ ¹ä¸Šçš„ç ”ç©¶è¿›å±•ï¼š</strong></p><p><strong>ä¸¥åå…µ</strong>å›¢é˜Ÿè¿‘å¹´<strong>åœ¨å…¨çƒè‘›æ ¹èµ„æºæ”¶é›†ä¸é‰´å®šè¯„ä»·ã€è‘›å±èµ„æºåˆ†ç±»ã€è‘›æ ¹<font color="red">åŸºå› ç»„ä¸åˆ†å­ç”Ÿç‰©å­¦</font>ã€ç²‰è‘›å’Œé‡è‘›å“ç§é€‰è‚²ã€å¥åº·ç§è‹—ç”Ÿäº§ã€é«˜äº§é«˜æ•ˆæ ½åŸ¹ç­‰æ–¹é¢å–å¾—äº†ä¸€ç³»åˆ—çš„æˆæœ</strong>ã€‚å›¢é˜Ÿç›®å‰å¹¿æ³›æ”¶é›†å…¨çƒè‘›å±ç§è´¨èµ„æº419ä»½ï¼ŒåŒ…æ‹¬é‡è‘›ã€ç²‰è‘›ã€è‘›éº»å§†ã€å¤§èŠ±è‘›ã€æ³°è‘›ã€è‹¦è‘›ã€çº¢è‘›ã€é¡»å¼¥è‘›ã€é£Ÿç”¨è‘›ç­‰ï¼›é€šè¿‡å¼€å‘<strong>è‘›SSRåˆ†å­æ ‡è®°</strong>ï¼Œæ„å»ºäº†å¹¿è¥¿è‘›æ ¸å¿ƒç§è´¨åº“ï¼›é€šè¿‡<strong>å¹¿æ³›é¶å‘ä»£è°¢ç»„</strong>è§£æè‘›å±è‘›ç§é‡è‘›ã€ç²‰è‘›å’Œè‘›éº»å§†ç­‰3ä¸ªå˜ç§å—æ ¹ä¸­å½±å“<strong>é£Ÿç”¨å“è´¨å’Œè¯ç”¨å“è´¨</strong>çš„<strong>ä»£è°¢å·®å¼‚</strong>ï¼›ç»“åˆè¡¨å‹é‰´å®šé€šè¿‡å¶ç»¿ä½“åŸºå› ç»„ç ”ç©¶ï¼Œæ­ç¤ºäº†è‘›åŠå…¶<strong>è¿‘ç¼˜ç§ä¹‹é—´çš„ç³»ç»Ÿå‘è‚²å…³ç³»</strong>ï¼›æŒ–æ˜äº†è°ƒæ§<strong>è‘›æ ¹ç´ åˆæˆä»£è°¢ç›¸å…³çš„ç»“æ„åŸºå› å’Œè½¬å½•å› å­</strong>ï¼Œå¹¶æ­£åœ¨å¼€å±•ç›¸å…³åŸºå› åŠŸèƒ½éªŒè¯å·¥ä½œï¼›é€‰è‚²å‡ºé€‚åˆå¼€å‘è‘›èŠ±èŒ¶ã€é«˜è‘›æ ¹ç´ ç²‰è‘›ã€æ— æ¸£ç²‰è‘›ã€è¯ç”¨é‡è‘›ç­‰ç³»åˆ—è‘›æ ¹æ–°å“ç§ï¼Œå¹¶é€æ­¥å»ºç«‹é…å¥—ç§è‹—ç¹è‚²å’Œé«˜æ•ˆæ ½åŸ¹æŠ€æœ¯ã€‚</p><p>1.37Gï¼šcontig Num 5145ï¼›conN50 593kbï¼›</p><h2 id="Genome-survey"><a href="#Genome-survey" class="headerlink" title="Genome survey"></a>Genome survey</h2><p>Short reads produced by the Illumina 6000 platform were <font color="blue">quality-filtered</font> by <font color="red"><strong>HTQC</strong></font> [23] (version v1.92.310) using the following method. Adaptors were firstly removed from the sequencing reads, and read pairs with any one end having an average quality &lt;20 were discarded. Ends of reads were trimmed if average quality was &lt;20 in the sliding window size of 5 bp, and read pairs with <font color="red">any end <strong>shorter than 75 bp</strong> were removed</font>. The quality-filtered reads were used for estimation of genome size. The <strong>17-mer</strong> occurrence distribution of sequencing reads was generated from short libraries with <font color="red"><strong>Jellyfish</strong></font> [24] (v2).</p><h2 id="Genome-assembly"><a href="#Genome-assembly" class="headerlink" title="Genome assembly"></a>Genome assembly</h2><p>Subreads generated with the above long-read third-generation sequencing were used for genome assembly of <em>P. lobata</em>. The draft assembly of the genome was made using <font color="red"><strong>Falcon (v0.3.0)</strong></font> [25]. To <font color="blue"><strong>correct</strong> errors</font> in the primary assembly, <font color="red"><strong>Racon</strong></font> (v1.44) tools were used to <font color="blue"><strong>polish</strong></font> the genome [26]. <font color="blue">Illumina-derived <strong>short reads</strong></font> were used to <font color="blue"><strong>correct</strong></font> any <font color="blue"><strong>remaining errors</strong></font> by <font color="red"><strong>NextPolish (v1.1.0)</strong></font> [27].</p><p><font color="blue">To scaffold the contigs</font>, 425 011 698 clean-read pairs were sequenced from the Hi-C library. <font color="red"><strong>Fastp</strong></font> (0.19.5) [28] was used to filter Hi-C data, including <font color="blue"><strong>removing adaptors</strong> and l<strong>ow-quality</strong> reads</font>. <font color="red"><strong>HiC-Pro</strong></font> Proto was used to obtain effective reads [29]. After filtering, <font color="blue">6%ã€?ã€‘ of high-quality and effective Hi-C data was retained</font>. The <font color="blue">resulting <strong>effective reads</strong></font> were <strong>mapped</strong> to the <strong>assembled and polished</strong> <em>P. thomsonii</em> <strong>genome</strong> using <font color="red"><strong>BWA</strong></font> (bwa-0.7.17) [30] with default parameters. <font color="red"><strong>ALL-HiC</strong></font> software was used to <font color="blue"><strong>anchor</strong> scaffolds to chromosomes</font> to obtain the chromosome-level <em>P. thomsonii</em> assembly.</p><h1 id="12-2022-03-ng-å››å€ä½“åœŸè±†"><a href="#12-2022-03-ng-å››å€ä½“åœŸè±†" class="headerlink" title="12. 2022.03-ng å››å€ä½“åœŸè±†"></a>12. 2022.03-ng å››å€ä½“åœŸè±†</h1><blockquote><p>Chromosome-scale and haplotype-resolved genome assembly of a tetraploid potato cultivar</p></blockquote><p>##<strong>Genome size estimation.</strong> </p><p>After <strong>trimming</strong> off 10Ã— genomics <font color="blue"><strong>barcodes and hexamers</strong></font> from the 370.3-Gb reads combined from the 10Ã— single-cell CNV libraries and single-molecule libraries, <em>k</em>-mer counting (<em>k</em> &#x3D; 21) was performed with <font color="red"><strong>Jellyfish</strong></font> (v.2.2.10). The <em>k</em>-mer histogram was provided to <font color="red"><strong>findGSE</strong></font> (v.1.0)39 to estimate the haploid&#x2F;tetraploid genome size of â€˜Otavaâ€™ under the <font color="blue">heterozygous mode</font> (with â€˜exp_hom &#x3D; 200â€™; Extended Data Fig. 1).</p><p>##<strong>Initial tetraploid genome assembly, polishing and purging.</strong> </p><p>The initial assembly of the tetraploid genome was performed using <font color="red"><strong>hifiasm (v.0.7)</strong></font> with <strong>default settings</strong> with the 102 Gb raw PacBio HiFi reads of â€˜Otavaâ€™, where the output consisting of <font color="red"><strong>unitigs</strong> (locally haplotype-resolved contigs)</font> was selected for <strong>further processing</strong>. </p><p>Then the <font color="blue">short reads</font> from the two 10Ã— single-cell CNV libraries were <font color="blue"><strong>aligned</strong> to the assembly</font> using <font color="red"><strong>bowtie2 (v.2.2.8)</strong></font>. These <font color="blue">alignments were used to <strong>polish</strong> the <strong>assembly</strong></font> with <font color="red"><strong>pilon (v.1.22)</strong></font> with <font color="green"><strong>options</strong> of <strong>â€“fixbases â€“changes â€“diploid â€“mindepth 0.8</strong></font>. </p><p>Further, <font color="blue"><strong>short</strong> reads</font> of the two 10Ã— single-cell CNV libraries, additional 10Ã— single-molecule libraries <strong>and</strong> PacBio <font color="blue"><strong>HiFi</strong> reads</font> were <font color="blue"><strong>all aligned</strong> to the <strong>polished assembly</strong></font> (using <font color="red"><strong>bowtie2</strong></font> and <font color="red"><strong>minimap2</strong></font> (v.2.17-r491) respectively). Among <font color="blue">17,153 raw contigs, <strong>9,041 contigs</strong></font> which were <font color="blue">longer than <strong>50 kb</strong></font> and with an <font color="blue">average sequencing depth over <strong>80Ã—</strong> were <strong>kept</strong></font>. </p><p><font color="blue">HiFi reads were <strong>re-aligned</strong> to the purged assembly and contigs covered less than 3Ã— were <strong>removed</strong></font>. </p><p>The HiFi reads-based <font color="red"><strong>purging process</strong></font> was repeated for <font color="blue"><strong>five rounds</strong></font> to get an initial assembly of <font color="blue">6,366 contigs</font> for subsequent analysis (Supplementary Fig. 1).</p><p>##<strong>Haplotype-specific PacBio HiFi read separation and haplotype assembly.</strong></p><p>HiFi reads were <font color="blue">classified into 48 groups</font> on the basis of alignments to the 50-kb coverage markers using customized code. Specifically, to assign a read to a marker, at least 500 bp of the read had to be aligned to the marker (reads aligning two neighboring markers were assigned to the marker with a larger overlapping size). Reads overlapping non-haplotig marker were randomly assigned to one of the marker-associated groups.</p><p><font color="red"><strong>Each set</strong> of HiFi reads</font> was independently assembled using <font color="red"><strong>hifiasm</strong></font> (v.0.7) with default settings. The resulting contigs were first polished with <font color="red">short reads using <strong>pilon</strong></font> with <font color="green"><strong>â€“fix bases â€“changes â€“diploid â€“mindepth 0.8</strong></font> and then with <font color="red">HiFi reads using <strong>racon</strong></font> (v.1.4.10)46 with<font color="green"> <strong>-u â€“no-trimming</strong></font>.</p><p>##<strong>Evaluation of haplotyping accuracy.</strong> </p><p>For <font color="blue">each haplotype assembly</font> and the sequencing data of the parental genomes, <em>k</em>-mers (<em>k</em> &#x3D; 21) were counted using <font color="red"><strong>KMC</strong></font>. Specifically, <em>k</em>-mers found in â€˜Heraâ€™ but not in â€˜Stieglitzâ€™ (with a coverage<br>of 6â€“12), as well as <em>k</em>-mers found in â€˜Stieglitzâ€™ but not in â€˜Heraâ€™ (with a coverage of 5â€“11) were selected using kmc_tools simple. For each haplotype, the sets of assembled <em>k</em>-mers were intersected with the two sets of parental-specific <em>k</em>-mers (using kmc_tools simple with subfunction intersect), which revealed <strong><em>k</em>-mers common with either of the parental genomes</strong>. </p><p>As a haplotype can only be inherited from one of the parents, it is expected to find parental-specific *k-*mers only of one parent. The overall haplotyping precision was determined as the total number of correctly phased <em>k</em>-mers divided by the total number of <em>k</em>-mers investigated in the <font color="red"><strong>48 haplotype assemblies</strong></font>. Note, this was done <font color="rblueed">before and after contig <strong>polishing</strong></font>, where we observed the same haplotyping accuracy.</p><p>##<strong>Haplotype-specific contig scaffolding using group-specific Hi-C reads.</strong> </p><p><font color="blue">Each haplotype-specific contig-level assembly</font> was indexed with <font color="red"><strong>bwa index</strong></font> (with -a bwtsw) (v.0.7.15-r1140) and <font color="red"><strong>samtools faidx</strong></font>. The haplotype-specific Hi-C read pairs were aligned using <font color="red"><strong>bwa aln</strong> and <strong>bwa sampe</strong></font>. Aligned reads (in pairs) were <strong>converted into BAM</strong> files using samtools view with options of <font color="green">-b -F12</font>. The BAM files were filtered with <font color="red"><strong>filterBAM_forHiC.pl</strong></font> (from ALLHiC package, v.0.9.13) to <font color="blue"><strong>remove nonuniquely mapped reads</strong></font>. Then BAM files were converted to bed files using <font color="red"><strong>bamToBed</strong></font> (from bedtools package) and <font color="blue"><strong>sorted</strong> by read name</font>. The <strong>bed files</strong> were provided to <font color="red"><em><strong>SALSA2</strong></em></font> (run with <font color="green">-s 100000000 -m yes -i 10 -e DNASE</font>). Potential chimeric contigs were broken at the chimeric sites given by SALSA2 output file of input_breaks, leading to a <font color="blue"><strong>new set</strong> of contigs for each of the 48 original groups</font>.</p><p>For <font color="blue">each new group of contigs</font>, the above process of <font color="red"><strong>contig indexing, Hi-C read alignment</strong> and <strong>BAM filtering</strong></font> was repeated. Then, for each haplotype, <font color="red"><strong>ALLHiC_ partition</strong></font> was run with <font color="green">-e GATC -k 1 -m 25</font>; <font color="red"><strong>allhic extract</strong></font> was run with <font color="green">â€“RE GATC</font>; allhic optimize and <font color="red"><strong>ALLHiC_build</strong></font> were run with <font color="green">default settings</font>; the chromosome contact map was visualized with <font color="red"><strong>ALLHiC_plot</strong></font> at <font color="green">1-Mb</font> resolution, where obvious mis-placement&#x2F;orientation of large contigs were visually identified and manually corrected (Extended Data Fig. 3).</p><h1 id="13-2022-03-ng-å…­å€ä½“å°éº¦"><a href="#13-2022-03-ng-å…­å€ä½“å°éº¦" class="headerlink" title="13. 2022.03-ng å…­å€ä½“å°éº¦"></a>13. 2022.03-ng å…­å€ä½“å°éº¦</h1><blockquote><p>Long-read genome sequencing of bread wheat facilitates disease resistance gene cloning</p></blockquote><table><thead><tr><th>Genomic feature</th><th>Value</th></tr></thead><tbody><tr><td><em><strong>Length of HiFi assembly</strong></em></td><td>14.66 Gb</td></tr><tr><td>Number of contigs</td><td>5,055</td></tr><tr><td>Length of contig N50</td><td>30.22 Mb</td></tr><tr><td>Length of contig N90</td><td>5.5 Mb</td></tr><tr><td><strong><em>Length of hybrid assembly</em>a</strong></td><td>14.68 Gb</td></tr><tr><td><em><strong>Length of hybrid scaffolds</strong></em></td><td>14.46 Gb</td></tr><tr><td>Number of hybrid scaffolds</td><td>324</td></tr><tr><td>Length of hybrid scaffold N50</td><td>204.26 Mb</td></tr><tr><td>Gap size</td><td>18.8 Mb (0.13%)</td></tr><tr><td><em><strong>Length of pseudomolecule assembly</strong></em></td><td>14.68 Gb</td></tr><tr><td><em><strong>Total length of anchored pseudomolecules</strong></em></td><td>14.45 Gb</td></tr><tr><td>Number of anchored hybrid scaffolds or contigs</td><td>717</td></tr><tr><td>Gap size</td><td>11.6 Mb (0.08%)</td></tr><tr><td>Number of high-confidence genes</td><td>110,383</td></tr><tr><td><em><strong>Total length of unanchored chromosome</strong></em></td><td>224.01 Mb</td></tr><tr><td>Number of unanchored hybrid scaffolds or contigs</td><td>3,910</td></tr><tr><td>Gap size</td><td>8.1 Mb (3.6%)</td></tr><tr><td>Number of high-confidence genes</td><td>6,455</td></tr><tr><td><em><strong>BUSCO</strong></em></td><td></td></tr><tr><td>Complete</td><td>99.4%</td></tr><tr><td>Duplicated</td><td>96.3%</td></tr><tr><td>Fragmented</td><td>0.1%</td></tr><tr><td>Missing</td><td>0.5%</td></tr></tbody></table><h2 id="Genome-assembly-and-validation"><a href="#Genome-assembly-and-validation" class="headerlink" title="Genome assembly and validation."></a><strong>Genome assembly and validation.</strong></h2><p>The PacBio HiFi reads were assembled using <font color="red"><strong>hifiasm12 (v.0.11)</strong></font> with <font color="green">default parameters</font>. Hybrid scaffolding incorporating the PacBio contigs and the <font color="blue">optical map</font> was performed using the <font color="red"><strong>hybridScaffold pipeline</strong></font> (Bionano Solve 3.6) with default parameters. For the pseudomolecule construction, the Omni-C reads were incorporated using <font color="red"><strong>Juicer tools (v.1.6)</strong></font> and <font color="red"><strong>3D-DNA (v.180114)</strong></font>. </p><p>In brief, the preprocessing of the Omni-C reads was performed with juicer.sh (parameter: -s none). The â€˜merged_nodups.txtâ€™ output file corresponding to the Hi-C contacts with duplicates removed was subsequently used with run-asm-pipeline.sh (parameter: -r 0) as input to produce the â€˜.hicâ€™ and â€˜.assemblyâ€™ files. These files were uploaded into Juicebox (v.1.11.08) to visualize the Hi-C map and for manual curation. </p><p>As a final step, the script <font color="red"><strong>run-asm-pipeline-post-review.sh</strong></font> (default parameters) was used to save the final Hi-C contact map and to output the final Kariega assembly (21 pseudomolecules and 1 unanchored pseudochromosome). To <font color="blue"><strong>validate</strong> the genome assembly</font>, we remapped the optical map onto the pseudomolecule using the <font color="red"><strong>hybridScaffold pipeline</strong></font> (Bionano Solve 3.6), and the final pseudomolecules were compared with the recent bread wheat assemblies of Chinese Spring (IWGSC RefSeq v.2.1) and the assemblies of the 10+ Wheat Genomes Project using <font color="red"><strong>MashMap</strong></font> (v.2.0; parameter: -s 300000â€“pi 98).</p><h1 id="14-2019-10-äºŒå€ä½“å·´ç‰¹åˆ©ç‰¹æ¢¨-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…1ã€‘"><a href="#14-2019-10-äºŒå€ä½“å·´ç‰¹åˆ©ç‰¹æ¢¨-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…1ã€‘" class="headerlink" title="14.  2019.10 äºŒå€ä½“å·´ç‰¹åˆ©ç‰¹æ¢¨ ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…1ã€‘"></a>14.  2019.10 äºŒå€ä½“å·´ç‰¹åˆ©ç‰¹æ¢¨ ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…1ã€‘</h1><blockquote><p>Pseudo-chromosomeâ€“length genome assembly of a double haploid â€œBartlettâ€ pear (<em>Pyrus communis</em> L.)</p></blockquote><p><strong>Genome assembly and scaffolding</strong></p><p>The genome assembly workflow began with <em>de novo</em> assembly of contigs from the PacBio long reads using 2 tools, <font color="red"><strong>Canu</strong></font> (version 1.5) and <font color="red"><strong>Falcon</strong></font> (version 0.5). For each assembler the most important assembly parameters were systematically varied (Supplementary Methods), as defined by the tool developers, and by consideration of assembly theory (e.g., overlap length, overlap identity for overlap layout consensus assembly). <font color="blue"><strong>Optimal settings</strong> were <strong>selected</strong></font> by <strong>comparison of assembly statistics</strong> (total size assembled and contig N50) and by <strong>alignment of Illumina PE</strong> data to the assembly with <font color="red"><strong>bowtie2</strong></font> (using the â€œvery fastâ€ pre-set). For <font color="blue">all PacBio assemblies</font> the consensus step was performed by running <font color="red"><strong>Quiverçº é”™</strong></font> (Genomic Consensus version 2.3.3) (with default parameters) on <font color="blue">raw PacBio contigs</font> and using the full 63Ã— of PacBio data.</p><p>Assembled contigs were further joined into scaffolds using a combination of <strong>BioNano optical mapping</strong> data, <strong>Hi-C</strong> chromatin conformation capture data, and <strong>genetic maps.</strong> The best <font color="blue">assemblies from Canu and Falcon</font> were <font color="blue">independently combined with</font> BioNano optical mapping data using the <font color="red">IrysView</font> software to develop the Canu + BioNano (CB) and Falcon + BioNano (FB) assemblies, respectively. The BioNano scaffolding process identified conflicts between the assembled contigs and the optical map, indicating some degree of misassembly in both Canu and Falcon results.</p><p><strong>Assembly polishing</strong></p><p><font color="red"><strong>Pilon</strong></font> (version1.21) [31] was <font color="blue">run iteratively</font> on the assembly, with <font color="blue">Illumina sequence realigned to the polished assembly</font> at each iteration and then <font color="blue">alignments passed to Pilon to call the next consensus</font>. Alignments for Pilon were produced using <font color="red"><strong>BWA mem</strong></font> (v0.7.17) with default settings. <em>k</em>-mer spectrum comparisons were made using the <em>k</em>-mer analysis toolkit (<font color="red"><strong>KAT</strong></font>) (version 2.3.4) [13] (KAT comp) at a <em>k</em>-mer size of 32, and <font color="blue">the metric used to assess each iteration was the number of <strong>k-mers shared between</strong> the <strong>assembly</strong> and the <strong>Illumina</strong> reads</font>. </p><p>In a second consensus phase, <font color="blue">RNA-Seq</font> reads were aligned as single end (SE), to the genome using <font color="red"><strong>Hisat</strong></font> (version 2.1.0)  with default parameters. This time the effectiveness of consensus calling was <font color="blue">assessed by analysis of <strong>full-length alignments</strong> of assembled RNA-Seq transcripts</font>. All transcripts designated as â€œcompleteâ€ by Evigene  were aligned to the genome with BLAT  (version 3.4, with [34] minimum match identity 90%). Alignments were filtered to <strong>retain only full-length alignments</strong> (i.e., from query start to query end). </p><p>Finally, the number of gaps in the alignments (query gaps + target gaps) was used as a metric with the rationale that this serves as a proxy for the number of indels in alignments of assembled messenger RNA sequence.</p><p><strong>Scaffold clustering and genome anchoring using Hi-C</strong></p><p>Hi-C reads were aligned to the polished scaffolds in CB with <font color="red"><strong>Bowtie2</strong></font> (version 2.3.3.1) . Each of the paired reads was aligned independently; then these SE alignments were subsequently merged as recommended by the LACHESIS developers. Based on the alignments, <font color="red">CB scaffolds were <strong>arranged</strong> into <strong>17 ordered</strong> and <strong>oriented</strong> <strong>clusters</strong> using the <strong>LACHESIS</strong> software</font>. As an <font color="blue">internal check</font>, the process was completed on <font color="blue">2 different random 95% sub-samplings of the Hi-C data</font>, as well as on the full data set. The clusters produced by <strong>all 3</strong> of these LACHESIS runs were <font color="blue">identical</font>. <font color="blue">LACHESIS produces groups of scaffolds</font> that are ordered and oriented relative to each other. These scaffold groupings were <font color="blue">compared with the genetic map</font> and the <strong>consistency</strong> of these sources of information was <strong>assessed</strong>. <font color="blue">The SNP probe mapping </font>at the scaffold <strong>validation step</strong> was compared with the clusters produced by LACHESIS.</p><p><strong>Illumina assembly</strong></p><p>The Illumina data were also assembled on their own, using the de Bruijn graphâ€“based assembler <font color="red"><strong>SOAPdenovo2</strong></font> (version 2.04). <font color="blue"><strong>This assembly</strong></font> was <font color="blue"><strong>used in various ways</strong></font> during the course of the pear genome project (for further scaffold validation, for training the <em>ab initio</em> gene predictors, etc.). <font color="red"><strong>ã€å€Ÿé‰´ã€‘The Illumina data were assembled twice</strong></font>. The <font color="red">first pass</font> contigs were screened using the Kraken software and an index built from the entire RefSeq database. <font color="red">Reads aligning to contaminant contigs were <strong>removed</strong></font> and the remaining data were assembled again.</p><h1 id="15-2021-05-nbt-äºº-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…2ã€‘"><a href="#15-2021-05-nbt-äºº-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…2ã€‘" class="headerlink" title="15.  2021.05-nbt äºº ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…2ã€‘"></a>15.  2021.05-nbt äºº ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…2ã€‘</h1><blockquote><p>Chromosome-scale, haplotype-resolved assembly of human genomes</p></blockquote><p><img src="/GeekFocus/2022-03-14-HiFi-6-HiC-assembly/10.png" alt="10"><br><img src="/GeekFocus/img/2022-03-14-HiFi-6-HiC-assembly/10.png" alt="10"></p><p>outline of the phased assembly algorithm, <font color="red"><strong>DipAsm</strong></font></p><p>Assemble HiFi reads into unphased contigs using <font color="red"><strong>Peregrine</strong></font> (1);</p><p> <font color="blue"><strong>group</strong> and <strong>order</strong></font> contigs into scaffolds with <font color="blue"><strong>Hi-C</strong> data</font> using <font color="blue"><strong>Hirise&#x2F;3D-DNA</strong></font> (3D de novo assembly) (2);</p><p> <font color="blue"><strong>map HiFi reads</strong> to scaffolds</font> and <font color="blue"><strong>call heterozygous SNPs</strong></font> using <font color="red"><strong>DeepVariant</strong></font> (3);</p><p> <font color="blue"><strong>phase</strong></font> heterozygous SNP calls with both HiFi and Hi-C data using <font color="red"><strong>WhatsHap plus HapCUT2</strong></font> (4);</p><p> partition reads based on their phase using <font color="red"><strong>WhatsHap</strong></font> (5);</p><p> assemble partitioned reads into <font color="blue"><strong>phased contigs</strong></font> using <font color="red"><strong>Peregrine</strong></font> (6).</p><p><strong>Phased sequence assembly.</strong> </p><p>We ran <font color="red"><strong>Peregrine v.0.1.5.2</strong></font> with the following command line: â€˜peregrine asm reads.lst 24 24 24 24 24 24 24 24 24 â€“with-consensus â€“shimmer-r 3 â€“best_n_ovlp 8â€“output asmâ€™, where file â€˜reads. lstâ€™ gives the list of input read files and directory â€˜asmâ€™ holds the output assembly. </p><p>We <font color="blue"><strong>mapped Hi-C reads to contigs</strong></font> with <font color="red"><strong>BWA-MEM</strong></font> v.0.7.17 and <font color="blue"><strong>scaffolded</strong></font> the Peregrine contigs with <font color="red"><strong>juicer v.1.5</strong></font> and <font color="red"><strong>3D-DNA v.180922</strong></font>. We preprocessed data with <font color="green"><strong>â€˜juicer.sh -d juicer -p chrom.sizes -y cut-sites.txt -z contigs.fa -Dâ€™</strong></font>, where file <strong>â€˜cut-sites.txtâ€™</strong> was <strong>generated</strong> using the <strong>generate_site_positions_Arima. py</strong> script, which <strong>outputs merged_nodups.txt</strong>. The scaffolds were produced with <font color="green"><strong>â€˜run-asm-pipeline.sh -m haploid contigs.fa merged_nodups.txtâ€™</strong></font>. </p><p>We then called small variants using DeepVariant v.0.8.0 with the pretrained PacBio model. </p><p>We mapped Hi-C reads to the scaffolds and ran HapCUT2 v.1.1 over heterozygous SNP sites to obtain sparse phasing at the chromosome scale. The resulting haplotypes were then combined with PacBio HiFi data using WhatsHap v.0.18, with default parameters, to generate fine-scale, chromosome-long phasing. </p><p>We partitioned HiFi reads based on the phases of SNPs residing on these reads, and ran Peregrine again for reads on the same haplotype from the same scaffold. This provided the final phased assembly.</p><h1 id="16-2018-11-ng-åŒæºå¤šå€ä½“ç”˜è”—-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…3ã€‘"><a href="#16-2018-11-ng-åŒæºå¤šå€ä½“ç”˜è”—-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…3ã€‘" class="headerlink" title="16.  2018.11-ng åŒæºå¤šå€ä½“ç”˜è”— ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…3ã€‘"></a>16.  2018.11-ng åŒæºå¤šå€ä½“ç”˜è”— ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…3ã€‘</h1><blockquote><p>Allele-defined genome of theautopolyploid sugarcane <em>Saccharum spontaneum</em> L.</p></blockquote><p><strong>ææ–™</strong></p><p>æ ½åŸ¹ç”˜è”—çš„<font color="blue">å•å€å‹ä¸ªä½“</font><em>S.spontaneum</em>â€œAP85-441â€(1n &#x3D; 4x &#x3D; 32) è¿›è¡ŒåŸºå› ç»„<em>denovo</em>æµ‹åºç ”ç©¶ã€‚<br>64ä»½ç”˜è”—ï¼ˆ<em>Saccharum spontaneum</em>ï¼‰ç¾¤ä½“ææ–™è¿›è¡Œ<font color="blue">é—ä¼ å¤šæ ·æ€§ç ”ç©¶</font>ã€‚</p><p><strong>æ–¹æ³•</strong></p><p>äºŒä»£280-bpå’Œ500-bp(PE) å°ç‰‡æ®µæ–‡åº“ï¼ˆIllumina HiSeq 2500ï¼‰<br>BACæ–‡åº“ï¼ˆIllumina HiSeq 2500ï¼ŒPE250ï¼‰ï¼›ä¸‰ä»£å¤§ç‰‡æ®µæ–‡åº“~20kb SMRTbellTMï¼ˆ<font color="blue">PacbioRSII</font>ï¼‰<br>Hi-Cæ–‡åº“ï¼ˆ<font color="blue">HindIIIé…¶åˆ‡</font>ï¼‰ï¼Œ500-700bpå°ç‰‡æ®µæ–‡åº“ï¼ˆHiSeqX tenï¼ŒPE150ï¼‰</p><p><strong>ä¸»è¦ç»“æœ</strong>ï¼š</p><p><strong>ç”˜è”—åŸºå› ç»„denovo</strong><br>åˆ©ç”¨BACæ–‡åº“è¿›è¡ŒäºŒä»£æµ‹åºï¼ŒALLPATH-LG,SPAdes å’ŒSOAPdenovo2è¿›è¡Œåˆæ­¥ç»„è£…ï¼Œè¿›ä¸€æ­¥åˆ©ç”¨<font color="blue">87X ä¸‰ä»£PacBioæ•°æ®è¿›è¡Œ<strong>çº é”™</strong></font>ï¼Œ<font color="red"><strong>CANU</strong></font>ç»„è£…ï¼Œç»„è£…åŸºå› ç»„3.13Gï¼Œ<font color="blue">contigN50&#x3D;45 kb</font>ï¼ˆæµå¼è¯„ä¼°åŸºå› ç»„å¤§å°ï¼š3.36Gï¼‰ï¼›é€šè¿‡Hi-CæŸ“è‰²ä½“æŒ‚è½½æŠ€æœ¯ï¼Œé’ˆå¯¹<font color="red"><strong>å¤šå€ä½“æŸ“è‰²æŒ‚è½½æœ€æ–°ç®—æ³•ALLHIC</strong></font>ï¼Œè¿›ä¸€æ­¥å°†contigæ°´å¹³æå‡è‡³æŸ“è‰²ä½“æ°´å¹³ï¼Œ<strong>æŒ‚è½½ç‡è¾¾åˆ°93%<strong>ï¼›é€šè¿‡BUSCOå’ŒäºŒä»£æ•°æ®å›æ¯”è¯„ä¼°åŸºå› ç»„å®Œæ•´æ€§é«˜è¾¾</strong>97.3%<strong>ã€‚å†é€šè¿‡<font color="red"><strong>MAKER</strong></font>å¯¹åŒæºå¤šå€ä½“ç”˜è”—<font color="blue">ç‰¹å¼‚ç­‰ä½åŸºå› è¿›è¡Œ</strong>æ‰‹åŠ¨æ³¨é‡Š</strong></font>ï¼Œä»¥è·å¾—é«˜è´¨é‡çš„ç”˜è”—åŸºå› ç»„</p><p>**åŸºç¡€æŸ“è‰²ä½“æ•°ç›®çš„å‡å°‘ *<em>ç¦¾æœ¬ç§‘æŸ“è‰²ä½“æ•°è¿›åŒ–ï¼ˆé«˜ç²±n&#x3D; 10åˆ°ç”˜è”—n&#x3D; 8ï¼‰<br>AP85-441åŸºå› ç»„çš„ç»„è£…æ˜¾ç¤ºäº†</em>S.spontaneum*çš„æŸ“è‰²ä½“æ•°ç›®ä»10é™åˆ°8ï¼Œè€Œè¿™ä¸é¢‘ç¹å¤åˆ¶çš„å¤å¤åˆ¶æŸ“è‰²ä½“å¯¹ç›¸å…³ï¼Œé€šè¿‡ä¸é«˜ç²±çš„èšç±»æ¯”å¯¹ï¼Œå‘ç°é«˜ç²±ç¥–å…ˆ5æŸ“è‰²ä½“å’Œ8å·æŸ“è‰²ä½“åŒæºç‰©ç»å†äº†æŸ“è‰²ä½“è£‚å˜ï¼ˆå›¾2ï¼‰ã€‚SbChr05ï¼ˆA12ï¼‰çš„ç¥–å…ˆæŸ“è‰²ä½“æ–­è£‚åˆ†ä¸ºä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼Œå³C5Sï¼ˆA12Sï¼‰å’ŒC5Lï¼ˆA12Lï¼‰ï¼Œåˆ†åˆ«è½¬ç§»åˆ°SbChr06ï¼ˆA2ï¼‰å’ŒSbChr07ï¼ˆA5ï¼‰çš„ç¥–å…ˆæŸ“è‰²ä½“ï¼›SbChr8ï¼ˆA11ï¼‰çš„ç¥–å…ˆæŸ“è‰²ä½“æ–­è£‚ä¸ºä¸¤ä¸ªä¸»è¦çš„éƒ¨åˆ†ï¼Œå³C8Sï¼ˆA11Sï¼‰å’ŒC8Lï¼ˆA11Lï¼‰ï¼Œåˆ†åˆ«è½¬ç§»åˆ°SbChr09ï¼ˆA6ï¼‰å’ŒSbChr02ï¼ˆA7+ A9ï¼‰çš„ç¥–å…ˆæŸ“è‰²ä½“ä¸­ã€‚SbChr8å’ŒSsChr5ä¹‹é—´åŠSbChr5å’ŒSsChr7ä¹‹é—´è¿‘ä¹åŒæºçš„çŸ­ç‰‡æ®µæ˜¯åœ¨é«˜ç²±ä¸ç”˜è”—åˆ†åŒ–å‰ï¼Œé«˜ç²±SSAå½¢æˆäº13.4MYAåŒæºåŸºå› çš„æ®‹ç•™ç‰©ï¼ŒåŒæ—¶å‘ç°ï¼ŒS5ä¸­è¾ƒå°çš„SSAåŒºåŸŸå’ŒS8ä¸­SSAçš„è¾ƒå¤§åŒºåŸŸåœ¨é‡æ’çš„AP85-441åŸºå› ç»„ä¸­ä¹Ÿæ˜¯ä¿å®ˆçš„ã€‚</p><p><strong>S.spontaneumçš„å¤šå€ä½“åŒ–åˆ†æ</strong><br>è¿›ä¸€æ­¥ç ”ç©¶å‘ç°äº†ç”˜è”—ï¼ˆ<em>Saccharum spontaneum</em> L.ï¼‰æŸ“è‰²ä½“ç”±é«˜ç²±ï¼ˆ<em>Sorghum</em>ï¼‰æ¼”å˜è¿›åŒ–è¿‡ç¨‹ä¸­ç»å†äº†æŸ“è‰²ä½“æ–­è£‚ä¸èåˆåï¼Œå‘ç”Ÿäº†ä¸¤æ¬¡WGDäº‹ä»¶ï¼ˆå›¾3ï¼‰ï¼›å¯¹ç”˜è”—çš„åŸºå› ç»„çš„å¤šå€åŒ–ç ”ç©¶ä¸­å‘ç°ï¼Œé€šè¿‡ä¸¤æ¬¡å…¨åŸºå› ç»„å¤åˆ¶äº‹ä»¶çš„å‘ç”Ÿï¼Œå¯¼è‡´äº†ç”˜è”—æŸ“è‰²ä½“çš„è‡ªå‘åŠ å€è¿‡ç¨‹ï¼›å¯¹åŒæºå¤šå€ä½“ç”˜è”—çš„ç‰¹å¼‚ç­‰ä½åŸºå› çš„é‰´å®šä½œä¸ºæœ¬ç ”ç©¶çš„å¦ä¸€äº®ç‚¹ï¼Œæ–‡ç« åœ¨é‰´å®šç­‰ä½åŸºå› çš„åŒæ—¶ï¼Œè¿›ä¸€æ­¥åˆ†æç ”ç©¶äº†ç­‰ä½åŸºå› çš„è¡¨è¾¾æ¨¡å¼ï¼Œç»“æœå‘ç°ä¸åŒå•å€å‹è¡¨è¾¾æ¨¡å¼ç›¸ä¼¼ï¼Œå¹¶æ— æ˜æ˜¾å·®å¼‚ï¼›å¯¹ç”˜è”—C4å…‰åˆä½œç”¨çš„ç ”ç©¶ä¸­é‰´å®šäº†24ä¸ªåŸºå› ï¼Œ7ç§å…³é”®é…¶å‚ä¸NADP-MEC4é€”å¾„ï¼›åœ¨ç”˜è”—ä¸­è”—ç³–å¯¹çš„ç§¯ç´¯çš„ç ”ç©¶ä¸­å‘ç°ä¸é«˜ç²±ç›¸æ¯”ç”˜è”—ä¸­çš„æ¶²æ³¡è†œç³–è½¬è¿è›‹ç™½ï¼ˆTSTsï¼Œä¸€ç§è”—ç³–è½¬è¿è›‹ç™½ï¼‰å‘ç”Ÿäº†åŸºå› å®¶æ—çš„æ‰©å¼ ï¼Œæ‰€ä»¥æ¨æµ‹TSTså‚ä¸è”—ç³–åœ¨æ¶²æ³¡ä¸­çš„ç§¯ç´¯ï¼›<em>S.spontaneum</em>ä¸ºç°ä»£æ ½åŸ¹ç”˜è”—æä¾›äº†æŠ—ç—…æ€§åŸºå› ï¼Œåœ¨å¯¹å…¶ç ”ç©¶ä¸­å‘ç°ï¼Œç”˜è”—ä¸­çš„80ï¼…çš„NBSç¼–ç åŸºå› ä½äºå››ä¸ªé‡æ’æŸ“è‰²ä½“ï¼ˆSs02ï¼ŒSs05ï¼ŒSs06å’ŒSs07ï¼‰ä¸Šï¼Œå…¶ä¸­51ï¼…ä½äºé‡æ’åŒºåŸŸã€‚</p><p><strong>S.spontaneumçš„èµ·æºä¸é—ä¼ å¤šæ ·æ€§åˆ†æ</strong><br>é€šè¿‡å¯¹64ä»½ç”˜è”—ï¼ˆ<em>Saccharum spontaneum</em>ï¼‰ç¾¤ä½“ææ–™é—ä¼ å¤šæ ·æ€§ç ”ç©¶ï¼Œå‘ç°å…¶å…·æœ‰å¹¿æ³›çš„è‡ªç„¶éƒ¨åˆ†èŒƒå›´ï¼ŒéåŠäºšæ´²ï¼Œå°åº¦æ¬¡å¤§é™†ï¼Œåœ°ä¸­æµ·å’Œéæ´²ï¼Œä¸”è‡ªç„¶ç§ç¾¤å…·æœ‰å¹¿æ³›çš„è¡¨å‹ï¼Œé—ä¼ å’Œå€æ€§æ°´å¹³å¤šæ ·æ€§ï¼ˆå›¾4ï¼‰ã€‚ç ”ç©¶å‘ç°ï¼Œä¸é«˜ç²±ç›¸æ¯”å…·æœ‰å¤§è§„æ¨¡æŸ“è‰²ä½“é‡æ’çš„<em>S. spontaneum</em>åŒºåŸŸå…·æœ‰æ¯”éé‡æ’åŒºåŸŸæ›´é«˜çš„é—ä¼ å¤šæ ·æ€§ï¼Œå¹¶ä¸”å¯èƒ½ç»å†äº†æ›´å¼ºçš„å¹³è¡¡é€‰æ‹©ã€‚è™½ç„¶å‡ æ¡å•ç‹¬çš„æŸ“è‰²ä½“æ²¡æœ‰æ˜¾ç¤ºå‡ºæ˜¾è‘—å·®å¼‚ï¼Œä½†æ˜¯æ¯”è¾ƒæ‰€æœ‰æŸ“è‰²ä½“ä¸Šçš„å¹³å‡å€¼æ˜¾ç¤ºé‡æ’åŒºåŸŸä¸­çš„æ ¸è‹·é…¸å¤šæ ·æ€§ï¼ˆ0.00025Â±0.00003ï¼‰è¿œé«˜äºéé‡æ’åŒºåŸŸä¸­çš„æ ¸è‹·é…¸å¤šæ ·æ€§ï¼ˆ0.00021Â±0.00001ï¼‰ï¼ŒæŸ“è‰²ä½“é‡æ’åŒºåŸŸçš„Tajimaâ€™s Dï¼ˆ-0.659Â±0.052ï¼‰è¿œè¿œé«˜äºéé‡æ’åŒºï¼ˆ-0.720Â±0.011ï¼‰ï¼Œé‡æ’åŒºçš„SNPå¯†åº¦(360.27Â±48.41) é«˜äºéé‡æ’åŒºåŸŸï¼ˆ297.46Â±12.65, P&#x3D;0.001798ï¼‰ï¼›æ­¤å¤–ï¼ŒGOå¯Œé›†æ˜¾ç¤ºï¼ŒæŸ“è‰²ä½“éé‡æ’åŒºä¸»è¦å¯Œé›†åˆ°ä¸åŸºæœ¬ç”Ÿå‘½å‘¨æœŸï¼Œå…‰åˆä½œç”¨ï¼Œå‘¼å¸ä½œç”¨å’ŒATPåˆæˆçš„é€šè·¯ä¸Šã€‚é‡æ’åŒºä¸»è¦å¯Œé›†åœ¨GOç”Ÿç‰©åˆæˆå’Œä»£è°¢ï¼Œè·¨è†œè½¬è¿å’Œç¦»å­ç»“åˆé€šè·¯ä¸Šã€‚</p><p><em>S. spontaneum</em>é‡æ’åŒºå…·æœ‰é«˜åº¦çš„é—ä¼ å¤šæ ·æ€§å°†æ›´é€‚åº”ç¯å¢ƒå‹åŠ›ï¼Œä¾‹å¦‚å¯¹å„ç§éç”Ÿç‰©èƒè¿«ï¼ˆå¹²æ—±ï¼Œç›åº¦ï¼Œç¢±æ€§ï¼Œé‡‘å±ç¦»å­ç­‰ï¼‰çš„ååº”ï¼Œè¿™äº›å—åˆ°æ¬¡ç”Ÿç»†èƒç”Ÿç‰©åˆæˆå’Œä»£è°¢ï¼Œè·¨è†œè½¬è¿å’Œç¦»å­ç»“åˆçš„æ§åˆ¶çš„åŸºå› åœ¨è¿™äº›åŒºåŸŸå¯ä»¥æ£€æµ‹åˆ°ã€‚åœ¨å¤šå€åŒ–äº‹ä»¶åï¼Œé‡æ’åŒºåŸŸç»å†äº†æ›´å¼ºçš„å¹³è¡¡é€‰æ‹©ã€‚</p><p><strong>è®¨è®º</strong></p><p>æœ¬ç ”ç©¶åˆ©ç”¨å¤æ‚åŸºå› ç»„Hi-Cå»ºåº“æµ‹åºæŠ€æœ¯ï¼Œå¹¶ç»“åˆALLHiCç®—æ³•æˆåŠŸç»„è£…äº†é«˜å¤æ‚åŒæºå¤šå€ä½“ç”˜è”—åŸºå› ç»„AP85-441ï¼Œé«˜è´¨é‡çš„ç”˜è”—åŸºå› ç»„çš„è·å¾—ï¼Œä¸ºåç»­ç ”ç©¶å…¶è”—ç³–å«é‡ï¼ŒæŠ—æ€§ç­‰æ€§çŠ¶åŠå†œä¸šè‚²ç§åŸºç¡€å¥ å®šäº†åŸºç¡€ã€‚</p><p><strong>Genome assembly overview.</strong> </p><p>The sugarcane AP85-441 contig-level assembly incorporated sequencing data from a mixture of sequencing technologies (Supplementary Fig. 1), including BAC pools sequenced with Illumina HiSeq 2500 and whole-genome shotgun sequencing with PacBio RS II as well as Hi-C reads, followed by Illumina short reads polishing. Each BAC pool was independently assembled using <font color="red">ALLPATHS-LG, SPAdes and SOAPdenovo2</font>, and best results were retained. For PacBio assembly, <font color="red"><strong>Canu v1.511</strong></font> was used, as it is capable<br>of avoiding collapsed repetitive regions and haplotypes. Self-correction was performed with parameter corOutCoverage &#x3D; 100, which allowed us to correct all of the input PacBio reads. The corrected reads, along with BAC-assembled contigs, were imported to the assembly step. <font color="blue">Chromosomal assembly</font> was constructed based on proximity-guided assembly using our newly developed program, <font color="red"><strong>ALLHIC</strong>, which is designed for <strong>polyploid</strong> genome scaffolding</font> (see Supplementary Note for details).</p><p><img src="/GeekFocus/2022-03-14-HiFi-6-HiC-assembly/11.png" alt="11"><br><img src="/GeekFocus/img/2022-03-14-HiFi-6-HiC-assembly/11.png" alt="11"></p><h1 id="17-2019-08-np-ALLHiCã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…4ã€‘"><a href="#17-2019-08-np-ALLHiCã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…4ã€‘" class="headerlink" title="17.  2019.08-np ALLHiCã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…4ã€‘"></a>17.  2019.08-np ALLHiCã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…4ã€‘</h1><blockquote><p>Assembly of allele-aware, chromosomal-scale autopolyploid genomes based on Hi-C data</p></blockquote><p><strong>existing approaches are mostly designed for diploid genomes and often with the aim of reconstructing a haploid representation, thereby having limited power to reconstruct chromosomes for autopolyploid genomes. We developed a novel algorithm (ALLHiC) that is capable of building allele-aware, chromosomal-scale assembly for <font color="red">auto-polyploid genomes</font> using Hi-C paired-end reads with innovative â€˜pruneâ€™ and â€˜optimizeâ€™ steps. Application on simulated data showed that ALLHiC can phase allelic contigs and substantially improve ordering and orientation when compared to other mainstream Hi-C assemblers</strong></p><h1 id="18-2020-05-nc-ç´«èŠ±è‹œè“¿åŒæºå››å€ä½“-06ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…5ã€‘"><a href="#18-2020-05-nc-ç´«èŠ±è‹œè“¿åŒæºå››å€ä½“-06ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…5ã€‘" class="headerlink" title="18. 2020.05-nc ç´«èŠ±è‹œè“¿åŒæºå››å€ä½“-06ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…5ã€‘"></a>18. 2020.05-nc ç´«èŠ±è‹œè“¿åŒæºå››å€ä½“-06ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…5ã€‘</h1><h1 id="19-2020-10-ng-äºŒå€ä½“åœŸè±†-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…6ã€‘"><a href="#19-2020-10-ng-äºŒå€ä½“åœŸè±†-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…6ã€‘" class="headerlink" title="19. 2020.10-ng äºŒå€ä½“åœŸè±† ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…6ã€‘"></a>19. 2020.10-ng äºŒå€ä½“åœŸè±† ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…6ã€‘</h1><blockquote><p>Haplotype-resolved genome analyses of a heterozygous diploid potato</p></blockquote><p>ref of 12: Hi-C-genetic-maps-for-<font color="red">correction</font></p><p>é©¬é“ƒè–¯(Solanum tuberosum L.)æ˜¯å…¨çƒé‡è¦çš„å—èŒä½œç‰©ã€‚äººä»¬æ­£åœ¨åŠªåŠ›å°†è¿™ç§ä½œç‰©ä»æ— æ€§ç¹æ®–çš„å››å€ä½“è½¬åŒ–ä¸ºç§å­ç¹æ®–çš„ã€è‡ªäº¤ç³»ä¸ºåŸºç¡€çš„æ‚äº¤ä½œç‰©ï¼Œä½†è¿™ä¸€è¿‡ç¨‹éœ€è¦å¯¹é©¬é“ƒè–¯åŸºå› ç»„æœ‰æ›´å¥½çš„äº†è§£ã€‚</p><p><strong>Genome assembly and phasing using PacBio CCS reads.</strong> </p><p>A total of 29 Gb CCS reads were assembled using <font color="red"><strong>Canu</strong></font> (v1.91) with the <font color="green"><strong>parameter</strong> â€“pacbio-hifi</font>.<br>Canu <font color="blue">generated <strong>two</strong> assemblies</font> composed of contigs and unitigs (Supplementary Table 4), and the <font color="blue"><strong>unitig</strong> assembly consisted of the <strong>contigs that split at any alternative paths</strong> in the assembly graph</font>. The contig assembly had longer continuity but more chimeric fragmentsåµŒåˆä½“ç‰‡æ®µ as revealed in the genetic mapping analysis. To avoid the mis-joining of two haplotypes, <font color="red"><strong>the unitig assembly</strong></font> rather than the contig assembly was chosen for the <font color="red"><strong>subsequent analysis</strong></font>. The unitigs were then <font color="blue"><strong>polished</strong> iteratively using <strong>two rounds</font></strong> of <font color="red"><strong>Pilon</strong></font> with ~150 Gb of WGS <strong>Illumina</strong> data, generating the genome <strong>draft RHgv2</strong>.</p><p>Similarly, the sequenced reads of RH selfing progenyåä»£ were mapped to unitigs of RHgv2 to perform <font color="blue"><strong>genetic grouping</strong></font>. Because the unitigs were relatively long (N50 &#x3D; 2 Mb), windows with a size of 200 kb rather than the whole unitig were used. If the adjacent windows of one unitig showed contrary read distribution, the unitig was defined as chimeric and broken between windows; 40 chimeric unitigs with a total length of 95 Mb were broken. In total, <font color="blue">1.31 Gb of 1.53 Gb sequences were assigned to 24 linkage groups</font>.</p><p>After merging, 141 Mb sequences and 5,252 annotated genes of RHgv1 were added to the RHgv2, yielding a 1.67 Gb genome draft with 1.54 Gb sequences assigned to 24 groups, termed RHgv3 (Supplementary Table 6). The sequences from the RHgv1 and RHgv2 assemblies were named as ontctg* and unitig* in the AGP file, respectively (Supplementary Data 3).</p><p><strong>Construction of pseudochromosomes.</strong> </p><p>As no approach generated satisfactory results on the RH genome, we introduced the group information derived from the genetic mapping to assist the Hi-C application on chromosome-level assembly. The process was performed on RHgv3 including three steps as follows:</p><ol><li><font color="blue"><strong>Align</strong></font>. The 24 previously determined groups were divided into <font color="blue"><strong>two haplotypes</strong> to <strong>generate</strong> <strong>two</strong> <strong>pseudohaploid genome drafts</strong></font>. The 132 Mb sequences that could not be assigned to any group were added to two pseudohaploid genomes. Total <font color="blue">Hi-C reads were <strong>aligned</strong> to <strong>each</strong> pseudohaploid genome using <strong>HiC-Pro</strong> to calculate the <strong>contact frequency</strong></font>. This step <font color="blue">yielded <strong>two bam files</strong> for the two pseudohaploid genomes</font>.</li><li><font color="blue"><strong>Rescue</strong></font>. Using the <font color="blue">bam file as input</font>, the <em>rescue</em> function in <font color="red"><strong>ALLHiC</strong></font> was applied to assign unplaced sequences to known groups. Because the 132 Mb <strong>unplaced sequences</strong> were <strong>added</strong> to two pseudohaploid genomes and <strong>processed twice</strong>, the rescued <strong>results were redundant</strong>. For every <strong>unplaced sequence</strong>, we <strong>considered its best Hi-C signal density</strong> to decide the group to which it belonged. After this step, the sequence content of 24 groups was updated with an <strong>extra 75.6 Mb</strong> sequences assigned to proper groups.</li><li><font color="blue"><strong>Optimize and build</strong></font>. For each pseudohaploid genome, using <font color="red">the bam file and the updated group file as input</font>, the <font color="red"><strong><em>optimize</em> function in ALLHiC</strong></font> decidedthe <strong>order</strong> and <strong>orientation</strong> of scaffolds for each group; thus, the <font color="red"><strong><em>build</em> function</strong></font> generated fasta sequences on that basis. By performing this step, we identified the pseudochromosomes for 24 groups. The order and orientation of scaffolds on chromosomes are provided in Supplementary Data 3.</li></ol><h1 id="20-2021-12-gb-ææ ‘ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…7ã€‘"><a href="#20-2021-12-gb-ææ ‘ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…7ã€‘" class="headerlink" title="20. 2021.12-gb ææ ‘ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…7ã€‘"></a>20. 2021.12-gb ææ ‘ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…7ã€‘</h1><blockquote><p>Gamete binning: chromosome-level and haplotype-resolved genome assembly enabled by high-throughput single-cell sequencing of gamete genomes</p></blockquote><p>ref of 12: Hi-C-genetic-maps-for-correction</p><p>ä¸€ç§åŸºäºå•å€ä½“é…å­å•ç»†èƒæµ‹åºçš„æ–¹æ³•ã€‚åŸºäº445ä¸ªä¸ªä½“èŠ±ç²‰ç²’çš„å…¨åŸºå› ç»„æµ‹åºï¼Œç»„è£…äº†ä¸€æ ªäºŒå€ä½“ææ ‘çš„ä¸¤ä¸ªåŸºå› ç»„ã€‚</p><p><strong>Genome size estimation</strong></p><p>After trimming off 10x Genomics barcodes and hexamers from the 61.7 Gb reads of the two 10x sc-CNV libraries, k-mer counting (k&#x3D;21) was performed with <font color="red"><strong>Jellyfish</strong></font>. The k-mer histogram was provided to<font color="red"> <strong>findGSE</strong></font> to estimate the size of the â€œRojo PasioÌnâ€ genome under the heterozygous mode (with â€œexp_hom&#x3D;200â€; Add- itional file 1: Fig. S3).</p><p><strong>Preliminary diploid-genome assembly and curation</strong></p><p>With the 19.9 G raw PacBio reads of â€œRojo PasioÌnâ€ (Additional file 1: Fig. S2), a pre-liminary diploid assembly was constructed using <font color="red"><strong>Canu</strong></font> (with options â€œgenome- Size&#x3D;242500000 corMhapSensitivity&#x3D;high corMinCoverage&#x3D;0 corOutCoverage&#x3D;100 correctedErrorRate&#x3D;0.105â€).</p><p>All raw <strong>Illumina reads</strong> from the 10x libraries were <font color="red">firstly <strong>aligned</strong> to the <strong>initial assembly</strong></font> using <font color="red"><strong>bowtie2</strong></font>. Then, the purge haplotigs pipeline was used to remove haplotigs (i.e., haplotype-specific contigs inflating the true haploid genome) based on statistical analysis of sequencing depth and identify primary contigs to build up a curated haploid assembly. To reduce the false-positive rate in defining haplotigs, each haplotig was blasted to the curated assembly; if over 50% of the haplotig could not be covered by any primary contigs, it was re-collected as a primary contig.</p>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
      <tag>paper</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HiFi-5-[HiC-Pro]-[MCscan]-[ALLHiC]</title>
    <link href="/GeekFocus/2022/03/09/2022-03-09-HiFi-5-HiC-Pro/"/>
    <url>/GeekFocus/2022/03/09/2022-03-09-HiFi-5-HiC-Pro/</url>
    
    <content type="html"><![CDATA[<p>HiC-Proå°†fqæ–‡ä»¶å¤„ç†æˆäº’ä½œallValidPairsï¼Œå†è½¬åŒ–æˆå¯è§†åŒ–hicæ–‡ä»¶(for juicer)</p><span id="more"></span><h1 id="HiCç®€ä»‹"><a href="#HiCç®€ä»‹" class="headerlink" title="HiCç®€ä»‹"></a>HiCç®€ä»‹</h1><ul><li><p><strong>1.1 Hi-CæŠ€æœ¯</strong>é«˜é€šé‡æŸ“è‰²ä½“æ„è±¡æ•è·æŠ€æœ¯(<code>High-throughput chromosome conformation capture</code>)ç ”ç©¶å…¨åŸºå› ç»„ä¸‰ç»´æ„è±¡åŠåˆ†ææŸ“è‰²è´¨ç‰‡æ®µç›¸äº’ä½œç”¨çš„å®éªŒæŠ€æœ¯</p></li><li><p><strong>1.2 Hi-Cç›®çš„</strong>äº†è§£æ ¸å†…æŸ“è‰²è´¨çš„ä¸‰ç»´æ„è±¡ã€è·å¾—ç»†èƒæ ¸å†…ç©ºé—´ä½ç½®éå¸¸æ¥è¿‘æˆ–å­˜åœ¨ç›¸äº’ä½œç”¨çš„æŸ“è‰²è´¨æµ‹åºç‰‡æ®µæ›´å¥½åœ°ç ”ç©¶æŸ“è‰²è´¨å†…æˆ–æŸ“è‰²è´¨é—´çš„äº’ä½œã€åŸºå› è°ƒæ§å…ƒä»¶åœ¨å…¨åŸºå› ç»„èŒƒå›´å†…è°ƒæ§çš„æƒ…å†µ</p></li><li><p><strong>1.3 Hi-Cåº”ç”¨æ–¹å‘</strong>è¾…åŠ©åŸºå› ç»„ç»„è£…ã€æ­ç¤ºç©ºé—´è°ƒæ§ã€æ­ç¤ºç‰©ç§è¿›åŒ–ã€ç–¾ç—…ç ”ç©¶ã€ä¸‰ç»´ç»“æ„å·®å¼‚åˆ†æã€è¿˜åŸæŸ“è‰²ä½“ä¸‰ç»´ç»“æ„ã€æ„å»ºæŸ“è‰²ä½“è·¨åº¦å•ä½“å‹</p></li><li><p><strong>1.4 äº’ä½œæœ¬è´¨</strong>ç»Ÿè®¡å­¦ä¸ŠåŸºå› ç»„ä¸¤ç‚¹ä¹‹é—´å‘ç”Ÿç©ºé—´æ¥è§¦çš„æ¦‚ç‡</p></li><li><p><strong>1.5 Hi-Cå®éªŒåŸç†</strong></p></li><li><p><strong>1.6 äºŒä»£æ–‡åº“æ„å»ºåŠæµ‹åº</strong></p></li><li><p><strong>1.7 Hi-Cå®é™…æ–‡åº“ç±»å‹</strong>å°†HICæ•°æ®è¿›è¡Œæ¯”å¯¹æ˜¯ä¼šå‡ºç°ä¸åŒçš„æ¯”å¯¹æƒ…å†µï¼Œéœ€è¦çš„æ˜¯<font color="blue">åŒç«¯å”¯ä¸€åŒ¹é…</font>ã€‚å¯¹å•ç«¯åŒ¹é…ã€å¤šå¤„æ¯”å¯¹ã€æœªæ¯”å¯¹çš„readsè¿›è¡Œè¿‡æ»¤ã€‚</p><p><img src="/GeekFocus/2022-03-09-HiFi-5-HiC-Pro/5.png"><br><img src="/GeekFocus/img/2022-03-09-HiFi-5-HiC-Pro/5.png" alt="HiC-Proçš„ä½¿ç”¨"></p><p>Hi-Cæ–‡åº“æ„å»ºäº§ç”Ÿå¤šç§åˆ†å­ç±»å‹ï¼ŒåŒ…æ‹¬ re-ligationã€Dangling endsã€self circle ã€dump reads åŠvalid pairs readsç­‰ç±»å‹ã€‚ åœ¨ Hi-C åˆ†æä¸­ï¼Œ<font color="red">ä»…valid pairå¯ä»¥åæ˜ åŸºå› ç»„ä¸Šä½ç‚¹ä¸ä½ç‚¹é—´çš„äº’ä½œ</font>ã€‚å› æ­¤ï¼Œ<font color="blue">éé‡å¤çš„valid pair</font>æ‰€å æ¯”ä¾‹æ˜¯è¯„ä¼°Hi-Cæ–‡åº“è´¨é‡é‡è¦æŒ‡æ ‡</p><p><img src="/GeekFocus/2022-03-09-HiFi-5-HiC-Pro/6.png"><br><img src="/GeekFocus/img/2022-03-09-HiFi-5-HiC-Pro/6.png" alt="ä¸‰ç»´åŸºå› ç»„æŠ€æœ¯ï¼ˆä¸‰ï¼‰ï¼šHi-C æ•°æ®æ¯”å¯¹åŠHiC-Proçš„ä½¿ç”¨"></p></li><li><p><strong>äº’ä½œçŸ©é˜µçš„ç”Ÿæˆ</strong>ç”±äºè®¡ç®—èµ„æºï¼Œæ•°æ®é‡ç­‰å› ç´ ï¼Œ<font color="blue">éœ€è¦ç¡®å®šä¸€ä¸ªäº’ä½œå•ä½ï¼šbin</font>ã€‚å°†åŸºå› ç»„æŒ‰ç…§ä¸€å®šå¤§å°åˆ†æˆbinã€‚<font color="red">å°†è¿‡æ»¤åçš„æœ‰æ•ˆåºåˆ—åˆ†é…åˆ°è¿™äº›binä¸­</font></p><p><img src="/GeekFocus/2022-03-09-HiFi-5-HiC-Pro/7.png"><br><img src="/GeekFocus/img/2022-03-09-HiFi-5-HiC-Pro/7.png" alt="ä¸‰ç»´åŸºå› ç»„æŠ€æœ¯ï¼ˆä¸‰ï¼‰ï¼šHi-C æ•°æ®æ¯”å¯¹åŠHiC-Proçš„ä½¿ç”¨"></p></li><li><p><strong>äº’ä½œçŸ©é˜µçš„çŸ«æ­£</strong>Hi-Cæ•°æ®ä¸­ç”±äº<font color="blue">å†…åˆ‡é…¶åå¥½æ€§ã€åŸºå› ç»„æœ¬èº«è´¨é‡ã€åŸºå› ç»„åºåˆ—ç‰¹å¼‚æ€§</font> å¯¼è‡´å…¶åœ¨åŸºå› ç»„ä¸åŒä½ç½®é—´å­˜åœ¨åå·®ã€‚å› æ­¤ï¼Œ<font color="red">å¯¹äº’ä½œçŸ©é˜µæ ¡æ­£ï¼Œä½¿å…¶æ•°æ®åœ¨åŸºå› ç»„ä¸Šæ¯ä¸ªä½ç‚¹çš„è¦†ç›–åº¦ä¸€è‡´</font>ã€‚å¸¸ç”¨çŸ«æ­£æ–¹å¼æœ‰<font color="red"><strong>è¿­ä»£çŸ«æ­£ã€å½’ä¸€åŒ–</strong></font>ç­‰</p><p><img src="/GeekFocus/2022-03-09-HiFi-5-HiC-Pro/8.png"><br><img src="/GeekFocus/img/2022-03-09-HiFi-5-HiC-Pro/8.png" alt="ä¸‰ç»´åŸºå› ç»„æŠ€æœ¯ï¼ˆä¸‰ï¼‰ï¼šHi-C æ•°æ®æ¯”å¯¹åŠHiC-Proçš„ä½¿ç”¨"></p></li></ul><h2 id="HiCå¸¸è§„è½¯ä»¶"><a href="#HiCå¸¸è§„è½¯ä»¶" class="headerlink" title="HiCå¸¸è§„è½¯ä»¶"></a>HiCå¸¸è§„è½¯ä»¶</h2><table><thead><tr><th align="left">è½¯ä»¶å</th><th align="left">hiclib</th><th align="left">HiC-Pro</th><th align="left">HICUP</th><th align="left">Juice</th></tr></thead><tbody><tr><td align="left">æ¯”å¯¹è½¯ä»¶</td><td align="left">Bowtie2</td><td align="left">Bowtie2</td><td align="left">Bowtie2</td><td align="left">BWA-mem</td></tr><tr><td align="left">æ¯”å¯¹ç­–ç•¥</td><td align="left">è¿­ä»£æ¯”å¯¹</td><td align="left">å…¨å±€ã€å±€éƒ¨æ¯”å¯¹</td><td align="left">å…ˆæˆªçŸ­åæ¯”å¯¹</td><td align="left">Pair-endï¼ŒåµŒåˆreadsè¿‡æ»¤</td></tr><tr><td align="left">åµŒåˆreadså¤„ç†</td><td align="left">âˆš</td><td align="left">âˆš</td><td align="left">âˆš</td><td align="left">âˆš</td></tr><tr><td align="left">æ„å»ºçŸ©é˜µ</td><td align="left">âˆš</td><td align="left">âˆš</td><td align="left">Ã—</td><td align="left">âˆš</td></tr><tr><td align="left">æ ‡å‡†åŒ–</td><td align="left">ICE</td><td align="left">ICE</td><td align="left">Ã—</td><td align="left">KR</td></tr><tr><td align="left">ç»“æœæ–‡ä»¶</td><td align="left">hdf5ã€hmã€bychr(HDF5)</td><td align="left">SAMã€validpair</td><td align="left">SAM</td><td align="left">SAMã€MNDã€.hic</td></tr><tr><td align="left">ç‰¹ç‚¹</td><td align="left">æ¯”å¯¹ç»“æœå¯é ï¼Œå­˜å‚¨æ¶ˆè€—å°</td><td align="left">ç®€å•æ˜“ç”¨ï¼Œè¾“å‡ºç»“æœå¯è¯»</td><td align="left">è¿‡æ»¤éå¸¸ä¸¥æ ¼</td><td align="left">åç»­åˆ†ææ¥å£å¤šï¼Œjuiceboxå¯è§†åŒ–</td></tr></tbody></table><h1 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h1><p>HiFiåŠ©åŠ›åŒæºå››å€ä½“ç´«èŠ±è‹œè“¿åŸºå› ç»„ç»„è£…ï¼ŒNC</p><blockquote><p>Allele-aware chromosome-level genome assembly and efficient transgene-free genome editing for the autotetraploid cultivated alfalfa</p></blockquote><p>ï¼ˆ1ï¼‰ä½¿ç”¨Canué»˜è®¤å‚æ•°ï¼Œåˆ©ç”¨CCS clean readsç»„è£…contigsã€‚ç»„è£…å¾—åˆ°çš„Contig N50å€¼ä¸º459kbï¼Œæ€»é•¿åº¦ä¸º3.15GBã€‚</p><blockquote><p>We assembled contigs from CCS clean reads using Canu, with default parameters. The N50 values of the contig sets were 459 kb, with total lengths 3154 Mb.</p></blockquote><p>ï¼ˆ2ï¼‰ä½¿ç”¨HiC-Proå°†Hi-C readsä¸contigs è¿›è¡Œæ¯”å¯¹ï¼Œäº§ç”Ÿæ¯”å¯¹BAMæ–‡ä»¶ã€‚</p><blockquote><p>Hi-C reads were aligned to contigs using <a href="https://pubmed.ncbi.nlm.nih.gov/26619908/">HiC-Pro(2015)</a>, yielding an alignment BAM file.</p></blockquote><p>ï¼ˆ3ï¼‰ä½¿ç”¨æ³¨é‡Šçš„è’ºè—œè‹œè“¿è›‹ç™½ä½œä¸ºå‚è€ƒï¼Œå®Œå…¨åŸºäºåŒæºçš„ç­–ç•¥æ³¨é‡Šcontigsã€‚å¯¹138,729ä¸ªåŒæºåŸºå› è¿›è¡Œäº†ç»“æ„æ³¨é‡Šã€‚ç”¨MCscanç”¨äºé‰´å®šcontigså’Œå‚è€ƒåŸºå› ç»„ä¹‹é—´çš„å…±çº¿æ€§ã€‚æ˜¾ç¤ºç´«èŠ±è‹œè“¿å’Œè’ºè—œè‹œè“¿ä¹‹é—´çš„é«˜å…±çº¿æ€§ã€‚ã€ä¸‹è½½çˆ¶æ¯æœ¬petunia refã€‘</p><blockquote><p>Contigs were annotated with a <font color="red"><strong>solely homology-based strategy</strong></font>, using annotated Medicago truncatula proteins as references. 138,729 homologous genes were structurally annotated. <font color="red"><strong>MCscan</strong> in <strong>Jcvi</strong></font> (<a href="https://zenodo.org/record/31631#.XpkUyTOeask">https://zenodo.org/record/31631#.XpkUyTOeask</a>) was used to identify <font color="red"><strong>synteny blocks</strong></font> between <strong>contigs and the reference</strong> genome. <font color="red"><strong>Contigs syntenic</strong> to M. truncatula were <strong>stacked and aligned</strong> to M. truncatula chromosomes</font>. The syntenic contigs are summarized in Supplementary Table 4.</p></blockquote><p><img src="/GeekFocus/2022-03-09-HiFi-5-HiC-Pro/1.png"><br><img src="/GeekFocus/img/2022-03-09-HiFi-5-HiC-Pro/1.png" alt="STable4"></p><p>ï¼ˆ4ï¼‰ä½¿ç”¨å†…éƒ¨è„šæœ¬å¤„ç†BAMæ–‡ä»¶ï¼Œå»é™¤ç­‰ä½åŸºå› contigsä¹‹é—´çš„linksã€‚ä½¿ç”¨ALLHiCè½¯ä»¶ï¼Œ<font color="red">æå–ã€èšç±»å’Œé‡æ’Contigs</font> (Contigs syntenicä¸è’ºè—œè‹œè“¿æŸ“è‰²ä½“ä¸€è‡´)ï¼Œå¾—åˆ°åŸå§‹çš„scaffoldsã€‚</p><blockquote><p>An <strong>in-house script</strong> was used to <font color="red">prune the BAM</font> file and <font color="red">discard links between allelic contigs</font>. Contigs syntenic to one chromosome of M. truncatula, e.g., chr1, were extracted, sub-clustered and reordered using <font color="red">ALLHiC</font>, yielding a raw scaffold set.</p></blockquote><p>ï¼ˆ5ï¼‰<a href="https://pubmed.ncbi.nlm.nih.gov/27467250/">Juicebox</a>ç”¨äºä»¥å›¾å½¢å’Œäº¤äº’æ–¹å¼å¾®è°ƒç»„è£…çš„scaffoldsã€‚å‰ªè£äº†40ä¸ªæ€»é•¿åº¦è¾¾1800Mbçš„scaffolds ã€‚</p><blockquote><p>Juicebox45 was used for fine-tuning assembled scaffolds in a graphic and inter-active fashion. Forty scaffolds with a total length of 1800 Mb were cropped (Supplementary Table 5).</p></blockquote><p><img src="/GeekFocus/2022-03-09-HiFi-5-HiC-Pro/2.png"><br><img src="/GeekFocus/img/2022-03-09-HiFi-5-HiC-Pro/2.png" alt="STable5"></p><p>ï¼ˆ6ï¼‰ åŸºäºç»„è£…çš„scaffoldï¼Œé€šè¿‡Hi-Cæ•°æ®ï¼Œæ¯ä¸ªunplaced contigè¢«åˆ†é…åˆ°äº’ä½œæœ€å¼ºçš„é‚£äº›contig clusteré‡Œã€‚</p><blockquote><p>Based on this scaffold assembly, each unplaced contig was assigned to the contig cluster, to which the contig was most connected by Hi-C data.</p></blockquote><p>ï¼ˆ7ï¼‰ä½¿ç”¨ALLHiCå¯¹é‚£äº›contig clusterså†æ¬¡è¿›è¡Œé‡æ’å’Œæ„å»ºscaffoldã€‚</p><blockquote><p>Those contig clusters were reordered and scaffolded using ALLHiC. </p></blockquote><p>ï¼ˆ8ï¼‰ä½¿ç”¨Juiceboxå¯¹scaffoldsè¿›è¡Œå¾®è°ƒï¼Œå¹¶ä»scaffoldsä¸Šå»é™¤ä¸ä¸€è‡´çš„contigsï¼Œäº§ç”Ÿæœ€ç»ˆçš„æŸ“è‰²ä½“åŸºå› ç»„ï¼Œå…¶åŒ…å«32æ¡æŸ“è‰²ä½“(8ä¸ªåŒæºç»„ï¼Œæ¯ä¸ªç»„ä¸­æœ‰4ä¸ªç­‰ä½åŸºå› æŸ“è‰²ä½“)ï¼Œæ€»é•¿åº¦ä¸º2738Mbï¼Œå’Œ419MbæœªæŒ‚è½½åˆ°æŸ“è‰²ä½“æ°´å¹³çš„åºåˆ—ã€‚</p><blockquote><p>Using Juicebox, scaffolds were fine-tuned and discordant contigs were removed from scaffolds, and the final chromosome assembly was generated, containing 32 chromosomes with a total length of 2738 Mb (Supplementary Table 6).</p></blockquote><p><img src="/GeekFocus/2022-03-09-HiFi-5-HiC-Pro/3.png"><br><img src="/GeekFocus/img/2022-03-09-HiFi-5-HiC-Pro/3.png" alt="STable6"></p><h1 id="HiC-Pro-install"><a href="#HiC-Pro-install" class="headerlink" title="HiC-Pro install"></a>HiC-Pro install</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sh">conda <span class="hljs-built_in">env</span> create -f ./HiC-Pro/environment.yml -p ///software/HiC_Pro_ENV<br><span class="hljs-comment">#ã€install env in my software dirã€‘</span><br>conda activate <span class="hljs-built_in">env</span><br><br>tar -zxvf HiC-Pro-master.tar.gz<br><span class="hljs-built_in">cd</span> HiC-Pro-master<br><span class="hljs-comment">## Edit config-install.txt file if necessary</span><br>make configure<br>make install<span class="hljs-comment"># failed </span><br><span class="hljs-comment">#(g++ -Wall -O2 -std=c++0x -o build_matrix ~/software/HiC-Pro-3.1.0/scripts/src/build_matrix.cpp; mv build_matrix ~/software/HiC-Pro-3.1.0/scripts)</span><br><span class="hljs-comment">#(g++ -Wall -O2 -std=c++0x -o cutsite_trimming ~/software/HiC-Pro-3.1.0/scripts/src/cutsite_trimming.cpp; mv cutsite_trimming ~/software/HiC-Pro-3.1.0/scripts)</span><br><span class="hljs-comment">#cp -Ri ~/software/HiC-Pro-3.1.0 /usr/local/bin//HiC-Pro_3.1.0</span><br><span class="hljs-comment">#cp: cannot create directory â€˜/usr/local/bin//HiC-Pro_3.1.0â€™: Permission denied</span><br><span class="hljs-comment">#make: *** [Makefile:78: cp] Error 1</span><br><br>but <span class="hljs-keyword">in</span> the bin file,it can be use?<br></code></pre></td></tr></table></figure><p>Make configure and make install, whats the function of those two steps?</p><h1 id="HiC-Pro-GitHub"><a href="#HiC-Pro-GitHub" class="headerlink" title="HiC-Pro-GitHub"></a><a href="https://github.com/nservant/HiC-Pro">HiC-Pro-GitHub</a></h1><p><a href="https://doi.org/10.1186/s13059-015-0831-x">Genome Biology 2015</a></p><p>HiC-Pro was designed to process Hi-C data, from <font color="red"><strong>raw fastq files</strong></font> (paired-end Illumina data) to <font color="red"><strong>normalized contact maps</strong></font>. It supports the main Hi-C protocols, including digestion protocols as well as protocols that do not require restriction enzymes such as DNase Hi-C. In practice, HiC-Pro was successfully <font color="blue"><strong>applied to many data-sets</strong></font> including dilution Hi-C, in situ Hi-C, DNase Hi-C, Micro-C, capture-C, capture Hi-C or HiChip data.<br>The pipeline is flexible, scalable and optimized. It can operate either on a single laptop or on a computational cluster. HiC-Pro is sequential and each step of the workflow can be run independantly.<br>HiC-Pro includes a fast implementatation of the iterative correction method (see the <a href="https://github.com/hiclib/iced">iced python package</a> for more information). Finally, HiC-Pro can use phasing data to build <a href="https://github.com/nservant/HiC-Pro/blob/master/doc/AS.md">allele-specific contact maps</a>.</p><h2 id="HiC-Pro-annotation-files"><a href="#HiC-Pro-annotation-files" class="headerlink" title="HiC-Pro annotation files"></a>HiC-Pro annotation files</h2><p>In order to process the raw data, HiC-Pro requires three annotation files. Note that the pipeline is provided with some Human and Mouse annotation files.<br><strong>Please be sure that the chromosome names are the same than the ones used in your bowtie indexes !</strong></p><ul><li><strong>A BED file</strong> of the <font color="blue"><strong>restriction fragments after digestion</strong></font>. This file <font color="blue">depends</font> both of the <font color="blue"><strong>restriction enzyme</strong></font> and the <font color="blue"><strong>reference genome</strong></font>. See the <a href="https://github.com/nservant/HiC-Pro/blob/master/doc/FAQ.md">FAQ</a> and the <a href="https://github.com/nservant/HiC-Pro/blob/master/doc/UTILS.md">HiC-Pro utilities</a> for details about <font color="blue"><strong>how to generate</strong></font> this file. A few annotation files are provided with the HiC-Pro sources as examples. æ ¹æ®é™åˆ¶æ€§å†…åˆ‡é…¶æ¶ˆåŒ–çš„å‚è€ƒåŸºå› ç»„ä¿¡æ¯ .bedæ–‡ä»¶ã€‚é…¶åˆ‡å›¾è°±</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#exampleï¼š/PATH/TO/HiC-Pro_2.11.1/annotation</span><br> <span class="hljs-built_in">head</span> HindIII_resfrag_hg19.bed<br> chr1   0       16007   HIC_chr1_1    0   +<br> chr1   16007   24571   HIC_chr1_2    0   +<br> chr1   24571   27981   HIC_chr1_3    0   +<br> (...)<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#GENOME_FRAGMENT = # å‚¨å­˜æ¶ˆåŒ–ç¢ç‰‡ä½ç½®ä¿¡æ¯çš„bedæ–‡ä»¶ï¼Œä¸€èˆ¬åœ¨HiC-Proçš„annotationæ–‡ä»¶å¤¹ä¸‹</span><br><span class="hljs-comment">#LIGATION_SITE = # é…¶åˆ‡ä½ç‚¹é‡è¿æ¥åçš„åºåˆ—</span><br><span class="hljs-comment">#æ³¨ï¼šGENOME_FRAGMENT å’Œ LIGATION_SITE å®Œå…¨å–å†³äºä½¿ç”¨äº†ä»€ä¹ˆé…¶ï¼Œä¸€èˆ¬HiCå»ºåº“çš„é…¶æ˜¯Hind IIIï¼Œæ‰€ä»¥è¦ä»”ç»†æ£€æŸ¥æ•°æ®æ¥æºçš„è¯´æ˜ã€‚ </span><br>digest_genome.py -r A^AGCTT -o HindIII_resfrag_hg19.bed hg19_rCRSchrm.fa  <br></code></pre></td></tr></table></figure><p>é€šè¿‡è½¯ä»¶è„šæœ¬äº§ç”ŸåŸºå› ç»„é…¶åˆ‡å›¾è°±ï¼Œè¾“å…¥å†…åˆ‡é…¶åç§°æˆ–è€…é…¶åˆ‡ä½ç‚¹åºåˆ—éƒ½å¯ä»¥ï¼Œç”¨æ³•ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">digest_genome.py -r A^AGCTT -o mm9_hindiii.bed mm9.fasta<br>digest_genome.py -r hindiii -o mm9_hindiii.bed mm9.fasta<br></code></pre></td></tr></table></figure><p>NcoIã€BamHIã€EcoRIã€HindIIIã€NdeIã€XhoI, å‚è€ƒï¼š<a href="https://www.biomart.cn/experiment/430/457/741/43956.htm"><font color="red"><strong>å¸¸è§é™åˆ¶æ€§å†…åˆ‡é…¶è¯†åˆ«åºåˆ—(é…¶åˆ‡ä½ç‚¹)</strong></font></a></p><table><thead><tr><th align="left">é™åˆ¶æ€§å†…åˆ‡é…¶</th><th align="left">é…¶åˆ‡ä½ç‚¹ï¼Œ<code>^</code>ä¸ºåˆ‡å‰²ä½ç‚¹</th></tr></thead><tbody><tr><td align="left">MboI</td><td align="left">^GATC</td></tr><tr><td align="left">DpnII</td><td align="left">^GATC</td></tr><tr><td align="left">BglII</td><td align="left">A^GATCT</td></tr><tr><td align="left">HindIII</td><td align="left">A^AGCTT</td></tr></tbody></table><ul><li><strong>A table file</strong> of chromosomesâ€™ size. This file can be easily find on the <font color="blue">UCSC genome browser</font>. Of note, pay attention to the contigs or scaffolds, and be aware that HiC-pro will generate a map per chromosomes pair. For model organisms such as Human or Mouse, which are well annotated, we usually recommand to remove all scaffolds. æŸ“è‰²ä½“å¤§å°çš„è¡¨æ ¼æ–‡ä»¶ã€‚ä»UCSCä¸‹è½½æŸ“è‰²ä½“é•¿åº¦æ–‡ä»¶ï¼Œæˆ–è‡ªå·±æ ¹æ®fastaåºåˆ—ç»Ÿè®¡é•¿åº¦</li></ul><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs dns">#exampleï¼š/PATH/TO/HiC-Pro_2.<span class="hljs-number">11</span>.<span class="hljs-number">1</span>/annotation<br>head chrom_hg19.sizes<br>   chr1    <span class="hljs-number">249250621</span><br>   chr2    <span class="hljs-number">243199373</span><br>   chr3    <span class="hljs-number">198022430</span><br>   chr4    <span class="hljs-number">191154276</span><br>   chr5    <span class="hljs-number">180915260</span><br>   chr6    <span class="hljs-number">171115067</span><br>   chr7    <span class="hljs-number">159138663</span><br>   ...<br></code></pre></td></tr></table></figure><p><font color="green"><strong>how?</strong></font> </p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">samtools</span> faidx genome.fa<br>awk â€˜&#123;<span class="hljs-attribute">print</span> <span class="hljs-variable">$1</span> <span class="hljs-string">&quot;t&quot;</span> <span class="hljs-variable">$2</span>&#125;â€˜ genome.fa.fai &gt; genome_sizes.bed<br></code></pre></td></tr></table></figure><ul><li><p><strong>The bowtie2 indexes</strong>. See the <a href="http://bowtie-bio.sourceforge.net/bowtie2/index.shtml">bowtie2 manual page</a> for details about how to create such indexes.</p></li><li><pre><code class="sh">bowtie2-build hg19.fasta hg19<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><br>## how <span class="hljs-keyword">to</span> use<br><br>```sh<br>  HiC-Pro <span class="hljs-comment">--help</span><br>  <span class="hljs-keyword">usage</span> : HiC-Pro -i <span class="hljs-keyword">INPUT</span> -o OUTPUT -c CONFIG [-s ANALYSIS_STEP] [-p] [-h] [-v]<br>  Use <span class="hljs-keyword">option</span> -h|<span class="hljs-comment">--help for more information</span><br><br>  HiC-Pro <span class="hljs-number">3.1</span><span class="hljs-number">.0</span><br>  <span class="hljs-comment">---------------</span><br>  <span class="hljs-keyword">OPTIONS</span><br><br>   -i|<span class="hljs-comment">--input INPUT : &#x27;input data folder&#x27;; contains a folder per sample with input files</span><br>   -o|<span class="hljs-comment">--output OUTPUT : &#x27;output folder&#x27;</span><br>   -c|<span class="hljs-comment">--conf CONFIG : &#x27;configuration file&#x27; for Hi-C processing</span><br>   [-p|<span class="hljs-comment">--parallel] : if specified run HiC-Pro on a cluster&#x27;?&#x27;</span><br>   [-s|<span class="hljs-comment">--step ANALYSIS_STEP] : run only a subset of the HiC-Pro workflow; &#x27;if not specified the complete workflow is run&#x27;</span><br>      <span class="hljs-keyword">mapping</span>: <span class="hljs-keyword">perform</span> reads <span class="hljs-string">&#x27;alignment&#x27;</span> - require fast files<br>      proc_hic: <span class="hljs-keyword">perform</span> Hi-C <span class="hljs-string">&#x27;filtering&#x27;</span> - require BAM files<br>      quality_checks: run Hi-C <span class="hljs-string">&#x27;quality control&#x27;</span> plots<br>      merge_persample: <span class="hljs-string">&#x27;merge&#x27;</span> multiple inputs <span class="hljs-keyword">and</span> remove duplicates <span class="hljs-keyword">if</span> specified - require .validPairs files<br>      build_contact_maps: <span class="hljs-string">&#x27;Build raw inter/intrachromosomal contact maps&#x27;</span> - require .allValidPairs files<br>      ice_norm : run ICE <span class="hljs-string">&#x27;normalization&#x27;</span> <span class="hljs-keyword">on</span> contact maps - require .matrix files<br>   [-h|<span class="hljs-comment">--help]: help</span><br>   [-v|<span class="hljs-comment">--version]: version</span><br></code></pre></td></tr></table></figure></code></pre></li><li><p><font color="blue"><strong>Copy and edit</strong></font> the configuration file <font color="blue"><strong>â€˜config-hicpro.txtâ€™</strong>Â </font> in your <font color="blue"><strong>local folder</strong></font>. See the <a href="https://github.com/nservant/HiC-Pro/blob/master/doc/MANUAL.md">manual</a> for details about the configuration file</p></li><li><p>Put <font color="blue"><strong>all input files in a rawdata folder</strong></font>. The input files have to be organized with <font color="blue"><strong>one folder per sample</strong></font>, such as;</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh">+ PATH_TO_MY_DATA<br>  + sample1<br>    ++ file1_R1.fastq.gz<br>    ++ file1_R2.fastq.gz<br>    ++ ...<br>  + sample2<br>    ++ file1_R1.fastq.gz<br>    ++ file1_R2.fastq.gz<br>  *...<br></code></pre></td></tr></table></figure><ul><li>Run HiC-Pro on your <font color="blue"><strong>laptop</strong></font> in standalone model</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">MY_INSTALL_PATH/bin/HiC-Pro -i <span class="hljs-string">&#x27;FULL&#x27;</span>_PATH_TO_DATA_FOLDER -o FULL_PATH_TO_OUTPUTS -c MY_LOCAL_CONFIG_FILE<br></code></pre></td></tr></table></figure><ul><li>Run HiC-Pro on a <font color="blue"><strong>cluster</strong></font> (TORQUE&#x2F;SGE&#x2F;SLURM&#x2F;LSF)</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">MY_INSTALL_PATH/bin/HiC-Pro -i FULL_PATH_TO_DATA_FOLDER -o FULL_PATH_TO_OUTPUTS -c MY_LOCAL_CONFIG_FILE -p<br></code></pre></td></tr></table></figure><ul><li>In the latter <font color="blue">case[cluster]</font>, you will have the following message :</li></ul><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stata">Please <span class="hljs-keyword">run</span> HiC-<span class="hljs-keyword">Pro</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">two</span> steps :<br> 1- The following command will launch the parallel workflow through 12 torque jobs:<br> qsub HiCPro_step1.<span class="hljs-keyword">sh</span><br> 2- The second command will <span class="hljs-keyword">merge</span> all outputs to <span class="hljs-keyword">generate</span> the contact maps:<br> qsub HiCPro_step2.<span class="hljs-keyword">sh</span><br></code></pre></td></tr></table></figure><p>Execute the displayed command from the <font color="blue"><strong>output folder</strong></font>:</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-keyword">qsub</span> HiCPro_step1.sh<br></code></pre></td></tr></table></figure><p>Once executed succesfully (may take several hours), run the step using:</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-keyword">qsub</span> HiCPro_step2.sh<br></code></pre></td></tr></table></figure><h2 id="config-editing"><a href="#config-editing" class="headerlink" title="config editing"></a>config editing</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#######################################################################</span><br><span class="hljs-comment">## SYSTEM AND SCHEDULER - Start Editing Here !!</span><br><span class="hljs-comment">#######################################################################</span><br>N_CPU = 2<br>LOGFILE = hicpro.log<br>JOB_NAME =<br>JOB_MEM =<br>JOB_WALLTIME =<br>JOB_QUEUE =<br>JOB_MAIL =<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined">BOWTIE2_IDX_PATH =<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#######################################################################</span><br><span class="hljs-comment">## Digestion Hi-C</span><br><span class="hljs-comment">#######################################################################</span><br>GENOME_FRAGMENT = HindIII_resfrag_hg19.bed<br>LIGATION_SITE = AAGCTAGCTT<br>MIN_FRAG_SIZE =<br>MAX_FRAG_SIZE =<br>MIN_INSERT_SIZE =<br>MAX_INSERT_SIZE =<br>MIN_MAPQ: æœ€ä½çš„è´¨é‡åˆ†æ•°ï¼Œç”¨äºç­›é€‰ï¼Œè¡¨ç¤ºä½äºè¯¥MAPQå€¼ä¼šè¢«è¿‡æ»¤<br>BOWTIE2_IDX_PATH: åŸºå› ç»„bowtie2ç´¢å¼•è·¯å¾„ï¼Œeg:/path/hg19<br>BOWTIE2_GLOBAL_OPTIONS: é»˜è®¤GLOBALæ¯”å¯¹è®¾ç½®<br>BOWTIE2_LOCAL_OPTIONS: é»˜è®¤LOCALæ¯”å¯¹è®¾ç½®<br>REFERENCE_GENOMEï¼š Bowtie2ç´¢å¼•å‰ç¼€<br>GENOME_SIZEï¼š åŸºå› ç»„sizes bedæ–‡ä»¶<br>GENOME_FRAGMENT: åŸºå› ç»„é…¶åˆ‡æ–‡ä»¶,eg. /path/hg19_HindIII.bed<br>LIGATION_SITE: é…¶åˆ‡ä½ç‚¹æœ«ç«¯è¡¥å¹³å†æ¬¡è¿æ¥åå½¢æˆçš„åµŒåˆåºåˆ—ï¼Œeg. AAGCTAGCTT<br>MIN_FRAG_SIZE: æœ€å°çš„ç†è®ºé…¶åˆ‡ç‰‡æ®µå¤§å°,eg. 100<br>MAX_FRAG_SIZE: æœ€å¤§çš„ç†è®ºé…¶åˆ‡ç‰‡æ®µå¤§å°,eg. 100000<br>MIN_INSERT_SIZE: æœ€å°çš„æ–‡åº“ç‰‡æ®µå¤§å°,eg.100<br>MAX_INSERT_SIZE: æœ€å¤§çš„æ–‡åº“ç‰‡æ®µå¤§å°,eg.1000<br><span class="hljs-string">&#x27;BIN_SIZE:éœ€è¦ç”Ÿæˆçš„çŸ©é˜µåˆ†è¾¨ç‡ï¼ˆbp)&#x27;</span><br>MATRIX_FORMATï¼šçŸ©é˜µçš„å½¢å¼ï¼Œupperè¡¨ç¤ºä¿ç•™ä¸ŠåŠéƒ¨åˆ†<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">BOWTIE2_IDX_PATH = <span class="hljs-comment"># bowtie2ç´¢å¼•æ–‡ä»¶ç›®å½•ï¼Œç´¢å¼•æ–‡ä»¶æå‰ä¸‹è½½æˆ–ç”¨bowtie2-buildç”Ÿæˆ</span><br>REFERENCE_GENOME = <span class="hljs-comment"># bowtie2ç´¢å¼•çš„æ–‡ä»¶å</span><br>GENOME_SIZE = <span class="hljs-comment"># æŸ“è‰²ä½“å¤§å°æ–‡ä»¶ï¼Œå¯ä»http://hgdownload.cse.ucsc.edu/goldenPath/ ä¸‹è½½</span><br>GENOME_FRAGMENT = <span class="hljs-comment"># å‚¨å­˜æ¶ˆåŒ–ç¢ç‰‡ä½ç½®ä¿¡æ¯çš„bedæ–‡ä»¶ï¼Œä¸€èˆ¬åœ¨HiC-Proçš„annotationæ–‡ä»¶å¤¹ä¸‹</span><br>LIGATION_SITE = AAGCTAGCTT<span class="hljs-comment"># é…¶åˆ‡ä½ç‚¹é‡è¿æ¥åçš„åºåˆ—</span><br><span class="hljs-comment"># æ³¨ï¼šGENOME_FRAGMENT å’Œ LIGATION_SITE å®Œå…¨å–å†³äºä½¿ç”¨äº†ä»€ä¹ˆé…¶ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯Hind IIIï¼Œæ‰€ä»¥è¦ä»”ç»†æ£€æŸ¥æ•°æ®æ¥æºçš„è¯´æ˜ã€‚ </span><br>PAIR2_EXT = <span class="hljs-comment"># æ ¹æ®æ–‡ä»¶åç§°ï¼Œåˆ†åˆ«è¾“å…¥åŒç«¯æ•°æ®æ–‡ä»¶åç§°ï¼Œä¸ç”¨è¾“å…¥åç¼€</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#???GENOME_SIZE = åœ¨å»ºç«‹çš„ç´¢å¼•ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªtxtæ–‡ä»¶ï¼š</span><br><span class="hljs-built_in">cat</span> &gt;chrom_bacteria.sizes  <span class="hljs-comment">#åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶cat &gt; filenameï¼Œæ–‡ä»¶åæˆ‘æ˜¯å‚è€ƒhicproçš„é…ç½®ç¤ºä¾‹ </span><br>Chromosome 4016942  <span class="hljs-comment">#åœ¨æ–‡ä»¶ä¸­å†™å…¥å†…å®¹ï¼Œè¡¨æ˜è¿™ä¸ªå‚è€ƒåŸºå› çš„å¤§å°æ˜¯4016942bp,1bpå³ä¸º1ä¸ªç¢±åŸºå¯¹ï¼ˆbase pairï¼‰</span><br></code></pre></td></tr></table></figure><h2 id="test"><a href="#test" class="headerlink" title="test"></a>test</h2><p>The test dataset and associated results are available <a href="https://zerkalo.curie.fr/partage/HiC-Pro/">here</a>. Small fastq files (2M reads) extracted from the Dixon et al. 2012 paper are available for test.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">## Get the data. Will download a test_data folder and a configuration file</span><br> wget https://zerkalo.curie.fr/partage/HiC-Pro/HiCPro_testdata.tar.gz &amp;&amp; tar -zxvf HiCPro_testdata.tar.gz<br><br> <span class="hljs-comment">## Edit the configuration file and set the path to Human bowtie2 indexes</span><br><br> <span class="hljs-comment">## Run HiC-Pro</span><br> time HICPRO_INSTALL_DIR/bin/HiC-Pro -c config_test_latest.txt -i test_data -o hicpro_latest_test<br></code></pre></td></tr></table></figure><h1 id="HIC-PROâ€™S-DOC"><a href="#HIC-PROâ€™S-DOC" class="headerlink" title="HIC-PROâ€™S DOC"></a><a href="http://nservant.github.io/HiC-Pro/">HIC-PROâ€™S DOC</a></h1><h1 id="åˆ†æ­¥åŸç†"><a href="#åˆ†æ­¥åŸç†" class="headerlink" title="åˆ†æ­¥åŸç†"></a>åˆ†æ­¥åŸç†</h1><p>refï¼š<a href="https://www.jianshu.com/p/76533e6d6152">https://www.jianshu.com/p/76533e6d6152</a></p><p><img src="/GeekFocus/2022-03-09-HiFi-5-HiC-Pro/4.png" alt="img"><br><img src="/GeekFocus/img/2022-03-09-HiFi-5-HiC-Pro/4.png" alt="img"></p><ul><li><p><font color="red"><strong>æ¯”å¯¹ã€è¿‡æ»¤HiCæ¯”å¯¹ç»“æœã€æ£€æµ‹æœ‰æ•ˆHiCåºåˆ—ã€ç»“æœåˆå¹¶ã€æ„å»ºHiCå…³è”å›¾è°±ã€å…³è”å›¾è°±æ ‡å‡†åŒ–ã€‚</strong></font></p></li><li><p>HiC-Proå¯è¾“å‡ºå„ä¸ªå°ºåº¦çš„HiC<font color="red">æ ‡å‡†åŒ–äº’ä½œå›¾è°±</font>ï¼Œä»æ¯ä¸ª<font color="red">çª—å£5Kbåˆ°1Mb</font>ï¼Œçª—å£è¶Šå¤§ï¼Œç”Ÿæˆäº’ä½œå…³ç³»è¶Šå°‘ï¼Œè®¡ç®—æ—¶é—´å°±è¶Šå°‘ï¼Œåä¹‹è¶Šå¤šã€‚åŒæ—¶HiC-Proèƒ½ä¸ä¸‹æ¸¸å¯è§†åŒ–è½¯ä»¶<font color="red"><strong>HiCPlotter</strong></font>ç­‰å…¼å®¹ï¼Œè¾“å‡ºæ–‡ä»¶å¯ç›´æ¥ç”¨äºå¯è§†åŒ–åˆ†æã€‚</p></li><li><p>HiC-Pro<font color="red">è‡ªåŠ¨åŒ–æ¯”å¯¹ï¼Œæ ‡å‡†åŒ–å’Œæ„å»ºç›¸äº’ä½œç”¨çŸ©é˜µ</font>ï¼Œåœ¨å¤„ç†å¤šæ ·åŒ–çš„æµ‹åºæ•°æ®æ—¶ï¼ŒHiC-Proèƒ½å¤Ÿ<strong>æ£€æµ‹å’Œè‡ªåŠ¨è¿‡æ»¤</strong>æµ‹åºæ•°é‡å·®çš„readså’Œæ— æ•ˆç‰‡æ®µã€‚</p></li></ul><h2 id="1-Reads-Mapping"><a href="#1-Reads-Mapping" class="headerlink" title="1.Reads Mapping"></a>1.Reads Mapping</h2><p>å°†fastqæ–‡ä»¶ç”¨bowtie2 mappingä¸€æ¬¡ï¼ŒæŸ¥çœ‹logï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cat</span> mapping_step1.log<br><span class="hljs-comment">###mapping fastq to reference genome , å°†unmappingçš„read å¦å­˜ä¸º unmap.fastq</span><br>/PATH/TO/bowtie2/bowtie2-2.3.3.1/bowtie2 --very-sensitive -L 30 --score-min L,-0.6,-0.2 --end-to-end --reorder --un bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap.fastq --rg-id BMG --rg SM:SRR400264_00_R2 -p 20 -x /PATH/TO/HiC-Pro_2.11.1/Bowtie2Index/hg19 -U rawdata/dixon_2M/SRR400264_00_R2.fastq.gz 2&gt;&gt; logs/dixon_2M/SRR400264_00_R2_bowtie2.<span class="hljs-built_in">log</span>| /PATH/TO/samtools/samtools-1.6/bin/samtools view -F 4 -bS - &gt; bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.bam<br><br>/PATH/TO/bowtie2/bowtie2-2.3.3.1/bowtie2 --very-sensitive -L 30 --score-min L,-0.6,-0.2 --end-to-end --reorder --un bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap.fastq --rg-id BMG --rg SM:SRR400264_00_R1 -p 20 -x /PATH/TO/HiC-Pro_2.11.1/Bowtie2Index/hg19 -U rawdata/dixon_2M/SRR400264_00_R1.fastq.gz 2&gt;&gt; logs/dixon_2M/SRR400264_00_R1_bowtie2.<span class="hljs-built_in">log</span>| /PATH/TO/samtools/samtools-1.6/bin/samtools view -F 4 -bS - &gt; bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.bam<br></code></pre></td></tr></table></figure><p>ç»“æœæ–‡ä»¶</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh">|   |-- bwt2_global<br>|   |   |-- dixon_2M<br>|   |   |   |-- SRR400264_00_R1_hg19.bwt2glob.bam<br>|   |   |   |-- SRR400264_00_R1_hg19.bwt2glob.unmap.fastq<br>|   |   |   |-- SRR400264_00_R2_hg19.bwt2glob.bam<br>|   |   |   |-- SRR400264_00_R2_hg19.bwt2glob.unmap.fastq<br>|   |   `-- dixon_2M_2<br>|   |       |-- SRR400264_01_R1_hg19.bwt2glob.bam<br>|   |       |-- SRR400264_01_R1_hg19.bwt2glob.unmap.fastq<br>|   |       |-- SRR400264_01_R2_hg19.bwt2glob.bam<br>|   |       |-- SRR400264_01_R2_hg19.bwt2glob.unmap.fastq<br></code></pre></td></tr></table></figure><p>æœ‰mappingå’Œunmappingã€‚å› ä¸ºreadæ˜¯åµŒåˆåŸºå› ã€‚mappingä¸Šçš„æ˜¯èƒŒæ™¯åŸºå› ç»„ã€‚<font color="blue">unmappingéœ€è¦ä¸‹ä¸€æ­¥å¤„ç†</font>ã€‚</p><h2 id="2-ç‰‡æ®µåˆ†é…å’Œè¿‡æ»¤"><a href="#2-ç‰‡æ®µåˆ†é…å’Œè¿‡æ»¤" class="headerlink" title="2. ç‰‡æ®µåˆ†é…å’Œè¿‡æ»¤"></a>2. ç‰‡æ®µåˆ†é…å’Œè¿‡æ»¤</h2><p>æŸ¥çœ‹log</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cat</span> mapping_step2.log<br><span class="hljs-comment">### é…¶åˆ‡</span><br>/PATH/TO/HiC-Pro/HiC-Pro_2.11.1/scripts/cutsite_trimming --fastq bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap.fastq --cutsite AAGCTAGCTT --out bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap_trimmed.fastq &gt; logs/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap_readsTrimming.<span class="hljs-built_in">log</span> 2&gt;&amp;1<br>/PATH/TO/HiC-Pro/HiC-Pro_2.11.1/scripts/cutsite_trimming --fastq bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap.fastq --cutsite AAGCTAGCTT --out bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap_trimmed.fastq &gt; logs/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap_readsTrimming.<span class="hljs-built_in">log</span> 2&gt;&amp;1<br><span class="hljs-comment">### å†ç”¨bowtie2 mappingä¸€æ¬¡</span><br>/PATH/TO/bowtie2/bowtie2-2.3.3.1/bowtie2 --very-sensitive -L 20 --score-min L,-0.6,-0.2 --end-to-end --reorder --rg-id BML --rg SM:SRR400264_00_R1_hg19.bwt2glob.unmap -p 20 -x /PATH/TO/HiC-Pro/HiC-Pro_2.11.1/Bowtie2Index/hg19 -U bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap_trimmed.fastq 2&gt;&gt; logs/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap_bowtie2.log | /PATH/TO/samtools/samtools-1.6/bin/samtools view -bS - &gt; bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap_bwt2loc.bam<br>/PATH/TO/bowtie2/bowtie2-2.3.3.1/bowtie2 --very-sensitive -L 20 --score-min L,-0.6,-0.2 --end-to-end --reorder --rg-id BML --rg SM:SRR400264_00_R2_hg19.bwt2glob.unmap -p 20 -x /PATH/TO/HiC-Pro/HiC-Pro_2.11.1/Bowtie2Index/hg19 -U bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap_trimmed.fastq 2&gt;&gt; logs/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap_bowtie2.log | /PATH/TO/samtools/samtools-1.6/bin/samtools view -bS - &gt; bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap_bwt2loc.bam<br></code></pre></td></tr></table></figure><p>è¿™ä¸€æ­¥å°†unmappingç»“æœï¼Œç”¨é…¶åˆ‡ä½ç‚¹åˆ†å‰²ï¼Œç„¶åå°†åˆ†å‰²ç»“æœï¼Œå†mappingä¸€æ¬¡ã€‚å¾—åˆ°ç»“æœ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh">|   |-- bwt2_local<br>|       |-- dixon_2M<br>|       |   |-- SRR400264_00_R1_hg19.bwt2glob.unmap_bwt2loc.bam<br>|       |   |-- SRR400264_00_R1_hg19.bwt2glob.unmap_trimmed.fastq<br>|       |   |-- SRR400264_00_R2_hg19.bwt2glob.unmap_bwt2loc.bam<br>|       |   |-- SRR400264_00_R2_hg19.bwt2glob.unmap_trimmed.fastq<br>|       |-- dixon_2M_2<br>|           |-- SRR400264_01_R1_hg19.bwt2glob.unmap_bwt2loc.bam<br>|           |-- SRR400264_01_R1_hg19.bwt2glob.unmap_trimmed.fastq<br>|           |-- SRR400264_01_R2_hg19.bwt2glob.unmap_bwt2loc.bam<br>|           |-- SRR400264_01_R2_hg19.bwt2glob.unmap_trimmed.fastq<br></code></pre></td></tr></table></figure><h2 id="3-mapping-combine-log"><a href="#3-mapping-combine-log" class="headerlink" title="3. mapping_combine.log"></a>3. mapping_combine.log</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cat</span> mapping_combine.log<br><br><span class="hljs-comment">### å°†globalçš„bamä¸localçš„bamç”¨samtools merge</span><br>/PATH/TO/samtools/samtools-1.6/bin/samtools merge -@ 20 -n -f bowtie_results/bwt2/dixon_2M/SRR400264_00_R1_hg19.bwt2merged.bam bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.bam bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap_bwt2loc.bam<br>/PATH/TO/samtools/samtools-1.6/bin/samtools merge -@ 20 -n -f bowtie_results/bwt2/dixon_2M/SRR400264_00_R2_hg19.bwt2merged.bam bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.bam bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap_bwt2loc.bam<br><br><span class="hljs-comment">### sort</span><br>/PATH/TO/samtools/samtools-1.6/bin/samtools <span class="hljs-built_in">sort</span> -@ 20 -n -T tmp/SRR400264_00_R2_hg19 -o bowtie_results/bwt2/dixon_2M/SRR400264_00_R2_hg19.bwt2merged.sorted.bam bowtie_results/bwt2/dixon_2M/SRR400264_00_R2_hg19.bwt2merged.bam<br>/PATH/TO/samtools/samtools-1.6/bin/samtools <span class="hljs-built_in">sort</span> -@ 20 -n -T tmp/SRR400264_00_R1_hg19 -o bowtie_results/bwt2/dixon_2M/SRR400264_00_R1_hg19.bwt2merged.sorted.bam bowtie_results/bwt2/dixon_2M/SRR400264_00_R1_hg19.bwt2merged.bam<br><br>[bam_sort_core] merging from 0 files and 20 in-memory blocks...<br>[bam_sort_core] merging from 0 files and 20 in-memory blocks...<br><br><span class="hljs-comment">### æ”¹å</span><br><span class="hljs-built_in">mv</span> bowtie_results/bwt2/dixon_2M/SRR400264_00_R1_hg19.bwt2merged.sorted.bam bowtie_results/bwt2/dixon_2M/SRR400264_00_R1_hg19.bwt2merged.bam<br><span class="hljs-built_in">mv</span> bowtie_results/bwt2/dixon_2M/SRR400264_00_R2_hg19.bwt2merged.sorted.bam bowtie_results/bwt2/dixon_2M/SRR400264_00_R2_hg19.bwt2merged.bam<br></code></pre></td></tr></table></figure><h2 id="4ã€merge"><a href="#4ã€merge" class="headerlink" title="4ã€merge"></a>4ã€merge</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">### å°†R1ä¸R2 mergeä¸ºä¸€ä¸ªæ–‡ä»¶ã€‚</span><br><span class="hljs-built_in">cat</span> mergeSAM.<span class="hljs-built_in">log</span><br>/PATH/TO/python/python-2.7.10/bin/python /PATH/TO/HiC-Pro/HiC-Pro_2.11.1/scripts/mergeSAM.py -q 0 -t -v -f bowtie_results/bwt2/dixon_2M/SRR400264_00_R1_hg19.bwt2merged.bam -r bowtie_results/bwt2/dixon_2M/SRR400264_00_R2_hg19.bwt2merged.bam -o bowtie_results/bwt2/dixon_2M/SRR400264_00_hg19.bwt2pairs.bam<br><span class="hljs-comment">## mergeBAM.py</span><br><span class="hljs-comment">## forward= bowtie_results/bwt2/dixon_2M/SRR400264_00_R1_hg19.bwt2merged.bam</span><br><span class="hljs-comment">## reverse= bowtie_results/bwt2/dixon_2M/SRR400264_00_R2_hg19.bwt2merged.bam</span><br><span class="hljs-comment">## output= bowtie_results/bwt2/dixon_2M/SRR400264_00_hg19.bwt2pairs.bam</span><br><span class="hljs-comment">## min mapq= 0</span><br><span class="hljs-comment">## report_single= False</span><br><span class="hljs-comment">## report_multi= False</span><br><span class="hljs-comment">## verbose= True</span><br><span class="hljs-comment">## Merging forward and reverse tags ...</span><br></code></pre></td></tr></table></figure><h2 id="5ã€åˆ©ç”¨HiCProçš„mapped-2hic-fragments-pyç¨‹åºå°†æ¯”å¯¹ç»“æœè½¬åŒ–ä¸ºHi-Cç‰‡æ®µä¿¡æ¯"><a href="#5ã€åˆ©ç”¨HiCProçš„mapped-2hic-fragments-pyç¨‹åºå°†æ¯”å¯¹ç»“æœè½¬åŒ–ä¸ºHi-Cç‰‡æ®µä¿¡æ¯" class="headerlink" title="5ã€åˆ©ç”¨HiCProçš„mapped_2hic_fragments.pyç¨‹åºå°†æ¯”å¯¹ç»“æœè½¬åŒ–ä¸ºHi-Cç‰‡æ®µä¿¡æ¯"></a>5ã€åˆ©ç”¨HiCProçš„mapped_2hic_fragments.pyç¨‹åºå°†æ¯”å¯¹ç»“æœè½¬åŒ–ä¸ºHi-Cç‰‡æ®µä¿¡æ¯</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> mapped_2hic_fragments.log<br>/PATH/TO/python /PATH/TO/HiC-Pro/HiC-Pro_2.11.1/scripts/mapped_2hic_fragments.py -v -S -t 100 -m 100000 -s 100 -l 600 -a -f /PATH/TO/HiC-Pro_2.11.1/annotation/HindIII_resfrag_hg19.bed -r bowtie_results/bwt2/dixon_2M/SRR400264_00_hg19.bwt2pairs.bam -o hic_results/data/dixon_2M<br><span class="hljs-comment">## overlapMapped2HiCFragments.py</span><br><span class="hljs-comment">## mappedReadsFile= bowtie_results/bwt2/dixon_2M/SRR400264_00_hg19.bwt2pairs.bam</span><br><span class="hljs-comment">## fragmentFile= /PATH/TO/HiC-Pro/HiC-Pro_2.11.1/annotation/HindIII_resfrag_hg19.bed</span><br><span class="hljs-comment">## minInsertSize= 100</span><br><span class="hljs-comment">## maxInsertSize= 600</span><br><span class="hljs-comment">## minFragSize= 100</span><br><span class="hljs-comment">## maxFragSize= 100000</span><br><span class="hljs-comment">## allOuput= True</span><br><span class="hljs-comment">## SAM ouput= True</span><br><span class="hljs-comment">## verbose= True</span><br></code></pre></td></tr></table></figure><p>å†å¯¹è¾“å‡ºçš„valid pairsæ–‡ä»¶æ’åºï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">LANG=en; <span class="hljs-built_in">sort</span> -T tmp -k2,2V -k3,3n -k5,5V -k6,6n -o hic_results/data/sample/sample_sample_genome_ref.bwt2pairs.validPairs hic_results/data/sample/sample_sample_genome_ref.bwt2pairs.validPairs<br></code></pre></td></tr></table></figure><h2 id="6-å¯¹æ‰€æœ‰çš„valid-pairsè¿›è¡Œåˆå¹¶"><a href="#6-å¯¹æ‰€æœ‰çš„valid-pairsè¿›è¡Œåˆå¹¶" class="headerlink" title="6 å¯¹æ‰€æœ‰çš„valid pairsè¿›è¡Œåˆå¹¶"></a>6 å¯¹æ‰€æœ‰çš„valid pairsè¿›è¡Œåˆå¹¶</h2><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart">LANG=en; sort -T tmp -S <span class="hljs-number">50</span>% -k2,<span class="hljs-number">2</span>V -k3,<span class="hljs-number">3</span>n -k5,<span class="hljs-number">5</span>V -k6,<span class="hljs-number">6</span>n -m hic_results/data/dixon_2M_2/SRR400264_01_hg19.bwt2pairs.validPairs | awk -F<span class="hljs-string">&quot;\t&quot;</span> <span class="hljs-string">&#x27;BEGIN&#123;c1=0;c2=0;s1=0;s2=0&#125;(c1!=<span class="hljs-subst">$2</span> || c2!=<span class="hljs-subst">$5</span> || s1!=<span class="hljs-subst">$3</span> || s2!=<span class="hljs-subst">$6</span>)&#123;print;c1=<span class="hljs-subst">$2</span>;c2=<span class="hljs-subst">$5</span>;s1=<span class="hljs-subst">$3</span>;s2=<span class="hljs-subst">$6</span>&#125;&#x27;</span> &gt; hic_results/data/dixon_2M_2/dixon_2M_2.allValidPairs<br></code></pre></td></tr></table></figure><p>ç”Ÿæˆæœ€ç»ˆæ–‡ä»¶dixon_2M_2.allValidPairsã€‚</p><p>è¿™ä¸ªæ–‡ä»¶è¿˜ä¸èƒ½å¯è§†åŒ–ï¼Œå¦‚æœè¦å¯è§†åŒ–ï¼Œä¸€èˆ¬åœ¨juceboxé‡Œé¢æŸ¥çœ‹ã€‚éœ€è¦ç”¨é…å¥—çš„hicpro2juicebox.shæ¥è½¬åŒ–ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">## e.g.1</span><br>HICPRO_PATH/bin/utils/hicpro2juicebox.sh -i hicpro_res/hic_results/data/dixon_2M/dixon_2M_allValidPairs -g hg19 -j /usr/local/juicebox/juicebox_clt_1.4.jar<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">-j jar<br>/PATH/TO/juicer/juicer/UGER/scripts/juicer_tools.jar<br></code></pre></td></tr></table></figure><h1 id="HiC-Pro-è¾“å‡º"><a href="#HiC-Pro-è¾“å‡º" class="headerlink" title="HiC-Pro è¾“å‡º"></a>HiC-Pro è¾“å‡º</h1><p>å…±æœ‰<strong>bowtie_results</strong>å’Œ<strong>hic_results</strong>ä¸¤ä¸ªç»“æœæ–‡ä»¶å¤¹ã€‚</p><p>å…¶ä¸­<strong>bowtie_results</strong>ä¸‹ä¸‰ä¸ªæ–‡ä»¶å¤¹ï¼šbwt2ã€bwt2_globalå’Œbwt2_localï¼Œåˆ†åˆ«æ˜¯åºåˆ—æ¯”å¯¹ç»“æœã€<font color="blue">æŸ“è‰²ä½“é—´</font>å…³è”æ¯”å¯¹ç»“æœå’Œ<font color="blue">æŸ“è‰²ä½“å†…</font>éƒ¨å…³è”æ¯”å¯¹ç»“æœã€‚bwt2æ–‡ä»¶å¤¹æœ‰æ•°æ®ç»Ÿè®¡ç»“æœè¾“å‡ºæ–‡ä»¶ï¼Œå¦‚mpairstatæ–‡ä»¶ã€‚</p><p><strong>hic_results</strong>æ–‡ä»¶å¤¹ä¸‹å…±æœ‰dataã€matrixä»¥åŠpicä¸‰ä¸ªæ–‡ä»¶å¤¹ã€‚</p><ul><li><p>dataæ–‡ä»¶å¤¹ä¸‹æ˜¯æ¯”å¯¹ä¸Šçš„æœ‰æ•ˆåºåˆ—å¯¹ï¼Œæ–‡ä»¶æœ«å°¾ä¸º_allValidPairsåˆå¹¶åçš„pairsæ•°æ®</p><p><code>DEPairs</code>:Dangling end pairsæ•°æ®</p><p><code>DumpPairs</code>:å®é™…ç‰‡æ®µé•¿åº¦å’Œç†è®ºç‰‡æ®µé•¿åº¦ä¸åŒçš„æ•°æ®</p><p><code>REPairs</code>ï¼šé…¶åˆ‡ç‰‡æ®µé‡æ–°è¿æ¥çš„pairs</p><p><code>FiltePairs</code>:MAPQè¿‡ä½çš„pairs</p><p><code>SCPairs</code>ï¼šç‰‡æ®µè‡ªè¿çš„pairs</p></li><li><p>picæ–‡ä»¶å¤¹ä¸‹æ˜¯å„ç±»ç»“æœæ•°æ®ç»Ÿè®¡ï¼›å­˜æ”¾ç»Ÿè®¡åˆ†æå›¾ç‰‡</p><p>HiCæ–‡åº“ç‰‡æ®µåˆ†å¸ƒæ–‡ä»¶</p><p>åŒç«¯æ¯”å¯¹è¿‡æ»¤è´¨æ§å›¾</p><p>æœ‰æ•ˆæ•°æ®è¿‡æ»¤è´¨æ§å›¾</p><p>é…å¯¹æ•°æ®ä¸åŒç±»å‹æ•°æ®æ¯”ä¾‹å±•ç¤ºå›¾</p></li><li><p>matrixæ–‡ä»¶å¤¹ä¸‹åˆ†ä¸º iced(æ ‡å‡†åŒ–) å’Œ raw(åŸå§‹) ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«æ ‡å‡†åŒ–åçš„å…³è”çŸ©é˜µå’Œåˆå§‹çš„å…³è”çŸ©é˜µã€‚å­˜æ”¾ä¸åŒåˆ†è¾¨ç‡çŸ©é˜µæ–‡ä»¶</p></li></ul><p>åç»­compartmentï¼ŒTADå’Œloopï¼Ÿ</p><h1 id="å¯è§†åŒ–"><a href="#å¯è§†åŒ–" class="headerlink" title="å¯è§†åŒ–"></a>å¯è§†åŒ–</h1><p><a href="https://mp.weixin.qq.com/s?__biz=MzUyMTk4ODM0OQ==&mid=2247483678&idx=1&sn=a1aa97892723f6fb51bd3b01a6441e6c&chksm=f9d3f08ccea4799af0a4401e938307a3f6e860239e905deb6963a82a8fc799a4af504e96bc10&scene=178&cur_album_id=1399424041152528385#rd">å¾®ä¿¡å…¬ä¼—å·</a></p><p><a href="https://weixin.sogou.com/weixin?type=2&query=%E6%9F%93%E8%89%B2%E8%B4%A8%E9%AB%98%E7%BA%A7%E7%BB%93%E6%9E%84%E7%A0%94%E7%A9%B6%E4%B9%8BHi-C%E6%8A%80%E6%9C%AF%EF%BC%88%E4%B8%8B%E7%AF%87%EF%BC%89%E2%80%94%E2%80%94%E5%8F%AF%E8%A7%86%E5%8C%96%E5%AE%9E%E6%88%98&ie=utf8&s_from=input&_sug_=n&_sug_type_=&w=01019900&sut=935&sst0=1646835948011&lkt=2,1646835946980,1646835947908">æŸ“è‰²è´¨é«˜çº§ç»“æ„ç ”ç©¶ä¹‹Hi-CæŠ€æœ¯ï¼ˆä¸‹ç¯‡ï¼‰â€”â€”å¯è§†åŒ–å®æˆ˜</a></p><h1 id="Error-debug"><a href="#Error-debug" class="headerlink" title="Error debug"></a>Error debug</h1><blockquote><p>HIC-PRO DOES NOT GENERATE ANY MAPS<br>HiC-Pro is using the chrom.sizes files to build the map.<br>Be sure that your chromosome names are the same in all annotations files (bowtie2 indexes, restriction fragments, chromosome sizes, etc.)</p></blockquote><blockquote><p>hiclib and mirnylib are not compatible with python 2.5 and 3.x, but work fine with py 2.6, 2.7</p><p>hiclibä¸»è¦ç”¨äºæ•°æ®æ ‡å‡†åŒ–ï¼Œhicproå¯ä»¥ï¼Œä¸ºä»€ä¹ˆè¿˜è¦å®‰è£…hiclib? æˆ–è€…æ˜¯æƒ³æ¯”è¾ƒä¸¤è€…åˆ†æçš„ç»“æœï¼Ÿ</p><p>HiC-Proéœ€è¦pythonç‰ˆæœ¬&gt;&#x3D;3.7, å®‰è£…3.9</p></blockquote><p><strong>Error1</strong>ï¼šdirectly use hicpro on the cluster,  â€”qual å¤šä¸€ä¸ª-æ— æ³•è§£å†³ï¼Œè‡ªå·±å®‰è£…<br>&#x2F;software&#x2F;biosoft&#x2F;software&#x2F;bowtie2-2.2.9&#x2F;bowtie2-align-s: <font color="red"><strong>unrecognized option â€˜â€”qualsâ€™</strong></font><br>Bowtie 2 version 2.2.9 by Ben Langmead (<a href="mailto:&#108;&#97;&#x6e;&#x67;&#109;&#101;&#x61;&#64;&#x63;&#115;&#x2e;&#x6a;&#104;&#x75;&#x2e;&#101;&#100;&#117;">&#108;&#97;&#x6e;&#x67;&#109;&#101;&#x61;&#64;&#x63;&#115;&#x2e;&#x6a;&#104;&#x75;&#x2e;&#101;&#100;&#117;</a>, <a href="http://www.cs.jhu.edu/~langmea">www.cs.jhu.edu/~langmea</a>)<br>Usage:<br>  bowtie2 [options]* -x <bt2-idx> {-1 <m1> -2 <m2> | -U <r>} [-S <sam>]</p><p>Encountered internal Bowtie 2 exception (#1)<br>Command: &#x2F;software&#x2F;biosoft&#x2F;software&#x2F;bowtie2-2.2.9&#x2F;bowtie2-align-s â€“wrapper basic-0 â€“very-sensitive -L 30 â€“score-min L,-0.6,-0.2 â€“end-to-end â€“reorder â€“rg-id BMG â€“rg SM:L3_R1 <font color="red"><strong>â€”quals</strong></font> -p 10 -x ~&#x2F;02.bwa_mapping&#x2F;primary&#x2F;&#x2F;HiFi.p_ctg â€“passthrough -U &#x2F;tmp&#x2F;34683.unp<br>(ERR): bowtie2-align exited with value 1</p><p>è‡ªå·±å®‰è£…æ—¶ï¼Œå…ˆåˆ›å»ºcondaç¯å¢ƒï¼Œå†tar xzvfï¼Œç„¶å<font color="red"><strong>ç¼–è¾‘config-install.txtçš„prefix å†make configure &amp;&amp; make install</strong></font><br><strong>Error2</strong>åœ¨é”™è¯¯äº§ç”Ÿoutputæ–‡ä»¶å¤¹æ—¶å†æ¬¡è¿è¡Œç›´æ¥æŠ¥é”™stat: <font color="red"><strong>Bad file descriptorï¼Œå…ˆåˆ é™¤output_dir</strong></font><br>è®¾ç½®config-install.txt çš„prefixæ—¶è®¾ç½®æˆ&#x2F;&#x2F;&#x2F;software&#x2F;HiC-Pro<font color="red"><strong>&#x2F;</strong></font><br>æŠ¥é”™ï¼š<br><strong>Error3</strong>ï¼šinstall in another dir HiC-Proï¼Œ PREFIX &#x3D; <del>&#x2F;software&#x2F;HiC-Pro&#x2F;<br>~&#x2F;software&#x2F;HiC-Pro&#x2F;HiC-Pro-3.1.0&#x2F;bin&#x2F;..&#x2F;scripts&#x2F;&#x2F;Makefile:48: ~&#x2F;software&#x2F;HiC-Pro<font color="red"><strong>&#x2F;&#x2F;</strong></font>config-system.txt: No such file or directory<br>make:  No rule to make target â€˜</del>&#x2F;software&#x2F;HiC-Pro<font color="red"><strong>&#x2F;&#x2F;</strong></font>config-system.txtâ€™.  Stop.<br>The config-system.txt file is a file which should be within the installation folder.<br>æ£€æŸ¥config-system.txt å‘ç°å¤šäº†&#x2F;&#x2F;<br>è®¾ç½®config-install.txt çš„prefixæ—¶è®¾ç½®æˆ&#x2F;&#x2F;&#x2F;software&#x2F;HiC-Proæ—¶ä¼š<font color="red"><strong>è‡ªåŠ¨äº§ç”Ÿè½¯ä»¶åæ–‡ä»¶å¤¹</strong></font>ï¼Œåé¢<font color="red">å¤šåŠ æ–œæ &#x2F;ç›´æ¥æŠ¥é”™</font></p><p><strong>successfully installed</strong>  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs sh">(HiC_Pro_ENV) [HiC-Pro-3.1.0]$ vi config-install.txt <br>PREFIX = ////software<br>(HiC_Pro_ENV) [HiC-Pro-3.1.0]$ make configure<br>make -f ./scripts/install/Makefile CONFIG_SYS=./config-install.txt<br>make[1]: Entering directory <span class="hljs-string">&#x27;~/HiC-Pro-3.1.0&#x27;</span><br>./scripts/install/install_dependencies.sh -c ./config-install.txt -p ~/software -o ~/software/HiC-Pro_3.1.0 -q<br>Make sure internet connection works <span class="hljs-keyword">for</span> your shell prompt under current user<span class="hljs-string">&#x27;s privilege ...</span><br><span class="hljs-string">Starting HiC-Pro installation !</span><br><span class="hljs-string">Checking dependencies</span><br><span class="hljs-string">- Python libraries ...OK</span><br><span class="hljs-string">- R installation ...OK</span><br><span class="hljs-string">- Bowtie2 installation ...OK</span><br><span class="hljs-string">- Samtools installation ...OK</span><br><span class="hljs-string">Checking HiC-Pro configuration</span><br><span class="hljs-string">- Configuration for TORQUE/PBS system ...OK</span><br><span class="hljs-string">done !</span><br><span class="hljs-string">make[1]: Leaving directory &#x27;</span>~/HiC-Pro-3.1.0<span class="hljs-string">&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">(/HiC_Pro_ENV) [HiC-Pro-3.1.0]$ make install</span><br><span class="hljs-string">(g++ -Wall -O2 -std=c++0x -o build_matrix ~/HiC-Pro-3.1.0/scripts/src/build_matrix.cpp; mv build_matrix ~/HiC-Pro-3.1.0/scripts)</span><br><span class="hljs-string">(g++ -Wall -O2 -std=c++0x -o cutsite_trimming ~/HiC-Pro-3.1.0/scripts/src/cutsite_trimming.cpp; mv cutsite_trimming ~/HiC-Pro-3.1.0/scripts)</span><br><span class="hljs-string">cp -Ri ~/HiC-Pro-3.1.0 ~/software/HiC-Pro_3.1.0</span><br><span class="hljs-string">HiC-Pro installed in ~/software/HiC-Pro_3.1.0 !</span><br></code></pre></td></tr></table></figure><p>Issue from: <a href="https://github.com/nservant/HiC-Pro/issues/289">https://github.com/nservant/HiC-Pro/issues/289</a></p><blockquote><p>you <font color="green"><strong>do not have the rigths</strong></font> to install HiC-Pro in <font color="green"><strong>&#x2F;usr&#x2F;local&#x2F;bin</strong></font><br>Update the <font color="green"><strong>PREFIX&#x3D; in the config-install.txt</strong></font> file before running the installation</p><p>You <font color="green"><strong>cannot install it in the path where you have downloaded it</strong> </font>!Please <font color="green"><strong>set another prefix</strong></font>.Note that it will <font color="green"><strong>create the HiC-Pro_3.0.0 folder by itself</strong></font></p></blockquote><p><font color="red"><strong>NOTICE</strong></font></p><ul><li>.&#x2F;configure â€“prefix&#x3D;  &amp;&amp;  make  &amp;&amp;  make install</li><li>Vim config-install.txt PREFIX  &amp;&amp;  make configure  &amp;&amp;  make install</li></ul><hr><p><strong>bowtie_pairing] Error 1</strong><br><a href="https://github.com/nservant/HiC-Pro/issues/482">https://github.com/nservant/HiC-Pro/issues/482</a></p><p>Thu Sep 23 04:23:58 CST 2021<br>Pairing of R1 and R2 tags â€¦<br>Logs: logs&#x2F;sample1&#x2F;mergeSAM.log<br>make: *** [bowtie_pairing] Error 1</p><p>the mergeSAM.log<br>~&#x2F;miniconda3&#x2F;envs&#x2F;hic-pro_env&#x2F;bin&#x2F;python ~&#x2F;02_software&#x2F;hic-pro&#x2F;HiC-Pro-3.1.0&#x2F;scripts&#x2F;mergeSAM.py -q 10 -t -v -f bowtie_results&#x2F;bwt2&#x2F;sample1&#x2F;XB_R1_merged_canu_asm.fasta.bwt2merged.bam -r bowtie_results&#x2F;bwt2&#x2F;sample1&#x2F;XB_R2_merged_canu_asm.fasta.bwt2merged.bam -o bowtie_results&#x2F;bwt2&#x2F;sample1&#x2F;XB_merged_canu_asm.fasta.bwt2pairs.bam<br>[E::idx_find_and_load] Could not retrieve index file for â€˜bowtie_results&#x2F;bwt2&#x2F;sample1&#x2F;XB_R1_merged_canu_asm.fasta.bwt2merged.bamâ€™<br>[E::idx_find_and_load] Could not retrieve index file for â€˜bowtie_results&#x2F;bwt2&#x2F;sample1&#x2F;XB_R2_merged_canu_asm.fasta.bwt2merged.bamâ€™</p><p>mapping_combine.log:<br>[bam_sort_core] merging from 6120 files and 36 in-memory blocksâ€¦<br>[E::hts_open_format] Failed to open file â€œtmp&#x2F;XB_R1_merged_canu_asm.fasta.1018.bamâ€ : Too many open files<br>samtools sort: fail to open â€œtmp&#x2F;XB_R1_merged_canu_asm.fasta.1018.bamâ€: Too many open files</p><p>yes well done ! So the samtools sort failed.<br>If you look at your command, -@ 36 -m 21M, means that it only has 21Mo to sort the file which is too few.<br>So it has to swap a lot, and generate too many tmp files.<br>This memory parameter is in your configuration file SORT_RAM. By default, it is set to 768M</p><p>Actually, the SORT_RAM parameter is divided by the number of CPUs<br>For instance, using 1000M with 4 CPUs means that samtools sort is run with 250M of RAM.<br>So it makes sense â€¦ you have 1000M &#x2F; 36 CPU &#x3D; 27M of RAM.<br>I would suggest to decrease the number of CPU to 8 for instance â€¦ this is enough ! or to increase again the SORT_RAM parameter.</p><hr><p>ref</p><p><a href="https://www.plob.org/article/24873.html">https://www.plob.org/article/24873.html</a></p><p><a href="https://lxz9.com/2021/08/05/ALLHIC/">https://lxz9.com/2021/08/05/ALLHIC/</a> ALLHiC</p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Linuxé›†ç¾¤ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿã€‘ã€LSF/SGE/Slurm/PBSã€‘ã€gridã€‘</title>
    <link href="/GeekFocus/2022/03/06/2022-03-06-Linux-grid/"/>
    <url>/GeekFocus/2022/03/06/2022-03-06-Linux-grid/</url>
    
    <content type="html"><![CDATA[<p>è°ƒåº¦å™¨ä¸»è¦æ˜¯åŸºäº<strong>HPCåœºæ™¯</strong>çš„<strong>é›†ç¾¤ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ</strong>ï¼Œè‹±æ–‡<strong>Cluster Scheduler</strong>ã€<strong>Job Scheduler</strong>ç­‰ã€‚</p><p>å¸‚é¢ä¸»æµè°ƒåº¦å™¨æœ‰å››å¤§æµæ´¾ï¼š<font color="red"><strong>LSF   SGE   Slurm   PBS</strong></font></p><span id="more"></span><h1 id="ä»Cluster-é›†ç¾¤-ã€Grid-ç½‘æ ¼-åˆ°-Cloud-ï¼ˆäº‘ï¼‰"><a href="#ä»Cluster-é›†ç¾¤-ã€Grid-ç½‘æ ¼-åˆ°-Cloud-ï¼ˆäº‘ï¼‰" class="headerlink" title="ä»Cluster (é›†ç¾¤)ã€Grid (ç½‘æ ¼) åˆ° Cloud ï¼ˆäº‘ï¼‰"></a>ä»Cluster (é›†ç¾¤)ã€Grid (ç½‘æ ¼) åˆ° Cloud ï¼ˆäº‘ï¼‰</h1><p>ä¸ºè§£å†³å¤æ‚çš„<strong>è®¡ç®—å¯†é›†å‹</strong>å’Œ<strong>æ•°æ®å¯†é›†å‹</strong>é—®é¢˜ï¼Œéœ€è¦<strong>é«˜ç½‘ç»œæ€§èƒ½</strong>ã€<strong>å¿«é€Ÿå­˜å‚¨</strong>ã€<strong>å¤§é‡å†…å­˜</strong>ã€<strong>è¶…é«˜è®¡ç®—èƒ½åŠ›</strong>ã€‚</p><h2 id="Cluster"><a href="#Cluster" class="headerlink" title="Cluster"></a><strong>Cluster</strong></h2><p>ä¸€ç»„æ¾æ•£é›†æˆçš„è®¡ç®—æœº<strong>è½¯ä»¶</strong>æˆ–<strong>ç¡¬ä»¶</strong>è¿æ¥èµ·æ¥<strong>é«˜åº¦ç´§å¯†åœ°åä½œ</strong>å®Œæˆè®¡ç®—å·¥ä½œã€‚åœ¨æŸç§æ„ä¹‰ä¸Šï¼Œå¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€å°è®¡ç®—æœºã€‚é›†ç¾¤ç³»ç»Ÿä¸­çš„<font color="blue"><strong>å•ä¸ªè®¡ç®—æœº</strong></font>é€šå¸¸ç§°ä¸º<font color="blue"><strong>èŠ‚ç‚¹node</strong></font>ï¼Œé€šå¸¸é€šè¿‡<strong>å±€åŸŸç½‘(LAN)è¿æ¥</strong>,æ€§ä»·æ¯”æ¯”<font color="blue"><strong>å¤§å‹æœºï¼ˆmainframeï¼‰</strong></font>ç­‰<strong>é«˜</strong>ã€‚</p><h2 id="Grid"><a href="#Grid" class="headerlink" title="Grid"></a><strong>Grid</strong></h2><p>é€šè¿‡<strong>åˆ©ç”¨</strong>å¤§é‡<strong>å¼‚æ„è®¡ç®—æœº</strong>çš„<strong>æœªç”¨èµ„æº</strong>ï¼Œå¦‚<strong>CPU</strong>ã€<strong>ç£ç›˜å­˜å‚¨</strong>ç­‰ï¼Œå°†å…¶ä½œä¸ºåµŒå…¥åœ¨åˆ†å¸ƒå¼çš„ä¸€ä¸ª<strong>è™šæ‹Ÿçš„è®¡ç®—æœºé›†ç¾¤</strong>ï¼Œä¸ºè§£å†³<strong>å¤§è§„æ¨¡è®¡ç®—é—®é¢˜</strong>æä¾›ä¸€ä¸ª<strong>æ¨¡å‹</strong>ã€‚ç›®æ ‡æ˜¯<font color="blue">è§£å†³</font>å¯¹å•ä¸€è¶…çº§è®¡ç®—æœºéƒ½<font color="blue">å›°éš¾çš„å¤§é—®é¢˜</font>ï¼Œå¹¶åŒæ—¶ä¿æŒè§£å†³å¤šä¸ª<font color="blue">è¾ƒå°</font>é—®é¢˜çš„çµæ´»æ€§ã€‚ç½‘æ ¼å¤©ç”Ÿå°±æ˜¯åœ¨æœ¬åœ°ç½‘ã€åŸåŸŸç½‘æˆ–å¹¿åŸŸç½‘ä¸Šè¿›è¡Œåˆ†å¸ƒçš„ã€‚ç½‘æ ¼<font color="blue">å¯ä»¥åˆ†å¸ƒåœ¨ä»»ä½•åœ°æ–¹</font>ã€‚è€Œ<font color="blue">é›†ç¾¤</font>ç‰©ç†ä¸Šéƒ½åœ¨<font color="blue">ä¸€å¤„</font>ï¼Œé€šå¸¸æ˜¯<font color="blue">å±€åŸŸç½‘äº’è¿</font>ã€‚</p><h2 id="Cloud"><a href="#Cloud" class="headerlink" title="Cloud"></a><strong>Cloud</strong></h2><p>é›†ç¾¤æŠ€æœ¯å‘å±•è€Œæ¥ï¼ŒåŒºåˆ«åœ¨äº<font color="blue">é›†ç¾¤è™½ç„¶æŠŠå¤šå°æœºå™¨è”èµ·æ¥</font>ï¼Œä½†å…¶<font color="blue">æŸé¡¹<strong>å…·ä½“ä»»åŠ¡</strong>æ‰§è¡Œçš„æ—¶å€™è¿˜æ˜¯ä¼šè¢«è½¬å‘åˆ°<strong>æŸå°æœåŠ¡å™¨</strong>ä¸Š</font>ï¼Œè€Œ<font color="blue">äº‘</font>å¯ä»¥ç®€å•è®¤ä¸ºæ˜¯<font color="blue">ä»»åŠ¡è¢«<strong>åˆ†å‰²æˆå¤šä¸ªè¿›ç¨‹</strong>åœ¨<strong>å¤šå°æœåŠ¡å™¨</strong>ä¸Š<strong>å¹¶è¡Œè®¡ç®—</strong></font>ï¼Œä¼˜åŠ¿æ˜¯å¤§æ•°æ®é‡çš„æ“ä½œæ€§èƒ½éå¸¸å¥½ã€‚äº‘å¯ä»¥ä½¿ç”¨å»‰ä»·çš„PCæœåŠ¡å™¨ ï¼Œå¯ä»¥<font color="blue"><strong>ç®¡ç†</strong>å¤§æ•°æ®é‡ä¸å¤§é›†ç¾¤</font>ï¼Œ<font color="blue">å…³é”®æŠ€æœ¯åœ¨äºèƒ½å¤Ÿå¯¹äº‘å†…çš„åŸºç¡€è®¾æ–½è¿›è¡ŒåŠ¨æ€æŒ‰éœ€åˆ†é…ä¸ç®¡ç†</font>ã€‚äº‘è®¡ç®—ä¸å¹¶è¡Œè®¡ç®—ã€åˆ†å¸ƒå¼è®¡ç®—çš„åŒºåˆ«ï¼Œ<font color="red">å¯¹äºè®¡ç®—æœºç”¨æˆ·ï¼Œ<strong>å¹¶è¡Œè®¡ç®—</strong>ç”±<strong>å•ä¸ªç”¨æˆ·å®Œæˆ</strong>ï¼Œ<strong>åˆ†å¸ƒå¼è®¡ç®—</strong>ç”±<strong>å¤šä¸ªç”¨æˆ·åˆä½œ</strong>å®Œæˆï¼Œ<strong>äº‘è®¡ç®—</strong>æ˜¯<strong>æ²¡æœ‰ç”¨æˆ·å‚ä¸</strong>ï¼Œè€Œæ˜¯äº¤ç»™<strong>ç½‘ç»œå¦ä¸€ç«¯çš„æœåŠ¡å™¨å®Œæˆ</strong>ã€‚</font></p><p><img src="/GeekFocus/2022-03-06-Linux-grid/1.png" alt="img"><br><img src="/GeekFocus/img/2022-03-06-Linux-grid/1.png" alt="img"></p><p><img src="/GeekFocus/2022-03-06-Linux-grid/2.png" alt="img"><br><img src="/GeekFocus/img/2022-03-06-Linux-grid/2.png" alt="img"></p><p><strong>ç ”ç©¶å‘ç°</strong>ï¼š<strong>å•†åŠ¡è®¡ç®—æœº</strong>åªç”¨åˆ°å…¶<strong>åŠŸèƒ½</strong>çš„ <strong>10ï¼… â€”20ï¼…</strong>ã€‚24 å°æ—¶å†…ï¼Œä¸€èˆ¬çš„ <strong>UNIX æœåŠ¡å™¨</strong>åª<strong>åˆ©ç”¨ 10ï¼…</strong> çš„æ—¶é—´ï¼Œå¤§å‹æœºå¤§çº¦ 40ï¼…ï¼Œ<strong>å°å¼æœºå°‘äº 5ï¼…</strong>ã€‚åŒæ ·æ—¶é—´é—´éš”å†…ï¼Œåˆ©ç”¨<strong>ç½‘æ ¼è®¡ç®—</strong>ï¼Œ<strong>èµ„æºåˆ©ç”¨</strong>å¯ä»¥è¾¾åˆ° <strong>90ï¼…</strong> ã€‚</p><h2 id="ä»æœåŠ¡è§’åº¦çœ‹ç½‘æ ¼åˆ†ç±»"><a href="#ä»æœåŠ¡è§’åº¦çœ‹ç½‘æ ¼åˆ†ç±»" class="headerlink" title="ä»æœåŠ¡è§’åº¦çœ‹ç½‘æ ¼åˆ†ç±»"></a><strong>ä»æœåŠ¡è§’åº¦çœ‹ç½‘æ ¼åˆ†ç±»</strong></h2><ul><li><p><strong>ä¸“ç”¨ç½‘æ ¼</strong></p><p>ç”±ç”¨äºç½‘æ ¼çš„<strong>ä¸“ç”¨ç¡¬ä»¶</strong>å’Œ<strong>è®¡ç®—èµ„æº</strong>ç»„æˆ, æä¾›äº†<strong>æœ€å¤§</strong>çš„<strong>æ§åˆ¶</strong>å’Œ<strong>çµæ´»æ€§</strong></p></li><li><p><strong>éä¸“ç”¨ç½‘æ ¼</strong></p><p>æ›´å¤šåœ°<strong>ä¾èµ–</strong>äº<strong>ç°æœ‰ç½‘ç»œ</strong>å’Œ<strong>åŸºç¡€è®¾æ–½</strong>ï¼Œå¯¹<strong>ç½‘ç»œå†³ç­–</strong>çš„<strong>æ§åˆ¶å¾ˆå°‘</strong>ç”šè‡³ä¸èƒ½æ§åˆ¶ã€‚</p></li><li><p><strong>åˆ†å¸ƒå¼ç½‘æ ¼</strong></p><p>åˆ†å¸ƒå¼ç½‘æ ¼ ç”±åœ¨ WAN æˆ– <font color="blue"><strong>Internet ä¸Šåˆ†å¸ƒçš„</strong>ã€<strong>ä½äºä»»ä½•ä½ç½®</strong></font>ï¼ˆå†…éƒ¨æˆ–å¤–éƒ¨ï¼‰çš„<strong>è®¡ç®—æœºèµ„æºç»„æˆ</strong>ã€‚</p></li></ul><h2 id="ä»åº”ç”¨è§’åº¦ç½‘æ ¼åˆ†ç±»"><a href="#ä»åº”ç”¨è§’åº¦ç½‘æ ¼åˆ†ç±»" class="headerlink" title="ä»åº”ç”¨è§’åº¦ç½‘æ ¼åˆ†ç±»"></a><strong>ä»åº”ç”¨è§’åº¦ç½‘æ ¼åˆ†ç±»</strong></h2><ul><li><p><strong>è®¡ç®—ç½‘æ ¼</strong></p><p>ä¾§é‡äº<font color="blue">è®¡ç®—å¯†é›†å‹</font>æ“ä½œçš„ç½‘æ ¼</p></li><li><p><strong>æ•°æ®ç½‘æ ¼</strong></p><p>å¤„ç†æ•°æ®çš„æ•°æ®è®¡ç®—ç³»ç»Ÿâ€”â€”<font color="blue">æ§åˆ¶å¤§é‡çš„åˆ†å¸ƒå¼æ•°æ®çš„å…±äº«å’Œç®¡ç†</font></p></li><li><p><strong>è®¾å¤‡ç½‘æ ¼</strong></p><p><font color="blue">ç”¨äº<strong>è¿œç¨‹æ§åˆ¶</strong>è®¾å¤‡å’Œåˆ†æäº§ç”Ÿçš„æ•°æ®</font></p></li></ul><h1 id="SGE-Sun-Grid-Engine"><a href="#SGE-Sun-Grid-Engine" class="headerlink" title="SGE [Sun Grid Engine]"></a>SGE [Sun Grid Engine]</h1><p><font color="red">ä»<strong>ç™»é™†èŠ‚ç‚¹</strong>ä¸Š<strong>å‘è®¡ç®—èŠ‚ç‚¹</strong>è¿›è¡Œ<strong>ä»»åŠ¡æŠ•é€’</strong></font>ã€‚SGEæˆ–è€…å…¶ä»–é›†ç¾¤ç®¡ç†å·¥ä½œåšçš„äº‹æƒ…å°±æ˜¯<font color="blue">å°†ç”¨æˆ·æŠ•é€’çš„<strong>ä»»åŠ¡æ’é˜Ÿ</strong></font>ï¼Œç„¶åå°†ä»»åŠ¡äº¤ç»™<font color="blue"><strong>èƒ½å¤Ÿè¿è¡Œ</strong>çš„<strong>è®¡ç®—èŠ‚ç‚¹æ‰§è¡Œ</strong></font>ï¼Œå·¥ä½œæµç¨‹åˆ†å››æ­¥:</p><ol><li><strong>æ¥å—</strong>ç”¨æˆ·æŠ•æ”¾çš„<strong>ä»»åŠ¡</strong></li><li>åœ¨ä»»åŠ¡è¿è¡Œä»¥å‰ï¼Œå°†ä»»åŠ¡<strong>æ”¾åˆ°</strong>ä¸€ä¸ª<strong>å­˜å‚¨åŒºåŸŸ</strong></li><li><strong>å‘é€ä»»åŠ¡</strong>åˆ°ä¸€ä¸ª<strong>æ‰§è¡Œè®¾å¤‡</strong>ï¼Œå¹¶<strong>ç›‘æ§</strong>ä»»åŠ¡çš„è¿è¡Œ</li><li>è¿è¡Œ<strong>ç»“æŸ</strong>å†™å›ç»“æœå¹¶è®°å½•è¿è¡Œ<strong>æ—¥å¿—</strong></li></ol><h2 id="SGEçš„å¸¸ç”¨å‘½ä»¤"><a href="#SGEçš„å¸¸ç”¨å‘½ä»¤" class="headerlink" title="SGEçš„å¸¸ç”¨å‘½ä»¤"></a>SGEçš„å¸¸ç”¨å‘½ä»¤</h2><h3 id="ä»»åŠ¡æŠ•é€’"><a href="#ä»»åŠ¡æŠ•é€’" class="headerlink" title="ä»»åŠ¡æŠ•é€’"></a>ä»»åŠ¡æŠ•é€’</h3><p>SGEä¸­æŠ•é€’ä»»åŠ¡æ‰€ç”¨åˆ°çš„å‘½ä»¤æ˜¯<code>qsub</code>. æœ€ç®€å•çš„ç”¨æ³•ï¼Œå³å°†è¦æ‰§è¡Œçš„å‘½ä»¤é€šè¿‡æ ‡å‡†è¾“å…¥çš„æ–¹å¼ä¼ é€’ç»™<code>qsub</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ls -l &quot;</span> | qsub<br></code></pre></td></tr></table></figure><p>æŠ•é€’ä¹‹åå¯ä»¥ç”¨<code>qstat</code>æŸ¥çœ‹ä»»åŠ¡è¿è¡Œæƒ…å†µï¼Œå¦‚ä¸‹å›¾</p><p><img src="/GeekFocus/2022-03-06-Linux-grid/3.png" alt="img"><br><img src="/GeekFocus/img/2022-03-06-Linux-grid/3.png" alt="img"></p><p>ä»»åŠ¡æŠ•é€’æƒ…å†µ</p><p>ç¬¬ä¸€åˆ—æ˜¯ä»»åŠ¡ç¼–å·, ç¬¬äºŒåˆ—æ˜¯ä¼˜å…ˆçº§ï¼Œç¬¬ä¸‰åˆ—æ˜¯ä»»åŠ¡åå­—ï¼Œåœ¨å‚æ•°é‡Œæ²¡æœ‰ç‰¹åˆ«è¯´æ˜çš„æƒ…å†µä¸‹ï¼ŒSGEä¼šç”¨ä»»åŠ¡çš„æ¥æºè¿›è¡Œå‘½ä»¤ï¼ŒSTDINè¡¨ç¤ºæ¥è‡ªäºæ ‡å‡†è¾“å…¥ï¼Œç¬¬å››åˆ—æ˜¯ç”¨æˆ·åï¼Œç¬¬äº”åˆ—æ˜¯è¿è¡ŒçŠ¶æ€(â€œrâ€è¡¨ç¤ºè¿è¡Œä¸­), ç¬¬å…­åˆ—è¡¨ç¤ºä»»åŠ¡æŠ•é€’å’Œå¼€å§‹æ—¶é—´ï¼Œç¬¬ä¸ƒåˆ—æ˜¯ä»»åŠ¡æŠ•é€’çš„èŠ‚ç‚¹ï¼Œç¬¬8åˆ—åˆ™æ˜¯è¦ç”³è¯·çš„çº¿ç¨‹æ•°ã€‚åœ¨æ‰§è¡Œå®Œæˆåä¼šåœ¨å®¶ç›®å½•ä¸‹ç”Ÿæˆâ€STDIN.e7883â€å’Œâ€STDIN.o7883â€, å…¶ä¸­7883æ˜¯ä»»åŠ¡ç¼–å·, å‰è€…å­˜æ”¾æ ‡å‡†é”™è¯¯è¾“å‡º, åè€…å­˜æ”¾æ ‡å‡†è¾“å‡ºï¼Œ å› æ­¤â€cat STDIN.o7883â€çš„å†…å®¹å°±æ˜¯<code>ls -l</code>çš„å†…å®¹ã€‚</p><p>å¦ä¸€ç§æ–¹æ³•æ˜¯å…ˆå†™è„šæœ¬åæŠ•é€’ï¼Œæ¯”å¦‚å…ˆç¼–è¾‘æ–‡ä»¶â€ls.shâ€, ç„¶åç”¨â€qsub ls.shâ€æŠ•é€’ä»»åŠ¡ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> -l<br></code></pre></td></tr></table></figure><p>è·Ÿä¹‹å‰ä¸€æ ·ï¼Œæœ€ååœ¨homeç›®å½•äº§ç”Ÿäº†â€ls.sh.exxxxâ€å’Œâ€ls.sh.exxxxâ€ä¸¤ä¸ªæ–‡ä»¶</p><p>å®é™…è‚¯å®šæ²¡æœ‰é‚£ä¹ˆç®€å•ï¼Œéœ€è¦å¢åŠ å„ç§å‚æ•°æ¥è°ƒæ•´<code>qsub</code>çš„è¡Œä¸ºï¼Œç”¨<code>qsub -help</code>å¯ä»¥çœ‹å®Œæ•´å‚æ•°ï¼Œä½†æ˜¯å¸¸ç”¨çš„ä¸ºå¦‚ä¸‹å‡ ä¸ª </p><ul><li>-q xxx : æŒ‡å®šè¦æŠ•é€’åˆ°çš„é˜Ÿåˆ—ï¼Œå¦‚æœä¸æŒ‡å®šçš„è¯ï¼ŒSGEä¼šåœ¨ç”¨æˆ·å¯ä½¿ç”¨çš„é˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„é˜Ÿåˆ—</li><li>-Vï¼š <font color="red">å°†å½“å‰çš„ç¯å¢ƒå˜é‡ä¼ é€’åˆ°æ‰§è¡Œå‘½ä»¤çš„èŠ‚ç‚¹ã€åœ¨ä½¿ç”¨PBSæ—¶ï¼Œç›´æ¥è¿è¡Œå¯ä»¥æ‰§è¡Œï¼ŒæŠ•é€’PBSåˆ™å¤±è´¥ï¼Œæ˜¯ä»»åŠ¡åˆ°äº†è®¡ç®—èŠ‚ç‚¹ä¸è¯†åˆ«ç¯å¢ƒå˜é‡ï¼Ÿã€‘</font></li><li>cwd: åœ¨å½“å‰ç›®å½•ä¸‹æ‰§è¡Œä»»åŠ¡, sgeçš„æ—¥å¿—ä¼šè¾“å‡ºåˆ°å½“å‰è·¯å¾„ã€‚ ä¸å¢åŠ è¯¥æŒ‡ä»¤ï¼Œæ‰€æœ‰æŠ•é€’çš„ä»»åŠ¡éƒ½ä¼šåœ¨homeç›®å½•ä¸‹æ‰§è¡Œ</li><li>-l resource&#x3D;value: è¯·æ±‚èµ„æºæ•°, ä¾‹å¦‚ <code>-l vf=25G -l h=node1</code> ä»»åŠ¡çš„é¢„ä¼°å†…å­˜è¦25G(å†…å­˜ä¼°è®¡çš„å€¼åº”ç¨å¾®å¤§äºçœŸå®å†…å­˜ï¼Œå†…å­˜é¢„ä¼°åå°å¯èƒ½ä¼šå¯¼è‡´èŠ‚ç‚¹è·‘æŒ‚), ç”³è¯·åœ¨node1ä¸Šè¿è¡Œ</li><li>-S &#x2F;bin&#x2F;bash: è¡¨ç¤ºåœ¨bashç¯å¢ƒä¸‹æ‰§è¡Œå‘½ä»¤ã€‚é»˜è®¤tcsh.</li><li>-pe openmpi 4: è¡¨ç¤ºä½¿ç”¨openmpiè¿›è¡Œå¹¶è¡Œè¿ç®—ï¼Œä¸”ç”³è¯·çš„çº¿ç¨‹æ˜¯4ï¼Œ</li><li>-N ä»»åŠ¡å: æ‰‹åŠ¨æ‰§è¡Œä»»åŠ¡çš„åå­—</li><li>-j y|n ï¼šæ˜¯å¦å°†æ ‡å‡†è¾“å…¥å’Œæ ‡å‡†è¾“å…¥åˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶</li><li>-sync y|n: æ˜¯å¦ç­‰å¾…ä»»åŠ¡ç»“æŸï¼Œè¿”å›é€€å‡ºç </li><li>-o path: æŒ‡å®šæ ‡å‡†è¾“å‡ºçš„æ–‡ä»¶å¤¹</li></ul><p>æ¥ä¸‹æ¥å°±å¯ä»¥æ·»åŠ è¿™äº›å‚æ•°è¿è¡Œä¸€äº›å‘½ä»¤ï¼Œä¾‹å¦‚åœ¨å‘½ä»¤è¡Œé‡ŒæŠ•é€’ä¸€ä¸ªæ¯”å¯¹ä»»åŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;bowtie2 -p 8 -x index/ref -1 data/A_1.fq -2 data/A_2.fq | samtools sort &gt; A.bam&quot;</span> | qsub -V -cwd -l vf=25G -S /bin/bash -pe openmpi 8 -N A.bt2<br></code></pre></td></tr></table></figure><p>è¿™äº›å‚æ•°é™¤äº†åœ¨<strong>å¤–éƒ¨è®¾ç½®</strong>å¤–ï¼Œè¿˜å¯ä»¥åœ¨shellè„šæœ¬<strong>å†…éƒ¨è®¾ç½®</strong>ï¼Œå¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment">#$ -S /bin/bash</span><br><span class="hljs-comment">#$ -V</span><br><span class="hljs-comment">#$ -cwd</span><br><span class="hljs-comment">#$ -l vf=25G</span><br><span class="hljs-comment">#$ -pe openmpi 8</span><br><span class="hljs-comment">#$ -N a.bt2</span><br>bowtie2 -p 8 -x index/ref -1 data/A_1.fq -2 data/A_2.fq | samtools <span class="hljs-built_in">sort</span> &gt; A.bam<br></code></pre></td></tr></table></figure><h3 id="æŸ¥è¯¢ä»»åŠ¡"><a href="#æŸ¥è¯¢ä»»åŠ¡" class="headerlink" title="æŸ¥è¯¢ä»»åŠ¡"></a>æŸ¥è¯¢ä»»åŠ¡</h3><p>é™¤ä»»åŠ¡æŠ•é€’å¤–ï¼ŒæŸ¥è¯¢ä»»åŠ¡ä¹Ÿæ˜¯å¸¸ç”¨å‘½ä»¤ï¼Œé™¤ç›´æ¥ç”¨<code>qstat</code>æŸ¥çœ‹ï¼Œè¿˜æœ‰å¦‚ä¸‹å‚æ•°æ¯”è¾ƒå¥½ç”¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">qstat -f        <span class="hljs-comment"># æŸ¥çœ‹ç”¨æˆ·ä»»åŠ¡</span><br>qstat -j jobId  <span class="hljs-comment"># æŒ‰ä»»åŠ¡idæŸ¥çœ‹</span><br>qstat -explain a|c|A|E -j jobID <span class="hljs-comment"># æŸ¥çœ‹ä»»åŠ¡ä»»åŠ¡å¹¶ç»™å‡ºè§£é‡Š</span><br>qstat -u user   <span class="hljs-comment"># æŒ‰ç”¨æˆ·æŸ¥çœ‹</span><br></code></pre></td></tr></table></figure><p>ä»»åŠ¡çŠ¶æ€ï¼š</p><ul><li>qw: è¡¨ç¤ºç­‰å¾…çŠ¶æ€</li><li>hqw: ä»»åŠ¡æŒ‚èµ·ç­‰å¾…ä¸­ï¼Œå¾…ä¾èµ–çš„ä»»åŠ¡å®Œæˆåæ‰§è¡Œ</li><li>Eqw: æŠ•é€’ä»»åŠ¡å‡ºé”™</li><li>r: è¡¨ç¤ºä»»åŠ¡æ­£åœ¨è¿è¡Œ</li><li>s: æš‚æ—¶æŒ‚èµ·</li><li>dr: èŠ‚ç‚¹æŒ‚äº†ä¹‹åï¼Œåˆ é™¤ä»»åŠ¡å°±ä¼šå‡ºç°è¿™ä¸ªçŠ¶æ€ï¼Œåªæœ‰èŠ‚ç‚¹é‡å¯åï¼Œä»»åŠ¡æ‰ä¼šæ¶ˆå¤±</li></ul><h3 id="åˆ é™¤ä»»åŠ¡"><a href="#åˆ é™¤ä»»åŠ¡" class="headerlink" title="åˆ é™¤ä»»åŠ¡"></a>åˆ é™¤ä»»åŠ¡</h3><p>ä»»åŠ¡åˆ é™¤ä¹Ÿæ¯”è¾ƒé‡è¦ï¼Œå¶å°”ä¼šå‡ºç°ä»»åŠ¡æŠ•é€’å‡ºé”™çš„æƒ…å†µ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">qdel -j 1111   åˆ é™¤ä»»åŠ¡å·ä¸º1111çš„ä»»åŠ¡<br></code></pre></td></tr></table></figure><h3 id="å…¶ä»–å‘½ä»¤"><a href="#å…¶ä»–å‘½ä»¤" class="headerlink" title="å…¶ä»–å‘½ä»¤"></a>å…¶ä»–å‘½ä»¤</h3><ul><li><p>qrshï¼šä¸qsubç›¸æ¯”ï¼Œæ˜¯äº¤äº’å¼çš„æŠ•é€’ä»»åŠ¡ï¼Œæ³¨æ„å‚æ•°:</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">-now <span class="hljs-literal">yes</span>|<span class="hljs-literal">no</span><br></code></pre></td></tr></table></figure><p>é»˜è®¤è®¾ç½®ä¸ºyes</p><ul><li>è‹¥è®¾ç½®ä¸ºyesï¼Œ<font color="blue">ç«‹å³è°ƒåº¦ä½œä¸š</font>ï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨èµ„æºï¼Œåˆ™æ‹’ç»ä½œä¸šï¼Œä»»åŠ¡æŠ•é€’å¤±è´¥ï¼Œä»»åŠ¡çŠ¶æ€ä¸ºEqwã€‚</li><li>è‹¥è®¾ç½®ä¸ºnoï¼Œè°ƒåº¦æ—¶å¦‚æœæ²¡æœ‰å¯ç”¨èµ„æºï¼Œåˆ™å°†ä½œä¸š<font color="blue">æ’å…¥é˜Ÿåˆ—</font>ï¼Œç­‰å¾…è°ƒåº¦ã€‚</li><li>ä¾‹å­ï¼š qrsh -l vf&#x3D;*G -q all.q -now no -w n *sh</li></ul></li><li><p>qacct ä»é›†ç¾¤æ—¥å¿—ä¸­æŠ½å–ä»»æ„è´¦æˆ·ä¿¡æ¯</p></li><li><p>qalter æ›´æ”¹å·²æäº¤ä½†æ­£å¤„äºæš‚æŒ‚çŠ¶æ€çš„ä½œä¸šçš„å±æ€§</p></li><li><p>qconf ä¸ºé›†ç¾¤å’Œé˜Ÿåˆ—é…ç½®æä¾›ç”¨æˆ·ç•Œé¢</p><ul><li><code>qconf -spl</code>æŸ¥çœ‹å¯ç”¨å¹¶è¡Œç¯å¢ƒ</li></ul></li><li><p>qhold é˜»æ­¢å·²æäº¤ä½œä¸šçš„æ‰§è¡Œ</p></li><li><p>qhost æ˜¾ç¤º<font color="blue">SGEæ‰§è¡Œä¸»æœº</font>ï¼ˆå³<font color="blue">å„ä¸ªè®¡ç®—èŠ‚ç‚¹</font>ï¼‰çš„<font color="blue">çŠ¶æ€ä¿¡æ¯</font></p><ul><li><code>qhost -j</code>æŒ‰ç…§èŠ‚ç‚¹æ˜¾ç¤ºä»»åŠ¡</li><li><code>qhost -F</code>å±•ç¤ºæ¯ä¸ªèŠ‚ç‚¹çš„èµ„æº</li></ul></li><li><p>qlogin å¯åŠ¨telnetæˆ–ç±»ä¼¼çš„ç™»å½•ä¼šè¯ã€‚</p></li></ul><h2 id="æ¡ˆä¾‹ï¼šä¸€ä¸ªæŠ•é€’æ¯”å¯¹ä»»åŠ¡çš„ç®€å•è„šæœ¬"><a href="#æ¡ˆä¾‹ï¼šä¸€ä¸ªæŠ•é€’æ¯”å¯¹ä»»åŠ¡çš„ç®€å•è„šæœ¬" class="headerlink" title="æ¡ˆä¾‹ï¼šä¸€ä¸ªæŠ•é€’æ¯”å¯¹ä»»åŠ¡çš„ç®€å•è„šæœ¬"></a>æ¡ˆä¾‹ï¼šä¸€ä¸ªæŠ•é€’æ¯”å¯¹ä»»åŠ¡çš„ç®€å•è„šæœ¬</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-built_in">set</span> -e<br><span class="hljs-built_in">set</span> -u<br><span class="hljs-built_in">set</span> -o pipefail<br><br>threads=8<br>index=index/hg19<br><br>FQ_DIR=<span class="hljs-string">&quot;analysis/0-raw-data&quot;</span><br>ALIGN_DIR=<span class="hljs-string">&quot;analysis/2-read-align&quot;</span><br>LOG_DIR=<span class="hljs-string">&quot;analysis/log&quot;</span><br>TMP_DIR=<span class="hljs-string">&quot;analysis/tmp&quot;</span><br><br><span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$&#123;ALIGN_DIR&#125;</span><br><span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$&#123;LOG_DIR&#125;</span><br><span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$&#123;TMP_DIR&#125;</span><br><br><span class="hljs-built_in">tail</span> -n+2 download_table.txt | <span class="hljs-built_in">cut</span> -f 6 | <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> <span class="hljs-built_in">id</span>;<br><span class="hljs-keyword">do</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;</span><br><span class="hljs-string">    bowtie2 --very-sensitive-local --mm -p <span class="hljs-variable">$threads</span> -x <span class="hljs-variable">$index</span> -U <span class="hljs-variable">$&#123;FQ_DIR&#125;</span>/<span class="hljs-variable">$id</span>.fastq.gz 2&gt; <span class="hljs-variable">$&#123;LOG_DIR&#125;</span>/<span class="hljs-variable">$id</span>.bt2.log | \</span><br><span class="hljs-string">    samtools sort -@ 2 -m 1G -T <span class="hljs-variable">$&#123;TMP_DIR&#125;</span>/<span class="hljs-variable">$&#123;id&#125;</span> -o <span class="hljs-variable">$&#123;ALIGN_DIR&#125;</span>/<span class="hljs-variable">$&#123;id&#125;</span>.sort.bam&quot;</span> | qsub -V -cwd -pe openmpi <span class="hljs-variable">$threads</span> -N <span class="hljs-variable">$&#123;id&#125;</span>_bt2 -q all.q -S /bin/bash<br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h1 id="PBS-Protable-Batch-System"><a href="#PBS-Protable-Batch-System" class="headerlink" title="PBS [Protable Batch System]"></a>PBS [Protable Batch System]</h1><h2 id="1-æœåŠ¡å™¨é›†ç¾¤"><a href="#1-æœåŠ¡å™¨é›†ç¾¤" class="headerlink" title="1. æœåŠ¡å™¨é›†ç¾¤"></a>1. æœåŠ¡å™¨é›†ç¾¤</h2><ul><li>æœåŠ¡å™¨é›†ç¾¤æŒ‡å°†å¾ˆå¤šæœåŠ¡å™¨é›†ä¸­ä¸€èµ·è¿›è¡ŒåŒç§æœåŠ¡ï¼Œåœ¨<font color="blue">å®¢æˆ·ç«¯çœ‹æ¥å°±åƒåªæœ‰ä¸€ä¸ªæœåŠ¡å™¨</font>ï¼Œé›†ç¾¤å¯ä»¥åˆ©ç”¨å¤šä¸ªè®¡ç®—æœºè¿›è¡Œ<font color="blue">å¹¶è¡Œè®¡ç®—</font>ä»è€Œè·å¾—å¾ˆé«˜çš„è®¡ç®—é€Ÿåº¦ï¼Œä¹Ÿå¯ä»¥ç”¨å¤šä¸ªè®¡ç®—æœºåš<font color="blue">å¤‡ä»½</font>ï¼Œä»è€Œä½¿å¾—ä»»ä½•ä¸€ä¸ªæœºå™¨åäº†æ•´ä¸ªç³»ç»Ÿè¿˜æ˜¯æ­£å¸¸è¿è¡Œã€‚</li><li>é›†ç¾¤æ˜¯ä¸€ç»„ç‹¬ç«‹çš„è®¡ç®—æœºï¼ˆèŠ‚ç‚¹ï¼‰çš„é›†åˆä½“ï¼ŒèŠ‚ç‚¹é—´é€šè¿‡é«˜æ€§èƒ½çš„äº’è¿ç½‘ç»œè¿æ¥ï¼›<strong>å„èŠ‚ç‚¹</strong>é™¤ä½œä¸º<strong>å•ä¸€è®¡ç®—èµ„æº</strong>ä¾›äº¤äº’å¼ç”¨æˆ·ä½¿ç”¨å¤–ï¼Œè¿˜å¯ä»¥<strong>ååŒå·¥ä½œ</strong>å¹¶è¡¨ç°ä¸ºä¸€ä¸ªå•ä¸€çš„ã€é›†ä¸­çš„è®¡ç®—èµ„æºä¾›å¹¶è¡Œè®¡ç®—ä»»åŠ¡ä½¿ç”¨ã€‚</li></ul><p><strong>1.1. é›†ç¾¤ç³»ç»ŸåŸºæœ¬ä¿¡æ¯</strong></p><ul><li>é›†ç¾¤é…åˆ¶çš„<a href="https://baike.baidu.com/item/%E5%88%80%E7%89%87%E6%9C%8D%E5%8A%A1%E5%99%A8/1375424">åˆ€ç‰‡è®¡ç®—èŠ‚ç‚¹</a>çš„CPUï¼ŒGPUé…åˆ¶æƒ…å†µã€‚<a href="https://www.dt-stor.com/yingpanbaike/407.html#:~:text=%E5%88%80%E7%89%87%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E4%BC%A0%E7%BB%9F%E6%9C%BA%E6%9E%B6%E5%BC%8F%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E6%AF%94%EF%BC%8C%E5%88%80%E7%89%87%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9B%A0%E5%85%B1%E4%BA%AB%E5%86%B7%E5%8D%B4%E3%80%81%E7%94%B5%E6%BA%90%E7%B3%BB%E7%BB%9F%E8%80%8C%E6%88%90%E4%B8%BA%E5%8F%97%E6%AC%A2%E8%BF%8E%E7%9A%84%E8%8A%82%E8%83%BD%E7%8E%AF%E4%BF%9D%E4%BA%A7%E5%93%81%EF%BC%8C%E4%B8%8E%E5%90%8C%E7%AD%89%E7%9A%841U%E6%9C%BA%E6%9E%B6%E5%BC%8F%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E6%AF%94%EF%BC%8C%E8%83%BD%E8%80%97%E9%99%8D%E4%BD%8E%E8%BE%BE,40%25%EF%BC%8C%E7%A9%BA%E9%97%B4%E5%8D%A0%E7%94%A8%E5%87%8F%E5%B0%9140%25%20%E3%80%82">åˆ€ç‰‡æœºä¼˜ç¼ºç‚¹</a>; <a href="https://www.intel.cn/content/www/cn/zh/products/docs/processors/cpu-vs-gpu.html">GPUä¸CPU</a>ã€‚</li><li>ç³»ç»Ÿé…å¤‡çš„<strong>å¹¶è¡Œæ–‡ä»¶ç³»ç»Ÿ</strong>ï¼Œå„ç»„<strong>åˆ€ç‰‡æœº</strong>ä¹‹é—´çš„<strong>ç½‘ç»œè¿æ¥</strong></li><li>ç³»ç»Ÿé…åˆ¶çš„<font color="blue">ç™»é™†ç®¡ç†èŠ‚ç‚¹</font>ï¼Œéƒ¨ç½²çš„é›†ç¾¤ç®¡ç†ç³»ç»Ÿã€‚ç”¨æˆ·å¯æ ¹æ®<font color="blue">ç™»å½•èŠ‚ç‚¹IPï¼Œç™»å½•é›†ç¾¤ï¼Œæäº¤ä½œä¸š</font>ï¼Œç¼–è¯‘ç¨‹åºã€‚</li></ul><p><strong>1.2. é›†ç¾¤è®¡ç®—èµ„æºåˆ—è¡¨</strong></p><p><img src="/GeekFocus/2022-03-06-Linux-grid/4.png"><br><img src="/GeekFocus/img/2022-03-06-Linux-grid/4.png" alt="é›†ç¾¤è®¡ç®—èµ„æºåˆ—è¡¨ç¤ºä¾‹"></p><ul><li>ä¸€èˆ¬æ­å»ºå¥½é›†ç¾¤åï¼Œéƒ½ä¼šç»™å‡ºé›†ç¾¤è®¡ç®—èµ„æºåˆ—è¡¨ï¼Œç±»ä¼¼äºä¸Šå›¾çš„å‡ ä¸ªéƒ¨åˆ†ã€‚<ul><li>é¦–å…ˆï¼Œä¼šå°†æ•´ä¸ª<font color="blue">é›†ç¾¤åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªé˜Ÿåˆ—ï¼ˆQueueï¼‰</font>ï¼Œå¹¶æ ¹æ®<font color="blue">é˜Ÿåˆ—èµ„æºé…ç½®</font>æƒ…å†µè¿›è¡Œ<font color="blue">ç›¸åº”å‘½å</font>ï¼›</li><li>å…¶æ¬¡ï¼Œ<font color="blue">æ¯ä¸ª<strong>é˜Ÿåˆ—</strong>ä¸‹è‹¥å¹²ä¸ª<strong>è®¡ç®—èŠ‚ç‚¹</strong>ï¼ˆ<strong>nodes</strong>ï¼‰ï¼Œæ¯ä¸ªè®¡ç®—èŠ‚ç‚¹é…åˆ¶<strong>è‹¥å¹²ä¸ªCPU</strong>ï¼ˆ<strong>ppn</strong>ï¼‰</font>ï¼›</li><li>æœ€åï¼Œå¯¹é›†ç¾¤çš„ä¸€äº›å…¶ä»–<strong>ä¿¡æ¯è¯´æ˜</strong>å’Œ<strong>é™åˆ¶æƒ…å†µè¯´æ˜</strong>ï¼Œå¦‚CPUå‹å·å’Œæ ¸æ•°ï¼Œç”¨æˆ·<strong>å¯æäº¤çš„ä½œä¸šæ•°</strong>ï¼Œæ¯ä¸ªä½œä¸šçš„<strong>æœ€å¤§è¿è¡Œæ—¶é—´</strong>ç­‰ã€‚</li></ul></li><li>åœ¨å¾€é›†ç¾¤ä¸ŠæŠ•é€’ä»»åŠ¡ä¹‹å‰ï¼Œé¦–å…ˆè¦äº†è§£è¯¥<strong>ä»»åŠ¡æ‰€éœ€çš„è®¡ç®—èµ„æºæ˜¯å¦èƒ½è¢«é›†ç¾¤æ‰€æ»¡è¶³</strong>ã€‚</li></ul><h2 id="2-PBSä»»åŠ¡ç®¡ç†ç³»ç»Ÿ"><a href="#2-PBSä»»åŠ¡ç®¡ç†ç³»ç»Ÿ" class="headerlink" title="2. PBSä»»åŠ¡ç®¡ç†ç³»ç»Ÿ"></a>2. PBSä»»åŠ¡ç®¡ç†ç³»ç»Ÿ</h2><h3 id="2-1-PBS-ç®€ä»‹"><a href="#2-1-PBS-ç®€ä»‹" class="headerlink" title="2.1 PBS ç®€ä»‹"></a><strong>2.1 PBS ç®€ä»‹</strong></h3><ul><li>PBS ï¼ˆProtable Batch Systemï¼‰ æ˜¯ä¸€ç§å¸¸ç”¨ä½œä¸šç®¡ç†ç³»ç»Ÿï¼Œå…¶ä»–ç±»ä¼¼çš„è¿˜æœ‰ LSF å’Œ SLURMã€‚</li></ul><ul><li><p>PBSä¼šæ ¹æ®ä¸€ä¸ªé›†ç¾¤ä¸Šçš„<strong>å¯ç”¨è®¡ç®—èŠ‚ç‚¹</strong>çš„<strong>è®¡ç®—èµ„æº</strong><font color="blue">ç®¡ç†å’Œè°ƒåº¦</font>æ‰€æœ‰è®¡ç®—ä½œä¸šï¼ˆæ— è®ºæ‰¹å¤„ç†ä½œä¸šè¿˜æ˜¯äº¤äº’å¼ä½œä¸šï¼‰ã€‚</p></li><li><p>ç›®å‰æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼š<font color="blue">OpenPBSï¼ˆå¼€æºï¼‰</font>å’Œ<font color="blue">PBSProï¼ˆå•†ä¸šï¼‰</font>ã€‚TORQUEï¼šåŸºäºPBSé¡¹ç›®çš„å¼€æºè½¯ä»¶ï¼Œæ˜¯å¼€æºçš„OpenPBSæ”¹è¿›ç‰ˆã€‚ä¸»è¦åŒ…æ‹¬ï¼š</p></li><li><p><strong>PBS Server</strong>ï¼šè¿è¡Œäºé›†ç¾¤çš„<font color="red"><strong>ç®¡ç†èŠ‚ç‚¹</strong></font>ã€‚<font color="red"><strong>åˆ›å»ºå¹¶æ¥å—ä½œä¸šã€ä¿®æ”¹ä½œä¸šã€æ¿€æ´»è°ƒåº¦å™¨ï¼ˆPBS Schedulerï¼‰ä»¥åŠé€šçŸ¥PBSæ‰§è¡Œå™¨ï¼ˆPBS Momsï¼‰æ‰§è¡Œä½œä¸š</strong></font></p></li><li><p><strong>PBS Scheduleræ¿€æ´»è°ƒåº¦å™¨</strong>ï¼šæ ¹æ®èµ„æºç®¡ç†å™¨è·çŸ¥<strong>å„ä¸ªèŠ‚ç‚¹çš„èµ„æºçŠ¶å†µ</strong>å’Œ<strong>ç³»ç»Ÿçš„ä½œä¸šä¿¡æ¯</strong>ç”Ÿæˆç›¸åº”<font color="red">ä½œä¸šä¼˜å…ˆçº§åˆ—è¡¨</font></p></li><li><p><strong>PBS MomsPBSæ‰§è¡Œå™¨</strong>ï¼š<font color="blue">æ¯ä¸ªèŠ‚ç‚¹å‡æœ‰ä¸€ä¸ª<strong>åå°è¿›ç¨‹</strong>ï¼Œè¯¥è¿›ç¨‹çœŸæ­£<strong>å¯åŠ¨</strong>å’Œ<strong>åœæ­¢</strong>æäº¤åˆ°è¯¥èŠ‚ç‚¹çš„ä½œä¸š</font></p></li></ul><h3 id="2-2-å¸¸ç”¨PBSå‘½ä»¤"><a href="#2-2-å¸¸ç”¨PBSå‘½ä»¤" class="headerlink" title="2.2 å¸¸ç”¨PBSå‘½ä»¤"></a><strong>2.2 å¸¸ç”¨PBSå‘½ä»¤</strong></h3><ul><li>æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€<br><font color="red"><strong>pbsnodes ï¼ˆæŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹ï¼‰</strong></font><br><font color="red"><strong>pbsnodes -l free ï¼ˆæŸ¥çœ‹ç©ºé—²èŠ‚ç‚¹ï¼‰</strong></font><br>pbsnodes æŸèŠ‚ç‚¹ ï¼ˆæŸ¥çœ‹æŸèŠ‚ç‚¹çŠ¶æ€ï¼‰</li><li>èŠ‚ç‚¹åˆ‡æ¢<br><font color="red"><strong>ssh æŸèŠ‚ç‚¹ ï¼ˆè½¬åˆ°æŸèŠ‚ç‚¹ï¼‰</strong></font></li><li>é€€å‡ºèŠ‚ç‚¹<br><strong>exit ï¼ˆç¦»å¼€èŠ‚ç‚¹ï¼‰</strong></li><li>æŸ¥çœ‹ä»»åŠ¡è¿è¡ŒçŠ¶æ€<br><font color="red"><strong>ã€qstat ï¼ˆåˆ—å‡ºæ‰€æœ‰ä½œä¸šè¿è¡ŒçŠ¶æ€ï¼‰ã€‘</strong></font></li></ul><blockquote><p>ã€ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ä¿¡æ¯ã€‘</p><ul><li><p>Job ID ä»»åŠ¡IDå·</p></li><li><p>Name ä»»åŠ¡è„šæœ¬åç§°</p></li><li><p>User ç”¨æˆ·å</p></li><li><p>Time Use ä»»åŠ¡è¿è¡Œæ—¶é—´</p></li><li><p>S State ä»»åŠ¡çŠ¶æ€<br>* B åªç”¨äºä»»åŠ¡å‘é‡ï¼Œè¡¨ç¤ºä»»åŠ¡å‘é‡å·²ç»å¼€å§‹æ‰§è¡Œ<br>* E ä»»åŠ¡åœ¨è¿è¡Œåé€€å‡º<br>* H ä»»åŠ¡è¢«æœåŠ¡å™¨æˆ–ç”¨æˆ·æˆ–è€…ç®¡ç†å‘˜é˜»å¡<br>* Q ä»»åŠ¡æ­£åœ¨æ’é˜Ÿä¸­ï¼Œç­‰å¾…è¢«è°ƒåº¦è¿è¡Œ<br>* R ä»»åŠ¡æ­£åœ¨è¿è¡Œ<br>* S ä»»åŠ¡è¢«æœåŠ¡å™¨æŒ‚èµ·ï¼Œç”±äºä¸€ä¸ªæ›´é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡éœ€è¦å½“å‰ä»»åŠ¡çš„èµ„æº<br>* T ä»»åŠ¡è¢«è½¬ç§»åˆ°å…¶å®ƒæ‰§è¡ŒèŠ‚ç‚¹äº†<br>* U ç”±äºæœåŠ¡å™¨ç¹å¿™ï¼Œä»»åŠ¡è¢«æŒ‚èµ·<br>* W ä»»åŠ¡åœ¨ç­‰å¾…å®ƒæ‰€è¯·æ±‚çš„æ‰§è¡Œæ—¶é—´çš„åˆ°æ¥(qsub -a)<br>* X åªç”¨äºå­ä»»åŠ¡ï¼Œè¡¨ç¤ºå­ä»»åŠ¡å®Œæˆ<br>* C è¡¨ç¤ºç¨‹åºæ­£åœ¨è¢«å…³é—­ï¼Œä¸€èˆ¬æ˜¯ç¨‹åºè¿è¡Œé”™è¯¯ï¼ŒæŠ¥é”™</p></li><li><p>Queue ä»»åŠ¡æ‰§è¡Œæ‰€åœ¨é˜Ÿåˆ—</p></li></ul><p><strong>qstat -q ï¼ˆåˆ—å‡ºé˜Ÿåˆ—ä½¿ç”¨ä¿¡æ¯ï¼‰</strong><br><strong>qstat -n ï¼ˆåˆ—å‡ºé˜Ÿåˆ—ä¸­ä½¿ç”¨çš„èŠ‚ç‚¹ï¼‰</strong><br><strong>qstat -f jobid ï¼ˆæŸ¥çœ‹jobidä»»åŠ¡çš„è¯¦ç»†ä¿¡æ¯ï¼‰</strong></p></blockquote><ul><li><strong>æäº¤</strong>ä»»åŠ¡åˆ°é›†ç¾¤<br>qsub æ–‡ä»¶å.pbs&#x2F;.sh ï¼ˆæäº¤ä»»åŠ¡ï¼‰<br>echo â€œscript.pyâ€ | qsub -l q batch1 -l nodes&#x3D;1:ppn&#x3D;2 (ç›´æ¥åœ¨ç»ˆç«¯è®¾ç½®PBSèµ„æºå‘½ä»¤ï¼Œå¹¶åœ¨æ­¤èµ„æºä¸‹æäº¤å¯æ‰§è¡Œè„šæœ¬)</li><li><strong>ä»»åŠ¡æŒ‚èµ·ï¼Œé‡Šæ”¾ï¼Œé‡æ–°åŠ è½½</strong><br>qholdï¼šæŒ‚èµ·ä½œä¸š<br>qrlsï¼šé‡Šæ”¾æŒ‚èµ·çš„ä½œä¸š<br>qrerunï¼šé‡æ–°è¿è¡Œä½œä¸š</li><li><strong>ä»»åŠ¡æ›´æ”¹</strong><br>qmoveï¼šå°†ä½œä¸šç§»åŠ¨åˆ°å¦ä¸€ä¸ªé˜Ÿåˆ—<br>qalterï¼š æ›´æ”¹ä½œä¸šèµ„æºå±æ€§</li><li>åˆ é™¤ä»»åŠ¡<br><strong>qdel jobid</strong> ï¼ˆå–æ¶ˆä»»åŠ¡ï¼‰</li></ul><h3 id="2-3-qsub-æäº¤ä»»åŠ¡"><a href="#2-3-qsub-æäº¤ä»»åŠ¡" class="headerlink" title="2.3 qsub æäº¤ä»»åŠ¡"></a><strong>2.3 qsub æäº¤ä»»åŠ¡</strong></h3><p><strong>2.3.1 é€šè¿‡ç»ˆç«¯æäº¤ä»»åŠ¡</strong></p><ul><li>é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ä¼ é€’ç»™ qsub å‘½ä»¤</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo &quot;python script.py -i inputdir -o outdir &quot; | qsub -q Batch1 -l nodes=1:ppn=1 -l mem=40gb -N jobname<br></code></pre></td></tr></table></figure><p><strong>æ‰§è¡Œscript.py è„šæœ¬ï¼Œ é€šè¿‡pbsæŠ•é€’ä»»åŠ¡, ä»»åŠ¡æäº¤åˆ°Batch1é˜Ÿåˆ—ï¼Œæ‰€éœ€èµ„æºä¸ºï¼Œ1ä¸ªèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹ä½¿ç”¨1ä¸ªcpu, 40GBç‰©ç†å†…å­˜ï¼Œè¯¥ä»»åŠ¡å‘½åjobname</strong></p><ul><li>-N ä»»åŠ¡åç§°</li><li>-q æŒ‡å®šQueue</li><li><font color="red">-l</font> resource_list æŒ‡å®š<font color="red">ä»»åŠ¡æ‰€éœ€èµ„æº</font><br>ä¸€èˆ¬åŒ…æ‹¬ï¼š<br>* cput&#x3D;Nï¼Œ è¯·æ±‚Nç§’CPUæ—¶é—´ï¼ŒNä¹Ÿå¯ä»¥å†™æˆhh:mm::ssï¼Œå•ä½åˆ†åˆ«æ˜¯ æ—¶ï¼šåˆ†ï¼šç§’<br>* mem&#x3D;N[K|M|G|][B|W], è¯·æ±‚Nå¤§å°çš„<font color="red">å†…å­˜</font><br>* nodes&#x3D;N, Nä¸ª<font color="red">èŠ‚ç‚¹</font><br>* ppn&#x3D;M, æ¯ä¸ªèŠ‚ç‚¹éœ€è¦Mä¸ª<font color="red">cpu</font></li><li>-e path å°†æ ‡å‡†é”™è¯¯é‡å®šå‘åˆ°path</li><li>-o path æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°path</li><li>-j join å°†æ ‡å‡†è¾“å‡ºä¿¡æ¯ä¸æ ‡å‡†é”™è¯¯ä¿¡æ¯åˆå¹¶åˆ°åŒä¸€ä¸ªæ–‡ä»¶joinä¸­å»</li><li>-p priority ä»»åŠ¡ä¼˜å…ˆçº§ï¼Œæ•´æ•°ï¼Œæ— å®šä¹‰é»˜è®¤0</li><li>-m mail_options mail_option &#x3D;aï¼šå·¦å³abortæ—¶ç»™ç”¨æˆ·å‘ä¿¡ï¼›&#x3D;bï¼šä½œä¸šå¼€å§‹æ—¶å‘ä¿¡ï¼›&#x3D;eï¼šä½œä¸šç»“æŸæ—¶å‘ä¿¡. é»˜è®¤&#x3D;a</li></ul><p><strong>2.3.2 <font color="red">PBSé€šè¿‡shè„šæœ¬æ‰§è¡Œå‘½ä»¤</font></strong></p><ul><li><font color="red">åœ¨ PBS è„šæœ¬ä¸­ä»¥ #PBS æ–¹å¼æŒ‡å®š</font><br>åœ¨PBSç³»ç»Ÿä¸­ï¼Œç”¨æˆ·ä½¿ç”¨qsubå‘½ä»¤æäº¤ç”¨æˆ·ç¨‹åºã€‚ç”¨æˆ·è¿è¡Œç¨‹åºçš„å‘½ä»¤ ä»¥åŠ PBSç¯å¢ƒå˜é‡è®¾ç½® å…±åŒç»„æˆäº†PBSä½œä¸šè„šæœ¬ã€‚</li><li>æ³¨é‡Šä¸º â€œ#â€ å¼€å¤´</li><li>PBSæŒ‡ä»¤ä¸º â€œ#PBSâ€ å¼€å¤´</li><li>shellå‘½ä»¤ ï¼ˆè¿è¡Œè„šæœ¬çš„å‘½ä»¤ï¼‰</li></ul><p>ä¾‹å¦‚ run.sh</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">å‚æ•°è§£æ</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">æŒ‡å®šèŠ‚ç‚¹æ•°ç›® ppnæŒ‡æ¯ä¸ªèŠ‚ç‚¹è¿è¡Œçš„cpuæ•°é‡ï¼ˆ4ä¸ªå°èŠ‚ç‚¹ï¼Œæ¯ä¸ª48ä¸ªCPUï¼‰</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">PBS -l nodes=1:ppn=16</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">æŒ‡å®šåˆå¹¶åˆ°æ ‡å‡†è¾“å‡ºæ–‡ä»¶ä¸­</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">PBS -j oe</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">è®¾ç½®ç¨‹åºè¿è¡Œçš„æœ€å¤§æ—¶é—´192å°æ—¶</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">PBS -l walltime=192:00:00</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">æŒ‡å®šqsubçš„æ‰€æœ‰ç¯å¢ƒå˜é‡éƒ½ä¼ é€’åˆ°æ‰¹å¤„ç†ä½œä¸šä¸­</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">PBS -V</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">è¾“å‡ºæ–‡ä»¶</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">PBS -o /public/home/tang/chaim/back_info/<span class="hljs-variable">$jobname</span>.out</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">é”™è¯¯è¾“å‡ºæ–‡ä»¶</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">PBS -e /public/home/tang/chaim/back_info/<span class="hljs-variable">$jobname</span>.err</span><br>cd PBS_O_OUTDIR<br><span class="hljs-meta prompt_"># </span><span class="language-bash">ç¨‹åºæ‰§è¡Œå‘½ä»¤</span><br>python script.py -i inputdir -o outdir <br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">æ‰§è¡Œè„šæœ¬</span><br>qsub run.sh<br><span class="hljs-meta prompt_"># </span><span class="language-bash">åˆ¶å®šå‘½ä»¤å¼€å§‹è¿è¡Œçš„æ—¶é—´</span>  <br>qusb -a 070000 run.s  #7å¤©åè¿è¡Œç¨‹åºï¼Œæ­¤æ—¶æ˜¯å¤„äºWçŠ¶æ€(ç­‰å¾…çŠ¶æ€)<br>qsub -a 2400 run.s #24håè¿è¡Œç¨‹åº<br></code></pre></td></tr></table></figure><p><strong>2.3.3 é€šè¿‡äº¤äº’å¼çš„æ–¹å¼æ‰§è¡Œä»»åŠ¡</strong></p><ul><li><strong>qsub -I</strong></li><li>qsub -I -q Batch1 -l nodes&#x3D;1:ppn&#x3D;1 -l mem&#x3D;80gb -N jobname</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">[#</span><span class="language-bash">11<span class="hljs-comment">#Rd01@login ~]$</span></span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">qsub -I -q Batch1 -l nodes=1:ppn=1 -l mem=80gb -N jobname</span><br>qsub: waiting for job 1230615.admin to start<br>qsub: job 1230615.admin ready<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">[#</span><span class="language-bash">1<span class="hljs-comment">#Rd01@comput4 ~]$</span></span><br><span class="hljs-meta prompt_">$</span><br></code></pre></td></tr></table></figure><h3 id="2-4-PBSå¸¸ç”¨ç¯å¢ƒå˜é‡"><a href="#2-4-PBSå¸¸ç”¨ç¯å¢ƒå˜é‡" class="headerlink" title="2.4 PBSå¸¸ç”¨ç¯å¢ƒå˜é‡"></a><strong>2.4 PBSå¸¸ç”¨ç¯å¢ƒå˜é‡</strong></h3><ul><li>PBS_ENVIRONMENTï¼šæ‰¹å¤„ç†ä½œä¸šä¸º PBS_BATCHï¼Œäº¤äº’å¼ä½œä¸šä¸º PBS_INTERACTIVE</li><li>PBS_JOBIDï¼šPBS ç³»ç»Ÿç»™ä½œä¸šåˆ†é…çš„æ ‡è¯†å·</li><li>PBS_JOBNAMEï¼šç”¨æˆ·æŒ‡å®šçš„ä½œä¸šåç§°</li><li>PBS_NODEFILEï¼šåŒ…å«ä½œä¸šæ‰€ç”¨è®¡ç®—èŠ‚ç‚¹çš„æ–‡ä»¶å</li><li>PBS_QUEUEï¼šä½œä¸šæ‰€æ‰§è¡Œçš„é˜Ÿåˆ—åç§°</li><li>PBS_O_HOMEï¼šæ‰§è¡Œ qsub å‘½ä»¤çš„ HOME ç¯å¢ƒå˜é‡å€¼</li><li>PBS_O_PATHï¼šæ‰§è¡Œ qsub å‘½ä»¤çš„ PATH ç¯å¢ƒå˜é‡å€¼</li><li>PBS_O_SHELLï¼šæ‰§è¡Œ qsub å‘½ä»¤çš„ SHELL ç¯å¢ƒå˜é‡å€¼</li><li>PBS_O_HOSTï¼šæ‰§è¡Œ qsub å‘½ä»¤èŠ‚ç‚¹åç§°</li><li>PBS_O_QUEUEï¼šæäº¤ä½œä¸šçš„æœ€åˆé˜Ÿåˆ—åç§°</li><li>PBS_O_WORKDIRï¼šæ‰§è¡Œ qsub å‘½ä»¤æ‰€åœ¨çš„ç»å¯¹è·¯å¾„</li></ul><h1 id="è°ƒåº¦å™¨"><a href="#è°ƒåº¦å™¨" class="headerlink" title="è°ƒåº¦å™¨"></a>è°ƒåº¦å™¨</h1><p><strong>å¦‚æœæœ‰ä¸€å¤©ï¼Œä½ æœ‰16ä¸‡ä¸ªCPUï¼Œä½ è¦æ€ä¹ˆç”¨ï¼Ÿ</strong> <strong>è°ƒåº¦å™¨</strong>æœ€å¤§ç¨‹åº¦å‹æ¦¨ç°æœ‰<strong>èµ„æºæˆ–æ—¶é—´çš„æœ€å¤§ä»·å€¼</strong>ã€‚</p><p>ä¸åŒè¡Œä¸šå› ä½¿ç”¨ä¹ æƒ¯å’Œä¸åŒè°ƒåº¦å™¨å¯¹åº”ç”¨çš„æ”¯æŒåŠ›åº¦ä¸åŒï¼Œå¾€å¾€æœ‰ä¸åŒåå¥½ï¼š<strong>æ¯”å¦‚é«˜æ ¡å’Œè¶…ç®—ç»å¸¸ç”¨Slurmï¼ŒåŠå¯¼ä½“å…¬å¸æœ€å¸¸ç”¨çš„æ˜¯LSFå’ŒSGEï¼Œå·¥ä¸šåˆ¶é€ ä¸šå¯èƒ½ç”¨PBSæ›´å¤šä¸€äº›ã€‚</strong></p><p>1ç¯‡ <a href="https://fastonetech.com/blog/biotech-fastone-help-hms-on-molecules-selection-20200709/">15å°æ—¶è™šæ‹Ÿç­›é€‰10äº¿åˆ†å­ï¼Œã€ŠNatureã€‹+HMSéªŒè¯äº‘ç«¯æ–°è¯ç ”å‘æœªæ¥</a> æ–‡ç« é‡Œå“ˆä½›å¤§å­¦åŒ»å­¦é™¢ç”¨<strong>äº‘ç«¯16ä¸‡ä¸ªCPUæ¥ç­›é€‰10äº¿ç§åŒ–åˆç‰©</strong>ï¼Œåªç”¨äº†15å°æ—¶ã€‚<br><strong>è¶…å¤§è§„æ¨¡è®¡ç®—é›†ç¾¤ä¸Šçš„å·¥ä½œæµç¨‹å›¾</strong>ï¼š</p><p><img src="/GeekFocus/2022-03-06-Linux-grid/5.png"><br><img src="/GeekFocus/img/2022-03-06-Linux-grid/5.png" alt="è°ƒåº¦å™¨-ç”Ÿä¿¡åˆ†æ-é«˜æ€§èƒ½è®¡ç®—é›†ç¾¤-åŒ–åˆç‰©ç­›é€‰"></p><p>è“è‰²æ¡†è¡¨ç¤ºè®¡ç®—èŠ‚ç‚¹ï¼Œå…¶ä¸­åŒ…å«CPUæ ¸æ•°ï¼ˆè“è‰²æ¡†å†…çš„é»‘è‰²æ­£æ–¹å½¢ï¼‰ï¼Œç´«è‰²å°åœ†åœˆä»£è¡¨å¾…å¤„ç†çš„é…ä½“ã€‚æ•´å¼ å›¾ä»£è¡¨æ•´ä¸ªè®¡ç®—é›†ç¾¤ï¼Œå¹¶è¡Œè¿è¡Œ1.1åˆ°X.1ä¸ªä»»åŠ¡ï¼Œä»»åŠ¡1.1å®Œæˆåä¼šè‡ªåŠ¨è¿è¡Œä»»åŠ¡1.2ï¼Œä»¥æ­¤ç±»æ¨ç›´åˆ°ä»»åŠ¡å®Œæˆã€‚<br>æ¯ä¸ªä»»åŠ¡ï¼ˆåŒ…å«å¤šä¸ªå­ä»»åŠ¡ï¼‰ä½¿ç”¨3ä¸ªè®¡ç®—èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰8ä¸ªCPUæ ¸ã€‚</p><p><strong>å‡è®¾æœ‰10äº¿åŒ–åˆç‰©éœ€è¦ç­›é€‰ï¼Œé¢å¯¹16ä¸‡CPUï¼ŒæŠŠæµç¨‹å›¾é‡Œç¼ºä¹çš„æ—¶é—´ç»´åº¦è€ƒè™‘è¿›æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å¤šæ€è€ƒå‡ ä¸ªé—®é¢˜ï¼š</strong></p><ol><li><strong>16ä¸‡CPUï¼Œæ€ä¹ˆé¡ºåˆ©ä¸€ä¸€é…ç½®ï¼Œå¯åŠ¨ï¼Œå…³é—­ï¼Ÿ</strong></li><li><strong>æ€ä¹ˆèƒ½è®©é›†ç¾¤æ•´ä½“èµ„æºåˆ©ç”¨ç‡æœ€é«˜ï¼Ÿè·‘æ›´å¤šä»»åŠ¡ï¼Ÿ</strong></li><li><strong>èƒ½ä¸èƒ½æŒ‡å®šç‰¹å®šä»»åŠ¡åœ¨æŸç§ç±»å‹è®¡ç®—èŠ‚ç‚¹ä¸Šè¿è¡Œï¼Ÿ</strong></li><li><strong>ä»»åŠ¡ä¹‹é—´å­˜åœ¨å…ˆåé¡ºåºï¼Œèƒ½å¦ç¡®ä¿ç‰¹å®šä»»åŠ¡ä¸€å®šå…ˆè¿è¡Œï¼Ÿ</strong></li><li><strong>æ€ä¹ˆç»Ÿè®¡å’Œé™åˆ¶ä¸åŒç”¨æˆ·çš„ç”¨é‡ï¼Ÿ</strong></li><li><strong>æ€ä¹ˆç›‘æ§æ¯ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€å’Œä½¿ç”¨æƒ…å†µï¼Ÿ</strong></li><li><strong>æ€ä¹ˆé™ä½é›†ç¾¤çš„æ•´ä½“è¿è¡Œæˆæœ¬ï¼Ÿé¿å…æµªè´¹ï¼Ÿ</strong></li><li><strong>è®¡ç®—èŠ‚ç‚¹é—´ç½‘ç»œ&#x2F;æ•°æ®ä¼ è¾“æ€ä¹ˆè€ƒè™‘ï¼Ÿ</strong></li><li><strong>å¦‚ä½•åº”å¯¹äº‘ä¸Šé›†ç¾¤èµ„æºé«˜åº¦åŠ¨æ€çš„ç‰¹æ€§ï¼Ÿç©ºé—²èµ„æºä¸è¶³æ—¶æ€ä¹ˆåŠï¼Ÿ</strong></li></ol><p>å¦‚æœè¿˜ä¸æ˜¯ç‰¹åˆ«æ˜ç™½ï¼Œå†æ‰“ä¸ªæ¯”æ–¹ã€‚è®¤çœŸæƒ³åƒä¸€ä¸‹ä½ æ˜¯è€æ¿ï¼Œæ‰‹é‡Œæœ‰ä¸”åªæœ‰100ä¸ªæ‰“å·¥äººï¼Œä½ æƒ³æƒ³è¦æ€ä¹ˆç®¡ç†æ‰èƒ½è®©ä»–ä»¬æ›´å¥½åœ°ä¸ºä½ å·¥ä½œï¼Ÿï¼Ÿ</p><p><strong>åŸºäºè¿™å‡ å®¶ä¸»æµè°ƒåº¦å™¨ï¼šLSF&#x2F;SGE&#x2F;Slurm&#x2F;PBSä»¥åŠå®ƒä»¬çš„ä¸åŒæ¼”åŒ–ç‰ˆæœ¬è¿›è¡Œäº†æ¢³ç†å’Œç›˜ç‚¹ï¼Œå°¤å…¶æ˜¯å¯¹äº‘çš„æ”¯æŒæ–¹é¢åˆ’äº†é‡ç‚¹ã€‚</strong></p><h2 id="LSF"><a href="#LSF" class="headerlink" title="LSF"></a>LSF</h2><p><strong>åŸºäºLSFï¼ˆLoad Sharing Facilityï¼‰çš„è°ƒåº¦å™¨ä¸»è¦æœ‰Spectrum LSFã€PlatformLSFã€OpenLavaä¸‰å®¶ã€‚</strong></p><p>æ—©æœŸLSFç”±Torontoå¤§å­¦å¼€å‘çš„Utopiaç³»ç»Ÿå‘å±•è€Œæ¥ã€‚<br>2007å¹´ï¼Œ<strong>Platform Computing</strong>åŸºäºæ—©æœŸè€ç‰ˆæœ¬çš„LSFå¼€æºäº†ä¸€ä¸ªç®€åŒ–ç‰ˆPlatform Lavaã€‚</p><p>è¿™ä¸ªå¼€æºé¡¹ç›®2011å¹´ä¸­æ­¢äº†ï¼Œè¢«<strong>OpenLava</strong>æ¥æ‰‹ã€‚<br>2011å¹´ï¼ŒPlatformå‘˜å·¥David BigagliåŸºäºPlatform Lavaçš„æ´¾ç”Ÿä»£ç åˆ›å»ºäº†OpenLava 1.0ã€‚2014å¹´ï¼Œä¸€äº›Platformçš„å‘˜å·¥æˆç«‹äº†Teraprocå…¬å¸ï¼Œä¸ºOpenLavaæä¾›å¼€å‘å’Œå•†ä¸šæ”¯æŒã€‚<strong>2016å¹´IBMå°±LSFç‰ˆæƒå¯¹Teraprocå…¬å¸å‘èµ·è¯‰è®¼ï¼Œ2018å¹´IBMèƒœè¯‰ï¼ŒOpenLavaè¢«ç¦ç”¨ã€‚</strong></p><p>2011å¹´ï¼ŒPlatform Lavaå¼€æºé¡¹ç›®ä¸­æ­¢åã€‚<strong>2012å¹´1æœˆï¼ŒIBMæ”¶è´­äº†Platform Computingã€‚Spectrum LSF</strong>å°±æ˜¯IBMæ”¶è´­åæ¨å‡ºçš„å•†ç”¨ç‰ˆæœ¬ï¼Œç›®å‰æ›´æ–°åˆ°10.1.0ï¼ŒåŒæ—¶æ”¯æŒLinuxå’ŒWindowsï¼Œ<font color="red">æœ€å¤§èŠ‚ç‚¹æ•°è¶…è¿‡6000ï¼Œåœ¨å›½å†…æä¾›å•†ä¸šæ”¯æŒã€‚</font><br><strong>Platform LSF</strong>æ˜¯LSFçš„æ—©æœŸç‰ˆæœ¬ï¼Œä¸Spectrum LSFä¸€æ ·å±äºIBMï¼Œç›®å‰ç‰ˆæœ¬æ˜¯9.1.3ï¼Œç›®æµ‹å·²ç»åœæ­¢æ›´æ–°ä»¥ç»´æŠ¤ä¸ºä¸»ã€‚</p><h2 id="SGE"><a href="#SGE" class="headerlink" title="SGE"></a>SGE</h2><p><strong>åŸºäºSGEï¼ˆSun Grid Engineï¼‰çš„è°ƒåº¦å™¨åŒ…æ‹¬UGEï¼ˆUniva Grid Engineï¼‰å’ŒSGEï¼ˆSon of Grid Engineï¼‰ã€‚</strong></p><p>1993å¹´ï¼Œ<strong>Grid Engine</strong>ä½œä¸ºå•†ä¸šè½¯ä»¶å‘å¸ƒï¼Œå…ˆåä½¿ç”¨äº†<strong>CODINE</strong>ï¼ˆComputing in Distributed Networked Environmentsï¼‰ã€<strong>GRD</strong>ï¼ˆGlobal Resource Directorï¼‰ä½œä¸ºåç§°ã€‚1999å¹´ï¼Œç¬¬ä¸€æ¬¡ç”±Genias Softwareæ¨å‡ºå¸‚åœºï¼Œç„¶åè¢«Gridwareå…¬å¸æ”¶è´­ã€‚ç›´åˆ°2000å¹´è¢«SUNæ”¶è´­ä¹‹åæ­£å¼æ”¹å<strong>Sun Grid Engine</strong>ï¼Œ2001å¹´å‘å¸ƒå¼€æºç‰ˆã€‚</p><p>2010å¹´è¢«Oracleæ”¶è´­åæ”¹å<strong>Oracle Grid Engine</strong>ï¼Œæ”¹æˆé—­æºç‰ˆï¼Œä¸æä¾›æºä»£ç ã€‚åŸæ¥å¼€æºé¡¹ç›®çš„èµ„æ–™åº“ç¦æ­¢ç”¨æˆ·ä¿®æ”¹ã€‚<br>äºæ˜¯ï¼ŒGrid Engineç¤¾åŒºå¼€å§‹å¼€æºç‰ˆæœ¬çš„<strong>SGE</strong>ï¼ˆ<strong>Son of Grid Engine</strong>ï¼‰é¡¹ç›®ã€‚è¯¥è°ƒåº¦å™¨æœ€åä¸€æ¬¡æ›´æ–°ä¸º2016å¹´çš„8.1.9ï¼Œç”±äºå­˜åœ¨ç‰ˆæƒé£é™©ï¼ŒSGEå·²é•¿æœŸæ— ç»´æŠ¤å’Œæ›´æ–°ã€‚</p><p>2013å¹´Univaæ”¶è´­äº†Oracle Grid Engineï¼Œæˆä¸ºå”¯ä¸€å•†ä¸šè½¯ä»¶<strong>UGEï¼ˆUniva Grid Engineï¼‰</strong>æä¾›å•†ã€‚UGEæœ€æ–°ç‰ˆæœ¬ä¸º8.6.15ï¼ŒåŒæ—¶æ”¯æŒLinuxå’ŒWindowsï¼Œå›½å†…æš‚æ— å•†ä¸šæ”¯æŒçš„ç›¸å…³ä¿¡æ¯ã€‚<br>2020å¹´9æœˆï¼ŒAltairæ”¶è´­äº†Univaã€‚</p><h2 id="Slurm-å››å¤§æµæ´¾é‡Œå”¯ä¸€çº¯å¼€æºæ´¾"><a href="#Slurm-å››å¤§æµæ´¾é‡Œå”¯ä¸€çº¯å¼€æºæ´¾" class="headerlink" title="Slurm å››å¤§æµæ´¾é‡Œå”¯ä¸€çº¯å¼€æºæ´¾"></a>Slurm <strong>å››å¤§æµæ´¾é‡Œå”¯ä¸€çº¯å¼€æºæ´¾</strong></h2><p><font color="red"><strong>Slurmå…¨ç§°ä¸ºSimple Linux Utility for Resource Management</strong></font>ï¼Œå‰æœŸä¸»è¦ç”±åŠ³ä¼¦æ–¯åˆ©å¼—è«å°”å›½å®¶å®éªŒå®¤ã€SchedMDã€Linux NetworXã€Hewlett-Packard å’Œ Groupe Bull è´Ÿè´£å¼€å‘ï¼Œå—åˆ°é—­æºè½¯ä»¶Quadrics RMSçš„å¯å‘ã€‚</p><p>Slurmæœ€æ–°ç‰ˆæœ¬ä¸º20.02ï¼Œç›®å‰ç”±ç¤¾åŒºå’ŒSchedMDå…¬å¸å…±åŒç»´æŠ¤ï¼Œ<strong>ä¿æŒå¼€æºå’Œå…è´¹</strong>ï¼Œç”±SchedMDå…¬å¸æä¾›å•†ä¸šæ”¯æŒï¼Œä»…æ”¯æŒLinuxç³»ç»Ÿï¼Œ<font color="red">æœ€å¤§èŠ‚ç‚¹æ•°é‡è¶…è¿‡12ä¸‡</font>ã€‚<br>Slurmæ‹¥æœ‰<font color="red">å®¹é”™ç‡é«˜ã€æ”¯æŒå¼‚æ„èµ„æºã€é«˜åº¦å¯æ‰©å±•ç­‰ä¼˜ç‚¹ï¼Œæ¯ç§’å¯æäº¤è¶…è¿‡1000ä¸ªä»»åŠ¡ï¼Œä¸”ç”±äºæ˜¯å¼€æ”¾æ¡†æ¶ï¼Œé«˜åº¦å¯é…ç½®ï¼Œæ‹¥æœ‰è¶…è¿‡100ç§æ’ä»¶ï¼Œå› æ­¤é€‚ç”¨æ€§ç›¸å½“å¼ºã€‚</font></p><p><strong>å…¨çƒ60%çš„TOP500è¶…ç®—ä¸­å¿ƒå’Œè¶…å¤§è§„æ¨¡é›†ç¾¤ï¼ˆåŒ…æ‹¬æˆ‘å›½çš„å¤©æ²³äºŒå·ç­‰ï¼‰éƒ½é‡‡ç”¨Slurmä½œä¸ºè°ƒåº¦ç³»ç»Ÿã€‚æˆ‘ä»¬çš„TOP500å°±æ˜¯ç”¨Slurmè°ƒåº¦äº‘ä¸Šèµ„æºè·‘çš„ã€‚</strong><a href="https://fastonetech.com/blog/top500/">ä¸Šæ¦œå•¦ï½èŠ±è´¹4å°æ—¶5500ç¾å…ƒï¼Œé€ŸçŸ³ç§‘æŠ€è·»èº«å…¨çƒè¶…ç®—TOP500</a></p><p>æ”¯æŒåœ¨Slurmä¸Šçš„é›†ç¾¤è‡ªåŠ¨ä¼¸ç¼©å’Œäº‘ç«¯è´¹ç”¨ç›‘æ§ï¼Œå¹¶æ”¯æŒAWSã€é˜¿é‡Œäº‘ã€Azureã€è…¾è®¯äº‘ã€åä¸ºäº‘ã€Google Cloudç­‰äº‘å‚å•†ã€‚</p><p><strong><a href="https://fastonetech.com/blog/case-vina-20201021/">ç”Ÿä¿¡äº‘å®è¯Vol.3</a>ï¼šæé€Ÿ2920å€ï¼ç”¨AutoDockVinaå¯¹æ¥2800ä¸‡ä¸ªåˆ†å­  è¿™ç¯‡ä¸»è¦åŸºäºç”¨æˆ·ä¸åŒçš„ç­–ç•¥ï¼Œè·¨åŒºã€è·¨ç±»å‹è‡ªåŠ¨ä¸ºç”¨æˆ·è°ƒåº¦äº‘èµ„æºï¼Œå¦‚ä½•ä»¥æœ€å¿«é€Ÿåº¦oræœ€ä½æˆæœ¬å®Œæˆè®¡ç®—ä»»åŠ¡ã€‚</strong></p><h2 id="PBS"><a href="#PBS" class="headerlink" title="PBS"></a>PBS</h2><p><strong>åŸºäºPBSï¼ˆPortable Batch Systemï¼‰çš„è°ƒåº¦å™¨åŒ…æ‹¬OpenPBSã€PBS PROã€Moab&#x2F;TORQUEã€‚</strong></p><p>PBSæœ€åˆæ˜¯ç”±MRJ Technology Solutionsäº 1991 å¹´ 6 æœˆå¼€å§‹ä¸º <font color="red">NASA æ‰€ç ”å‘çš„ä½œä¸šè°ƒåº¦ç³»ç»Ÿ</font>ï¼ŒMRJäº 20 ä¸–çºª90 å¹´ä»£æœ«è¢« Veridian æ”¶è´­ã€‚2003å¹´ï¼ŒAltairæ”¶è´­äº†Veridianï¼Œè·å¾—äº†PBSçš„æŠ€æœ¯å’ŒçŸ¥è¯†äº§æƒã€‚<br><font color="red"><strong>PBS Pro</strong></font>æ˜¯Altairæ——ä¸‹PBS WORKSæä¾›çš„<font color="red">å•†ä¸šç‰ˆæœ¬ï¼Œæ”¯æŒå¯è§†åŒ–ç•Œé¢ï¼ŒèŠ‚ç‚¹æ•°è¶…è¿‡50000ä¸ªã€‚</font></p><p>2016å¹´AltairåŸºäº<strong>PBS Pro</strong>æä¾›äº†å¼€æºè®¸å¯ç‰ˆæœ¬ï¼Œå…¶ä¸MRJäº1998å¹´å‘å¸ƒçš„åŸå§‹å¼€æºç‰ˆæœ¬ä¸¤è€…åˆäºŒä¸ºä¸€å¤§è‡´å°±æ˜¯ç°åœ¨çš„<font color="red"><strong>OpenPBS</strong></font>ã€‚<font color="red">ä¸Proç‰ˆæœ¬æ¯”ï¼Œå¤šäº†å¾ˆå¤šé™åˆ¶ï¼Œä½†éƒ½æ”¯æŒLinuxå’ŒWindowsã€‚</font></p><p><strong>Moab&#x2F;TORQUEåˆåœ¨ä¸€èµ·æ˜¯ä¸€ä¸ªå®Œæ•´è°ƒåº¦å™¨çš„åŠŸèƒ½ï¼Œç°åœ¨å±äºåŒä¸€å®¶å…¬å¸Adaptive Computingã€‚</strong>90å¹´ä»£ä¸­æœŸç”±MHPCCçš„David Jacksonå¼€å‘çš„Mauiï¼Œä»–åæ¥åˆ›ç«‹äº†Adaptive Computingã€‚</p><p><strong>Moab</strong>æ˜¯Adaptive Computing å…¬å¸ï¼ˆå‰èº«ä¸º Cluster Resources å…¬å¸å¼€å‘çš„Maui Cluster Schedulerï¼‰ç»´æŠ¤çš„ OpenPBS åˆ†æ”¯ï¼Œ2003å¹´å‘å¸ƒã€‚è¯¥é¡¹ç›®æœ€åˆæ˜¯å¼€æºå…è´¹çš„ï¼Œåæ¥å˜æˆäº†å•†ç”¨è½¯ä»¶Moabåä¸å†å…è´¹ã€‚</p><p><strong>TORQUE</strong>ï¼ˆTerascale Open-source Resource and QUEue Managerï¼‰æ—©æœŸçš„ Torque ä¹Ÿæ˜¯å¼€æºå…è´¹è½¯ä»¶ï¼Œä¸è¿‡ 2018 å¹´ 6 æœˆå¼€å§‹ TORQUE ä¸å†å¼€æºã€‚<br><font color="red">ä¸¤è€…å‡åªæ”¯æŒLinuxç³»ç»Ÿï¼Œæä¾›å¯è§†åŒ–ç•Œé¢ï¼Œæ‹¥æœ‰çº¦æ•°åƒä¸ªèŠ‚ç‚¹ã€‚</font></p><p>äº‘æœåŠ¡æ–¹é¢ï¼ŒPBS Proèƒ½é€šè¿‡<strong>Altair Controläº§å“</strong>ä»æœ¬åœ°æº¢å‡ºåˆ°å¤šäº‘å’ŒAuto-Scaleé›†ç¾¤è‡ªåŠ¨ä¼¸ç¼©ï¼Œæ”¯æŒçš„äº‘å‚å•†åŒ…æ‹¬AWSã€Azureå’ŒGoogle Cloudã€‚</p><p>Moab&#x2F;TORQUE åˆ™å¯é€šè¿‡ <strong>NODUSCloud OS äº§å“</strong>å®ç°æœ¬åœ°æ‰©å±•åˆ°äº‘ï¼Œæ”¯æŒTORQUE æˆ– Slurmé›†ç¾¤å’Œè‡ªåŠ¨ä¼¸ç¼©ï¼Œå¯æ”¯æŒçš„äº‘å‚å•†åŒ…æ‹¬AWSã€Azureã€GoogleCloud å’Œåä¸ºäº‘ï¼Œå¹¶é€šè¿‡ Account Manager äº§å“å®ç°äº‘ç«¯è´¹ç”¨ç›‘æ§ã€‚</p><hr><p>ref</p><p> <a href="https://fastonetech.com/blog/cluster-scheduler-20201105/">https://fastonetech.com/blog/cluster-scheduler-20201105/</a></p><p><a href="https://www.jianshu.com/p/45e3f88086f3">https://www.jianshu.com/p/45e3f88086f3</a></p><p><a href="https://www.jianshu.com/p/b7b540a3c015">https://www.jianshu.com/p/b7b540a3c015</a></p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>grid</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HiFi-4-QC-BUSCO</title>
    <link href="/GeekFocus/2022/03/05/2022-03-02-HiFi-4-BUSCO/"/>
    <url>/GeekFocus/2022/03/05/2022-03-02-HiFi-4-BUSCO/</url>
    
    <content type="html"><![CDATA[<p>BUSCO - <strong>B</strong>enchmarking <strong>U</strong>niversal <strong>S</strong>ingle-<strong>C</strong>opy <strong>O</strong>rthologs</p><p>æ™®éé€šç”¨çš„å•æ‹·è´ç›´ç³»åŒæºæµ‹è¯•?</p><span id="more"></span><p>officialï¼š<a href="https://busco.ezlab.org/busco_userguide.html">https://busco.ezlab.org/busco_userguide.html</a></p><p>Ref:<a href="https://www.jianshu.com/p/5041460f7a5d">https://www.jianshu.com/p/5041460f7a5d</a></p><p>BUSCOæ˜¯ä½¿ç”¨pythonè¯­è¨€ç¼–å†™çš„<font color="blue">å¯¹<strong>è½¬å½•ç»„</strong>å’Œ<strong>åŸºå› ç»„ç»„è£…è´¨é‡</strong>è¿›è¡Œ<strong>è¯„ä¼°</strong></font>çš„è½¯ä»¶ã€‚ç›¸è¿‘ç‰©ç§é—´æ€»æœ‰ä¸€äº›ä¿å®ˆåºåˆ—ï¼ŒBUSCO<font color="blue">ä½¿ç”¨è¿™äº›<strong>ä¿å®ˆåºåˆ—</strong>ä¸<strong>ç»„è£…ç»“æœ</strong>è¿›è¡Œ<strong>æ¯”å¯¹</strong></font>ï¼Œé‰´å®šç»„è£…ç»“æœæ˜¯å¦åŒ…å«è¿™äº›åºåˆ—ï¼ŒåŒ…å«å•æ¡ã€å¤šæ¡è¿˜æ˜¯éƒ¨åˆ†æˆ–è€…ä¸åŒ…å«ç­‰æƒ…å†µç»™å‡ºç»“æœ</p><blockquote><p>BUSCO è½¯ä»¶æ ¹æ®<strong>OrthoDB æ•°æ®åº“</strong>ï¼Œæ„å»ºäº†<strong>å‡ ä¸ªå¤§çš„è¿›åŒ–åˆ†æ”¯</strong>çš„<strong>å•æ‹·è´åŸºå› é›†</strong>ã€‚å°†è½¬å½•æœ¬æ‹¼æ¥ç»“æœ<strong>ä¸è¯¥åŸºå› é›†æ¯”è¾ƒ</strong>ï¼Œæ ¹æ®æ¯”å¯¹ä¸Šçš„æ¯”ä¾‹ã€å®Œæ•´æ€§ï¼Œæ¥è¯„ä»·æ‹¼æ¥ç»“æœçš„<strong>å‡†ç¡®æ€§å’Œå®Œæ•´æ€§</strong></p></blockquote><p>åŸºäºå¤§é‡ç‰©ç§çš„<font color="blue">å•æ‹·è´åŸºå› æ„å»ºæ•°æ®é›†</font>ï¼Œç”¨äºè¯„ä¼°<font color="blue"><strong>åŸºå› ç»„ç»„è£…ï¼Œè½¬å½•ç»„ç»„è£…ï¼ŒåŸºå› æ³¨é‡Šï¼Œè›‹ç™½é›†çš„å®Œæ•´æ€§</strong></font>ã€‚core-genes æ„å»ºæ–¹å¼ï¼Œ90%ç‰©ç§å…±äº«çš„åŸºå› å³ä¸ºæ ¸å¿ƒåŸºå› ã€‚ä½¿ç”¨çš„æ˜¯ç›´ç³»åŒæºåŸºå› å®¶æ—çš„æ¦‚å¿µï¼ŒåŸºäº100ä¸ªç‰©ç§åŸºå› ç»„ï¼ŒæŸä¸€ä¸ªåŸºå› å®¶æ—å­˜åœ¨äº&gt;90ä¸ªåŸºå› ç»„ä¸­ï¼Œå³å°†è¯¥åŸºå› å®¶æ—è®¤å®šä¸ºæ ¸å¿ƒåŸºå› </p><p>BUSCOä½¿ç”¨å…¶ä»–å·¥å…·æ­å»ºæµç¨‹</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xl"><span class="hljs-function"><span class="hljs-title">genoem</span> assemble : tBLASTn --&gt;</span> A<span class="hljs-function"><span class="hljs-title">ugustus</span> --&gt;</span> HMMER3 âˆš<br>T<span class="hljs-function"><span class="hljs-title">ranscriptome</span>   :             Find ORF --&gt;</span> HMMER3<br>Gene set        :                          HMMER3<br></code></pre></td></tr></table></figure><h1 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h1><h2 id="conda"><a href="#conda" class="headerlink" title="conda"></a>conda</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment"># æ²¡æœ‰é•œåƒçš„è¯ï¼Œæ·»åŠ é•œåƒ</span><br>conda<span class="hljs-built_in"> config </span>--show <br>conda<span class="hljs-built_in"> config </span>--<span class="hljs-built_in">add</span> channels conda-forge<br><br><span class="hljs-comment"># æ„å»ºcondaçš„python3ç¯å¢ƒ</span><br>ã€conda create --name python36 <span class="hljs-attribute">python</span>=3.6ã€‘<br><span class="hljs-comment">#  ç„¶åæ¿€æ´»</span><br>ã€conda activate python36ã€‘<br><span class="hljs-comment"># æ‰§è¡Œå®‰è£…</span><br>ã€conda install -c conda-forge -c bioconda <span class="hljs-attribute">busco</span>=5.3.0ã€‘<br><span class="hljs-comment"># åœ¨ä½¿ç”¨å®Œbuscoä¹‹åå¯ä»¥é€€å‡ºpython36ç¯å¢ƒ</span><br>ã€conda deactivateã€‘<br><br></code></pre></td></tr></table></figure><h2 id="ç‹¬ç«‹å®‰è£…ï¼Ÿ"><a href="#ç‹¬ç«‹å®‰è£…ï¼Ÿ" class="headerlink" title="ç‹¬ç«‹å®‰è£…ï¼Ÿ"></a>ç‹¬ç«‹å®‰è£…ï¼Ÿ</h2><p>buscoï¼Œä¾èµ–Augustusï¼ŒHMMERï¼ŒBlast+</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#  ============ ä¸‹è½½BUSCO  ============ </span><br><span class="hljs-built_in">cd</span> ~/Applications/download<br>wget -c https://gitlab.com/ezlab/busco/-/archive/master/busco-master.zip -O busco.zip<br><br><span class="hljs-comment"># ============ ä¸‹è½½ä¾èµ–çš„å·¥å…· ============</span><br><span class="hljs-comment"># ä¸‹è½½Augustus</span><br>wget -c http://bioinf.uni-greifswald.de/augustus/binaries/augustus.current.tar.gz<br><span class="hljs-comment"># ä¸‹è½½HMMER</span><br>wget -c http://eddylab.org/software/hmmer/hmmer.tar.gz -O hmmer.tar.gz<br><span class="hljs-comment"># ä¸‹è½½Blast+</span><br>wget -c ftp://ftp.ncbi.nlm.nih.gov/blast/executables/LATEST/ncbi-blast-2.7.1+-x64-linux.tar.gz<br><span class="hljs-comment">#-------------------------------------------------------------------------------------</span><br><span class="hljs-built_in">cd</span> ~/Applications/download<br><br><span class="hljs-comment"># === å®‰è£…busco ===</span><br>unzip busco.zip<br><span class="hljs-comment"># æ”¹å</span><br><span class="hljs-built_in">mv</span> busco-master busco <br><span class="hljs-comment"># ç§»åŠ¨åˆ°å¤–éƒ¨</span><br><span class="hljs-built_in">mv</span> busco ../<br><span class="hljs-built_in">cd</span> ../busco<br><span class="hljs-comment"># å®‰è£…</span><br>python setup.py install<br><br><span class="hljs-built_in">cd</span> ~/Applications/download<br><span class="hljs-comment"># === å®‰è£…Augustus ===</span><br>tar -xzvf augustus.current.tar.gz<br><span class="hljs-built_in">cd</span> augustus-3.3.1<br><span class="hljs-built_in">cd</span> ../<br><span class="hljs-built_in">mv</span> augustus-3.3.1 ../<br><span class="hljs-built_in">cd</span> ../augustus-3.3.1<br><span class="hljs-comment"># æ‰“å¼€common.mkæ–‡ä»¶ï¼Œå°†ZIPINPUT = trueæ³¨é‡Šæ‰ï¼ˆå³åœ¨æœ€å‰é¢åŠ ä¸€#å·ï¼‰</span><br>vim common.mk<br><span class="hljs-comment"># å®‰è£…</span><br>make<br><br><span class="hljs-built_in">cd</span> ~/Applications/download<br><span class="hljs-comment"># === å®‰è£…HMMER ===</span><br>tar -xzvf hmmer.tar.gz<br><span class="hljs-built_in">cd</span> hmmer-3.2.1<br>./configure<br>make<br><br><span class="hljs-comment"># === å®‰è£…blast+ ===</span><br>tar -xzvf ncbi-blast-2.7.1+-x64-linux.tar.gz<br><span class="hljs-comment"># æ”¹å</span><br><span class="hljs-built_in">mv</span> ncbi-blast-2.7.1+ ../blast+-2.7.1-linux<br><br><span class="hljs-comment"># åˆ é™¤å®‰è£…åŒ…</span><br><span class="hljs-built_in">cd</span> ~/Applications/download<br><span class="hljs-built_in">rm</span> busco.zip<br><span class="hljs-built_in">rm</span> augustus.current.tar.gz<br><span class="hljs-built_in">rm</span> hmmer.tar.gz<br><span class="hljs-built_in">rm</span> ncbi-blast-2.7.1+-x64-linux.tar.gz<br></code></pre></td></tr></table></figure><h2 id="ä¸‹è½½æ•°æ®åº“æ–‡ä»¶"><a href="#ä¸‹è½½æ•°æ®åº“æ–‡ä»¶" class="headerlink" title="ä¸‹è½½æ•°æ®åº“æ–‡ä»¶"></a>ä¸‹è½½æ•°æ®åº“æ–‡ä»¶</h2><p><a href="https://busco-data.ezlab.org/v5/data/lineages/">https://busco-data.ezlab.org/v5/data/lineages/</a></p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">å¤§ç±»äº”ç±»<br><span class="hljs-bullet">- </span>Bacteria ç»†èŒ<br><span class="hljs-bullet">- </span>Protists åŸç”Ÿç”Ÿç‰©<br><span class="hljs-bullet">- </span>Metazoa åç”ŸåŠ¨ç‰©<br><span class="hljs-bullet">- </span>Fungi çœŸèŒ<br><span class="hljs-bullet">- </span>Plant æ¤ç‰©<br>ä¸‹è½½çš„æ˜¯æ¤ç‰©ç›¸å…³ embryophyta<span class="hljs-emphasis">_odb10.2020-09-10.tar.gz</span><br><span class="hljs-emphasis"># è§£å‹æ–‡ä»¶</span><br><span class="hljs-emphasis">tar -xzvf embryophyta_</span>odb9.tar.gz<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œæ—¶éœ€è¦å¯¹åº”çš„æ•°æ®åº“æ–‡ä»¶è·¯å¾„ &#x2F;&#x2F;&#x2F;embryophyta_odb9</p><h1 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h1><p>é…ç½®æ˜¯å¿…é¡»çš„ï¼Œ<strong>è¿™ä¸€æ­¥éœ€è¦ä»”ç»†ä¸€äº›ï¼Œè·¯å¾„å‡ºé”™çš„è¯æ˜¯æ— æ³•é€šè¿‡buscoçš„æ£€æµ‹çš„</strong>ï¼Œåœ¨å®‰è£…å¥½è½¯ä»¶ä¹‹å <code>~/Applications/busco/config/</code>ä¹‹ä¸­å¹¶æ²¡æœ‰<code>config.ini</code>æ–‡ä»¶ï¼Œåªæœ‰ä¸€ä¸ª<code>config.ini_default</code>æ–‡ä»¶ï¼Œå¯ä»¥æŠŠé‡Œé¢çš„å†…å®¹å¤åˆ¶ä¸‹æ¥ï¼Œ</p><ul><li>æ–¹æ³•1</li></ul><p>æ–°å»º<code>config.ini</code>æ–‡ä»¶æˆ–è€…ç›´æ¥å¤åˆ¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cp</span> config.ini_default config.ini<br></code></pre></td></tr></table></figure><ul><li>æ–¹æ³•2</li></ul><p>ä¹Ÿå¯æ–°å»º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å¢åŠ é…ç½®æ–‡ä»¶</span><br>vim ~/Applications/busco/config/config.ini<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># BUSCO specific configuration</span><br><span class="hljs-comment">#It ã€overrides default valuesã€‘ in code and dataset cfg, and is ã€overridden by arguments in command lineã€‘</span><br><span class="hljs-comment"># Uncomment lines when appropriate</span><br>[busco]<br><span class="hljs-comment"># Input file</span><br>;<span class="hljs-keyword">in</span> = ./sample_data/target.fa<br><span class="hljs-comment"># Run name, used in output files and folder</span><br>;out = SAMPLE<br><span class="hljs-comment"># Where to store the output directory</span><br><span class="hljs-comment">#ã€ï¼Ÿã€‘ out_path = /workdir</span><br><span class="hljs-comment"># Path to the BUSCO dataset</span><br>;lineage_path = ./sample_data/example<br><span class="hljs-comment"># Which mode to run (ã€genome / protein / transcriptomeã€‘)</span><br>;mode = genome<br><span class="hljs-comment"># How many threads to use for ã€multithreadedã€‘ steps</span><br>;cpu = 1<br><span class="hljs-comment"># Domain for augustus retraining, eukaryota or prokaryota</span><br><span class="hljs-comment"># ã€Do not changeã€‘ this unless you know exactly why !!!</span><br>;domain = eukaryota<br><span class="hljs-comment"># Force rewrite if files already exist (True/False)</span><br>;force = False<br><span class="hljs-comment"># Restart mode (True/False)</span><br>;restart = False<br><span class="hljs-comment"># Blast e-value</span><br>;evalue = 1e-3<br><span class="hljs-comment"># Species to use with augustus, for old datasets only</span><br>;species = fly<br><span class="hljs-comment"># Augustus extra parameters</span><br><span class="hljs-comment"># Use single quotes, like this: &#x27;--param1=1 --param2=2&#x27;</span><br>;augustus_parameters = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-comment"># Tmp folder</span><br>;tmp_path = ./tmp/<br><span class="hljs-comment"># How many candidate regions (contigs, scaffolds) to consider for each BUSCO</span><br>;<span class="hljs-built_in">limit</span> = 3<br><span class="hljs-comment"># Augustus long mode for retraining (True/False)</span><br>;long = False<br><span class="hljs-comment"># Quiet mode (True/False)</span><br>;quiet = False<br><span class="hljs-comment"># Debug logs (True/False), it needs Quiet to be False</span><br>debug = True<br><span class="hljs-comment"># tar gzip output files (True/False)</span><br>;gzip = False<br><span class="hljs-comment"># Force single core for the tblastn step</span><br>;blast_single_core = True<br><br>ã€[tblastn]ã€‘<br><span class="hljs-comment"># path to tblastn</span><br>path = ~/Applications/blast+-2.7.1-linux/bin<br><br>ã€[makeblastdb]ã€‘<br><span class="hljs-comment"># path to makeblastdb</span><br>path = ~/Applications/blast+-2.7.1-linux/bin<br><br>ã€[augustus]ã€‘<br><span class="hljs-comment"># path to augustus</span><br>path = ~/Applications/augustus-3.3.1/bin<br><br>ã€[etraining]ã€‘<br><span class="hljs-comment"># path to augustus etraining</span><br>path = ~/Applications/augustus-3.3.1/bin<br><br><span class="hljs-comment"># path to augustus perl scripts, redeclare it for each new script        </span><br>ã€[gff2gbSmallDNA.pl]ã€‘                                                      <br>path = ~/Applications/augustus-3.3.1/scripts                         <br>ã€[new_species.pl]ã€‘                                                         <br>path = ~/Applications/augustus-3.3.1/scripts                         <br>ã€[optimize_augustus.pl]ã€‘                                                   <br>path = ~/Applications/augustus-3.3.1/scripts                         <br>                                                                         <br>ã€[hmmsearch]ã€‘                                                              <br><span class="hljs-comment"># path to HMMsearch executable                                           </span><br>path = ~/Applications/hmmer-3.2.1/src                                <br>                                                                         <br>ã€[Rscript]ã€‘                                                                <br><span class="hljs-comment"># path to Rscript, if you wish to use the plot tool                      </span><br>path = /usr/bin/<br></code></pre></td></tr></table></figure><p>æ–°å»ºconfig.ini&#96;æ–‡ä»¶ä¹‹åï¼Œ</p><ol><li>å°†<code>config.ini</code>æ–‡ä»¶ä¸­çš„<code>out_path = /workdir</code>å‰é¢åŠ ä¸Š<code>#</code><br>å› ä¸ºè¾“å‡ºè·¯å¾„æœ‰æ—¶å€™ä¼šå‡ºé”™ï¼Œæ‰€ä»¥æ³¨é‡Šæ‰ï¼Œä¹‹åè¿è¡Œbuscoï¼Œ<font color="blue">è¾“å‡ºçš„è·¯å¾„å°±æ˜¯cdçš„è·¯å¾„</font></li><li>ä¹‹åéœ€è¦æ”¹è¿™å‡ é¡¹å¯¹åº”çš„è·¯å¾„ï¼ˆ<strong>é‡Œé¢çš„è·¯å¾„éœ€è¦æ›´æ”¹ä¸ºè‡ªå·±çš„å·¥å…·çš„è·¯å¾„</strong>ï¼‰</li></ol><table><thead><tr><th>é€‰é¡¹</th><th>ç›¸å…³</th></tr></thead><tbody><tr><td>[tblastn]</td><td>blast+</td></tr><tr><td>[makeblastdb]</td><td>blast+</td></tr><tr><td>[augustus]</td><td>Augustus</td></tr><tr><td>[hmmsearch]</td><td>HMMER</td></tr><tr><td>[gff2gbSmallDNA.pl]</td><td>Augustus</td></tr><tr><td>[new_species.pl]</td><td>Augustus</td></tr><tr><td>[optimize_augustus.pl]</td><td>Augustus</td></tr><tr><td>[hmmsearch]</td><td>HMMER</td></tr></tbody></table><h1 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># augustuså·¥å…·çš„æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-string">&quot;/home/ssd/Applications/augustus-3.3.1/bin:<span class="hljs-variable">$PATH</span>&quot;</span><br><span class="hljs-comment"># augustuså·¥å…·é™„åŠ è„šæœ¬æ‰€åœ¨æ–‡ä»¶å¤¹</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-string">&quot;/home/ssd/Applications/augustus-3.3.1/scripts:<span class="hljs-variable">$PATH</span>&quot;</span><br><span class="hljs-comment"># augustuså·¥å…·é…ç½®æ–‡ä»¶çš„æ‰€åœ¨ä½ç½® ã€‚AUGUSTUS_CONFIG_PATH éœ€è¦ä½¿ç”¨ç»å¯¹è·¯å¾„</span><br><span class="hljs-built_in">export</span> AUGUSTUS_CONFIG_PATH=<span class="hljs-string">&quot;/home/ssd/Applications/augustus-3.3.1/config&quot;</span><br><span class="hljs-comment"># hmmerå·¥å…·çš„æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-string">&quot;/home/ssd/Applications/hmmer-3.2.1/src:<span class="hljs-variable">$PATH</span>&quot;</span><br><span class="hljs-comment"># blast+å·¥å…·çš„æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-string">&quot;/home/ssd/Applications/blast+-2.7.1-linux/bin:<span class="hljs-variable">$PATH</span>&quot;</span><br></code></pre></td></tr></table></figure><h1 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">run_BUSCO.py -i [ç»„è£…çš„æ–‡ä»¶.fasta]  -l  [æ•°æ®åº“æ–‡ä»¶å¤¹] -o [è¾“å‡ºæ–‡ä»¶å] -m [è¯„ä¼°æ¨¡å¼] [å…¶ä»–ä¸€äº›é€‰é¡¹]<br></code></pre></td></tr></table></figure><p>å®ä¾‹ï¼Œå¦‚æœç”¨<code>conda</code>å®‰è£…BUSCOã€‚æ‰§è¡Œåªéœ€å†™<code>busco</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># é¦–å…ˆcdåˆ°å¯¹åº”çš„ç»„è£…æ–‡ä»¶çš„æ–‡ä»¶å¤¹</span><br><span class="hljs-comment"># ç¡®ä¿canuå…¨è·¯å¾„ï¼Œcondaå®‰è£…ï¼Œwhich busco</span><br><span class="hljs-comment"># -i è¾“å…¥æ–‡ä»¶</span><br><span class="hljs-comment"># -l BUSCOçš„æ•°æ®åº“æ–‡ä»¶</span><br><span class="hljs-comment"># -o è¾“å‡ºçš„æ–‡ä»¶åçš„åç¼€ä»¥åŠæ–‡ä»¶å¤¹çš„åç§°</span><br><span class="hljs-comment"># -m åˆ†æç±»å‹ï¼ˆgenomeã€transcriptomeã€proteinsï¼‰</span><br><span class="hljs-comment"># --cpu çº¿ç¨‹æ•°</span><br>busco \<br>    -i contigs.fasta \<br>    -l ~/database/BUSCO/embryophyta_odb9 \<br>    -o suffix\<br>    -m genome \<br>    --cpu 8<br></code></pre></td></tr></table></figure><h2 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a><font color="red">å‚æ•°</font></h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs sh">usage: busco -i [SEQUENCE_FILE] -l [LINEAGE] -o [OUTPUT_NAME] -m [MODE] [OTHER OPTIONS]<br><br>Welcome to BUSCO 5.3.0: the Benchmarking Universal Single-Copy Ortholog assessment tool.<br>For more detailed usage information, please review the README file provided with this distribution and the BUSCO user guide. Visit this page https://gitlab.com/ezlab/busco<span class="hljs-comment">#how-to-cite-busco to see how to cite BUSCO</span><br><br>optional arguments:<br>  <span class="hljs-string">&#x27;-i&#x27;</span> SEQUENCE_FILE, --<span class="hljs-keyword">in</span> SEQUENCE_FILE<br>                        Input sequence file <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;FASTA format&#x27;</span>. Can be an assembled genome or transcriptome (DNA), or protein sequences from an annotated gene <span class="hljs-built_in">set</span>. Also possible to use a path to a directory containing multiple input files.<br>  <span class="hljs-string">&#x27;-o&#x27;</span> OUTPUT, --out OUTPUT<br>                        Give your analysis run a recognisable short name. <span class="hljs-string">&#x27;Output folders and files will be labelled with this name&#x27;</span>. The path to the output folder is <span class="hljs-built_in">set</span> with --out_path.<br>  <span class="hljs-string">&#x27;-m&#x27;</span> MODE, --mode MODE  Specify <span class="hljs-built_in">which</span> BUSCO analysis mode to run.<br>                        There are three valid modes:<br>                        - geno or <span class="hljs-string">&#x27;genome&#x27;</span>, <span class="hljs-keyword">for</span> genome assemblies (DNA)<br>                        - tran or transcriptome, <span class="hljs-keyword">for</span> transcriptome assemblies (DNA)<br>                        - prot or proteins, <span class="hljs-keyword">for</span> annotated gene sets (protein)<br>  <span class="hljs-string">&#x27;-l&#x27;</span> LINEAGE, --lineage_dataset LINEAGE<br>                        Specify the name of the BUSCO lineage to be used<span class="hljs-string">&#x27;database?&#x27;</span><br>  --augustus            Use augustus gene predictor <span class="hljs-keyword">for</span> eukaryote runs<br>  --augustus_parameters --PARAM1=VALUE1,--PARAM2=VALUE2<br>                        Pass additional arguments to Augustus. All arguments should be contained within a single string with no white space, with each argument separated by a comma.<br>  --augustus_species AUGUSTUS_SPECIES<br>                        Specify a species <span class="hljs-keyword">for</span> Augustus training.<br>  --auto-lineage        Run auto-lineage to find optimum lineage path<br>  --auto-lineage-euk    Run auto-placement just on eukaryote tree to find optimum lineage path<br>  --auto-lineage-prok   Run auto-lineage just on non-eukaryote trees to find optimum lineage path<br>  <span class="hljs-string">&#x27;-c&#x27;</span> N, --cpu N         Specify the number (N=<span class="hljs-built_in">integer</span>) of threads/cores to use.<br>  <span class="hljs-string">&#x27;--config&#x27;</span> CONFIG_FILE  Provide a config file<br>  --datasets_version DATASETS_VERSION<br>                        Specify the version of BUSCO datasets, e.g. odb10<br>  <span class="hljs-string">&#x27;--download&#x27;</span> [dataset [dataset ...]]<br>                        Download dataset. Possible values are a specific dataset name, <span class="hljs-string">&quot;all&quot;</span>, <span class="hljs-string">&quot;prokaryota&quot;</span>, <span class="hljs-string">&quot;eukaryota&quot;</span>, or <span class="hljs-string">&quot;virus&quot;</span>. If used together with other <span class="hljs-built_in">command</span> line arguments, make sure to place this last.<br>  --download_base_url DOWNLOAD_BASE_URL<br>                        Set the url to the remote BUSCO dataset location<br>  --download_path DOWNLOAD_PATH<br>                        Specify <span class="hljs-built_in">local</span> filepath <span class="hljs-keyword">for</span> storing BUSCO dataset downloads<br>  <span class="hljs-string">&#x27;-e&#x27;</span> N, --evalue N      <span class="hljs-string">&#x27;E-value cutoff for BLAST searches&#x27;</span>. Allowed formats, 0.001 or 1e-03 (Default: 1e-03)<br>  -f, --force           Force rewriting of existing files. Must be used when output files with the provided name already exist.<br>  -h, --<span class="hljs-built_in">help</span>            Show this <span class="hljs-built_in">help</span> message and <span class="hljs-built_in">exit</span><br>  --<span class="hljs-built_in">limit</span> N             How many candidate regions (contig or transcript) to consider per BUSCO (default: 3)<br>  --list-datasets       Print the list of available BUSCO datasets<br>  --long                Optimization Augustus self-training mode (Default: Off); adds considerably to the run time, but can improve results <span class="hljs-keyword">for</span> some non-model organisms<br>  --metaeuk_parameters <span class="hljs-string">&quot;--PARAM1=VALUE1,--PARAM2=VALUE2&quot;</span><br>                        Pass additional arguments to Metaeuk <span class="hljs-keyword">for</span> the first run. All arguments should be contained within a single string with no white space, with each argument separated by a comma.<br>  --metaeuk_rerun_parameters <span class="hljs-string">&quot;--PARAM1=VALUE1,--PARAM2=VALUE2&quot;</span><br>                        Pass additional arguments to Metaeuk <span class="hljs-keyword">for</span> the second run. All arguments should be contained within a single string with no white space, with each argument separated by a comma.<br>  <span class="hljs-string">&#x27;--offline&#x27;</span>            <span class="hljs-string">&#x27;To indicate that BUSCO cannot attempt to download files&#x27;</span><br>  --out_path OUTPUT_PATH<br>                        Optional location <span class="hljs-keyword">for</span> results folder, excluding results folder name. <span class="hljs-string">&#x27;Default is current working directory&#x27;</span>.<br>  -q, --quiet           Disable the info logs, <span class="hljs-string">&#x27;displays only errors&#x27;</span><br>  -r, --restart         <span class="hljs-string">&#x27;Continue a run that had already partially completed&#x27;</span>.<br>  --tar                 <span class="hljs-string">&#x27;Compress some subdirectories with many files to save space&#x27;</span><br>  --update-data         Download and replace with last versions all lineages datasets and files necessary to their automated selection<br>  -v, --version         Show this version and <span class="hljs-built_in">exit</span><br><br></code></pre></td></tr></table></figure><p>fastaæ–‡ä»¶ä¸­ï¼Œä¸€äº›ç»„è£…å·¥å…·ç”Ÿæˆçš„<code>contig</code>çš„åå­—æ˜¯å½¢å¦‚<code>&gt;contig/1/12345</code>ä¹‹ç±»çš„ï¼Œè¿™ç§fastaæ–‡ä»¶è¿è¡Œæ—¶BUSCOä¼šæŠ¥é”™ï¼Œè§£å†³åŠæ³•æ˜¯æ”¹åï¼Œperlå•è¡Œã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cat</span> contig.fasta | perl -p -e <span class="hljs-string">&#x27;s&#123;/&#125;&#123;&#125;g&#x27;</span> &gt; contig.new.fasta<br></code></pre></td></tr></table></figure><h1 id="ç»“æœè§£è¯»"><a href="#ç»“æœè§£è¯»" class="headerlink" title="ç»“æœè§£è¯»"></a>ç»“æœè§£è¯»</h1><p>åœ¨è¿è¡Œæ–‡ä»¶å¤¹ä¸‹ä¼šæœ‰</p><ul><li><code>run_suffix</code> æ–‡ä»¶å¤¹ï¼šå› ä¸ºä¸Šé¢<code>-o</code>é€‰é¡¹è®¾ç½®äº†<code>suffix</code>ï¼Œæ‰€ä»¥æ–‡ä»¶å¤¹åç§°åŠ äº†åç¼€ã€‚æ–‡ä»¶å¤¹é‡Œï¼Œæœ‰ä¸€ä¸ªæ–‡ä»¶æœ€ä¸ºé‡è¦ã€‚æ˜¯<code>short_summary_suffix.txt</code></li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs text"># Summarized benchmarking in BUSCO notation for file assembly/spades/contigs.fasta<br># BUSCO was run in mode: genome<br>    C:98.6%[S:98.6%,D:0.0%],F:0.0%,M:1.4%,n:148<br><br>    146 Complete BUSCOs (C)<br>    146 Complete and single-copy BUSCOs (S)<br>    0   Complete and duplicated BUSCOs (D)<br>    0   Fragmented BUSCOs (F)<br>    2   Missing BUSCOs (M)<br>    148 Total BUSCO groups searched<br></code></pre></td></tr></table></figure><table><thead><tr><th align="left">ç¼©å†™</th><th>å…¨ç§°</th><th>è¯´æ˜</th><th>å…³ç³»</th></tr></thead><tbody><tr><td align="left">C</td><td>Complete</td><td>å¤šå°‘ä¸ªBUSCOæµ‹è¯•åŸºå› è¢«è¦†ç›–ã€‚</td><td>C &#x3D; S + D</td></tr><tr><td align="left">S</td><td>single-copy</td><td>å¤šå°‘ä¸ªåŸºå› ç»è¿‡æ¯”å¯¹å‘ç°æ˜¯å•æ‹·è´ã€‚</td><td>-</td></tr><tr><td align="left">D</td><td>duplicated</td><td>å¤šå°‘ä¸ªåŸºå› ç»è¿‡æ¯”å¯¹å‘ç°åŒ…å«å¤šæ‹·è´ã€‚</td><td>-</td></tr><tr><td align="left">F</td><td>Fragment</td><td>å¤šå°‘ä¸ªåŸºå› ç»è¿‡æ¯”å¯¹è¦†ç›–ä¸å®Œå…¨ï¼Œåªæ˜¯éƒ¨åˆ†æ¯”å¯¹ä¸Šã€‚</td><td>-</td></tr><tr><td align="left">M</td><td>Miss</td><td>æ²¡æœ‰å¾—åˆ°æ¯”å¯¹ç»“æœçš„åŸºå› æ•°</td><td>-</td></tr><tr><td align="left">Total</td><td>Total</td><td>æ€»å…±æµ‹è¯•çš„åŸºå› æ¡ç›®æ•°</td><td>Total &#x3D; C + F + M</td></tr></tbody></table><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css">ä¸€èˆ¬æƒ…å†µä¸‹å¯¹äºå®Œæ•´åº¦è¾ƒå¥½çš„åŸºå› ç»„ç»„è£…ç»“æœæ¥è®²ï¼ŒComplete and single-copyè¶Šå¤šè¶Šå¥½ï¼Œè€ŒComplete and duplicatedå’ŒMissingè¶Šå°‘è¶Šå¥½ï¼Œå¯¹äºFragmentedä¹Ÿå°½å¯èƒ½åœ°å°‘ä¸€äº›ã€‚<br>çœŸå®é¡¹ç›®ä¸­ï¼ŒComplete BUSCOs (C) çš„æ¯”ä¾‹é€šå¸¸éƒ½èƒ½è¾¾åˆ° <span class="hljs-number">80%</span> ä»¥ä¸Šã€‚<br>Cå€¼è¡¨ç¤ºå’ŒBUSCOé›†ç›¸æ¯”çš„å®Œæ•´åº¦ï¼ŒMå€¼è¡¨ç¤ºå¯èƒ½ç¼ºå°‘çš„åŸºå› æ•°ï¼ŒDåˆ™æ˜¯é‡å¤æ•°ã€‚<br></code></pre></td></tr></table></figure><p>ä¸‰ç§æ¯”å¯¹</p><ul><li>æƒ…å†µ1 - å®Œå…¨è¦†ç›–</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">è¯´æ˜: +è¡¨ç¤ºç»„è£…å¾—åˆ°åŸºå› åºåˆ— -è¡¨ç¤ºç”¨äºæµ‹è¯•çš„åŸºå› åºåˆ—<br><br>ç»„è£… : ================+++++++==============<br>æµ‹è¯•                   -------<br>                       æˆ–è€…<br>ç»„è£… : ==============+++++++++++============<br>æµ‹è¯•                   -------               <br></code></pre></td></tr></table></figure><ul><li>æƒ…å†µ2 - éƒ¨åˆ†è¦†ç›–</li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs text">ç»„è£… : ================+++++++==============<br>æµ‹è¯•                   -----<br>                     /      \<br>                       æˆ–è€…<br>ç»„è£… : ================+++++++==============<br>æµ‹è¯•                   -------<br>                     /        \<br></code></pre></td></tr></table></figure><ul><li>æƒ…å†µ3 - æ²¡æœ‰æ¯”å¯¹</li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">ç»„è£… : ================+++++++==============<br>æµ‹è¯• <br></code></pre></td></tr></table></figure><p>ä¸€èˆ¬<code>S</code> + <code>D</code>çš„æ•°å€¼ä¹Ÿå°±æ˜¯<code>C</code>çš„å€¼è¶Šå¤§è¶Šå¥½ï¼Œä½†æ˜¯åœ¨æ–‡çŒ®ä¸­ä½œè€…è¯´å¦‚æœ<code>D</code>çš„æ•°å€¼å¤ªå¤šçš„è¯å¯èƒ½æ„å‘³ç€ç»„è£…é”™è¯¯çš„å¯èƒ½æ€§è¾ƒå¤§ã€‚å› ä¸ºä¸€ä¸ªåŸºå› ï¼ˆBUSCOæ•°æ®åº“ä¸­è¯¥åŸºå› ä¸€èˆ¬ä¸ºå•æ‹·è´ï¼‰è¢«è¦†ç›–å¤šæ¬¡ï¼Œé‚£ä¹ˆå¯èƒ½å°±æ˜¯è¯´è¯¥åŸºå› æ‰€åœ¨çš„ç‰‡æ®µç»„è£…å¯èƒ½å‡ºç°é—®é¢˜ã€‚<br>å› ä¸ºç†è®ºä¸Š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs text">ç†è®ºä¸Šï¼š--------------------------------------------<br>å®é™…ä¸Šï¼š--------   ----------    ----------    -----<br>é”™è¯¯çš„ï¼š--------                 -------------<br>           \\\\                    ///<br>          -----------     --------------<br></code></pre></td></tr></table></figure><p>ç†è®ºä¸Šç»„è£…ä¹‹åå„ä¸ªç‰‡æ®µä¹‹é—´åº”è¯¥å‰åæœ‰åºï¼Œä¹‹é—´é™¤äº†é‡å¤åŒºåŸŸæˆ–è€…å…¶ä»–ç‰¹æ®Šç‰‡æ®µä¹‹å¤–ä¸åº”è¯¥æœ‰å¯ä»¥é‡å çš„åœ°æ–¹ã€‚<br>ä¾‹å¦‚</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs text">sequence1 : ..TAGTCGTGA                         GTGCATGCTGTAGC..<br>                       \                       /<br>                        AAAATTGG......CGATGAAAA<br>                       /                       \<br>sequence2 : ..GGGTAGCGG                         TTGACTAGCTAGCT..<br></code></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ä¸­é—´ä¸€æ®µåºåˆ—æ˜¯ä¸¤ä¸ªåºåˆ—çš„å…±åŒéƒ¨åˆ†ï¼Œé™¤éè¿™ä¸ªåºåˆ—å­˜åœ¨å¤šä¸ªæ‹·è´ï¼Œå¦åˆ™å°±å¾ˆå¯èƒ½æ˜¯æ‹¼æ¥é”™è¯¯ã€‚é€šå¸¸ä¸€èˆ¬è¿™ç§æ‹¼æ¥é”™è¯¯çš„åºåˆ—çš„ä¸¤ç«¯ä¼šå‡ºç°é‡å¤åºåˆ—ã€‚å¦å¤–å¦‚æœæ˜¯å¤šå€ä½“ç»„è£…çš„è¯ï¼Œ<code>D</code>å€¼ä¹Ÿå¯èƒ½å¤§ã€‚</p><p>ä¸€èˆ¬æ¥çœ‹ï¼Œ<code>S</code>ä¼¼ä¹è¶Šå¤§è¶Šå¥½ï¼Œ<code>M</code>è¶Šå°è¶Šå¥½ï¼Œè¯´æ˜ç»„è£…çš„è¶Šå®Œæ•´ï¼Œå› ä¸ºæ£€æµ‹çš„å•æ‹·è´åŒæºåŸºå› å‡ºç°å¾—å¤šã€‚ä½†æ˜¯<code>D</code>ä¸<code>F</code>è¿™ä¸¤ä¸ªæ•°å€¼è¶Šå¤§ä¸è§å¾—å°±æ˜¯å¥½çš„ï¼Œå› ä¸ºç»„è£…çš„é”™è¯¯å¯èƒ½ä¼šå¸¦æ¥è¿™ä¸¤ä¸ªå€¼çš„å¢å¤§ã€‚ä¸èƒ½ä»…ä»…åªæ˜¯é€šè¿‡è¿™ä¸€ä¸ªè½¯ä»¶æ¥åˆ¤å®šã€‚æ¯”å¦‚è¿˜å¯ä»¥å€ŸåŠ©<code>QUAST</code>å’Œå¸¸è§„æŒ‡æ ‡<code>N50</code>ã€<code>æ€»çš„æ ¸é…¸é‡</code>ã€<code>ç‚¹é˜µå›¾</code>ç­‰ç­‰å¤šä¸ªè¾…åŠ©æ ‡å‡†æ¥è¿›è¡Œç»¼åˆçš„è¯„ä¼°ã€‚</p><h1 id="ç”»å›¾"><a href="#ç”»å›¾" class="headerlink" title="ç”»å›¾"></a>ç”»å›¾</h1><p>æ‰§è¡Œå®Œæ¯•åï¼Œå¯ä½¿ç”¨<code>generate_plot.py</code>ç”»å›¾ï¼Œæ¡å½¢å›¾ã€‚</p><ul><li>é¦–å…ˆæŠŠæ‰€æœ‰ç»è¿‡BUSCOæ£€æµ‹çš„ç»“æœèšé›†åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¹‹å†…</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> my_summaries<br><span class="hljs-built_in">cp</span> run_SPEC1/short_summary_SPEC1.txt my_summaries/.<br><span class="hljs-built_in">cp</span> run_SPEC2/short_summary_SPEC2.txt my_summaries/.<br><span class="hljs-built_in">cp</span> run_SPEC3/short_summary_SPEC3.txt my_summaries/.<br><span class="hljs-built_in">cp</span> run_SPEC4/short_summary_SPEC4.txt my_summaries/.<br><span class="hljs-built_in">cp</span> run_SPEC5/short_summary_SPEC5.txt my_summaries/.<br></code></pre></td></tr></table></figure><ul><li>è¿è¡Œ</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined">python scripts/generate_plot.py â€“wd my_summaries<br></code></pre></td></tr></table></figure><p>äº”ä¸ªæ•°å€¼å˜æˆæ¡å½¢å›¾æ˜¾ç¤ºï¼Œå¯¹æ¯”æ›´åŠ æ˜æ˜¾.</p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>busco</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€paperã€‘Insight into the evolution of the Solanaceae from the parental genomes of Petunia hybrida</title>
    <link href="/GeekFocus/2022/03/02/2022-03-02-paper-Petunia/"/>
    <url>/GeekFocus/2022/03/02/2022-03-02-paper-Petunia/</url>
    
    <content type="html"><![CDATA[<p>Solanaceae èŒ„ç§‘</p><span id="more"></span><h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>The assemblies include 91.3% and 90.2% coverage of their diploid genomes (1.4 Gb; 2n &#x3D; 14) containing 32,928 and 36,697 protein-coding genes, respectively. The genomes reveal that the Petunia lineage has experienced at least two rounds of hexaploidization: the older gamma event, which is shared with most Eudicots, and a more recent Solanaceae event that is shared with tomato and other solanaceous species. Transcription factors involved in the shift from bee to moth pollination reside in particularly dynamic regions of the genome, which may have been key to the remarkable diversity of floral colour patterns and pollination systems. The high-quality genome sequences will enhance the value of Petunia as a model system for research on unique biological phenomena such as small RNAs, symbiosis, self-incompatibility and circadian rhythms.</p><p>çŸ®ç‰µç‰›æ˜¯ä¸€ç§æµè¡Œçš„èŠ±å›æ¤ç‰©ï¼Œä½œä¸ºä¸€ç§é—ä¼ å­¦æ¨¡å¼ç³»ç»Ÿæœ‰ç€æ‚ ä¹…çš„å†å²ã€‚æˆ‘ä»¬æŠ¥é“äº†å…¶ä¸¤ä¸ªé‡ç”Ÿäº²æœ¬è…‹æ¯›å‡å•èƒèŒ(P. axillaris N)å’Œè†¨èƒ€å‡å•èƒèŒ(P. inflata S6)è¿‘äº¤ç³»è¡ç”Ÿç‰©çš„å…¨åŸºå› ç»„æµ‹åºå’Œç»„è£…ã€‚è¯¥ç»„åˆçš„äºŒå€ä½“åŸºå› ç»„è¦†ç›–ç‡ä¸º91.3%å’Œ90.2% (1.4 Gb;2n &#x3D; 14)ï¼Œåˆ†åˆ«å«æœ‰32,928ä¸ªå’Œ36,697ä¸ªè›‹ç™½ç¼–ç åŸºå› ã€‚åŸºå› ç»„æ˜¾ç¤ºçŸ®çŸ®èŠ±è‡³å°‘ç»å†äº†ä¸¤è½®å…­å€åŒ–:æ›´å¤è€çš„ä¼½ç›äº‹ä»¶ï¼Œä¸å¤§å¤šæ•°åŒå­å¶æ¤ç‰©å…±äº«ï¼Œä»¥åŠæ›´è¿‘çš„èŒ„ç§‘äº‹ä»¶ï¼Œä¸ç•ªèŒ„å’Œå…¶ä»–èŒ„ç§‘æ¤ç‰©å…±äº«ã€‚è½¬å½•å› å­å‚ä¸äº†ä»èœœèœ‚åˆ°é£è›¾çš„ä¼ ç²‰è¿‡ç¨‹ï¼Œå®ƒä»¬ä½äºåŸºå› ç»„ä¸­ç‰¹åˆ«æ´»è·ƒçš„åŒºåŸŸï¼Œè¿™å¯èƒ½æ˜¯èŠ±çš„é¢œè‰²æ¨¡å¼å’Œä¼ ç²‰ç³»ç»Ÿæ˜¾è‘—å¤šæ ·æ€§çš„å…³é”®ã€‚é«˜è´¨é‡çš„åŸºå› ç»„åºåˆ—å°†æé«˜çŸ®ç§çŸ®èŠ±ä½œä¸ºç ”ç©¶å°rnaã€å…±ç”Ÿã€è‡ªäº¤ä¸äº²å’Œæ€§å’Œæ˜¼å¤œèŠ‚å¾‹ç­‰ç‹¬ç‰¹ç”Ÿç‰©ç°è±¡çš„æ¨¡å‹ç³»ç»Ÿçš„ä»·å€¼ã€‚</p><p>çŸ®ç‰µç‰›ï¼ˆ<em>Petunia hybrida</em>ï¼‰å±äºèŒ„ç§‘ï¼ˆSolanaceaeï¼‰ï¼Œæ˜¯ä¸€ç§æµè¡Œçš„èŠ±å›æ¤ç‰©ï¼Œé•¿æœŸä½œä¸ºä¸€ä¸ªé—ä¼ æ¨¡å¼ç³»ç»Ÿã€‚æœ¬è®ºæ–‡æŠ¥é“äº†çŸ®ç‰µç‰›çš„ä¸¤ä¸ªé‡ç”Ÿäº²æœ¬çš„åŸºå› ç»„ï¼Œ<em>P. axillaris</em> N å’Œ <em>P. inflata</em> S6ã€‚The assemblies include 91.3% and 90.2% coverage of their diploid genomes (1.4 Gb; 2n &#x3D; 14) containing 32,928 and 36,697 protein-coding genes, respectively. ç»„è£…çš„åŸºå› ç»„çŸ®ç‰µç‰›çš„åŸºå› ç»„å¤§å°å¤§çº¦æ˜¯1.4Gbï¼Œ14å¯¹æŸ“è‰²ä½“ã€‚æŠ¥é“çš„ä¸¤ä¸ªåŸºå› ç»„åˆ†åˆ«æ³¨é‡Šåˆ°32928å’Œ36697ä¸ªç¼–ç è›‹ç™½åŸºå› ã€‚</p><p><em>P. axillaris</em> N åŸºå› ç»„çš„ç»„è£…åˆ©ç”¨äº†137 Xçš„äºŒä»£æµ‹åºï¼ˆIlluminaï¼‰æ•°æ®å’Œ 21 Xä¸‰ä»£æµ‹åºï¼ˆPacBioï¼‰æŠ€æœ¯æ•°æ®ï¼Œ<em>P. inflata</em> S6 åŸºå› ç»„çš„ç»„è£…åˆ©ç”¨äº† 135 X çš„äºŒä»£æµ‹åºæ•°æ®ï¼Œæµ‹åºæ·±åº¦éƒ½ä¸ä½ã€‚ç›¸ä¿¡çŸ®ç‰µç‰›åŸºå› ç»„çš„å‘å¸ƒä¼šæ¨åŠ¨è‡ªäº¤ä¸äº²å’Œã€èŠ±è‰²ç­‰æ–¹é¢çš„ç ”ç©¶ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>paper</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HiFi-3-assemble-software</title>
    <link href="/GeekFocus/2022/03/02/2022-03-02-HiFi-3-software/"/>
    <url>/GeekFocus/2022/03/02/2022-03-02-HiFi-3-software/</url>
    
    <content type="html"><![CDATA[<p>Hifiasm is a <font color="blue"><strong>fast haplotype-resolved de novo assembler</strong></font> for <font color="blue"><strong>PacBio HiFi reads(High Fidelity,high accuracy consensus reads)</strong></font>. HiCanu, Hifiasm, BUSCO, Peregrine, minimap2</p><span id="more"></span><h1 id="HiFi-å¿«-å‡†-ç‹ "><a href="#HiFi-å¿«-å‡†-ç‹ " class="headerlink" title="HiFi å¿« å‡† ç‹ "></a><a href="https://zhuanlan.zhihu.com/p/138395531">HiFi å¿« å‡† ç‹ </a></h1><h2 id="ç»„è£…å¿«"><a href="#ç»„è£…å¿«" class="headerlink" title="ç»„è£…å¿«"></a>ç»„è£…å¿«</h2><p>CLRæˆ–Nanoporeé•¿Readsæµ‹åºå‡†ç¡®æ€§è¾ƒä½ï¼Œè¿›è¡Œç»„è£…æ—¶éœ€è¦åˆ©ç”¨é«˜å‡†ç¡®æ€§IlluminaçŸ­Readsçº é”™ã€‚è€ŒHiFi Readsæœ¬èº«å³é«˜å‡†ç¡®æ€§é•¿Readsï¼Œå¯ç›´æ¥æ‹¼æ¥ï¼Œå› æ­¤å¤§å¤§èŠ‚çœè¿ç®—èµ„æºå’Œæ—¶é—´ã€‚ç¬¬ä¸€ç¯‡åˆ©ç”¨HiFiè¿›è¡ŒäººåŸºå› ç»„ç»„è£…çš„æŠ¥é“è¡¨æ˜ï¼Œ<font color="red"><strong>HiFi Readsç»„è£…é€Ÿåº¦æ¯”CLR Readså¿«10â€“100å€</strong></font> <a href="https://pubmed.ncbi.nlm.nih.gov/31406327/">[1]</a>ã€‚å¦ä¸€é¡¹åŒæ—¶åˆ©ç”¨HiFi å’ŒCLR å¯¹äººåŸºå› ç»„ç»„è£…çš„æ¯”è¾ƒä¸­ï¼ŒHiFi ç»„è£…ä»…èŠ±è´¹çº¦2,800ä¸ªCPUæ—¶ï¼Œè€ŒCLR ç»„è£…èŠ±è´¹è¶…è¿‡50,000ä¸ªCPUæ—¶ï¼Œåˆ©ç”¨Nanopore Readsè¿›è¡Œç»„è£…æ›´æ˜¯èŠ±è´¹çº¦151,000ä¸ªCPUæ—¶ <a href="https://pubmed.ncbi.nlm.nih.gov/31711268/">[2]</a>ã€‚27 Gbå…­å€ä½“åŠ å·çº¢æ‰è¶…å¤§åŸºå› ç»„ï¼Œåˆ©ç”¨HiFi Readsä¸¤å‘¨å°±å®Œæˆç»„è£…ã€‚</p><h2 id="ç»„è£…å‡†"><a href="#ç»„è£…å‡†" class="headerlink" title="ç»„è£…å‡†"></a>ç»„è£…å‡†</h2><h3 id="1-è¿ç»­æ€§ä¸CLRå’ŒNanoporeç›¸å½“"><a href="#1-è¿ç»­æ€§ä¸CLRå’ŒNanoporeç›¸å½“" class="headerlink" title="1 è¿ç»­æ€§ä¸CLRå’ŒNanoporeç›¸å½“"></a>1 è¿ç»­æ€§ä¸CLRå’ŒNanoporeç›¸å½“</h3><p>è™½HiFi Readsåœ¨<font color="red"><strong>è¯»é•¿æ‰“æŠ˜æ‰£</strong></font>ï¼Œä½†åœ¨<font color="red"><strong>è¿ç»­æ€§æ–¹é¢æ¯«ä¸é€Šè‰²</strong></font>äºPacBio CLRå’ŒNanopore Readsã€‚åŒæ—¶åˆ©ç”¨HiFi å’ŒCLR å¯¹äººåŸºå› ç»„ç»„è£…çš„æ¯”è¾ƒä¸­ï¼Œ<font color="red"><strong>HiFi å’ŒCLR ç»„è£…çš„Contigs N50ç›¸å½“</strong></font>ï¼ˆ25.52 Mbå’Œ29.26 Mbï¼‰ã€‚ä¸€èˆ¬è®¤ä¸º<font color="red">Nanopore ultra-long</font>åœ¨åŸºå› ç»„ç»„è£…<font color="red"><strong>è¿ç»­æ€§æ›´å…·ä¼˜åŠ¿</strong></font>ï¼Œä½†åŒæ—¶åˆ©ç”¨HiFi å’ŒNanopore è¿›è¡Œæ°´ç¨»ç»„è£…çš„æŠ¥é“ä¸­ï¼Œä¸‰ä¸ªç»„è£…è½¯ä»¶ä¸­ä¸¤ä¸ªçš„ç»„è£…ç»“æœéƒ½æ˜¾ç¤º<font color="red"><strong>HiFi ç»„è£…Contigs N50é«˜äºNanopore Reads</strong></font> <a href="https://pubmed.ncbi.nlm.nih.gov/33319909/">[3]</a>ã€‚</p><h3 id="2-ç»„è£…è´¨é‡æ˜¾è‘—æå‡"><a href="#2-ç»„è£…è´¨é‡æ˜¾è‘—æå‡" class="headerlink" title="2 ç»„è£…è´¨é‡æ˜¾è‘—æå‡"></a>2 ç»„è£…è´¨é‡æ˜¾è‘—æå‡</h3><p>ç”±äºHiFi ä¸IllunimaçŸ­Readså…·æœ‰ç›¸å½“çš„ç¢±åŸºå‡†ç¡®æ€§ï¼Œå› æ­¤åœ¨ç»„è£…ä¸Šå…·æœ‰CLRå’ŒNanoporeæ— æ³•æ¯”æ‹Ÿçš„ä¼˜åŠ¿ã€‚åˆ©ç”¨HiFi å¯¹äººåŸºå› ç»„ç»„è£…ç»“æœè¡¨æ˜ï¼Œ<font color="red"><strong>HiFi ç»„è£…è´¨é‡æ¯”CLRé«˜6å€ï¼Œæ¯”ç»Illuminaæ ¡æ­£çš„Nanoporeé«˜77å€</strong></font> <a href="https://pubmed.ncbi.nlm.nih.gov/31406327/">[1]</a>ã€‚</p><p>å€¼å¾—ä¸€æï¼Œåˆ©ç”¨HiFi å’ŒNanopore è¿›è¡Œæ°´ç¨»ç»„è£…æ–‡ç« è¡¨æ˜ï¼Œ<font color="red"><strong>å¯¹äºé«˜é‡å¤åŒºåŸŸåˆ©ç”¨é«˜è´¨é‡Illuminaå¯¹Nanoporeé•¿Readsçº é”™æ•ˆæœä¸€èˆ¬</strong></font>ã€‚åŸå› åœ¨äºIllumina<font color="blue">çŸ­Readsåœ¨é‡å¤åŒºåŸŸå¾ˆéš¾å‡†ç¡®æ¯”å¯¹</font>ï¼Œå¯¼è‡´<strong>è¦†ç›–æ·±åº¦æœ‰é™</strong>ï¼Œå› è€Œ<strong>æ— æ³•èµ·åˆ°å‡†ç¡®çº é”™çš„ä½œç”¨</strong>ã€‚è€ŒHiFi å…¼å…·é•¿è¯»é•¿å’Œé«˜å‡†ç¡®æ€§åŒé‡ä¼˜åŠ¿ï¼Œå¯¹<font color="red"><strong>é‡å¤åŒºåŸŸ</strong>ä»ç„¶èƒ½å¤Ÿè·å¾—<strong>è¾ƒé«˜</strong>çš„ç»„è£…<strong>è´¨é‡</strong></font>ã€‚</p><h3 id="3-å¯¹é‡å¤åŒºåŸŸå’Œç€ä¸ç²’åŒºåŸŸå…·æœ‰è¾ƒé«˜çš„åˆ†è¾¨ç‡"><a href="#3-å¯¹é‡å¤åŒºåŸŸå’Œç€ä¸ç²’åŒºåŸŸå…·æœ‰è¾ƒé«˜çš„åˆ†è¾¨ç‡" class="headerlink" title="3 å¯¹é‡å¤åŒºåŸŸå’Œç€ä¸ç²’åŒºåŸŸå…·æœ‰è¾ƒé«˜çš„åˆ†è¾¨ç‡"></a>3 å¯¹é‡å¤åŒºåŸŸå’Œç€ä¸ç²’åŒºåŸŸå…·æœ‰è¾ƒé«˜çš„åˆ†è¾¨ç‡</h3><p>é™¤äº†æ•´ä¸ªåŸºå› ç»„çš„è¿ç»­æ€§å’Œå‡†ç¡®æ€§ï¼ŒHiFi åœ¨<font color="red"><strong>é‡å¤åŒºåŸŸ</strong>å’Œ<strong>ç€ä¸ç²’åŒºåŸŸ</strong></font>çš„ç»„è£…ä¹Ÿè¡¨ç°ä¸ä¿—ã€‚å¯¹äººåŸºå› ç»„çš„ç»„è£…è¡¨ç°ä¸Šï¼ŒHiFi ç»„è£…å¯¹<font color="red"><strong>æ•£åœ¨é‡å¤</strong>çš„<strong>åˆ†è¾¨ç‡ä¸º43%</strong></font>ï¼Œ<font color="red"><strong>é«˜äº</strong> CLRå’Œå·²æœ‰çš„Nanoporeç‰ˆæœ¬</font>ã€‚å¯¹äº<font color="red"><strong>æ•°ç™¾æ‹·è´çš„ä¸²è”é‡å¤</strong></font>ï¼ŒHiFi ç»„è£…<font color="red">æ¯”CLRå…·æœ‰<strong>æ›´é«˜</strong>çš„<strong>åˆ†è¾¨ç‡</strong>å’Œ<strong>å‡†ç¡®æ€§</strong></font>ã€‚è€Œä¸“é—¨é’ˆå¯¹HiFi Readsç»„è£…ä¼˜åŒ–çš„<font color="blue"><strong>HiCanu</strong></font>åœ¨<font color="blue"><strong>é‡å¤åºåˆ—å’Œç€ä¸ç²’ç»„è£…</strong></font>æ–¹é¢æ›´æœ‰è‰¯å¥½è¡¨ç°ã€‚</p><p><img src="/GeekFocus/2022-03-02-HiFi-3-software/9.png" alt="img"><br><img src="/GeekFocus/img/2022-03-02-HiFi-3-software/9.png" alt="img"></p><p>HiFiå’ŒCLRå¯¹<strong>ä¸²è”é‡å¤åŒºåŸŸç»„è£…</strong>ç»“æœçš„æ¯”è¾ƒ <a href="https://pubmed.ncbi.nlm.nih.gov/31711268/">[2]</a></p><p><strong>variable number of tandem repeats (VNTRs)</strong></p><blockquote><p>b) Dot plot of a <strong>6.7 kbp VNTR</strong> in the <strong>intron</strong> of <em>RTEL1</em> (chr20:63693361â€“63693833) (top panel), <strong>which was resolved in the HiFi assembly only</strong>. The <strong>CLR assembly</strong> contained a <strong>gap</strong> over this region. The overall structure and length of this VNTR was <strong>supported by the ONT reads</strong> mapping to this location, which averaged 5,956 +&#x2F;âˆ’ 1799 bp (n &#x3D; 5 ultra-long ONT reads), placing the HiFi sequence length at &lt;1 standard deviation away from the average ONT read. The motif homology plot (bottom panel) indicates that the content of the <em>RTEL1</em> VNTR is relatively pure, with an average sequence identity to the 15-mer repeat unit of 94.49% across the 439 copies.</p></blockquote><blockquote><p>c)Dot plot of the <strong>zinc finger protein gene <em>ZNF717</em></strong> (GRCh38 coordinates: chr3:75777127â€“75780446) (top panel), which was <strong>collapsed in the CLR</strong> assembly but <strong>fully represented in the HiFi assembly</strong>. The number of copies of this <strong>35 bp repeat unit</strong> increased from <strong>15 in the CLR</strong> assembly to <strong>89 in the HiFi</strong> assembly. The large amount of variation between individual copies of this VNTR is shown in the region between the <strong>red lines</strong> in the motif homology plots (bottom panels). The <strong>level of purity within the VNTR increased</strong> from 80.38% sequence identity in the CLR assembly to 90.75% sequence identity in the HiFi assembly. The red vertical lines indicate the start and end position of the VNTR.</p></blockquote><h2 id="ç‹ "><a href="#ç‹ " class="headerlink" title="ç‹ "></a>ç‹ </h2><h3 id="1-ç®€å•å¤æ‚åŸºå› ç»„é€šåƒ"><a href="#1-ç®€å•å¤æ‚åŸºå› ç»„é€šåƒ" class="headerlink" title="1 ç®€å•å¤æ‚åŸºå› ç»„é€šåƒ"></a><strong>1 ç®€å•å¤æ‚åŸºå› ç»„é€šåƒ</strong></h3><p>PacBioå®˜æ–¹ï¼Œé™¤äº†å·²æŠ¥é“çš„<strong>äººã€æ°´ç¨»ã€æœè‡å’Œè·—åº“èšŠ</strong>ï¼Œç›®å‰HiFi ç»„è£…å·²ç»åœ¨<strong>äººã€å¤§éº»ã€ç‡•éº¦ã€å››å€ä½“æœˆå­£å’Œå…­å€ä½“åŠ å·çº¢æ‰</strong>ç­‰ç‰©ç§ä¸­åº”ç”¨ã€‚å³ä¾¿æ˜¯<strong>å¤§éº»ã€ç‡•éº¦ã€æœˆå­£ã€åŠ å·çº¢æ‰</strong>è¿™äº›<strong>å¤æ‚</strong>åŸºå› ç»„ï¼ŒHiFi ç»„è£…ä¸ä¿—ã€‚11 Gbç‡•éº¦çš„Contig N50é«˜è¾¾<strong>20 Mb</strong>ï¼é«˜é‡å¤é«˜æ‚åˆçš„å¤šå€ä½“è£¸å­æ¤ç‰©çš„åŠ å·çº¢æ‰è¶…å¤§åŸºå› ç»„ï¼ŒHiFi çš„Contig N50ä¹Ÿè¾¾åˆ°1.92 Mbï¼Œè¿œé«˜äºå·²æŠ¥é“å…¶ä»–è£¸å­æ¤ç‰©åŸºå› ç»„ã€‚</p><h3 id="2-é«˜è´¨é‡å•å€å‹åŸºå› ç»„ç»„è£…"><a href="#2-é«˜è´¨é‡å•å€å‹åŸºå› ç»„ç»„è£…" class="headerlink" title="2 é«˜è´¨é‡å•å€å‹åŸºå› ç»„ç»„è£…"></a><strong>2 é«˜è´¨é‡å•å€å‹åŸºå› ç»„ç»„è£…</strong></h3><p>ç»„è£…<strong>å¤šå€ä½“</strong>æ—¶ï¼Œç»„è£…è½¯ä»¶å¿…é¡»èƒ½<strong>åŒºåˆ†ä¸åŒçš„ç­‰ä½åŸºå› </strong>ï¼Œå¹¶<strong>ä¿å­˜ä¸ºä¸åŒçš„åºåˆ—</strong>ã€‚ç”¨HiCanuå¯¹äººåŸºå› ç»„çš„HiFi Readsç»„è£…ç»“æœåŒ…å«<strong>è¶…è¿‡2 Gbçš„æ›¿ä»£Contig</strong>ï¼Œè€Œ<strong>å…¶å®ƒè½¯ä»¶</strong>åªèƒ½äº§ç”Ÿ<strong>ä¸åˆ°400 Mb</strong>çš„<strong>æ›¿ä»£Contig</strong>ã€‚è¯´æ˜HiCanuç»“åˆHiFi Readså…·æœ‰æ›´å¼ºçš„<strong>åŒºåˆ†å•å€å‹çš„èƒ½åŠ›</strong>ã€‚å¹¶ä¸”ï¼ŒHiCanuç»„è£…çš„<font color="blue">ä¸»è¦Contig</font>å’Œ<font color="blue">æ›¿ä»£Contig</font>éƒ½å…·æœ‰è¾ƒé«˜çš„<font color="red">BUSCOå®Œæ•´æ€§</font>ï¼ˆ&gt; <strong>94ï¼…</strong>å’Œ&gt; 75ï¼…ï¼‰ï¼Œè¿œ<strong>é«˜</strong>äº<strong>Nanopore ultra-long Reads</strong>ç»„è£…çš„BUSCOå®Œæ•´æ€§ï¼ˆåˆ†åˆ«åªæœ‰**63%<strong>å’Œ</strong>0.3%**ï¼‰ã€‚</p><h1 id="hifiasm-Official-doc"><a href="#hifiasm-Official-doc" class="headerlink" title="hifiasm Official doc"></a><a href="https://github.com/chhylp123/hifiasm">hifiasm Official doc</a></h1><p><strong>install</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># Install hifiasm (requiring g++ and zlib)</span><br>git <span class="hljs-built_in">clone</span> https://github.com/chhylp123/hifiasm<br><span class="hljs-comment">#download zipfile unzip</span><br><span class="hljs-built_in">cd</span> hifiasm &amp;&amp; make<br></code></pre></td></tr></table></figure><p><strong>simple use</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># Run on test data (use -f0 for small datasets)?</span><br>wget https://github.com/chhylp123/hifiasm/releases/download/v0.7/chr11-2M.fa.gz<br>./hifiasm -o <span class="hljs-built_in">test</span> -t4 -f0 chr11-2M.fa.gz 2&gt; test.log<br>ã€awk <span class="hljs-string">&#x27;/^S/&#123;print &quot;&gt;&quot;$2;print $3&#125;&#x27;</span> test.bp.p_ctg.gfa &gt; test.p_ctg.faã€‘  <span class="hljs-comment"># get primary contigs in FASTA</span><br><br><span class="hljs-comment"># Assemble inbred/homozygous genomes (-l0 disables duplication purging)</span><br><span class="hljs-comment">#?</span><br>hifiasm -o CHM13.asm -t32 -l0 CHM13-HiFi.fa.gz 2&gt; CHM13.asm.log<br><span class="hljs-comment"># Assemble heterozygous genomes with built-in duplication purging</span><br><span class="hljs-comment">#?</span><br>hifiasm -o HG002.asm -t32 HG002-file1.fq.gz HG002-file2.fq.gz<br><br><span class="hljs-comment"># Hi-C phasing with paired-end short reads in two FASTQ files</span><br><span class="hljs-comment">#add Hi-C data</span><br>hifiasm -o HG002.asm --h1 read1.fq.gz --h2 read2.fq.gz HG002-HiFi.fq.gz<br><br><span class="hljs-comment"># Trio binning assembly (requiring https://github.com/lh3/yak)</span><br><span class="hljs-comment">#combine parent sequencing data</span><br>yak count -b37 -t16 -o pat.yak &lt;(<span class="hljs-built_in">cat</span> pat_1.fq.gz pat_2.fq.gz) &lt;(<span class="hljs-built_in">cat</span> pat_1.fq.gz pat_2.fq.gz)<br>yak count -b37 -t16 -o mat.yak &lt;(<span class="hljs-built_in">cat</span> mat_1.fq.gz mat_2.fq.gz) &lt;(<span class="hljs-built_in">cat</span> mat_1.fq.gz mat_2.fq.gz)<br>hifiasm -o HG002.asm -t32 -1 pat.yak -2 mat.yak HG002-HiFi.fa.gz<br></code></pre></td></tr></table></figure><h2 id="introduction"><a href="#introduction" class="headerlink" title="introduction"></a>introduction</h2><p>Hifiasm is a <font color="blue"><strong>fast haplotype-resolved de novo assembler</strong></font> for <font color="blue"><strong>PacBio HiFi reads</strong></font>. It can <strong>assemble a human genome in several hours</strong> and assemble a <strong>~30Gb</strong> California redwood genome in <strong>a few days</strong>. Hifiasm emits <font color="red"><strong>partially phased assemblies</strong></font> of quality competitive with the best assemblers. Given <font color="green"><strong>parental short reads</strong></font> or <font color="green"><strong>Hi-C data</strong></font>, it produces arguably <font color="red"><strong>the best haplotype-resolved assemblies</strong></font> so far.</p><h2 id="Why-Hifiasm"><a href="#Why-Hifiasm" class="headerlink" title="Why Hifiasm?"></a>Why Hifiasm?</h2><ul><li>Hifiasm delivers high-quality assemblies. It tends to generate <font color="blue">longer contigs</font> and resolve <font color="blue">more segmental duplications</font> than other assemblers.</li><li>Given <font color="blue">Hi-C reads</font> or <font color="blue">short reads from the parents</font>, hifiasm can produce overall <font color="blue"><strong>the best haplotype-resolved assembly</strong></font> so far. It is the assembler of choice by the <a href="https://humanpangenome.org/">Human Pangenome Project</a> for the first batch of samples.</li><li>Hifiasm can <font color="blue">purge duplications?</font> between haplotigs without relying on third-party tools such as purge_dups. Hifiasm does <font color="blue">not need polishing tools?</font> like pilon or racon, either. This simplifies the assembly pipeline and saves running time.</li><li>Hifiasm is <font color="blue">fast</font>. It can assemble a human genome in half a day and assemble a ~30Gb redwood genome in three days. <font color="blue">No genome is too large for hifiasm</font>.</li><li>Hifiasm is trivial to install and easy to use. It does not required Python, R or C++11 compilers, and can be compiled into a single executable. The default setting works well with a variety of genomes.</li></ul><h1 id="hifiasm-paper"><a href="#hifiasm-paper" class="headerlink" title="hifiasm paper"></a>hifiasm paper</h1><p>refï¼š<a href="https://www.jianshu.com/p/6d79690dce5d">https://www.jianshu.com/p/6d79690dce5d</a></p><p><a href="https://hifiasm.readthedocs.io/en/latest/index.html">https://hifiasm.readthedocs.io/en/latest/index.html</a></p><p><a href="https://links.jianshu.com/go?to=https://github.com/chhylp123/hifiasm">https://github.com/chhylp123/hifiasm</a></p><p><a href="https://links.jianshu.com/go?to=https://www.nature.com/articles/s41592-020-01056-5">https://www.nature.com/articles/s41592-020-01056-5</a></p><h2 id="åŸç†ä»‹ç»1"><a href="#åŸç†ä»‹ç»1" class="headerlink" title="åŸç†ä»‹ç»1"></a>åŸç†ä»‹ç»1</h2><p>hifiasmæœ‰æ•ˆåˆ©ç”¨PacBio HiFiæµ‹åºæŠ€æœ¯ï¼Œåœ¨<font color="red"><strong>åˆ†å‹ç»„è£…å›¾(pahsed assembly gprah)</strong></font>ä¸­å¯é çš„è¡¨ç¤ºå•å€ä½“ä¿¡æ¯ã€‚</p><p><strong>ç¬¬ä¸€é˜¶æ®µ</strong>ï¼šé€šè¿‡æ‰€æœ‰åºåˆ—ç›¸äº’æ¯”å¯¹ï¼Œå¯¹æ½œåœ¨æµ‹åºé”™è¯¯çº æ­£ã€‚å¦‚æœ<font color="red">ä¸€ä¸ªä½ç½®åªå­˜åœ¨ä¸¤ç§ç¢±åŸºç±»å‹</font>ï¼Œä¸”æ¯ä¸ªç¢±åŸºç±»å‹<font color="red">è‡³å°‘æœ‰3æ¡readæ”¯æŒ</font>ï¼Œé‚£ä¹ˆè¿™ä¸ªä½ç½®ä¼šè¢«å½“ä½œ<font color="red">æ‚åˆä½ç‚¹</font>ï¼Œå¦åˆ™è§†ä½œæµ‹åºé”™è¯¯çº æ­£ã€‚</p><p><strong>ç¬¬äºŒé˜¶æ®µ</strong>ï¼šæ ¹æ®<font color="red">åºåˆ—ä¹‹é—´é‡å å…³ç³»</font>ï¼Œæ„å»º<font color="red">åˆ†å‹çš„å­—ç¬¦ä¸²å›¾(phased string graph)</font>ã€‚å…¶ä¸­è°ƒæ•´æœå‘çš„åºåˆ—ä½œä¸º<font color="red">é¡¶ç‚¹(vertex)</font>ï¼Œä¸€è‡´é‡å ä½œä¸º<font color="red">è¾¹(edge)</font>ã€‚å­—ç¬¦ä¸²å›¾ä¸­çš„<font color="red">æ°”æ³¡(bubble)</font>åˆ™æ˜¯<font color="red">æ‚åˆä½ç‚¹</font>ã€‚</p><p><strong>ç¬¬ä¸‰é˜¶æ®µ</strong>ï¼šå¦‚æœæ²¡æœ‰é¢å¤–çš„ä¿¡æ¯ï¼Œhifiasmä¼š<font color="red">éšæœºé€‰æ‹©æ°”æ³¡ä¸€è¾¹</font>æ„å»ºprimary assemblyï¼Œå¦ä¸€è¾¹åˆ™æ˜¯alternate assembly. è¯¥ç­–ç•¥å’ŒHiCanuï¼ŒFalcon-Unzipä¸€æ ·ã€‚å¯¹äºæ‚åˆåŸºå› ç»„è€Œè¨€ï¼Œç”±äºå­˜åœ¨ä¸€ä¸ªä»¥ä¸Šçš„çº¯åˆhaplotypeï¼Œå› æ­¤<font color="red">primary assemblyå¯èƒ½è¿˜ä¼šåŒ…å«haplotigs</font>ã€‚HiCanuä¾èµ–ç¬¬ä¸‰æ–¹çš„purge_dups, è€Œhifiasmå†…éƒ¨å®ç°purge_dupsç®—æ³•çš„å˜ç§ï¼Œç®€åŒ–äº†æµç¨‹ã€‚å¦‚æœæœ‰<font color="red">é¢å¤–ä¿¡æ¯</font>ï¼Œhifiasmå¯æ­£ç¡®çš„å¯¹<font color="red">haplotypeè¿›è¡Œåˆ†å‹</font>ã€‚</p><p><img src="/GeekFocus/2022-03-02-HiFi-3-software/1.png" alt="img"><br><img src="/GeekFocus/img/2022-03-02-HiFi-3-software/1.png" alt="img"></p><h2 id="hifiasm-åŸç†ä»‹ç»2"><a href="#hifiasm-åŸç†ä»‹ç»2" class="headerlink" title="hifiasm åŸç†ä»‹ç»2"></a>hifiasm åŸç†ä»‹ç»2</h2><p><strong>å¯è¯†åˆ«å•å€å‹çš„çº é”™</strong></p><p>Hifiasmå°†æ‰€æœ‰hifi readsè¯»å–åˆ°å†…å­˜ä¸­è¿›è¡Œ<font color="red"><strong>all-vs-allæ¯”å¯¹å¹¶çº é”™</strong></font>ã€‚åŸºäºreadsé—´overlapä¿¡æ¯ï¼Œå¦‚æœreadä¸Šæœ‰ä¸€ä¸ªç¢±åŸºä¸å…¶ä»–ç¢±åŸºä¸åŒï¼Œå¹¶æœ‰<font color="red"><strong>è‡³å°‘3æ¡readsæ”¯æŒ</strong></font>ï¼Œåˆ™è®¤ä¸ºå®ƒæ˜¯<font color="red"><strong>SNP</strong></font>å¹¶ä¿ç•™ï¼Œ<strong>å¦åˆ™</strong>è®¤ä¸ºæ˜¯é”™è¯¯å¹¶<strong>çº æ­£</strong>ã€‚</p><p><strong>ç»„è£…å›¾çš„æ„å»º</strong></p><p>åœ¨æ ¡æ­£ä¹‹åï¼Œå¤§å¤šæ•°é”™è¯¯è¢«å»é™¤ï¼ŒåŒæ—¶<font color="red"><strong>æ‚åˆå˜å¼‚ä¿¡æ¯è¢«ä¿ç•™</strong></font>ã€‚åŸºäºè¿™äº›ä¿¡æ¯ï¼ŒHifiasmæ„å»ºäº†<font color="red"><strong>ä»¥readsä¸ºé¡¶ç‚¹ã€é‡å åŒºä¸ºè¾¹çš„å®šç›¸string-graph</strong></font>ã€‚</p><p><strong>ç»„è£…åºåˆ—çš„ç”Ÿæˆ</strong></p><ul><li><p>å¦‚æœ<font color="red">æ²¡æœ‰å…¶ä»–æ•°æ®</font>ï¼ŒHifiasmåœ¨è¾“å‡ºåºåˆ—æ—¶ä¼š<font color="red"><strong>ä»»æ„é€‰æ‹©</strong>æ¯ä¸ªæ°”æ³¡<strong>bubble</strong>çš„<strong>ä¸€ä¾§è¾“å‡º</strong>ç±»ä¼¼<strong>Falcon unzip</strong>å’Œ<strong>HiCanu</strong>çš„ä¸»è¦ç»„è£…ç»“æœ</font>ï¼ˆprimary contigsï¼‰ã€‚</p></li><li><p>å¦‚æœåŒæ—¶æœ‰<font color="red">çˆ¶æ¯æœ¬çš„æµ‹åºæ•°æ®</font>ï¼ŒHifiasmå¯ä»¥é€šè¿‡<font color="red">äº²æœ¬ç‰¹æœ‰çš„kmer</font>åœ¨å›¾ä¸Š<font color="red">è¯†åˆ«æ¥è‡ªçˆ¶æ¯æœ¬çš„åºåˆ—</font>ï¼Œå¾—åˆ°<font color="red"><strong>ä¸¤å¥—å•å€ä½“</strong>åŸºå› ç»„</font>ã€‚</p></li><li><p>å½“ç„¶HiFiasmæ–‡ç« ä¸­ä¹Ÿæåˆ°ï¼š</p><p>ä¸å…¶ä»–åŸºäºå›¾å½¢çš„æ±‡ç¼–ç¨‹åºä¸åŒï¼ŒHiFiasmè‡´åŠ›äº<strong>ä¿æŒæ‰€æœ‰å•å€å‹çš„è¿ç»­æ€§ã€‚</strong><br><font color="red"><strong>HiCanu</strong>åªè¯•å›¾<strong>ä¿æŒä¸€ä¸ªäº²æœ¬å•å€å‹</strong>çš„<strong>è¿ç»­æ€§</strong></font>ï¼Œå¹¶ä¸”ç»å¸¸<font color="red">ç ´åå¦ä¸€ä¸ªå•å€å‹çš„è¿ç»­æ€§</font>ï¼Œå½“åˆ†ç¦»äº²æœ¬å•å€å‹æ—¶ï¼Œè¿™äº›çªå˜ç‚¹å°†å¯¼è‡´å•å€å‹åˆ†è§£çš„ç¢ç‰‡â€”HiCanu<font color="red">æ²¡æœ‰å……åˆ†åˆ©ç”¨HiFi Reads</font><br>Hifiasmé’ˆå¯¹HiFiç‰¹ç‚¹å¼€å‘ï¼Œåœ¨hifiæ•°æ®çš„ç»„è£…è¡¨ç°ä¸Šè¾ƒåŒç±»è½¯ä»¶æ›´ä¸ºçªå‡ºï¼Œåœ¨å¤šä¸ªåŸºå› ç»„ä¸Šè¡¨ç°å‡ºäº†æ›´é«˜çš„<strong>å‡†ç¡®æ€§</strong>å’Œç»„è£…çš„<strong>è¿ç»­æ€§</strong>ã€‚</p></li></ul><h2 id="ä»…HiFiæ•°æ®æ¨¡å¼"><a href="#ä»…HiFiæ•°æ®æ¨¡å¼" class="headerlink" title="ä»…HiFiæ•°æ®æ¨¡å¼"></a>ä»…HiFiæ•°æ®æ¨¡å¼</h2><p>æœ€åŸºæœ¬çš„ç”¨æ³•ï¼Œä¼šå¾—åˆ°ä¸¤ä¸ªéƒ¨åˆ†åˆ†å‹çš„ç»„è£…</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">wget https://github.com/chhylp123/hifiasm/releases/download/v0.7/chr11-2M.fa.gz<br>hifiasm -o <span class="hljs-built_in">test</span> -t 32 chr11-2M.fa.gz 2&gt; test.log<br><span class="hljs-comment">#-oè¾“å‡ºæ–‡ä»¶å‰ç¼€ -tçº¿ç¨‹</span><br></code></pre></td></tr></table></figure><p>ç»“æœæ–‡ä»¶å…³æ³¨å¦‚ä¸‹å‡ é¡¹ (prefixä¸ºå‰ç¼€ï¼‰</p><ul><li><code>prefix.bp.r_utg.gfa</code>: haplotype-resolved raw unitig graphï¼Œè®°å½•æ‰€æœ‰çš„å•å€å‹ä¿¡æ¯</li><li><code>prefix.bp.p_utg.gfa</code>: åœ¨raw unitig graphåŸºç¡€ä¸Šè¿‡æ»¤å°çš„bubbleï¼Œ</li><li><code>prefix.bp.p_ctg.gfa</code>: ä¸»è¦contigçš„assembly graph</li><li><code>prefix.bp.hap1.p_ctg.gfa</code>: haplotype1çš„éƒ¨åˆ†åˆ†å‹çš„contig graph</li><li><code>prefix.bp.hap2.p_ctg.gfa</code>: haplotype2çš„éƒ¨åˆ†åˆ†å‹çš„contig graph</li></ul><p>å¦‚æœå¹¶ä¸éœ€è¦éƒ¨åˆ†åˆ†å‹çš„ç»„è£…ï¼Œåªè¦primaryå’Œalternateçš„ç»„è£…ç»“æœï¼Œå¯ä»¥åœ¨ä¹‹å‰å‘½ä»¤çš„åŸºç¡€ä¸Šï¼ŒåŠ ä¸Š <code>--primary</code>å‚æ•°ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">hifiasm --primary -o <span class="hljs-built_in">test</span> -t 32 chr11-2M.fa.gz 2&gt; test.log2<br></code></pre></td></tr></table></figure><p>ç”±äºhifiasmè¿è¡Œæ—¶ä¼šå°†æ­¥éª¤ä¸­çº é”™å’Œç›¸äº’æ¯”å¯¹çš„ç»“æœä¿å­˜æˆ bin æ–‡ä»¶ï¼Œå› æ­¤reruné€Ÿåº¦å¾ˆå¿«(å‰ç¼€åå·®å¼‚)ã€‚</p><p>primayæ¨¡å¼ä¸‹è¾“å‡ºçš„æ–‡ä»¶å’Œä¹‹å‰çš„ç±»ä¼¼ï¼Œå”¯ä¸€çš„ä¸åŒåœ¨äºæ²¡æœ‰ <strong>bp</strong></p><p>prefix<code>.r_utg.gfa</code>: haplotype-resolved raw unitig graph: ä¿ç•™äº†ç»„è£…ç”Ÿæˆçš„æ‰€æœ‰å•ä½“å‹ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä½“ç»†èƒçªå˜å’Œé‡å¤çš„æµ‹åºé”™è¯¯ã€‚</p><p>prefix<code>.p_utg.gfa</code>: haplotype-resolved processed unitig graph without small bubblesï¼šæ— å°æ°”æ³¡çš„å•å€å‹è§£æï¼›å»æ‰ç”±äºä½“ç»†èƒçªå˜å’Œæ•°æ®èƒŒæ™¯å™ªéŸ³å¼•èµ·çš„small bubblesï¼ˆè¿™ä¸ªå¹¶ä¸æ˜¯çœŸæ­£çš„å•ä½“å‹ä¿¡æ¯ï¼‰ï¼Œå¯¹äºé«˜åº¦æ‚åˆåŸºå› ç»„ç‰©ç§ä¼˜å…ˆé€‰æ‹©è¿™ä¸ªç»“æœã€‚</p><p>prefix<code>.p_ctg.gfa</code>: assembly graph of primary contigsï¼šå¯¹äºä½æ‚åˆåº¦ç‰©ç§æ¥è¯´ï¼Œä¼˜å…ˆé€‰æ‹©è¯¥æ–‡ä»¶ï¼›å¯¹äºé«˜æ‚åˆåº¦ç‰©ç§ï¼Œè¯¥ç»“æœä»£è¡¨å…¶ä¸­ä¸€ä¸ªå•å€å‹ã€‚</p><p>prefix<code>.a_ctg.gfa</code>: assembly graph of alternate contigsï¼šç»„è£…å‡ºæ¥çš„å¦ä¸€å¥—å•ä½“å‹åŸºå› ç»„ç»“æœã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#contigï¼Œé€šè¿‡awkæå–</span><br>awk <span class="hljs-string">&#x27;/^S/&#123;print &quot;&gt;&quot;$2;print $3&#125;&#x27;</span> test.p_ctg.gfa &gt; test.p_ctg.fa<br></code></pre></td></tr></table></figure><h2 id="åŒäº²äºŒä»£æµ‹åºTrio-binningæ¨¡å¼"><a href="#åŒäº²äºŒä»£æµ‹åºTrio-binningæ¨¡å¼" class="headerlink" title="åŒäº²äºŒä»£æµ‹åºTrio-binningæ¨¡å¼"></a>åŒäº²äºŒä»£æµ‹åºTrio-binningæ¨¡å¼</h2><p>å¦‚æœæœ‰åŒäº²æ•°æ®ï¼Œåˆ™å¯ä½¿ç”¨trio-binningæ–¹æ³•è¿›è¡Œæ›´å¯é çš„åˆ†å‹ã€‚åˆ†ä¸ºä¸¤æ­¥ï¼Œ<font color="red"><strong>å…ˆç”¨yakç»Ÿè®¡k-mersï¼Œ ç„¶åç”¨hifiasmè¿›è¡Œç»„è£…</strong></font></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">yak count -k31 -b37 -t16 -o pat.yak paternal.fq.gz<br>yak count -k31 -b37 -t16 -o mat.yak maternal.fq.gz<br>hifiasm -o NA12878.asm -t 32 -1 pat.yak -2 mat.yak NA12878.fq.gz<br></code></pre></td></tr></table></figure><p>è¾“å‡ºå’Œä¹‹å‰ç±»ä¼¼ï¼Œä¸»è¦å…³æ³¨æ–‡ä»¶å<font color="red">å¸¦ dip çš„è¾“å‡ºgfaæ–‡ä»¶</font></p><ul><li><strong>prefix.r_utg.gfa</strong>(Haplotype-resolved raw unitig graph in GFA format):ä¿å­˜äº†æ‰€æœ‰çš„å•å€å‹ä¿¡æ¯ã€‚</li></ul><ul><li><code>prefix.dip.hap1.p_ctg.gfa</code>: å®Œæˆåˆ†å‹çš„<font color="red"><strong>çˆ¶æºå•å€ä½“ contigå›¾</strong></font>ã€‚(Phased paternal&#x2F;haplotype1 contig graph):ä¿ç•™äº†é˜¶æ®µæ€§çˆ¶ç³»&#x2F;å•å€å‹1ç»„è£…ã€‚</li><li><code>prefix.dip.hap2.p_ctg.gfa</code>: å®Œå…¨åˆ†å‹çš„<font color="red"><strong>æ¯æºå•å€ä½“contigå›¾</strong></font>ã€‚(Phased maternal&#x2F;haplotype2 contig graph):ä¿ç•™äº†é˜¶æ®µæ€§æ¯ç³»&#x2F;å•å€å‹2ç»„è£…ã€‚</li></ul><h2 id="é™„åŠ Hi-Cæ¨¡å¼"><a href="#é™„åŠ Hi-Cæ¨¡å¼" class="headerlink" title="é™„åŠ Hi-Cæ¨¡å¼"></a>é™„åŠ Hi-Cæ¨¡å¼</h2><p>ç”±äºHi-Cæ•°æ®èƒ½å¤Ÿæä¾›<strong>è¿œè·ä¿¡æ¯</strong>ï¼Œå› æ­¤ä¹Ÿèƒ½<strong>ç”¨äºå•å€ä½“åˆ†å‹</strong>ã€‚éœ€è¦åŠ ä¸¤ä¸ªå‚æ•°ï¼Œ h1ä¸ºHi-Cçš„read1, h2 ä¸ºHi-Cçš„read2</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hifiasm -o NA12878.asm -t 32 --h1 read1.fq.gz --h2 read2.fq.gz HiFi-reads.fq.gz<br></code></pre></td></tr></table></figure><p>åœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ªcontigè¦ä¹ˆæ˜¯æ¥è‡ªäºçˆ¶äº²ï¼Œè¦ä¹ˆæ˜¯æ¥è‡ªäºæ¯äº²ã€‚hifiasmå°†<font color="red">åŒä¸€æ¥æºçš„contigæ”¾åœ¨åŒä¸€ä¸ªç»„è£…ä¸­</font>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œhifiasmæœªå¿…èƒ½å¤Ÿå¤„ç†å¥½<font color="red">ç€ä¸ç²’é™„è¿‘åŒºåŸŸ</font>ï¼Œå¦å¤–<font color="red">hifiasmä¸­Hi-Cä¹Ÿä¸ä¼šç”¨äºè¿›è¡Œscaffold</font>ã€‚</p><p>è¾“å‡ºç»“æœé‡ç‚¹å…³æ³¨å¸¦hicçš„æ–‡ä»¶</p><ul><li><code>prefix.hic.p_ctg.gfa</code>: ä¸»è¦contigçš„ç»„è£…å›¾</li><li><code>prefix.hic.hap1.p_ctg.gfa</code>: å®Œå…¨åˆ†å‹çš„haplotype1çš„contigå›¾</li><li><code>prefix.hic.hap2.p_ctg.gfa</code>: å®Œå…¨åˆ†å‹çš„haplotype2çš„contigå›¾</li><li><code>prefix.hic.a_ctg.gfa</code> : å¦‚æœè®¾ç½®äº† <code>--primary</code>å‚æ•°ï¼Œè¿˜ä¼šè¾“å‡ºè¯¥æ¬¡è¦contigçš„ç»„è£…å›¾</li></ul><h2 id="æ—¥å¿—å’Œå‚æ•°è°ƒæ•´"><a href="#æ—¥å¿—å’Œå‚æ•°è°ƒæ•´" class="headerlink" title="æ—¥å¿—å’Œå‚æ•°è°ƒæ•´"></a>æ—¥å¿—å’Œå‚æ•°è°ƒæ•´</h2><p>ç»å¤§éƒ¨åˆ†çš„æ—¶å€™ï¼Œåªéœ€è¦ä½¿ç”¨é»˜è®¤å‚æ•°å³å¯å¾—åˆ°ç›¸å¯¹æ¯”è¾ƒå¥½çš„ç»“æœã€‚ä½†æ˜¯å½“é»˜è®¤å‚æ•°æ— æ³•è¾¾åˆ°ç›®çš„ï¼Œå°±éœ€è¦æ£€æŸ¥æ—¥å¿—ä¿¡æ¯ï¼Œé˜…è¯»ç›¸å…³å‚æ•°ä»è€Œä¼˜åŒ–ç»“æœã€‚</p><p>æ—¥å¿—ä¿¡æ¯ä¸»è¦åˆ†ä¸‰é¡¹</p><ul><li><font color="red">k-merå›¾</font>: çº¯åˆæ ·æœ¬ä¸€ä¸ªpeakï¼Œæ‚åˆæ ·æœ¬2ä¸ªpeakã€‚</li><li><font color="red">çº¯åˆå³°çš„è¦†ç›–åº¦</font>: <code>[M::purge_dups] homozygous read coverage threshold: X</code> , ä¸€èˆ¬ä¼šç”±hifiasmè‡ªåŠ¨æ¨æ–­ã€‚</li><li><font color="red">æ‚åˆ&#x2F;çº¯åˆç¢±åŸºæ•°ç›®ï¼ˆHi-Cæ¨¡å¼ï¼‰</font>: Hi-Cæ¨¡å¼ä¸‹ï¼Œå¦‚æœçº¯åˆçš„ç¢±åŸºæ•°è¶…è¿‡æ‚åˆç¢±åŸºæ•°ï¼Œé‚£ä¹ˆhifiasmå°±ä¸å®¹æ˜“æ‰¾å¯¹çº¯åˆreadçš„æ‰€åœ¨å³°ã€‚</li></ul><p>å¯¹äºæ—¥å¿—ä¿¡æ¯ï¼Œæœ€ä¸»è¦å…³æ³¨<font color="red">k-merå›¾</font>ï¼Œä»è€Œåˆ¤æ–­hifiasmæ˜¯å¦èƒ½å¤Ÿæ­£ç¡®çš„æ‰¾åˆ°çº¯åˆå³°ï¼Œæ‚åˆå³°æ‰€åœ¨ä½ç½®ã€‚å¦‚æœhifiasmæ²¡æœ‰æ‰¾å¯¹çº¯åˆå³°æ‰€åœ¨çš„ä½ç½®ï¼Œå°±éœ€è¦<font color="red">æ ¹æ®k-merå›¾æ‰‹åŠ¨æŒ‡å®š?</font> <code>--hom-cov</code>ã€‚</p><p>å¯¹äºä¸€ä¸ªç»„è£…ç»“æœï¼Œæœ€ç›´æ¥çš„<strong>è¯„ä¼°æ ‡å‡†</strong>å°±æ˜¯<font color="red">åŸºå› ç»„å¤§å°æ˜¯å¦ç¬¦åˆé¢„æœŸ</font>ï¼Œåˆ†å‹çš„<font color="red">ä¸¤å¥—åŸºå› ç»„æ˜¯å¦ç›¸å·®ä¸å¤§</font>ï¼Œåºåˆ—<strong>æ˜¯å¦è¶³å¤Ÿé•¿</strong>ï¼Œ<strong>æ˜¯å¦å­˜åœ¨é”™è¯¯ç»„è£…</strong>çš„æƒ…å†µã€‚</p><p>å¦‚æœåŸºå› ç»„<font color="red"><strong>å¤§å°ä¸ç¬¦åˆé¢„æœŸ</strong></font>ï¼Œä¸€èˆ¬éƒ½æ˜¯hifiasm<strong>æ‰¾é”™çº¯åˆå³°çš„ä½ç½®</strong>ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®š <code>--hom-cov</code>ï¼›</p><p>å¦‚æœåˆ†å‹çš„ä¸¤å¥—åŸºå› ç»„<font color="red"><strong>å·®åˆ«è¿‡å¤§</strong></font>ï¼Œåˆ™é€šè¿‡é™ä½ <code>-s</code> è°ƒæ•´ã€‚</p><p>å¦‚æœ<font color="red"><strong>åºåˆ—ä¸å¤Ÿé•¿ï¼Œç‰‡æ®µåŒ–æ˜æ˜¾</strong></font>ï¼Œåˆ™å¯å°è¯•<font color="red">å¢åŠ </font>  <code>-D</code> å’Œ  <code>-N</code>, è™½å¢åŠ è¿è¡Œæ—¶é—´ï¼Œä½†ä¼š<font color="red">æé«˜é‡å¤åŒºåŸŸçš„åˆ†è¾¨ç‡</font>ã€‚</p><p>å¦‚æœåç»­çš„Hi-Cï¼Œæˆ–è€…BioNanoå‘ç°hifiasmç»„è£…ç»“æœ<font color="red"><strong>æœ‰æ¯”è¾ƒå¤šé”™è¯¯ç»„è£…</strong></font>ï¼Œåˆ™å¯ä»¥é€‚å½“é™ä½ <code>--purge-max</code>, <code>-s</code>å’Œ <code>-O</code>ã€‚æˆ–è€…è®¾ç½® <code>-u</code> å…³é—­post-join æ­¥éª¤ï¼Œhifiasmé€šè¿‡è¯¥æ­¥éª¤æé«˜ç»„è£…çš„è¿ç»­æ€§ã€‚</p><h2 id="è¾“å…¥æ ¼å¼-fqè¿˜æ˜¯fa"><a href="#è¾“å…¥æ ¼å¼-fqè¿˜æ˜¯fa" class="headerlink" title="è¾“å…¥æ ¼å¼ fqè¿˜æ˜¯fa"></a>è¾“å…¥æ ¼å¼ fqè¿˜æ˜¯fa</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment"># bam --&gt; fasta</span><br><span class="hljs-attribute">samtools</span> view <span class="hljs-regexp">*.bam</span> | awk <span class="hljs-string">&#x27;&#123;print &quot;&gt;&quot;<span class="hljs-variable">$1</span>&quot;\n&quot;<span class="hljs-variable">$10</span>&#125;&#x27;</span> &gt; fasta<br><span class="hljs-comment"># bam2fastq</span><br></code></pre></td></tr></table></figure><hr><h1 id="HiCanu-https-canu-readthedocs-io-en-latest-index-html"><a href="#HiCanu-https-canu-readthedocs-io-en-latest-index-html" class="headerlink" title="HiCanu[https://canu.readthedocs.io/en/latest/index.html]"></a>HiCanu[<a href="https://canu.readthedocs.io/en/latest/index.html]">https://canu.readthedocs.io/en/latest/index.html]</a></h1><hr><p>ref <a href="https://www.jianshu.com/p/c1aeeae77cb5">https://www.jianshu.com/p/c1aeeae77cb5</a></p><p>Canuåˆ†ä¸‰ä¸ªæ­¥éª¤ï¼Œ<font color="red"><strong>çº é”™</strong></font>ï¼Œ<font color="red"><strong>ä¿®æ•´</strong></font>å’Œ<font color="red"><strong>ç»„è£…</strong></font>ï¼Œæ¯ä¸€æ­¥<font color="red">æ­¥éª¤<strong>ç›¸ä¼¼</strong></font>ï¼š</p><ul><li>åŠ è½½readåˆ°readæ•°æ®åº“ï¼ŒgkpStore</li><li>å¯¹k-merè¿›è¡Œè®°æ•°ï¼Œç”¨äºè®¡ç®—åºåˆ—é—´çš„overlap</li><li>è®¡ç®—overlap</li><li>åŠ è½½overlapåˆ°overlapæ•°æ®åº“ï¼ŒOvlStore</li><li>æ ¹æ®readå’Œoverlapå®Œæˆç‰¹å®šåˆ†æç›®æ ‡<ul><li>read<font color="blue"><strong>çº é”™</strong></font>æ—¶ä¼šä»overlapä¸­æŒ‘é€‰ä¸€è‡´æ€§åºåˆ—æ›¿æ¢åŸå§‹çš„å™ªå£°read</li><li>read<font color="blue"><strong>ä¿®æ•´</strong></font>æ—¶ä¼šä½¿ç”¨overlapç¡®å®šreadå“ªäº›åŒºåŸŸæ˜¯é«˜è´¨é‡åŒºåŸŸï¼Œå“ªäº›åŒºåŸŸè´¨é‡è¾ƒä½éœ€è¦ä¿®æ•´ã€‚æœ€åä¿ç•™å•ä¸ªæœ€é«˜è´¨é‡çš„åºåˆ—å—</li><li>åºåˆ—<font color="blue"><strong>ç»„è£…</strong></font>æ—¶æ ¹æ®ä¸€è‡´çš„overlapå¯¹åºåˆ—è¿›è¡Œç¼–æ’(layout), æœ€åå¾—åˆ°contig</li></ul></li></ul><p>ä¸‰æ­¥<font color="blue">å¯åˆ†å¼€</font>è¿è¡Œï¼Œæ—¢å¯ç”¨<font color="blue">Canuçº é”™åç»“æœ</font>ä½œä¸º<font color="blue">å…¶ä»–ç»„è£…è½¯ä»¶è¾“å…¥</font>ï¼Œä¹Ÿå¯å°†å…¶ä»–è½¯ä»¶çš„çº é”™ç»“æœä½œä¸ºCanuçš„è¾“å…¥ã€‚</p><p><font color="red">å‡ ä¸ª<strong>å…¨å±€å‚æ•°</strong></font>ï¼š</p><ul><li><font color="red"><strong>genomeSize</strong></font>è®¾ç½®é¢„ä¼°åŸºå› ç»„å¤§å°ï¼Œç”¨äºCanu<font color="blue">ä¼°è®¡æµ‹åº<strong>æ·±åº¦</strong></font>, The genome size should be your best guess of the haploid genome size of what is being assembled, It is used primarily to estimate coverage in reads, NOT as the desired assembly size.</li><li><font color="red">maxThreads</font>è®¾ç½®æœ€å¤§<font color="blue">çº¿ç¨‹</font></li><li><font color="red">rawErrorRate</font>è®¾ç½®<font color="blue">ä¸¤ä¸ª<strong>æœªçº é”™readä¹‹é—´</strong>æœ€å¤§<strong>æœŸæœ›å·®å¼‚ç¢±åŸºæ•°</strong></font></li><li><font color="red">correctedErrorRate</font>è®¾ç½®<font color="blue"><strong>çº é”™å</strong>readä¹‹é—´æœ€å¤§<strong>æœŸæœ›å·®å¼‚ç¢±åŸºæ•°</strong>ï¼Œ<strong>ç»„è£…</strong>æ­¥éª¤<strong>å¤šæ¬¡è°ƒæ•´</strong></font></li><li><font color="red">minReadLength</font>è¡¨ç¤º<font color="blue">åªä½¿ç”¨å¤§äºé˜ˆå€¼çš„åºåˆ—</font></li><li><font color="red">minOverlapLength</font>è¡¨ç¤º<font color="blue">Overlapæœ€å°é•¿åº¦</font></li><li>æé«˜minReadLengthå¯<strong>æ</strong>é«˜è¿è¡Œ<strong>é€Ÿ</strong>åº¦ï¼Œå¢åŠ minOverlapLengthå¯<strong>é™</strong>ä½<strong>å‡é˜³æ€§overlap</strong></li></ul><p><font color="blue">æµ‹è¯•æ•°æ®</font> â€œ<a href="https://links.jianshu.com/go?to=https://www.nature.com/articles/s41467-018-03016-2">High contiguity Arabidopsis thaliana genome assembly with a single nanopore flow cell</a>â€œã€‚ æä¾› <em>Arabidopsis thaliana</em> KBS-Mac-74 çš„30XçŸ­ç‰‡æ®µæ–‡åº“äºŒä»£æµ‹åºã€PacBioå’ŒNanoporeçš„ä¸‰ä»£æµ‹åºä»¥åŠBionanoæµ‹åºæ•°æ®, æ‹Ÿå—èŠ¥åŸºå› ç»„è¢«è®¤ä¸ºæ˜¯æ¤ç‰©é‡‘æ ‡å‡†ï¼Œæ•°æ®é€‚åˆç»ƒä¹ ã€‚é¡¹ç›®ç¼–å·â€PRJEB21270â€, åœ¨European Nucleotide Archiveä¸Šæ‰¾åˆ°ä¸‹è½½åœ°å€ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment">## PacBio Sequal</span><br>wget -c -q ftp:<span class="hljs-regexp">//</span>ftp.sra.ebi.ac.uk<span class="hljs-regexp">/vol1/</span>ERA111<span class="hljs-regexp">/ERA1116568/</span>bam/pb.bam<br><span class="hljs-comment">## MinION</span><br>wget -c -q ftp:<span class="hljs-regexp">//</span>ftp.sra.ebi.ac.uk<span class="hljs-regexp">/vol1/</span>ERA111<span class="hljs-regexp">/ERA1116595/</span>fastq/ont.fq.gz<br><span class="hljs-comment"># Illuminia MiSeq</span><br>wget -c -q ftp:<span class="hljs-regexp">//</span>ftp.sra.ebi.ac.uk<span class="hljs-regexp">/vol1/</span>ERA111<span class="hljs-regexp">/ERA1116569/</span>fastq/il_1.fq.gz<br>wget -c -q ftp:<span class="hljs-regexp">//</span>ftp.sra.ebi.ac.uk<span class="hljs-regexp">/vol1/</span>ERA111<span class="hljs-regexp">/ERA1116569/</span>fastq/il_2.fq.gz<br></code></pre></td></tr></table></figure><p><font color="blue">PacBioæ•°æ®ä»¥BAMæ ¼å¼å­˜å‚¨</font>ï¼Œé€šè¿‡å®‰è£…PacBioçš„smrtlinkå·¥å…·å¥—è£…ï¼Œä½¿ç”¨å…¶ä¸­<font color="blue">bam2fasta</font>è½¬æ¢</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-string">&#x27;build index for convert&#x27;</span><br>~/opt/biosoft/smrtlink/smrtcmds/bin/pbindex pb.bam &amp;<br><span class="hljs-comment"># convert bam to fasta</span><br>~/opt/biosoft/smrtlink/smrtcmds/bin/bam2fasta -o pb pb.bam &amp;<br></code></pre></td></tr></table></figure><p>PacBioçš„smrtlinkå·¥å…·å¥—è£…å¤§å°1.4Gï¼Œä¸‹è½½é€Ÿåº¦æ…¢ï¼Œå®‰è£…æ‰‹åŠ¨ç¡®è®¤å„ç§é€‰é¡¹, å¥½å¤„æ˜¯å·¥å…·å…¨ã€‚</p><h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><p>latest: <a href="https://github.com/marbl/canu/releases/tag/v2.2">https://github.com/marbl/canu/releases/tag/v2.2</a></p><h2 id="Run-Canu"><a href="#Run-Canu" class="headerlink" title="Run Canu"></a>Run Canu</h2><p><strong>ç¬¬ä¸€æ­¥</strong>ï¼š<font color="red"><strong>çº é”™</strong></font>ã€‚ä¸‰ä»£æµ‹åºé”™è¯¯ç‡é«˜ï¼ŒåŸå§‹æ•°æ®å……æ»¡å™ªéŸ³ã€‚é€šè¿‡<strong>åºåˆ—</strong>é—´<strong>ç›¸äº’æ¯”è¾ƒçº é”™å¾—åˆ°é«˜å¯ä¿¡åº¦çš„ç¢±åŸº</strong>ã€‚<font color="blue">ä¸»è¦<strong>è°ƒæ•´ä¸¤ä¸ªå‚æ•°</strong></font></p><ul><li><font color="blue">corOutCoverage</font>: æ§åˆ¶<strong>å¤šå°‘æ•°æ®</strong>ç”¨äºçº é”™ã€‚å¦‚æ‹Ÿå—èŠ¥120MåŸºå› ç»„ï¼Œ100Xæµ‹åº12Gæ•°æ®ï¼Œå¦‚æœåªç”¨æœ€é•¿6Gæ•°æ®çº é”™ï¼Œå‚æ•°è®¾ç½®ä¸º50(120m x 50)ã€‚<strong>è®¾ç½®å¤§äºæµ‹åºæ·±åº¦çš„å€¼</strong>å¦‚120è¡¨ç¤º<strong>ä½¿ç”¨æ‰€æœ‰æ•°æ®</strong>ã€‚<font color="green"><strong>-pacbio-raw</strong></font></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">canu -correct \<br>    -p ath -d pb_ath \<br>    Threads=10 gnuplotTested=<span class="hljs-literal">true</span>\<br>    genomeSize=120m minReadLength=2000 minOverlapLength=500\<br>    corOutCoverage=120 corMinCoverage=2 \<br>    -pacbio-raw pb.fasta.gz<br></code></pre></td></tr></table></figure><p>æ³¨: æœ‰äº›æœåŠ¡å™¨<strong>æ²¡æœ‰å®‰è£…gnuplot</strong>, <strong>gnuplotTested&#x3D;true</strong> è·³è¿‡æ£€æŸ¥ã€‚</p><p><strong>ç¬¬äºŒæ­¥</strong>ï¼š<font color="red"><strong>ä¿®æ•´</strong></font>ã€‚ä¸ºè·å–æ›´é«˜è´¨é‡çš„åºåˆ—ï¼Œ<font color="blue">ç§»é™¤å¯ç–‘åŒºåŸŸ</font>ï¼ˆå¦‚æ®‹ç•™çš„SMRTbellæ¥å¤´)ã€‚<font color="green"><strong>-pacbio-corrected</strong></font></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">canu -trim \<br>        -p ath -d pb_ath<br>        maxThreads=20 gnuplotTested=<span class="hljs-literal">true</span>\<br>        genomeSize=120m minReadLength=2000 minOverlapLength=500\<br>        -pacbio-corrected ath/pb_ath.correctedReads.fasta.gz<br></code></pre></td></tr></table></figure><p><strong>ç¬¬ä¸‰æ­¥</strong>: <font color="red"><strong>ç»„è£…</strong></font>ã€‚å‰ä¸¤æ­¥è·å¾—é«˜è´¨é‡åºåˆ—åæ­£å¼ç»„è£…ã€‚ ä¸»è¦è°ƒæ•´å‚æ•°æ˜¯<font color="red">çº é”™åçš„<strong>åºåˆ—é”™è¯¯ç‡ correctedErrorRate</strong></font>ï¼Œå®ƒä¼šå½±å“utgOvlErrorRateã€‚å¯å°è¯•å¤šä¸ªå‚æ•°ï¼Œå› ä¸ºé€Ÿåº¦è¾ƒå—ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># error rate 0.035</span><br>canu -assemble \<br>    -p ath -d ath-erate-0.035 \<br>    maxThreads=20 gnuplotTested=<span class="hljs-literal">true</span> \<br>    genomeSize=120m\<br>    correctedErrorRate=0.035 \<br>    -pacbio-corrected atg/pb_ath.trimmedReads.fasta.gz<br><span class="hljs-comment"># error rate 0.050</span><br>canu -assemble \<br>    -p ath -d ath-erate-0.050 \<br>    maxThreads=20 gnuplotTested=<span class="hljs-literal">true</span> \<br>    genomeSize=120m\<br>    correctedErrorRate=0.050 \<br>    -pacbio-corrected atg/pb_ath.trimmedReads.fasta.gz<br></code></pre></td></tr></table></figure><p>è¾“å‡ºæ–‡ä»¶<font color="red"><strong>ath.contigs.fasta</strong></font>ç»“æœæ–‡ä»¶ã€‚</p><h2 id="Debug"><a href="#Debug" class="headerlink" title="Debug"></a>Debug</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#qsub: submit error (No default queue specified MSG=requested queue not found)</span><br><span class="hljs-comment">#invalid useGrid (1) and gridEngine (PBS); found no execution hosts - is grid available from this host?.</span><br></code></pre></td></tr></table></figure><p>issue: <a href="https://github.com/marbl/canu/issues/1040">https://github.com/marbl/canu/issues/1040</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">advice : Canu uses the <span class="hljs-string">&quot;PBS command pbsnodes&quot;</span> to poll your available resources. On your compute nodes this is not working. See the FAQ: http://canu.readthedocs.io/en/latest/faq.html<span class="hljs-comment">#my-run-stopped-with-the-error-failed-to-submit-batch-jobs</span><br>If your nodes <span class="hljs-string">&#x27;cannot access/submit&#x27;</span> to the <span class="hljs-string">&#x27;grid&#x27;</span> <span class="hljs-keyword">then</span> Canu <span class="hljs-string">&#x27;wont work with your grid system&#x27;</span>. These are grid configuration issues so youll have to check with your sysadmin <span class="hljs-keyword">if</span> it can be changed. If not, youll have to run Canu on a single node or use useGrid=remote from the <span class="hljs-built_in">head</span> node <span class="hljs-built_in">which</span> will <span class="hljs-built_in">print</span> the commands <span class="hljs-keyword">for</span> you to manually run (see issue <span class="hljs-comment">#822).</span><br></code></pre></td></tr></table></figure><p><a href="https://canu.readthedocs.io/en/latest/faq.html#my-run-stopped-with-the-error-failed-to-submit-batch-jobs">canu FAQ</a></p><p><strong>How do I run Canu on my SLURM &#x2F; SGE &#x2F; PBS &#x2F; LSF &#x2F; Torque system?</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">Canu will <span class="hljs-string">&#x27;detect and configure&#x27;</span> itself to use on most <span class="hljs-string">&#x27;grids&#x27;</span>. You <span class="hljs-keyword">do</span> not need to submit Canu to the grid <span class="hljs-keyword">in</span> this <span class="hljs-keyword">case</span>. Canu will query the system <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;grid support&#x27;</span>, configure itself <span class="hljs-keyword">for</span> the machines <span class="hljs-string">&#x27;available in the grid&#x27;</span>, <span class="hljs-keyword">then</span> submit itself to the grid <span class="hljs-keyword">for</span> execution. You can <span class="hljs-keyword">then</span> monitor the run <span class="hljs-string">&#x27;using your grid&#x27;</span>.<br><br>Canu will <span class="hljs-string">&#x27;NOT request explicit time limits or queues/partitions&#x27;</span>. You can supply your own grid options, such as a partition on SLURM, an account code on SGE, and/or time limits with gridOptions=<span class="hljs-string">&quot;&lt;your options list&gt;&quot;</span> <span class="hljs-built_in">which</span> will passed to every job submitted by Canu. Similar options exist <span class="hljs-keyword">for</span> every stage of Canu, <span class="hljs-built_in">which</span> could be used to, <span class="hljs-keyword">for</span> example, restrict overlapping to a specific partition or queue.<br><br>ã€ã€ã€<span class="hljs-string">&#x27;To disable grid support and run only on the local machine, specify useGrid=false&#x27;</span>ã€‘ã€‘ã€‘<br><br>It is possible to <span class="hljs-built_in">limit</span> the number of grid <span class="hljs-built_in">jobs</span> running at the same time, but this isnâ€™t directly supported by Canu. The various gridOptions parameters can pass grid-specific parameters to the submit commands used; see Issue <span class="hljs-comment">#756 for Slurm and SGE examples.</span><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#common options:</span><br>useGrid=string<br>      - Run under grid control (<span class="hljs-literal">true</span>), <span class="hljs-string">&#x27;locally (false)&#x27;</span>, or <span class="hljs-built_in">set</span> up <span class="hljs-keyword">for</span> grid control<br>        but dont submit any <span class="hljs-built_in">jobs</span> (remote)<br></code></pre></td></tr></table></figure><h2 id="Advice"><a href="#Advice" class="headerlink" title="Advice"></a>Advice</h2><h3 id="åç»­åˆ†æè¦å»å†—ä½™"><a href="#åç»­åˆ†æè¦å»å†—ä½™" class="headerlink" title="åç»­åˆ†æè¦å»å†—ä½™"></a>åç»­åˆ†æè¦å»å†—ä½™</h3><p>Canu2.0ä¹‹å‰çš„contigå°½ç®¡è¿è¡Œæ—¥å¿—è¯´æ²¡æœ‰bubbleï¼Œå…¶å®æ˜¯æ²¡æœ‰æ£€æµ‹åˆ°ã€‚Canu2.0æ‰åŠ ä¸Šè¯¥ä¿¡æ¯ã€‚ä½†ä½œè€…å¼ºçƒˆæ¨èå…ˆç”¨purge_dupså»å†—ä½™ï¼Œé¿å…è½¯ä»¶éš¾ä»¥æ£€æµ‹åˆ°çš„å†—ä½™åºåˆ—å­˜åœ¨å½±å“åç»­åˆ†æã€‚</p><p>ä½œè€…ï¼šæ—§ç‰ˆCanuæ²¡æœ‰çœŸæ­£æ£€æµ‹åˆ°bubbleï¼Œå› æ­¤contigåŒ…å«ç€bubleï¼Œå»ºè®®åç»­åˆ†æç”¨purge_dups å¤„ç†è¿™äº›å†—ä½™åºåˆ—</p><p>Canuæ”¹åŠ¨åŸºæœ¬ä¸Šæ˜¯å¢åŠ æ–°åŠŸèƒ½ï¼Œæé«˜ç»„è£…å‡†ç¡®æ€§ï¼Œæé«˜ç»„è£…é€Ÿåº¦ï¼Œå¸¸è§„bugä¿®å¤ã€‚</p><p>1.8ç‰ˆæœ¬æ›´æ”¹äº†Nanoporeçš„é”™è¯¯ç‡ï¼Œæé«˜10å€å·¦å³ç»„è£…é€Ÿåº¦ï¼ŒåŒæ—¶å®Œæ•´æ”¯æŒäº†trio-binning</p><p>1.9ç‰ˆå¼€å§‹å¢åŠ PacBioçš„HiFiæ•°æ®ï¼Œæå¤§æé«˜ç›¸äº’æ¯”å¯¹é€Ÿåº¦</p><p>è¿™äº›ä¿®æ”¹ï¼Œå¯ä»¥ç›´æ¥å°†ç»„è£…å¾—åˆ°çš„contigç”¨äºåç»­åˆ†æ</p><p>è€Œ2.0åšäº†è®¸å¤šä¼˜åŒ–ç”¨æ¥ä¿è¯contigç»„è£…æ›´é•¿æ›´å‡†ç¡®ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯åœ¨contigæ„å»ºæœŸé—´ä¼šæ£€æµ‹bubbles, é˜²æ­¢ä»–ä»¬æ‰“æ–­æ‚åˆåŸºå› ç»„</p><p>ä¾‹å¦‚ç»„è£…å‘ç°æŸ“è‰²ä½“æ˜æ˜¾åå¤§ï¼Œç”¨æ–°Canuç»„è£…è¯¥ç‰©ç§æ—¶å€™å‘ç°ï¼Œå‰åä¸¤æ¬¡ç»„è£…ç»“æœåœ¨bubblesä¸€æ æœ‰æ˜æ˜¾å·®åˆ«ã€‚1.8ç‰ˆæœ¬æ˜¯0ï¼Œ2.0ç‰ˆæœ¬æ˜¯136ï¼Œçº¦6MåŸºå› ç»„å¤§å°ã€‚</p><p>æŸ¥çœ‹ä¹‹å‰æ‰€æœ‰ç»„è£…ç‰©ç§çš„æ—¥å¿—ï¼Œå‘ç°bubbleä¸€æ éƒ½æ˜¯0ï¼ˆå³ä¾¿æ˜¯æ‚åˆåŸºå› ç»„ï¼‰ã€‚</p><p>æ„å‘³ç€ï¼Œ2.0ç‰ˆæœ¬è£…çš„åŸºå› ç»„ä¸èƒ½ç›´æ¥ç”¨äºä¸‹æ¸¸çš„HiCï¼Œè€Œéœ€è¦å…ˆæŠŠbubbleè¿™éƒ¨åˆ†åºåˆ—ç»™è¿‡æ»¤æ‰ï¼Œä¸ç„¶åŸºå› ç»„åç¦»å®é™…å€¼ã€‚</p><h3 id="é«˜æ‚åˆç‰©ç§ç»„è£…"><a href="#é«˜æ‚åˆç‰©ç§ç»„è£…" class="headerlink" title="é«˜æ‚åˆç‰©ç§ç»„è£…"></a>é«˜æ‚åˆç‰©ç§ç»„è£…</h3><p>é«˜æ‚åˆç‰©ç§ç»„è£…ï¼ŒCanuå»ºè®®æ˜¯ç”¨ <code>batOptions=-dg 3 -db 3 -dr 1 -ca 500 -cp 50</code>å‚æ•°å°½é‡åˆ†å‡ºä¸¤å¥—å•å€å‹ï¼Œç„¶åå¯¹åŸºå› ç»„å»å†—ä½™ã€‚</p><p><code>batOptions</code>è¡¨ç¤ºä¼ é€’åç»­çš„å‚æ•°ç»™ç»„è£…è½¯ä»¶<code>bogart</code>, <code>-dg 3 -db3</code>é™ä½è‡ªåŠ¨ç¡®å®šé˜ˆå€¼æ—¶çš„é”™è¯¯ç‡ç¦»å·®(deviation)ï¼Œä»è€Œæ›´å¥½åˆ†å¼€å•å€å‹ã€‚<code>-dr 1 -ca 500 -cp 50</code>ä¼šå½±å“é”™è¯¯ç»„è£…çš„æ‹†åˆ†ï¼Œå¯¹äºä¸€ä¸ªæ¨¡æ£±ä¸¤å¯çš„contigï¼Œå¦‚æœå¦ä¸€æ¡å¯é€‰è·¯å¾„çš„overlapé•¿åº¦è‡³å°‘æ˜¯500bpï¼Œæˆ–å¦ä¸€æ¡å¯é€‰è·¯å¾„æ—¶åœ¨é•¿åº¦ä¸Šå’Œå½“å‰æœ€ä½³è·¯å¾„å­˜åœ¨50%çš„å·®å¼‚ï¼Œé‚£ä¹ˆå°†contigæ‹†åˆ†ã€‚</p><p>å…³äºæ‚åˆç‰©ç§ç»„è£…çš„è®¨è®ºï¼Œå‚è€ƒ<a href="https://links.jianshu.com/go?to=https://github.com/marbl/canu/issues/201%23issuecomment-233750764">https://github.com/marbl/canu/issues/201#issuecomment-233750764</a></p><h3 id="è´­ä¹°SSDé¿å…æœåŠ¡å™¨IOç“¶é¢ˆ"><a href="#è´­ä¹°SSDé¿å…æœåŠ¡å™¨IOç“¶é¢ˆ" class="headerlink" title="è´­ä¹°SSDé¿å…æœåŠ¡å™¨IOç“¶é¢ˆ"></a>è´­ä¹°SSDé¿å…æœåŠ¡å™¨IOç“¶é¢ˆ</h3><p>å¦‚æœæœåŠ¡å™¨çº¿ç¨‹æ•°å¾ˆå¤šï¼Œåœ¨æ™®é€šæœºæ¢°ç¡¬ç›˜ä¸Šç»„è£…ï¼Œè€Œä¸”ç³»ç»Ÿè¿˜æ˜¯CentOSï¼Œé‚£ä¹ˆéœ€è¦è°ƒæ•´ä¸€ä¸ªå‚æ•°ï¼Œé¿å…å…¶ä¸­ä¸€æ­¥çš„IOä¸¥é‡å½±å“æœåŠ¡å™¨æ€§èƒ½ã€‚</p><p>Canué€šè¿‡ä¸¤ä¸ªç­–ç•¥è¿›è¡Œå¹¶è¡Œï¼Œbucketizing (â€˜ovbâ€™ ä»»åŠ¡) å’Œ sorting (â€˜ovsâ€™ ä»»åŠ¡)ã€‚ bucketizingä¼šä»1-overlapè¯»å–è¾“å‡ºçš„overlapï¼Œå°†ä»–ä»¬<strong>å¤åˆ¶</strong>ä¸€ä»½ä½œä¸ºä¸­é—´æ–‡ä»¶ã€‚sortingä¸€æ­¥å°†è¿™äº›æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­è¿›è¡Œæ’åºç„¶å<strong>å†™å‡º</strong>åˆ°ç¡¬ç›˜ä¸Šã€‚ å¦‚æœä½ çš„overlapè¾“å‡ºç‰¹åˆ«å¤šï¼Œé‚£ä¹ˆè¯¥æ­¥éª¤å°†ä¼šç¬é—´æŒ¤çˆ†çš„ä½ çš„IO.</p><p>ä¸ºäº†é¿å…æ‚²å‰§å‘ç”Ÿï¼Œè¯·å¢åŠ å¦‚ä¸‹å‚æ•°: <code>ovsMemory=16G ovbConcurrency=15 ovsConcurrency=15</code>ï¼Œ ä¹Ÿå°±æ˜¯é™ä½è¿™ä¸¤æ­¥åŒæ—¶æŠ•é€’çš„ä»»åŠ¡æ•°ï¼Œç¼“è§£IOå‹åŠ›ã€‚</p><hr><h1 id="HiFIç»„è£…å®ä¾‹"><a href="#HiFIç»„è£…å®ä¾‹" class="headerlink" title="HiFIç»„è£…å®ä¾‹"></a>HiFIç»„è£…å®ä¾‹</h1><p>Contiguity, Completeness, and Correctness</p><h2 id="2018-10"><a href="#2018-10" class="headerlink" title="2018.10"></a>2018.10</h2><p>PacBioå…¬å¸ é«˜ä¿çœŸ å•åˆ†å­ é•¿è¯»é•¿ æµ‹åºã€HiFiã€‘æ¨¡å¼</p><h2 id="2019-01"><a href="#2019-01" class="headerlink" title="2019.01"></a>2019.01</h2><p>é¦–ç¯‡åˆ©ç”¨HiFiæ•°æ®è¿›è¡ŒäººåŸºå› ç»„ ç»“æ„å˜å¼‚æ£€æµ‹ å’Œ åŸºå› ç»„ç»„è£… æ–‡ç« å‘å¸ƒ</p><h2 id="2020-01"><a href="#2020-01" class="headerlink" title="2020.01"></a>2020.01</h2><p>HiFiåœ¨ å››å€ä½“ç«ç‘° ç‡•éº¦ å¤§éº» ç™½è›‰ ç­‰å¤šä¸ªç‰©ç§åŸºå› ç»„ç»„è£…</p><h2 id="2020-03-27Gbå…­å€ä½“åŠ å·çº¢æ‰"><a href="#2020-03-27Gbå…­å€ä½“åŠ å·çº¢æ‰" class="headerlink" title="2020.03 27Gbå…­å€ä½“åŠ å·çº¢æ‰"></a>2020.03 27Gbå…­å€ä½“åŠ å·çº¢æ‰</h2><p><a href="https://mp.weixin.qq.com/s?__biz=MzkxMjIzNzY3Mw==&mid=2247489444&idx=2&sn=e6e9e4eebac756a0d518ee4a0fa09956&source=41#wechat_redirect">PacBioç§‘å­¦å®¶åˆ©ç”¨HiFiæµ‹åºä¸¤å‘¨å†…å®ŒæˆåŸºå› ç»„é«˜è¾¾27Gbçš„å…­å€ä½“åŠ å·çº¢æ‰åŸºå› ç»„ç»„è£…</a></p><h3 id="åˆè¡·"><a href="#åˆè¡·" class="headerlink" title="åˆè¡·"></a>åˆè¡·</h3><p><font color="blue">15Gbå…­å€ä½“å°éº¦</font>åŸºå› ç»„ï¼Œé€‰æ‹©<font color="blue">HiFiè¿˜æ˜¯CLRï¼Ÿ</font><font color="blue">11Gbç‡•éº¦</font>åŸºå› ç»„ç»„è£…è¯´æ˜<font color="blue">HiFiç»„è£…<strong>è¶…å¤§åŸºå› ç»„</strong>çš„èƒ½åŠ›</font>ï¼Œ<strong>Contig N50</strong>é«˜è¾¾<strong>20Mb</strong>ï¼HiFi Reads <font color="blue"><strong>è¯»å–é•¿åº¦</strong></font> å’Œ <font color="blue"><strong>å‡†ç¡®æ€§</strong></font> ä¹‹é—´çš„ <font color="blue"><strong>å¹³è¡¡</strong></font> æ˜¯å¦èƒ½å…‹æœæœ€è‰°å·¨çš„åŸºå› ç»„ï¼ˆå¤§ä¸”å¤æ‚ï¼‰æŒ‘æˆ˜ï¼Ÿ</p><h3 id="æµ‹åºè¿‡ç¨‹"><a href="#æµ‹åºè¿‡ç¨‹" class="headerlink" title="æµ‹åºè¿‡ç¨‹"></a>æµ‹åºè¿‡ç¨‹</h3><p>æ–¯å¦ç¦å¤§å­¦æ ¡å›­å†…é‡‡æ ·ï¼ŒDNAæå–æ–‡åº“æ„å»ºã€‚</p><p>ä½¿ç”¨<font color="blue">BluePippin[é«˜åˆ†å­é‡DNAæ ¸é…¸ç‰‡æ®µåˆ†ç¦»å’Œå›æ”¶]</font>å°†DNAç‰‡æ®µé€‰æ‹©å¤§å°è®¾ä¸º<strong>15 kb</strong>ï¼Œæ›´é•¿çš„æ’å…¥ç‰‡æ®µå…è®¸HiFiè¯»é•¿è¾¾åˆ°<strong>50 kb</strong>ã€‚ HiFi reads çš„å‡†ç¡®ç‡åˆ†å¸ƒå¯ä»¥å‘ç°æ‰€æœ‰readså‡†ç¡®ç‡<strong>éƒ½åœ¨Q20ä»¥ä¸Š</strong>ï¼ŒHiFi reads<strong>æœ€å¯†é›†</strong>çš„æ’å…¥ç‰‡æ®µåœ¨<strong>20k-30kåŒºé—´</strong>ï¼Œæœ€é•¿çš„æ’å…¥ç‰‡æ®µè¾¾åˆ°<strong>50kç²¾åº¦éƒ½é«˜äºQ20</strong>(99ï¼…)ï¼Œå¤§çº¦æœ‰<strong>è¶…è¿‡ä¸€åŠçš„reads</strong>å‡†ç¡®ç‡æ¥è¿‘æˆ–è¶…è¿‡<strong>Q30</strong>(99.9%)ã€‚</p><p><strong>7å¤©è¿ç»­æµ‹åº</strong>å…±è·å¾—<strong>606Gb</strong> HiFiæ•°æ®ï¼Œç›¸å½“äº<strong>22X</strong>ã€‚åœ¨ä¹‹å‰å¾ˆå¤šä½¿ç”¨HiFiè¿›è¡Œç»„è£…çš„é¡¹ç›®ä¸­å‘ç°ï¼Œåªéœ€<strong>20å€</strong>å·¦å³çš„è¦†ç›–åº¦å°±èƒ½å¤Ÿäº§ç”Ÿ<strong>å‡ºè‰²</strong>çš„ç»„è£…ç»“æœï¼Œä¸”<strong>ä¸éœ€è¦NGSçº é”™</strong>ã€‚</p><h3 id="ç»„è£…ç»“æœ"><a href="#ç»„è£…ç»“æœ" class="headerlink" title="ç»„è£…ç»“æœ"></a>ç»„è£…ç»“æœ</h3><p>åœ¨è·å¾—HiFiæ•°æ®ä¹‹åï¼ŒPacBioè´Ÿè´£<strong>è¶…å¤§åŸºå› ç»„ç»„è£…</strong>çš„èµ„æ·±ç”Ÿä¿¡ç§‘å­¦å®¶<strong>Greg Concepcion</strong>å¼€å§‹äº†åŠ å·çº¢æ‰åŸºå› ç»„çš„ç»„è£…å·¥ä½œã€‚Gregé€‰æ‹©çš„å·¥å…·æ˜¯<font color="red">Hifiasm</font>ï¼Œå› ä¸ºè¿™æ˜¯ç›®å‰<font color="blue"><strong>æœ€å¿«</strong>çš„ä¸”<strong>ä¸“æ³¨äºè§£æå•å€å‹</strong>çš„ç»„è£…è½¯ä»¶</font>ã€‚</p><p>Hifiasmè½¯ä»¶è¿è¡Œ<font color="red">6å¤©</font>åï¼Œç»„è£…å·¥ä½œé¡ºåˆ©å®Œæˆã€‚å…·ä½“æ¶ˆè€—è®¡ç®—èµ„æºå¦‚ä¸‹ï¼›</p><p>æœåŠ¡å™¨é…ç½®ï¼š64æ ¸512Gb RAM</p><p>ç”ŸæˆHiFiæ•°æ®ï¼š46,000 CPU hours</p><p>åŸºå› ç»„ç»„è£…ï¼š7,200 CPU hoursï¼Œæ€»å…±åˆ†ææ—¶é—´6å¤©</p><p>å¯¹æ¯”2019å¹´Oxford Nanopore + NGSåŒæ ·ç»„è£…åŠ å·çº¢æ‰ï¼Œä½¿ç”¨2Tbå†…å­˜,æœ€ç»ˆèŠ±è´¹5-6ä¸ªæœˆæ‰å®Œæˆç»„è£…ã€‚</p><p>Sequencing and assembling mega-genomes of mega-trees: the giant sequoia and coast redwood genomesï¼Œ<strong>Nanopore Community Meeting 2019</strong>ã€æœ€å¤§å†…å­˜ä½¿ç”¨ï¼š2Tï¼›error correctionï¼š330ï¼Œ000CPU hoursï¼›Assembly post-error-correctionï¼š700ï¼Œ000CPU hoursï¼›wall clock timeï¼š5-6monthã€‘</p><p>è·å¾—çš„ç»“æœæƒŠäººï¼Œç»“æœå‡ ä¹æ˜¯<font color="blue">é¢„æœŸåŸºå› å¤§å°<strong>ä¸¤å€</strong></font>ï¼Œè€Œ<font color="blue">Contig N50</font>è¾¾åˆ°<font color="blue"><strong>1.92Mb</strong></font> ï¼ç›¸å¯¹2019å¹´Oxford Nanopore + NGSç»„è£…<font color="blue"><strong>æå‡18å€</strong></font>ã€‚å¤§äºé¢„æœŸåŸºå› ç»„å¤§å°çš„ç»„è£…ä¸­ï¼Œå¤§éƒ¨åˆ†å¯æ˜¯<font color="blue"><strong>ä¸¤ä¸ªç±»ä¼¼çš„å•å€å‹</strong></font>ï¼Œè€Œ<font color="red"><strong>å¹¶éå®Œå…¨ä¸åŒçš„å…­å€ä½“</strong></font>ï¼Œè¿™ä¸æœ€è¿‘Scottå‘è¡¨çš„çº¢æ‰ç›¸å…³ç ”ç©¶ç±»ä¼¼ï¼Œå°è¯äº†åŠ å·çº¢æ‰çš„å¤šå€ä½“åŒ–æ˜¯<font color="red"><strong>è‡ªå¤šå€ä½“äº‹ä»¶</strong></font>ã€‚</p><p><img src="/GeekFocus/2022-03-02-HiFi-3-software/8.png"><br><img src="/GeekFocus/img/2022-03-02-HiFi-3-software/8.png"></p><p><font color="blue">åŠ å·çº¢æ‰ç»„è£…ç»“æœä¸­<strong>BUSCOè¯„åˆ†åªæœ‰59%??</strong> </font>ä¸æ˜¯ä¸€èˆ¬<strong>è¾ƒå¥½</strong>çš„ç»„è£…ç»“æœBUSCOå€¼éƒ½è¦é«˜è¾¾<font color="blue"><strong>90%ä»¥ä¸Šå—ï¼Ÿ</strong></font>å› ä¸º<font color="blue">è£¸å­æ¤ç‰©ï¼ˆåŠ å·çº¢æ‰å±äºè£¸å­æ¤ç‰©ï¼‰çš„BUSCOåŸºå› é›†ä¸è¢«å­æ¤ç‰©çš„<strong>BUSCOåŸºå› é›†ç›¸å·®å¾ˆ</strong>å¤š</font>ã€‚æ„å‘³ç€é’ˆå¯¹åŠ å·çº¢æ‰ä½¿ç”¨<font color="red"><strong>é€šç”¨BUSCOåŸºå› é›†</strong></font>æ¥<font color="red"><strong>è¯„ä¼°</strong>åŸºå› ç»„å®Œæ•´æ€§<strong>ä¸å‡†ç¡®</strong></font>ï¼Œåªæ˜¯<strong>ç›®å‰æ²¡æœ‰</strong>å…¶å®ƒ<strong>æ›´å¥½</strong>è¯„ä¼°æ–¹æ³•ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ä»åŠ å·çº¢æ‰åŸºå› ç»„ç ”ç©¶ä¸­å¾—åˆ°ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>é¦–å…ˆï¼Œå¯¹PacBio SMRTæµ‹åºå……æ»¡ä¿¡å¿ƒï¼Œå»ºè®®ä½¿ç”¨HiFiæ•°æ®ä»ä»»ä½•ç”Ÿç‰©ä½“ç”Ÿæˆé«˜è´¨é‡çš„åŸºå› ç»„æ•°æ®ã€‚ </p><p>å…¶æ¬¡ï¼Œå®ƒå°†å½»åº•æ”¹å˜å¯¹<strong>å¤§å‹ï¼Œå¤æ‚</strong>çš„åŸºå› ç»„è£…é…çš„è®¤çŸ¥ã€‚ä¹‹å‰ç»éªŒæ˜¯<strong>è¶…å¤§å‹å¤æ‚åŸºå› ç»„</strong>ç»„è£…éœ€è¦èŠ±è´¹<strong>å¤§é‡æ—¶é—´</strong>å’Œç”Ÿä¿¡<strong>è®¡ç®—èµ„æº</strong>ï¼Œè¿˜ä¸åŒ…æ‹¬æµ‹åºæ—¶é—´ã€‚è€ŒåŠ å·çº¢æ‰åºå¤§åŸºå› ç»„åœ¨çŸ­çŸ­17å¤©å†…å°±å¯å®Œæˆï¼ˆåŒ…æ‹¬4å¤©æ ·å“å‡†å¤‡å’Œå»ºåº“ï¼Œ7å¤©æµ‹åºå’Œ6å¤©ç»„è£…ï¼‰ã€‚ </p><p><strong>é€šè¿‡PacBio HiFiæ•°æ®ï¼Œå¯ä»¥å¯¹<font color="blue">ä»»ä½•ç”Ÿç‰©</font>è¿›è¡Œ<font color="blue">é«˜è´¨é‡</font>çš„åŸºå› ç»„æµ‹åºã€‚</strong></p><h2 id="2020-05"><a href="#2020-05" class="headerlink" title="2020.05"></a>2020.05</h2><p>HiFiåŠ©åŠ›åŒæºå››å€ä½“ç´«èŠ±è‹œè“¿åŸºå› ç»„ç»„è£…ï¼ŒNCå‘è¡¨</p><p>Allele-aware chromosome-level genome assembly and efficient transgene-free genome editing for the autotetraploid cultivated alfalfa</p><p>ï¼ˆ1ï¼‰ä½¿ç”¨Canué»˜è®¤å‚æ•°ï¼Œåˆ©ç”¨CCS clean readsç»„è£…contigsã€‚ç»„è£…å¾—åˆ°çš„Contig N50å€¼ä¸º459kbï¼Œæ€»é•¿åº¦ä¸º3.15GBã€‚</p><p>ï¼ˆ2ï¼‰ä½¿ç”¨HiC-Proå°†Hi-C readsä¸contigs è¿›è¡Œæ¯”å¯¹ï¼Œäº§ç”Ÿæ¯”å¯¹BAMæ–‡ä»¶ã€‚</p><p>ï¼ˆ3ï¼‰ä½¿ç”¨æ³¨é‡Šçš„è’ºè—œè‹œè“¿è›‹ç™½ä½œä¸ºå‚è€ƒï¼Œå®Œå…¨åŸºäºåŒæºçš„ç­–ç•¥æ³¨é‡Šcontigsã€‚å¯¹138,729ä¸ªåŒæºåŸºå› è¿›è¡Œäº†ç»“æ„æ³¨é‡Šã€‚ç”¨MCscanç”¨äºé‰´å®šcontigså’Œå‚è€ƒåŸºå› ç»„ä¹‹é—´çš„å…±çº¿æ€§ã€‚æ˜¾ç¤ºç´«èŠ±è‹œè“¿å’Œè’ºè—œè‹œè“¿ä¹‹é—´çš„é«˜å…±çº¿æ€§ã€‚ã€ä¸‹è½½çˆ¶æ¯æœ¬petunia refã€‘</p><p>ï¼ˆ4ï¼‰ä½¿ç”¨å†…éƒ¨è„šæœ¬å¤„ç†BAMæ–‡ä»¶ï¼Œå»é™¤ç­‰ä½åŸºå› contigsä¹‹é—´çš„linksã€‚ä½¿ç”¨ALLHiCè½¯ä»¶ï¼Œæå–ã€èšç±»å’Œé‡æ’Contigs (Contigs syntenicä¸è’ºè—œè‹œè“¿æŸ“è‰²ä½“ä¸€è‡´)ï¼Œå¾—åˆ°åŸå§‹çš„scaffoldsã€‚</p><p>ï¼ˆ5ï¼‰Juiceboxç”¨äºä»¥å›¾å½¢å’Œäº¤äº’æ–¹å¼å¾®è°ƒç»„è£…çš„scaffoldsã€‚å‰ªè£äº†40ä¸ªæ€»é•¿åº¦è¾¾1800Mbçš„scaffolds ã€‚</p><p>ï¼ˆ6ï¼‰ åŸºäºç»„è£…çš„scaffoldï¼Œé€šè¿‡Hi-Cæ•°æ®ï¼Œæ¯ä¸ªunplaced contigè¢«åˆ†é…åˆ°äº’ä½œæœ€å¼ºçš„é‚£äº›contig clusteré‡Œã€‚</p><p>ï¼ˆ7ï¼‰ä½¿ç”¨ALLHiCå¯¹é‚£äº›contig clusterså†æ¬¡è¿›è¡Œé‡æ’å’Œæ„å»ºscaffoldã€‚</p><p>ï¼ˆ8ï¼‰ä½¿ç”¨Juiceboxå¯¹scaffoldsè¿›è¡Œå¾®è°ƒï¼Œå¹¶ä»scaffoldsä¸Šå»é™¤ä¸ä¸€è‡´çš„contigsï¼Œäº§ç”Ÿæœ€ç»ˆçš„æŸ“è‰²ä½“åŸºå› ç»„ï¼Œå…¶åŒ…å«32æ¡æŸ“è‰²ä½“(8ä¸ªåŒæºç»„ï¼Œæ¯ä¸ªç»„ä¸­æœ‰4ä¸ªç­‰ä½åŸºå› æŸ“è‰²ä½“)ï¼Œæ€»é•¿åº¦ä¸º2738Mbï¼Œå’Œ419MbæœªæŒ‚è½½åˆ°æŸ“è‰²ä½“æ°´å¹³çš„åºåˆ—ã€‚</p><h2 id="2020-07"><a href="#2020-07" class="headerlink" title="2020.07"></a>2020.07</h2><p>åŠ å·å¤§å­¦HiFiç»„è£…äººå®Œæ•´XæŸ“è‰²ä½“ï¼ŒNature</p><p>Miga Karen H,Koren Sergey,Rhie Arang et al. Telomere-to-telomere assembly of a complete human X chromosome.[J] .Nature, 2020.</p><h1 id="HiFiä¸ä¸åŒç±»å‹åŸºå› ç»„ç»„è£…"><a href="#HiFiä¸ä¸åŒç±»å‹åŸºå› ç»„ç»„è£…" class="headerlink" title="HiFiä¸ä¸åŒç±»å‹åŸºå› ç»„ç»„è£…"></a><a href="https://www.jianshu.com/p/4d42719d8b01">HiFiä¸ä¸åŒç±»å‹åŸºå› ç»„ç»„è£…</a></h1><h2 id="é«˜é‡å¤åŸºå› ç»„â€”ç‰ç±³"><a href="#é«˜é‡å¤åŸºå› ç»„â€”ç‰ç±³" class="headerlink" title="é«˜é‡å¤åŸºå› ç»„â€”ç‰ç±³"></a><strong>é«˜é‡å¤åŸºå› ç»„â€”ç‰ç±³</strong></h2><p>ç‰ç±³ï¼ˆ<em>Z.mays</em>ï¼‰æ˜¯ä¸–ç•Œä¸Šäº§é‡æœ€é«˜ç§æ¤æœ€å¹¿çš„ä½œç‰©ï¼Œä¹Ÿæ˜¯é—ä¼ å­¦å’ŒåŸºå› ç»„å­¦çš„åŸºç¡€modelã€‚ç‰ç±³åŸºå› ç»„ç»å†<font color="blue"><strong>å…¨åŸºå› ç»„å¤åˆ¶äº‹ä»¶</strong></font>å’Œ<font color="blue"><strong>é•¿æœ«ç«¯é‡å¤è½¬åº§å­æ‰©å¢</strong></font>å¯¼è‡´åŸºå› ç»„<strong>æ€¥å‰§æ‰©å¤§</strong>ï¼ˆ<font color="red">2.3Gb</font>ï¼‰ã€‚æœ€ç»ˆå¯¼è‡´ç‰ç±³åŸºå› ç»„ä¸­<font color="red"><strong>è½¬åº§å­å æ¯”é«˜è¾¾85%</strong></font>ã€‚</p><p>åˆ©ç”¨<strong>HiFi</strong>ç»„è£…çš„<font color="blue"><strong>ç‰ç±³B73</strong></font>åŸºå› ç»„å¤§å°ä¸º<font color="blue"><strong>2.164 Gb</strong></font>ï¼Œ<strong>ç•¥å¤§äº</strong>2017å¹´å‘è¡¨çš„åˆ©ç”¨PacBio <font color="blue">CLR</font>çš„ç»„è£…ç‰ˆæœ¬ï¼ˆ<font color="blue">2.104 Gb</font>ï¼‰ã€‚åœ¨è¿ç»­æ€§æ–¹é¢ï¼ŒHiFiç»„è£…<font color="blue"><strong>Contig N50åˆ™è¾¾åˆ°28.2 Mb</strong></font>ï¼Œæå‡è¿‘<font color="red"><strong>23å€</strong></font>ï¼Œç”šè‡³<strong>è¶…è¿‡</strong>æœ€è¿‘å‘è¡¨çš„<strong>NC358</strong>åŸºå› ç»„ã€‚<font color="red"><strong>BUSCOè¯„ä¼°è¡¨æ˜</strong></font>ï¼ŒHiFiç»„è£…ç‰ˆæœ¬çš„ç»„è£…è´¨é‡ä¹Ÿ<font color="red"><strong>é«˜äºæ‰€æœ‰</strong></font>å·²å‘è¡¨çš„<strong>ç‰ç±³åŸºå› ç»„ç‰ˆæœ¬</strong>ã€‚åœ¨æ—¶é—´å’Œèµ„æºæ¶ˆè€—ä¸Šï¼Œæœ€è¿‘å‘è¡¨çš„<strong>75Ã— CLRæ•°æ®</strong>ç»„è£…NC358åŸºå› ç»„èŠ±è´¹äº†<strong>11,520 CPU hours</strong>ï¼Œè€ŒHiFiæ•°æ®ç»„è£…ä»…åœ¨6å°æ—¶å®Œæˆï¼Œä»…èŠ±è´¹360 CPU hoursï¼Œ<font color="red"><strong>èµ„æºæ¶ˆè€—èŠ‚çœäº†31å€</strong></font>ã€‚ä½“ç°äº†HiFiåœ¨<font color="blue">é«˜é‡å¤åŸºå› ç»„ç»„è£…</font>çš„æ˜æ˜¾<font color="blue">ä¼˜åŠ¿</font>ã€‚</p><p><img src="/GeekFocus/2022-03-02-HiFi-3-software/10.png" alt="img"><br><img src="/GeekFocus/img/2022-03-02-HiFi-3-software/10.png" alt="img"></p><p>HiFi ç»„è£… <strong>ç‰ç±³B73</strong> åŸºå› ç»„ç»“æœ</p><h2 id="å¤§å‹å¤æ‚åŸºå› ç»„â€”é»„è…¿å±±è›™"><a href="#å¤§å‹å¤æ‚åŸºå› ç»„â€”é»„è…¿å±±è›™" class="headerlink" title="å¤§å‹å¤æ‚åŸºå› ç»„â€”é»„è…¿å±±è›™"></a><strong>å¤§å‹å¤æ‚åŸºå› ç»„â€”é»„è…¿å±±è›™</strong></h2><p>é»„è…¿å±±è›™ï¼ˆ<em>R. muscosa</em>ï¼‰æ˜¯ä¸€ç§ä¸¤æ –åŠ¨ç‰©ã€‚<font color="blue"><strong>ä¸¤æ –åŠ¨ç‰©</strong>æ˜¯<strong>è„Šæ¤åŠ¨ç‰©</strong>ä¸­<strong>åŸºå› ç»„å¤§å°å˜åŒ–æœ€å¤§</strong>çš„ä¸€ç±»</font>ï¼Œå·²å®ŒæˆåŸºå› ç»„æµ‹åºçš„<strong>ç¾è¥¿é’å£èˆ</strong>é«˜è¾¾<strong>32 Gb</strong>ã€‚è›™ç§‘ç‰©ç§ä¸­ï¼Œæœ€å¤§åŸºå› ç»„è¾¾10 Gbä»¥ä¸Šï¼Œé»„è…¿å±±è›™çš„åŸºå› ç»„<strong>é¢„è®¡9 Gb</strong>å·¦å³ã€‚</p><p>åˆ©ç”¨HiFiæ•°æ®ç»„è£…çš„é»„è…¿å±±è›™åŸºå› ç»„è·å¾—<font color="blue">ä¸¤å¥—å•å€å‹åŸºå› ç»„</font>ï¼Œå•å€å‹åŸºå› ç»„å¤§å°åˆ†åˆ«ä¸º<font color="blue">9.03Gå’Œ5.23 Gb</font>ï¼Œ<font color="red"><strong>ä¸»è¦å•å€å‹åŸºå› ç»„</strong></font>å¤§å°<strong>æ¥è¿‘é¢„ä¼°</strong>åŸºå› ç»„å¤§å°ã€‚<font color="red"><strong>ä¸»è¦å•å€å‹åŸºå› ç»„</strong>Contig <strong>N50è¾¾2.8 M</strong>ï¼Œ<strong>è¿œé«˜äº</strong>å·²å‘è¡¨çš„è›™ç§‘ç‰©ç§åŸºå› ç»„</font>ã€‚HiFi ç»„è£…çš„<font color="blue"><strong>é»„è…¿å±±è›™</strong>åŸºå› ç»„çš„<strong>BUSCOè¯„ä¼°ç»“æœ</strong>ä¹Ÿ<strong>æ˜æ˜¾é«˜äº</strong>å¦å¤–ä¸¤ä¸ªç‰©ç§çš„åŸºå› ç»„</font>ã€‚æ­¤å¤–ï¼Œè™½ç„¶é»„è…¿å±±è›™çš„åŸºå› ç»„é«˜è¾¾9 Gbï¼Œåˆ©ç”¨HiFi ç»„è£…ä¹Ÿä»…èŠ±è´¹<strong>12å°æ—¶</strong>ã€‚ä¸Šè¿°è¡¨æ˜ï¼ŒHiFiå¿«é€Ÿç»„è£…<font color="blue">é«˜è´¨é‡å¤§å‹åŸºå› ç»„</font>å‡ºè‰²ã€‚</p><p><img src="/GeekFocus/2022-03-02-HiFi-3-software/11.png" alt="img"><br><img src="/GeekFocus/img/2022-03-02-HiFi-3-software/11.png" alt="img"></p><p>HiFiç»„è£… <strong>é»„è…¿å±±è›™</strong> åŸºå› ç»„ç»“æœ</p><h2 id="å¼‚æºå¤šå€ä½“åŸºå› ç»„â€”è‰è“"><a href="#å¼‚æºå¤šå€ä½“åŸºå› ç»„â€”è‰è“" class="headerlink" title="å¼‚æºå¤šå€ä½“åŸºå› ç»„â€”è‰è“"></a><strong>å¼‚æºå¤šå€ä½“åŸºå› ç»„â€”è‰è“</strong></h2><p>æ ½åŸ¹è‰è“ï¼ˆ<em>F. x ananassa</em>ï¼‰æ˜¯ä¸€ä¸ª<font color="blue"><strong>å¼‚æº</strong>å…«å€ä½“ç‰©ç§ï¼ˆ2n&#x3D;8x&#x3D;56ï¼‰</font>ï¼Œç”±ä¸¤ç§<font color="blue">é‡ç”Ÿå…«å€ä½“ç‰©ç§å¤©ç„¶æ‚äº¤</font>äº§ç”Ÿï¼Œè¿™<font color="blue"><strong>ä¸¤ç§é‡ç”Ÿå…«å€ä½“</strong>éƒ½æ˜¯<strong>100å¤šä¸‡å¹´</strong>å‰<strong>å››ç§äºŒå€ä½“ç¥–å…ˆç‰©ç§åˆå¹¶</strong>çš„äº§ç‰©</font>ã€‚</p><p>åˆ©ç”¨HiFiæ•°æ®ç»„è£…çš„å…«å€ä½“è‰è“åŸºå› ç»„è·å¾—äº†<font color="blue">ä¸¤å¥—å•å€å‹åŸºå› ç»„</font>ï¼Œå¤§å°åˆ†åˆ«ä¸º<font color="blue">776Må’Œ304 M</font>ï¼Œ<font color="red"><strong>ä¸»è¦å•å€å‹åŸºå› ç»„</strong></font>çš„å¤§å°ä¸<strong>2019å¹´</strong>æœ€æ–°<strong>å‘è¡¨</strong>çš„<strong>æ ½åŸ¹è‰è“åŸºå› ç»„ç›¸å½“</strong>ï¼Œä½†<font color="blue">Contig N50è¾¾<strong>15.5 Mb</strong>ï¼Œæå‡<strong>193å€</strong></font>ã€‚æ­¤å¤–ï¼Œæ•´ä¸ªåŸºå› ç»„ç»„è£…ä»…èŠ±è´¹<strong>3å°æ—¶</strong>ã€‚ä¸Šè¿°ç»“æœä½“ç°HiFiæµ‹åºåœ¨<font color="blue">å¤šå€ä½“åŸºå› ç»„ç»„è£…ä¸­çš„è‰¯å¥½è¡¨ç°</font>ã€‚</p><p><img src="/GeekFocus/2022-03-02-HiFi-3-software/12.png" alt="img"><br><img src="/GeekFocus/img/2022-03-02-HiFi-3-software/12.png" alt="img"></p><p>HiFi æ•°æ®ç»„è£… <strong>å…«å€ä½“è‰è“</strong> åŸºå› ç»„ç»“æœ</p><h2 id="åŒæºå¤šå€ä½“åŸºå› ç»„â€”è‹œè“¿-âˆš"><a href="#åŒæºå¤šå€ä½“åŸºå› ç»„â€”è‹œè“¿-âˆš" class="headerlink" title="åŒæºå¤šå€ä½“åŸºå› ç»„â€”è‹œè“¿ âˆš"></a><strong>åŒæºå¤šå€ä½“åŸºå› ç»„â€”è‹œ</strong>è“¿ âˆš</h2><p>æ ½åŸ¹ç´«èŠ±è‹œè“¿ï¼ˆ<em>M. sativa</em>ï¼‰æ˜¯ä¸€ç§<font color="blue">è‡ªäº¤ä¸äº²å’Œçš„<strong>åŒæº</strong>å››å€ä½“ï¼ˆ2n&#x3D;4Ã—&#x3D;32ï¼‰</font>æ¤ç‰©ã€‚5æœˆæ˜†æ˜åŠ¨ç‰©ç ”ç©¶æ‰€ç­‰å•ä½åˆ©ç”¨HiFiæµ‹åºï¼ˆçº¦23Ã—ï¼‰å®ç°æ ½åŸ¹ç´«èŠ±è‹œè“¿çš„åŸºå› ç»„ç»„è£… <a href="https://pubmed.ncbi.nlm.nih.gov/32427850/">paper</a>ã€‚</p><p>åˆ©ç”¨ä¸“é—¨é’ˆå¯¹HiFiæ•°æ®å¼€å‘çš„ç»„è£…è½¯ä»¶<font color="red"><strong>HiCanuå’ŒHifiasm</strong></font>é‡æ–°å¯¹è¯¥åŸºå› ç»„è¿›è¡Œç»„è£…ã€‚<font color="blue">HiCanuç»„è£…ç‰ˆæœ¬</font>åŸºå› ç»„å¤§å°ä¸º<font color="blue">2.66 G</font>ï¼Œ<strong>ç•¥ä½</strong>äº<font color="blue">Canuç‰ˆæœ¬</font>ï¼›<font color="blue"><strong>Hifiasmç»„è£…ç‰ˆæœ¬</strong></font>çš„åŸºå› ç»„å¤§å°ï¼ˆ<font color="blue">3.22 G</font>ï¼‰åˆ™ç•¥é«˜äºCanuç‰ˆæœ¬ã€‚<font color="red"><strong>HiCanu</strong>å’Œ<strong>Hifiasm</strong>çš„ç»„è£…çš„<strong>Contig N50</strong>åˆ†åˆ«ä¸º<strong>1.67</strong>å’Œ<strong>1.73</strong> Mbï¼Œ<strong>æ˜æ˜¾é«˜äºCanu</strong>ç‰ˆæœ¬</font>ã€‚æµ‹è¯•ç»“æœåŠå·²å‘è¡¨çš„è‹œè“¿åŸºå› ç»„å‡è¡¨æ˜ï¼ŒHiFièƒ½å¤Ÿå®ç°<font color="blue">åŒæºå¤šå€ä½“åŸºå› ç»„çš„é«˜è´¨é‡ç»„è£…</font>ã€‚</p><p><img src="/GeekFocus/2022-03-02-HiFi-3-software/14.png"><br><img src="/GeekFocus/img/2022-03-02-HiFi-3-software/14.png" alt="åŒæºå››å€ä½“è‹œè“¿åŸºå› ç»„ç»„è£…ç»“æœæ¯”è¾ƒ"></p><h2 id="å•å€å‹åŸºå› ç»„-äºº"><a href="#å•å€å‹åŸºå› ç»„-äºº" class="headerlink" title="å•å€å‹åŸºå› ç»„   äºº"></a><strong>å•å€å‹åŸºå› ç»„   äºº</strong></h2><p>ç›®å‰å·²å‘è¡¨å¤šä¸ªé«˜è´¨é‡äººåŸºå› ç»„åºåˆ—ï¼Œä¸”å·²æœ‰å¤šä¸ªåˆ©ç”¨HiFiç»„è£…äººåŸºå› ç»„çš„æ¡ˆä¾‹ï¼Œåˆ©ç”¨HiFiç»„è£…å‡º<strong>äººä¸¤å¥—å•å€å‹åŸºå› ç»„</strong>ä¹Ÿå·²ç»è¢«æŠ¥é“ã€‚</p><p>åˆ©ç”¨HiFi å¯¹äººåŸºå› ç»„ç»„è£…ï¼Œè·å¾—ä¸¤å¥—å•å€å‹åŸºå› ç»„ã€‚<font color="blue"><strong>ä¸¤å¥—å•å€å‹åŸºå› ç»„</strong>å¤§å°åˆ†åˆ«ä¸º<strong>3.14G</strong>å’Œ<strong>2.50 G</strong>ï¼Œ<strong>Contig N50</strong>åˆ†åˆ«ä¸º<strong>42.2M</strong>å’Œ<strong>1.6 M</strong></font>ã€‚è¿™ä¸€ç»“æœä¸<strong>å·²å‘è¡¨çš„åˆ©ç”¨HiFiæ•°æ®ç»„è£…çš„HG002å’ŒHG00733åŸºå› ç»„ç›¸å½“ã€‚æ•´ä¸ªç»„è£…è¿‡ç¨‹ä»…èŠ±è´¹2å°æ—¶ã€‚</strong>ä¸Šè¿°ç»“æœä½“ç°HiFiåœ¨<font color="blue">å•å€å‹åŸºå› ç»„ç»„è£…ä¸­çš„ä¼˜åŠ¿</font>ã€‚</p><p><img src="/GeekFocus/2022-03-02-HiFi-3-software/13.png" alt="img"><br><img src="/GeekFocus/img/2022-03-02-HiFi-3-software/13.png" alt="img"></p><p>HiFi ç»„è£… äºº åŸºå› ç»„ç»“æœ</p><hr><h1 id="ï¼ŸPacbioåºåˆ—ç»“æ„å˜å¼‚germline-SV-calling"><a href="#ï¼ŸPacbioåºåˆ—ç»“æ„å˜å¼‚germline-SV-calling" class="headerlink" title="ï¼ŸPacbioåºåˆ—ç»“æ„å˜å¼‚germline SV calling"></a>ï¼ŸPacbioåºåˆ—ç»“æ„å˜å¼‚germline SV calling</h1><p><a href="https://blog.csdn.net/weixin_36416921/article/details/112277318">https://blog.csdn.net/weixin_36416921/article/details/112277318</a> ï¼Ÿï¼Ÿ</p><p><img src="/GeekFocus/2022-03-02-HiFi-3-software/2.png" alt="img"><br><img src="/GeekFocus/img/2022-03-02-HiFi-3-software/2.png" alt="img"></p><ul><li><p>è·å–bamæ–‡ä»¶ï¼ˆPacbioä¸‹æœºæ•°æ®ï¼‰ã€‚</p></li><li><p>subreads.bamæ–‡ä»¶ åˆ°ccs.bamæ–‡ä»¶</p></li><li><p>bamåˆ°fastqæ–‡ä»¶</p></li><li><p>æ•°æ®åˆ†æï¼Œå˜å¼‚æ£€æµ‹</p><ul><li><strong>mapping &amp; calling ã€</strong>nextSV2æµç¨‹ã€‘</li><li>å¸¸ç”¨çš„é•¿åºåˆ—æ¯”å¯¹è½¯ä»¶æœ‰<strong>ngmlr</strong> å’Œ <strong>minimap2</strong>ï¼Œä¸åŒçš„mappingè½¯ä»¶å¾—åˆ°ç»“æœç•¥æœ‰å·®åˆ«ï¼Œminimap2æ¯”å¯¹å¾—åˆ°çš„ç»“æœè¾ƒå¤šï¼Ÿ</li><li><strong>sniffles calling</strong></li></ul></li></ul><hr><p>ä¸€èˆ¬è®¤ä¸ºåªæœ‰CLRçš„subreadséœ€è¦ç”¨NGSæ ¡æ­£ï¼Œccsæˆ–hifi readså·²ç»è‡ªèº«æ ¡æ­£äº†ï¼Œä¸ç”¨é¢å¤–æ ¡æ­£ã€‚å½“ccsçš„é˜ˆå€¼è®¾å®šä¸º3æ—¶ï¼Œå¾—åˆ°çš„åºåˆ—å°±æ˜¯HIFI readsäº†ã€‚</p><h1 id="HiFi-HiCanu"><a href="#HiFi-HiCanu" class="headerlink" title="HiFi+HiCanu"></a>HiFi+HiCanu</h1><p>ref: <a href="http://www.genome.cn/News/Industry/1099.html">http://www.genome.cn/News/Industry/1099.html</a></p><p><a href="https://pubmed.ncbi.nlm.nih.gov/32801147/">HiCanu: accurate assembly of segmental duplications, satellites, and allelic variants from high-fidelity long reads</a> <strong>2020.09 Genom Res</strong></p><p><strong>PacBio HiFi+HiCanu</strong>å®Œæˆå‡†ç¡®åº¦è¶…99.999%ï¼Œ<strong>Contig N50</strong>è¾¾åˆ°<strong>77Mb</strong>çš„<strong>äººç±»</strong>åŸºå› ç»„ç»„è£…ç»“æœï¼</p><p>NIHç§‘å­¦å®¶ä½¿ç”¨PacBio HiFi Readsç»„è£…åŸºå› ç»„æ–‡ç«  <strong>HiCanu</strong>ã€‚ä½¿ç”¨HiCanuç»„è£…å·¥å…·ï¼ˆä¸“é—¨é’ˆå¯¹ HiFi Readsä¼˜åŒ–ç»„è£…æµç¨‹ï¼‰ï¼Œå¯¹<font color="red"><strong>æœè‡</strong></font>å’Œ<font color="red"><strong>äººç±»</strong></font><strong>æ ‡å‡†åŸºå› ç»„</strong>ç»„è£…ï¼Œé‡ç‚¹æ¢ç´¢HiFi Readså¯¹<font color="blue"><strong>åŸºå› ç»„å•å€å‹çš„åŒºåˆ†</strong></font>ï¼Œä¸»è¦<font color="blue"><strong>ç»„ç»‡ç›¸å®¹æ€§å¤åˆä½“ï¼ˆMHCï¼‰å˜å¼‚</strong></font>ï¼ŒæŸ“è‰²ä½“<font color="blue"><strong>å«æ˜ŸåŒºåŸŸ</strong></font>å’Œ<font color="blue"><strong>ç‰‡æ®µé‡å¤</strong></font>çš„æ£€æµ‹èƒ½åŠ›ã€‚</p><h2 id="åŸºå› ç»„è¿ç»­æ€§å’Œå‡†ç¡®æ€§æå‡"><a href="#åŸºå› ç»„è¿ç»­æ€§å’Œå‡†ç¡®æ€§æå‡" class="headerlink" title="åŸºå› ç»„è¿ç»­æ€§å’Œå‡†ç¡®æ€§æå‡"></a><strong>åŸºå› ç»„è¿ç»­æ€§å’Œå‡†ç¡®æ€§æå‡</strong></h2><p>30X HiFi Readsé€šè¿‡HiCanuå°†äººCHM13ç»†èƒç³»çš„åŸºå› ç»„ç»„è£…çš„<strong>Contig N50</strong> æå‡è‡³<strong>77M</strong>ï¼Œå•ç¢±åŸºå‡†ç¡®æ€§è¶…è¿‡99.999%ï¼ˆQ50ï¼‰ï¼åœ¨ç»„è£…çš„å‡†ç¡®æ€§è¿ç»­æ€§ä¸¤ä¸ªæ–¹é¢ï¼ŒHiFi Readsçš„ç»„è£…ç»“æœéƒ½è¶…è¿‡äº†æœ€æ–° é«˜è¦†ç›–åº¦ è¶…é•¿ ç‰›æ´¥ çº³ç±³å­”æµ‹åº çš„ç»“æœã€‚</p><p><img src="/GeekFocus/2022-03-02-HiFi-3-software/3.png"><br><img src="/GeekFocus/img/2022-03-02-HiFi-3-software/3.png"></p><p>ä½¿ç”¨PacBio HiFiå’ŒUltra-Long (Oxford Nanoproe) ç»„è£…äººCHM13åŸºå› ç»„ç»“æœå¯¹æ¯”ï¼Œéƒ½<strong>æœªç»çŸ­è¯»é•¿æµ‹åºæ•°æ®polish</strong>ã€‚Peregrine, Canuå’ŒHiCanuæ˜¯ä¸åŒçš„ç»„è£…å·¥å…·ã€‚</p><h2 id="åŸºå› ç»„å•å€å‹æ£€æµ‹çš„æå‡-åšæ­¤å›¾ç±»ä¼¼è¯„ä¼°"><a href="#åŸºå› ç»„å•å€å‹æ£€æµ‹çš„æå‡-åšæ­¤å›¾ç±»ä¼¼è¯„ä¼°" class="headerlink" title="åŸºå› ç»„å•å€å‹æ£€æµ‹çš„æå‡[åšæ­¤å›¾ç±»ä¼¼è¯„ä¼°]"></a><strong>åŸºå› ç»„å•å€å‹æ£€æµ‹çš„æå‡</strong>[åšæ­¤å›¾ç±»ä¼¼è¯„ä¼°]</h2><p>ç»„è£…å¤šå€ä½“æ—¶ï¼Œç»„è£…è½¯ä»¶è¦èƒ½åŒºåˆ†<font color="blue"><strong>ä¸åŒç­‰ä½åŸºå› </strong></font>ï¼Œå¹¶å°†å®ƒä»¬<font color="blue"><strong>ä¿å­˜ä¸ºä¸åŒçš„åºåˆ—</strong></font>ï¼Œä»¥<font color="blue"><strong>ä¸»è¦Contig</strong>å’Œ<strong>æ›¿ä»£Contig</strong>æ¨¡å¼</font>è¡¨ç¤ºã€‚å¯¹äº<font color="blue">åŒå€ä½“äºº</font>åŸºå› ç»„ç»„è£…ï¼ŒHiCanuç»„è£…ç»“æœ<font color="blue">åŒ…å«<strong>è¶…è¿‡2 Gbp</strong>çš„<strong>æ›¿ä»£Contig</strong></font>ï¼Œè€Œ<font color="blue">å…¶å®ƒç»„è£…è½¯ä»¶</font>åªèƒ½äº§ç”Ÿ<font color="blue">ä¸åˆ°400 Mbpçš„æ›¿ä»£Contig [hifiasmå¦‚ä½•?]</font>ã€‚è¯´æ˜<font color="blue">HiCanu</font>ç»“åˆHiFi Readså…·æœ‰<font color="blue">æ›´å¼ºçš„<strong>åŒºåˆ†å•å€å‹èƒ½åŠ›</strong></font>ã€‚å¦‚ä¸‹å›¾ï¼ŒHiCanuç»„è£…çš„<font color="red">ä¸»è¦Contigå’Œæ›¿ä»£Contig<strong>éƒ½</strong></font>å…·æœ‰<font color="red">è¾ƒé«˜çš„<strong>BUSCOå®Œæ•´æ€§</strong></font>ï¼ˆåˆ†åˆ«**&gt; 94ï¼…<strong>å’Œ</strong>&gt; 75ï¼…<strong>ï¼‰ï¼Œè€Œé‡‡ç”¨ <strong>è¶…é•¿ ç‰›æ´¥çº³ç±³å­”æµ‹åº</strong>çš„BUSCOå®Œæ•´æ€§åˆ†åˆ«åªæœ‰</strong>63%<strong>å’Œ</strong>0.3%**ã€‚å¹¶ä¸”HiCanu + HiFi Readsçš„<font color="red"><strong>Phase Block NG50?</strong></font>æ˜¯é«˜è¦†ç›–åº¦è¶…é•¿ç‰›æ´¥çº³ç±³å­”æµ‹åºçš„2.5å€ï¼</p><p><img src="/GeekFocus/2022-03-02-HiFi-3-software/4.png"><br><img src="/GeekFocus/img/2022-03-02-HiFi-3-software/4.png"></p><p>HiCanuä¸å…¶å®ƒç»„è£…è½¯ä»¶ <strong>ç»„è£… åŒå€ä½“åŸºå› ç»„ ç»“æœå¯¹æ¯”</strong>ï¼Œå…¶ä¸­HG00733çš„Haplotype asm hap1(hap2)aå’ŒHG002çš„Haplotype asm hap1(hap2)b çš„æ•°æ®æ˜¯<font color="red"><strong>HiFiç»“åˆHi-Cçš„ç»„è£…ç»“æœ</strong></font>ã€‚</p><p>ä¸ºäº†<font color="red">è¯„ä¼°</font>ä¸åŒç»„è£…å·¥å…·å¯¹<strong>éš¾ä»¥æ£€æµ‹</strong>çš„<font color="red"><strong>å¤æ‚ä¸´åºŠç›¸å…³ç­‰ä½åŸºå› åˆ†å‹ç»“æœ</strong></font>ï¼Œé€šè¿‡HiCanu+ HiFi å¾—åˆ°çš„å…­ä¸ªç»å…¸çš„<font color="blue">äººç±»ç™½ç»†èƒæŠ—åŸï¼ˆHLAï¼‰åŸºå› </font>çš„<font color="blue">è£…é…åˆ†å‹ç»“æœ</font>ä¸ä¹‹å‰é€šè¿‡<strong>å¤šç§æ£€æµ‹æ–¹æ³•</strong>è·å¾—çš„<strong>å·²çŸ¥HG002å’ŒHG00733ç­‰ä½åŸºå› </strong>è¿›è¡Œæ¯”è¾ƒã€‚<font color="red">åªæœ‰HiCanuå’ŒTrioCanuèƒ½å¤Ÿ<strong>æ¢å¤</strong>å…·æœ‰<strong>100ï¼…åºåˆ—åŒä¸€æ€§</strong>çš„<strong>æ‰€æœ‰ç­‰ä½åŸºå› </strong></font>ã€‚è¿™ä¹Ÿä½“ç°HiCanu+ HiFiå¯¹äºæ½œåœ¨çš„å¤æ‚ä¸´åºŠç›¸å…³åŸºå› çš„ç²¾ç¡®æ£€æµ‹èƒ½åŠ›ã€‚</p><h2 id="åº”å¯¹å¤æ‚ç‰‡æ®µé‡å¤åºåˆ—"><a href="#åº”å¯¹å¤æ‚ç‰‡æ®µé‡å¤åºåˆ—" class="headerlink" title="åº”å¯¹å¤æ‚ç‰‡æ®µé‡å¤åºåˆ—"></a><strong>åº”å¯¹å¤æ‚ç‰‡æ®µé‡å¤åºåˆ—</strong></h2><p>ä¸ºäº†è¯„ä¼°å¯¹<font color="red"><strong>ç‰‡æ®µé‡å¤ï¼ˆSDï¼Œsegmental duplicationsï¼‰</strong>åºåˆ—çš„ç»„è£…èƒ½åŠ›</font>ï¼Œä½¿ç”¨äº†BACæ–‡åº“æŒ‘æˆ˜ã€‚è¢«<strong>é€‰æ‹©</strong>çš„<strong>BACæ–‡åº“åºåˆ—åŒ…å«å¤§é‡ç‰‡æ®µé‡å¤åºåˆ—</strong>ï¼Œè€Œç‰‡æ®µé‡å¤åŒºåŸŸæ˜¯åŸºå› ç»„<font color="blue"><strong>æœ€éš¾ç»„è£…åŒºåŸŸä¹‹ä¸€</strong></font>ã€‚ç»è¿‡åˆæ­¥æ¯”å¯¹ï¼ŒHiCanu+ HiFiåœ¨æ‰€æœ‰ç»„è£…æ–¹æ¡ˆä¸­<font color="red">è§£ææœ€å¤šçš„BAC</font>ï¼Œå¹¶ä¸”å®ç°<font color="red">æœ€é«˜çš„BACå¯¹æ¯”è´¨é‡</font>ã€‚</p><p><img src="/GeekFocus/2022-03-02-HiFi-3-software/5.png"><br><img src="/GeekFocus/img/2022-03-02-HiFi-3-software/5.png" alt="ä¸åŒæµ‹åºæ•°æ®ä¸ç»„è£…å·¥å…·åœ¨BACæ–‡åº“æŒ‘æˆ˜ä¸­çš„ç»“æœ"></p><p>ä¸åŒæµ‹åºæ•°æ®ä¸ç»„è£…å·¥å…·åœ¨BACæ–‡åº“æŒ‘æˆ˜ä¸­çš„ç»“æœ</p><p>é’ˆå¯¹<font color="blue">CHM13ä¸­<strong>æœªèƒ½</strong>æˆåŠŸè§£æçš„BACæ·±å…¥ç ”ç©¶</font>ï¼Œå‘ç°å…¶ä¸­ã€11ä¸ªBACæœ¬èº«å¯èƒ½åŒ…å«ç»„è£…é”™è¯¯æˆ–å…‹éš†ä¼ªåƒ?ã€‘ã€‚æ‰‹åŠ¨æ£€æŸ¥11ä¸ªBACçš„HiFiç»„è£…ç»“æœï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾ç»„è£…é”™è¯¯ï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚è¿™è¡¨æ˜HiCanu+ HiFi å®é™…ä¸ŠæˆåŠŸè§£æCHM13 341ä¸ªBACä¸­çš„<strong>337ä¸ª</strong>ã€‚</p><p><img src="/GeekFocus/2022-03-02-HiFi-3-software/6.png"><br><img src="/GeekFocus/img/2022-03-02-HiFi-3-software/6.png"></p><p>äººå·¥æ£€æŸ¥å¯èƒ½æœ¬èº«å­˜åœ¨é”™è¯¯çš„BAC</p><h2 id="äººç±»æŸ“è‰²ä½“ç€ä¸ç²’çš„ç»„è£…-how"><a href="#äººç±»æŸ“è‰²ä½“ç€ä¸ç²’çš„ç»„è£…-how" class="headerlink" title="äººç±»æŸ“è‰²ä½“ç€ä¸ç²’çš„ç»„è£… [how?]"></a>äººç±»æŸ“è‰²ä½“ç€ä¸ç²’çš„ç»„è£… [how?]</h2><p>ä½¿ç”¨HiCanu+HiFi æˆåŠŸç”ŸæˆåŒ…æ‹¬CHM13 <font color="blue"><strong>19å·æŸ“è‰²ä½“ç€ä¸ç²’åœ¨å†…</strong></font>çš„<font color="blue"><strong>å…±9ä¸ªäººç±»æŸ“è‰²ä½“ç€ä¸ç²’è£…é…å›¾</strong></font>ã€‚CHM13 <font color="red"><strong>19å·æŸ“è‰²ä½“ç€ä¸ç²’åŒºåŸŸè¢«è®¤ä¸ºæ˜¯æœ€éš¾ç»„è£…çš„ç€ä¸ç²’ä¹‹ä¸€</strong></font>ï¼Œå› ä¸ºå®ƒ<font color="red"><strong>ç”±å¤šä¸ªHORï¼ˆHigher Order Repeatï¼‰åŒºåŸŸç»„æˆ</strong></font>å¹¶<font color="red"><strong>ä¸1å·å’Œ5å·æŸ“è‰²ä½“çš„ç€ä¸ç²’åŒºåŸŸå…±äº«Î±å«æ˜Ÿåºåˆ—</strong></font>ã€‚</p><p>HiCanu+HiFi ä¸ä»…èƒ½<font color="red">ç»„è£…<strong>è¦†ç›–æ•´ä¸ªç€ä¸ç²’</strong>çš„contig<strong>ç¾¤</strong></font>ï¼Œè€Œä¸”å¯ä»¥<font color="red">å‡†ç¡®<strong>åŒºåˆ†</strong>ä¸‰ä¸ª<strong>ä¸åŒçš„HORåŒºåŸŸ???</strong></font>ï¼š<strong>D19Z1ï¼ŒD19Z2å’ŒD19Z3</strong>ã€‚åœ¨ä¹‹å‰çš„<font color="red"><strong>XæŸ“è‰²ä½“T2Tç ”ç©¶</strong>ä¸­</font>ï¼Œä¸ºäº†è¾¾åˆ°å¦‚æ­¤å®Œæ•´çš„äººç±»æŸ“è‰²ä½“<strong>ç€ä¸ç²’ç»„è£…</strong>ç»“æœï¼Œéœ€è¦<font color="blue">ä½¿ç”¨åŒ…æ‹¬<strong>é«˜æ·±åº¦è¶…é•¿çº³ç±³å­”æµ‹åº</strong>ï¼Œ<strong>60X PacBio CLR</strong>æµ‹åºå’Œ<strong>illuminaçŸ­è¯»é•¿</strong>æµ‹åºçš„æ•°æ®<strong>å…±åŒ</strong>ç»„è£…</font>æ‰èƒ½è¾¾åˆ°è¿™æ ·çš„æ•ˆæœã€‚è€Œç°åœ¨<font color="blue">ä»…ä½¿ç”¨<strong>ä¸€ç§</strong>æµ‹åºæŠ€æœ¯</font>ï¼Œå³<strong>HiFi ç»“åˆHiCanu</strong>å°±èƒ½<strong>è§£æ</strong>äººç±»æŸ“è‰²ä½“<strong>ç€ä¸ç²’</strong>ç»“æ„ã€‚</p><p><img src="/GeekFocus/2022-03-02-HiFi-3-software/7.png"><br><img src="/GeekFocus/img/2022-03-02-HiFi-3-software/7.png"></p><p>CHM13 19å·æŸ“è‰²ä½“<font color="blue"><strong>ç€ä¸ç²’çš„HiCanuè£…é…</strong></font>ã€‚tig00006497çš„<font color="red"><strong>RepeatMasker</strong>æ­ç¤ºäº†ä½äº<strong>19å·ç€ä¸ç²’</strong>ï¼ˆD19Z1ï¼ŒD19Z2Î±å’ŒD19Z3ï¼›æ ‡æœ‰é»‘æ¡ï¼‰ä¸­çš„<strong>ä¸‰ä¸ªÎ±å«æ˜ŸHORåŒºåŸŸ</strong></font>ã€‚è¿™äº›<strong>HORåºåˆ—é•¿åº¦</strong>åˆ†åˆ«ä¸º<strong>606 kbpï¼Œ289 kbpå’Œ3.96 Mbp</strong>ï¼Œåˆ†åˆ«ç”±<strong>13-mer</strong>ï¼Œå¤æ‚çš„<strong>é«˜é˜¶HOR</strong>å’Œ<strong>äºŒèšä½“HORå•å…ƒ</strong>ç»„æˆ?</p><h2 id="æ€»ç»“ä¸å±•æœ›"><a href="#æ€»ç»“ä¸å±•æœ›" class="headerlink" title="æ€»ç»“ä¸å±•æœ›"></a><strong>æ€»ç»“ä¸å±•æœ›</strong></h2><p>é€šè¿‡æœ¬ç ”ç©¶ï¼Œè¯æ˜<font color="blue">HiFi ç»“åˆHiCanu</font>èƒ½å¤Ÿç”Ÿæˆè¿„ä»Šä¸ºæ­¢<font color="blue">æœ€å‡†ç¡®ï¼Œæœ€å®Œæ•´</font>çš„äººç±»åŸºå› ç»„<font color="blue">è£…é…ä½“</font>ã€‚å…¶ä»–åº”ç”¨ï¼Œä¾‹å¦‚åŒæ ·éœ€è¦é«˜ç²¾åº¦Readsçš„<strong>å®åŸºå› ç»„ç»„è£…</strong>ã€‚<font color="red">HiFiæ“…é•¿è§£å†³<strong>å¤§å‹é«˜åº¦ç›¸ä¼¼</strong>ï¼ˆä½†<strong>ä¸å®Œå…¨ç›¸åŒ</strong>ï¼‰çš„<strong>é‡å¤åºåˆ—</strong></font>ã€‚HiCanu+HiFi å¯¹äººç±»<strong>1å·ï¼Œ7å·ï¼Œ9å·å’Œ16å·</strong>æŸ“è‰²ä½“çš„é‡å»º<strong>æ˜¾è‘—æ”¹å–„</strong>å…ˆå‰<strong>è¶…é•¿çº³ç±³å­”æµ‹åºçš„ç»„è£…è¿ç»­æ€§</strong>ã€‚è¿™äº›æŸ“è‰²ä½“åŒ…å«<font color="blue">å¤šä¸ªé•¿åº¦è¶…è¿‡<strong>200 kbpçš„ç‰‡æ®µé‡å¤</strong></font>ï¼Œéœ€è¦ <font color="blue">HiFi æ‰èƒ½<strong>è¯†åˆ«</strong>å˜å¼‚å¹¶<strong>åˆ†ç¦»</strong>å‡º<strong>å•ä¸ªæ‹·è´</strong></font>ã€‚ä½¿ç”¨ <strong>HiFi <font color="red">ç‹¬ç«‹å®Œæˆ</font><strong>äººç±»æŸ“è‰²ä½“</strong>ä¹ä¸ªç€ä¸ç²’åŒºåŸŸ</strong>çš„è£…é…è‰å›¾ï¼Œè¿™ä¹Ÿæ˜¯T2Té¡¹ç›®çš„æœ€éš¾æŒ‘æˆ˜ä¹‹ä¸€ã€‚</p><p><font color="blue">HiFi çš„é•¿åº¦</font>å¯¹ç»„è£…ç»“æœæœ‰å¾ˆå¤§å½±å“ï¼Œç›®å‰æœ€æ–°HiFi Readså·²ç»è¾¾åˆ°25kã€‚HiCanuåœ¨äºšé©¬é€Š<strong>äº‘å¹³å°</strong>ä¸Šç»„è£…ä¸€ä¸ª<strong>äºº</strong>ç±»åŸºå› ç»„åªéœ€è¦<strong>22å°æ—¶</strong>ï¼Œè¿™è¿˜<strong>ä¸æ˜¯ç›®å‰æœ€å¿«</strong>çš„é’ˆå¯¹ HiFiæ•°æ®çš„ç»„è£…è½¯ä»¶ï¼Œæœ€å¿«çš„è½¯ä»¶åªéœ€è¦<strong>2å°æ—¶</strong>ã€‚ç›¸ä¿¡æœªæ¥éšç€HiFi Readsçš„é•¿åº¦ä¸æ–­æé«˜ï¼Œä»¥åŠæ›´å¤šé’ˆå¯¹PacBio HiFi Readsä¼˜åŒ–çš„ç»„è£…è½¯ä»¶å‡ºç°ï¼ŒåŸºå› ç»„çš„ä»å¤´ç»„è£…ä¼š<strong>æ›´å¿«æ›´å‡†</strong>ã€‚</p><h1 id=""><a href="#" class="headerlink" title=""></a></h1>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Sequencing data and fastq.gz</title>
    <link href="/GeekFocus/2022/03/01/2022-03-01-sequencing-data/"/>
    <url>/GeekFocus/2022/03/01/2022-03-01-sequencing-data/</url>
    
    <content type="html"><![CDATA[<h1 id="fastqå‹ç¼©ä¹‹gzipæ–‡ä»¶å¤§å°ä¸æ ·æœ¬æ•°æ®é‡å…³ç³»"><a href="#fastqå‹ç¼©ä¹‹gzipæ–‡ä»¶å¤§å°ä¸æ ·æœ¬æ•°æ®é‡å…³ç³»" class="headerlink" title="fastqå‹ç¼©ä¹‹gzipæ–‡ä»¶å¤§å°ä¸æ ·æœ¬æ•°æ®é‡å…³ç³»"></a>fastqå‹ç¼©ä¹‹gzipæ–‡ä»¶å¤§å°ä¸æ ·æœ¬æ•°æ®é‡å…³ç³»</h1><span id="more"></span><p>ref : <a href="https://www.zxzyl.com/archives/1011">https://www.zxzyl.com/archives/1011</a></p><p>æµ‹åºæ—¶ï¼Œå…ˆæ‹¿åˆ°çš„æ˜¯æ ·æœ¬fastqå‹ç¼©åçš„gzæ–‡ä»¶ï¼Œè‹¥å…³å¿ƒæ•°æ®é‡å¤Ÿä¸å¤Ÿï¼Œåˆ™éœ€è®¡ç®—fastq.gzæ–‡ä»¶å¤§å°å’Œæµ‹åºæ•°æ®é‡çš„å…³ç³»ã€‚</p><p>ç”¨Miseqæµ‹åºæ•°æ®ï¼ˆgzæ–‡ä»¶200Mï¼‰ï¼ŒHiseq panelï¼ˆgzæ–‡ä»¶50Mï¼‰å’ŒWESæµ‹åºæ•°æ®ï¼ˆgzæ–‡ä»¶4Gï¼‰è¿›è¡Œç®€å•åˆ†æã€‚å‘ç°ï¼Œ<font color="green"><strong>è™½ç„¶R1å’ŒR2æ•°æ®é‡æ˜¯ä¸€æ ·ï¼Œè§£å‹å‡ºæ¥çš„æ–‡ä»¶å¤§å°ä¸€æ ·ï¼Œä½†R2çš„gzipæ–‡ä»¶æ€»æ¯”R1å¤§</strong></font>ã€‚ä¸ç®¡æ˜¯Miseqè¿˜æ˜¯Hiseqçš„panelæµ‹åºï¼Œå‹ç¼©åçš„R2å‡å¤§äºR1æ–‡ä»¶ï¼Œä¸”æ–‡ä»¶è¶Šå°ï¼Œå·®å¼‚è¶Šå¤§ã€‚</p><p>å› R1å’ŒR2æ•°æ®é‡ç›¸åŒï¼Œåªçœ‹R1çš„çœŸå®æ–‡ä»¶å’Œgzæ–‡ä»¶å¤§å°ä¸æ•°æ®é‡ä¹‹é—´çš„å…³ç³»ã€‚<br><font color="green"><strong>æ•°æ®é‡</strong></font>&#x3D;FASTQæ–‡ä»¶è¡Œæ•°&#x2F;4x<font color="green"><strong>151</strong></font>&#x2F;1000&#x2F;<font color="green"><strong>1000</strong></font> å•ä½ä¸º<strong>M</strong><br><font color="green"><strong>çœŸå®æ–‡ä»¶å¤§å°ä¼°è®¡</strong></font>&#x3D;FASTQæ–‡ä»¶è¡Œæ•°&#x2F;4x<font color="green"><strong>357</strong></font>&#x2F;1024&#x2F;<font color="green"><strong>1024</strong></font> å•ä½ä¸º<strong>M</strong>ï¼Œé¢„æµ‹å€¼ï¼Œå·®åˆ«ä¸å¤§ï¼Œ<strong>å› ä¸ºFASTQæ–‡ä»¶ä¸­æ¯å››è¡Œ357ä¸ªå­—ç¬¦</strong>ï¼ˆå’Œå¹³å°å’Œè®¾ç½®æœ‰å…³ç³»ï¼‰ï¼Œæ¯ä¸ªå­—ç¬¦1byteã€‚</p><p>GZæ–‡ä»¶å¤§å°é€šè¿‡ll -hæŸ¥çœ‹</p><p>å› ä¸ºFASTQæ–‡ä»¶æ˜¯<strong>è§„èŒƒ</strong>çš„ï¼Œ<strong>æ¯å››è¡Œå­—ç¬¦åŸºæœ¬ä¸€è‡´</strong>ï¼Œæ‰€ä»¥<font color="green"><strong>FASTQçœŸå®æ–‡ä»¶å¤§å°å’Œæ•°æ®é‡æˆæ­£æ¯”</strong></font>ã€‚<strong>å‰é¢æåˆ°æ¯å››è¡Œæœ‰357ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­åºåˆ—åªå 151ä¸ªå­—ç¬¦ï¼ŒFASTQæ–‡ä»¶å¤§å°å¤§æ¦‚æ˜¯æµ‹åºé‡çš„357&#x2F;151â‰ˆ2.3å€å¤š</strong>ã€‚ä½†å› FASTQæ–‡ä»¶ä¸ºæ–‡æœ¬æ–‡ä»¶ï¼Œå ç”¨ç©ºé—´è¾ƒå¤§ï¼Œæ‰€ä»¥ä¸€èˆ¬å°†FASTQæ–‡ä»¶å‹ç¼©æˆgzã€‚</p><p>ç”¨gzæ–‡ä»¶å¤§å°é™¤ä»¥ä¼°è®¡çš„çœŸå®æ–‡ä»¶å¤§å°ï¼Œå¾—åˆ°å‹ç¼©æ¯”ï¼Œå‘ç°å‹ç¼©æ¯”å’Œæµ‹åºå¹³å°æœ‰å…³ç³»ï¼Œ<font color="green"><strong>Miseq</strong>çš„å‹ç¼©æ¯”åœ¨<strong>0.35</strong>å·¦å³ï¼Œ<strong>Hiseq</strong>å¹³å°ä¸­çš„panelæµ‹åºåœ¨<strong>0.24</strong>å·¦å³ï¼Œ<strong>WES</strong>åœ¨<strong>0.2</strong>å·¦å³</font>ã€‚å¯ä»¥å‘ç°WESçš„æ•°æ®çš„å‹ç¼©æ•ˆç‡æœ€é«˜ï¼ŒçŒœæµ‹ä¸åŒå¹³å°åœ¨å‹ç¼©è¿‡ç¨‹ä¸­è®¾ç½®çš„å‹ç¼©æ¯”ä¾‹ä¸åŒã€‚Hiseqæµ‹åºå¹³å°çš„gzæ–‡ä»¶å‹ç¼©æ€§èƒ½å¤§äºMiseqå¹³å°ã€‚</p><ul><li><p>ä»¥Miseqçš„gzipæ–‡ä»¶å¤§å°å’Œæ•°æ®é‡<strong>ä½œå›¾</strong>ï¼Œå¯ä»¥å¾ˆç›´è§‚çš„å‘ç°gzæ–‡ä»¶å¤§å°å’Œæ•°æ®é‡ä¹‹é—´çš„çº¿æ€§å…³ç³»ã€‚æ–œç‡æ˜¯1.245ï¼Œæˆªè·å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œå› ä¸ºçºµåæ ‡å¾ˆå¤§ã€‚ä¹Ÿå°±æ˜¯è¯´R1æ–‡ä»¶çš„æ•°æ®é‡çº¦ç­‰äºgzipæ–‡ä»¶çš„1.245å€ã€‚</p></li><li><p><strong>ä»å¦å¤–ä¸€ä¸ªè§’åº¦è®¡ç®—</strong>ï¼Œ<font color="green"><strong>R1æ–‡ä»¶æ•°æ®é‡&#x3D;gzipæ–‡ä»¶å¤§å°&#x2F;å‹ç¼©æ•ˆç‡&#x2F;2.3</strong></font>ï¼Œåˆ™å› ä¸ºMiseqçš„å‹ç¼©æ•ˆç‡åœ¨0.35ï¼ŒHiseqåœ¨0.23å·¦å³ï¼Œæ‰€ä»¥Miseq R1æ–‡ä»¶çš„æ•°æ®é‡å¤§æ¦‚æ˜¯gzipæ–‡ä»¶çš„<font color="green">1.242å€ï¼ˆ1&#x2F;0.35&#x2F;2.3ï¼‰</font>ï¼Œå’Œä¸Šå›¾æ‹Ÿåˆçš„ç»“æœå¾ˆç›¸è¿‘ï¼Œ<strong>Hiseqçº¦åœ¨1.89(1&#x2F;0.23&#x2F;2.3)å€</strong>ã€‚çœŸå®çš„æ•°æ®é‡å…¶å®æ˜¯R1æ–‡ä»¶æ•°æ®é‡çš„2å€ï¼ˆR2æ–‡ä»¶ä¸­çš„æ•°æ®é‡å’ŒR1æ–‡ä»¶ç›¸åŒï¼‰ã€‚</p></li></ul><p><strong>ç»“è®ºï¼š</strong>ä¸åŒå¹³å°å’Œä¸åŒæµ‹åºæ–¹æ³•ä¹‹é—´çš„<font color="green">fastqæ–‡ä»¶å‹ç¼©æ¯”ä¾‹å¹¶ä¸ä¸€è‡´</font>ï¼Œä½†åŒä¸€ç§æ–¹æ³•å’Œå¹³å°å†…çš„å‹ç¼©æ¯”ä¾‹æ˜¯ç›¸è¿‘çš„ï¼Œå› è€Œå¯ä»¥æ ¹æ®gzipæ–‡ä»¶çš„å¤§å°æ¨æµ‹å‡ºæµ‹åºçš„æ•°æ®é‡ã€‚</p><p><strong>Miseqçš„æµ‹åºé‡çº¦æ˜¯R1 gzipæ–‡ä»¶å¤§å°çš„2.49å€(R1+R2)ï¼ŒHiseqçš„æµ‹åºé‡çº¦æ˜¯R1 gzipæ–‡ä»¶å¤§å°çš„3.78å€ã€‚</strong>ä¸åŒå¹³å°å’Œæ–¹æ³•ä¹‹é—´ï¼Œè¿™ä¸ªå€¼æ˜¯ä¸å›ºå®šçš„ï¼Œå¯ä»¥æ ¹æ®æ‰‹å¤´çš„æ•°æ®è®¡ç®—ä¸€ä¸‹è¿™ä¸ªæ¯”ä¾‹ï¼Œå°±èƒ½è¿…é€Ÿçš„ä¼°ç®—å‡ºæ ·æœ¬çš„æ•°æ®é‡ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>note</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Genome assemble pipeline</title>
    <link href="/GeekFocus/2022/02/28/2022-02-28-genome-assemble/"/>
    <url>/GeekFocus/2022/02/28/2022-02-28-genome-assemble/</url>
    
    <content type="html"><![CDATA[<p>Genome assemble pipeline</p><span id="more"></span><blockquote><p>å†…å®¹å‡æ¥è‡ªè²æ²™åŸºå› ï¼ˆ<a href="https://links.jianshu.com/go?to=http://www.frasergen.com/">Frasergen</a>ï¼‰æš‘æœŸç”Ÿä¿¡åŸ¹è®­ç­è¯¾å ‚ç¬”è®°</p><p><a href="https://www.jianshu.com/p/c7663d2cf337">https://www.jianshu.com/p/c7663d2cf337</a></p></blockquote><h2 id="Genome-de-nove-åŸºç¡€çŸ¥è¯†"><a href="#Genome-de-nove-åŸºç¡€çŸ¥è¯†" class="headerlink" title="Genome de nove åŸºç¡€çŸ¥è¯†"></a>Genome <em>de nove</em> åŸºç¡€çŸ¥è¯†</h2><ul><li>åŸºå› ç»„æ˜¯ç‰©ç§æ‰€å«æœ‰çš„ä¸€å¥—é—ä¼ ç‰©è´¨(å•å€ä½“ç»†èƒæ ¸ã€ç»†èƒå™¨æ‰€å«çš„å…¨éƒ¨DNAåˆ†å­) , åŒ…æ‹¬å…¨å¥—åŸºå› å’Œé—´éš”åºåˆ—</li><li>åŸºå› ç»„&#x3D;ç‰©ç§æ‰€æ‹¥æœ‰çš„ä¸€å¥—å®Œæ•´å•å€ä½“åºåˆ—</li><li>åˆ©ç”¨æµ‹åºæŠ€æœ¯å¯¹ç‰©ç§ä½“å†…æ‰€æœ‰DNAåˆ†å­è¿›è¡Œæµ‹åº,è·å–ç¢±åŸºç»„æˆ,æ˜ç¡®åŸºå› ç»“æ„ä¿¡æ¯,å¤–æ˜¾å­åŠå†…å«å­åŒºåŸŸã€å¯åŠ¨å­ä½ç½®,ä»¥åŠåŸºå› çš„æ’åˆ—é¡ºåºåŠåŠŸèƒ½</li><li>åŸºå› ç»„<em>de nove</em>,åˆç§°åŸºå› ç»„ä»å¤´æµ‹åº,æ˜¯æŒ‡å¯¹åŸºå› ç»„åºåˆ—æœªçŸ¥(æˆ–ä»…æœ‰åŸºå› ç»„è‰å›¾)çš„ç‰©ç§è¿›è¡Œå…¨åŸºå› ç»„æµ‹åº,ç„¶åè¿›è¡Œæ‹¼è£…,ä»è€Œå¾—åˆ°è¯¥ç‰©ç§çš„å…¨åŸºå› ç»„åºåˆ—,ä¸ºåç»­åŠŸèƒ½åŸºå› æŒ–æ˜ã€è°ƒæ§ä»£è°¢ç½‘ç»œæ„å»ºã€ç‰©ç§è¿›åŒ–åˆ†æç­‰å¥ å®šåŸºç¡€ã€‚</li></ul><h2 id="æ„å»ºå‚è€ƒåŸºå› ç»„pipeline"><a href="#æ„å»ºå‚è€ƒåŸºå› ç»„pipeline" class="headerlink" title="æ„å»ºå‚è€ƒåŸºå› ç»„pipeline"></a>æ„å»ºå‚è€ƒåŸºå› ç»„pipeline</h2><p><img src="/GeekFocus/2022-02-28-genome-assemble/1.png" alt="1"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/1.png" alt="1"></p><h3 id="åŸºå› ç»„Surveyåˆ†æ"><a href="#åŸºå› ç»„Surveyåˆ†æ" class="headerlink" title="åŸºå› ç»„Surveyåˆ†æ"></a>åŸºå› ç»„Surveyåˆ†æ</h3><ul><li><p>åŸºå› ç»„SurveyåŸºäºå°ç‰‡æ®µæ–‡åº“çš„ä½æ·±åº¦æµ‹åºæ•°æ®( 50X-100X ) ;</p></li><li><p>é€šè¿‡K-meråˆ†æ ,æœ‰æ•ˆçš„<strong>è¯„ä¼°åŸºå› ç»„å¤§å°ã€GCå«é‡ã€æ‚åˆåº¦ä»¥åŠé‡å¤åºåˆ—çš„å«é‡ç­‰ä¿¡æ¯</strong>;</p></li><li><p>æ˜¯å…¨é¢äº†è§£æŸä¸€ç‰©ç§åŸºå› ç»„ç‰¹å¾çš„æœ‰æ•ˆæ–¹æ³•;</p></li><li><p>ä¸ºåç»­çš„å…¨åŸºå› ç»„ <em>de novo</em> æµ‹åºçš„ç»„è£…ç­–ç•¥çš„åˆ¶å®šæä¾›ç†è®ºä¾æ®ã€‚</p></li></ul><p><img src="/GeekFocus/2022-02-28-genome-assemble/2.png" alt="2"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/2.png" alt="2"></p><h4 id="è¡¥å……çŸ¥è¯†1ï¼šåŸºå› ç»„å¤æ‚åº¦è¯„ä¼°"><a href="#è¡¥å……çŸ¥è¯†1ï¼šåŸºå› ç»„å¤æ‚åº¦è¯„ä¼°" class="headerlink" title="è¡¥å……çŸ¥è¯†1ï¼šåŸºå› ç»„å¤æ‚åº¦è¯„ä¼°"></a>è¡¥å……çŸ¥è¯†1ï¼šåŸºå› ç»„å¤æ‚åº¦è¯„ä¼°</h4><p><img src="/GeekFocus/2022-02-28-genome-assemble/3.png" alt="3"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/3.png" alt="3"></p><h4 id="è¡¥å……çŸ¥è¯†2ï¼šæ ¹æ®kmer-å›¾ç¡®è®¤ç‰©ç§å€å‹"><a href="#è¡¥å……çŸ¥è¯†2ï¼šæ ¹æ®kmer-å›¾ç¡®è®¤ç‰©ç§å€å‹" class="headerlink" title="è¡¥å……çŸ¥è¯†2ï¼šæ ¹æ®kmer-å›¾ç¡®è®¤ç‰©ç§å€å‹"></a>è¡¥å……çŸ¥è¯†2ï¼šæ ¹æ®kmer-å›¾ç¡®è®¤ç‰©ç§å€å‹</h4><blockquote><p>äºŒå€ä½“ï¼šæ‚åˆå³°ï¼šä¸»å³°ï¼šé‡å¤å³°&#x3D;1ï¼š2ï¼š4ï¼ˆxï¼‰</p></blockquote><p><img src="/GeekFocus/2022-02-28-genome-assemble/4.png" alt="4"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/4.png" alt="4"></p><blockquote><p>ä¸‰å€ä½“ï¼šæ­£å¸¸æƒ…å†µä¸‹æ‚åˆå³°ï¼šä¸»å³°ï¼šé‡å¤å³° &#x3D; 1:2:3ï¼ˆå·¦å›¾ï¼‰ã€‚ä¸»å³°å’Œé‡å¤å³°æ·±åº¦ä½åˆ™å¯èƒ½é‡å åœ¨ä¸€èµ·ï¼šæ‚åˆå³°ï¼šä¸»å³°ï¼šé‡å¤å³° &#x3D; 1:2ï¼ˆå³å›¾ï¼‰</p></blockquote><p><img src="/GeekFocus/2022-02-28-genome-assemble/5.png" alt="5"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/5.png" alt="5"></p><blockquote><p><strong>å¼‚æºå››å€ä½“</strong>ï¼š2ä¸ªå³°ï¼Œå‘ˆç°1:2çš„å…³ç³»</p></blockquote><p><img src="/GeekFocus/2022-02-28-genome-assemble/6.png" alt="6"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/6.png" alt="6"></p><blockquote><p><strong>åŒæºå››å€ä½“</strong>ï¼šåŒæºå››å€ä½“çš„å³°å°±æ˜¯1 : 2 : 3 : 4 ,å…¶ä¸­3å’Œ4ç»å¸¸é‡å åœ¨ä¸€èµ·</p></blockquote><p><img src="/GeekFocus/2022-02-28-genome-assemble/7.png" alt="7"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/7.png" alt="7"></p><h4 id="è¡¥å……çŸ¥è¯†3ï¼šSurveyä¼˜åŠ¿"><a href="#è¡¥å……çŸ¥è¯†3ï¼šSurveyä¼˜åŠ¿" class="headerlink" title="è¡¥å……çŸ¥è¯†3ï¼šSurveyä¼˜åŠ¿"></a>è¡¥å……çŸ¥è¯†3ï¼šSurveyä¼˜åŠ¿</h4><p><img src="/GeekFocus/2022-02-28-genome-assemble/8.png" alt="8"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/8.png" alt="8"></p><h3 id="åŸºå› ç»„ç»„è£…ä¸æ³¨é‡Š"><a href="#åŸºå› ç»„ç»„è£…ä¸æ³¨é‡Š" class="headerlink" title="åŸºå› ç»„ç»„è£…ä¸æ³¨é‡Š"></a>åŸºå› ç»„ç»„è£…ä¸æ³¨é‡Š</h3><ul><li><strong>Contig</strong>ï¼šä½¿ç”¨çŸ­readsä¹‹é—´çš„overlapå…³ç³»æ‹¼æ¥æ‰€å¾—çš„æ— GAPåºåˆ—ç‰‡æ®µ</li><li><strong>Scaffold</strong>ï¼šé€šè¿‡å¤§ç‰‡æ®µæ–‡åº“å°†Contigè¿›-æ­¥è¿æ¥æ‰€å¾—çš„é•¿åºåˆ—ç‰‡æ®µï¼Œå„ä¸ªContigä¹‹é—´ç”¨â€Nâ€å¡«è¡¥</li></ul><p><img src="/GeekFocus/2022-02-28-genome-assemble/9.png" alt="9"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/9.png" alt="9"></p><ul><li><p>ç»„è£…è´¨é‡è¯„ä»·åŸºæœ¬æŒ‡æ ‡ï¼š<strong>ContigN50</strong>ä¸<strong>ScaffoldN50</strong></p></li><li><p>å°†ç»„è£…æ‰€å¾—åºåˆ—<strong>ä»å¤§åˆ°å°</strong>æ’åˆ—ï¼Œå¹¶ä¾æ¬¡ç›¸åŠ ï¼Œå½“<strong>ç´¯åŠ é•¿åº¦è¾¾åˆ°æ€»é•¿åº¦ä¸€åŠæ—¶ï¼Œæœ€åä¸€æ¡åºåˆ—çš„é•¿åº¦</strong>å³ä¸ºN50;N50è¶Šå¤§ï¼Œç»„è£…ç»“æœè¿ç»­æ€§è¶Šå¥½</p></li></ul><h4 id="ç»„è£…æµç¨‹"><a href="#ç»„è£…æµç¨‹" class="headerlink" title="ç»„è£…æµç¨‹"></a>ç»„è£…æµç¨‹</h4><p><img src="/GeekFocus/2022-02-28-genome-assemble/10.png" alt="10"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/10.png" alt="10"></p><h4 id="ç»„è£…"><a href="#ç»„è£…" class="headerlink" title="ç»„è£…"></a>ç»„è£…</h4><p>å¸¸ç”¨è½¯ä»¶æœ‰**<a href="https://links.jianshu.com/go?to=https://canu.readthedocs.io/en/latest/">Canu</a>, <a href="https://links.jianshu.com/go?to=https://github.com/xiaochuanle/MECAT">MECAT</a>, <a href="https://links.jianshu.com/go?to=https://github.com/PacificBiosciences/pb-assembly">FALCON</a><strong>ã€‚ä»é¡¹ç›®å‘¨æœŸã€ç»„è£…ç»“æœã€èµ„æºæ¶ˆè€—ç­‰æ–¹é¢ç»¼åˆæ¥çœ‹,è²æ²™åŸºå› ï¼ˆ<a href="https://links.jianshu.com/go?to=http://www.frasergen.com/">Frasergen</a>ï¼‰é¦–é€‰</strong>Mecat 2**è¿›è¡ŒåŸºå› ç»„ç»„è£…ã€‚</p><p>####Hi-Cè¾…åŠ©ç»„è£…</p><p>Hi-Cæ•°æ®çš„ä¸€èˆ¬è§„å¾‹:<br>â¢ æŸ“è‰²ä½“å†…çš„äº’ä½œé«˜äºæŸ“è‰²ä½“é—´çš„äº’ä½œ<br>â¢ æŸ“è‰²ä½“å†…äº’ä½œå¼ºåº¦éšçº¿æ€§è·ç¦»å¢åŠ è€Œå‡å¼±</p><p><img src="/GeekFocus/2022-02-28-genome-assemble/11.png" alt="11"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/11.png" alt="11"></p><h4 id="ç»„è£…ç»“æœè¯„ä¼°"><a href="#ç»„è£…ç»“æœè¯„ä¼°" class="headerlink" title="ç»„è£…ç»“æœè¯„ä¼°"></a>ç»„è£…ç»“æœè¯„ä¼°</h4><p>æ•°æ®å›æ¯”ï¼šä¸ºäº†è¯„ä¼°ç»„è£…çš„å®Œæ•´æ€§å’Œæµ‹åºè¦†ç›–çš„å‡åŒ€æ€§,é€‰æ‹©CLR (Continuous Long Reads) subreads ,ä½¿ç”¨æ¯”å¯¹å·¥å…·Minimap2 ( v2.5é»˜è®¤å‚æ•°)æ¯”å¯¹å›ç»„è£…å¥½çš„åŸºå› ç»„,ç»Ÿè®¡readsçš„æ¯”å¯¹ç‡ã€è¦†ç›–åŸºå› ç»„çš„ç¨‹åº¦ä»¥åŠæ·±åº¦çš„åˆ†å¸ƒæƒ…å†µ,ç”±æ­¤è¯„ä¼°ç»„è£…çš„å®Œæ•´æ€§å’Œæµ‹åºè¦†ç›–çš„å‡åŒ€æ€§,ç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><p>BUSCOè¯„ä¼°ï¼šåŸºäºOrthoDBä¸­çš„å•æ‹·è´åŒæºåŸºå› é›†,ä½¿ç”¨BUSCO ( V3.0.2 )é¢„æµ‹è¿™äº›åŸºå› å¹¶ç»Ÿè®¡å…¶å®Œæ•´åº¦,ç¢ç‰‡åŒ–ç¨‹åº¦åŠå¯èƒ½çš„ä¸¢å¤±ç‡ã€‚ç”±æ­¤è¯„ä¼°æ•´ä¸ªç»„è£…ç»“æœä¸­åŸºå› åŒºçš„å®Œæ•´æ€§(å¤§äº90%è¾ƒå¥½)ã€‚BUSCOè¯„ä¼°ç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><p><img src="/GeekFocus/2022-02-28-genome-assemble/12.png" alt="12"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/12.png" alt="12"></p><h4 id="åŸºå› ç»“æ„æ³¨é‡Š"><a href="#åŸºå› ç»“æ„æ³¨é‡Š" class="headerlink" title="åŸºå› ç»“æ„æ³¨é‡Š"></a>åŸºå› ç»“æ„æ³¨é‡Š</h4><p>åŸºå› ç»“æ„é¢„æµ‹åŒ…æ‹¬é¢„æµ‹åŸºå› ç»„ä¸­çš„åŸºå› ä½ç‚¹ã€å¼€æ”¾æ€§é˜…è¯»æ¡†æ¶ï¼ˆORFï¼‰ã€ç¿»è¯‘èµ·å§‹ä½ç‚¹å’Œç»ˆæ­¢ä½ç‚¹ã€å†…å«å­å’Œå¤–æ˜¾å­åŒºåŸŸã€å¯åŠ¨å­å’Œç»ˆæ­¢å­ã€å¯å˜å‰ªåˆ‡ä½ç‚¹ä»¥åŠè›‹ç™½ç¼–ç åºåˆ—ï¼ˆCDSï¼‰ç­‰</p><p><img src="/GeekFocus/2022-02-28-genome-assemble/13.png" alt="13"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/13.png" alt="13"></p><h4 id="åŸºå› åŠŸèƒ½æ³¨é‡Š"><a href="#åŸºå› åŠŸèƒ½æ³¨é‡Š" class="headerlink" title="åŸºå› åŠŸèƒ½æ³¨é‡Š"></a>åŸºå› åŠŸèƒ½æ³¨é‡Š</h4><p>å…¨åŸºå› ç»„æµ‹åºå°†äº§ç”Ÿå¤§é‡æ•°æ®ï¼Œæ­¤å‰æ™®éé‡‡ç”¨æ¯”å¯¹æ–¹æ³•å¯¹å¯¹é¢„æµ‹å‡ºæ¥çš„<strong>ç¼–ç åŸºå› </strong>è¿›è¡ŒåŠŸèƒ½æ³¨é‡Šï¼Œé€šè¿‡ä¸å„ç§åŠŸèƒ½æ•°æ®åº“ï¼ˆNRã€Swiss-Prot ã€GOã€KOGã€KEGGï¼‰è¿›è¡Œè›‹ç™½è´¨æ¯”å¯¹ï¼Œè·å–è¯¥åŸºå› çš„åŠŸèƒ½ä¿¡æ¯ã€‚å…¶ä¸­GOå’ŒKEGGæ•°æ®åº“åˆ†åˆ«åœ¨åŸºå› åŠŸèƒ½å’Œä»£è°¢é€šè·¯ç ”ç©¶ä¸­å æ®é‡è¦åœ°ä½ã€‚</p><p><img src="/GeekFocus/2022-02-28-genome-assemble/14.png" alt="14"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/14.png" alt="14"></p><h4 id="éç¼–ç RNAæ³¨é‡Š"><a href="#éç¼–ç RNAæ³¨é‡Š" class="headerlink" title="éç¼–ç RNAæ³¨é‡Š"></a>éç¼–ç RNAæ³¨é‡Š</h4><p>éç¼–ç RNAï¼ˆncRNAï¼‰ï¼ŒæŒ‡ä¸ç¿»è¯‘æˆè›‹ç™½è´¨çš„RNAï¼Œå¦‚<br> miRNA(MicroRNA),<br> tRNA(è½¬è¿RNA)ï¼Œ<br> rRNA(æ ¸ç³–ä½“RNA),<br> snRNAï¼ˆå°æ ¸RNAï¼‰ç­‰ã€‚<br> åˆ©ç”¨tRNAscan-SEå¯¹å…¨åŸºå› ç»„è¿›è¡ŒtRNAé¢„æµ‹ï¼›åˆ©ç”¨RNAmmeré¢„æµ‹å…¨åŸºå› çš„rRNAï¼›åˆ©ç”¨Rfamæ•°æ®åº“é€šè¿‡cmscané‰´å®šå…¨åŸºå› ç»„éç¼–ç RNA</p><p><img src="/GeekFocus/2022-02-28-genome-assemble/15.png" alt="15"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/15.png" alt="15"></p><h4 id="é‡å¤åºåˆ—åˆ†æ"><a href="#é‡å¤åºåˆ—åˆ†æ" class="headerlink" title="é‡å¤åºåˆ—åˆ†æ"></a>é‡å¤åºåˆ—åˆ†æ</h4><p>é‡å¤åºåˆ—å¹¿æ³›å­˜åœ¨äºçœŸæ ¸ç”Ÿç‰©åŸºå› ç»„ä¸­ï¼Œè¿™äº›é‡å¤åºåˆ—æˆ–é›†ä¸­æˆç°‡ï¼Œæˆ–åˆ†æ•£åœ¨åŸºå› ä¹‹é—´ï¼Œæ ¹æ®åˆ†å¸ƒæŠŠé‡å¤åºåˆ—åˆ†ä¸ºåˆ†æ•£é‡å¤åºåˆ—ï¼ˆInterpersed repeatï¼‰å’Œä¸²è”é‡å¤åºåˆ—ï¼ˆTendam repeatï¼‰</p><p><img src="/GeekFocus/2022-02-28-genome-assemble/16.png" alt="16"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/16.png" alt="16"></p><h4 id="åŸºå› ç»„åœˆå›¾ç»“æœå±•ç¤º"><a href="#åŸºå› ç»„åœˆå›¾ç»“æœå±•ç¤º" class="headerlink" title="åŸºå› ç»„åœˆå›¾ç»“æœå±•ç¤º"></a>åŸºå› ç»„åœˆå›¾ç»“æœå±•ç¤º</h4><p><img src="/GeekFocus/2022-02-28-genome-assemble/18.png" alt="18"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/18.png" alt="18"></p><h3 id="æ¯”è¾ƒåŸºå› ç»„å­¦"><a href="#æ¯”è¾ƒåŸºå› ç»„å­¦" class="headerlink" title="æ¯”è¾ƒåŸºå› ç»„å­¦"></a>æ¯”è¾ƒåŸºå› ç»„å­¦</h3><ul><li><p>æ¯”è¾ƒåŸºå› ç»„å­¦æ˜¯ä»åŸºå› ç»„ä¸­è§£æç”Ÿç‰©å­¦æ„ä¹‰</p><p><img src="/GeekFocus/2022-02-28-genome-assemble/19.png" alt="19"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/19.png" alt="19"></p></li></ul><h4 id="åŸºå› å®¶æ—èšç±»"><a href="#åŸºå› å®¶æ—èšç±»" class="headerlink" title="åŸºå› å®¶æ—èšç±»"></a>åŸºå› å®¶æ—èšç±»</h4><p><img src="/GeekFocus/2022-02-28-genome-assemble/20.png" alt="20"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/20.png" alt="20"></p><h4 id="ç³»ç»Ÿè¿›åŒ–æ ‘"><a href="#ç³»ç»Ÿè¿›åŒ–æ ‘" class="headerlink" title="ç³»ç»Ÿè¿›åŒ–æ ‘"></a>ç³»ç»Ÿè¿›åŒ–æ ‘</h4><p><img src="/GeekFocus/2022-02-28-genome-assemble/21.png" alt="21"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/21.png" alt="21"></p><h4 id="ç‰©ç§åˆ†æ­§æ—¶é—´è®¡ç®—"><a href="#ç‰©ç§åˆ†æ­§æ—¶é—´è®¡ç®—" class="headerlink" title="ç‰©ç§åˆ†æ­§æ—¶é—´è®¡ç®—"></a>ç‰©ç§åˆ†æ­§æ—¶é—´è®¡ç®—</h4><p><img src="/GeekFocus/2022-02-28-genome-assemble/22.png" alt="22"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/22.png" alt="22"></p><h4 id="åŸºå› å®¶æ—æ‰©å±•æ”¶ç¼©åˆ†æ"><a href="#åŸºå› å®¶æ—æ‰©å±•æ”¶ç¼©åˆ†æ" class="headerlink" title="åŸºå› å®¶æ—æ‰©å±•æ”¶ç¼©åˆ†æ"></a>åŸºå› å®¶æ—æ‰©å±•æ”¶ç¼©åˆ†æ</h4><p><img src="/GeekFocus/2022-02-28-genome-assemble/23.png" alt="23"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/23.png" alt="23"></p><h4 id="æ­£é€‰æ‹©åˆ†æ"><a href="#æ­£é€‰æ‹©åˆ†æ" class="headerlink" title="æ­£é€‰æ‹©åˆ†æ"></a>æ­£é€‰æ‹©åˆ†æ</h4><p><img src="/GeekFocus/2022-02-28-genome-assemble/24.png" alt="24"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/24.png" alt="24"></p><h4 id="å…±çº¿æ€§åˆ†æ-éœ€åˆ°æŸ“è‰²ä½“æ°´å¹³"><a href="#å…±çº¿æ€§åˆ†æ-éœ€åˆ°æŸ“è‰²ä½“æ°´å¹³" class="headerlink" title="å…±çº¿æ€§åˆ†æ(éœ€åˆ°æŸ“è‰²ä½“æ°´å¹³)"></a>å…±çº¿æ€§åˆ†æ(éœ€åˆ°æŸ“è‰²ä½“æ°´å¹³)</h4><p><img src="/GeekFocus/2022-02-28-genome-assemble/25.png" alt="25"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/25.png" alt="25"></p><h4 id="å…¨åŸºå› ç»„å¤åˆ¶åˆ†æ-WGD"><a href="#å…¨åŸºå› ç»„å¤åˆ¶åˆ†æ-WGD" class="headerlink" title="å…¨åŸºå› ç»„å¤åˆ¶åˆ†æ(WGD)"></a>å…¨åŸºå› ç»„å¤åˆ¶åˆ†æ(WGD)</h4><p><img src="/GeekFocus/2022-02-28-genome-assemble/26.png" alt="26"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/26.png" alt="26"></p><h4 id="æ³›åŸºå› ç»„åˆ†æï¼ˆéœ€è¦å¤šä»½åŸºå› ç»„de-noveæµ‹åºæ•°æ®ï¼‰"><a href="#æ³›åŸºå› ç»„åˆ†æï¼ˆéœ€è¦å¤šä»½åŸºå› ç»„de-noveæµ‹åºæ•°æ®ï¼‰" class="headerlink" title="æ³›åŸºå› ç»„åˆ†æï¼ˆéœ€è¦å¤šä»½åŸºå› ç»„de noveæµ‹åºæ•°æ®ï¼‰"></a>æ³›åŸºå› ç»„åˆ†æï¼ˆéœ€è¦å¤šä»½åŸºå› ç»„<em>de nove</em>æµ‹åºæ•°æ®ï¼‰</h4><p><img src="/GeekFocus/2022-02-28-genome-assemble/27.png" alt="27"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/27.png" alt="27"></p><h2 id="æ–‡ç« "><a href="#æ–‡ç« " class="headerlink" title="æ–‡ç« "></a>æ–‡ç« </h2><p><img src="/GeekFocus/2022-02-28-genome-assemble/28.png" alt="28"><br><img src="/GeekFocus/img/2022-02-28-genome-assemble/28.png" alt="28"></p><p><a href="https://links.jianshu.com/go?to=https://pan.baidu.com/s/1t_xbRf4Bj3DoHTQV-y6xAQ">https://pan.baidu.com/s/1t_xbRf4Bj3DoHTQV-y6xAQ</a></p><p>yyds</p>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Soapdenovo2</title>
    <link href="/GeekFocus/2022/02/24/2022-02-25-soapdenovo2/"/>
    <url>/GeekFocus/2022/02/24/2022-02-25-soapdenovo2/</url>
    
    <content type="html"><![CDATA[<h1 id="soapdenovo2"><a href="#soapdenovo2" class="headerlink" title="soapdenovo2:"></a>soapdenovo2:</h1><span id="more"></span><p>SOAPdenovoä½¿ç”¨è¯´æ˜ï¼Œå†…å®¹åŒ…æ‹¬ç¨‹åº<font color="green"><strong>ä½¿ç”¨</strong></font>ã€<font color="green"><strong>å‚æ•°è¯´æ˜</strong></font>ã€<font color="green"><strong>å‚æ•°è°ƒæ•´</strong></font>ã€ä¸»è¦<font color="green"><strong>è¾“å‡ºæ–‡ä»¶</strong></font>çš„æ ¼å¼è¯´æ˜ç­‰ã€‚</p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/1.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/1.png" alt="img"></p><h1 id="contiging"><a href="#contiging" class="headerlink" title="contiging"></a>contiging</h1><p><em><strong>a.</strong></em>  åŸºå› ç»„DNAéšæœºæ‰“æ–­ï¼Œä½¿ç”¨paired-endæµ‹åºã€‚é•¿åº¦åœ¨150-500bpçš„short clonesæ‰©å¢ç›´æ¥æµ‹åºã€‚åœ¨2-10kbçš„é•¿paired-end libraries é€šè¿‡DNAç¯åŒ–ã€fragmentationç ´ç¢ï¼Œç„¶åå‡€åŒ–400-600bpçš„ç¢ç‰‡ä¸ºäº†cluster ç»“æ„ã€‚</p><p><em><strong>b.</strong></em>  raw reads æˆ–é¢„ä¿®æ­£readsè¢«å­˜å‚¨ï¼Œde Bruijn graph data structure è¢«ç”¨äºè¡¨ç¤ºreadsé—´overlapã€‚</p><p>Kmer-graphæ„å»ºï¼šæ‰€æœ‰readsè¢«åˆ‡å‰²æˆæŸä¸€å›ºå®šKmeré•¿åº¦çš„åºåˆ—ï¼ˆ21bp&#x3D;&lt;kmer&lt;&#x3D;127bpï¼‰ï¼Œå½¢æˆç­‰é•¿çš„Kmersã€‚å°†Kmersè¿æˆå›¾ã€‚<font color="green"><strong>ç›¸é‚»çš„kmersæ˜¯é€šè¿‡K-1 overlapingè¿æ¥</strong></font>ï¼Œæ‰€ä»¥å®ƒä¸éœ€è¦æˆå¯¹åºåˆ—æ¯”å¯¹ï¼ˆThe neighboring kmers are K-1 overlaping which generated from read sequences, so it doesnâ€™t need pair-wise reads alignment.ï¼‰ã€‚é‡å¤åºåˆ—åœ¨å›¾ä¸­è¢«å‹ç¼©ã€‚</p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/2.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/2.png" alt="img"></p><p><em><strong>c.</strong></em>  äº§ç”Ÿ<font color="red"><strong>tipsç¿¼å°–ã€bubblesæ°”æ³¡ã€low coverage linksä½è¦†ç›–ç‡é“¾æ¥ã€tiny repeatå¾®å°é‡å¤</strong></font>ç­‰é—®é¢˜ã€‚</p><p><font color="blue"><strong>tipsç¿¼å°–ï¼ˆaï¼‰</strong></font>å’Œ<font color="blue"><strong>bubblesæ°”æ³¡ï¼ˆcï¼‰</strong></font>ï¼šç”±äº<strong>æµ‹åºé”™è¯¯</strong>æˆ–<strong>æ‚åˆ</strong>æˆ–<strong>é«˜é‡å¤åºåˆ—</strong>ç›¸ä¼¼æ€§ï¼Œå°†ä¼šå¯¼è‡´ç¿¼å°–å’Œæ°”æ³¡å‡ºç°ã€‚</p><p><font color="blue"><strong>low coverage linksä½è¦†ç›–ç‡é“¾æ¥ï¼šï¼ˆbï¼‰ï¼ˆdï¼‰</strong></font>ã€‚</p><p><font color="blue"><strong>tiny repeatå¾®å°é‡å¤(e)</strong></font>ï¼šé‡å¤åœ¨graphä¸­è¢«å‹ç¼©ï¼Œå¹¶ä½œä¸ºä¸åŒè·¯å¾„çš„å…±äº«è¾¹ç¼˜ï¼Œä½†æ˜¯èƒ½å¤Ÿé€šè¿‡reads ç©¿è¿‡æ¥è§£å†³ã€‚</p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/3.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/3.png" alt="img"></p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/4.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/4.png" alt="img"></p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/5.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/5.png" alt="img"></p><p>ç§»é™¤é”™è¯¯é“¾æ¥å’Œgraph simplificationå›¾å½¢ç®€åŒ–ï¼Œå¾—åˆ°contigs or contig  graphsï¼štipsç¿¼å°–ç§»é™¤ï¼›åˆ é™¤ä½è¦†ç›–é“¾æ¥ï¼›bubblesåˆå¹¶æ°”æ³¡ï¼›è§£å†³å¾®å°é‡å¤ï¼›</p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/6.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/6.png" alt="img"></p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/7.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/7.png" alt="img"></p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/8.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/8.png" alt="img"></p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/9.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/9.png" alt="img"></p><p> <em><strong>d.</strong></em>  contig  graphs,åœ¨é‡å¤çš„èŠ‚ç‚¹å¤„å‰ªæ–­?ï¼Œè¾“å‡ºcontigs</p><h1 id="scaffolding"><a href="#scaffolding" class="headerlink" title="scaffolding"></a>scaffolding</h1><p><em><strong>e.</strong></em>  é‡æ–°ç”¨readså’Œcontigsè¿›è¡Œæ¯”å¯¹ï¼Œä½¿ç”¨<font color="red"><strong>paired-endä¿¡æ¯</strong></font>æŠŠå•ä¸€çš„contigsè¿æ¥æˆscaffoldsã€‚reads æ¯”å¯¹åˆ°contigsä¸Šï¼Œä¸´è¿‘çš„contigå»ºç«‹è¿æ¥ï¼›repeatå°†ä¼šå¼•æ¥å†²çªçŸ›ç›¾ä¿¡æ¯ï¼›<font color="red"><strong>åœ¨ç»„è£…æˆscaffoldæ—¶ï¼Œrepeat contigså°†ä¼šè¢«å±è”½</strong></font>ï¼›paired-endä¿¡æ¯çš„ä¸åŒæ’å…¥ç‰‡æ®µè¢«ç”¨æ¥ä¸€æ­¥æ­¥ä»çŸ­åˆ°é•¿çš„å»ºç«‹scaffold graph(Scaffolding iteratively from short to long insert PEs.&#x2F;Various insert size of paired-end information is used to build contig graph step by step from short to long)ã€‚</p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/10.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/10.png" alt="img"></p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/11.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/11.png" alt="img"></p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/12.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/12.png" alt="img"></p><h1 id="Gap-Filling"><a href="#Gap-Filling" class="headerlink" title="Gap Filling:"></a>Gap Filling:</h1><p><em><strong>f.</strong></em>  ä½¿ç”¨paired-end readsæ¥å¡«è¡¥scaffoldså†…éƒ¨å¯èƒ½æ˜¯ç”±é‡å¤åºåˆ—æ‰€é€ æˆçš„Gapã€‚contig N50 é€šå¸¸æ¯”è¾ƒå°ï¼ˆ&lt;3KBï¼‰,ä½†æ˜¯ï¼Œgap fillingä¹‹åèƒ½å¤Ÿæ˜¾è‘—æé«˜N50å€¼ï¼ˆi.e.,&gt;20KBï¼‰;Most of the gaps are repeat relative sequences.;Reads locate at gaps can collected by their paired-end which uniquely map to the contig.</p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/13.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/13.png" alt="img"></p><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>SOAPdenovoï¼ˆç›®å‰æœ€æ–°ç‰ˆæ˜¯SOAPdenovo2ï¼‰æ˜¯åˆ©ç”¨ä¸€ç§æ–°çš„ç»„è£…çŸ­readçš„æ–¹æ³•ï¼Œå®ƒä»¥kermä¸ºèŠ‚ç‚¹å•ä½ï¼Œåˆ©ç”¨<font color="green"><strong>de Bruijnå›¾</strong></font>çš„æ–¹æ³•å®ç°å…¨åŸºå› ç»„çš„ç»„è£…ï¼Œå’Œå…¶ä»–çŸ­åºåˆ—ç»„è£…è½¯ä»¶ç›¸æ¯”ï¼Œå®ƒå¯ä»¥è¿›è¡Œå¤§å‹åŸºå› ç»„æ¯”å¦‚äººç±»åŸºå› ç»„çš„ç»„è£…ï¼Œç»„è£…ç»“æœæ›´åŠ å‡†ç¡®å¯é ï¼Œå¯ä»¥é€šè¿‡ç»„è£…çš„ç»“æœéå¸¸å‡†ç¡®åœ°é‰´åˆ«å‡ºåŸºå› ç»„ä¸Šçš„åºåˆ—ç»“æ„æ€§å˜å¼‚ï¼Œä¸ºæ„å»ºå…¨åŸºå› ç»„å‚è€ƒåºåˆ—å’Œä»¥ä½æµ‹åºæˆæœ¬å¯¹æœªçŸ¥åŸºå› ç»„å®æ–½ç²¾ç¡®åˆ†æåˆ›é€ äº†å¯èƒ½ã€‚</p><p>SOAPdenovo aims for large plant and animal genomes, although it also works well on bacteria and fungi genomes. It runs on 64-bit Linux system with a minimum of 5G physical memory. For <strong>big genomes</strong> like human, about <strong>150 GB memory</strong> would be required.</p><p>ç¨‹åºçš„ä¸‹è½½åŠå®‰è£…ï¼š<br>ä¸‹è½½åœ°å€ï¼š<a href="http://soap.genomics.org.cn/soapdenovo.html">http://soap.genomics.org.cn/soapdenovo.html</a><br>å®‰è£…ï¼š<br>(a) ä¸‹è½½SOAPdenovoçš„å‹ç¼©åŒ…   </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">git <span class="hljs-built_in">clone</span> https://github.com/aquaskyline/SOAPdenovo2.git<br><span class="hljs-built_in">cd</span> SOAPdenovo2<br>make<br></code></pre></td></tr></table></figure><p>(b) è§£å‹ç¼©<br>(c)å°†å¾—åˆ°å¯æ‰§è¡Œæ–‡ä»¶SOAPdenovoå’Œä¸€ä¸ªé…ç½®æ–‡ä»¶çš„æ¨¡æ¿example.contig</p><p><strong>3ä¸ªå¯æ‰§è¡Œæ–‡ä»¶</strong></p><ol><li><font color="green"><strong>SOAPdenovo-63mer</strong></font></li><li><font color="green"><strong>SOAPdenovo-127mer</strong></font></li><li><font color="green"><strong>SOAPdenovo-fusion</strong></font></li></ol><p>ç¬¬ä¸€ä¸ªæ”¯æŒæœ€å¤§k-merä¸º63ï¼Œç¬¬äºŒä¸ªæœ€å¤§kmerä¸º127ï¼Œç¬¬ä¸‰ä¸ªæ–‡ä»¶ç”¨äºå•ç»†èƒæµ‹åºå’Œå®åŸºå› ç»„æµ‹åºæ•°æ®ã€‚</p><h1 id="ä½¿ç”¨ç¨‹åºåŠå‚æ•°"><a href="#ä½¿ç”¨ç¨‹åºåŠå‚æ•°" class="headerlink" title="ä½¿ç”¨ç¨‹åºåŠå‚æ•°"></a>ä½¿ç”¨ç¨‹åºåŠå‚æ•°</h1><p>SOAPdenovoå¯ä»¥ä¸€æ­¥è·‘å®Œï¼Œä¹Ÿå¯ä»¥åˆ†æˆå››æ­¥å•ç‹¬è·‘<br><font color="green"><strong>ä¸€æ­¥è·‘å®Œè„šæœ¬:</strong></font><br>.&#x2F; SOAPdenovo <font color="red"><strong>all</strong></font> <strong>-s</strong> lib.cfg <strong>-K</strong> 29 <strong>-D</strong> 1 <strong>-o</strong> ant &gt;&gt;ass.log<br><font color="green"><strong>å››æ­¥å•ç‹¬è·‘çš„è„šæœ¬</strong></font><br>.&#x2F; SOAPdenovo <font color="red"><strong>pregraph</strong></font> <strong>-s</strong> lib.cfg <strong>-d</strong> 1  <strong>-K</strong> 29 <strong>-o</strong> ant &gt;pregraph.log<br>.&#x2F; SOAPdenovo <font color="red"><strong>contig</strong></font> <strong>-g</strong> ant <strong>-D</strong> 1 <strong>-M</strong> 3 &gt;contig.log<br>.&#x2F; SOAPdenovo <font color="red"><strong>map</strong></font> <strong>-s</strong> lib23.cfg <strong>-g</strong> ant &gt;map.log<br>.&#x2F; SOAPdenovo <font color="red"><strong>scaff</strong></font> <strong>-g</strong> ant <strong>-F</strong> &gt;scaff.log</p><h1 id="å‚æ•°è¯´æ˜"><a href="#å‚æ•°è¯´æ˜" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h1><p>ç”¨æ³•ï¼š&#x2F;PathToProgram&#x2F;SOAPdenovo all -s configFile [-K kmer -d KmerFreqCutOff -D EdgeCovCutoff -M mergeLevel -R -u -G gapLenDiff -L minContigLen -p n_cpu] -o Output</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh">-s    STR     é…ç½®æ–‡ä»¶âˆš<br>-o    STR     å›¾å½¢è¾“å‡ºçš„æ–‡ä»¶åå‰ç¼€ âˆš<br>-g    STR     è¾“å…¥æ–‡ä»¶çš„æ–‡ä»¶åå‰ç¼€<br>-K    INT     è¾“å…¥çš„K-merå€¼å¤§å°ï¼Œé»˜è®¤å€¼23ï¼Œå–å€¼èŒƒå›´ 13-63 âˆš<br>-p    INT     ç¨‹åºè¿è¡Œæ—¶è®¾å®šçš„cpuçº¿ç¨‹æ•°ï¼Œé»˜è®¤å€¼8<br>-R            <span class="hljs-string">&quot;åˆ©ç”¨readé‰´åˆ«çŸ­çš„é‡å¤åºåˆ—ï¼Œé»˜è®¤å€¼ä¸è¿›è¡Œæ­¤æ“ä½œ&quot;</span> âˆš<br>-d    INT     å»é™¤é¢‘æ•°ä¸å¤§äºè¯¥å€¼çš„k-merï¼Œé»˜è®¤å€¼ä¸º0;<span class="hljs-string">&quot;æœ€å°åŒ–é”™è¯¯æµ‹åºå¸¦æ¥çš„å½±å“&quot;</span> âˆš<br>-D    INT     å»é™¤é¢‘æ•°ä¸å¤§äºè¯¥å€¼çš„ç”±k-merè¿æ¥çš„è¾¹ï¼Œé»˜è®¤å€¼ä¸º1ï¼Œå³è¯¥è¾¹ä¸Šæ¯ä¸ªç‚¹çš„é¢‘æ•°éƒ½å°äºç­‰äº1æ—¶æ‰å»é™¤,æœ€å°åŒ–é”™è¯¯æµ‹åºå¸¦æ¥çš„å½±å“ ?<br>-M    INT     è¿æ¥contigæ—¶åˆå¹¶ç›¸ä¼¼åºåˆ—çš„ç­‰çº§(å¼ºåº¦)ï¼Œé»˜è®¤å€¼ä¸º1ï¼Œæœ€å¤§å€¼3ã€‚<br>-F            åˆ©ç”¨<span class="hljs-built_in">read</span>å¯¹scaffoldä¸­çš„gapè¿›è¡Œå¡«è¡¥ï¼Œé»˜è®¤ä¸æ‰§è¡Œ<br>-u            æ„å»ºscaffoldå‰ä¸å±è”½é«˜è¦†ç›–åº¦çš„contigï¼Œè¿™é‡Œé«˜é¢‘ç‡è¦†ç›–åº¦æŒ‡å¹³å‡contigè¦†ç›–æ·±åº¦çš„2å€ã€‚é»˜è®¤å±è”½<br>-G    INT     ä¼°è®¡gapçš„å¤§å°å’Œå®é™…è¡¥gapçš„å¤§å°çš„å·®å¼‚ï¼Œé»˜è®¤å€¼ä¸º50bpã€‚<br>-L            ç”¨äºæ„å»ºscaffoldçš„contigçš„æœ€çŸ­é•¿åº¦ï¼Œé»˜è®¤ä¸ºï¼šKmerå‚æ•°å€¼ Ã—2<br></code></pre></td></tr></table></figure><p><font color="blue"><strong>å…¨å±€é…ç½®</strong></font></p><p><code>max_rd_len</code></p><p><font color="blue"><strong>æ–‡åº“é…ç½®</strong></font></p><p>æ¯ä¸ªæ–‡åº“çš„é…ç½®ä»¥<code>[LIB]</code>å¼€å¤´ï¼Œä¸»è¦æŒ‡å®šè¾“å…¥æ–‡ä»¶çš„è·¯å¾„ï¼Œæ”¯æŒå¤šç§æ ¼å¼çš„è¾“å…¥æ–‡ä»¶ï¼Œç”¨ä¸åŒçš„å‰ç¼€è¡¨ç¤ºï¼Œ <code>q</code>ä»£è¡¨è¾“å…¥åºåˆ—ä¸ºfastqæ ¼å¼ï¼›<code>f</code>ä»£ç¬”è¾“å…¥åºåˆ—ä¸ºfastaæ ¼å¼ï¼Œ<code>b</code>ä»£è¡¨è¾“å…¥æ–‡ä»¶ä¸ºbamæ ¼å¼ï¼Œå¯¹äºåŒç«¯æ•°æ®ï¼Œåˆ†åˆ«ç”¨åç¼€<code>1</code>å’Œ<code>2</code>è¡¨ç¤ºR1ç«¯å’ŒR2ç«¯çš„readsã€‚</p><p><font color="blue"><strong>ä¸»è¦å‚æ•°</strong></font></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh">-avg_ins    This value indicates the average insert size of this library or the peak value position <span class="hljs-keyword">in</span> the <span class="hljs-string">&quot;insert size distribution figure?&quot;</span>. <span class="hljs-comment">#æ–‡åº“å¹³å‡æ’å…¥é•¿åº¦(æˆ–å–æ’å…¥å¤§å°åˆ†å¸ƒå›¾ä¸­çš„å³°å€¼ä½ç½®)ï¼Œæ ¹æ®å»ºåº“æƒ…å†µè®¾ç½®ã€‚ </span><br><br>-reverse_seq    This option takes value 0 or 1. It tells the assembler <span class="hljs-keyword">if</span> the <span class="hljs-built_in">read</span> sequences need to be complementarily reversed. Illumima GA produces two types of paired-end libraries: a) <span class="hljs-string">&quot;forward-reverse&quot;</span>, generated from fragmented DNA ends with typical <span class="hljs-string">&quot;insert size less than 500 bp&quot;</span>; b) <span class="hljs-string">&quot;reverse-forward&quot;</span>, generated from <span class="hljs-string">&quot;circularizing libraries&quot;</span> with typical <span class="hljs-string">&quot;insert size greater than 2 Kb&quot;</span>. The parameter <span class="hljs-string">&quot;reverse_seq&quot;</span> should be <span class="hljs-built_in">set</span> to indicate this: 0, forward-reverse; 1, reverse-forward. <br><br>-asm_flags    This indicator decides <span class="hljs-keyword">in</span> <span class="hljs-built_in">which</span> part(s) the reads are used. It takes value 1(only contig assembly), 2 (only scaffold assembly), <span class="hljs-string">&quot;3(both contig and scaffold assembly)&quot;</span><span class="hljs-string">&quot;, or 4 (only gap closure). </span><br><span class="hljs-string"></span><br><span class="hljs-string">-rd_len_cutof    The assembler will &quot;</span><span class="hljs-built_in">cut</span> the reads from the current library to this length<span class="hljs-string">&quot;.</span><br><span class="hljs-string"></span><br><span class="hljs-string">-rank    It takes integer values and decides in which &quot;</span>order the reads are used <span class="hljs-keyword">for</span> scaffold assembly<span class="hljs-string">&quot;. Libraries with the same &quot;</span>rank<span class="hljs-string">&quot; are used at the same time during scaffold assembly.</span><br><span class="hljs-string"></span><br><span class="hljs-string">-pair_num_cutoff    This parameter is the cutoff value of pair number for a &quot;</span>reliable connection<span class="hljs-string">&quot; between two contigs or pre-scaffolds. The minimum number for &quot;</span>paired-end reads and mate-pair reads is 3 and 5 respectively<span class="hljs-string">&quot;. </span><br><span class="hljs-string"></span><br><span class="hljs-string">-map_len    This takes effect in the &quot;</span>map<span class="hljs-string">&quot; step and is the minimun alignment length between a read and a contig required for a reliable read location. The minimum length for &quot;</span>paired-end reads and mate-pair reads is 32 and 35 respectively<span class="hljs-string">&quot;.</span><br></code></pre></td></tr></table></figure><p><font color="blue"><strong>å®ä¾‹</strong></font></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs sh">max_rd_len=100<br>[LIB]<br><span class="hljs-comment">#avg_ins æ–‡åº“æ’å…¥ç‰‡æ®µçš„å¹³å‡é•¿åº¦ï¼Œåœ¨å®é™…è®¾ç½®æ—¶ï¼Œå¯ä»¥å‚è€ƒæ–‡åº“sizeåˆ†å¸ƒå›¾ï¼Œå–å³°å€¼å³å¯???</span><br>avg_ins=200<br><span class="hljs-comment">#reverse_seq æ˜¯å¦éœ€è¦å°†åºåˆ—åå‘äº’è¡¥ï¼Œpair-endæ•°æ®ï¼Œä¸éœ€åå‘äº’è¡¥ï¼Œè®¾ç½®ä¸º0ï¼›mate-pairéœ€è¦è®¾ç½®ä¸º1</span><br>reverse_seq=0<br><span class="hljs-comment">#asm_flags 1åªç»„è£…contig. 2åªç»„è£…scaffold,3åŒæ—¶ç»„è£…contigå’Œscaffold,4åªè¡¥gap</span><br>asm_flags=3<br><span class="hljs-comment">#åºåˆ—é•¿åº¦é˜ˆå€¼ï¼Œä½œç”¨å’Œmax_rd_lenç›¸åŒï¼Œå¤§äºè¯¥é•¿åº¦çš„åºåˆ—ä¼šè¢«åˆ‡é™¤åˆ°è¯¥é•¿åº¦</span><br>rd_len_cutoff=100<br><span class="hljs-comment">#è®¾ç½®ä¸åŒæ–‡åº“æ•°æ®çš„ä¼˜å…ˆçº§é¡ºåºï¼Œå–å€¼èŒƒå›´ä¸ºæ•´æ•°ï¼Œrankå€¼ç›¸åŒçš„å¤šä¸ªæ–‡åº“ï¼Œåœ¨ç»„è£…scaffoldæ—¶ï¼Œä¼šåŒæ—¶ä½¿ç”¨ã€‚</span><br>rank=1<br>q1=fastq1_read_1.fq<br>q2=fastq1_read_2.fq<br>-pair_num_cutoff<br><span class="hljs-comment">#contigæˆ–è€…scaffoldä¹‹å‰çš„æœ€å°overlapä¸ªæ•°ï¼Œpair-endæ•°æ®é»˜è®¤ä¸º3ï¼›mate-pairdæ•°æ®é»˜è®¤ä¸º5</span><br>-map_len<br><span class="hljs-comment">#æ¯”å¯¹é•¿åº¦çš„æœ€å°é˜ˆå€¼ï¼Œpair-endæ•°æ®é»˜è®¤ä¸º32ï¼›mate-pairæ•°æ®é»˜è®¤ä¸º35</span><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">SOAPdenovo-63mer all -s config_file -K 63 -R -o graph_prefix<br></code></pre></td></tr></table></figure><h1 id="ä½¿ç”¨æ–¹æ³•åŠç¤ºä¾‹"><a href="#ä½¿ç”¨æ–¹æ³•åŠç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨æ–¹æ³•åŠç¤ºä¾‹"></a>ä½¿ç”¨æ–¹æ³•åŠç¤ºä¾‹</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#ï¼ˆ1ï¼‰ç¤ºä¾‹</span><br>SOAPdenovo all -s HCB.lib -K 25 -d -o <span class="hljs-built_in">test</span><br><span class="hljs-comment">#ï¼ˆ2ï¼‰é…ç½®æ–‡ä»¶ configFile</span><br><span class="hljs-comment">#maximal read length ï¼ˆreadçš„æœ€å¤§é•¿åº¦ï¼‰ï¼Œè¯¥å€¼ã€ä¸€èˆ¬è®¾ç½®çš„æ¯”å®é™…readè¯»é•¿ç¨å¾®çŸ­ä¸€äº›ï¼Ÿã€‘ï¼Œæˆªå»æµ‹åºæœ€åçš„éƒ¨åˆ†ï¼Œå…·ä½“é•¿åº¦çœ‹æµ‹åºè´¨é‡</span><br>max_rd_len=50    <br><br><span class="hljs-comment">#[LIB]æ–‡åº“ä¿¡æ¯ä»¥æ­¤å¼€å¤´</span><br><br>avg_ins=200<span class="hljs-comment">#?</span><br><br>reverse_seq=0<br><span class="hljs-comment">#åºåˆ—æ˜¯å¦éœ€åè½¬ï¼Œç›®å‰æµ‹åºæŠ€æœ¯ï¼Œæ’å…¥ç‰‡æ®µå¤§äºç­‰äº2kçš„é‡‡ç”¨äº†ç¯åŒ–ï¼Œå¯¹äºæ’å…¥é•¿åº¦å¤§äºç­‰äº2kæ–‡åº“ï¼Œåºåˆ—éœ€è¦åè½¬ï¼Œreverse_seqï¼1ï¼Œå°ç‰‡æ®µè®¾ä¸º0</span><br><br>asm_flags=3<br><span class="hljs-comment">#è¯¥æ–‡åº“ä¸­çš„readåºåˆ—åœ¨ç»„è£…çš„å“ªäº›è¿‡ç¨‹ï¼ˆcontig/scaff/fillï¼‰ä¸­ç”¨åˆ°</span><br><span class="hljs-comment">#çŸ­æ’å…¥ç‰‡æ®µ(&lt;2K)çš„è®¾ä¸º3ï¼ŒåŒæ—¶æ„å»ºcontigå’Œscaffoldï¼Œé•¿æ’å…¥ç‰‡æ®µ(&gt;=2k)è®¾ä¸º2ï¼Œä¸æ„å»ºcontigï¼Œåªæ„å»ºscaffoldï¼Œ454single é•¿readsåªç”¨äºè¡¥æ´ã€‚</span><br><br>rank=1<br><span class="hljs-comment">#è¯¥å€¼å–æ•´æ•°ï¼Œå†³å®šäº†readsç”¨äºæ„å»ºscaffoldçš„æ¬¡åºï¼Œå€¼è¶Šä½æ•°æ®è¶Šä¼˜å…ˆç”¨äºæ„å»ºscaffoldã€‚ã€ç›¸åŒrankçš„æ–‡åº“æ•°æ®ä¼šåŒæ—¶ç”¨äºç»„è£…scaffoldã€‘ã€‚ä¸€èˆ¬å°†çŸ­æ’å…¥ç‰‡æ®µè®¾ä¸º1ï¼›2kè®¾ä¸º2ï¼›5kè®¾ä¸º3ï¼›10kè®¾ä¸º4ï¼›å½“ã€æŸä¸ªæ¡£çš„æ•°æ®é‡è¾ƒå¤§ã€‘æ—¶å¯ä»¥å°†å…¶åˆ†ä¸ºå¤šä¸ªæ¡£ï¼ŒåŒæ ·å½“ã€æŸæ¡£æ•°æ®é‡ä¸è¶³å¤Ÿã€‘æ—¶ï¼Œå¯ä»¥å°†å¤šä¸ªæ¡£çš„æ•°æ®åˆåœ¨ä¸€èµ·æ„å»ºscaffold?ã€‚è¿™é‡Œè¯´çš„æ•°æ®é‡å¤Ÿä¸ä¸å¤Ÿæ˜¯ä»è¯¥æ¡£çš„æµ‹åºè¦†ç›–åº¦å’Œç‰©ç†è¦†ç›–åº¦ä¸¤ä¸ªæ–¹é¢è€ƒè™‘ã€‚</span><br><br>pair_num_cutoff=3<br><span class="hljs-comment">#ã€å¯é€‰å‚æ•°ã€‘ï¼Œè¯¥å‚æ•°è§„å®šè¿æ¥ä¸¤ä¸ªcontig æˆ–è€…æ˜¯pre-scaffold çš„å¯ä¿¡è¿æ¥çš„é˜ˆå€¼ï¼Œå½“è¿æ¥æ•°å¤§äºè¯¥å€¼ï¼Œè¿æ¥æ‰ç®—æœ‰æ•ˆã€‚çŸ­æ’å…¥ç‰‡æ®µ(&lt;2k)é»˜è®¤å€¼ä¸º3ï¼Œé•¿æ’å…¥é•¿åº¦åºåˆ—é»˜è®¤å€¼ä¸º5</span><br><br>map_len=32<br><span class="hljs-comment">#map_lenè¯¥å‚æ•°è§„å®šåœ¨mapè¿‡ç¨‹ä¸­ readså’Œcontigçš„æ¯”å¯¹é•¿åº¦å¿…é¡»è¾¾åˆ°è¯¥å€¼ï¼ˆæ¯”å¯¹ä¸å®¹mismacthå’Œgapï¼‰ï¼Œè¯¥æ¯”å¯¹æ‰èƒ½ä½œä¸ºä¸€ä¸ªå¯ä¿¡çš„æ¯”å¯¹ã€‚å¯é€‰å‚æ•°ï¼ŒçŸ­æ’å…¥ç‰‡æ®µ(&lt;2k)ä¸€èˆ¬è®¾ç½®ä¸º32ï¼Œé•¿æ’å…¥ç‰‡æ®µè®¾ç½®ä¸º35ï¼Œé»˜è®¤å€¼æ˜¯Kï¼‹2ã€‚</span><br><br>q1=/path/LIBNAMEA/fastq_read_1.fq<span class="hljs-comment">#read 1çš„fastq</span><br>q2=/path/LIBNAMEA/fastq_read_2.fq<span class="hljs-comment">#read 2çš„fastqã€æ³¨æ„é¡ºåºã€‘</span><br>f1=/path/LIBNAMEA/fasta_read_1.fa<span class="hljs-comment">#read 1çš„fa</span><br>f2=/path/LIBNAMEA/fasta_read_2.fa<br>q=/path/LIBNAMEA/fastq_read_single.fq<span class="hljs-comment">#å•å‘æµ‹åºfastq</span><br>f=/path/LIBNAMEA/fasta_read_single.fa<span class="hljs-comment">#å•å‘æµ‹åºfa</span><br>p=/path/LIBNAMEA/pairs_in_one_file.fa<span class="hljs-comment">#åŒå‘æµ‹åºä¸€ä¸ªfasta</span><br></code></pre></td></tr></table></figure><h1 id="è¾“å‡ºæ–‡ä»¶åŠè¯´æ˜"><a href="#è¾“å‡ºæ–‡ä»¶åŠè¯´æ˜" class="headerlink" title="è¾“å‡ºæ–‡ä»¶åŠè¯´æ˜"></a>è¾“å‡ºæ–‡ä»¶åŠè¯´æ˜</h1><p>SOAPdenovo åˆ†å››éƒ¨åˆ†åˆ«å¯¹åº”çš„è¾“å‡ºæ–‡ä»¶ï¼š<br>  â— pregraph  ç”Ÿæˆ7ä¸ªæ–‡ä»¶ *.kmerFreq  *.edge  *.preArc  *.markOnEdge  *.path  *.vertex  *.preGraphBasic<br>  â— contig       ç”Ÿæˆ4ä¸ªæ–‡ä»¶ <font color="red"> ***.contig**</font>  *.ContigIndex  *.updated.edge  *.Arc<br>  â— map          ç”Ÿæˆ3ä¸ªæ–‡ä»¶ *.readOnContig  *.peGrads  *.readInGap<br>  â— scaff          ç”Ÿæˆ6ä¸ªæ–‡ä»¶ *.newContigIndex  *.links  *.scaf  *.scaf_gap  <font color="red"> ***.scafSeq**</font>  *.gapSeq</p><p>*.kmerFreq             #æ¯è¡Œæ˜¾ç¤ºä¸€ä¸ªæ•°ï¼Œè¿™ä¸ªæ•°æ˜¯kmerå€¼å‡ºç°çš„é¢‘ç‡ç­‰äºè¡Œå·çš„kmerä¸ªæ•°ã€‚</p><p><font color="red"><em><strong>.contig</strong></font>ï¼šæ²¡æœ‰ä½¿ç”¨mate pair ä¿¡æ¯çš„contig sequences<br><font color="red"></em><strong>.scafSeq</strong></font>ï¼šfastaæ ¼å¼scaffoldåºåˆ—æ–‡ä»¶ï¼Œcontigä¹‹é—´çš„gapç”¨Nå¡«å……ï¼›<br><strong>å¯¹äºå¾—åˆ°çš„.scafSeqæ–‡ä»¶è¿˜éœ€è¦ç”¨<font color="red">GapCloser</font>å»åˆå¹¶å…¶ä¸­çš„gapï¼Œæœ€åçš„contigæ–‡ä»¶åˆ™æ˜¯å¯¹è¡¥æ´ä¹‹åçš„scaffoldæ–‡ä»¶é€šè¿‡æ‰“æ–­NåŒºçš„æ–¹æ³•å¾—åˆ°?</strong><br>ä»¥ä¸Šä¸¤ä¸ªæ–‡ä»¶æ˜¯ç»„è£…ç»“æœä¸­æœ€ä¸»è¦çš„è¾“å‡ºã€‚</p><p><font color="red"><em><strong>.scaf</strong></font>ï¼šåŒ…æ‹¬scaffoldä¸­contigçš„è¯¦ç»†ä¿¡æ¯ï¼›<br>åœ¨</em>*scaffoldè¡Œ<strong>ä¸­åŒ…æ‹¬scaffoldåå­—ã€contigé•¿åº¦å’Œè¯¥scaffoldé•¿åº¦ã€‚<br>åœ¨</strong>contigè¡Œ**åŒ…æ‹¬contigåå­—ã€contigåœ¨scaffoldä¸Šçš„èµ·å§‹ä½ç½®ã€æ­£åé“¾ã€é•¿åº¦å’Œcontigé—´çš„é“¾æ¥ä¿¡æ¯<br><font color="red"> *.links</font>ï¼šcontigé—´çš„pair-endè¿æ¥ä¿¡æ¯<br><font color="red"> *.readOnContig</font>ï¼šreadsåœ¨contigä¸Šçš„ä½ç½®<br><font color="red"> *.peGrads</font>ï¼š é€šè¿‡è°ƒæ•´æœ¬æ–‡ä»¶ä¸­å‚æ•°æ¥æ˜¾ç¤ºæ„å»ºscaffoldæ‰€ç”¨åˆ°çš„æ’å…¥ç‰‡æ®µåº“çš„ä¸ªæ•°ï¼Œæ€»å…±ç”¨åˆ°çš„readæ•°ï¼Œæœ€é•¿readï¼Œæ¯ä¸ªåº“å¯¹åº”çš„å“ªäº›readsï¼Œrankè®¾ç½®ï¼Œpair_num_cutoffè®¾ç½®ã€‚ä¾‹å¦‚ï¼š</p><blockquote><p>grads&amp;num: 10   522083934       70<br>323     104577616       1       3<br>334     180770522       1       3<br>345     226070520       1       3<br>486     361955834       2       3<br>2200    392088076       3       5<br>2290    422272580       3       5<br>2400    445522690       3       5<br>4870    475666064       4       5<br>9000    511030930       5       8<br>9110    522083934       5       5</p><p>è¯¥æ–‡ä»¶ä¸­å…±åˆ†æˆ4åˆ—ã€‚<strong>ç»„è£…çš„é…ç½®æ–‡ä»¶ä¸­æœ‰nä¸ªæ–‡åº“ï¼Œè¯¥æ–‡ä»¶åˆ™æœ‰n+1è¡Œï¼Œä¸”æŒ‰ç…§æ–‡åº“å¤§å°é¡ºåºæ’åˆ—ã€‚</strong><br><strong>ç¬¬1è¡Œ</strong>ï¼ŒäºŒä¸‰å››åˆ—åˆ†åˆ«æ˜¯æ‰€ç”¨æ–‡åº“æ•°ç›®ï¼Œreadsæ€»æ•°å’Œ<font color="red">ç»„è£…ä¸­ç”¨åˆ°çš„æœ€é•¿çš„readsé•¿åº¦ï¼Ÿ</font>ã€‚<br><strong>ç¬¬2è¡Œ</strong>ï¼Œå››åˆ—åˆ†åˆ«æ˜¯æ–‡åº“å¤§å°ï¼Œæ–‡åº“readsæ•°ç›®ï¼Œæ–‡åº“readsçš„rankç­‰çº§å’Œpair_num_cutoffã€‚<br><strong>ç¬¬3ï½n+1è¡Œ</strong>ï¼Œå››åˆ—åˆ†åˆ«æ˜¯æ–‡åº“å¤§å°ï¼Œæ–‡åº“readsæ•°ç›®åŠ ä¸Šå‰é¢æ–‡åº“ä¸­çš„readsæ€»æ•°ï¼Œæ–‡åº“readsçš„rankç­‰çº§pair_num_cutoffã€‚#contigæˆ–è€…scaffoldä¹‹å‰çš„æœ€å°overlapä¸ªæ•°ï¼Œpair-endæ•°æ®é»˜è®¤ä¸º3ï¼›mate-pairdæ•°æ®é»˜è®¤ä¸º5,è‹¥é…ç½®æ–‡ä»¶æ²¡è®¾ç½®pair_num_cutoffï¼Œå³ä½¿ç”¨é»˜è®¤å‚æ•°0ã€‚</p></blockquote><p><strong>å¯¹äºSOAPdenovoçš„æ¯ä¸ªæ­¥éª¤éƒ½æœ‰æ—¥å¿—æ–‡ä»¶è¾“å‡ºï¼Œè¦ä¿å­˜å¥½æ—¥å¿—æ–‡ä»¶ï¼Œæ—¥å¿—æ–‡ä»¶ä¸­åŒ…å«æœ‰å¾ˆå¤šæœ‰ç”¨çš„ä¿¡æ¯ã€‚</strong></p><p>SOAPdenovoæ—¥å¿—è¾“å‡ºè¯´æ˜ï¼š</p><p>1ï¼‰<font color="red">pregraph.log</font>:  å…¶ä¸­æœ‰å¾ˆå¤šçš„ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ„å»ºdebruijn-graphæ‰€ç”¨readsæ•°ç›®ï¼Œæ„å›¾äº§ç”Ÿå¤šå°‘uniqçš„kmerä»¥åŠè®¾ç½®-då‚æ•°åå»é™¤äº†å¤šå°‘kmerã€‚</p><blockquote><p>-R            åˆ©ç”¨readé‰´åˆ«çŸ­çš„é‡å¤åºåˆ—ï¼Œé»˜è®¤å€¼ä¸è¿›è¡Œæ­¤æ“ä½œ</p><p>-d    INT     å»é™¤é¢‘æ•°ä¸å¤§äºè¯¥å€¼çš„k-merï¼Œé»˜è®¤å€¼ä¸º0</p></blockquote><p>åœ¨pregraphä¸­ï¼Œå¯é€‰å‚æ•°æœ‰ â€“R â€“K â€“d  ç»“æœå¦‚ï¼š<br>5467781332 <strong>nodes</strong> allocated, 70662750348 <strong>kmer</strong> <strong>in reads</strong>, 70662750348 <strong>kmer processed</strong><br>3283081670 <strong>kmer removed</strong><br>å…¶ä¸­Kmer æ•°å–å†³äºkå€¼å’Œæ•°æ®é‡ï¼Œnodesæ•°å³ç‰¹å¼‚æ€§kmeræ•°ï¼Œå½“nodesæ•°ç›®è¿‡é«˜<strong>ï¼ˆä¸€èˆ¬å’ŒåŸºå› ç»„å¤§å°å·®ä¸å¤šå¤§å°ï¼‰ï¼Œå¯èƒ½æ˜¯æ•°æ®çš„é”™è¯¯ç‡æ¯”è¾ƒé«˜ï¼Œä¹Ÿå¯èƒ½æ˜¯å­˜åœ¨æ‚åˆ</strong>ã€‚è‹¥nodesæ•°ç›®åå°ï¼Œä¸”kmeræ•°ç›®å¤šï¼Œåˆ™åŸºå› ç»„é‡å¤åº¦è¾ƒé«˜ã€‚</p><p>kå€¼çš„é€‰å–ï¼Œå½“æ•°æ®é‡å……è¶³ï¼ˆ&gt;&#x3D;40Xï¼‰ï¼Œ<strong>æ¤ç‰©åŸºå› ç»„ä¸€èˆ¬é‡‡ç”¨å¤§kmeræ•ˆæœè¾ƒå¥½</strong>ï¼Œè€Œ<strong>åŠ¨ç‰©åŸºå› ç»„kå€¼ä¸€èˆ¬å–27å’Œ29è¶³å¤Ÿ</strong>ã€‚kmer removedè¡¨ç¤ºçš„ <strong>â€“d å‚æ•°æ‰€å»é™¤çš„ä½é¢‘çš„kmer</strong>ã€‚</p><p>2ï¼‰<font color="red">contig.log</font>: contig ä¸­ï¼Œå¯é€‰å‚æ•° â€“R â€“D â€“Mï¼Œæ³¨ï¼Œ-R å‚æ•°çš„é€‰å®šï¼Œå¿…é¡»pregraphå’Œcontigä¸­åŒæ—¶é€‰æ‹©æ‰æœ‰æ•ˆã€‚</p><blockquote><p>-R            åˆ©ç”¨readé‰´åˆ«çŸ­çš„é‡å¤åºåˆ—ï¼Œé»˜è®¤å€¼ä¸è¿›è¡Œæ­¤æ“ä½œ</p></blockquote><p>ç»“æœä¾‹å­ï¼š<br>16430183 pairs found, 2334584 pairs of paths compared, 1674493 pairs merged<br><strong>mergedçš„æ•°é‡å¯ä½œä¸ºä¼°è®¡æ‚åˆä»¥åŠæµ‹åºé”™è¯¯çš„ç¨‹åº¦</strong>ã€‚<br>sum up 1932549703bp, with average length 1170<br>the longest is 36165bp, contig N50 is 2871 bp,contig N90 is 553 bp<br>ç›¸å…³ç»Ÿè®¡ä¿¡æ¯ï¼Œé€šå¸¸<strong>æ¤ç‰©åŸºå› ç»„çš„contig N90åœ¨200bpå·¦å³</strong>ï¼Œè‹¥<strong>N90é«˜äº200bpåˆ™è¯¥åŸºå› ç»„scaffoldæ„å»ºä¸ä¼šæœ‰å¤ªå¤§é—®é¢˜</strong>ã€‚åŠ¨ç‰©åŸºå› ç»„scaffoldæ„å»ºå¾ˆå°‘æœ‰å‡ºé—®é¢˜çš„ã€‚</p><p>3ï¼‰<font color="red">map.log</font>:<br>Output 415219610 out of 1956217742 (21.2)% reads in gaps<br><strong>1661094582 out of 1956217742 (84.9)% reads mapped to contigs</strong><br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œreads in gapæ¯”ä¾‹å’Œmap to contig æ¯”ä¾‹<strong>æ€»å’Œå¤§äº1ï¼ˆ21.2%+84.9%ï¼‰</strong>ã€‚å› ä¸ºreads mapåˆ°å¤šä¸ªåœ°æ–¹éƒ½è¢«ç»Ÿè®¡ã€‚å½“map to contigçš„æ¯”ä¾‹å¾ˆé«˜ï¼ˆ80%å·¦å³æ—¶ï¼‰ï¼Œä½†ç»„è£…æ•ˆæœä¸å¥½å¯èƒ½æ˜¯é‡å¤åºåˆ—è¾ƒå¤šã€‚reads in gapæ¯”ä¾‹è¾ƒé«˜ï¼ˆå¤§äº40%ï¼‰æ˜¯å› ä¸ºåŸºå› ç»„ç»„è£…çš„è¾ƒç¢gapåŒºåŸŸè¾ƒå¤šã€‚<br>map_len é»˜è®¤å€¼&#x3D;K+5ï¼ŒçŸ­æ’å…¥ç‰‡æ®µ(&lt;2k)ä¸€èˆ¬è®¾ç½®ä¸º32ï¼Œé•¿æ’å…¥ç‰‡æ®µä¸º35ã€‚å–å€¼ä¸ºmax{K+5,map_len}</p><p>4ï¼‰<font color="red">scaff.log</font>:<br>average contig coverage is 23, 5832270 contig masked<br>æ„å»ºscaffoldæ˜¯å¯¹é«˜é¢‘è¦†ç›–çš„contigè¿›è¡Œå±è”½ï¼ˆå³<strong>é¢‘ç‡é«˜äºaverage contig coverageçš„ä¸¤å€çš„contigä¸ç”¨äºæ„å»ºscaffold(average-dep 2å€ä»¥ä¸Šrepeat sequences)?<strong>ï¼‰ï¼Œä»è¿™é‡Œå¯ä»¥çœ‹å‡ºç»„è£…çš„åŸºå› ç»„ä¸€å®šçš„é‡å¤æƒ…å†µã€‚<br><strong>estimated PE size 162</strong>, by 40034765 pairs<br>on contigs longer than 173, 38257479 pairs found,SD&#x3D;8, insert_size estimated: 163<br><font color="green"><strong>173 æ˜¯é…ç½®æ–‡ä»¶æ–‡åº“insertsize</strong></font>ï¼Œ<font color="green"><strong>163 æ˜¯reads  mapåˆ°contigä¸Šçš„è·ç¦»çš„ä¼°è®¡å€¼</strong></font>ï¼Œ8æ˜¯åˆ†å¸ƒæ ‡å‡†åå·®ã€‚ä¸€èˆ¬è€ƒè™‘æ¯”å¯¹ä¸Šå»çš„pairæ•°ç›®å’ŒSDå€¼ã€‚è‹¥pairå¯¹æ•°å¾ˆå¤šä¸”SDå€¼å¾ˆå°ï¼Ÿï¼ˆå°ç‰‡æ®µæ–‡åº“æ•°æ®ä¸è¶…è¿‡ä¸‰ä½æ•°ï¼Œå¤§ç‰‡æ®µæ–‡åº“æ•°æ®ä¸è¶…è¿‡500ï¼‰ï¼Œ<font color="green">ä¸€èˆ¬å¯å°†é…ç½®æ–‡ä»¶ä¸­</strong>æ–‡åº“æ’å…¥ç‰‡æ®µå€¼ä¿®æ”¹</strong>ä¸ºå¯¹çŸ­æ’å…¥ç‰‡æ®µæ–‡åº“ï¼ˆ&lt;1kï¼‰çš„å¤§å°<strong>ä¼°è®¡å€¼<strong>ï¼Œä¸‹æ¬¡</strong>ç»„è£…<strong>ä»¥åŠ</strong>è¡¥æ´<strong>æ—¶åº”æ ¹æ®ä¼°è®¡å€¼å¯¹åŸé…ç½®æ–‡ä»¶ä¸­çš„</strong>insertsizeä¿®æ­£**</font>ã€‚å¯¹äºå¤§ç‰‡æ®µæ–‡åº“ï¼ˆ&gt;&#x3D;2Kï¼‰ï¼Œå› ä¸ºæ˜¯æŠŠreads mapåˆ°contigä¸Šï¼Œè‹¥æœ€é•¿contigè¾ƒçŸ­ï¼Œå¯èƒ½æ‰¾ä¸åˆ°æˆpairæ¯”å¯¹ä¸Šå»çš„readsï¼Œæ— æ³•ä¼°è®¡æ–‡åº“å¤§å°ï¼Œéœ€è¦è‡ªå·±å°†å¤§ç‰‡æ®µä¸€çº§ä¸€çº§çš„mapåˆ°å‰ä¸€çº§çš„ç»„è£…ç»“æœä¸Šï¼Œç„¶åå†åˆ†æå¤§ç‰‡æ®µæ–‡åº“çš„æ’å…¥ç‰‡æ®µå¤§å°ã€‚æ³¨ï¼Œ</strong>éœ€è¦è°ƒæ•´insertsizeæ—¶ï¼Œåªéœ€ä¿®æ”¹* .peGradsæ–‡ä»¶ä¸­ç¬¬ä¸€åˆ—ï¼Œååˆ é™¤*.linksæ–‡ä»¶ï¼Œé‡è·‘scaffå³å¯*<em>ã€‚å³æ„å»ºscaffoldæ—¶ï¼Œä¸»è¦æ˜¯æ ¹æ®</em>.linksæ–‡ä»¶çš„ä¿¡æ¯è¿›è¡Œè¿æ¥ã€‚<br>Cutoff for number of pairs to make a reliable connection: 3<br>1124104 weak connects removed (there were 4773564 active cnnects))<br>Cutoff for numberæ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾çš„pair_num_cutoffå€¼ï¼Œweak connectsæ˜¯ä½äºè¿™ä¸ªå€¼è¢«è®¤å®šä¸ºæ— æ•ˆçš„è¿æ¥æ•°ï¼Œactive connectsæ˜¯æ»¡è¶³cutoffçš„è¿æ¥æ•°ï¼Œæ ¹æ®è¿™ä¸ªæ•°å€¼å¯å¯¹pair_num_cutoffåšè°ƒæ•´<br>Picked  25241 subgraphs,4 have conflicting connections<br>conflicting connections æ˜¯è¡¨ç¤ºæ„å»ºscaffoldæ—¶çš„çŸ›ç›¾æ•°ï¼ŒçŸ›ç›¾æ•°æ¯”è¾ƒé«˜ï¼ˆ&gt;100ï¼‰æ—¶ï¼Œå¯æ ¹æ®å‰é¢çš„æœ‰æ•ˆè¿æ¥æ•°ï¼Œé€‚å½“æé«˜pair_num_cutoffå€¼ï¼Œå³æé«˜scaffoldè¿æ¥è¦æ±‚çš„æœ€å°‘å…³ç³»æ•°<br>182483 scaffolds&amp;singleton sum up 1990259817bp, with average length 10906<br>the longest is 6561520bp,scaffold N50 is 836795 bp, scaffold N90 is 157667 bp<br>scaffold ç»Ÿè®¡ä¿¡æ¯ï¼Œå°†æ˜¯æ ¹æ®rankåˆ†æ¢¯åº¦çš„ç»Ÿè®¡<br>Done with 13301 scaffolds, 2161915 gaps finished, 2527441 gaps overall<br><strong>-F å‚æ•°è¡¥æ´çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</strong></p><blockquote><p>å‘ç°scafstatistics æ–‡ä»¶ä¸­çš„sca N50æ˜¯æ•´ä¸ªscafSeqæ–‡ä»¶ä¸­çš„N50ï¼ˆåŒ…æ‹¬ä¸å­˜åœ¨äºscafå†…çš„contigï¼‰ã€‚logæ–‡ä»¶ä¸­çš„sca N50åªåŒ…æ‹¬scaf ä¸­çš„N50.</p><p>sacf.seqä¸­å¯èƒ½æœ‰Nï¼Œä¹Ÿå¯èƒ½æ— Nã€‚å¤§éƒ¨åˆ†æœ‰</p><p>gap finishï¼Ÿ</p></blockquote><h1 id="å‚æ•°è°ƒæ•´"><a href="#å‚æ•°è°ƒæ•´" class="headerlink" title="å‚æ•°è°ƒæ•´"></a>å‚æ•°è°ƒæ•´</h1><p>ç»„è£…æ—¶éœ€è°ƒæ•´çš„å‚æ•°ï¼Œä¸»è¦åˆ†ä¸¤ç§ï¼š</p><p>ä¸€ç§æ˜¯è„šæœ¬ä¸­å‚æ•°æ”¹åŠ¨ï¼šå¦‚è°ƒæ•´  -K  -R  -d  -D  -M<br>-K å€¼ä¸€èˆ¬ä¸åŸºå› ç»„çš„ç‰¹æ€§å’Œæ•°æ®é‡ç›¸å…³ï¼Œç›®å‰ç”¨åˆ°çš„SOAPdenovoè½¯ä»¶ä¸»è¦æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼ŒSOAPdenovo-63meræ˜¯å¯ä½¿ç”¨å¤§kmerç»„è£…ï¼ŒKå€¼èŒƒå›´13-63ã€‚<br>ã€<strong>ç»éªŒ</strong>ã€‘ï¼šæ¤ç‰©åŸºå› ç»„ç»„è£…é‡‡ç”¨å¤§kmeræ•ˆæœä¼šæ¯”è¾ƒå¥½ï¼ˆè¦æ±‚çŸ­ç‰‡æ®µreadsé•¿åº¦75bpï¼‰ï¼ŒåŠ¨ç‰©åŸºå› ç»„å¾ˆå°‘æœ‰ç”¨åˆ°å¤§kmeråæœ‰æ˜æ˜¾æ”¹è¿›æ•ˆæœçš„ï¼Œä¸”<strong>åŠ¨ç‰©åŸºå› ç»„ç»„è£…Kå€¼ä¸€èˆ¬è®¾ç½®ä¸º27å’Œ29è¾ƒå¤š</strong>ã€‚</p><p><font color="red"><strong>ç»„è£…æ‚åˆå­åŸºå› ç»„çš„K-merå€¼åº”è¯¥å°ä¸€ç‚¹ï¼›ç»„è£…å«æœ‰é«˜repeatsåŸºå› ç»„ä¸”è¦æ±‚å…¶æœ‰é«˜çš„æµ‹åºæ·±åº¦å’Œé•¿çš„reads,çš„K-meråº”è¯¥å¤§ä¸€ç‚¹ã€‚</strong></font></p><p>-Rå‚æ•°ï¼Œå¯¹äº<font color="green">åŠ¨ç‰©åŸºå› ç»„Rå‚æ•°ä¸€èˆ¬ä¸è®¾ç½®</font>ï¼Œ<font color="red"><strong>æ¤ç‰©åŸºå› ç»„</strong>ç”±äº<strong>è¾ƒå¤šçš„repeatåŒº</strong>åˆ™<strong>è®¾ç½®Rå‚æ•°</strong>åæ•ˆæœæ›´å¥½</font>ã€‚æ³¨æ„<strong>è®¾ç½®-Ræ—¶ï¼Œä¸€èˆ¬ä½¿ç”¨-M çš„é»˜è®¤å€¼</strong>ã€‚ï¼ˆç†ŠçŒ«åŸºå› ç»„ç»„è£…æ—¶å¾—å‡ºçš„ç»“è®ºï¼‰</p><p>-M å‚æ•°ï¼Œ0-3,<strong>é»˜è®¤å€¼1</strong>ã€‚ä¸€èˆ¬æ‚åˆç‡ä¸ºåƒåˆ†ä¹‹å‡ å°±è®¾ä¸ºå‡ ã€‚ç†ŠçŒ«åŸºå› ç»„ç»„è£…æ—¶-M 2 ã€‚</p><p>-d å‚æ•°ï¼Œå¯¹äºæ²¡æœ‰çº é”™ï¼Œæ²¡æœ‰å¤„ç†çš„è´¨é‡åˆè¾ƒå·®çš„åŸå§‹æ•°æ®ï¼Œkmeré¢‘æ•°ä¸º1æ•°æ®è¾ƒå¤šçš„ç»„è£…ï¼Œ<font color="red"><strong>è®¾ç½®ä¸º-d 1 è¶³å¤Ÿ</strong></font>ã€‚å¯¹äºå¤„ç†è¿‡æˆ–æ˜¯æµ‹åºè´¨é‡è¾ƒå¥½æ•°æ®å¯ä¸è®¾ç½®ã€‚æ•°æ®é‡è¾ƒå¤šæ—¶ï¼Œä¹Ÿå¯è®¾ç½®-d å»é™¤éƒ¨åˆ†è´¨é‡ç¨å·®æ•°æ®ã€‚</p><p>-D å‚æ•°ï¼Œé»˜è®¤ä¸º1ï¼Œä¸€èˆ¬ä¸ç”¨å¦è¡Œè®¾ç½®ã€‚</p><p>ç¬¬äºŒç§ï¼Œä»<strong>map</strong>è¿‡ç¨‹å»è°ƒèŠ‚å‚æ•°ã€‚å¯ä»¥<font color="red"> è°ƒæ•´é…ç½®æ–‡ä»¶map_lençš„å€¼å’Œè°ƒæ•´æ–‡ä»¶ * .peGrads  </font>ã€‚<br>å½“<strong>æ–‡åº“æ’å…¥ç‰‡æ®µåˆ†å¸ƒå›¾</strong>ä¸­æ–‡åº“å¤§å°ä¸<strong>å®éªŒç»™å‡ºçš„æ–‡åº“å¤§å°</strong><font color="red">å·®å¼‚å¾ˆå¤§</font>ï¼Œ<font color="red"><em><em>è°ƒæ•´</em>.peGrad</em>*s</font>æ–‡ä»¶ä¸­çš„æ’å…¥ç‰‡æ®µå¤§å°ã€‚</p><p>æ ¹æ®æ¯ä¸€æ¡£æ•°æ®çš„æ•°æ®é‡å»è°ƒæ•´æ–‡åº“çš„<strong>rankç­‰çº§</strong>ã€‚</p><p>å½“è¯¥æ–‡åº“çš„æ•°æ®é‡å¾ˆå¤šæˆ–è€…æ˜¯åœ¨æ„å»ºscaffoldçš„è¿‡ç¨‹ä¸­çš„å†²çªæ•°å¾ˆå¤šæ—¶ï¼Œå¯æ˜¯é€‚å½“çš„è°ƒå¤§ç¬¬å››åˆ—çš„<strong>pair_num_cutoff</strong>ï¼ŒæŠŠæ¡ä»¶è®¾ç½®çš„æ›´ä¸¥ã€‚</p><h1 id="å†…å­˜ä¼°è®¡"><a href="#å†…å­˜ä¼°è®¡" class="headerlink" title="å†…å­˜ä¼°è®¡"></a>å†…å­˜ä¼°è®¡</h1><p>SOAPdenovoå››ä¸ªæ­¥éª¤æ¶ˆè€—çš„å†…å­˜ä¸ä¸€æ ·</p><p>ç¬¬ä¸€æ­¥æ¶ˆè€—å†…å­˜æœ€å¤šï¼Œä½¿ç”¨æ²¡æœ‰çº é”™çš„çš„readsï¼Œ(<font color="blue"> <strong>K&lt;&#x3D;31**</font>)ç¬¬ä¸€æ­¥æ¶ˆè€—çš„å†…å­˜åœ¨<font color="blue"><strong>åŸºå› ç»„å¤§å°80ï¼100å€</strong>å·¦å³</font>ï¼Œ<font color="blue">çº è¿‡é”™åœ¨</strong>40ï¼50å€**å·¦å³</font></p><p>ç¬¬äºŒæ­¥ç›¸å¯¹æ¶ˆè€—å†…å­˜ä¼šå°‘å¾ˆå¤š</p><p>ç¬¬ä¸‰æ­¥æ¶ˆè€—å†…å­˜ä»…æ¬¡äºç¬¬ä¸€æ­¥ï¼Œåœ¨ç¬¬ä¸€æ­¥çš„ä¸€åŠå·¦å³</p><p>ç¬¬å››æ­¥æ¶ˆè€—çš„å†…å­˜ä¹Ÿä¼šæ¯”è¾ƒå°‘</p><p>å¯¹äºCPUçš„ä½¿ç”¨ï¼Œé»˜è®¤æ˜¯8ä¸ªï¼Œå¦‚æœç”³è¯·å†…å­˜æ—¶ç”³è¯·ä¸€ä¸ªè®¡ç®—èŠ‚ç‚¹çš„æ‰€æœ‰å†…å­˜, CPUå°±è®¾ç½®ä¸ºè¯¥è®¡ç®—èŠ‚ç‚¹çš„CPUä¸ªæ•°å……åˆ†åˆ©ç”¨è®¡ç®—èµ„æºï¼Œå¦‚æœä»…ç”³è¯·ä¸€ä¸ªèŠ‚ç‚¹çš„éƒ¨åˆ†å†…å­˜åˆ™æ ¹æ®å®é™…æƒ…å†µè€ƒè™‘ã€‚</p><p>å¯¹äº<font color="blue"><strong>å¤§kemr(K&gt;31)</strong></font>å…¶å†…å­˜ä½¿ç”¨æ˜¯<font color="blue">**(k&lt;&#x3D;31)**</font>çš„<font color="blue"><strong>1.5å€</strong></font>å·¦å³ï¼Œæœ‰æ—¶ç”šè‡³æ›´å¤šï¼Œè¦å……åˆ†ä¼°è®¡å†…å­˜ä½¿ç”¨ï¼Œåœ¨ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶è€ƒè™‘ä¸èƒ½å¤ªä¿å®ˆã€‚</p><h1 id="å¸¸è§é”™è¯¯"><a href="#å¸¸è§é”™è¯¯" class="headerlink" title="å¸¸è§é”™è¯¯"></a>å¸¸è§é”™è¯¯</h1><p>1ï¼‰é…ç½®æ–‡ä»¶readså­˜å‚¨è·¯å¾„é”™è¯¯<br>åªè¾“å‡ºæ—¥å¿—æ–‡ä»¶ã€‚<br>pregraph.logä¸­çš„é”™è¯¯ä¿¡æ¯ï¼šâ€œCannot open &#x2F;path&#x2F;LIBNAMEA&#x2F;fastq_read_1.fq. Now exit to systemâ€¦â€<br>2ï¼‰-g åæ‰€è·Ÿå‚æ•°ä¸pregraphï¼ˆç¬¬ä¸€æ­¥ï¼‰ -o  åæ‰€è·Ÿå‚æ•°åä¸ä¸€è‡´ã€**-oå¯¹åº”åé¢çš„-g**ã€‘<br>contig  map  scaff è¿™ä¸‰ä¸ªæ­¥éª¤éƒ½åªæ˜¯è¾“å‡ºæ—¥å¿—æ–‡ä»¶ã€‚<br><font color="green">contig.log</font>é”™è¯¯ä¿¡æ¯ï¼šâ€œCannot open *.preGraphBasic. Now exit to systemâ€¦â€<br><font color="green">map.log</font>é”™è¯¯ä¿¡æ¯ï¼šâ€œCannot open *.contig. Now exit to systemâ€¦â€<br><font color="green">scaff.log</font>é”™è¯¯ä¿¡æ¯ï¼šâ€œCannot open *.preGraphBasic. Now exit to systemâ€¦â€<br>3ï¼‰<font color="blue">ä»mapå¼€å§‹é‡æ–°è·‘æ—¶ï¼Œéœ€è¦åˆ é™¤ *.linksæ–‡ä»¶</font>ï¼Œå¦åˆ™ä¼šç”Ÿæˆcoreæ–‡ä»¶ï¼Œç¨‹åºé€€å‡ºã€‚</p><hr><h1 id="Github-Readme-md"><a href="#Github-Readme-md" class="headerlink" title="Github-Readme.md"></a>Github-Readme.md</h1><h2 id="Configuration-file"><a href="#Configuration-file" class="headerlink" title="Configuration file"></a>Configuration file</h2><p>For big genome projects with deep sequencing, <font color="red">the data is usually organized as <strong>multiple read sequence files</strong> generated from <strong>multiple libraries</strong></font>. The configuration file: where? information? example.config</p><p>The configuration file has a section for <font color="red"><strong>global information</strong></font>, and then <font color="red"><strong>multiple library sections</strong></font>. Right now only â€œmax_rd_lenâ€ is included in the global information section. Any read longer than max_rd_len will be cut to this length.</p><p>The library information and the information of sequencing data generated from the library should be organized in the corresponding library section. <font color="red"><strong>Each library section starts with tag [LIB]</strong></font> and includes the following items:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">-avg_ins<br>-reverse_seq<br>-asm_flags<br>-rd_len_cutof<br>-rank<br>-pair_num_cutoff<br>-map_len<br></code></pre></td></tr></table></figure><p>The assembler accepts read file in three kinds of formats: <font color="green">FASTA, FASTQ and BAM</font>. Mate-pair relationship could be indicated in two ways: two sequence files with reads in the same order belonging to a pair, or two adjacent reads in a single file (FASTA only) belonging to a pair. If a read in <strong>bam</strong> file <strong>fails</strong> platform&#x2F;vendor <strong>quality checks</strong>(the flag field 0x0200 is set), itself and itâ€™s <strong>paired read</strong> would be <strong>ignored</strong>.</p><p>All the above items in each library section are optional. The assembler assigns default values for most of them. <strong>If you are not sure how to set a parameter, you can remove it from your configuration file</strong>.</p><h2 id="Get-started"><a href="#Get-started" class="headerlink" title="Get started"></a>Get started</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-string">&quot;one step&quot;</span><br>SOAPdenvo all -s config_file -K 63 -R -o graph_prefix 1&gt;ass.log 2&gt;ass.err<br><span class="hljs-comment">#-R            åˆ©ç”¨readé‰´åˆ«çŸ­çš„é‡å¤åºåˆ—ï¼Œé»˜è®¤å€¼ä¸è¿›è¡Œæ­¤æ“ä½œ</span><br><br><span class="hljs-comment">#step by step </span><br><span class="hljs-string">&quot;step1:&quot;</span><br>SOAPdenvo pregraph -s config_file -K 63 -R -o graph_prefix 1&gt;pregraph.log 2&gt;pregraph.err<br><span class="hljs-string">&quot;OR&quot;</span><br>SOAPdenvo sparse_pregraph -s config_file -K 63 -z 5000000000 -R -o graph_prefix 1&gt;pregraph.log 2&gt;pregraph.err<br><span class="hljs-comment">#-z genomize(required):estimated genome size</span><br><br><span class="hljs-string">&quot;step2:&quot;</span><br>SOAPdenvo contig -g graph_prefix -R 1&gt;contig.log 2&gt;contig.err<br><span class="hljs-comment">#-g    STR     è¾“å…¥æ–‡ä»¶çš„æ–‡ä»¶åå‰ç¼€</span><br><br><span class="hljs-string">&quot;step3:&quot;</span><br>SOAPdenvo map -s config_file -g graph_prefix 1&gt;map.log 2&gt;map.err<br><br><span class="hljs-string">&quot;step4:&quot;</span><br>SOAPdenvo scaff -g graph_prefix -F 1&gt;scaff.log 2&gt;scaff.err<br><span class="hljs-comment">#-F            åˆ©ç”¨readå¯¹scaffoldä¸­çš„gapè¿›è¡Œå¡«è¡¥ï¼Œé»˜è®¤ä¸æ‰§è¡Œ       </span><br></code></pre></td></tr></table></figure><h2 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h2><h3 id="Options-for-all-pregraph-contig-map-scaff"><a href="#Options-for-all-pregraph-contig-map-scaff" class="headerlink" title="Options for all (pregraph-contig-map-scaff)"></a>Options for all (<font color="red">pregraph-contig-map-scaff</font>)</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-string">&quot;-s&quot;</span>    configFile: the config file of solexa reads<br><span class="hljs-string">&quot;-o&quot;</span>     outputGraph: prefix of <span class="hljs-string">&quot;output graph file name&quot;</span><br><span class="hljs-string">&quot;-K&quot;</span>        kmer(min 13, max 63/127): kmer size, [23]<br><span class="hljs-string">&quot;-p&quot;</span>        n_cpu: number of cpu <span class="hljs-keyword">for</span> use, [8]<br><span class="hljs-string">&quot;-a?&quot;</span>        initMemoryAssumption: memory assumption initialized to avoid further reallocation, unit G, [0]<br><span class="hljs-string">&quot;-d&quot;</span>        KmerFreqCutoff: kmers with frequency no larger than KmerFreqCutoff will be deleted, [0]INT     å»é™¤é¢‘æ•°ä¸å¤§äºè¯¥å€¼çš„k-merï¼Œé»˜è®¤å€¼ä¸º0<br><span class="hljs-string">&quot;-R&quot;</span> (optional)  resolve repeats by reads, [NO]<br><span class="hljs-string">&quot;-D&quot;</span>        EdgeCovCutoff: edges with coverage no larger than EdgeCovCutoff will be deleted, [1]INT     å»é™¤é¢‘æ•°ä¸å¤§äºè¯¥å€¼çš„ç”±k-merè¿æ¥çš„è¾¹ï¼Œé»˜è®¤å€¼ä¸º1ï¼Œå³è¯¥è¾¹ä¸Šæ¯ä¸ªç‚¹çš„é¢‘æ•°éƒ½å°äºç­‰äº1æ—¶æ‰å»é™¤<br><span class="hljs-string">&quot;-M&quot;</span>        mergeLevel(min 0, max 3): the strength of merging similar sequences during contiging, [1]INT     è¿æ¥contigæ—¶åˆå¹¶ç›¸ä¼¼åºåˆ—çš„ç­‰çº§ï¼Œé»˜è®¤å€¼ä¸º1ï¼Œæœ€å¤§å€¼3ã€‚<br>-m        max k when using multi kmer<br>-e        weight to filter arc when linearize two edges(default 0)<br>-r (optional)  keep available <span class="hljs-built_in">read</span>(*.<span class="hljs-built_in">read</span>)<br>-E (optional)  merge clean bubble before iterate<br>-f (optional)  output gap related reads <span class="hljs-keyword">in</span> map step <span class="hljs-keyword">for</span> using SRkgf to fill gap, [NO]<br>-k        kmer_R2C(min 13, max 63): kmer size used <span class="hljs-keyword">for</span> mapping <span class="hljs-built_in">read</span> to contig, [K]<br>-F (optional)  fill gaps <span class="hljs-keyword">in</span> scaffold, [NO]åˆ©ç”¨<span class="hljs-built_in">read</span>å¯¹scaffoldä¸­çš„gapè¿›è¡Œå¡«è¡¥ï¼Œé»˜è®¤ä¸æ‰§è¡Œ<br>-u (optional)  un-mask contigs with high/low coverage before scaffolding, [mask]æ„å»ºscaffoldå‰ä¸å±è”½é«˜è¦†ç›–åº¦çš„contigï¼Œè¿™é‡Œé«˜é¢‘ç‡è¦†ç›–åº¦æŒ‡å¹³å‡contigè¦†ç›–æ·±åº¦çš„2å€ã€‚é»˜è®¤å±è”½<br>-w (optional)  keep contigs weakly connected to other contigs <span class="hljs-keyword">in</span> scaffold, [NO]<br>-G        gapLenDiff: allowed length difference between estimated and filled gap, [50]INT     ä¼°è®¡gapçš„å¤§å°å’Œå®é™…è¡¥gapçš„å¤§å°çš„å·®å¼‚ï¼Œé»˜è®¤å€¼ä¸º50bpã€‚<br>-L        minContigLen: shortest contig <span class="hljs-keyword">for</span> scaffolding, [K+2]ç”¨äºæ„å»ºscaffoldçš„contigçš„æœ€çŸ­é•¿åº¦ï¼Œé»˜è®¤ä¸ºï¼šKmerå‚æ•°å€¼ Ã—2<br>-c      minContigCvg: <span class="hljs-string">&quot;minimum contig coverage&quot;</span> (c*avgCvg), contigs shorter than 100bp with coverage smaller than c*avgCvg will be masked before scaffolding unless -u is <span class="hljs-built_in">set</span>, [0.1]<br>-C      maxContigCvg: <span class="hljs-string">&quot;maximum contig coverage&quot;</span> (C*avgCvg), contigs with coverage larger than C*avgCvg or contigs shorter than 100bp with coverage larger than 0.8*C*avgCvg will be masked before scaffolding unless -u is <span class="hljs-built_in">set</span>, [2]<br>-b      insertSizeUpperBound: (b*avg_ins) will be used as upper bound of insert size <span class="hljs-keyword">for</span> large insert size ( &gt; 1000) when handling pair-end connections between contigs <span class="hljs-keyword">if</span> b is <span class="hljs-built_in">set</span> to larger than 1, [1.5]<br>-B      bubbleCoverage: remove contig with lower cvoerage <span class="hljs-keyword">in</span> bubble structure <span class="hljs-keyword">if</span> both contigs<span class="hljs-string">&#x27; coverage are smaller than bubbleCoverage*avgCvg, [0.6]</span><br><span class="hljs-string">-N        genomeSize: genome size for statistics, [0]</span><br><span class="hljs-string">-V (optional)  output visualization information of assembly, [NO]</span><br></code></pre></td></tr></table></figure><h3 id="Options-for-sparse-pregraph"><a href="#Options-for-sparse-pregraph" class="headerlink" title="Options for sparse_pregraph"></a>Options for sparse_pregraph</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh">Usage: ./SOAPdenovo2 sparse_pregraph -s configFile -K kmer -z genomeSize -o outputGraph [-g maxKmerEdgeLength -d kmerFreqCutoff -e kmerEdgeFreqCutoff -R -r runMode -p n_cpu]<br>  -s      configFile: the config file of solexa reads<br>  -K         kmer(min 13, max 63/127): kmer size, [23]<br>  -g         maxKmerEdgeLength(min 1, max 25): number of skipped intermediate kmers, [15]<br>  <span class="hljs-string">&quot;-z&quot;</span>         genomeSize(mandatory): estimated genome size<br>  <span class="hljs-string">&quot;-d&quot;</span>         kmerFreqCutoff: delete kmers with frequency no larger than,[1]<br>  -e         kmerEdgeFreqCutoff: delete kmers<span class="hljs-string">&#x27; related edge with frequency no larger than [1]</span><br><span class="hljs-string">  -R (optional)   output extra information for resolving repeats in contig step, [NO]</span><br><span class="hljs-string">  -r         runMode: 0 build graph &amp; build edge and preArc, 1 load graph by prefix &amp; build edge and preArc, 2 build graph only, 3 build edges only, 4 build preArcs only [0]</span><br><span class="hljs-string">  &quot;-p&quot;         n_cpu: number of cpu for use,[8]</span><br><span class="hljs-string">  -o         outputGraph: prefix of output graph file name</span><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs sh">contigsï¼š<br>      -g  &lt;string&gt;      è¾“å…¥graph fileæ–‡ä»¶åå‰ç¼€ <br>    -R  (optional)    ç§»é™¤repeatsï¼Œä½¿ç”¨pregraphæ­¥éª¤ä¸­äº§ç”Ÿçš„ç»“æœï¼Œå¦‚æœå‚æ•°-Råœ¨pregraphæ­¥éª¤ä¸­è¢«è®¾ç½®çš„è¯ï¼Œé»˜è®¤[NO]<br>    -D  &lt;int&gt;         å»é™¤é¢‘æ•°ä¸å¤§äºè¯¥å€¼ï¼ˆedgeCovCutoffï¼‰çš„ç”±k-merè¿æ¥çš„è¾¹ï¼Œé»˜è®¤å€¼[1]ï¼Œå³è¯¥è¾¹ä¸Šæ¯ä¸ªç‚¹çš„é¢‘æ•°éƒ½å°äºç­‰äº1æ—¶æ‰å»é™¤ã€‚edges with coverage no larger than EdgeCovCutoff will be deleted, [1] <span class="hljs-comment">#æœ€å°åŒ–é”™è¯¯æµ‹åºå¸¦æ¥çš„å½±å“</span><br>    -M  &lt;int&gt;         åœ¨contigingæ“ä½œæ—¶ï¼Œåˆå¹¶ç›¸ä¼¼åºåˆ—çš„å¼ºåº¦ï¼Œé»˜è®¤å€¼ä¸º[1]ï¼Œæœ€å°å€¼0ï¼Œæœ€å¤§å€¼3ã€‚<span class="hljs-comment">#deal with heterozygosis</span><br>    -e  &lt;int&gt;         ä¸¤è¾¹ç¼˜ä¹‹é—´çš„å¼§çš„æƒé‡å¤§äºè¯¥å€¼ï¼ˆarcWeightï¼‰ï¼Œå°†è¢«çº¿æ€§åŒ–ï¼Œé»˜è®¤å€¼[0]<br>    -m  &lt;int&gt;         æœ€å¤§çš„kmer sizeï¼ˆmax 127ï¼‰ç”¨äºmulti-kmerï¼Œé»˜è®¤[NO]<br>    -E  (optional)    åœ¨iterateè¿­ä»£ä¹‹å‰ï¼Œåˆå¹¶clean bubbleåŠŸèƒ½ï¼Œä»…åœ¨å½“ä½¿ç”¨multi-kmeræ—¶ä¸”è®¾ç½®-Må‚æ•°ï¼Œé»˜è®¤[NO]<br> <br>mapï¼š<br>    -g  &lt;string&gt;      è¾“å…¥graph fileæ–‡ä»¶åå‰ç¼€ <br>    -k  &lt;int&gt;         è¯¥å€¼ï¼ˆkmer_R2Cï¼‰æ˜¯kmer sizeç”¨äºmapping readsåˆ°contigsä¸Šæ—¶çš„å€¼ï¼Œé»˜è®¤å€¼[K]<br>    -f  (optional)    åœ¨mapé‚£ä¸€æ­¥ä¸­ï¼Œå¯¹äºä½¿ç”¨SRkgfå»å¡«å……gapï¼Œè¾“å‡ºä¸gapç›¸å…³çš„reads,é»˜è®¤[NO]<br> <br>scaffoldï¼š<br>      -F  (optional)    åˆ©ç”¨<span class="hljs-built_in">read</span>å¯¹scaffoldä¸­çš„gapè¿›è¡Œå¡«è¡¥ï¼Œé»˜è®¤[NO]<br>    -u  (optional)    æ„å»ºscaffoldingå‰ä¸å±è”½é«˜/ä½è¦†ç›–åº¦çš„contigsï¼Œè¿™é‡Œé«˜é¢‘ç‡è¦†ç›–åº¦æŒ‡å¹³å‡contigè¦†ç›–æ·±åº¦çš„2å€ã€‚é»˜è®¤[mask]å±è”½<br>    -w  (optional)    åœ¨scaffoldä¸­ï¼Œä¿æŒcontigså¼±è¿æ¥äºå…¶ä»–contigsï¼Œé»˜è®¤[NO]<br>    -G  &lt;int&gt;         ä¼°è®¡gapçš„å¤§å°å’Œå®é™…è¡¥gapçš„å¤§å°çš„å·®å¼‚å€¼ï¼Œé»˜è®¤å€¼[50]bpã€‚<br>    -L  &lt;int&gt;         ç”¨äºæ„å»ºscaffoldçš„contigçš„æœ€çŸ­é•¿åº¦(minContigLen)ï¼Œé»˜è®¤ä¸ºï¼š[Kmerå‚æ•°å€¼+2]<br>    -c  &lt;<span class="hljs-built_in">float</span>&gt;       åœ¨scaffoldingä¹‹å‰ï¼Œcontigså°äº100bpï¼Œä¸”è¦†ç›–ç‡å°äºè¯¥æœ€å°contigè¦†ç›–ç‡ï¼ˆc*avgCvgï¼‰ï¼Œå°†è¢«å±è”½ï¼Œé™¤éå‚æ•°-uå·²è®¾å®šï¼Œé»˜è®¤å€¼[0.1]<br>    -C  &lt;<span class="hljs-built_in">float</span>&gt;       åœ¨scaffoldingä¹‹å‰ï¼Œcontigsè¦†ç›–ç‡å¤§äºè¯¥æœ€å¤§contigsè¦†ç›–ç‡ï¼ˆC*avgCvgï¼‰ï¼Œæˆ–è€…contigså°äº100bpä¸”è¦†ç›–ç‡å¤§äº0.8*ï¼ˆC*avgCvgï¼‰ï¼Œå°†è¢«å±è”½ï¼Œé™¤éå‚æ•°-uå·²è®¾å®šï¼Œé»˜è®¤å€¼[2]<br>    -b  &lt;<span class="hljs-built_in">float</span>&gt;       å½“å¤„ç†contigsé—´çš„pair-endè¿æ¥æ—¶ï¼Œå¦‚æœå‚æ•°-b&gt;1ï¼Œè¯¥æ’å…¥ç‰‡æ®µçš„ä¸Šé™å€¼ï¼ˆb*avg_insï¼‰å°†è¢«ç”¨æ¥ä½œä¸ºå¤§çš„æ’å…¥ç‰‡æ®µï¼ˆ&gt;1000ï¼‰çš„ä¸Šé™ï¼Œé»˜è®¤å€¼[1.5]<br>    -B  &lt;<span class="hljs-built_in">float</span>&gt;       å¦‚æœä¸¤ä¸ªcontigsçš„è¦†ç›–ç‡éƒ½å°äºbubbleè¦†ç›–ç‡ï¼ˆbubbleCoverageï¼‰ä¹˜ä»¥contigså¹³å‡è¦†ç›–ç‡ï¼ˆbubbleCoverage*avgCvgï¼‰ï¼Œåˆ™å»é™¤åœ¨bubbleç»“æ„ä¸­çš„ä½è¦†ç›–ç‡contigï¼Œé»˜è®¤å€¼[0.6]<br>    -N  &lt;int&gt;         ç»Ÿè®¡åŸºå› ç»„å¤§å°ï¼Œé»˜è®¤å€¼[0]<br>    -V  (optional)    è¾“å‡ºç›¸å…³ä¿¡æ¯ä¸ºäº†å¯è§†åŒ–ç»„è£…ï¼Œé»˜è®¤[NO]<br></code></pre></td></tr></table></figure><h2 id="Output-files"><a href="#Output-files" class="headerlink" title="Output files"></a>Output files</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">a. <span class="hljs-string">&quot;*.contig&quot;</span><br>  contig sequences without using mate pair information.<br>b. <span class="hljs-string">&quot;*.scafSeq&quot;</span><br>  scaffold sequences (final contig sequences can be extracted by breaking down scaffold sequences at gap regions).<br></code></pre></td></tr></table></figure><h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="How-to-set-K-mer-size"><a href="#How-to-set-K-mer-size" class="headerlink" title="How to set K-mer size?"></a>How to set K-mer size?</h3><p>The program accepts odd numbers between 13 and 31? <strong>Larger K-mers would have higher rate of uniqueness in the genome and would make the graph simpler, but it requires deep sequencing depth and longer read length to guarantee the overlap at any genomic location.</strong> <font color="red"><strong>Balance?</strong></font></p><p>The <strong>sparse_pregraph</strong> module usually needs <strong>2-10bp smaller kmer</strong> length to achieve the same performance as the original <strong>pregraph</strong> module. <font color="red"><strong>Difference?</strong></font></p><h3 id="How-to-set-genome-size-z-for-sparse-pregraph-module"><a href="#How-to-set-genome-size-z-for-sparse-pregraph-module" class="headerlink" title="How to set genome size(-z) for sparse_pregraph module?"></a>How to set genome size(-z) for sparse_pregraph module?</h3><p>The -z parameter for sparse pregraph should be set <font color="red"><strong>a litter larger than the real genome size</strong></font>, it is used to allocate memory.</p><h3 id="How-to-set-library-rank"><a href="#How-to-set-library-rank" class="headerlink" title="How to set library rank?"></a>How to set library rank?</h3><p>SOAPdenovo will <font color="red">use the <strong>pair-end libraries</strong> with <strong>insert size</strong> from <strong>smaller to larger</strong> to <strong>construct</strong> scaffolds</font>. Libraries with the same rank would be used at the same time. For example, in a dataset of a human genome, we set <strong><font color="red">five ranks</font> for five libraries with insert size 200-bp, 500-bp, 2-Kb, 5-Kb and 10-Kb</strong>, separately. It is desired that the pairs in each rank provide adequate physical coverage of the genome.</p><h2 id="APPENDIX-A-an-example-config"><a href="#APPENDIX-A-an-example-config" class="headerlink" title="APPENDIX A: an example.config"></a>APPENDIX A: an example.config</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#maximal read length</span><br>max_rd_len=100<br><span class="hljs-string">&quot;[LIB]&quot;</span><br><span class="hljs-comment">#average insert size</span><br>avg_ins=200<br><span class="hljs-comment">#if sequence needs to be reversed</span><br>reverse_seq=0<br><span class="hljs-comment">#in which part(s) the reads are used</span><br>asm_flags=3<br><span class="hljs-comment">#use only first 100 bps of each read</span><br>rd_len_cutoff=100<br><span class="hljs-comment">#in which order the reads are used while scaffolding</span><br>rank=1<br><span class="hljs-comment"># cutoff of pair number for a reliable connection (at least 3 for short insert size)</span><br>pair_num_cutoff=3<br><span class="hljs-comment">#minimum aligned length to contigs for a reliable read location (at least 32 for short insert size)</span><br>map_len=32<br><span class="hljs-comment">#a pair of fastq file, read 1 file should always be followed by read 2 file</span><br>q1=/path/**LIBNAMEA**/fastq1_read_1.fq<br>q2=/path/**LIBNAMEA**/fastq1_read_2.fq<br><span class="hljs-comment">#another pair of fastq file, read 1 file should always be followed by read 2 file</span><br>q1=/path/**LIBNAMEA**/fastq2_read_1.fq<br>q2=/path/**LIBNAMEA**/fastq2_read_2.fq<br><span class="hljs-comment">#a pair of fasta file, read 1 file should always be followed by read 2 file</span><br>f1=/path/**LIBNAMEA**/fasta1_read_1.fa<br>f2=/path/**LIBNAMEA**/fasta1_read_2.fa<br><span class="hljs-comment">#another pair of fasta file, read 1 file should always be followed by read 2 file</span><br>f1=/path/**LIBNAMEA**/fasta2_read_1.fa<br>f2=/path/**LIBNAMEA**/fasta2_read_2.fa<br><span class="hljs-comment">#fastq file for single reads</span><br>q=/path/**LIBNAMEA**/fastq1_read_single.fq<br><span class="hljs-comment">#another fastq file for single reads</span><br>q=/path/**LIBNAMEA**/fastq2_read_single.fq<br><span class="hljs-comment">#fasta file for single reads</span><br>f=/path/**LIBNAMEA**/fasta1_read_single.fa<br><span class="hljs-comment">#another fasta file for single reads</span><br>f=/path/**LIBNAMEA**/fasta2_read_single.fa<br><span class="hljs-comment">#a single fasta file for paired reads</span><br>p=/path/**LIBNAMEA**/pairs1_in_one_file.fa<br><span class="hljs-comment">#another single fasta file for paired reads</span><br>p=/path/**LIBNAMEA**/pairs2_in_one_file.fa<br><span class="hljs-comment">#bam file for single or paired reads, reads 1 in paired reads file should always be followed by reads 2</span><br><span class="hljs-comment">#<span class="hljs-doctag">NOTE:</span> If a read in bam file fails platform/vendor quality checks(the flag field 0x0200 is set), itself and it&#x27;s paired read would be ignored.</span><br>b=/path/**LIBNAMEA**/reads1_in_file.bam<br><span class="hljs-comment">#another bam file for single or paired reads</span><br>b=/path/**LIBNAMEA**/reads2_in_file.bam<br><span class="hljs-string">&quot;[LIB]&quot;</span><br>avg_ins=2000<br>reverse_seq=1<br>asm_flags=2<br>rank=2<br><span class="hljs-comment"># cutoff of pair number for a reliable connection (at least 5 for large insert size)</span><br>pair_num_cutoff=5<br><span class="hljs-comment">#minimum aligned length to contigs for a reliable read location (at least 35 for large insert size)</span><br>map_len=35<br>q1=/path/**LIBNAMEB**/fastq_read_1.fq<br>q2=/path/**LIBNAMEB**/fastq_read_2.fq<br>f1=/path/**LIBNAMEA**/fasta_read_1.fa<br>f2=/path/**LIBNAMEA**/fasta_read_2.fa<br>p=/path/**LIBNAMEA**/pairs_in_one_file.fa<br>b=/path/**LIBNAMEA**/reads_in_file.bam<br></code></pre></td></tr></table></figure><h2 id="Appendix-B-output-files"><a href="#Appendix-B-output-files" class="headerlink" title="Appendix B: output files"></a>Appendix B: output files</h2><h3 id="1-Output-files-from-the-command-â€œpregraphâ€"><a href="#1-Output-files-from-the-command-â€œpregraphâ€" class="headerlink" title="1. Output files from the command â€œpregraphâ€"></a>1. Output files from the command â€œpregraphâ€</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh">a. *.kmerFreq<br>   Each row shows the number of Kmers with a frequency equals the row number. Note that those peaks of frequencies <span class="hljs-built_in">which</span> are the integral multiple of 63 are due to the data structure.<br>b. *.edge<br>   Each record gives the information of an edge <span class="hljs-keyword">in</span> the pre-graph: length, Kmers on both ends, average kmer coverage, whether it<span class="hljs-string">&#x27;s reverse-complementarily identical and the sequence.</span><br><span class="hljs-string">c. *.markOnEdge &amp; *.path</span><br><span class="hljs-string">   These two files are for using reads to solve small repeats.</span><br><span class="hljs-string">e. *.preArc</span><br><span class="hljs-string">   Connections between edges which are established by the read paths.</span><br><span class="hljs-string">f. *.vertex</span><br><span class="hljs-string">   Kmers at the ends of edges.</span><br><span class="hljs-string">g. *.preGraphBasic</span><br><span class="hljs-string">   Some basic information about the pre-graph: number of vertex, K value, number of edges, maximum read length etc.</span><br></code></pre></td></tr></table></figure><h3 id="2-Output-files-from-the-command-â€œcontigâ€"><a href="#2-Output-files-from-the-command-â€œcontigâ€" class="headerlink" title="2. Output files from the command â€œcontigâ€"></a>2. Output files from the command â€œcontigâ€</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">a. *.contig<br>      Contig information: corresponding edge index, length, kmer coverage, whether it<span class="hljs-string">&#x27;s tip and the sequence. Either a contig or its reverse complementry counterpart is included. Each reverse complementary contig index is indicated in the *.ContigIndex file.</span><br><span class="hljs-string">   b. *.Arc</span><br><span class="hljs-string">      Arcs coming out of each edge and their corresponding coverage by reads</span><br><span class="hljs-string">   c. *.updated.edge</span><br><span class="hljs-string">      Some information for each edge in graph: length, Kmers at both ends, index difference between the reverse-complementary edge and this one.</span><br><span class="hljs-string">   d. *.ContigIndex</span><br><span class="hljs-string">      Each record gives information about each contig in the *.contig: it&#x27;</span>s edge index, length, the index difference between its reverse-complementary counterpart and itself.<br></code></pre></td></tr></table></figure><h3 id="3-Output-files-from-the-command-â€œmapâ€"><a href="#3-Output-files-from-the-command-â€œmapâ€" class="headerlink" title="3. Output files from the command â€œmapâ€"></a>3. Output files from the command â€œmapâ€</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">a. *.peGrads<br>      Information <span class="hljs-keyword">for</span> each <span class="hljs-built_in">clone</span> library: insert-size, <span class="hljs-built_in">read</span> index upper bound, rank and pair number cutoff <span class="hljs-keyword">for</span> a reliable <span class="hljs-built_in">link</span>. This file can be revised manually <span class="hljs-keyword">for</span> scaffolding tuning.<br>   b. *.readOnContig<br>      Reads<span class="hljs-string">&#x27; locations on contigs. Here contigs are referred by their edge index. Howerver about half of them are not listed in the *.contig file for their reverse-complementary counterparts are included already.</span><br><span class="hljs-string">   c. *.readInGap</span><br><span class="hljs-string">      This file includes reads that could be located in gaps between contigs. This information will be used to close gaps in scaffolds if &quot;-F&quot; is set.</span><br></code></pre></td></tr></table></figure><h3 id="4-Output-files-from-the-command-â€œscaffâ€"><a href="#4-Output-files-from-the-command-â€œscaffâ€" class="headerlink" title="4. Output files from the command â€œscaffâ€"></a>4. Output files from the command â€œscaffâ€</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs sh">a. *.newContigIndex<br>      Contigs are sorted according their length before scaffolding. Their new index are listed <span class="hljs-keyword">in</span> this file.  This is useful <span class="hljs-keyword">if</span> one wants to corresponds contigs <span class="hljs-keyword">in</span> *.contig with those <span class="hljs-keyword">in</span> *.links.<br>   b. *.links<br>      Links between contigs <span class="hljs-built_in">which</span> are established by <span class="hljs-built_in">read</span> pairs. New index are used.<br>   c. *.scaf_gap<br>      Contigs <span class="hljs-keyword">in</span> gaps found by contig graph outputted by the contiging procedure. Here new index are used.<br>   d. *.scaf<br>      Contigs <span class="hljs-keyword">for</span> each scaffold: contig index (concordant to index <span class="hljs-keyword">in</span> *.contig),  approximate start position on scaffold, orientation, contig length, and its links to others contigs.<br>   e. *.gapSeq<br>      Gap sequences between contigs.<br>   f. *.scafSeq<br>      Sequences of each scaffolds.<br>   g. *.contigPosInscaff<br>      Contigs<span class="hljs-string">&#x27; positions in each scaffold.</span><br><span class="hljs-string">   h. *.bubbleInScaff</span><br><span class="hljs-string">      Contigs that form bubble structures in scaffolds. Every two contigs form a bubble and the contig with higher coverage will be kept in scaffold.</span><br><span class="hljs-string">   i. *.scafStatistics</span><br><span class="hljs-string">      Statistic information of final scaffold and contig.</span><br></code></pre></td></tr></table></figure><hr><h1 id="å°è®°1"><a href="#å°è®°1" class="headerlink" title="å°è®°1"></a>å°è®°1</h1><p> refï¼š<a href="https://www.cnblogs.com/Formulate0303/p/6879841.html">https://www.cnblogs.com/Formulate0303/p/6879841.html</a></p><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>ç¡®å®šåŸºå› ç»„ç¼ºå¤±ä»€ä¹ˆï¼›ç¡®å®šéš¾ä»¥ç”ŸåŒ–ç ”ç©¶çš„åŸºå› å’Œpathwaysï¼›ç ”ç©¶æ„Ÿå…´è¶£pathwayé€šè·¯ä¸­æ¯ä¸€ä¸ªåŸºå› ï¼›ç ”ç©¶åŸºå› ç»„éç¼–ç åŒºï¼ˆintronsã€promotersã€telomeresç«¯ç²’ç­‰ï¼‰çš„è°ƒæ§æœºç†å’Œç»“æ„ç‰¹å¾ï¼›åŸºå› ç»„æä¾›å¯è¿›è¡Œå„ç§ç»Ÿè®¡çš„å¤§å‹æ•°æ®åº“ï¼ˆprovide large databases that are amenable to statistical methodsï¼‰;è¯†åˆ«ä¸åŒå¯èƒ½æœ‰ç»†å¾®è¡¨å‹çš„åºåˆ—ï¼›ç ”ç©¶ç‰©ç§å’ŒåŸºå› ç»„çš„è¿›åŒ–è¿‡ç¨‹ã€‚ä¸€èˆ¬éƒ½æ˜¯ç”¨ä¸åŒæ¢¯åº¦çš„æ’å…¥ç‰‡æ®µæ¥æµ‹åºï¼Œå°ç‰‡æ®µï¼ˆ200,500,800ï¼‰å’Œå¤§ç‰‡æ®µï¼ˆ1k, 2kb 5kb 10kb 20kb 40kbï¼‰ã€‚</p><h2 id="æµ‹åºå‰å‡†å¤‡"><a href="#æµ‹åºå‰å‡†å¤‡" class="headerlink" title="æµ‹åºå‰å‡†å¤‡"></a>æµ‹åºå‰å‡†å¤‡</h2><p>æœé›†ç‰©ç§ç›¸å…³ä¿¡æ¯ï¼ˆæŸ“è‰²ä½“çš„å€å‹ã€åŸºå› ç»„å¤§å°ã€æ‚åˆåº¦ã€é‡å¤åºåˆ—æ¯”ä¾‹ã€æ˜¯å¦æœ‰å¯ç”¨çš„é—ä¼ å›¾è°±ã€GCå«é‡ å’Œ GCåˆ†å¸ƒï¼‰ã€‚æä¾›å·²ç»å‘è¡¨çš„è¿‘æºç‰©ç§ã€‚æ ¹æ®è¿‘æºç‰©ç§åˆ†æä»¥ä¸Šä¿¡æ¯ï¼Œå°¤å…¶æ˜¯GCå«é‡ä»¥åŠå¯¹åº”çš„GCåˆ†å¸ƒï¼Œé‡å¤ç¨‹åº¦ã€‚</p><h3 id="1-è·å–åŸºå› ç»„å¤§å°"><a href="#1-è·å–åŸºå› ç»„å¤§å°" class="headerlink" title="1 è·å–åŸºå› ç»„å¤§å°"></a>1 è·å–åŸºå› ç»„å¤§å°</h3><ul><li><p>åŸºå› ç»„å¤ªå¤§ï¼ˆ&gt;10Gbï¼‰è¶…å‡ºäº†ç›®å‰denovoç»„è£…åŸºå› ç»„è½¯ä»¶å¯¹æœºå™¨å†…å­˜çš„è¦æ±‚ï¼Œåˆ™æ— æ³•å®ç°ç»„è£…ï¼›å¯¹ç»„è£…ç»“æœçš„å¤§å°çš„è¿›è¡Œæ­£ç¡®æ€§ä¸å¦åˆ¤æ–­ã€‚</p></li><li><p>åŠ¨ç‰©åŸºå› ç»„å¤§å°æ•°æ®åº“ï¼ˆANIMAL GENOME SIZE DATABASEï¼‰: <a href="http://www.genomesize.com/%EF%BC%9B%E5%AF%B9%E4%BA%8E%E6%9F%A5%E4%B8%8D%E5%88%B0%E7%9A%84%E7%89%A9%E7%A7%8D%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%A4%A7%E5%B0%8F%E7%9A%84%EF%BC%8C%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E4%B8%80%E4%BA%9B%E6%96%B9%E6%B3%95%E5%8E%BB%E4%BC%B0%E8%AE%A1%E3%80%82">http://www.genomesize.com/ï¼›å¯¹äºæŸ¥ä¸åˆ°çš„ç‰©ç§åŸºå› ç»„å¤§å°çš„ï¼Œå¯ä»¥é€šè¿‡ä¸€äº›æ–¹æ³•å»ä¼°è®¡ã€‚</a></p></li><li><p>å®éªŒï¼ˆæµå¼ç»†èƒä»ªï¼‰ä¼°è®¡åŸºå› ç»„å¤§å°çš„ä¾‹å­ï¼š â€œA full-length enriched cDNA library and expressed sequence tag analysis of the parasitic weed, Striga hermonthica.â€ BMC Plant Biol (2010)</p></li><li><p>åŸºäºç¦å°”æ‘©æ ¹æŸ“è‰²ä¼°è®¡åŸºå› ç»„å¤§å°ï¼šä¹¦The evolution of the genomeã€ŠåŸºå› ç»„è¿›åŒ–ã€‹, Gregory, T. (2005).</p></li><li><p>å®šé‡PCRä¼°è®¡åŸºå› ç»„å¤§å°: â€œReal-time PCR-based method for the estimation of genome sizes.â€ Nucleic Acids Res (2003); â€œThe nuclear genome of the phytoseiid Metaseiulus occidentalis (Acari: Phytoseiidae) is among the smallest known in arthropods.â€ Exp Appl Acarol (2009)</p></li><li><p>é€šè¿‡Kmerä¼°è®¡åŸºå› ç»„å¤§å°ï¼šKim, E. B., X. Fang, et al. (2011). â€œ<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3319411/"><strong>Genome sequencing reveals insights into physiology and longevity of the naked mole rat</strong></a>.â€ Nature 479(7372): 223-227. [Obtained 2.5 G contig sequences with N50 19.3 kbp and N90 4.7 kbp, and 2.7 G scaffold sequences with N50 1.6 Mbp and N90 0.3 Mbp.]</p></li></ul><h3 id="2-æ‚åˆåº¦è¯„ä¼°"><a href="#2-æ‚åˆåº¦è¯„ä¼°" class="headerlink" title="2 æ‚åˆåº¦è¯„ä¼°"></a>2 æ‚åˆåº¦è¯„ä¼°</h3><ul><li><p>ä¸»è¦ä½“ç°åœ¨<font color="green">ä¸èƒ½åˆå¹¶å§Šå¦¹æŸ“è‰²ä½“</font>ï¼Œæ‚åˆåº¦é«˜çš„åŒºåŸŸï¼Œä¼šæŠŠä¸¤æ¡å§Šå¦¹æŸ“è‰²å•ä½“éƒ½ç»„è£…å‡ºæ¥ï¼Œé€ æˆç»„è£…çš„åŸºå› ç»„<font color="green">åå¤§</font>ã€‚</p></li><li><p><font color="red"><strong>æ‚åˆåº¦&gt;0.5%åˆ™ç»„è£…æœ‰ä¸€å®šéš¾åº¦</strong></font>ã€‚æ‚åˆåº¦&gt;1%åˆ™å¾ˆéš¾ç»„è£…å‡ºæ¥ã€‚</p></li><li><p>æ‚åˆåº¦é«˜åˆ™ç»„è£…çš„åºåˆ—ä¸é€‚åˆç”¨äºåç»­ç”Ÿç‰©å­¦åˆ†æï¼ˆeg:æ‹·è´æ•°ã€åŸºå› å®Œæ•´ç»“æ„ç­‰ï¼‰ã€‚</p></li></ul><h3 id="3-æ˜¯å¦æœ‰é—ä¼ å›¾è°±å¯ç”¨"><a href="#3-æ˜¯å¦æœ‰é—ä¼ å›¾è°±å¯ç”¨" class="headerlink" title="3 æ˜¯å¦æœ‰é—ä¼ å›¾è°±å¯ç”¨"></a>3 æ˜¯å¦æœ‰é—ä¼ å›¾è°±å¯ç”¨</h3><p>éšç€æµ‹åºå¯¹è´¨é‡æé«˜å’Œç›¸å…³æŠ€æœ¯æˆç†Ÿï¼Œ<font color="red"><strong>é—ä¼ å›¾è°±ï¼Ÿ</strong></font>ä¹Ÿå¿«æˆäº†denovoåŸºå› ç»„çš„å¿…é¡»ç»„æˆã€‚</p><p><a href="https://cdmd.cnki.com.cn/Article/CDMD-10504-1019065822.htm">çŸ®ç‰µç‰›é—ä¼ å›¾è°±æ„å»ºåŠé‡ç“£åˆ†å­æ ‡è®°ç­›é€‰</a></p><p>é—ä¼ å›¾è°±æ˜¯æŸä¸€ç‰©ç§çš„æŸ“è‰²ä½“å›¾ï¼Œæ˜¾ç¤ºæ‰€çŸ¥çš„åŸºå› å’Œ&#x2F;æˆ–é—ä¼ æ ‡è®°çš„ç›¸å¯¹ä½ç½®ï¼Œè€Œä¸æ˜¯åœ¨æ¯æ¡æŸ“è‰²ä½“ä¸Šç‰¹æ®Šçš„ç‰©ç†ä½ç½®ã€‚ç”±<a href="https://baike.baidu.com/item/%E9%81%97%E4%BC%A0%E9%87%8D%E7%BB%84/6391485">é—ä¼ é‡ç»„</a>æµ‹éªŒç»“æœæ¨ç®—å‡ºæ¥çš„ã€åœ¨ä¸€æ¡æŸ“è‰²ä½“ä¸Šå¯ä»¥å‘ç”Ÿçš„çªå˜åº§ä½çš„ç›´çº¿æ’åˆ—ï¼ˆ<a href="https://baike.baidu.com/item/%E5%9F%BA%E5%9B%A0%E4%BD%8D%E7%82%B9/3613206">åŸºå› ä½ç‚¹</a>çš„æ’åˆ—ï¼‰å›¾ã€‚</p><p>Genetic mapï¼Œ<a href="https://baike.baidu.com/item/%E9%81%97%E4%BC%A0%E5%9B%BE/2951032">é—ä¼ å›¾</a>æˆ–é—ä¼ <a href="https://baike.baidu.com/item/%E8%BF%9E%E9%94%81%E5%9B%BE/1586423">è¿é”å›¾</a>æ˜¯ä»¥<a href="https://baike.baidu.com/item/%E5%9F%BA%E5%9B%A0%E8%BF%9E%E9%94%81/7740242">åŸºå› è¿é”</a>ã€é‡ç»„<a href="https://baike.baidu.com/item/%E4%BA%A4%E6%8D%A2%E5%80%BC/5106108">äº¤æ¢å€¼</a>æ„å»ºçš„å›¾è°±ï¼Œå›¾è·ä¸ºcMï¼ˆ<a href="https://baike.baidu.com/item/%E5%8E%98%E6%91%A9/1586351">å˜æ‘©</a>ï¼‰ï¼Œ1%äº¤æ¢å€¼ä¸º1cMï¼Œçº¦ç›¸å½“äº1000kbã€‚äººåŸºå› ç»„å…¨é•¿çº¦3300cMï¼Œå¦‚ä¸¤ä¸ªæ ‡è®°ä¹‹é—´ç›¸è·1cMï¼Œåˆ™éœ€3300ä¸ªæ ‡è®°ï¼Œå¦‚ç›¸è·2ï½5cMï¼Œåˆ™éœ€660ï½l650ä¸ªæ ‡è®°ã€‚æ ‡è®°å¯ä»¥æ˜¯ä½“è´¨æ€§çŠ¶ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯æ£€å‡ºçš„DNAåºåˆ—ï¼Œä¾‹å¦‚åŸºå› ã€<a href="https://baike.baidu.com/item/%E9%99%90%E5%88%B6%E7%89%87%E6%AE%B5%E9%95%BF%E5%BA%A6%E5%A4%9A%E6%80%81%E6%80%A7/3841692">é™åˆ¶ç‰‡æ®µé•¿åº¦å¤šæ€æ€§</a>ï¼ˆ<a href="https://baike.baidu.com/item/RFLP/5060944">RFLP</a>ï¼‰å’Œç‰¹å®šçš„<a href="https://baike.baidu.com/item/%E5%8D%95%E4%B8%80%E5%BA%8F%E5%88%97/1851974">å•ä¸€åºåˆ—</a>ç­‰ã€‚æ¯ä¸€ä¸ªæ ‡è®°éƒ½è¦ç”¨ä¸“ä¸€åºåˆ—ä½ç‚¹ï¼ˆSTSï¼‰ä½œé‰´å®šã€‚STSæ˜¯æŒ‡å…¶ä½ç½®åŠæ ¸è‹·é…¸åºåˆ—å‡å·²çŸ¥çš„ã€äººåŸºå› ç»„ä¸­åªæœ‰ä¸€ä»½æ‹·è´çš„DNAçŸ­ç‰‡æ®µï¼ˆä¸€èˆ¬é•¿200ï½500ç¢±åŸºå¯¹ï¼‰ï¼Œå®ƒå¾ˆå®¹æ˜“ç”¨å¤šèšé…¶é“¾ååº”ï¼ˆPCRï¼‰åŠ ä»¥éªŒè¯ã€‚å½“å„ä¸ªå®éªŒå®¤æŠ¥é“å®šä½å’Œæµ‹åºçš„æ•°æ®æ—¶ï¼Œå¯ç”¨STSæ¥ç¡®å®šè¿™äº›DNAç‰‡æ®µçš„å®šä½ä¸å–å‘ã€‚äººç±»åŸºå› ç»„è®¡åˆ’çš„ç ”ç©¶ç›®æ ‡æ˜¯ï¼Œå®Œæˆä¸€ä¸ªå®Œå…¨è¿æ¥çš„äººç±»é—ä¼ å›¾ï¼Œæ ‡è®°ä¹‹é—´å¹³å‡ç›¸è·2ï½5cMã€‚</p><p>é—ä¼ å›¾è°±æ„å»ºç›¸å…³æ¦‚å¿µæ¨èå‚è€ƒä¹¦ï¼š<strong>The handbook of plant genome mapping: genetic and physical mapping</strong> </p><h3 id="4-ç”Ÿç‰©å­¦é—®é¢˜çš„è°ƒç ”"><a href="#4-ç”Ÿç‰©å­¦é—®é¢˜çš„è°ƒç ”" class="headerlink" title="4 ç”Ÿç‰©å­¦é—®é¢˜çš„è°ƒç ”"></a>4 ç”Ÿç‰©å­¦é—®é¢˜çš„è°ƒç ”</h3><h2 id="ç»„è£…"><a href="#ç»„è£…" class="headerlink" title="ç»„è£…"></a>ç»„è£…</h2><ul><li><p>BAC-by-BAC:æµ‹åºå’Œç»„è£…æ¯ä¸€ä¸ªBAC, åˆå¹¶BACå’Œç§»é™¤BACå†—ä½™éƒ¨åˆ†ï¼Œè·å¾—å‚è€ƒåŸºå› ç»„åºåˆ—ã€‚</p></li><li><p>whole genome shotgunï¼šå…¨åŸºå› ç»„é¸Ÿæªæ³•ï¼ŒæŸ“è‰²ä½“DNAè¢«éšæœºæ‰“æ–­æˆç‰‡æ®µï¼Œä¾æ¬¡æµ‹åºå’Œç»„è£…ã€‚</p></li></ul><h3 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h3><p>äºŒä»£æµ‹åºæ•°æ®ä»å¤´ç»„è£…çš„è§£å†³overlapçš„ä¸‰ç§ç®—æ³•</p><ul><li><p>overlap-layout-consensusï¼šé‡å å¸ƒå±€ä¸€è‡´OLCæ³•ï¼Œã€è½¯ä»¶ï¼šPHRAP.NEWBLER.CABOG.CELERA.SHORTY.EDENA,popular for long readsã€‘ï¼Œ1. Overlap discovery involves all-against-all, pair-wise read comparison. 2. Construction an approximate read layout according to the pair-wise alignment 3. Multiple sequence alignment determines the precise layout and the consensus.</p></li><li><p>De bruijn graph:DBGæ³•ï¼Œã€è½¯ä»¶ï¼šSOAPdenovo2.Velvet.EULER,popular for illumina ï¼Œfor short readsã€‘,1.æ‰€æœ‰çš„æµ‹åºreadséƒ½è¢«åˆ‡å‰²æˆæŸä¸€å›ºå®šKmeré•¿åº¦çš„åºåˆ—ï¼ˆ21bp-kmer-127bpï¼‰.2.ç›¸é‚»kmersé“¾æ¥æ˜¯æ¥è‡ªreadåºåˆ—ï¼Œæ‰€ä»¥å®ƒä¸éœ€è¦æˆå¯¹åºåˆ—æ¯”å¯¹(The links between neighboring Kmers are derived from read sequences,so it doesnâ€™t need pair-wise reads alignment.ï¼‰3.å†—ä½™çš„æ•°æ®è‡ªåŠ¨è¢«å‹ç¼©ã€‚</p></li><li><p>greedy methodï¼šè´ªå©ªæ³•(use OLC or DBG)ï¼Œã€è½¯ä»¶ï¼šSSAKE.SHARCGS.VCAKEã€‘ï¼Œä»ç»™å®šçš„readså’Œcontigså¼€å§‹ï¼Œä½¿ç”¨ä¸‹ä¸€ä¸ªå¾—åˆ†æœ€é«˜çš„overlapå»åšä¸‹ä¸€ä¸ªè¿æ¥ï¼Œè¿™æ ·ä¸€ç›´åšä¸‹å»ï¼Œç›´åˆ°ä¸èƒ½è¿›è¡Œä¸‹å»ä¸ºæ­¢ã€‚</p></li></ul><h3 id="è¯„ä¼°"><a href="#è¯„ä¼°" class="headerlink" title="è¯„ä¼°"></a>è¯„ä¼°</h3><p>ç»„è£…short readsçš„æŒ‘æˆ˜</p><p>1.åŸºå› ç»„çš„å¤æ‚æ€§ï¼Œ<strong>é‡å¤åºåˆ—</strong>ã€<strong>æ‚åˆ</strong>çš„<strong>äºŒå€ä½“</strong>åŸºå› ç»„heterozygous diploid genomeã€<strong>å¤šå€æ€§</strong>polyploidy.</p><p>2.illumina reads çš„æ•°æ®ç‰¹å¾ï¼Œ<strong>æµ‹åºé”™è¯¯</strong>ç‡<del>1%ã€short read é•¿åº¦</del>100bpã€<del>100Xçš„é«˜æµ‹åºæ·±åº¦ã€ä¸åŒçº§åˆ«çš„æ–‡åº“æ’å…¥ç‰‡æ®µï¼ˆ200bp</del>40Kbpï¼‰ã€‚</p><p>3.Complexity of computation</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><hr><h1 id="å°è®°2"><a href="#å°è®°2" class="headerlink" title="å°è®°2"></a>å°è®°2</h1><p>ref <a href="https://www.jianshu.com/p/e02ecd537c83">https://www.jianshu.com/p/e02ecd537c83</a></p><h2 id="readsè´¨é‡æ§åˆ¶"><a href="#readsè´¨é‡æ§åˆ¶" class="headerlink" title="readsè´¨é‡æ§åˆ¶"></a>readsè´¨é‡æ§åˆ¶</h2><ul><li>è®¤è¯†æ•°æ®ã€‚(readç±»å‹ï¼Œreadæ•°é‡ï¼Œå…¶GCå«é‡ï¼Œå¯èƒ½çš„æ±¡æŸ“å’Œå…¶ä»–é—®é¢˜)</li><li>æ•°æ®æ¸…ç†ã€‚(ç»„è£…å‰æ¸…ç†åŸå§‹æ•°æ®å¯ä»¥ä½¿ç»„è£…ç»“æœæ›´å¥½,å› ä¸ºç§»é™¤äº†ä½è´¨é‡å’Œæ±¡æŸ“çš„reads)</li><li>ä¸ºç»„è£…è½¯ä»¶æä¾›ä¸€äº›ç»„è£…çš„å‚æ•°</li></ul><h2 id="æ£€æŸ¥åŸå§‹readæ•°æ®çš„è´¨é‡"><a href="#æ£€æŸ¥åŸå§‹readæ•°æ®çš„è´¨é‡" class="headerlink" title="æ£€æŸ¥åŸå§‹readæ•°æ®çš„è´¨é‡"></a>æ£€æŸ¥åŸå§‹readæ•°æ®çš„è´¨é‡</h2><p>(1)readé•¿åº¦:åœ¨è®¾ç½®ç»„è£…çš„æœ€å¤§k-merå€¼æ—¶å°†å¾ˆé‡è¦ã€‚</p><p>(2)è´¨é‡ç¼–ç ç±»å‹:å¯¹äºquality trimmingè½¯ä»¶å¾ˆé‡è¦ã€‚(Phred33ã€64)</p><p>(3)GCå«é‡:<strong>é«˜GCçš„ç”Ÿç‰©ä½“å¾€å¾€ç»„è£…å¾—ä¸å¥½ï¼Œå¹¶ä¸”readè¦†ç›–ç‡åˆ†å¸ƒå¯èƒ½ä¸å‡åŒ€</strong></p><p>(4)æ€»çš„readsæ•°:<strong>äº†è§£coverageèŒƒå›´</strong></p><p>(4)åœ¨readçš„å¼€å§‹ã€ä¸­é—´æˆ–ç»“å°¾é™„è¿‘è´¨é‡ä¸‹é™:ç¡®å®šå¯èƒ½çš„ä¿®æ•´&#x2F;æ¸…é™¤æ–¹æ³•å’Œå‚æ•°ã€‚</p><p>(5)å‡ºç°<strong>é«˜åº¦é‡å¤çš„k-mers</strong>:è¯´æ˜åºåˆ—å¯èƒ½å­˜åœ¨æ±¡æŸ“ã€‚</p><p>(6)readsä¸­å­˜åœ¨<strong>å¤§é‡N</strong>:å¯èƒ½è¡¨æ˜æµ‹åºè´¨é‡è¾ƒå·®ã€‚ä½ éœ€è¦ä¿®å‰ªè¿™äº›readï¼Œä»¥åˆ é™¤N.</p><h2 id="genome-survey"><a href="#genome-survey" class="headerlink" title="genome survey"></a>genome survey</h2><p>æ­£å¼ç»„è£…å‰è¿›è¡Œkmeråˆ†æï¼Œä»¥äº†è§£ä»¥ä¸‹ä¿¡æ¯ã€‚</p><p>(1)åŸºå› ç»„æ‚åˆåº¦ã€‚</p><p>(2)é‡å¤åºåˆ—æ¯”ä¾‹ã€‚</p><p>(3)é¢„ä¼°åŸºå› ç»„å¤§å°ã€‚</p><p>(4)æµ‹åºæ·±åº¦ã€‚</p><p>æ‰€ç”¨è½¯ä»¶ä¸ºkmergenieï¼Œ<a href="https://links.jianshu.com/go?to=http://kmergenie.bx.psu.edu/">http://kmergenie.bx.psu.edu/</a> </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#å®‰è£…(ä½¿ç”¨æ—¶ï¼Œç¡®ä¿æœåŠ¡å™¨è£…æœ‰Pthonä¸R)</span><br>tar -xzvf kmergenie-1.7051.tar.gz &amp;&amp; <span class="hljs-built_in">cd</span> kmergenie-1.7051<br>python setup.py install<br> <br><span class="hljs-comment">#æ·»åŠ å¯æ‰§è¡Œæƒé™</span><br><span class="hljs-built_in">chmod</span> -R 755 *<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ä»‹ç»æ€ä¹ˆç”¨ï¼Œå‚è€ƒï¼š<a href="https://links.jianshu.com/go?to=http://wap.sciencenet.cn/blog-3406804-1159967.html">http://wap.sciencenet.cn/blog-3406804-1159967.html</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">touch</span> fq_501.txt                                 <span class="hljs-comment">#å­˜å‚¨fastqæ–‡ä»¶çš„è·¯å¾„ã€‚</span><br>vim fq_501.txt                                   <span class="hljs-comment">#ç¼–è¾‘fq.txtï¼Œè¾“å…¥fastqæ–‡ä»¶è·¯å¾„ã€‚</span><br><span class="hljs-built_in">mkdir</span> kmergenie_result     <br>./tools/kmergenie-1.7051/kmergenie fq_501.list -o ./kmergenie_result/PB_501 -k 105 -<br>l 15 -s 10 -t 12                               <br><span class="hljs-comment">#-o:è¾“å‡ºæ–‡ä»¶å­˜æ”¾çš„åœ°å€ã€‚</span><br><span class="hljs-comment">#-k:æœ€å¤§çš„kå€¼</span><br><span class="hljs-comment">#-l:æœ€å°çš„kå€¼</span><br><span class="hljs-comment">#-s:ä»æœ€å°çš„k----æœ€å¤§çš„kï¼Œæ¯æ¬¡å¢åŠ çš„kã€‚</span><br><span class="hljs-comment">#-t:çº¿ç¨‹æ•°ã€‚</span><br><span class="hljs-comment">#æ³¨:åˆšå¼€å§‹så¯ä»¥è®¾å¤§ç‚¹ï¼Œå¯ä»¥æ ¹æ®åˆ¤æ–­å‡ºçš„æœ€ä½³kå€¼ï¼Œç¼©å°så†è¿›è¡Œåˆ¤æ–­((ç¬¬ä¸€æ¬¡:I:15,k:105,s:10 ç¬¬äºŒæ¬¡I:85,k:140,s:6)ã€‚</span><br></code></pre></td></tr></table></figure><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">usage:<br><br>    ./kmergenie reads_file<br><br>reads_file is either <span class="hljs-keyword">a</span> single FASTA, FASTQ, FASTA.gz, FASTQ.gz <span class="hljs-built_in">file</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">a</span> list <span class="hljs-keyword">of</span> <span class="hljs-built_in">file</span> names, <span class="hljs-literal">one</span> per <span class="hljs-built_in">line</span>. For example:<br>    <br>    ls <span class="hljs-number">-1</span> *.fastq.gz &gt; list_files<br>    ./kmergenie list_files<br><br>    type ./kmergenie <span class="hljs-built_in">to</span> see extra options<br><br>input:<br><br>    Input reads should be exactly those <span class="hljs-keyword">the</span> de novo assembler will use <span class="hljs-built_in">to</span> <span class="hljs-built_in">create</span> contigs, i.e. <span class="hljs-keyword">the</span> list <span class="hljs-keyword">of</span> all single <span class="hljs-keyword">and</span> paired-<span class="hljs-function"><span class="hljs-keyword">end</span> <span class="hljs-title">reads</span>.</span><br><br>    The order does <span class="hljs-keyword">not</span> matter, KmerGenie treats <span class="hljs-keyword">the</span> reads <span class="hljs-keyword">as</span> <span class="hljs-keyword">an</span> unordered <span class="hljs-built_in">set</span> <span class="hljs-keyword">of</span> k-mers. Orientation <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> reads also does <span class="hljs-keyword">not</span> matter.<br>    With Velvet, <span class="hljs-keyword">if</span> you have mate-pairs, Velvet uses them <span class="hljs-built_in">to</span> <span class="hljs-built_in">create</span> contigs, so <span class="hljs-built_in">do</span> <span class="hljs-built_in">include</span> them <span class="hljs-keyword">in</span> KmerGenie.<br>    Otherwise, <span class="hljs-keyword">if</span> <span class="hljs-keyword">the</span> mate-pairs are used only <span class="hljs-keyword">for</span> scaffolding (i.e. asm_flag=<span class="hljs-number">2</span> <span class="hljs-keyword">in</span> SOAPdenovo), <span class="hljs-built_in">do</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">include</span> them.<br><br>tips:<br><br>    * Take <span class="hljs-keyword">a</span> look <span class="hljs-keyword">at</span> <span class="hljs-keyword">the</span> generated HTML report. It provides <span class="hljs-keyword">a</span> summary <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> results, <span class="hljs-keyword">and</span> <span class="hljs-keyword">contains</span> <span class="hljs-keyword">an</span> Advanced Help section <span class="hljs-built_in">to</span> help analysis.<br><br>    * There is no need <span class="hljs-built_in">to</span> use Kmergenie <span class="hljs-keyword">for</span> <span class="hljs-keyword">a</span> multi-k assembler, like SPAdes. Default parameters <span class="hljs-keyword">of</span> multi-k assemblers are generally better than <span class="hljs-keyword">a</span> single best k.<br><br>    * By default, KmerGenie will perform another pass <span class="hljs-built_in">to</span> estimate k more precisely. You may skip <span class="hljs-keyword">it</span> <span class="hljs-keyword">by</span> <span class="hljs-keyword">using</span> <span class="hljs-keyword">the</span> <span class="hljs-string">&quot;--one-pass&quot;</span> option (roughly <span class="hljs-number">2</span>x faster).<br><br>    * To run multiple instances <span class="hljs-keyword">of</span> KmerGenie <span class="hljs-keyword">on</span> <span class="hljs-title">the</span> <span class="hljs-title">same</span> <span class="hljs-title">folder</span>, <span class="hljs-title">specify</span> <span class="hljs-title">the</span> <span class="hljs-string">&quot;-o&quot;</span> <span class="hljs-title">and</span> <span class="hljs-string">&quot;-t&quot;</span> <span class="hljs-title">parameters</span> (<span class="hljs-title">output</span> <span class="hljs-title">prefix</span>, <span class="hljs-title">number</span> <span class="hljs-title">of</span> <span class="hljs-title">threads</span> <span class="hljs-title">per</span> <span class="hljs-title">instance</span>).<br><br>    * The sampling <span class="hljs-built_in">value</span> e (<span class="hljs-string">&quot;-e&quot;</span> parameter) makes sure that roughly n/e k-mers are sampled out <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> n distinct kmers <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> dataset. The datasets are fully analyzed, though. Kmergenie samples <span class="hljs-built_in">from</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">set</span> <span class="hljs-keyword">of</span> distinct kmers, <span class="hljs-keyword">not</span> <span class="hljs-built_in">from</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">set</span> <span class="hljs-keyword">of</span> reads.<br><br>    * The diploid model should only be used <span class="hljs-keyword">for</span> moderate-high heterozygosity rates. The haploid model works better when only <span class="hljs-literal">one</span> peak is visible <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> histograms (indicating low heterozygosity).<br><br>outputs:<br><br>    histograms_report.html<br>        html report <span class="hljs-keyword">of</span> all <span class="hljs-keyword">the</span> results<br>    histograms.dat<br>        <span class="hljs-built_in">file</span> containing <span class="hljs-keyword">the</span> raw data <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> genomic kmers <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span> k <span class="hljs-built_in">value</span><br>    histograms-k*.histo<br>        <span class="hljs-built_in">files</span> containing raw sampled histograms <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span> k <span class="hljs-built_in">value</span><br>    histograms-k*.histo.pdf<br>        plots <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> histograms <span class="hljs-keyword">and</span> <span class="hljs-keyword">the</span> fits. Colors: red is <span class="hljs-keyword">the</span> fit <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> complete statistical model <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> histogram (erroneous k-mers + genomic k-mers). With <span class="hljs-keyword">the</span> diploid model, green are only <span class="hljs-keyword">the</span> heterozygous k-mers, blue are only <span class="hljs-keyword">the</span> homozygous k-mers.<br>    &lt;<span class="hljs-keyword">stdout</span>&gt;<br>        <span class="hljs-keyword">last</span> <span class="hljs-built_in">line</span> is <span class="hljs-keyword">the</span> best k <span class="hljs-built_in">value</span><br>    &lt;<span class="hljs-literal">return</span> code / error code&gt;<br>        <span class="hljs-number">0</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">and</span> only <span class="hljs-keyword">if</span> <span class="hljs-keyword">a</span> best k was found (note: no longer returns <span class="hljs-keyword">the</span> best k <span class="hljs-keyword">as</span> error code)<br></code></pre></td></tr></table></figure><p>ç»“æœæ–‡ä»¶ç”Ÿæˆreportã€‚æŠ¥å‘Šä»¥æŠ˜çº¿å›¾å½¢å¼ç»™å‡ºæ¯ç§é•¿åº¦çš„kmerä¸‹ï¼Œä¼°è®¡çš„åŸºå› ç»„å¤§å°ï¼ŒåŒæ—¶ç»™å‡ºäº†æœ€ä½³çš„kmer(è¯„ä¼°åŸºå› ç»„æ€»å¤§å°æœ€é«˜)</p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/14.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/14.png" alt="img"></p><p>ç†æƒ³æ¡ä»¶è¯¥å›¾åº”è¯¥ä¸ºä¸€æ¡å¹³æ»‘çš„æ›²çº¿ï¼Œæœ‰æ˜ç¡®æœ€å¤§å€¼ã€‚ç„¶è€Œåœ¨ä¸€äº›æƒ…å†µä¸‹æœ‰å¤šä¸ªå±€éƒ¨æœ€å¤§å€¼ã€‚</p><p>è¿™äº›æƒ…å†µè¡¨æ˜ï¼Œå¯¹äºæŸäº›kå€¼ï¼ŒKmergenieä¸­çš„ç»Ÿè®¡æ¨¡å‹å¹¶ä¸æ€»æ˜¯æ­£ç¡®åœ°æ‹Ÿåˆè¾“å…¥æ•°æ®ã€‚å› æ­¤ç”±Kmergenieé¢„æµ‹çš„æœ€ä½³kå€¼å¯èƒ½ä¸æ˜¯æœ€ä½³çš„ã€‚åœ¨éšåçš„åˆ†æä¸­ï¼Œè¿˜å°è¯•ä½¿ç”¨æ¯”Kmergenieé¢„æµ‹çš„kå¤§çš„k(å…¶ä»–å³°å€¼)</p><p>è‹¥åŸºå› ç»„k-mersçš„æ•°é‡ä¸ä¼šéšç€kå€¼çš„å‡é«˜è€Œä¸‹é™ï¼Œåˆ™æ˜¯ä¸€ä¸ªé«˜è¦†ç›–ç‡(high coverage)æ•°æ®é›†çš„è¿¹è±¡ï¼Ÿ<br>ä»€ä¹ˆæ˜¯è¦†ç›–ç‡å‘¢ï¼Ÿ<br>è¦†ç›–ç‡(coverage)ï¼šæŒ‡çš„æ˜¯æµ‹åºè¿‡ç¨‹ä¸­è¯»å–å•ä¸ªç¢±åŸºçš„å¹³å‡æ¬¡æ•°ã€‚å¦‚æœè¦†ç›–åº¦ä¸º100Ã—ï¼Œè¯´æ˜å¹³å‡æ¯ä¸ªç¢±åŸºæµ‹åºäº†100æ¬¡ã€‚å¯¹ç¢±åŸºæµ‹åºçš„é¢‘ç‡è¶Šé«˜ï¼Œæ•°æ®çš„è´¨é‡è¶Šé«˜ã€‚</p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/15.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/15.png" alt="img"></p><h2 id="soapdevovo2"><a href="#soapdevovo2" class="headerlink" title="soapdevovo2"></a>soapdevovo2</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#æ­£å¼ç»„è£…(kmeré€‰103,113,123,127åˆ†åˆ«è·‘)</span><br><span class="hljs-comment">#SOAPdenovo2æ—¢å¯ä»¥ä¸€æ­¥ç»„è£…ä¹Ÿå¯ä»¥åˆ†å››æ­¥ï¼Œå¦‚æœåŸºå› ç»„å¤§ä¸”å¤æ‚å»ºè®®åˆ†å››æ­¥ã€‚</span><br> <span class="hljs-built_in">nohup</span> ./tools/SOAPdenovo2-master/SOAPdenovo-127mer all -s config_file -d 1 -R -F -K 113 -p 60 -o PB_501_113 &gt; PB_501_113.<span class="hljs-built_in">log</span> &amp;  <span class="hljs-comment">#æ³¨:åŠ nohupå’Œ&amp;æ˜¯ä¸ºäº†è®©å®ƒåœ¨åå°è¿è¡Œ(é˜²æ­¢è¿œç¨‹è¿æ¥æ–­å¼€ç¨‹åºåœæ­¢)</span><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#åˆ†å››æ­¥(åœ¨k=103ã€113ã€123ã€åŠ127(æ”¯æŒçš„æœ€å¤§kmer)è·‘äº†åå‘ç°127åœ¨åŒæ ·å‚æ•°ä¸‹contig N50æœ€å¤§)ï¼Œä¸‹é¢æ˜¯ä¸ºäº†ä¼˜åŒ–ç»“æœè·‘çš„ã€‚</span><br><span class="hljs-comment">#pregraph(d=1,2,3,4)</span><br><span class="hljs-built_in">nohup</span> ./tools/SOAPdenovo2-master/SOAPdenovo-127mer pregraph -s config_file -o PB_501_127_d_3 -R -K 127 -p 60 -d 2 &gt;PB_501_127_d_3_pre.<span class="hljs-built_in">log</span> &amp;<br><span class="hljs-built_in">nohup</span> ./tools/SOAPdenovo2-master/SOAPdenovo-127mer contig -g PB_501_127_d_3 -R -p 60 &gt;PB_501_127_d_3_con.<span class="hljs-built_in">log</span> &amp;<br><span class="hljs-built_in">nohup</span> ./tools/SOAPdenovo2-master/SOAPdenovo-127mer map -s config_file -g PB_501_127_d_3 -p 60 -k 127 &gt;PB_501_127_d_3_map.<span class="hljs-built_in">log</span> &amp;  <br><span class="hljs-built_in">nohup</span> ./tools/SOAPdenovo2-master/SOAPdenovo-127mer scaff -g PB_501_127_d_3 -F -p 60 &gt;PB_501_127_d_3_scaf.<span class="hljs-built_in">log</span> &amp;<br></code></pre></td></tr></table></figure><h2 id="ç»Ÿè®¡"><a href="#ç»Ÿè®¡" class="headerlink" title="ç»Ÿè®¡"></a>ç»Ÿè®¡</h2><p><img src="/GeekFocus/2022-02-25-soapdenovo2/16.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/16.png" alt="img"></p><h2 id="ç»„è£…è¯„ä¼°"><a href="#ç»„è£…è¯„ä¼°" class="headerlink" title="ç»„è£…è¯„ä¼°"></a>ç»„è£…è¯„ä¼°</h2><p>QUASTè½¯ä»¶ä¸‹è½½:<a href="https://links.jianshu.com/go?to=https://sourceforge.net/projects/quast/files/quast-5.0.2.tar.gz/download">https://sourceforge.net/projects/quast/files/quast-5.0.2.tar.gz/download</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#è§£å‹å®‰è£…</span><br>tar -zxvf quast-5.0.2.tar.gz &amp;&amp; <span class="hljs-built_in">cd</span> quast-5.0.2<br>python  setup.py install_full<br></code></pre></td></tr></table></figure><h3 id="å‚è€ƒåŸºå› ç»„ä¸‹è½½"><a href="#å‚è€ƒåŸºå› ç»„ä¸‹è½½" class="headerlink" title="å‚è€ƒåŸºå› ç»„ä¸‹è½½"></a>å‚è€ƒåŸºå› ç»„ä¸‹è½½</h3><h3 id="QUASTä½¿ç”¨"><a href="#QUASTä½¿ç”¨" class="headerlink" title="QUASTä½¿ç”¨"></a>QUASTä½¿ç”¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">./tools/quast-5.0.2/quast.py -o ./quast_results -R ./reference/IRGSP-1.0_genome.fasta.gz -t 70 ./PB_501_results/PB_501_127_d_1/PB_501_127_d_1.scafSeq ./PB_501_results/PB_501_127_d_2/PB_501_127_d_2.scafSeq ./PB_501_results/PB_501_127_d_3/PB_501_127_d_3.scafSeq ./PB_501_results/PB_501_127_d_6/PB_501_127_d_6.scafSeq<br><span class="hljs-comment">#-oè¾“å‡ºç›®å½•</span><br><span class="hljs-comment">#-Rå‚è€ƒåŸºå› ç»„åºåˆ—</span><br><span class="hljs-comment">#-tçº¿ç¨‹æ•°</span><br><span class="hljs-comment">#åé¢ä¸ºè¦æ¯”è¾ƒçš„contig/scaffoldæ‰€åœ¨ç›®å½•ã€‚</span><br></code></pre></td></tr></table></figure><h2 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h2><h3 id="ç»Ÿè®¡ç»“æœ"><a href="#ç»Ÿè®¡ç»“æœ" class="headerlink" title="ç»Ÿè®¡ç»“æœ"></a>ç»Ÿè®¡ç»“æœ</h3><p>å°†contig&#x2F;scaffoldæ¯”å¯¹åˆ°å‚è€ƒåŸºå› ç»„ä¸Šï¼Œä¸‹é¢æ˜¯æ¯”å¯¹å¾—åˆ°çš„ç»“æœã€‚</p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/17.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/17.png" alt="img"></p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/18.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/18.png" alt="img"></p><p>ç´¯è®¡é•¿åº¦:è‹¥ä¸ç°è‰²çº¿é‡åˆè¶Šå¥½ï¼Œç»„è£…ç»“æœè¶Šå¥½ã€‚</p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/19.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/19.png" alt="img"></p><p>é”™è¯¯ç»„è£…æƒ…å†µï¼š</p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/20.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/20.png" alt="img"></p><p>GCå«é‡:</p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/21.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/21.png" alt="img"></p><h3 id="contig-x2F-scaffoldå¤§å°å¯è§†åŒ–"><a href="#contig-x2F-scaffoldå¤§å°å¯è§†åŒ–" class="headerlink" title="contig&#x2F;scaffoldå¤§å°å¯è§†åŒ–"></a>contig&#x2F;scaffoldå¤§å°å¯è§†åŒ–</h3><p><img src="/GeekFocus/2022-02-25-soapdenovo2/22.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/22.png" alt="img"></p><h3 id="æ¯”å¯¹åˆ°æ¯æ¡æŸ“è‰²ä½“æƒ…å†µ"><a href="#æ¯”å¯¹åˆ°æ¯æ¡æŸ“è‰²ä½“æƒ…å†µ" class="headerlink" title="æ¯”å¯¹åˆ°æ¯æ¡æŸ“è‰²ä½“æƒ…å†µ"></a>æ¯”å¯¹åˆ°æ¯æ¡æŸ“è‰²ä½“æƒ…å†µ</h3><p><img src="/GeekFocus/2022-02-25-soapdenovo2/23.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/23.png" alt="img"></p><p>æ¯”å¯¹åˆ°æ¯æ¡æŸ“è‰²ä½“å¯è§†åŒ–æƒ…å†µ:</p><p><img src="/GeekFocus/2022-02-25-soapdenovo2/24.png" alt="img"><br><img src="/GeekFocus/img/2022-02-25-soapdenovo2/24.png" alt="img"></p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>seqkit</title>
    <link href="/GeekFocus/2022/02/24/2022-02-24-Seqkit/"/>
    <url>/GeekFocus/2022/02/24/2022-02-24-Seqkit/</url>
    
    <content type="html"><![CDATA[<h1 id="SeqKit-a-cross-platform-and-ultrafast-toolkit-for-FASTA-x2F-Q-file-manipulation"><a href="#SeqKit-a-cross-platform-and-ultrafast-toolkit-for-FASTA-x2F-Q-file-manipulation" class="headerlink" title="SeqKit - a cross-platform and ultrafast toolkit for FASTA&#x2F;Q file manipulation"></a>SeqKit - a cross-platform and ultrafast toolkit for FASTA&#x2F;Q file manipulation</h1><span id="more"></span><p><a href="https://bioinf.shenwei.me/seqkit/usage/#fx2tab-tab2fx">Official doc</a></p><h1 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h1><ul><li>Basic: <a href="https://bioinf.shenwei.me/seqkit/usage/#seq">seq</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#stats">stats</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#subseq">subseq</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#sliding">sliding</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#faidx">faidx</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#watch">watch</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#sana">sana</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#scat">scat</a></li><li>Format conversion: <a href="https://bioinf.shenwei.me/seqkit/usage/#fq2fa">fq2fa</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#fx2tab-tab2fx">fx2tab</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#fx2tab-tab2fx">tab2fx</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#convert">convert</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#translate">translate</a></li><li>Searching: <a href="https://bioinf.shenwei.me/seqkit/usage/#grep">grep</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#locate">locate</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#amplicon">amplicon</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#fish">fish</a></li><li>Set operation: <a href="https://bioinf.shenwei.me/seqkit/usage/#sample">sample</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#rmdup">rmdup</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#common">common</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#duplicate">duplicate</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#split">split</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#split2">split2</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#head">head</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#head-genome">head-genome</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#range">range</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#pair">pair</a></li><li>Edit: <a href="https://bioinf.shenwei.me/seqkit/usage/#concat">concat</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#replace">replace</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#restart">restart</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#mutate">mutate</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#rename">rename</a></li><li>Ordering: <a href="https://bioinf.shenwei.me/seqkit/usage/#sort">sort</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#shuffle">shuffle</a></li><li>BAM processing: <a href="https://bioinf.shenwei.me/seqkit/usage/#bam">bam</a></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">conda install -c bioconda seqkit<br></code></pre></td></tr></table></figure><h1 id="command"><a href="#command" class="headerlink" title="command"></a>command</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs sh">amplicon        é€šè¿‡å¼•ç‰©æ£€ç´¢æ‰©å¢å­(æˆ–å…¶å‘¨å›´çš„ç‰¹å®šåŒºåŸŸ)<br>bam             æ£€æŸ¥å’Œåœ¨çº¿ç»˜åˆ¶BAMè®°å½•æ–‡ä»¶çš„ç›´æ–¹å›¾<br>common          é€šè¿‡<span class="hljs-built_in">id</span>/åç§°/åºåˆ—æŸ¥æ‰¾å¤šä¸ªæ–‡ä»¶çš„å…¬å…±åºåˆ—<br>concat          è¿æ¥å¤šä¸ªæ–‡ä»¶ä¸­å…·æœ‰ç›¸åŒIDçš„åºåˆ—<br>convert         è½¬æ¢FASTQè´¨é‡ç¼–ç æ ¼å¼ï¼šæ”¯æŒæ ¼å¼åŒ…æ‹¬ï¼šæ¡‘æ ¼ï¼ŒSolexaå’ŒIllumina<br>duplicate       é‡å¤åºåˆ—Næ¬¡<br>faidx           åˆ›å»ºFASTAç´¢å¼•æ–‡ä»¶å¹¶æå–å­åºåˆ—<br>fish            ä½¿ç”¨å±€éƒ¨æ¯”å¯¹åœ¨è¾ƒå¤§çš„åºåˆ—ä¸­å¯»æ‰¾çŸ­åºåˆ—<br>fq2fa           è½¬æ¢FASTQåˆ°FASTA<br>fx2tab          å°†FASTA/Qè½¬æ¢ä¸ºè¡¨æ ¼æ ¼å¼(åŒ…å«é•¿åº¦/GCå«é‡/GCåå¥½)<br>genautocomplete ç”Ÿæˆshellè‡ªåŠ¨å®Œæˆè„šæœ¬<br>grep            é€šè¿‡ID/name/sequence/sequence motifæœç´¢åºåˆ—ï¼Œå…è®¸é”™é…<br><span class="hljs-built_in">head</span>            æ‰“å°ç¬¬ä¸€æ¡åºåˆ—<br><span class="hljs-built_in">help</span>            æ‰“å°å¸®åŠ©ä¿¡æ¯<br>locate          å®šä½åºåˆ—ï¼Œæˆ–è€…motifsï¼Œå…è®¸é”™é…<br>mutate          ç¼–è¾‘åºåˆ—(ç‚¹çªå˜ã€æ’å…¥ã€åˆ é™¤)<br>pair            åŒ¹é…åŒç«¯åºåˆ—æ–‡ä»¶<br>range           æ‰“å°ä¸€ä¸ªèŒƒå›´å†…çš„åºåˆ—<br>rename          é‡å‘½åé‡å¤åºåˆ—ID<br>replace         ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹åç§°æˆ–è€…åºåˆ—<br>restart         é‡ç½®ç¯çŠ¶åŸºå› ç»„çš„èµ·å§‹ä½ç½®<br>rmdup           é€šè¿‡<span class="hljs-built_in">id</span>/åç§°/åºåˆ—åˆ é™¤é‡å¤çš„åºåˆ—<br>sample          æŒ‰æ•°é‡æˆ–æ¯”ä¾‹å¯¹åºåˆ—è¿›è¡ŒæŠ½æ ·<br>sana            æ¸…ç†æŸåçš„å•è¡Œfastqæ–‡ä»¶<br>scat            real time recursive concatenation and streaming of fastx files<br><span class="hljs-built_in">seq</span>             è½¬æ¢åºåˆ—(åå‘ï¼Œè¡¥å……ï¼Œæå–IDâ€¦)<br>shuffle         éšæœºåºåˆ—<br>sliding         åºåˆ—æ»‘çª—æå–ï¼Œæ”¯æŒç¯å½¢åŸºå› ç»„<br><span class="hljs-built_in">sort</span>            æŒ‰<span class="hljs-built_in">id</span>/åç§°/åºåˆ—/é•¿åº¦æ’åºåºåˆ—<br><span class="hljs-built_in">split</span>           æŒ‰<span class="hljs-built_in">id</span>/seqåŒºåŸŸ/å¤§å°/éƒ¨ä»¶å°†åºåˆ—æ‹†åˆ†ä¸ºæ–‡ä»¶(ä¸»è¦ç”¨äºFASTA)<br>split2          æŒ‰åºåˆ—æ•°é‡/æ–‡ä»¶æ•°å°†åºåˆ—æ‹†åˆ†ä¸ºå¤šä¸ªæ–‡ä»¶(FASTA, PE/SE FASTQ)<br>stats           FASTA/Qæ–‡ä»¶çš„ç®€å•ç»Ÿè®¡<br>subseq          é€šè¿‡region/gtf/bedå¾—åˆ°å­åºåˆ—ï¼ŒåŒ…æ‹¬ä¾§ç¿¼åºåˆ—<br>tab2fx          è½¬æ¢è¡¨æ ¼æ ¼å¼ä¸ºFASTA/Qæ ¼å¼<br>translate       ç¿»è¯‘DNA/RNAåˆ°è›‹ç™½è´¨åºåˆ—(æ”¯æŒæ­§ä¹‰ç¢±åŸº)<br>version         æ‰“å°ç‰ˆæœ¬ä¿¡æ¯å¹¶æ£€æŸ¥æ˜¯å¦æ›´æ–°<br>watch           åºåˆ—ç‰¹å¾çš„ç›‘æµ‹å’Œåœ¨çº¿ç›´æ–¹å›¾<br><br><br></code></pre></td></tr></table></figure><h1 id="Parameter"><a href="#Parameter" class="headerlink" title="Parameter:"></a>Parameter:</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh">Flags:<br>      --alphabet-guess-seq-length int   seqkitæ ¹æ®ç¬¬ä¸€ä¸ªFASTAè®°å½•çŒœæµ‹åºåˆ—ç±»å‹çš„åºåˆ—å‰ç¼€çš„é•¿åº¦(0è¡¨ç¤ºæ•´ä¸ªåºåˆ—)(é»˜è®¤10000)<br>  -h, --<span class="hljs-built_in">help</span>                            æ˜¾ç¤ºå¸®åŠ©<br>      --id-ncbi                         FASTAå¤´æ˜¯ncbié£æ ¼çš„ï¼Œä¾‹å¦‚&gt;gi|110645304|ref|NC_002516.2 <br>      --id-regexp string                ç”¨äºè§£æIDçš„æ­£åˆ™è¡¨è¾¾å¼(default <span class="hljs-string">&quot;^(\\S+)\\s?&quot;</span>)ï¼ŒåŒ¹é…ç©ºæ ¼å‰çš„éƒ¨åˆ†ä¸ºåºåˆ—å<br>      --infile-list string              è¾“å…¥æ–‡ä»¶åˆ—è¡¨ä¸­çš„æ–‡ä»¶ (one file per line), <span class="hljs-keyword">if</span> given, they are appended to files from cli arguments<br>  -w, --line-width int                  è¾“å‡ºFASTAæ ¼å¼æ—¶çš„è¡Œå®½ (0 <span class="hljs-keyword">for</span> no wrap) (default 60)<br>  -o, --out-file string                 è¾“å‡º (<span class="hljs-string">&quot;-&quot;</span> <span class="hljs-keyword">for</span> stdout, suffix .gz <span class="hljs-keyword">for</span> gzipped out) (default <span class="hljs-string">&quot;-&quot;</span>) -ä»£è¡¨æ ‡å‡†è¾“å‡ºï¼ŒåŠ .gzå¯è¾“å‡ºå‹ç¼©æ–‡ä»¶<br>      --quiet                           ä¿æŒå®‰é™ï¼Œä¸è¦æ˜¾ç¤ºé¢å¤–çš„ä¿¡æ¯<br>  -t, --seq-type string                 åºåˆ—ç±»å‹ (dna|rna|protein|<span class="hljs-built_in">unlimit</span>|auto) (auto, æŒ‰ç¬¬ä¸€ä¸ªåºåˆ—è‡ªåŠ¨æ£€æµ‹) (default <span class="hljs-string">&quot;auto&quot;</span>)<br>  -j, --threads int                     CPUæ•°é‡ (é»˜è®¤å•æ ¸ä¸º1ï¼Œå¤šæ ¸ä¸º2) (default 2)<br><br><br></code></pre></td></tr></table></figure><h1 id="stats-FASTA-x2F-Qæ–‡ä»¶çš„ç®€å•ç»Ÿè®¡"><a href="#stats-FASTA-x2F-Qæ–‡ä»¶çš„ç®€å•ç»Ÿè®¡" class="headerlink" title="stats FASTA&#x2F;Qæ–‡ä»¶çš„ç®€å•ç»Ÿè®¡"></a>stats FASTA&#x2F;Qæ–‡ä»¶çš„ç®€å•ç»Ÿè®¡</h1><p>ç»Ÿè®¡åºåˆ—æ ¼å¼fa&#x2F;fqã€å†…å®¹ç±»å‹DNA&#x2F;RNA&#x2F;Proteinï¼Œ<font color="red">åºåˆ—æ•°é‡ã€æ€»é•¿åº¦ï¼Œæœ€å°ã€å¹³å‡å’Œæœ€å¤§é•¿åº¦</font></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># FASTA DNA</span><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;&gt;seq\nacgtryswkmbdhvACGTRYSWKMBDHV&quot;</span> | seqkit stats<br>file  format  <span class="hljs-built_in">type</span>  num_seqs  sum_len  min_len  avg_len  max_len<br>-     FASTA   DNA          1       28       28       28       28<br><br><span class="hljs-comment"># RNA </span><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;&gt;seq\nACGUN\nACGUN&quot;</span> | seqkit stats<br>file  format  <span class="hljs-built_in">type</span>  num_seqs  sum_len  min_len  avg_len  max_len<br>-     FASTA   RNA          1       10       10       10       10<br><br><span class="hljs-comment"># Protein</span><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;&gt;seq\nabcdefghijklmnpqrstvwyz&quot;</span> | seqkit stats<br>file  format  <span class="hljs-built_in">type</span>     num_seqs  sum_len  min_len  avg_len  max_len<br>-     FASTA   Protein         1       23       23       23       23<br><br><span class="hljs-comment"># FASTQ DNA</span><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;@read\nACTGCN\n+\n@IICCG&quot;</span> | seqkit stats<br>file  format  <span class="hljs-built_in">type</span>  num_seqs  sum_len  min_len  avg_len  max_len<br>-     FASTQ   DNA          1        6        6        6        6<br><br>file                             format  <span class="hljs-built_in">type</span>     num_seqs         sum_len  min_len  avg_len  max_len<br>R1.fastq.gz  FASTQ   DNA   254,677,261  34,439,769,981       50    135.2      138<br><br></code></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment"># ä¸€èˆ¬æ¨¡å¼</span><br>seqkit stats C1_1.fq.gz<br><span class="hljs-comment">#--è¾“å‡ºç»“æœtabåˆ†éš”</span><br>seqkit stats C1_1.fq.gz <span class="hljs-operator">-</span><span class="hljs-built_in">T</span><br><span class="hljs-comment">#--è¾“å‡ºæ–‡ä»¶è½¬åŒ–å…¶ä»–æ ¼å¼</span><br>seqkit stats C1_1.fq.gz <span class="hljs-operator">-</span><span class="hljs-built_in">T</span><span class="hljs-operator">|</span> csvtk pretty <span class="hljs-operator">-</span>t<br>seqkit stats C1_1.fq.gz <span class="hljs-operator">-</span><span class="hljs-built_in">T</span><span class="hljs-operator">|</span> csvtk csv2md <span class="hljs-operator">-</span>t<br><span class="hljs-comment"># ç»Ÿè®¡æ›´å¤šä¿¡æ¯ -a</span><br>seqkit stats C1_1.fq.gz <span class="hljs-operator">-</span>a<br><span class="hljs-comment"># jå¤šçº¿ç¨‹åŠ é€Ÿï¼Œå°¤å…¶æ˜¯å¯¹äºå…·æœ‰å¤šä¸ªåºåˆ—æ–‡ä»¶ä¼šåŠ é€Ÿ</span><br><span class="hljs-comment"># seqkit stats -j 2 *.fq.gz</span><br><br><br></code></pre></td></tr></table></figure><h1 id="seq-è½¬æ¢åºåˆ—-ï¼ˆåå‘ã€äº’è¡¥-x2F-æå–IDï¼‰"><a href="#seq-è½¬æ¢åºåˆ—-ï¼ˆåå‘ã€äº’è¡¥-x2F-æå–IDï¼‰" class="headerlink" title="seq è½¬æ¢åºåˆ— ï¼ˆåå‘ã€äº’è¡¥&#x2F;æå–IDï¼‰"></a>seq è½¬æ¢åºåˆ— ï¼ˆåå‘ã€äº’è¡¥&#x2F;æå–IDï¼‰</h1><p>â€œ-nâ€: æå–åºåˆ—IDï¼ŒåŒ…æ‹¬â€œ&gt;â€åé¢çš„å…¨éƒ¨å†…å®¹</p><p>â€œ-n -iâ€: ä»…æå–ç¬¬ä¸€ä¸ªç©ºæ ¼å‰çš„ID</p><h1 id="æŒ‰é•¿åº¦è¿‡æ»¤-å¸¸ç”¨"><a href="#æŒ‰é•¿åº¦è¿‡æ»¤-å¸¸ç”¨" class="headerlink" title="æŒ‰é•¿åº¦è¿‡æ»¤(å¸¸ç”¨)"></a>æŒ‰é•¿åº¦è¿‡æ»¤(å¸¸ç”¨)</h1><p>æ‰©å¢å­åˆ†ææ—¶è¦ç­›é€‰æ‰©å¢é•¿åº¦ç›¸è¿‘çš„ç‰‡æ®µï¼Œè¿‡é•¿æˆ–è¿‡çŸ­ä¸€èˆ¬éƒ½è¦åˆ é™¤ã€‚å®åŸºå› ç»„ä¸­æ¯”å¦‚ç»„è£…çš„ç»“æœï¼Œç»å¸¸è¦è¿‡æ»¤&lt;200&#x2F;300bpçš„çŸ­ç‰‡æ®µï¼Œåˆ†ç®±æ—¶è¦ç­›é€‰&gt;1000&#x2F;2000çš„é•¿ç‰‡æ®µä½¿ç”¨ã€‚æœ¬æ¡å‘½ä»¤éå¸¸å¤šçš„åº”ç”¨åœºæ™¯ã€‚ç­›é€‰åç»“æœå¯ç”¨ &gt; å†™å…¥æ–‡ä»¶</p><p>-m æŒ‰ç…§åºåˆ—é•¿åº¦è¿‡æ»¤ï¼Œè¡¨ç¤ºä¿ç•™çš„æœ€å°é•¿åº¦ï¼Œ-M æ­¤ä¸ºä¿ç•™çš„æœ€å¤§é•¿åº¦</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#--æå–åºåˆ—é•¿åº¦å¤§äº60çš„å¹¶ç»Ÿè®¡é•¿åº¦ä¿¡æ¯</span><br>zcat hairpin.fa.gz | seqkit <span class="hljs-built_in">seq</span> -m 60 | seqkit stats<br><span class="hljs-comment"># è®¾ç½®æœ€å°åºåˆ—é•¿åº¦å’Œæœ€å¤§åºåˆ—é•¿åº¦ï¼Œç”¨äºè¿‡æ»¤åºåˆ—ï¼Œå¹¶ç»Ÿè®¡</span><br>zcat hairpin.fa.gz | seqkit <span class="hljs-built_in">seq</span> -m 100 -M 1000 | seqkit stats<br><span class="hljs-comment"># ä¿å­˜&gt;100ä¸”&lt;1000é•¿åº¦çš„åºåˆ—</span><br>seqkit <span class="hljs-built_in">seq</span> -m 100 -M 1000 hairpin.fa.gz &gt; hairpin100-1000.fa<br>seqkit <span class="hljs-built_in">stat</span> hairpin100-1000.fa<br><br></code></pre></td></tr></table></figure><h1 id="æå–ID"><a href="#æå–ID" class="headerlink" title="æå–ID"></a>æå–ID</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">head</span> gene.fa<br><span class="hljs-comment">## åç§°å…¨è¡Œ</span><br>seqkit <span class="hljs-built_in">seq</span> gene.fa -n | <span class="hljs-built_in">head</span><br><span class="hljs-comment"># ä»…ä»…æ‰“å°ID</span><br>seqkit <span class="hljs-built_in">seq</span> gene.fa -n -i | <span class="hljs-built_in">head</span><br> <br><span class="hljs-comment"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–åå­—ä¸­çš„ä¿¡æ¯</span><br>zcat hairpin.fa.gz | <span class="hljs-built_in">head</span><br><span class="hljs-comment"># æå–IDä¸­ç¬¬äºŒä¸ªå­—æ®µä½œä¸ºID</span><br>seqkit <span class="hljs-built_in">seq</span> hairpin.fa.gz -n -i --id-regexp <span class="hljs-string">&quot;^[^\s]+\s([^\s]+)\s&quot;</span> | <span class="hljs-built_in">head</span><br><br><br></code></pre></td></tr></table></figure><h1 id="å•è¡Œ-x2F-å¤šè¡Œè½¬æ¢"><a href="#å•è¡Œ-x2F-å¤šè¡Œè½¬æ¢" class="headerlink" title="å•è¡Œ&#x2F;å¤šè¡Œè½¬æ¢"></a>å•è¡Œ&#x2F;å¤šè¡Œè½¬æ¢</h1><ul><li>-sæå–å¹¶å±•ç¤ºåºåˆ—</li><li>-w ä»£è¡¨æ¯è¡Œçš„ç¢±åŸºæ•°é‡ï¼Œ0ä»£è¡¨ä¸æ¢è¡Œ</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#ä»…ä»…æå–åºåˆ— -s</span><br>seqkit <span class="hljs-built_in">seq</span> gene.fa -s -w 0|<span class="hljs-built_in">head</span><br><span class="hljs-comment">#--å°†å¤šè¡Œåºåˆ—è½¬åŒ–ä¸ºæ ‡å‡†4è¡ŒFASTQ</span><br>seqkit <span class="hljs-built_in">seq</span> C1_1.fq.gz -w 0|<span class="hljs-built_in">head</span><br></code></pre></td></tr></table></figure><h1 id="åå‘-x2F-äº’è¡¥"><a href="#åå‘-x2F-äº’è¡¥" class="headerlink" title="åå‘&#x2F;äº’è¡¥"></a>åå‘&#x2F;äº’è¡¥</h1><ul><li>-r åºåˆ—åå‘</li><li>-påºåˆ—äº’è¡¥</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># åºåˆ—åå‘äº’è¡¥,-råå‘ï¼Œ-päº’è¡¥</span><br>seqkit <span class="hljs-built_in">seq</span> hairpin.fa.gz -r -p|<span class="hljs-built_in">head</span><br></code></pre></td></tr></table></figure><h1 id="åˆ é™¤gap-x2F-å¤§å°å†™è½¬æ¢"><a href="#åˆ é™¤gap-x2F-å¤§å°å†™è½¬æ¢" class="headerlink" title="åˆ é™¤gap&#x2F;å¤§å°å†™è½¬æ¢"></a>åˆ é™¤gap&#x2F;å¤§å°å†™è½¬æ¢</h1><ul><li>-g å»é™¤åºåˆ—ä¸­çš„é—´éš”,å°†ä¸­é—´çš„æ¨ªæ å»æ‰</li><li>-uè½¬åŒ–åºåˆ—ä¸ºå¤§å†™å­—æ¯å±•ç¤º</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;&gt;seq\nACGT-ACTGC-acc&quot;</span> | seqkit <span class="hljs-built_in">seq</span> -g -u<br></code></pre></td></tr></table></figure><h1 id="RNAè½¬ä¸ºDNA"><a href="#RNAè½¬ä¸ºDNA" class="headerlink" title="RNAè½¬ä¸ºDNA"></a>RNAè½¬ä¸ºDNA</h1><ul><li>â€”rna2dna å°†RNAåºåˆ—è½¬åŒ–ä¸ºDNAåºåˆ—</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;&gt;seq\nUCAUAUGCUUGUCUCAAAGAUUA&quot;</span> | seqkit <span class="hljs-built_in">seq</span> --rna2dna<br></code></pre></td></tr></table></figure><h1 id="subseqé€šè¿‡æŒ‡å®šåŒºåŸŸ"><a href="#subseqé€šè¿‡æŒ‡å®šåŒºåŸŸ" class="headerlink" title="subseqé€šè¿‡æŒ‡å®šåŒºåŸŸ"></a>subseqé€šè¿‡æŒ‡å®šåŒºåŸŸ</h1><ul><li>-r é€šè¿‡åŒºåŸŸæ¥æˆªå–åºåˆ—</li></ul><p>å¦‚1:12æå–å‰12ä¸ªç¢±åŸºï¼Œ-12:-1æå–åºåˆ—ç»“å°¾12ä¸ªç¢±åŸºï¼›<br>for last 12 bases, 13:-1 for cutting first 12 bases. type â€œseqkit subseq -hâ€ for more examples</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment">#-æå–åºåˆ—å‰1ï¼š12ä¸ªç¢±åŸº</span><br><span class="hljs-attribute">zcat</span> C1_1.fq.gz | seqkit subseq -r <span class="hljs-number">1</span>:<span class="hljs-number">12</span> |head<br><span class="hljs-comment">#-æå–åºåˆ—æœ€å1ï¼š12ä¸ªç¢±åŸº</span><br><span class="hljs-attribute">zcat</span> C1_1.fq.gz | seqkit subseq -r -<span class="hljs-number">12</span>:-<span class="hljs-number">1</span> |head<br> <br><span class="hljs-comment">#å–ç¬¬12è‡³å€’æ•°ç¬¬12ä¸ªç¢±åŸºï¼Œå³å‰11å’Œå11ä¸ªç¢±åŸºå»æ‰</span><br><span class="hljs-attribute">zcat</span> C1_1.fq.gz | seqkit subseq -r <span class="hljs-number">12</span>:-<span class="hljs-number">12</span>| head<br></code></pre></td></tr></table></figure><p>åŸºäºgtf&#x2F;bedä¿¡æ¯æŒ‘é€‰å­åºåˆ—ã€‚</p><p>â€”gtf  æ ¹æ®gtfæ–‡ä»¶æŒ‘é€‰åŸºå› ï¼Œè¿™éƒ¨åˆ†åŠŸèƒ½ç”¨äºæ ¹æ®åŸºå› æ³¨é‡Šå¿«é€Ÿæå–åŸºå› åºåˆ—ï¼Œåœ¨å®åŸºå› ç»„ã€è½¬å½•ç»„ã€é‡æµ‹åºä¸­å¸¸ç”¨ã€‚â€”chr é€‰æ‹©æŸ“è‰²ä½“ï¼Œâ€”feature cdsé€‰æ‹©åºåˆ—ç±»å‹</p><p>ä»¥æ‹Ÿå—èŠ¥åŸºå› ç»„çš„åºåˆ—å’Œæ³¨é‡Šæ•°æ®æ¼”ç¤ºï¼šæå–ç¬¬ä¸€æ¡æŸ“è‰²ä½“ä¸Šçš„CDSåŸºå› ä¿¡æ¯ï¼Œå¹¶ç»Ÿè®¡åŸºæœ¬ä¿¡æ¯</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">seqkit subseq <span class="hljs-attr">--gtf</span> Arabidopsis_thaliana<span class="hljs-selector-class">.TAIR10</span>.<span class="hljs-number">49</span><span class="hljs-selector-class">.gtf</span><span class="hljs-selector-class">.gz</span> <span class="hljs-attr">--chr</span> <span class="hljs-number">1</span> <span class="hljs-attr">--feature</span> cds  Arabidopsis_thaliana<span class="hljs-selector-class">.TAIR10</span><span class="hljs-selector-class">.dna</span><span class="hljs-selector-class">.toplevel</span><span class="hljs-selector-class">.fa</span><span class="hljs-selector-class">.gz</span>  &gt; chr1<span class="hljs-selector-class">.gtf</span><span class="hljs-selector-class">.cds</span><span class="hljs-selector-class">.fa</span><br>seqkit stats chr1<span class="hljs-selector-class">.gtf</span><span class="hljs-selector-class">.cds</span><span class="hljs-selector-class">.fa</span><br><br><br></code></pre></td></tr></table></figure><ul><li>-u å¯ä»¥æå–ç›®æ ‡åŸºå› ä¸Šæ¸¸çš„åºåˆ—</li><li>-f ç›®æ ‡åŒºåŸŸä¸å±•ç¤º</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment">#--æŒ‘é€‰åºåˆ—å¹¶å¤šåŠ ä¸Šä¸Šæ¸¸çš„3ä¸ªç¢±åŸº</span><br><span class="hljs-attribute">seqkit</span> subseq --gtf Arabidopsis_thaliana.TAIR10.<span class="hljs-number">49</span>.gtf.gz Arabidopsis_thaliana.TAIR10.dna.toplevel.fa.gz -u <span class="hljs-number">3</span> |head<br> <br><span class="hljs-comment"># ä»…æå–ä¸Šæ¸¸åºåˆ—ï¼Œå¦‚æå–å¯åŠ¨å­åŒº2kï¼š-fä»…å®šä½ä¸è¾“å‡ºä½ç½®åºåˆ—ï¼Œ-uè¾“å‡ºä¸Šæ¸¸åºåˆ—ï¼Œæ­¤å¤„ç¤ºä¾‹3bp</span><br><span class="hljs-attribute">seqkit</span> subseq --gtf Arabidopsis_thaliana.TAIR10.<span class="hljs-number">49</span>.gtf.gz Arabidopsis_thaliana.TAIR10.dna.toplevel.fa.gz -u <span class="hljs-number">3</span> -f |head<br><br><br></code></pre></td></tr></table></figure><h1 id="sliding-æ»‘çª—æå–åºåˆ—ï¼Œæ”¯æŒç¯çŠ¶åŸºå› ç»„"><a href="#sliding-æ»‘çª—æå–åºåˆ—ï¼Œæ”¯æŒç¯çŠ¶åŸºå› ç»„" class="headerlink" title="sliding æ»‘çª—æå–åºåˆ—ï¼Œæ”¯æŒç¯çŠ¶åŸºå› ç»„"></a>sliding æ»‘çª—æå–åºåˆ—ï¼Œæ”¯æŒç¯çŠ¶åŸºå› ç»„</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment">#-s æ­¥é•¿ä¸º3ï¼Œ-W åºåˆ—é•¿åº¦ä¸º6ä¸ªç¢±åŸº</span><br><span class="hljs-attribute">echo</span> -e <span class="hljs-string">&quot;&gt;seq\nACGTacgtNN&quot;</span> | seqkit sliding -s <span class="hljs-number">3</span> -W <span class="hljs-number">6</span><br><span class="hljs-comment"># -g è´ªå©ªæ¨¡å¼ï¼Œåé¢ä¸è¶³6ä¸ªé‚£ä¹Ÿå–</span><br><span class="hljs-attribute">echo</span> -e <span class="hljs-string">&quot;&gt;seq\nACGTacgtNN&quot;</span> | seqkit sliding -s <span class="hljs-number">3</span> -W <span class="hljs-number">6</span> -g<br><span class="hljs-comment"># ç¯çŠ¶DNAæ¨¡å¼-Cï¼Œé¦–å°¾ä¸ç®—ä¸­æ–­ï¼Œç¯çŠ¶</span><br><span class="hljs-attribute">echo</span> -e <span class="hljs-string">&quot;&gt;seq\nACGTacgtNN&quot;</span> | seqkit sliding -s <span class="hljs-number">3</span> -W <span class="hljs-number">6</span> -C<br><br><br></code></pre></td></tr></table></figure><ul><li>æ­¥é•¿ä¸º5ï¼Œå–30ä¸ªç¢±åŸºåºåˆ—ï¼Œç„¶åç»Ÿè®¡GCå«é‡</li></ul><ul><li>fx2tabï¼šç»Ÿè®¡fasta&#x2F;fastqåºåˆ—çš„ä¿¡æ¯ä¸ºè¡¨æ ¼</li><li>-nä»…è¾“å‡ºIDï¼Œä¸è¾“å‡ºåºåˆ—</li><li>-gä¸ºGCå«é‡</li></ul><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coq">zcat hairpin.fa.gz | <span class="hljs-type">seqkit</span> sliding -s <span class="hljs-number">5</span> -W <span class="hljs-number">30</span> | <span class="hljs-type">seqkit</span> fx2tab -n -g |<span class="hljs-type">head</span><br></code></pre></td></tr></table></figure><h1 id="faidx-åˆ›å»ºFASTAç´¢å¼•æ–‡ä»¶å¹¶æå–å­åºåˆ—"><a href="#faidx-åˆ›å»ºFASTAç´¢å¼•æ–‡ä»¶å¹¶æå–å­åºåˆ—" class="headerlink" title="faidx åˆ›å»ºFASTAç´¢å¼•æ–‡ä»¶å¹¶æå–å­åºåˆ—"></a>faidx åˆ›å»ºFASTAç´¢å¼•æ–‡ä»¶å¹¶æå–å­åºåˆ—</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># è§£å‹</span><br><span class="hljs-attribute">zcat</span> hairpin.fa.gz &gt; hairpin.fa<br> <br><span class="hljs-comment"># å»ºç´¢å¼•*.faiæ–‡ä»¶</span><br><span class="hljs-attribute">seqkit</span> faidx hairpin.fa<br> <br><span class="hljs-comment"># IDä¿¡æ¯ï¼šhsa-let-7a-1 hsa-let-7a-2</span><br><span class="hljs-attribute">seqkit</span> faidx hairpin.fa hsa-let-<span class="hljs-number">7</span>a-<span class="hljs-number">1</span> hsa-let-<span class="hljs-number">7</span>a-<span class="hljs-number">2</span><br><span class="hljs-comment"># -f æ ‡é¢˜è¡Œå…¨éƒ¨æ˜¾ç¤º</span><br><span class="hljs-attribute">seqkit</span> faidx hairpin.fa hsa-let-<span class="hljs-number">7</span>a-<span class="hljs-number">1</span> hsa-let-<span class="hljs-number">7</span>a-<span class="hljs-number">2</span> -f<br><span class="hljs-comment"># æå–åºåˆ—å¹¶é€‰æ‹©åŒºåŸŸæ˜¾ç¤º</span><br><span class="hljs-attribute">seqkit</span> faidx hairpin.fa hsa-let-<span class="hljs-number">7</span>a-<span class="hljs-number">1</span>:<span class="hljs-number">1</span>-<span class="hljs-number">10</span><br><span class="hljs-attribute">seqkit</span> faidx hairpin.fa hsa-let-<span class="hljs-number">7</span>a-<span class="hljs-number">1</span>:-<span class="hljs-number">10</span>--<span class="hljs-number">1</span><br><span class="hljs-attribute">seqkit</span> faidx hairpin.fa hsa-let-<span class="hljs-number">7</span>a-<span class="hljs-number">1</span>:<span class="hljs-number">1</span><br><span class="hljs-comment"># æ£€æŸ¥hsaå¼€å¤´çš„åºåˆ—å¹¶ç»Ÿè®¡</span><br><span class="hljs-attribute">seqkit</span> faidx hairpin.fa hsa -r | seqkit stats<br><br><br></code></pre></td></tr></table></figure><h1 id="watch-åºåˆ—è´¨é‡çš„ç›‘æµ‹å’Œåœ¨çº¿ç›´æ–¹å›¾"><a href="#watch-åºåˆ—è´¨é‡çš„ç›‘æµ‹å’Œåœ¨çº¿ç›´æ–¹å›¾" class="headerlink" title="watch åºåˆ—è´¨é‡çš„ç›‘æµ‹å’Œåœ¨çº¿ç›´æ–¹å›¾"></a>watch åºåˆ—è´¨é‡çš„ç›‘æµ‹å’Œåœ¨çº¿ç›´æ–¹å›¾</h1><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment">#-å–å¯¹æ•°å±•ç¤ºç›´æ–¹å›¾</span><br>seqkit watch <span class="hljs-literal">-L</span> <span class="hljs-operator">-f</span> ReadLen hairpin.fa<br> <br><span class="hljs-comment"># æ¯äº”åƒä¸ªåšä¸€ä¸ªå›¾ä¿å­˜åœ¨pdfæ–‡ä»¶ä¸­</span><br>seqkit watch <span class="hljs-literal">-p</span> <span class="hljs-number">500000</span> <span class="hljs-literal">-O</span> qhist.pdf <span class="hljs-operator">-f</span> MeanQual C1_1.fq.gz<br></code></pre></td></tr></table></figure><p>ä»æœ‰é”™è¯¯è®°å½•çš„fastqæ–‡ä»¶ä¸­æŒ½æ•‘å¯ç”¨çš„è¯»å–</p><h1 id="sanaï¼šæ¸…ç†æŸåfastqæ–‡ä»¶"><a href="#sanaï¼šæ¸…ç†æŸåfastqæ–‡ä»¶" class="headerlink" title="sanaï¼šæ¸…ç†æŸåfastqæ–‡ä»¶"></a>sanaï¼šæ¸…ç†æŸåfastqæ–‡ä»¶</h1><p>è¿™é‡Œæˆ‘ä¸“é—¨å°†C1_1.fqçš„ç¬¬ä¸€ä¸ªåºåˆ—è¿›è¡Œäº†é”™ä½ï¼Œè¿›è¡Œæµ‹è¯•ã€‚è¿™ä¸ªæ“ä½œå¾€å¾€åœ¨è¿›è¡Œæ•°æ®æ•´åˆçš„æ—¶å€™å¯ä»¥æœ‰å¾ˆå¤§ä½œç”¨ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">zcat</span> C1_1.fq.gz|sed <span class="hljs-string">&#x27;2 s/^/A/&#x27;</span> &gt; C1_1_bad.fq<br>seqkit sana C1_1_bad.fq -o rescued.fq.gz<br></code></pre></td></tr></table></figure><h1 id="fq2fa-å°†fqè½¬ä¸ºfaæ ¼å¼"><a href="#fq2fa-å°†fqè½¬ä¸ºfaæ ¼å¼" class="headerlink" title="fq2fa å°†fqè½¬ä¸ºfaæ ¼å¼"></a>fq2fa å°†fqè½¬ä¸ºfaæ ¼å¼</h1><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">seqkit fq2fa <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">C1_1</span>.</span></span>fq.gz -o <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">C1_1</span>.</span></span>fa<br></code></pre></td></tr></table></figure><h1 id="fx2tab-amp-tab2fx-åºåˆ—è½¬åŒ–è¡¨æ ¼æ ¼å¼"><a href="#fx2tab-amp-tab2fx-åºåˆ—è½¬åŒ–è¡¨æ ¼æ ¼å¼" class="headerlink" title="fx2tab &amp; tab2fx åºåˆ—è½¬åŒ–è¡¨æ ¼æ ¼å¼"></a>fx2tab &amp; tab2fx åºåˆ—è½¬åŒ–è¡¨æ ¼æ ¼å¼</h1><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs ldif">è¿™ä¸€è½¬åŒ–å¾ˆæœ‰ç”¨ï¼Œå¾€å¾€ç”¨äºè¡¨æ ¼/çŸ©é˜µå¤„ç†çš„æ—¶å€™ã€‚<br>seqkit fx2tab hairpin.fa.gz | head -n 2<br>é€šè¿‡çŸ©é˜µæ ¼å¼çš„åºåˆ—æ–‡ä»¶ç»Ÿè®¡åºåˆ—é•¿åº¦å’Œè´¨é‡å€¼<br><br><span class="hljs-literal">-</span>l ç»Ÿè®¡åºåˆ—é•¿åº¦<br><br><span class="hljs-literal">-</span>g ç»Ÿè®¡å¹³å‡GCå«é‡<br><br><span class="hljs-literal">-</span>i åªæ‰“å°åç§°(ä¸æ‰“å°åºåˆ—)<br><br><span class="hljs-literal">-</span>H æ‰“å°æ ‡é¢˜è¡Œ<br><span class="hljs-comment"># æ‰“å°åºåˆ—é•¿åº¦ã€GCå«é‡</span><br>seqkit fx2tab hairpin.fa.gz -l -g -n -i -H | head<br><br><br></code></pre></td></tr></table></figure><p>tab2fx å’Œè¡¨æ ¼æ ¼å¼è½¬åŒ–ä¸ºåºåˆ—æ ¼å¼</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta"># seqkit tab2fx è¡¨æ ¼å½¢å¼è½¬åŒ–ä¸ºåºåˆ—å½¢å¼</span><br>zcat hairpin.fa.gz <span class="hljs-string">| seqkit fx2tab | seqkit tab2fx | head</span><br> <br><span class="hljs-meta"># è½¬åŒ–ä¸ºè¡¨æ ¼ï¼Œç„¶åæ’åºï¼Œç„¶åè½¬åŒ–å›å»</span><br>zcat hairpin.fa.gz \<br>    <span class="hljs-string">| seqkit fx2tab -l \</span><br>    <span class="hljs-string">| sort -t &quot;</span>`echo -e &#x27;\t&#x27;`<span class="hljs-string">&quot; -n -k4,4 \</span><br>    <span class="hljs-string">| seqkit tab2fx | head</span><br><span class="hljs-meta"># ç­‰åŒäºä¸‹é¢çš„å‘½ä»¤</span><br>seqkit sort -l hairpin.fa.gz <span class="hljs-string">| head</span><br> <br><span class="hljs-meta"># é€šè¿‡è¿™ä¸ªè½¬åŒ–å¯ä»¥å°†å¾ˆå¤šåœ¨è¡¨æ ¼ä¸­å®ç°çš„æ•°æ®å¤„ç†æ–¹æ³•ç”¨äºåºåˆ—</span><br>ä¾‹å¦‚ä¸‹é¢çš„æå–<span class="hljs-number">1000</span>ä¸ªåºåˆ—ï¼šseqkit fx2tab hairpin.fa.gz <span class="hljs-string">| head -n 1000 | seqkit tab2fx | head</span><br></code></pre></td></tr></table></figure><h1 id="translate-ç¿»è¯‘DNA-x2F-RNAä¸ºè›‹ç™½è´¨åºåˆ—"><a href="#translate-ç¿»è¯‘DNA-x2F-RNAä¸ºè›‹ç™½è´¨åºåˆ—" class="headerlink" title="translate ç¿»è¯‘DNA&#x2F;RNAä¸ºè›‹ç™½è´¨åºåˆ—"></a>translate ç¿»è¯‘DNA&#x2F;RNAä¸ºè›‹ç™½è´¨åºåˆ—</h1><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs processing">#--è½¬åŒ–ä¸ºè›‹ç™½åºåˆ—<br>seqkit <span class="hljs-built_in">translate</span> gene.<span class="hljs-property">fa</span>|head<br> <br># å»é™¤<span class="hljs-string">&#x27;X&#x27;</span> å’Œ <span class="hljs-string">&#x27;*&#x27;</span><br>seqkit <span class="hljs-built_in">translate</span> hairpin.<span class="hljs-property">fa</span> <br>seqkit <span class="hljs-built_in">translate</span> hairpin.<span class="hljs-property">fa</span> --<span class="hljs-built_in">trim</span> | head<br></code></pre></td></tr></table></figure><h1 id="grep-åºåˆ—åŒ¹é…"><a href="#grep-åºåˆ—åŒ¹é…" class="headerlink" title="grep  åºåˆ—åŒ¹é…"></a>grep  åºåˆ—åŒ¹é…</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ç”Ÿæˆä¸€ä¸ªIDåˆ—è¡¨</span><br>grep <span class="hljs-string">&#x27;&gt;&#x27;</span> C1_1.fa|<span class="hljs-built_in">cut</span> -c2-|<span class="hljs-built_in">head</span> -n 10 &gt; id.txt<br> <br><span class="hljs-comment"># ä½¿ç”¨åºåˆ—idåˆ—è¡¨è¿›è¡Œæœç´¢(ä¸åŒ…å«ç©ºæ ¼)</span><br>seqkit grep -f id.txt C1_1.fq.gz -o result.fq.gz<br><span class="hljs-comment"># ä½¿ç”¨åºåˆ—åç§°åˆ—è¡¨è¿›è¡Œæœç´¢(å®ƒä»¬å¯èƒ½åŒ…å«ç©ºæ ¼)</span><br>seqkit grep -n -f id.txt C1_1.fq.gz -o result.fa.gz<br>zcat  result.fa.gz<br><span class="hljs-comment"># æå–hsaå¼€å¤´çš„åºåˆ—</span><br>zcat hairpin.fa.gz | seqkit grep -r -p ^hsa |<span class="hljs-built_in">head</span><br> <br><span class="hljs-comment"># -vå‚æ•°vç”¨äºç§»é™¤åºåˆ—</span><br>zcat hairpin.fa.gz | seqkit grep -r -p ^hsa -p ^mmu -v | <span class="hljs-built_in">head</span><br> <br><span class="hljs-comment"># æå–ID</span><br>zcat miRNA.diff.gz | grep ^<span class="hljs-comment"># -v | grep NEW | cut -f 2 &gt; list</span><br><span class="hljs-built_in">head</span> list<br><span class="hljs-comment"># æ ¹æ®IDæå–æ–‡ä»¶</span><br>zcat hairpin.fa.gz | seqkit grep -f list &gt; new.fa<br><span class="hljs-built_in">head</span> new.fa<br> <br><span class="hljs-comment"># æå–åŒ…å«ç‰¹å®šç¢±åŸºç»„åˆçš„åºåˆ—</span><br><span class="hljs-built_in">cat</span> hairpin.fa.gz | seqkit grep -s -i -p aggcg |<span class="hljs-built_in">head</span><br><span class="hljs-comment"># ç»Ÿè®¡</span><br><span class="hljs-built_in">cat</span> hairpin.fa.gz | seqkit grep -s -i -p aggcg | seqkit stats<br> <br><span class="hljs-comment">#  å»é™¤ åŒ…å«ç‰¹å®šç»„åˆç¢±åŸºçš„åºåˆ—</span><br>zcat hairpin.fa.gz | seqkit grep -s -r -i -p ^aggcg |<span class="hljs-built_in">head</span><br><br><br></code></pre></td></tr></table></figure><h1 id="locate-è¾“å‡ºåŒ¹é…ä½ç½®"><a href="#locate-è¾“å‡ºåŒ¹é…ä½ç½®" class="headerlink" title="locate è¾“å‡ºåŒ¹é…ä½ç½®"></a>locate è¾“å‡ºåŒ¹é…ä½ç½®</h1><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs 1c">ï¼ƒã€€å…¶ä»–ä¸¤ç§è¾“å‡ºæ ¼å¼<br>zcat hairpin.fa.gz <span class="hljs-string">| seqkit locate -i -d -p AUGGACUN --bed</span><br>zcat hairpin.fa.gz <span class="hljs-string">| seqkit locate -i -d -p AUGGACUN --gtf</span><br><br><br></code></pre></td></tr></table></figure><h1 id="fish-ä½¿ç”¨å±€éƒ¨æ¯”å¯¹åœ¨è¾ƒå¤§çš„åºåˆ—ä¸­å¯»æ‰¾çŸ­åºåˆ—"><a href="#fish-ä½¿ç”¨å±€éƒ¨æ¯”å¯¹åœ¨è¾ƒå¤§çš„åºåˆ—ä¸­å¯»æ‰¾çŸ­åºåˆ—" class="headerlink" title="fish ä½¿ç”¨å±€éƒ¨æ¯”å¯¹åœ¨è¾ƒå¤§çš„åºåˆ—ä¸­å¯»æ‰¾çŸ­åºåˆ—"></a>fish ä½¿ç”¨å±€éƒ¨æ¯”å¯¹åœ¨è¾ƒå¤§çš„åºåˆ—ä¸­å¯»æ‰¾çŸ­åºåˆ—</h1><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs 1c">echo -e &#x27;&gt;seq\nACGACGACGA&#x27; \<br>    <span class="hljs-string">| seqkit locate -p ACGA -G | csvtk -t pretty</span><br> <br>echo -e &#x27;&gt;seq\nACGACGACGA&#x27; \<br>    <span class="hljs-string">| seqkit fish -F ACGA -a 2&gt;&amp;1 | csvtk -t pretty</span><br><br><br></code></pre></td></tr></table></figure><h1 id="amplicon-é€šè¿‡å¼•ç‰©æ£€ç´¢æ‰©å¢å­-æˆ–å…¶å‘¨å›´çš„ç‰¹å®šåŒºåŸŸ"><a href="#amplicon-é€šè¿‡å¼•ç‰©æ£€ç´¢æ‰©å¢å­-æˆ–å…¶å‘¨å›´çš„ç‰¹å®šåŒºåŸŸ" class="headerlink" title="amplicon é€šè¿‡å¼•ç‰©æ£€ç´¢æ‰©å¢å­(æˆ–å…¶å‘¨å›´çš„ç‰¹å®šåŒºåŸŸ)"></a>amplicon é€šè¿‡å¼•ç‰©æ£€ç´¢æ‰©å¢å­(æˆ–å…¶å‘¨å›´çš„ç‰¹å®šåŒºåŸŸ)</h1><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">echo</span> <span class="hljs-operator">-ne</span> <span class="hljs-string">&quot;&gt;seq\nacgcccactgaaatga\n&quot;</span> \<br>    | seqkit amplicon <span class="hljs-operator">-F</span> ccc <span class="hljs-literal">-R</span> ttt<br> <br><span class="hljs-comment"># è®¾ç½®è¾“å‡ºæ ¼å¼ä¸ºbedï¼ŒåŒ¹é…çš„ä½ç‚¹ç­‰ä¿¡æ¯</span><br><span class="hljs-built_in">echo</span> <span class="hljs-operator">-ne</span> <span class="hljs-string">&quot;&gt;seq\nacgcccactgaaatga\n&quot;</span> \<br>    | seqkit amplicon <span class="hljs-operator">-F</span> ccc <span class="hljs-literal">-R</span> ttt <span class="hljs-literal">--bed</span><br> <br><span class="hljs-comment">#- ä½¿ç”¨å¼•ç‰©æ–‡ä»¶ï¼Œè¿™ç”¨äºåˆ˜è€å¸ˆç»„çš„é«˜é€šé‡åˆ†èŒçš„åºåˆ—æ‹†åˆ†é€Ÿåº¦åº”è¯¥å¾ˆå®¢è§‚</span><br><span class="hljs-comment"># cat seqs4amplicon.fa | seqkit amplicon -p primers.tsv --bed</span><br><br><br></code></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment"># è¾“å‡ºé™¤å»å¼•ç‰©ä¹‹å¤–çš„éƒ¨åˆ†ï¼Œ-rè¾“å‡ºå‡ ä¸ªç¢±åŸº</span><br><span class="hljs-built_in">echo</span> <span class="hljs-operator">-ne</span> <span class="hljs-string">&quot;&gt;seq\nacgcccactgaaatga\n&quot;</span> \<br>    | seqkit amplicon <span class="hljs-operator">-F</span> ccc <span class="hljs-literal">-R</span> ttt <span class="hljs-literal">-r</span> <span class="hljs-number">4</span>:<span class="hljs-number">7</span><br><span class="hljs-comment"># è¾“å‡ºæ ¼å¼ä¸ºbed</span><br><span class="hljs-built_in">echo</span> <span class="hljs-operator">-ne</span> <span class="hljs-string">&quot;&gt;seq\nacgcccactgaaatga\n&quot;</span> \<br>    | seqkit amplicon <span class="hljs-operator">-F</span> ccc <span class="hljs-literal">-R</span> ttt <span class="hljs-literal">-r</span> <span class="hljs-number">4</span>:<span class="hljs-number">7</span> <span class="hljs-literal">--bed</span><br><br><br></code></pre></td></tr></table></figure><h1 id="duplicate-å¯¹åºåˆ—é‡å¤Næ¬¡"><a href="#duplicate-å¯¹åºåˆ—é‡å¤Næ¬¡" class="headerlink" title="duplicate å¯¹åºåˆ—é‡å¤Næ¬¡"></a>duplicate å¯¹åºåˆ—é‡å¤Næ¬¡</h1><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta"># é‡å¤åºåˆ—1æ¬¡ï¼Œä½†æ˜¯åå­—æ²¡æœ‰ä¿®æ”¹</span><br>cat hairpin.fa <span class="hljs-string">| seqkit head -n 1 \</span><br>    <span class="hljs-string">| seqkit duplicate -n 2</span><br><span class="hljs-meta"># å¯¹é‡å¤åºåˆ—æ”¹åï¼Œä½¿å…¶ç‹¬ä¸€æ— äºŒ</span><br>cat hairpin.fa <span class="hljs-string">| seqkit head -n 1 \</span><br>    <span class="hljs-string">| seqkit duplicate -n 2 | seqkit rename</span><br><br><br></code></pre></td></tr></table></figure><h1 id="rmdup-é€šè¿‡id-x2F-åç§°-x2F-åºåˆ—åˆ é™¤é‡å¤çš„åºåˆ—"><a href="#rmdup-é€šè¿‡id-x2F-åç§°-x2F-åºåˆ—åˆ é™¤é‡å¤çš„åºåˆ—" class="headerlink" title="rmdup é€šè¿‡id&#x2F;åç§°&#x2F;åºåˆ—åˆ é™¤é‡å¤çš„åºåˆ—"></a>rmdup é€šè¿‡id&#x2F;åç§°&#x2F;åºåˆ—åˆ é™¤é‡å¤çš„åºåˆ—</h1><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta"># å»é™¤é‡å¤çš„åºåˆ—</span><br>zcat hairpin.fa.gz <span class="hljs-string">| seqkit rmdup -s -o clean.fa.gz</span><br> <br><span class="hljs-meta"># ä¿å­˜é‡å¤åºåˆ—å¾—åˆ°æ–‡ä»¶ -D duplicated.detail.txt</span><br>zcat hairpin.fa.gz \<br>    <span class="hljs-string">| seqkit rmdup -s -i -o clean.fa.gz -d duplicated.fa.gz -D duplicated.detail.txt</span><br><br><br></code></pre></td></tr></table></figure><h1 id="common-ï¼šé€šè¿‡id-x2F-åç§°-x2F-åºåˆ—æŸ¥æ‰¾å¤šä¸ªæ–‡ä»¶çš„å…¬å…±åºåˆ—"><a href="#common-ï¼šé€šè¿‡id-x2F-åç§°-x2F-åºåˆ—æŸ¥æ‰¾å¤šä¸ªæ–‡ä»¶çš„å…¬å…±åºåˆ—" class="headerlink" title="common ï¼šé€šè¿‡id&#x2F;åç§°&#x2F;åºåˆ—æŸ¥æ‰¾å¤šä¸ªæ–‡ä»¶çš„å…¬å…±åºåˆ—"></a>common ï¼šé€šè¿‡id&#x2F;åç§°&#x2F;åºåˆ—æŸ¥æ‰¾å¤šä¸ªæ–‡ä»¶çš„å…¬å…±åºåˆ—</h1><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs axapta"><span class="hljs-meta"># é€šè¿‡IDåŒ¹é…ï¼Œæ–‡ä»¶å¤¹ä¸‹å…¨éƒ¨çš„faåºåˆ—å…¬å…±éƒ¨åˆ†è¾“å‡ºæ¥</span><br>seqkit <span class="hljs-keyword">common</span> *.fq.gz<br> <br><span class="hljs-meta"># é€šè¿‡-nå®ç°å…¨éƒ¨åå­—åŒ¹é…ï¼Œ-oè¾“å‡ºç»“æœ</span><br>seqkit <span class="hljs-keyword">common</span> *.fq.gz -n -o <span class="hljs-keyword">common</span>.fq <br><span class="hljs-meta"># é€šè¿‡-såºåˆ—åŒ¹é…</span><br>seqkit <span class="hljs-keyword">common</span> *.fq.gz -s -i -o <span class="hljs-keyword">common</span>.fq<br><br><br></code></pre></td></tr></table></figure><h1 id="split-æ‹†åˆ†åºåˆ—ä¸ºå­æ–‡ä»¶"><a href="#split-æ‹†åˆ†åºåˆ—ä¸ºå­æ–‡ä»¶" class="headerlink" title="split æ‹†åˆ†åºåˆ—ä¸ºå­æ–‡ä»¶"></a>split æ‹†åˆ†åºåˆ—ä¸ºå­æ–‡ä»¶</h1><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs tcl">æŒ‰åç§°IDã€ç»™å®šåŒºåŸŸçš„å­åºåˆ—ã€æ–‡ä»¶å¤§å°æˆ–åºåˆ—æ•°é‡å°†åºåˆ—æ‹†åˆ†ä¸ºæ–‡ä»¶<br><br>å¯ç”¨äºå°†å¤§æ–‡ä»¶æ‹†åˆ†åï¼Œå¹¶è¡Œå¤„ç†ï¼ŒåŠ é€Ÿåˆ†æã€‚å¦‚ä»contigä¸­é¢„æµ‹åŸºå› ã€‚<br><span class="hljs-comment">#æŒ‰ç…§10000ä¸ªåºåˆ—ä¸ºä¸€ä¸ªæ–‡ä»¶æ‹†åˆ†ï¼Œç»“æœä¸ºhairpin.fa.gz.split/ç›®å½• ï¼Œæ–‡ä»¶åä¸ºhairpin.part_00x.fastaï¼Œ-s</span><br>seqkit <span class="hljs-keyword">split</span> hairpin.fa.gz -s <span class="hljs-number">10000</span> <span class="hljs-number">-2</span><br> <br><span class="hljs-comment"># å°†åºåˆ—æ‹†åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†(å¸¸ç”¨ï¼Œç­‰åˆ†ç„¶åå¹¶è¡Œ)</span><br>seqkit <span class="hljs-keyword">split</span> hairpin.fa.gz -p <span class="hljs-number">5</span> <span class="hljs-number">-2</span><br> <br><span class="hljs-comment"># å¤æ‚ä¸€ç‚¹çš„å°±æ˜¯æŒ‰ç…§IDåŒºåˆ†</span><br>seqkit <span class="hljs-keyword">split</span> hairpin.fa.gz -i --id-<span class="hljs-keyword">regexp</span> <span class="hljs-string">&quot;^([\w]+)\-&quot;</span> <span class="hljs-number">-2</span><br> <br><span class="hljs-comment"># æŒ‰ç…§å‰ä¸‰ä¸ªåºåˆ—ç¢±åŸºæ¥åŒºåˆ†</span><br>seqkit <span class="hljs-keyword">split</span> hairpin.fa.gz -r <span class="hljs-number">1</span>:<span class="hljs-number">3</span> <span class="hljs-number">-2</span><br></code></pre></td></tr></table></figure><h1 id="split2-æ‹†åˆ†æ–‡ä»¶-å‡çº§ç‰ˆæœ¬"><a href="#split2-æ‹†åˆ†æ–‡ä»¶-å‡çº§ç‰ˆæœ¬" class="headerlink" title="split2 æ‹†åˆ†æ–‡ä»¶ å‡çº§ç‰ˆæœ¬"></a>split2 æ‹†åˆ†æ–‡ä»¶ å‡çº§ç‰ˆæœ¬</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs csharp">Flags:<br>  -l, --<span class="hljs-keyword">by</span>-length <span class="hljs-built_in">string</span>   split sequences <span class="hljs-keyword">into</span> chunks of &gt;=N bases, supports K/M/G suffix<br>  -p, --<span class="hljs-keyword">by</span>-part <span class="hljs-built_in">int</span>        æŒ‰ç…§æ‹†åˆ†å‡ºæ¥çš„æ•°é‡ï¼Œæ¯”å¦‚ï¼šæ‹†åˆ†æˆä¸¤ä¸ªå­æ–‡ä»¶<span class="hljs-number">2</span>ã€‚-s, --<span class="hljs-keyword">by</span>-size <span class="hljs-built_in">int</span>        æŒ‰ç…§åºåˆ—æ•°é‡æ‹†åˆ†<br>  -f, --force              å¼ºåˆ¶è¦†ç›–æ–‡ä»¶<br>  -h, --help               æŸ¥çœ‹å¸®åŠ©æ–‡ä»¶<br>  -O, --<span class="hljs-keyword">out</span>-dir <span class="hljs-built_in">string</span>     è¾“å‡ºæ–‡ä»¶å¤¹ (<span class="hljs-literal">default</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">is</span> $infile.split)<br>  <span class="hljs-number">-1</span>, --<span class="hljs-function">read1 <span class="hljs-title">string</span>       (<span class="hljs-params">gzipped</span>) åŒç«¯åºåˆ—ç¬¬ä¸€ä¸ª</span><br><span class="hljs-function">  -2, --read2 <span class="hljs-title">string</span>       (<span class="hljs-params">gzipped</span>) åŒç«¯åºåˆ—ç¬¬äºŒä¸ª</span><br><span class="hljs-function"></span><br><span class="hljs-function"></span><br></code></pre></td></tr></table></figure><p>åŒæ—¶æ”¯æŒfaå’Œfqæ–‡ä»¶ã€‚å•ç«¯å’ŒåŒç«¯åºåˆ—æ‹†åˆ†å®ä¾‹</p><p>-få¼ºåˆ¶è¦†ç›–ç»“æœï¼Œé€‚åˆé‡å¤è®¡ç®—æ—¶ä½¿ç”¨</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">seqkit</span> split2 hairpin.fa.gz -s <span class="hljs-number">10000</span> -f<br> <br><span class="hljs-comment"># åŒç«¯åºåˆ—æ‹†åˆ†(é‡ç‚¹)ï¼ŒpæŒ‡å®šæ‹†åˆ†æ•°é‡ï¼Œ-OæŒ‡å®šè¾“å‡ºç›®å½•ï¼Œ-fè¦†ç›–ç»“æœï¼Œé»˜è®¤ä¸ºå‹ç¼©</span><br><span class="hljs-attribute">seqkit</span> split2 -<span class="hljs-number">1</span> C1_1.fq.gz -<span class="hljs-number">2</span> C1_2.fq.gz -p <span class="hljs-number">2</span> -O out -f<br><br><br></code></pre></td></tr></table></figure><h1 id="pair-æ‹¼æ¥ä¸¤ä¸ªfastqæ–‡ä»¶"><a href="#pair-æ‹¼æ¥ä¸¤ä¸ªfastqæ–‡ä»¶" class="headerlink" title="pair æ‹¼æ¥ä¸¤ä¸ªfastqæ–‡ä»¶"></a>pair æ‹¼æ¥ä¸¤ä¸ªfastqæ–‡ä»¶</h1><p>ç•™ä¸‹åŒ¹é…çš„ï¼Œå»é™¤ä¸åŒ¹é…çš„ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨æ‰©å¢å­çš„åŒç«¯åºåˆ—åšä¸€ä¸ªæ¼”ç¤ºï¼š</p><p>æ³¨æ„ï¼šåŒç«¯åºåˆ—åœ¨ä¸¤ä¸ªæ–‡ä»¶ä¸­çš„é¡ºåºæœ€å¥½æ˜¯ä¸€æ ·çš„ï¼Œå¦åˆ™ä¼šæ¶ˆè€—å¤§é‡å†…å­˜å»åŒ¹é…ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">seqkit</span> pair -<span class="hljs-number">1</span> C1_1.fq.gz -<span class="hljs-number">2</span> C1_2.fq.gz -O result<br><span class="hljs-comment"># -u è¾“å‡ºæœªåŒ¹é…ä¸Šçš„æ–‡ä»¶</span><br><span class="hljs-attribute">seqkit</span> pair -<span class="hljs-number">1</span> C1_1.fq.gz -<span class="hljs-number">2</span> C1_2.fq.gz -O result -u -f<br><br></code></pre></td></tr></table></figure><h1 id="sample-æŒ‰æ•°é‡æˆ–æ¯”ä¾‹å¯¹åºåˆ—è¿›è¡ŒæŠ½æ ·ã€‚"><a href="#sample-æŒ‰æ•°é‡æˆ–æ¯”ä¾‹å¯¹åºåˆ—è¿›è¡ŒæŠ½æ ·ã€‚" class="headerlink" title="sample æŒ‰æ•°é‡æˆ–æ¯”ä¾‹å¯¹åºåˆ—è¿›è¡ŒæŠ½æ ·ã€‚"></a>sample æŒ‰æ•°é‡æˆ–æ¯”ä¾‹å¯¹åºåˆ—è¿›è¡ŒæŠ½æ ·ã€‚</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">æŒ‰ç…§ç™¾åˆ†æ¯”ä¾‹å’Œåºåˆ—æ•°é‡è¿›è¡ŒæŠ½æ ·<br><span class="hljs-comment"># æŠ½æ ·ç™¾åˆ†ä¹‹å</span><br>zcat C1_1.fq.gz | seqkit sample -p <span class="hljs-number">0.1</span> -o sample.fq.gz<br><span class="hljs-comment"># æŠ½æ ·1000æ¡</span><br>zcat C1_1.fq.gz | seqkit sample -n <span class="hljs-number">1000</span> -o sample.fq.gz<br><br>æ³¨æ„ï¼š<span class="hljs-number">1000</span>æ¡å¹¶ä¸æ˜¯å¾ˆå‡†ç¡®ï¼Œå¯èƒ½æ˜¯<span class="hljs-number">900</span>å¤šæ¡ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿçœ‹è¿™é‡Œäº†è§£é—®é¢˜ã€‚https:<span class="hljs-regexp">//</span>bioinf.shenwei.me<span class="hljs-regexp">/seqkit/</span>note/<span class="hljs-comment">#effect-of-random-seed-on-results-of-seqkit-sample</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œä¸ºå¤§å®¶å±•ç¤ºä¸€ä¸‹å‡å°‘å†…å­˜çš„åºåˆ—æŠ½æ ·æ–¹æ³•</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta"># æŠ½æ · seqkit sample </span><br>zcat hairpin.fa.gz \<br>    <span class="hljs-string">| seqkit sample -p 0.1 \</span><br>    <span class="hljs-string">| seqkit head -n 1000 -o sample.fa.gz</span><br> <br><span class="hljs-meta"># è®¾ç½®éšæœºç§å­ï¼Œæ–¹ä¾¿é‡å¤ç»“æœ: -s 11</span><br>zcat hairpin.fa.gz \<br>    <span class="hljs-string">| seqkit sample -p 0.1 -s 11 |head</span><br> <br><span class="hljs-meta"># æŠ½æ ·åæ‰“ä¹±åºåˆ— :seqkit shuffle</span><br>zcat hairpin.fa.gz \<br>    <span class="hljs-string">| seqkit sample -p 0.1 \</span><br>    <span class="hljs-string">| seqkit shuffle -o sample.fa.gz</span><br><br><br></code></pre></td></tr></table></figure><h1 id="range-æ‰“å°åºåˆ—-æŒ‰ç…§ä¸€ä¸ªèŒƒå›´"><a href="#range-æ‰“å°åºåˆ—-æŒ‰ç…§ä¸€ä¸ªèŒƒå›´" class="headerlink" title="range æ‰“å°åºåˆ— æŒ‰ç…§ä¸€ä¸ªèŒƒå›´"></a>range æ‰“å°åºåˆ— æŒ‰ç…§ä¸€ä¸ªèŒƒå›´</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># æ‰“å°ä¸€ä¸ªèŒƒå›´å†…çš„åºåˆ—</span><br><span class="hljs-attribute">cat</span> hairpin.fa | seqkit range -r <span class="hljs-number">1</span>:<span class="hljs-number">10</span><br><span class="hljs-comment"># æ‰“å°æœ€åå‡ è¡Œçš„åºåˆ—</span><br><span class="hljs-attribute">cat</span> hairpin.fa | seqkit range -r -<span class="hljs-number">100</span>:-<span class="hljs-number">1</span> | seqkit stats<br><span class="hljs-comment"># æ‰“å°ä¸­é—´èŒƒå›´çš„åºåˆ—</span><br><span class="hljs-attribute">cat</span> hairpin.fa | seqkit range -r <span class="hljs-number">101</span>:<span class="hljs-number">150</span> | seqkit stats<br><br><br></code></pre></td></tr></table></figure><h1 id="repeat-ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢åç§°-x2F-åºåˆ—ã€‚"><a href="#repeat-ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢åç§°-x2F-åºåˆ—ã€‚" class="headerlink" title="repeat ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢åç§°&#x2F;åºåˆ—ã€‚"></a>repeat ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢åç§°&#x2F;åºåˆ—ã€‚</h1><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-comment"># ä¿®æ”¹åºåˆ—åç§°ï¼šåˆ é™¤ç©ºæ ¼åå†…å­˜</span><br>echo -e <span class="hljs-string">&quot;&gt;seq1 abc-123\nACGT-ACGT&quot;</span> \<br>    | seqkit <span class="hljs-built_in">replace</span> -p <span class="hljs-string">&quot;\s.+&quot;</span><br> <br><span class="hljs-comment"># ä¿®æ”¹åºåˆ—åï¼šæ›¿æ¢</span><br>echo -e <span class="hljs-string">&quot;&gt;seq1 abc-123\nACGT-ACGT&quot;</span> \<br>    | seqkit <span class="hljs-built_in">replace</span> -p <span class="hljs-string">&quot;\-&quot;</span> -r <span class="hljs-string">&#x27;=&#x27;</span><br> <br><span class="hljs-comment"># ä¿®æ”¹åºåˆ—ï¼šå»é™¤åºåˆ—é—´éš”</span><br>echo -e <span class="hljs-string">&quot;&gt;seq1 abc-123\nACGT-ACGT&quot;</span> \<br>    | seqkit <span class="hljs-built_in">replace</span> -p <span class="hljs-string">&quot; |-&quot;</span> -s<br> <br><span class="hljs-comment"># ä¿®æ”¹åºåˆ—ï¼šç»™æ¯ä¸€ä¸ªç¢±åŸºåŠ ä¸Šç©ºæ ¼</span><br>echo -e <span class="hljs-string">&quot;&gt;seq1 abc-123\nACGT-ACGT&quot;</span> \<br>    | seqkit <span class="hljs-built_in">replace</span> -p <span class="hljs-string">&quot;(.)&quot;</span> -r <span class="hljs-string">&#x27;$1 &#x27;</span> -s<br> <br><span class="hljs-comment"># ä½¿ç”¨å­—ç¬¦åŠ æ•°æ®é‡å‘½ååºåˆ—-ç”¨äºæ‰©å¢å­ä»£è¡¨åºåˆ—æ”¹åéå¸¸ä¼˜ç§€</span><br>echo -e <span class="hljs-string">&quot;&gt;abc\nACTG\n&gt;123\nATTT&quot;</span> \<br>    |  seqkit <span class="hljs-built_in">replace</span> -p .+ -r <span class="hljs-string">&quot;ASV_&#123;nr&#125;&quot;</span><br> <br>echo -e <span class="hljs-string">&quot;&gt;abc\nACTG\n&gt;123\nATTT&quot;</span> \<br>    |  seqkit <span class="hljs-built_in">replace</span> -p .+ -r <span class="hljs-string">&quot;SAV_&#123;nr&#125;&quot;</span> <span class="hljs-comment">--nr-width 5</span><br><br><br></code></pre></td></tr></table></figure><h1 id="rename-é‡å‘½åé‡å¤çš„ID"><a href="#rename-é‡å‘½åé‡å¤çš„ID" class="headerlink" title="rename é‡å‘½åé‡å¤çš„ID"></a>rename é‡å‘½åé‡å¤çš„ID</h1><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs lsl"># é‡å‘½åï¼šç›¸åŒåºåˆ—ä¼šåœ¨åé¢åŠ ä¸Š_2 æ¥å¤„ç†<br>echo -e <span class="hljs-string">&quot;&gt;a comment<span class="hljs-subst">\n</span>acgt<span class="hljs-subst">\n</span>&gt;b comment of b<span class="hljs-subst">\n</span>ACTG<span class="hljs-subst">\n</span>&gt;a comment<span class="hljs-subst">\n</span>aaaa&quot;</span> \<br>    | seqkit rename<br><br><br></code></pre></td></tr></table></figure><h1 id="concat-è¿æ¥å¤šä¸ªæ–‡ä»¶ä¸­å…·æœ‰ç›¸åŒIDçš„åºåˆ—"><a href="#concat-è¿æ¥å¤šä¸ªæ–‡ä»¶ä¸­å…·æœ‰ç›¸åŒIDçš„åºåˆ—" class="headerlink" title="concat è¿æ¥å¤šä¸ªæ–‡ä»¶ä¸­å…·æœ‰ç›¸åŒIDçš„åºåˆ—"></a>concat è¿æ¥å¤šä¸ªæ–‡ä»¶ä¸­å…·æœ‰ç›¸åŒIDçš„åºåˆ—</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment">#è¿™é‡Œæ¼”ç¤ºç»„åˆå‰é¢ä¸¤ä¸ªç¢±åŸºå’Œæœ€åä¸¤ä¸ªç¢±åŸºçš„ç”¨æ³•</span><br><span class="hljs-attribute">seqkit</span> concat &lt;(seqkit subseq -r <span class="hljs-number">1</span>:<span class="hljs-number">2</span> C1_1.fq.gz) &lt;(seqkit subseq -r -<span class="hljs-number">2</span>:-<span class="hljs-number">1</span> C1_2.fq.gz)|head<br><br></code></pre></td></tr></table></figure><h1 id="shuffle-éšæœºæ‰“ä¹±åºåˆ—-é»˜è®¤å…¨éƒ¨è¯»å…¥å†…å­˜"><a href="#shuffle-éšæœºæ‰“ä¹±åºåˆ—-é»˜è®¤å…¨éƒ¨è¯»å…¥å†…å­˜" class="headerlink" title="shuffle éšæœºæ‰“ä¹±åºåˆ— é»˜è®¤å…¨éƒ¨è¯»å…¥å†…å­˜"></a>shuffle éšæœºæ‰“ä¹±åºåˆ— é»˜è®¤å…¨éƒ¨è¯»å…¥å†…å­˜</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">seqkit shuffle hairpin<span class="hljs-selector-class">.fa</span><span class="hljs-selector-class">.gz</span> -<span class="hljs-number">2</span>  &gt; shuffled.fa<br></code></pre></td></tr></table></figure><h1 id="sort-æŒ‰id-x2F-åç§°-x2F-åºåˆ—-x2F-é•¿åº¦æ’åºåºåˆ—"><a href="#sort-æŒ‰id-x2F-åç§°-x2F-åºåˆ—-x2F-é•¿åº¦æ’åºåºåˆ—" class="headerlink" title="sort æŒ‰id&#x2F;åç§°&#x2F;åºåˆ—&#x2F;é•¿åº¦æ’åºåºåˆ—"></a>sort æŒ‰id&#x2F;åç§°&#x2F;åºåˆ—&#x2F;é•¿åº¦æ’åºåºåˆ—</h1><p>â€”quiet å±å¹•ä¸è¾“å‡ºè¿‡ç¨‹</p><p>-i æ’åºå¿½ç•¥å¤§å°å†™</p><p>-l æŒ‰ç…§åºåˆ—é•¿åº¦æ’åº</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs lsl"># IDæ’åº<br>echo -e <span class="hljs-string">&quot;&gt;seq1<span class="hljs-subst">\n</span>ACGTNcccc<span class="hljs-subst">\n</span>&gt;SEQ2<span class="hljs-subst">\n</span>acgtnAAAA&quot;</span> \<br>    | seqkit sort --quiet<br> <br># æŒ‰ç…§IDæ’åºï¼Œå¿½ç•¥å¤§å°å†™<br>echo -e <span class="hljs-string">&quot;&gt;seq1<span class="hljs-subst">\n</span>ACGTNcccc<span class="hljs-subst">\n</span>&gt;SEQ2<span class="hljs-subst">\n</span>acgtnAAAA&quot;</span> \<br>    | seqkit sort --quiet -i<br> <br># æŒ‰ç…§åºåˆ—é•¿åº¦æ’åºï¼Œç”±å°åˆ°å¤§<br>echo -e <span class="hljs-string">&quot;&gt;seq1<span class="hljs-subst">\n</span>ACGTNcccc<span class="hljs-subst">\n</span>&gt;SEQ2<span class="hljs-subst">\n</span>acgtnAAAAnnn<span class="hljs-subst">\n</span>&gt;seq3<span class="hljs-subst">\n</span>acgt&quot;</span> \<br>    | seqkit sort --quiet -l<br><br><br></code></pre></td></tr></table></figure><h1 id="mutate-ç¼–è¾‘åºåˆ—-ç‚¹çªå˜ã€æ’å…¥ã€åˆ é™¤"><a href="#mutate-ç¼–è¾‘åºåˆ—-ç‚¹çªå˜ã€æ’å…¥ã€åˆ é™¤" class="headerlink" title="mutate ç¼–è¾‘åºåˆ—(ç‚¹çªå˜ã€æ’å…¥ã€åˆ é™¤)"></a>mutate ç¼–è¾‘åºåˆ—(ç‚¹çªå˜ã€æ’å…¥ã€åˆ é™¤)</h1><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs swift">echo <span class="hljs-operator">-</span>ne <span class="hljs-string">&quot;&gt;1<span class="hljs-subst">\n</span>ACTGNactgn<span class="hljs-subst">\n</span>&gt;2<span class="hljs-subst">\n</span>actgnACTGN<span class="hljs-subst">\n</span>&quot;</span><br> <br># ä¿®æ”¹ç¬¬ä¸€ä¸ªç¢±åŸº<br>echo <span class="hljs-operator">-</span>ne <span class="hljs-string">&quot;&gt;1<span class="hljs-subst">\n</span>ACTGNactgn<span class="hljs-subst">\n</span>&gt;2<span class="hljs-subst">\n</span>actgnACTGN<span class="hljs-subst">\n</span>&quot;</span> \<br>    <span class="hljs-operator">|</span> seqkit mutate <span class="hljs-operator">-</span>p <span class="hljs-number">1</span>:x<br> <br># ä¿®æ”¹ç¬¬äº”ä¸ªä½ç½®çš„ç¢±åŸºï¼Œè¾“å‡ºä¿¡æ¯éšè—    <br>echo <span class="hljs-operator">-</span>ne <span class="hljs-string">&quot;&gt;1<span class="hljs-subst">\n</span>ACTGNactgn<span class="hljs-subst">\n</span>&gt;2<span class="hljs-subst">\n</span>actgnACTGN<span class="hljs-subst">\n</span>&quot;</span> \<br>    <span class="hljs-operator">|</span> seqkit mutate <span class="hljs-operator">-</span>p <span class="hljs-number">5</span>:x <span class="hljs-operator">--</span>quiet<br> <br># å¯ä»¥åŒæ—¶ä¿®æ”¹å¤šä¸ªç¢±åŸº<br>echo <span class="hljs-operator">-</span>ne <span class="hljs-string">&quot;&gt;1<span class="hljs-subst">\n</span>ACTGNactgn<span class="hljs-subst">\n</span>&gt;2<span class="hljs-subst">\n</span>actgnACTGN<span class="hljs-subst">\n</span>&quot;</span> \<br>    <span class="hljs-operator">|</span> seqkit mutate <span class="hljs-operator">-</span>p <span class="hljs-number">1</span>:x <span class="hljs-operator">-</span>p <span class="hljs-operator">-</span><span class="hljs-number">1</span>:x <span class="hljs-operator">--</span>quiet<br> <br># åˆ é™¤ç¢±åŸº<br>echo <span class="hljs-operator">-</span>ne <span class="hljs-string">&quot;&gt;1<span class="hljs-subst">\n</span>ACTGNactgn<span class="hljs-subst">\n</span>&gt;2<span class="hljs-subst">\n</span>actgnACTGN<span class="hljs-subst">\n</span>&quot;</span> \<br>    <span class="hljs-operator">|</span> seqkit mutate <span class="hljs-operator">-</span>d <span class="hljs-number">1</span>:<span class="hljs-number">1</span> <span class="hljs-operator">--</span>quiet<br> <br># åˆ é™¤å€’æ•°ä¸‰ä¸ªç¢±åŸº<br>echo <span class="hljs-operator">-</span>ne <span class="hljs-string">&quot;&gt;1<span class="hljs-subst">\n</span>ACTGNactgn<span class="hljs-subst">\n</span>&gt;2<span class="hljs-subst">\n</span>actgnACTGN<span class="hljs-subst">\n</span>&quot;</span> \<br>    <span class="hljs-operator">|</span> seqkit mutate <span class="hljs-operator">-</span>d <span class="hljs-operator">-</span><span class="hljs-number">3</span>:<span class="hljs-operator">-</span><span class="hljs-number">1</span> <span class="hljs-operator">--</span>quiet<br> <br># æ’å…¥ç¢±åŸº<br>echo <span class="hljs-operator">-</span>ne <span class="hljs-string">&quot;&gt;1<span class="hljs-subst">\n</span>ACTGNactgn<span class="hljs-subst">\n</span>&gt;2<span class="hljs-subst">\n</span>actgnACTGN<span class="hljs-subst">\n</span>&quot;</span> \<br>    <span class="hljs-operator">|</span> seqkit mutate <span class="hljs-operator">-</span>i <span class="hljs-number">0</span>:xx <span class="hljs-operator">--</span>quiet<br><br><br></code></pre></td></tr></table></figure><h1 id="head-å±•ç¤ºå¼€å¤´Nè¡Œçš„åºåˆ—"><a href="#head-å±•ç¤ºå¼€å¤´Nè¡Œçš„åºåˆ—" class="headerlink" title="head å±•ç¤ºå¼€å¤´Nè¡Œçš„åºåˆ—"></a>head å±•ç¤ºå¼€å¤´Nè¡Œçš„åºåˆ—</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">seqkit head -n <span class="hljs-number">1</span> hairpin<span class="hljs-selector-class">.fa</span><span class="hljs-selector-class">.gz</span><br><br><br></code></pre></td></tr></table></figure><h1 id="locate-å®šä½å­åºåˆ—æˆ–è€…ä¿å®ˆåºåˆ—ä½ç½®"><a href="#locate-å®šä½å­åºåˆ—æˆ–è€…ä¿å®ˆåºåˆ—ä½ç½®" class="headerlink" title="locate å®šä½å­åºåˆ—æˆ–è€…ä¿å®ˆåºåˆ—ä½ç½®"></a>locate å®šä½å­åºåˆ—æˆ–è€…ä¿å®ˆåºåˆ—ä½ç½®</h1><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs 1c">cat gene.fa <span class="hljs-string">| seqkit locate -p ACT | csvtk pretty -t</span><br><span class="hljs-meta"># è°ƒæ•´é”™é… æœ€å¤§é”™é…ä¸º1</span><br>cat gene.fa \<br>  <span class="hljs-string">| seqkit locate -p ACTG -m 1 \</span><br>  <span class="hljs-string">| csvtk pretty -t</span><br> <br><span class="hljs-meta"># ç®€å¹¶ç¢±åŸº</span><br>zcat hairpin.fa.gz \<br>    <span class="hljs-string">| seqkit locate -i -d -p AUGGACUN \</span><br>    <span class="hljs-string">| head -n 4</span><br><br><br></code></pre></td></tr></table></figure><h1 id="restart-é‡ç½®å¾ªç¯åŸºå› ç»„çš„èµ·å§‹ä½ç½®"><a href="#restart-é‡ç½®å¾ªç¯åŸºå› ç»„çš„èµ·å§‹ä½ç½®" class="headerlink" title="restart é‡ç½®å¾ªç¯åŸºå› ç»„çš„èµ·å§‹ä½ç½®"></a>restart é‡ç½®å¾ªç¯åŸºå› ç»„çš„èµ·å§‹ä½ç½®</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;&gt;seq\nacgtnACGTN&quot;</span><br> <br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;&gt;seq\nacgtnACGTN&quot;</span> | seqkit restart -i 2<br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;&gt;seq\nacgtnACGTN&quot;</span> | seqkit restart -i -2<br><br><br></code></pre></td></tr></table></figure><h1 id="convet-äºŒä»£æµ‹åºè´¨é‡å€¼çš„è½¬åŒ–ä¸º-Sanger"><a href="#convet-äºŒä»£æµ‹åºè´¨é‡å€¼çš„è½¬åŒ–ä¸º-Sanger" class="headerlink" title="convet äºŒä»£æµ‹åºè´¨é‡å€¼çš„è½¬åŒ–ä¸º Sanger"></a>convet äºŒä»£æµ‹åºè´¨é‡å€¼çš„è½¬åŒ–ä¸º Sanger</h1><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs clean"># Illumina<span class="hljs-number">-1.8</span>+ -&gt; Sanger<br># seqkit convert tests/Illimina1<span class="hljs-number">.8</span>.fq.gz  | seqkit head -n <span class="hljs-number">1</span><br># <span class="hljs-number">40</span>åˆ†ä»¥ä¸Šçš„éƒ½è®¤ä¸º<span class="hljs-number">40</span> Illumina<span class="hljs-number">-1.8</span>+ -&gt; Sanger<br># seqkit convert tests/Illimina1<span class="hljs-number">.8</span>.fq.gz -f | seqkit head -n <span class="hljs-number">1</span><br> <br>#Illumina<span class="hljs-number">-1.8</span>+ -&gt; Illumina<span class="hljs-number">-1.5</span>+<br># seqkit convert tests/Illimina1<span class="hljs-number">.8</span>.fq.gz --to Illumina<span class="hljs-number">-1.5</span>+ | seqkit head -n <span class="hljs-number">1</span><br> <br># Illumina<span class="hljs-number">-1.8</span>+ -&gt; Illumina<span class="hljs-number">-1.5</span>+ -&gt;  Sanger.<br># seqkit convert tests/Illimina1<span class="hljs-number">.8</span>.fq.gz --to Illumina<span class="hljs-number">-1.5</span>+ | seqkit convert | seqkit head -n <span class="hljs-number">1</span><br> <br># Solexa -&gt; Sanger<br># seqkit convert tests/Illimina1<span class="hljs-number">.8</span>.fq.gz --<span class="hljs-keyword">from</span> Solexa<br> <br># Illumina<span class="hljs-number">-1.5</span>+ -&gt; Sanger<br># seqkit convert tests/Illimina1<span class="hljs-number">.5</span>.fq | seqkit head -n <span class="hljs-number">1</span><br><br><br></code></pre></td></tr></table></figure><h1 id="æŠ€æœ¯ç»†èŠ‚å’Œä½¿ç”¨"><a href="#æŠ€æœ¯ç»†èŠ‚å’Œä½¿ç”¨" class="headerlink" title="æŠ€æœ¯ç»†èŠ‚å’Œä½¿ç”¨"></a>æŠ€æœ¯ç»†èŠ‚å’Œä½¿ç”¨</h1><p>seqkitå¤„ç†å‹ç¼©æ–‡ä»¶</p><p>pigz æˆ–è€… gzip åœ¨éƒ¨åˆ†æ“ä½œä¸­ä¸èƒ½åŠ é€Ÿï¼Œæ‰€ä»¥åœ¨v.0.8.1ç‰ˆæœ¬ä»¥ä¾¿å…³æ³¨äº†ï¼Œç„¶è€Œè¿˜æ˜¯å¯ä»¥ä½¿ç”¨å‘½ä»¤ï¼š</p><p>pigz -d -c seqs.fq.gz | seqkit xxx<br>å› ä¸ºseqkitä½¿ç”¨äº†pgzipå»å†™gzipã€‚è¿™æ¯”gzipå’Œpigzæ›´å¿«ã€‚ï¼ˆ10X of gzip, 4X of pigzï¼‰ï¼Œè€Œä¸”gzipå‹ç¼©æ–‡ä»¶æ¯”è¾ƒå¤§ã€‚</p><p>ä»æ•°æ®å¤„ç†æ ¼å¼æ¥è®²</p><p>seqkitæ— ç¼æ”¯æŒfaå’Œfqæ ¼å¼æ•°æ®ï¼Œå¹¶ä¸”å¯ä»¥è‡ªåŠ¨è¯†åˆ«ã€‚é™¤äº† faidxä¹‹å¤–ï¼Œå…¨éƒ¨å‘½ä»¤éƒ½å¯ä»¥å¤„ç†è¿™ä¸¤ç§æ ¼å¼çš„æ•°æ®ã€‚</p><p>åªæœ‰faæ ¼å¼æ”¯æŒå‘½ä»¤(subseq, split, sortå’Œshuffle)åˆ©ç”¨FASTAç´¢å¼•(by flag -two-pass)ä¸‹æé«˜å¤§æ–‡ä»¶çš„æ€§èƒ½ã€‚</p><p>åºåˆ—ç±»å‹çš„æ£€æµ‹DNA&#x2F;RNA&#x2F;Proteinï¼Œä¼šä½¿ç”¨å­åºåˆ—è¿›è¡Œï¼Œé»˜è®¤æ£€æµ‹ç¬¬ä¸€æ¡å­åºåˆ—ï¼Œé€šè¿‡â€”alphabet-guess-seq-lengthå‚æ•°é»˜è®¤ä¸º10000ï¼Œå¦‚æœé•¿åº¦å°äº10000ï¼Œåˆ™æ£€æŸ¥æ•´æ¡åºåˆ—ã€‚</p><p>åºåˆ—åå­—</p><p>æ‰€æœ‰çš„è½¯ä»¶ï¼ŒåŒ…æ‹¬seqkitï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªç©ºæ ¼ä¹‹å‰çš„å­—ç¬¦ä½œä¸ºåºåˆ—çš„åå­—ï¼š<br>éœ€è¦æ³¨æ„çš„NCBIç­‰ä¸€äº›åºåˆ—çš„æ ¼å¼å¹¶ä¸æ˜¯å¦‚æ­¤ï¼Œä¾‹å¦‚ï¼š</p><blockquote><p>gi|110645304|ref|NC_002516.2| Pseudomona<br>æƒ³è¦åœ¨seqkitä¸­è¯†åˆ«å‡ºæ¥çš„åºåˆ—IDä¸ºï¼šNC_002516.2ã€‚</p></blockquote><p>æ­¤æ—¶ä½¿ç”¨å‚æ•°â€“id-regexp â€œ|([^|]+)| â€œï¼Œæˆ–è€…æ·»åŠ å‚æ•°â€“id-ncbiï¼Œä½†å¦‚æœæ˜¯åªè¦å‰é¢çš„giæ•°å­—ä½œä¸ºIDçš„è¯ï¼Œæ·»åŠ å‚æ•°ï¼šâ€“id-regexp â€œ^gi|([^|]+)|â€œã€‚</p><p>æ³¨æ„ï¼š.seqkit.faiä¸åŒäºsamtoolsäº§ç”Ÿçš„.faiæ ¼å¼æ–‡ä»¶ï¼Œseqkitä½¿ç”¨æ•´ä¸ªåºåˆ—å¼€å¤´è€Œä¸æ˜¯IDä½œä¸ºç´¢å¼•ã€‚</p><p>å¹¶è¡Œè¿ç®—</p><p>å•æ ¸CPUé»˜è®¤çº¿ç¨‹ï¼šâ€”threads 1ï¼Œå¤šä¸ªCPUï¼Œçº¿ç¨‹é»˜è®¤2.</p><p>å†…å­˜å ç”¨</p><p>seqkitè®¸å¤šçš„å‘½ä»¤éƒ½ä¸éœ€è¦å°†æ•´ä¸ªåºåˆ—è¯»å…¥åˆ°å†…å­˜ä¸­ã€‚åŒ…æ‹¬ï¼šstat, fq2fa, fx2tab, tab2fx, grep, locate, replace, seq, sliding, subseqã€‚</p><p>æ³¨æ„ï¼šå¦‚æœä½¿ç”¨subseq â€”gtf | â€”bedæ—¶ï¼Œå¦‚æœGTFæˆ–è€…BEDæ–‡ä»¶å¤ªå¤§ï¼Œå†…å­˜ä½¿ç”¨é‡ä¼šæš´å¢ï¼Œå¯ä»¥é€šè¿‡æŒ‡å®šæŸ“è‰²ä½“ï¼šâ€”chrï¼Œæˆ–è€…â€”featureå»é™åˆ¶ç‰¹å¾ã€‚</p><p>æœ‰ä¸€äº›å‘½ä»¤éœ€è¦å°†æ–‡ä»¶è¯»å…¥å†…å­˜ï¼Œä½†æ˜¯å¯ä»¥ç”¨è¿‡rmdup å’Œ commonå‡å°‘å†…å­˜ä½¿ç”¨ã€‚</p><p>éšæœºâ€”æŠ½æ ·</p><p>æŠ½æ ·å‘½ä»¤sampleå’Œshuffleä½¿ç”¨äº†éšæœºåŠŸèƒ½ï¼Œä¸ºäº†ä¿è¯é‡ç°æ€§ï¼Œå¯ä»¥ä½¿ç”¨-sè®¾ç½®éšæœºç§å­ã€‚è¿™å¯ä»¥ä¿è¯åœ¨ä¸åŒçš„ç¯å¢ƒä¸­å¯ä»¥æœ‰ç›¸åŒçš„æŠ½æ ·ç»“æœã€‚</p><h1 id="åºåˆ—é•¿åº¦åˆ†å¸ƒ"><a href="#åºåˆ—é•¿åº¦åˆ†å¸ƒ" class="headerlink" title="åºåˆ—é•¿åº¦åˆ†å¸ƒ"></a>åºåˆ—é•¿åº¦åˆ†å¸ƒ</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># -j æ˜¯çº¿ç¨‹æ•°</span><br>seqkit fx2tab -j 30 -l  -n -i -H file.fastq.gz | <span class="hljs-built_in">cut</span> -f 4 &gt; Length.txt<br><span class="hljs-comment"># æŸ¥çœ‹Length.txt</span><br></code></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs r">library<span class="hljs-punctuation">(</span>tidyverse<span class="hljs-punctuation">)</span><br><br><span class="hljs-built_in">length</span> <span class="hljs-operator">&lt;-</span> read_tsv<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Length.txt&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> group_by<span class="hljs-punctuation">(</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span><br>  summarise<span class="hljs-punctuation">(</span>Count <span class="hljs-operator">=</span> n<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-built_in">length</span><span class="hljs-operator">$</span><span class="hljs-built_in">length</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.character</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">length</span><span class="hljs-operator">$</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">)</span><br><span class="hljs-built_in">sum</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">sum</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">length</span><span class="hljs-operator">$</span>Count<span class="hljs-punctuation">)</span><br>ggplot<span class="hljs-punctuation">(</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> geom_col<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">,</span> Count<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> width <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_line<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">,</span> Count<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> group <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> geom_point<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">,</span> Count<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  scale_y_continuous<span class="hljs-punctuation">(</span>sec.axis <span class="hljs-operator">=</span> sec_axis<span class="hljs-punctuation">(</span><span class="hljs-operator">~</span>.<span class="hljs-operator">*</span><span class="hljs-number">100</span><span class="hljs-operator">/</span><span class="hljs-built_in">sum</span><span class="hljs-punctuation">,</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&quot;% Relative Abundance&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> xlab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Length&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  theme_bw<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> theme<span class="hljs-punctuation">(</span>panel.grid <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                     axis.title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br>ggsave<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Length.png&quot;</span><span class="hljs-punctuation">,</span> height <span class="hljs-operator">=</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span> width <span class="hljs-operator">=</span> <span class="hljs-number">8</span><span class="hljs-punctuation">)</span><br>ggsave<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Length.pdf&quot;</span><span class="hljs-punctuation">,</span> height <span class="hljs-operator">=</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span> width <span class="hljs-operator">=</span> <span class="hljs-number">8</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>fastq-tool</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux å†…å­˜ å­˜å‚¨</title>
    <link href="/GeekFocus/2022/02/24/2022-02-24-memory/"/>
    <url>/GeekFocus/2022/02/24/2022-02-24-memory/</url>
    
    <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><span id="more"></span><h1 id="å†…å­˜æ˜¯ä»€ä¹ˆ"><a href="#å†…å­˜æ˜¯ä»€ä¹ˆ" class="headerlink" title="å†…å­˜æ˜¯ä»€ä¹ˆ"></a>å†…å­˜æ˜¯ä»€ä¹ˆ</h1><ul><li><p>å†…å­˜åˆç§°ä¸»å­˜ï¼Œæ˜¯ CPU èƒ½ç›´æ¥å¯»å€çš„å­˜å‚¨ç©ºé—´ï¼Œç”±åŠå¯¼ä½“å™¨ä»¶åˆ¶æˆ</p></li><li><p>å†…å­˜çš„ç‰¹ç‚¹æ˜¯å­˜å–é€Ÿç‡å¿«</p></li><li><p>CPUã€IOã€ç£ç›˜ã€å†…å­˜å¯ä»¥è¯´æ˜¯å½±å“è®¡ç®—æœºæ€§èƒ½å…³é”®å› ç´ </p></li><li><p>å†…å­˜ä¸ºè¿›ç¨‹çš„è¿è¡Œæä¾›ç‰©ç†ç©ºé—´ï¼ŒåŒæ—¶ä½œä¸ºå¿«é€ŸCPUå’Œæ…¢é€Ÿç£ç›˜ä¹‹é—´çš„é€‚é…å™¨ï¼Œ</p></li></ul><h1 id="å†…å­˜çš„ä½œç”¨"><a href="#å†…å­˜çš„ä½œç”¨" class="headerlink" title="å†…å­˜çš„ä½œç”¨"></a>å†…å­˜çš„ä½œç”¨</h1><ul><li><p>æš‚æ—¶å­˜æ”¾ cpu çš„è¿ç®—æ•°æ®</p></li><li><p>ç¡¬ç›˜ç­‰å¤–éƒ¨å­˜å‚¨å™¨äº¤æ¢çš„æ•°æ®</p></li><li><p>ä¿éšœ cpu è®¡ç®—çš„ç¨³å®šæ€§å’Œé«˜æ€§èƒ½</p></li></ul><h1 id="æŸ¥çœ‹å†…å­˜æƒ…å†µ"><a href="#æŸ¥çœ‹å†…å­˜æƒ…å†µ" class="headerlink" title="æŸ¥çœ‹å†…å­˜æƒ…å†µ"></a>æŸ¥çœ‹å†…å­˜æƒ…å†µ</h1><p>freeå‘½ä»¤æ˜¯ä¸€ä¸ªå¿«é€ŸæŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µçš„æ–¹æ³•ï¼Œå®ƒæ˜¯å¯¹ &#x2F;proc&#x2F;meminfo æ”¶é›†åˆ°çš„ä¿¡æ¯çš„ä¸€ä¸ªæ¦‚è¿°ã€‚</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">free -h</span><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">zds@ubuntu ~ $ free -m   <span class="hljs-comment"># ä»¥ Mb ä¸ºå•ä½æ˜¾ç¤º</span><br>              total        used        free      shared  buff/cache   available<br><span class="hljs-comment"># ç‰©ç†å†…å­˜</span><br>Mem:           2990        1528         383          49        1078        1217<br><span class="hljs-comment"># è™šæ‹Ÿå†…å­˜</span><br>Swap:          2044           0        2044<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs sh">zds@ubuntu ~ $ top<br><br><br>top - 23:43:07 up 32 min,  1 user,  load average: 0.17, 0.36, 0.34<br>Tasks: 230 total,   1 running, 229 sleeping,   0 stopped,   0 zombie<br>%Cpu(s): 12.9 us,  5.6 sy,  0.0 ni, 81.5 <span class="hljs-built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<br>KiB Mem :  2029876 total,   148224 free,   998788 used,   882864 buff/cache<br>KiB Swap:  2094076 total,  2087304 free,     6772 used.   819128 avail Mem <br><br>   PID è¿›ç¨‹å·    PR ä¼˜å…ˆçº§  VIRT è¿›ç¨‹å ç”¨çš„è™šæ‹Ÿå†…å­˜å€¼<br>       USER è¿›ç¨‹æ‰€æœ‰è€…              RES è¿›ç¨‹å ç”¨çš„ç‰©ç†å†…å­˜å€¼<br>                     NI ä¼˜å…ˆçº§ç›¸å¯¹å€¼       SHR è¿›ç¨‹ä½¿ç”¨çš„å…±äº«å†…å­˜å€¼<br><br>   PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND<br>   978 root      20   0  356740  84104  37752 S  8.9  4.1   0:19.39 Xorg    <br>  1909 zds       20   0 1023828 118576  80360 S  4.6  5.8   0:18.36 compiz       <br>  2439 zds       20   0  630364  52556  42052 S  4.3  2.6   0:08.29 gnome-terminal-   <br>  1945 zds       20   0  633568  35384  28860 S  0.7  1.7   0:10.46 sogou-qimpanel- <br>     7 root      20   0       0      0      0 S  0.3  0.0   0:01.94 rcu_sched   <br>   845 root      20   0  187344   9684   8508 S  0.3  0.5   0:03.35 vmtoolsd  <br>  1631 zds       20   0   43736   4216   2924 S  0.3  0.2   0:01.82 dbus-daemon <br>  1795 zds       20   0  564648  29760  24496 S  0.3  1.5   0:01.08 unity-panel-ser<br>  1958 zds       20   0 1026996  95708  27980 S  0.3  4.7   0:07.03 gnome-software<br>  1966 zds       20   0  496776  28904  25224 S  0.3  1.4   0:03.52 vmtoolsd   <br>  7336 zds       20   0   43652   3948   3340 R  0.3  0.2   0:01.25 top  <br>     1 root      20   0  119836   5652   4024 S  0.0  0.3   0:03.27 systemd <br>     2 root      20   0       0      0      0 S  0.0  0.0   0:00.00 kthreadd <br>     3 root      20   0       0      0      0 S  0.0  0.0   0:00.52 ksoftirqd/0<br>     5 root       0 -20       0      0      0 S  0.0  0.0   0:00.00 kworker/0:0H <br>     8 root      20   0       0      0      0 S  0.0  0.0   0:00.00 rcu_bh<br>     9 root      rt   0       0      0      0 S  0.0  0.0   0:00.00 migration/0<br>    10 root      rt   0       0      0      0 S  0.0  0.0   0:00.01 watchdog/0<br>    11 root      20   0       0      0      0 S  0.0  0.0   0:00.00 kdevtmpfs <br>    12 root       0 -20       0      0      0 S  0.0  0.0   0:00.00 netns <br>    13 root       0 -20       0      0      0 S  0.0  0.0   0:00.00 perf <br>    14 root      20   0       0      0      0 S  0.0  0.0   0:00.00 khungtaskd  <br></code></pre></td></tr></table></figure><p><strong>htop</strong>å‘½ä»¤æ˜¾ç¤ºäº†æ¯ä¸ªè¿›ç¨‹çš„å†…å­˜å®æ—¶ä½¿ç”¨ç‡ã€‚å®ƒæä¾›äº†æ‰€æœ‰è¿›ç¨‹çš„å¸¸é©»å†…å­˜å¤§å°ã€ç¨‹åºæ€»å†…å­˜å¤§å°ã€å…±äº«åº“å¤§å°ç­‰çš„æŠ¥å‘Šã€‚åˆ—è¡¨å¯ä»¥æ°´å¹³åŠå‚ç›´æ»šåŠ¨ã€‚</p><p><strong>top</strong>å‘½ä»¤æä¾›äº†å®æ—¶çš„è¿è¡Œä¸­çš„ç¨‹åºçš„èµ„æºä½¿ç”¨ç»Ÿè®¡ã€‚ä½ å¯ä»¥æ ¹æ®å†…å­˜çš„ä½¿ç”¨å’Œå¤§å°æ¥è¿›è¡Œæ’åºã€‚</p><h1 id="Core-Dump"><a href="#Core-Dump" class="headerlink" title="Core Dump"></a>Core Dump</h1><ul><li>Coreæ„æ€æ˜¯å†…å­˜, Dumpçš„æ„æ€æ˜¯æ‰”å‡ºæ¥, å †å‡ºæ¥ã€‚åœ¨å¼€å‘ï¼ˆæˆ–ä½¿ç”¨ï¼‰ä¸€ä¸ªç¨‹åºæ—¶ï¼Œæœ‰æ—¶ç¨‹åºè«åå…¶å¦™çš„downäº†, å´æ²¡æœ‰ä»»ä½•æç¤º(æœ‰æ—¶æç¤ºcore dumped)ã€‚è™½ç„¶ç³»ç»Ÿæ²¡äº‹ï¼Œä½†ä¸‹æ¬¡ä»å¯èƒ½é‡åˆ°ç›¸åŒé—®é¢˜ã€‚è¿™æ—¶å¯æŸ¥çœ‹æœ‰æ— å½¢å¦‚core.PIDçš„coreæ–‡ä»¶ç”Ÿæˆï¼Œè¿™ä¸ªæ–‡ä»¶ä¾¿æ˜¯æ“ä½œç³»ç»ŸæŠŠç¨‹åºdownæ‰æ—¶çš„å†…å­˜å†…å®¹æ‰”å‡ºæ¥ç”Ÿæˆçš„ï¼Œè®©debugger åšå‚è€ƒã€‚è¿™ä¸ªåŠ¨ä½œå« core dumpã€‚<ul><li>core dumpåˆå«<strong>æ ¸å¿ƒè½¬å‚¨</strong>, å½“ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸, ç¨‹åºå¼‚å¸¸é€€å‡ºæ—¶, ç”±æ“ä½œç³»ç»ŸæŠŠç¨‹åºå½“å‰çš„å†…å­˜çŠ¶å†µå­˜å‚¨åœ¨ä¸€ä¸ªcoreæ–‡ä»¶ä¸­, å«core dumpã€‚ç®€è€Œè¨€ä¹‹ï¼Œ<font color="red">è¿›ç¨‹å¼‚å¸¸ç»ˆæ­¢ï¼Œè¿›ç¨‹ç”¨æˆ·ç©ºé—´çš„æ•°æ®å°±ä¼šè¢«å†™åˆ°ç£ç›˜coreæ–‡ä»¶</font>ã€‚</li></ul></li></ul><h2 id="ä¸ºä½•æœ‰æ—¶ç¨‹åºDownäº†ï¼Œå´æ²¡ç”Ÿæˆ-Coreæ–‡ä»¶"><a href="#ä¸ºä½•æœ‰æ—¶ç¨‹åºDownäº†ï¼Œå´æ²¡ç”Ÿæˆ-Coreæ–‡ä»¶" class="headerlink" title="ä¸ºä½•æœ‰æ—¶ç¨‹åºDownäº†ï¼Œå´æ²¡ç”Ÿæˆ Coreæ–‡ä»¶"></a>ä¸ºä½•æœ‰æ—¶ç¨‹åºDownäº†ï¼Œå´æ²¡ç”Ÿæˆ Coreæ–‡ä»¶</h2><ul><li><font color="red">æœ‰æ—¶å€™ç¨‹åºdownäº†, ä¸åƒç¼–è¯‘é”™è¯¯ä¼šæç¤ºåˆ°æ–‡ä»¶æŸä¸€è¡Œï¼Œè€Œæ˜¯æ²¡æœ‰ä»»ä½•ä¿¡æ¯</font>ã€‚ä¸€ç§åŠæ³•æ˜¯ç”¨gdbçš„stepï¼ˆlinuxä¸‹è°ƒè¯•å·¥å…·gdbæ˜¯å¾ˆå¼ºå¤§çš„è°ƒè¯•å™¨ï¼‰, ä¸€æ­¥ä¸€æ­¥å¯»æ‰¾ï¼Œä½†è¦stepä¸€ä¸ªä¸Šä¸‡è¡Œçš„ä»£ç è®©äººéš¾ä»¥æƒ³è±¡ã€‚ æ›´å¥½çš„åŠæ³•å°±æ˜¯core fileã€‚</li><li><font color="red">å¦‚æœcoreæ–‡ä»¶æ²¡æœ‰ç”Ÿæˆ</font>ï¼Œæ˜¯å› ä¸ºcore.PIDçš„coreæ–‡ä»¶çš„ç”Ÿæˆè·Ÿå½“å‰ç³»ç»Ÿçš„ç¯å¢ƒè®¾ç½®æœ‰å…³ç³»ï¼Œ<font color="red">ç³»ç»Ÿé»˜è®¤coreæ–‡ä»¶çš„å¤§å°ä¸º0</font>ï¼ˆæ³¨æ„core file size (blocks, -c) 0 è¿™è¡Œï¼Œè¡¨ç¤ºåˆ†é…ç»™coreæ–‡ä»¶çš„é•¿åº¦ï¼ˆå•ä½ä¸ºå­—èŠ‚ï¼Œä¸€ä¸ªå—çš„å¤§å°è¦åˆ†ç³»ç»Ÿè€Œå®šäº†ï¼‰ï¼Œä¸º0è‚¯å®šæ— coreæ–‡ä»¶ï¼Œå¯ä¿®æ”¹ä¹‹ï¼‰</li><li>ç”¨ulimitå‘½ä»¤æŸ¥çœ‹å’Œä¿®æ”¹coreæ–‡ä»¶çš„å¤§å°ï¼Œä½¿ç”¨<code>ulimit -a</code>æŸ¥çœ‹å¤§å°ï¼Œä½¿ç”¨ <code>ulimit -c unlimited</code>è¡¨ç¤ºå¯¹coreæ–‡ä»¶ä¸åšé™åˆ¶ æˆ– ä½¿ç”¨<code>ulimit -c 1024</code> å¯¹coreæ–‡ä»¶åˆ†é…1024ä¸ªå­—èŠ‚</li><li><font color="red">ç¨‹åºè¿è¡Œè¿‡ç¨‹å‡ºç°aborted(core dumped)ï¼Œulimit -aï¼Œç»“æœç¡®å® core file size (blocks, -c) 0ï¼Œæ— æ³•ç”Ÿæˆä¸­æ–­æ–‡ä»¶</font></li><li>è‹¥ä¿®æ”¹åå†è¿è¡Œç¨‹åºä¾¿ç”Ÿæˆ<code>core.PID</code>çš„coreæ–‡ä»¶ï¼ˆ<strong>coreæ–‡ä»¶ç”Ÿæˆçš„ä½ç½®ä¸€èˆ¬å’Œè¿è¡Œç¨‹åºçš„è·¯å¾„ç›¸åŒ, æ–‡ä»¶åä¸€èˆ¬ä¸ºcore.è¿›ç¨‹å·</strong>ï¼‰ã€‚</li></ul><h2 id="å¦‚ä½•ä½¿ç”¨coreæ–‡ä»¶"><a href="#å¦‚ä½•ä½¿ç”¨coreæ–‡ä»¶" class="headerlink" title="å¦‚ä½•ä½¿ç”¨coreæ–‡ä»¶?"></a>å¦‚ä½•ä½¿ç”¨coreæ–‡ä»¶?</h2><ul><li>å‘ç”Ÿcore dumpåï¼Œä½¿ç”¨gdbæŸ¥çœ‹coreæ–‡ä»¶å†…å®¹, ä»¥å®šä½æ–‡ä»¶ä¸­å¼•å‘core dumpçš„è¡Œï¼Œåœ¨Linuxä¸‹ï¼ŒæŸ¥çœ‹coreæ–‡ä»¶ä¸­çš„å‡ºé”™å †æ ˆä¿¡æ¯æœ‰äºŒç§æ–¹å¼ï¼Œä½¿ç”¨ï¼š<font color="red">gdb -c core.pid program_name</font>æˆ–gdb [program_name] [core.pid]å¯ä»¥è¿›å…¥gdbæ¨¡å¼</li><li>åœ¨è¿›å…¥gdbåè¾“å…¥<font color="red">whereå¹¶å›è½¦</font>ï¼Œå°±å¯ä»¥æŒ‡å‡ºæ˜¯åœ¨å“ªä¸€è¡Œè¢«Downæ‰ï¼Œåœ¨å“ªä¸ªå‡½æ•°å†…ï¼Œç”±è°è°ƒç”¨ç­‰ç­‰ã€‚</li><li>åœ¨è¿›å…¥gdbåè¾“å…¥<font color="red"> bt</font>ï¼Œç”¨btå‘½ä»¤æŸ¥çœ‹backtraceä»¥æ£€æŸ¥å‘ç”Ÿç¨‹åºè¿è¡Œåˆ°å“ªé‡Œï¼Œæ¥å®šä½core dumpçš„æ–‡ä»¶-&gt;è¡Œã€‚</li></ul><h2 id="core-dump-åŸå› "><a href="#core-dump-åŸå› " class="headerlink" title="core dump åŸå› "></a>core dump åŸå› </h2><ul><li><p><font color="red">batch_sizeè¿‡å¤§å¯¼è‡´çš„ã€‚Aborted(core dumped)</font></p></li><li><p>çº¿ç¨‹è¢«è°‹æ€ï¼Œ è¢«è°‹æ€è€…æ‰€åœ¨çº¿ç¨‹ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚Cancellation &amp; C++ Exception</p></li><li><p>pure virtual method called terminate called without an active exception è§£å†³æ–¹æ¡ˆ</p></li></ul><p>å¯¹äºå¤šçº¿ç¨‹çš„ç¨‹åºï¼Œè¿™ä¸ªé”™è¯¯çš„ä¸»è¦åŸå› æ˜¯å½“å‰å¯¹è±¡å·²ç»è¢«é”€æ¯æˆ–è€…æ­£åœ¨è¢«é”€æ¯ï¼Œä½†æ˜¯å…¶åˆåœ¨è¢«è°ƒç”¨ï¼Œå¯¼è‡´äº†å†²çªã€‚</p><ul><li>pure virtual method called</li></ul><hr><h1 id="æŸ¥çœ‹å­˜å‚¨ç©ºé—´ï¼š"><a href="#æŸ¥çœ‹å­˜å‚¨ç©ºé—´ï¼š" class="headerlink" title="æŸ¥çœ‹å­˜å‚¨ç©ºé—´ï¼š"></a>æŸ¥çœ‹å­˜å‚¨ç©ºé—´ï¼š</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh">zds@ubuntu ~ $ <span class="hljs-built_in">df</span> -hl<br>æ–‡ä»¶ç³»ç»Ÿ         å®¹é‡   å·²ç”¨  å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹<br>udev            972M     0  972M    0% /dev<br>tmpfs           199M  6.3M  192M    4% /run<br>/dev/sda1        23G  5.3G   17G   25% /<br>tmpfs           992M  212K  991M    1% /dev/shm<br>tmpfs           5.0M  4.0K  5.0M    1% /run/lock<br>tmpfs           992M     0  992M    0% /sys/fs/cgroup<br>tmpfs           199M   60K  199M    1% /run/user/1000 <br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>note</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Genome Survey</title>
    <link href="/GeekFocus/2022/02/23/2022-02-21-Survey/"/>
    <url>/GeekFocus/2022/02/23/2022-02-21-Survey/</url>
    
    <content type="html"><![CDATA[<h1 id="Genome-survey"><a href="#Genome-survey" class="headerlink" title="Genome survey"></a>Genome survey</h1><span id="more"></span><p>åŸºå› ç»„æ‚åˆåº¦å’Œé‡å¤åºåˆ—å¯¹åç»­åŸºå› ç»„ç»„è£…æœ‰å¾ˆå¤§å½±å“ã€‚</p><p><strong>é«˜æ‚åˆ</strong>åŸºå› ç»„å¾€å¾€æ— æ³•åˆå¹¶å§Šå¦¹æŸ“è‰²ä½“ï¼Œå¯¼è‡´ç»„è£…ç»“æœ<strong>åå¤§</strong>ã€‚</p><p>è€Œ<strong>é‡å¤åºåˆ—</strong>åœ¨ç»„è£…ä¸­è¢«æŠ˜å ï¼Œä½¿ç»„è£…ä¸­å‡ºç°ç¼ºå£ã€é”™è¯¯ï¼Œå¯¼è‡´ç»„è£…ç»“æœ<strong>åå°</strong>ã€‚</p><p>ä¸åŒçš„ç”Ÿç‰©åŸºå› ç»„ä¹‹é—´æ‚åˆç‡å’Œé‡å¤åºåˆ—å«é‡å·®å¼‚å·¨å¤§ï¼Œå› æ­¤åœ¨åŸºå› ç»„æµ‹åºå‰éœ€è¦å¯¹åŸºå› ç»„ç‰¹å¾è¿›è¡Œè°ƒç ”ï¼Œä»¥ç¡®å®šæµ‹åºæ–¹æ¡ˆï¼Œå‘¨æœŸç­‰ã€‚</p><p>ç›®å‰å¸¸ç”¨çš„è°ƒç ”æ‰‹æ®µæœ‰ä¸‰ç§ï¼š</p><ol><li>ç”¨æµå¼ç»†èƒä»ªæµ‹å®šç»†èƒæ ¸å†…çš„<strong>DNAæ€»é‡</strong></li><li>ç”¨æ ¸å‹åˆ†ææ–¹æ³•ï¼Œè¯†åˆ«<strong>æŸ“è‰²ä½“æ•°é‡ã€å€æ€§</strong></li><li>ç”¨è°ƒç ”å›¾ï¼Œé€šè¿‡äºŒä»£æµ‹åºï¼Œä¼°ç®—<strong>åŸºå› ç»„å¤§å°ã€æ‚åˆåº¦ã€é‡å¤åºåˆ—æ¯”ä¾‹ã€GCå«é‡</strong>ç­‰ã€‚</li></ol><p>ä¸åŒæŠ€æœ¯æ‰‹æ®µä¸åŒä¾§é‡ï¼Œå…¶ä¸­<font color="red">è°ƒç ”å›¾</font>ä»¥<font color="green">ä½æˆæœ¬ï¼Œä½éš¾åº¦å’Œæ›´å¤šçš„è¯„ä¼°å†…å®¹</font>ä½¿ç”¨æœ€å¤šï¼ŒåŒæ—¶<font color="red"><strong>Surveyæ‰€æµ‹äºŒä»£æ•°æ®è¿˜å¯ç”¨äºå›æ¯”åŸºå› ç»„ï¼Œè¯„ä¼°ç»„è£…è´¨é‡</strong></font>ã€‚è°ƒç ”å›¾<font color="green">åŸºäºæ•°å­¦ç»Ÿè®¡å­¦æ‰‹æ®µ</font>è·å–ç‰©ç§ä¿¡æ¯çš„æ–¹å¼ï¼Œå› æ­¤å¯¹äºå·²ç»ç ”ç©¶çš„è¾ƒä¸ºæ¸…æ™°çš„ç‰©ç§â€”â€”ä¸»è¦æ˜¯<font color="green"><strong>æ™®é€šäºŒå€ä½“å’Œç®€å•å¤šå€ä½“</strong></font>ï¼Œå…¶<font color="green">æŸ“è‰²ä½“æ¡æ•°ã€å€æ€§ã€å¤§æ¦‚åŸºå› ç»„å¤§å°æ˜¯å·²çŸ¥</font>ï¼Œæ­¤æ—¶ä»…é€‰æ‹©<strong>survey</strong>è¶³ä»¥æ»¡è¶³åŸºå› ç»„ç‰¹å¾éœ€è¦ï¼Œä½†å¯¹äº<strong>å¤šå€ä½“å¤æ‚åŸºå› ç»„</strong>æ›´æ¨è<strong>è¡¥å……æ ¸å‹åˆ†æå’Œæµå¼</strong>ï¼Œä»¥å’Œè°ƒç ”å›¾ç›¸äº’å°è¯è¡¥å……ã€‚</p><hr><p><strong>Survey æ–¹æ¡ˆ</strong></p><p>é€šè¿‡è´¨æ§ã€NTæ¯”å¯¹ï¼Œè·å¾—é«˜è´¨é‡çš„clean dataï¼Œä¸ºåç»­åˆ†æå¥ å®šè‰¯å¥½åŸºç¡€ï¼›</p><p>åŸºå› ç»„SurveyåŸºäºå°ç‰‡æ®µæ–‡åº“çš„ä½æ·±åº¦æµ‹åºæ•°æ®ï¼ˆ50Xï¼‰å·¦å³ï¼›</p><p>é€šè¿‡K-meråˆ†æï¼Œæœ‰æ•ˆçš„è¯„ä¼°åŸºå› ç»„å¤§å°ã€GCå«é‡ã€æ‚åˆåº¦ä»¥åŠé‡å¤åºåˆ—çš„å«é‡ç­‰ä¿¡æ¯ï¼›</p><p>å…¨é¢äº†è§£æŸä¸€ç‰©ç§åŸºå› ç»„ç‰¹å¾çš„æœ‰æ•ˆæ–¹æ³•ï¼›</p><p>ä¸ºåç»­çš„å…¨åŸºå› denoveæµ‹åºçš„ç»„è£…ç­–ç•¥çš„åˆ¶å®šæä¾›ç†è®ºä¾æ®ã€‚</p><p><strong>åˆ†æå†…å®¹</strong>ï¼šæ±¡æŸ“ç¨‹åº¦è¯„ä¼°ï¼ŒåŸºå› ç»„å¤§å°è¯„ä¼°ï¼Œæ‚åˆåº¦è¯„ä¼°ï¼Œé‡å¤ç‡è¯„ä¼°ï¼ŒGCå«é‡è¯„ä¼°ã€‚ã€åˆæ­¥äº†è§£ä¸‰ä»£ç»„è£…éš¾åº¦å’Œé¢„æœŸå¤§å°ã€‘</p><p><strong>åŸºå› ç»„å¤æ‚åº¦é¢„ä¼°?</strong></p><blockquote><p>æ™®é€šåŸºå› ç»„çš„å®šä¹‰ï¼Ÿ<br>å•å€ä½“ã€çº¯åˆäºŒå€ä½“æˆ–è€…æ‚åˆåº¦&lt;0.5%ï¼Œä¸”é‡å¤åºåˆ—å«é‡&lt;50%ï¼ŒGCå«é‡ä¸º35%åˆ°65%ä¹‹é—´çš„äºŒå€ä½“ã€‚</p><p>å¤æ‚åŸºå› ç»„çš„å®šä¹‰ï¼Ÿ<br>æ‚åˆåº¦&gt;0.5%ï¼Œé‡å¤åºåˆ—å«é‡&gt;50%ï¼Œå¤šå€ä½“ï¼ŒGCå«é‡å¤„äºå¼‚å¸¸çš„èŒƒå›´ï¼ˆGCå«é‡&lt;35%æˆ–è€…GCå«é‡&gt;65%çš„äºŒå€ä½“ï¼‰ã€‚</p><p><font color="red">äºŒå€ä½“å¤æ‚åŸºå› ç»„è¿›ä¸€æ­¥ç»†åˆ†ä¸º</font><br><font color="red"> å¾®æ‚åˆåŸºå› ç»„ï¼ˆ0.5%&lt;æ‚åˆç‡&lt;&#x3D;0.8%)</font><br><font color="red"> é«˜æ‚åˆåŸºå› ç»„ï¼ˆæ‚åˆç‡&gt;0.8%)</font><br> <font color="red">é«˜é‡å¤åŸºå› ç»„ï¼ˆé‡å¤åºåˆ—æ¯”ä¾‹&gt;50%ï¼‰</font></p><p>åŸºå› ç»„å¤§å°ï¼š<br> åŸºå› ç»„è¶Šå¤§ï¼Œæµ‹åºèŠ±é’±è¶Šå¤š</p></blockquote><blockquote><ul><li>ç®€å•åŸºå› ç»„: æ‚åˆåº¦ä½äº0.5%, GCå«é‡åœ¨35%~65%, é‡å¤åºåˆ—ä½äº50%</li><li>äºŒå€ä½“æ™®é€šåŸºå› ç»„: æ‚åˆåº¦åœ¨0.5%~1.2%ä¸­é—´ï¼Œé‡å¤åºåˆ—ä½äº50%ã€‚æˆ–æ‚åˆåº¦ä½äº0.5%ï¼Œé‡å¤åºåˆ—ä½äº65%</li><li>é«˜å¤æ‚åŸºå› ç»„: æ‚åˆåº¦&gt;1.2% æˆ– é‡å¤ç‡å¤§äº65%</li></ul></blockquote><hr><h1 id="è´¨æ§"><a href="#è´¨æ§" class="headerlink" title="è´¨æ§"></a>è´¨æ§</h1><p>å„æå‡º10,000å¯¹æ¯”å¯¹åˆ°<strong>NTåº“</strong>ï¼Œå¦‚æœéƒ½æ¯”å¯¹åˆ°åŒæºç‰©ç§ï¼Œè¯´æ˜æ— æ±¡æŸ“ï¼Œå¦‚æœæ¯”å¯¹åˆ°ç»†èŒçœŸèŒï¼Œå¯èƒ½æ•°æ®æœ‰æ±¡æŸ“ã€‚</p><h2 id="rawdata-qc"><a href="#rawdata-qc" class="headerlink" title="rawdata qc"></a>rawdata qc</h2><h2 id="trim"><a href="#trim" class="headerlink" title="trim"></a>trim</h2><h2 id="cleandata-qc"><a href="#cleandata-qc" class="headerlink" title="cleandata qc"></a>cleandata qc</h2><h2 id="NTæ•°æ®åº“æ¯”å¯¹"><a href="#NTæ•°æ®åº“æ¯”å¯¹" class="headerlink" title="NTæ•°æ®åº“æ¯”å¯¹"></a>NTæ•°æ®åº“æ¯”å¯¹</h2><p>Partially non-redundant nucleotide from all traditional divisions of GenBank, EMBL, and DDBJ excluding GSS,STS, PAT, EST, HTG, and WGS.</p><p><a href="https://ftp.ncbi.nih.gov/blast/db/FASTA/">NTåº“</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">blastn \<br>-query reads_2.fa \<br>-db /local_data1/public_data/database/genome_DB/nt/20190417_all/nt \<br>-out reads_2.csv \<br>-outfmt <span class="hljs-string">&quot;10 evalue length qseqid qlen qstart qend sacc slen sstart send pident nident sstrand qcovs qseq sseq sgi stitle&quot;</span> \<br>-num_threads 4 -evalue 1e-5 -max_target_seqs 1<br></code></pre></td></tr></table></figure><hr><p><a href="https://blog.csdn.net/u012110870/article/details/82500748">https://blog.csdn.net/u012110870/article/details/82500748</a></p><h1 id="k-mers"><a href="#k-mers" class="headerlink" title="k-mers"></a>k-mers</h1><p>æœ€ç®€å•çš„ç­–ç•¥å°±æ˜¯åŸºäºk-merå¯¹åŸºå› ç»„åšä¸€ä¸ªç®€å•çš„äº†è§£, ä½¿ç”¨jellyfishç»Ÿè®¡k-mersï¼Œç„¶åä½œå›¾</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">jellyfish count  -m 21 -s 20G -t 20 -o 21mer_out  -C --min-qual-char=? &lt;(zcat test_1.fq.gz) &lt;(zcat test_2.fq.gz)<br><span class="hljs-comment"># -m k-mersçš„K</span><br><span class="hljs-comment"># -s Hashå¤§å°, æ ¹æ®æ–‡ä»¶å¤§å°ç¡®å®š</span><br><span class="hljs-comment"># -t çº¿ç¨‹</span><br><span class="hljs-comment"># -o è¾“å‡ºå‰ç¼€</span><br><span class="hljs-comment"># -C ç»Ÿè®¡æ­£è´Ÿé“¾</span><br><span class="hljs-comment"># --min-qual-char è¿‡æ»¤ä½è´¨é‡ç¢±åŸºã€‚ åœ¨Phred+33ä¸­,?=30</span><br>jellyfish histo -o 21mer_out.histo 21mer_out<br></code></pre></td></tr></table></figure><p>ç”¨Rä½œå›¾</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">pdf</span><span class="hljs-params">(<span class="hljs-string">&quot;21_mer.out.pdf&quot;</span>)</span></span><br>dataframe19 &lt;- read<span class="hljs-selector-class">.table</span>(<span class="hljs-string">&quot;21mer_out.histo&quot;</span>)<br><span class="hljs-function"><span class="hljs-title">plot</span><span class="hljs-params">(dataframe19[<span class="hljs-number">1</span>:<span class="hljs-number">200</span>,], type=<span class="hljs-string">&quot;l&quot;</span>)</span></span><br>dev<span class="hljs-selector-class">.off</span>()<br></code></pre></td></tr></table></figure><p>ç”±äºåªæœ‰ä¸€ä¸ªä¸»å³°ï¼Œè¯´æ˜è¯¥ç‰©ç§çš„æ‚åˆåº¦å¹¶ä¸é«˜ï¼ŒåŸºæœ¬ä¸Šä¹Ÿå°±æ˜¯äºŒå€ä½“ã€‚å¦‚æœå›¾ä¸­å‡ºç°å¤šä¸ªå³°ï¼Œè¯´æ˜å®ƒå¯èƒ½æ˜¯å¤šå€ä½“æˆ–è€…æ˜¯åŸºå› ç»„æ‚åˆåº¦é«˜ã€‚</p><p>æ¨èæ–‡çŒ®: Genomic DNA k-mer spectra: models and modalities</p><h1 id="åŸºäºç»„è£…"><a href="#åŸºäºç»„è£…" class="headerlink" title="åŸºäºç»„è£…"></a>åŸºäºç»„è£…</h1><p>åŸºäºK-merså¯ä»¥è¾ƒå¥½çš„é¢„æµ‹åŸºå› ç»„å¤§å°ï¼Œå¹¶å®šæ€§çš„äº†è§£åŸºå› ç»„çš„å¤æ‚æƒ…å†µï¼Œå¦‚æœæƒ³æ›´å…·ä½“çš„äº†è§£åŸºå› ç»„çš„å¤æ‚åº¦ï¼Œå¯ä»¥å…ˆå°†50Xä»¥ä¸Šçš„æ®µç‰‡æ®µè¿›è¡Œç»„è£…ï¼Œç„¶åè¿›è¡Œåˆ†æã€‚</p><p>ç»„è£…çš„å·¥å…·æ¯”è¾ƒå¤šï¼Œæ¨èç”¨SOAPdenovoï¼Œå› ä¸ºé€Ÿåº¦å¿«ã€‚abyss?</p><p>æ–°å»ºä¸€ä¸ªcontig.config, å¢åŠ å¦‚ä¸‹å†…å®¹</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">max_rd_len</span>=<span class="hljs-number">150</span><br><span class="hljs-section">[LIB]</span><br><span class="hljs-attr">avg_ins</span>=<span class="hljs-number">200</span><br><span class="hljs-attr">reverse_seq</span>=<span class="hljs-number">0</span><br><span class="hljs-attr">asm_flags</span>=<span class="hljs-number">3</span><br><span class="hljs-attr">rd_len_cutoff</span>=<span class="hljs-number">100</span><br><span class="hljs-attr">rank</span>=<span class="hljs-number">1</span><br><span class="hljs-attr">pair_num_cutoff</span>=<span class="hljs-number">3</span><br><span class="hljs-attr">map_len</span>=<span class="hljs-number">32</span><br><span class="hljs-attr">q1</span>=read_1.fq<br><span class="hljs-attr">q2</span>=read_2.fq<br></code></pre></td></tr></table></figure><p>ç»„è£…å‡ºå‚è€ƒåºåˆ—</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">~<span class="hljs-regexp">/opt/</span>biosoft<span class="hljs-regexp">/SOAPdenovo2/</span>SOAPdenovo-<span class="hljs-number">63</span>mer all -s contig.config -R -K <span class="hljs-number">63</span> -p <span class="hljs-number">30</span> -o assembly/graph<br></code></pre></td></tr></table></figure><p>æœ€ågraph.scafSeqæ˜¯æ‹¼æ¥åçš„åºåˆ—, æå–å‡ºå¤§äº300bpçš„åºåˆ—.</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stata"># <span class="hljs-keyword">adjust</span> <span class="hljs-keyword">format</span><br>bioawk -c fastx -v name=1 &#x27;&#123;<span class="hljs-keyword">if</span>(<span class="hljs-built_in">length</span>(<span class="hljs-variable">$seq</span>)&gt;300) <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;&gt;&quot;</span>name <span class="hljs-string">&quot;\n&quot;</span> <span class="hljs-variable">$seq</span>;name+=1&#125;&#x27; assembly/<span class="hljs-keyword">graph</span>.scafSeq &gt;contig.fa<br></code></pre></td></tr></table></figure><h1 id="æ‚åˆåº¦ä¼°è®¡"><a href="#æ‚åˆåº¦ä¼°è®¡" class="headerlink" title="æ‚åˆåº¦ä¼°è®¡"></a>æ‚åˆåº¦ä¼°è®¡</h1><p>å°†åŸæ¥çš„åºåˆ—å›è´´åˆ°contigä¸Šï¼Œå¹¶ç”¨samtools+bcftoolsè¿›è¡Œsnp calling.ç»Ÿè®¡å˜å¼‚çš„ç¢±åŸºå æ€»ä½“çš„æ¯”ä¾‹ã€‚</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">mkdir</span> -p <span class="hljs-keyword">index</span><br>bwa <span class="hljs-keyword">index</span> contig.fa -p <span class="hljs-keyword">index</span>/contig<br>bwa mem -v <span class="hljs-number">2</span> -t <span class="hljs-number">10</span> <span class="hljs-keyword">index</span>/contig read_1.fq read_2.f<span class="hljs-string">q | samtools sort -n &gt; align.bam</span><br><span class="hljs-string">samtools mpileup -f contig align.bam |</span> bcftools call -mv -Oz -o variants.gz<br></code></pre></td></tr></table></figure><p>ä¸€æ–¹é¢ç”±äºSOAPdenovoç»„è£…è¿‡ç¨‹ä¸­ä¼šå‡ºé”™, å¦ä¸€æ–¹é¢samtoolsåœ¨å˜å¼‚æ£€æµ‹ä¸Šä¹Ÿå­˜åœ¨å¾ˆé«˜çš„å‡é˜³æ€§, æ‰€ä»¥æ€»å¾—å…ˆæŒ‰ç…§æ·±åº¦å’Œè´¨é‡è¿‡æ»¤ä¸€æ‰¹å‡é˜³æ€§ã€‚</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">bcftools view -i &#x27; DP &gt; 30 &amp;&amp; MQ &gt; 30&#x27; -H variants.vcf.gz <span class="hljs-string">| wc -l</span><br><span class="hljs-meta"># 325219, æ— è¿‡æ»¤æ˜¯445113</span><br></code></pre></td></tr></table></figure><p>å˜å¼‚æ•°ç›®å åŸºå› ç»„å¤§å°çš„æ¯”ä¾‹å°±æ˜¯æ‚åˆåº¦ã€‚æˆ‘çš„contigå¤§æ¦‚æ˜¯200Mï¼Œæ‰¾åˆ°0.3Må·¦å³çš„å˜å¼‚ï¼Œä¹Ÿå°±æ˜¯0.0015ï¼Œå³0.15%.</p><h1 id="é‡å¤åºåˆ—ä¼°è®¡"><a href="#é‡å¤åºåˆ—ä¼°è®¡" class="headerlink" title="é‡å¤åºåˆ—ä¼°è®¡"></a>é‡å¤åºåˆ—ä¼°è®¡</h1><p>åŸºäºåŒæºæ³¨é‡Šï¼Œç”¨RepeatMaskerå¯»æ‰¾é‡å¤åºåˆ—. è¿™é‡Œè¦æ³¨æ„åˆ†æçš„fastaçš„IDä¸èƒ½è¿‡é•¿ï¼Œä¹Ÿå°±æ˜¯æœ€å¥½æ˜¯<code>&gt;scaffold_1</code>è¿™ç§å½¢å¼ï¼Œä¸ç„¶ä¼šæŠ¥é”™ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">~<span class="hljs-regexp">/opt/</span>biosoft<span class="hljs-regexp">/RepeatMsker/</span>RepeatMasker -e ncbi -species arabidopsis -pa <span class="hljs-number">10</span> -gff -dir ./ contig.fa<br><span class="hljs-comment"># -e ncbi</span><br><span class="hljs-comment"># -species é€‰æ‹©ç‰©ç§ ç”¨~/opt/biosoft/RepeatMasker/util/queryRepeatDatabase.pl -tree äº†è§£</span><br><span class="hljs-comment"># -pa å¹¶è¡Œè®¡ç®—</span><br><span class="hljs-comment"># -gff è¾“å‡ºgffæ³¨é‡Š</span><br><span class="hljs-comment"># -dir è¾“å‡ºè·¯å¾„</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœä¸­ä¸»è¦å…³æ³¨å¦‚ä¸‹ä¸‰ä¸ª</p><ul><li>output.fa.masked, å°†é‡å¤åºåˆ—ç”¨Nä»£æ›¿</li><li>output.fa.out.gff, ä»¥gff2å½¢å¼å­˜æ”¾é‡å¤åºåˆ—å‡ºç°çš„ä½ç½®</li><li>output.fa.tbl, è¯¥æ–‡ä»¶è®°å½•ç€åˆ†ç±»ä¿¡æ¯</li></ul><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">==================================================<br>file name: anno.fasta<br>sequences:         62027<br>total length:  273135210 bp  (273135210 bp excl N/X-runs)<br>GC level:         36.80 %<br>bases masked:   79642191 bp ( 29.16 %)<br>==================================================<br></code></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çš„ç‰©ç§æœ‰30%çš„é‡å¤åºåˆ—ï¼Œä½œä¸ºå‚è€ƒï¼Œæ‹Ÿå—èŠ¥125Mb 14%é‡å¤åºåˆ—, æ°´ç¨»389Mï¼Œ36%é‡å¤</p><hr><h1 id="Grand-Omics"><a href="#Grand-Omics" class="headerlink" title="Grand Omics"></a><font color="green">Grand Omics</font></h1><p>å¿«é€Ÿï¼šK-meråˆ†ææ–¹æ³•ï¼Œå¯å¿«é€Ÿç¡®å®šåŸºå› ç»„ç‰¹å¾</p><p>ä¸“ä¸šï¼šç®€å•åŸºå› ç»„å’Œå¤æ‚åŸºå› ç»„ï¼ˆé«˜æ‚åˆã€å¤šå€ä½“ç­‰ï¼‰é‡‡ç”¨ä¸åŒç®—æ³•è½¯ä»¶</p><p>å»ºåº“ï¼šIllumina PE150æ™®é€šæ–‡åº“ï¼›æˆ–MGI PE150 æ™®é€šæ–‡åº“ã€‚æ€»é‡ â‰¥ 1Î¼gï¼›æ¨èæ•°æ®é‡ â‰¥ 50X</p><p>åˆ†æå†…å®¹ï¼šåŸå§‹æ•°æ®è´¨æ§ï¼›æ•°æ®æ±¡æŸ“æ£€æµ‹ï¼›åŸºå› ç»„å¤§å°é¢„ä¼°ï¼›åŸºå› ç»„æ‚åˆåº¦é¢„ä¼°</p><h2 id="æ•°æ®è´¨æ§åŠæ±¡æŸ“è¯„ä¼°"><a href="#æ•°æ®è´¨æ§åŠæ±¡æŸ“è¯„ä¼°" class="headerlink" title="æ•°æ®è´¨æ§åŠæ±¡æŸ“è¯„ä¼°"></a>æ•°æ®è´¨æ§åŠæ±¡æŸ“è¯„ä¼°</h2><p>å¯¹åŸå§‹æ•°æ®è´¨æ§è¿‡æ»¤ï¼Œç„¶åå¯¹åŸå§‹æ•°æ®ï¼ˆRaw dataï¼‰åŠè¿‡æ»¤åæ•°æ®ï¼ˆClean dataï¼‰è¿›è¡Œè´¨é‡ç»Ÿè®¡ã€‚éšæœºå–100,000æ¡è´¨æ§åçš„readsï¼Œç»Ÿè®¡readsåœ¨<font color="red">ntåº“</font>ä¸­çš„åˆ†å¸ƒæƒ…å†µåŠæ¯”å¯¹ä¸Šçš„ç‰©ç§åˆ†å¸ƒï¼Œä»¥è¯„ä¼°æ•°æ®æ±¡æŸ“æƒ…å†µã€‚</p><h2 id="åŸºå› ç»„å¤§å°å’Œæ‚åˆåº¦ä¼°è®¡"><a href="#åŸºå› ç»„å¤§å°å’Œæ‚åˆåº¦ä¼°è®¡" class="headerlink" title="åŸºå› ç»„å¤§å°å’Œæ‚åˆåº¦ä¼°è®¡"></a>åŸºå› ç»„å¤§å°å’Œæ‚åˆåº¦ä¼°è®¡</h2><p>åˆ©ç”¨<font color="red">åæ­£æ€åˆ†å¸ƒæ¨¡å‹ï¼ˆskew normal distribution modelï¼‰</font>ï¼Œ<font color="red">è´ŸäºŒé¡¹å¼æ¨¡å‹ (negative binomial model)</font> å¯¹K-mer æ•°æ®è¿›è¡Œæ‹Ÿåˆåˆ†æï¼Œè¿›è¡ŒåŸºå› ç»„å¤§å°ä»¥åŠæ‚åˆåº¦çš„è¯„ä¼°ï¼Œå¹¶ç”Ÿæˆæœ€ç»ˆåŸºå› ç»„è¯„ä¼°ç»“æœã€‚</p><p>ä¸€èˆ¬é€‰æ‹©<strong>17-mer</strong>è¯„ä¼°åŸºå› ç»„å¤§å°ï¼ŒATCGå››ç§ç¢±åŸºç»„æˆé•¿åº¦ä¸º17çš„æ ¸è‹·é…¸ç‰‡æ®µæœ‰4(17æ¬¡æ–¹)<del>17Gï¼Œè¶³ä»¥è¦†ç›–ä¸€èˆ¬çš„æ­£å¸¸åŸºå› ç»„ï¼›15mer</del>1Gã€‚å¯¹äºæ­£å¸¸åŸºå› ç»„å¯èƒ½è¦†ç›–åº¦ä¸å¤Ÿï¼Œå¯¼è‡´ä¼°è®¡ä¸å‡†ç¡®ã€‚&gt;15Gï¼Œé‡‡ç”¨19-meræˆ–21-merã€‚K-merè¶Šå¤§ï¼ŒåŒ…å«é”™è¯¯ä½ç‚¹çš„K-merè¶Šå¤šã€‚ä¸ºäº†<strong>é¿å…å›æ–‡åºåˆ—ï¼ŒKä¸ºå¥‡æ•°</strong>ã€‚</p><h2 id="GC-depth-åˆ†æåŠæ±¡æŸ“è¯„ä¼°"><a href="#GC-depth-åˆ†æåŠæ±¡æŸ“è¯„ä¼°" class="headerlink" title="GC-depth åˆ†æåŠæ±¡æŸ“è¯„ä¼°"></a>GC-depth åˆ†æåŠæ±¡æŸ“è¯„ä¼°</h2><p>å¯¹<font color="red">ç»„è£…çš„åŸºå› ç»„åºåˆ—</font>ä»¥<font color="red">5kbä¸ºwindows</font>ï¼Œæ— é‡å¤è®¡ç®—ç‰‡æ®µçš„<font color="red">å¹³å‡GCå«é‡å’Œå¹³å‡æ·±åº¦</font>å¹¶ä½œå›¾ã€‚åŸºäºæ¯ä¸€ä¸ªwindowså¯¹åº”çš„å¹³å‡GCå’Œå¹³å‡æ·±åº¦è¿›è¡Œç»˜å›¾ã€‚å¯ä»¥æ ¹æ®æ­¤å›¾åˆ†ææµ‹åºæ•°æ®æ˜¯å¦å­˜åœ¨GCåå‘æ€§ä»¥åŠæ ·æœ¬æ˜¯å¦å­˜åœ¨æ±¡æŸ“ã€‚</p><h1 id="Biomarker"><a href="#Biomarker" class="headerlink" title="Biomarker"></a><font color="green">Biomarker</font></h1><p>åŸºå› ç»„surveyä»¥æµ‹åºæŠ€æœ¯ä¸ºåŸºç¡€ï¼ŒåŸºäºå°ç‰‡æ®µæ–‡åº“çš„ä½æ·±åº¦æµ‹åºï¼Œé€šè¿‡K-meråˆ†æï¼Œå¿«é€Ÿè·å¾—åŸºå› ç»„å¤§å°ã€æ‚åˆåº¦ã€é‡å¤åºåˆ—æ¯”ä¾‹ç­‰åŸºæœ¬ä¿¡æ¯ï¼Œä¸ºåˆ¶å®šè¯¥ç‰©ç§çš„å…¨åŸºå› ç»„de novoæµ‹åºç­–ç•¥æä¾›æœ‰æ•ˆä¾æ®ã€‚</p><h2 id="è°ƒç ”å›¾åˆ†æåŸç†"><a href="#è°ƒç ”å›¾åˆ†æåŸç†" class="headerlink" title="è°ƒç ”å›¾åˆ†æåŸç†"></a>è°ƒç ”å›¾åˆ†æåŸç†</h2><p><img src="/GeekFocus/img/2022-02-21-Survey/1.png" alt="5"></p><p><img src="/GeekFocus/2022-02-21-Survey/1.png" alt="5"></p><p>k-merï¼Œå°†æ ¸é…¸åºåˆ—ä»¥æ»‘çª—åˆ†æˆåŒ…å«kä¸ªç¢±åŸºçš„çŸ­åºåˆ—ï¼Œâ€œmerâ€è¿™ä¸ªå•è¯çš„æ¥æº<font color="red">monomeric unitï¼Œå•ä½“å•å…ƒ</font>ã€‚Kä¸€èˆ¬ä¸ºå¥‡æ•°ï¼ˆé¿å…æ­£åé“¾æ··æ·†?ï¼‰ã€‚ç»Ÿè®¡æ‰€æœ‰readsä¸­æ‰€å‡ºç°çš„k-merç±»å‹åŠå„ç±»å‹k-merçš„æ·±åº¦ï¼ˆæˆ–è€…é¢‘ç‡ï¼‰ï¼Œç»˜åˆ¶ç‰¹å®šk-merä¸‹ä¸åŒæ·±åº¦k-merç‰‡æ®µçš„é¢‘æ•°ç»Ÿè®¡å›¾ï¼Œé€šå¸¸é€‰æ‹©K-meråˆ†å¸ƒæœ€å¤šçš„å³°ä¸ºä¸»å³°ï¼Œä»è€Œå¾—åˆ°<font color="red"><strong>åŸºå› ç»„å¤§å°&#x3D;K-meræ€»æ•°&#x2F;K-merä¸»å³°æ·±åº¦å€¼</strong></font>ã€‚</p><p>ç”±äºåŸºå› ç»„å­˜åœ¨<font color="red">æ‚åˆä½ç‚¹å’Œé‡å¤åºåˆ—</font>ï¼Œk-meræ›²çº¿ä¸æ˜¯æ ‡å‡†æ³Šæ¾åˆ†å¸ƒï¼Œåœ¨ä¸»å³°å‰åå‡ºç°å…¶ä»–çš„å³°ï¼Œå¦‚æœå­˜åœ¨ä¸€å®š<font color="red">æ‚åˆåº¦</font>ï¼Œä¼šå¯¼è‡´åœ¨<font color="red">ä¸»å³°æ¨ªåæ ‡çš„äºŒåˆ†ä¹‹ä¸€å¤„</font>å‡ºç°<font color="red">æ‚åˆå³°</font>ï¼Œè€Œä¸€å®šçš„<font color="red">é‡å¤åº¦</font>åˆ™ä¼šåœ¨<font color="red">ä¸»å³°å¯¹åº”çš„æ¨ªåæ ‡æ•´æ•°å€</font>å¤„å‡ºç°<font color="red">é‡å¤å³°</font>ã€‚</p><h2 id="è°ƒç ”å›¾åˆ†æå†…å®¹"><a href="#è°ƒç ”å›¾åˆ†æå†…å®¹" class="headerlink" title="è°ƒç ”å›¾åˆ†æå†…å®¹"></a>è°ƒç ”å›¾åˆ†æå†…å®¹</h2><p>è¯„ä¼°åŸºå› ç»„<font color="red">å¤§å°</font>ï¼›è¯„ä¼°åŸºå› ç»„<font color="red">æ‚åˆ</font>æƒ…å†µï¼›è¯„ä¼°<font color="red">é‡å¤åºåˆ—</font>å«é‡ï¼›è¯„ä¼°åŸºå› ç»„<font color="red">GCå«é‡</font>ï¼›ä¸ºåç»­ç²¾ç»†å›¾é˜¶æ®µçš„æ–‡åº“æ„å»ºæä¾›ç­–ç•¥å»ºè®®ã€‚</p><h2 id="åŸºå› ç»„è°ƒç ”å›¾surveyçš„æ„ä¹‰"><a href="#åŸºå› ç»„è°ƒç ”å›¾surveyçš„æ„ä¹‰" class="headerlink" title="åŸºå› ç»„è°ƒç ”å›¾surveyçš„æ„ä¹‰"></a>åŸºå› ç»„è°ƒç ”å›¾surveyçš„æ„ä¹‰</h2><p>å¯åŠ¨å…¨åŸºå› ç»„æµ‹åºçš„<font color="red">å¿…è¦å‰æ</font></p><p>äº†è§£ä¸<font color="red"><strong>è¿‘ç¼˜ç‰©ç§é—´</strong>çš„<strong>åŸºå› ç»„å·®å¼‚</strong>ä¿¡æ¯</font></p><p>è·å¾—æŸ<font color="red">ç‰©ç§åŸºå› ç»„çš„åŸºæœ¬ä¿¡æ¯åŠéš¾æ˜“ç¨‹åº¦</font></p><h1 id="Novogene"><a href="#Novogene" class="headerlink" title="Novogene"></a><font color="green">Novogene</font></h1><p>æ–¹æ¡ˆï¼šDNA10 ugï¼›æ–‡åº“350bpï¼›PE150æµ‹åºï¼Œæµ‹åºæ·±åº¦ä¸º50X</p><h2 id="åˆ†æå†…å®¹"><a href="#åˆ†æå†…å®¹" class="headerlink" title="åˆ†æå†…å®¹"></a>åˆ†æå†…å®¹</h2><ul><li>K-meråˆ†æ</li><li>é¢„ä¼°ç‰©ç§åŸºå› ç»„å¤§å°</li><li>GCå«é‡å’Œå¤–æºæ±¡æŸ“åˆ†æ</li><li>æ‚åˆåº¦è¯„ä¼°</li><li>é‡å¤åºåˆ—è¯„ä¼°</li><li>åˆæ­¥ç»„è£…</li><li>åŸºäºåˆæ­¥ç»„è£…çš„ç‰ˆæœ¬ï¼Œå¯ä»¥è¿›è¡ŒSSRæ ‡è®°å¼€å‘å’ŒåŒæºæ³¨é‡Šã€highlevelã€‘simple sequence repeats</li></ul><h1 id="BerryGenomics"><a href="#BerryGenomics" class="headerlink" title="BerryGenomics"></a><font color="green">BerryGenomics</font></h1><p>åŸºäºå°ç‰‡æ®µæ–‡åº“ä½æ·±åº¦æµ‹åºæ•°æ®ï¼Œé€šè¿‡K-meråˆ†æï¼Œæœ‰æ•ˆè¯„ä¼°åŸºå› ç»„å¤§å°ã€GCå«é‡ã€æ‚åˆåº¦é«˜ä½åŠé‡å¤åºåˆ—å«é‡ç­‰ä¿¡æ¯ï¼Œä¸ºåç»­çš„ç»„è£…ç­–ç•¥çš„åˆ¶å®šæä¾›ç†è®ºä¾æ®ã€‚</p><p><a href="https://pdf.sciencedirectassets.com/272196/1-s2.0-S0092867419X0015X/1-s2.0-S0092867420306188/main.pdf?X-Amz-Security-Token=IQoJb3JpZ2luX2VjEOj//////////wEaCXVzLWVhc3QtMSJHMEUCIEP3b6JimIkwVtoSmPnQ7fbUGBl4eNBBDDnBn4Sgw6y2AiEA9ob5g/J4zQrFLsTKjhs51/F/1tP61OMYZBAruOkb0fgq+gMIQRAEGgwwNTkwMDM1NDY4NjUiDMQhUFOWJRI31LL0UyrXA4jlyI72DidSpx8zf2iw85fV3Vmv5GwQ6zAU0go3NjgbvnEQeGHSyjCD3bfuIdLxx9+JR3iu8nTJwgeiw9+Pub8vYWrjzALVOyDRYnN4C6P68gzwDtI75rViTKSOYGpm0LXGHIuNV3O6NG9GNYo9nKQUdsmQfjBcBVHGBhXgRhFbmvWhLVufPeyZIY/sw6wiX3diCmbAuE7tTj4O0tA4ht9m/9y/rMizkGh9ZPtbzZ7JDkZm0+cpNEzpq3cQrGGNFrTcYFMQLf9YYSiY5LNr+zDXEI/cud8Oj8u3J75X7AtKXVgDFx3WOLQId9J+kxO1tSZ5/glrj2Mrth4nSXKk2TcSj6sirRM7+QbGIcYbhUHe+97GuZSfy6tJSD8POUgAUJZwoh9mtVgEIgRBR3uHjlgquc2QL4w5HsPkDpKmCRjT5ZIlJKfBli2DLWB81D9uot9Aw5SNzZ+mx3uR2mpTibb5v54gw7HtVunol7a5sq4awm3L8KRSRvUwk+fwX38TdFUH7OxZaFWIlBk536NC4ceJTACy5V5Ae+f7lhfpLN5wHzi3JomqhWFjfqqDLY11VHUBE2hJ2MtKtSQwilpBH+qtouIVYoOLFsKgJGfh0HvzkymqMQdxizDUhM2QBjqlAa9D4CUBq0ExkdHUsNdoKZ3Mz+0m1f72NRgmttBXR/CcVH6PUnSta5nZU2WQy6dUTWTx6pl8YHzW/DDLcwdU82BkQOE1n6CSzHGjaKA75v3T4RWRU9wOiObTdjqpmmMKTp2xohm4N78+/ZejYhLhk1Tx/CnUl2ue4z1/Utn17JSca5oVGbePorLRmqyYs5F3oL08SP73vwHxeNaoI7f7ucpUWqEcHA==&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20220221T081720Z&X-Amz-SignedHeaders=host&X-Amz-Expires=300&X-Amz-Credential=ASIAQ3PHCVTYYN624BKH/20220221/us-east-1/s3/aws4_request&X-Amz-Signature=16e8a26f9b71e59d421ff693fe49b021ce1222b688728bb93ce93ea82fb5968d&hash=ccc160836e462b394593db49a0b599b8a106fca7b355f59e9e05635b2a62f335&host=68042c943591013ac2b2430a89b270f6af2c76d8dfd086a07176afe7c76c2c61&pii=S0092867420306188&tid=spdf-0c4aa40e-20ae-4f30-8d50-b9cee2090b93&sid=5071d2f0595c814bfc9b6e825f0c6315e333gxrqa&type=client&ua=570456075759005851&rr=6e0e89a71f5d7c4a">å¤§è±†é«˜è´¨é‡æ³›åŸºå› ç»„å›¾è°±æ„å»º</a></p><p>æˆ‘å›½å¤§è±†æ¶ˆè´¹å¯¹å¤–ä¾èµ–ä¸¥é‡ï¼Œè€Œæé«˜å¤§è±†äº§é‡åˆ™å¿…é¡»å¯¹å¤§è±†ç§è´¨çš„é—ä¼ å¤šæ ·æ€§è¿›è¡Œç»¼åˆè¯„ä»·ã€‚ä¸­ç§‘é™¢é—ä¼ ä¸å‘è‚²ç”Ÿç‰©å­¦ç ”ç©¶æ‰€ç­‰å•ä½ä¸è´ç‘åŸºå› åˆä½œï¼Œåˆ©ç”¨æœ€æ–°ç»„è£…ç­–ç•¥æ„å»ºäº†é«˜è´¨é‡çš„åŸºäºå›¾å½¢çš„æ³›åŸºå› ç»„ã€‚è¯¥ç ”ç©¶åˆ©ç”¨Illuminaå¹³å°å¯¹æ¥è‡ªä¸–ç•Œå¤§è±†ä¸»äº§å›½çš„2,898ä»½å¤§è±†ç§è´¨è¿›è¡Œé‡æµ‹åºï¼ˆ13Ã—ï¼‰ï¼Œåˆ©ç”¨PacBioï¼ˆ96Ã—ï¼‰ã€Bionanoå’ŒHi-CæŠ€æœ¯å¯¹26ä»½ä»£è¡¨æ€§ç§è´¨è¿›è¡ŒåŸºå› ç»„ç»„è£…å’Œæ³›åŸºå› ç»„æ„å»ºã€‚å¹¶ä»¥ZH13åŸºå› ç»„ä¸ºåŸºå‡†åŸºå› ç»„ï¼Œæ•´åˆPAVsåæ„å»ºåŸºäºåŸºå› ç»„å›¾è°±ã€‚å°†é‡æµ‹åºæ•°æ®é‡æ–°æ¯”å¯¹åˆ°è¯¥åŸºå› ç»„è¿›è¡ŒSVsæ£€æµ‹å’ŒGWASåˆ†æã€‚åœ¨å¼€èŠ±çš„ä¸»æ•ˆä½ç‚¹<em>E3</em>å‘ç°äº†5ç§ä¸åŒçš„å•å€å‹ï¼›ç§çš®é¢œè‰²ç›¸å…³åŸºå› <em>CHS</em>çš„<em>I</em>ä½ç‚¹å‘ç°5ç§ä¸»è¦å•å€å‹ï¼›14å·æŸ“è‰²ä½“ä¸Šçš„ç¼ºé“è¤ªç»¿ç—‡QTLå†…å­˜åœ¨ä¸€ä¸ªè°ƒæ§Fe2+&#x2F;Zn2+è½¬è¿è›‹ç™½åŸºå› <em>SoyZH13_14G179600</em>ã€‚</p><hr><h1 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a><font color="green">Pipeline</font></h1><ul><li><p><strong>K-mer analysis</strong> (genome size,  repetive seq, heterozygous)</p><ul><li><p><a href="http://www.cbcb.umd.edu/software/jellyfish/">JELLYFISH</a>æ˜¯<a href="http://www.cbcb.umd.edu/">CBCB(Center for Bioinformatics and Computational Biology)</a>çš„Guillaume MarÃ§ais å’Œ <a href="http://www.cs.cmu.edu/~ckingsf/">Carl Kingsford</a> ç ”å‘çš„ä¸€æ¬¾è®¡æ•° DNA çš„ k-mers çš„è½¯ä»¶ã€‚è¯¥è½¯ä»¶è¿ç”¨ Hash è¡¨æ¥å­˜å‚¨æ•°æ®ï¼ŒåŒæ—¶èƒ½å¤šçº¿ç¨‹è¿è¡Œï¼Œé€Ÿåº¦å¿«ï¼Œå†…å­˜æ¶ˆè€—å°ã€‚è¯¥è½¯ä»¶åªèƒ½è¿è¡Œåœ¨64ä½çš„Linuxç³»ç»Ÿä¸‹ã€‚å…¶<a href="http://bioinformatics.oxfordjournals.org/content/27/6/764">æ–‡ç« </a>äº2011å¹´å‘è¡¨åœ¨æ‚å¿— <a href="http://bioinformatics.oxfordjournals.org/">Bioinformatics</a> ä¸Šã€‚<a href="https://www.cnblogs.com/zhanmaomao/p/9285582.html">https://www.cnblogs.com/zhanmaomao/p/9285582.html</a>,  <a href="https://github.com/gmarcais/Jellyfish#:~:text=Jellyfish%20Overview%20Jellyfish%20is%20a%20tool%20for%20fast%2C,central%20step%20in%20many%20analyses%20of%20DNA%20sequence">https://github.com/gmarcais/Jellyfish#:~:text=Jellyfish%20Overview%20Jellyfish%20is%20a%20tool%20for%20fast%2C,central%20step%20in%20many%20analyses%20of%20DNA%20sequence</a>.</p></li><li><pre><code class="sh">$ wget æœ€æ–°targz$ tar zxvf .tar.gz$ mkdir jellyfish$ cd jellyfish-2.3.0$ ./configure --prefix=Your/Path/to/jellyfishå¦‚æœå®‰è£…åœ¨å½“å‰ç›®å½•ä¸­ï¼Œä¼šæŠ¥é”™ã€‚$ make -j 8$ make install</code></pre></li></ul><table><thead><tr><th>jellyfish</th><th>Kmer</th><th>Clean</th><th>Insert</th><th>Depth</th><th>Kpeak</th><th>HetP</th><th>Heter</th><th>repeatP</th><th>Repeat</th><th>Size</th></tr></thead><tbody><tr><td>[4]</td><td>17</td><td>30.29G</td><td>220 bp</td><td>62.99X</td><td>54.98X</td><td>26X</td><td>0.18%</td><td>106X</td><td>291.49Mb?(60.60%)</td><td>480.97 Mb</td></tr><tr><td>[5]</td><td>21</td><td>54.23G</td><td>270bp</td><td>83.69Ã—</td><td>69 Ã—</td><td>34 Ã—</td><td>0.72%</td><td>139 Ã—</td><td>43.22%</td><td>648.07 Mb</td></tr><tr><td>[6]?</td><td>17</td><td>89G</td><td>350bp</td><td></td><td>48x</td><td>24x</td><td>0.69%</td><td>96x</td><td><strong>91.05%</strong></td><td>1.86G</td></tr><tr><td>[7]</td><td>19[21,23,25,27]</td><td>54.99G</td><td>270bp</td><td>45.37x</td><td>38x</td><td>19x</td><td>0.33%</td><td>76x</td><td><strong>70.62%</strong></td><td>1.2G</td></tr><tr><td>[8]è‡ªæºå››å€</td><td>17</td><td>27G</td><td>220</td><td></td><td>57</td><td>28</td><td><strong>1.37%</strong></td><td>114</td><td>42.81%</td><td>800M</td></tr><tr><td>[9]</td><td>17</td><td></td><td></td><td></td><td>52</td><td>26</td><td><strong>2.28%</strong></td><td>104</td><td><strong>89.2%</strong></td><td>4159 M</td></tr></tbody></table><ul><li>[6] : K-mer analysis:1.8G; flow cytometry: 8.50 Â± 0.38 Gb. å·¨å¤§åå·®ï¼Ÿæ‚åˆåº¦0.69%ï¼Œé‡å¤ratio 91.05%</li></ul></li><li><p><strong>assembly</strong></p><ul><li><p>[4] : soap devovo, abyss. </p><ul><li>K-mer 31, 54, 63, 70, 77 ,83. ç»“æœåªæœ‰77ï¼Œ105 Kmer soapdenovoï¼› AByss K43</li><li>optimal k-mer size was selected from the N50 length</li><li>usable reads &gt; 200 bases were selected to realign the contig </li><li>paired-end relationship between reads was coincident between contigs</li><li>scaffolds were constructed using insert size paired-ends</li></ul></li><li><p>[5] :</p></li><li><p>[8] :conduct de novo assembly. K-mer sizes of 20, 37, 55, 63, 71, 77, 83, and 95 were examined using default parameters. Assembly with k-mer 63 by SOAP de novo was selected because it has the optimal reading for N50</p><table><thead><tr><th>SOAPdenovo2</th><th>K-mer</th><th>ConN50</th><th>N90</th><th>TotalCon</th><th>ScaN50</th><th>N90</th><th>TotalSca</th><th>Genome</th></tr></thead><tbody><tr><td>[4]</td><td>77</td><td>1.48k</td><td>236</td><td>405M</td><td>3.55k</td><td>375</td><td>409M</td><td>480.97 M</td></tr><tr><td>[5]</td><td>65</td><td>1.59k</td><td>379</td><td>449M</td><td>3.5k</td><td>1262</td><td>543M</td><td>648.07 M</td></tr><tr><td>[6]?</td><td>41</td><td>287</td><td>127</td><td></td><td>1138</td><td>150</td><td></td><td></td></tr><tr><td>[7]</td><td></td><td></td><td></td><td></td><td>191bp</td><td></td><td>1.37G</td><td>1.2G</td></tr><tr><td>[8]</td><td>63</td><td>1.08k</td><td>219</td><td>170M</td><td>1.96k</td><td>1110</td><td>173M</td><td>800M</td></tr><tr><td>[9]</td><td></td><td>533</td><td></td><td></td><td>778</td><td>119</td><td>4.5G</td><td>4159M</td></tr></tbody></table></li></ul></li><li><p>GC</p><ul><li>[4] mid GC: 38%,  too high (&gt;65%) and too low (&lt;25%)</li><li>[4] GC depth two layer: only one of the two sets of homologous chromosomes in the diploid was assembled, which resulted in the emergence of the lower layer</li><li>[5] GC depth map was divided into 2 layers (Fig. 2), which was mainly due to the high heterozygosity.</li><li><font color="red"><strong>æ‰¾è¿‘ç¼˜çš„GCåšæ¯”è¾ƒï¼›çœ‹æ˜¯å¦GCåˆ†å±‚</strong></font></li><li>[8] the GC depth was slightly blocked into 4 layers (Fig. 2), which was in part caused by the polyploidy and the 1.37% high heterozygosity rate. è‡ªæºå››å€ä½“</li></ul></li><li><p><strong>Repetitive sequences</strong></p><ul><li>[4] :<strong>LTR_FINDER, MITE-Hunter, RepeatScout, and PILER-DF, PASTEClassifier, Repeat Masker, SciRoKo</strong> <ul><li>repetitive sequences ~147.89 Mb, 47.55% of the genome,</li><li>class I transposable element; class II transposable element</li><li>SSR(167,859SSR);  motif types</li></ul></li><li>[5] : total of 851,957 SSRs were identified,<strong>MISA</strong>. <ul><li>245 motif types</li></ul></li><li>[7] : <strong>MIcro-SAtellite(MISA)</strong><ul><li>Identification and characterisation of SSR motifs.</li><li>SSR marker verification</li></ul></li></ul></li><li><p><strong>Gene predition &amp; annotation</strong></p></li></ul><hr><p>ref</p><p><a href="https://www.jianshu.com/p/092103a24ce4">https://www.jianshu.com/p/092103a24ce4</a></p><p><a href="https://zhuanlan.zhihu.com/p/366933242">https://zhuanlan.zhihu.com/p/366933242</a></p><p>[4] Genome Survey Sequencing for the Characterization of the Genetic Background of Rosa roxburghii Tratt and Leaf Ascorbate Metabolism Genes [Plos one]</p><p>[5] Genome survey sequencing and genetic diversity of cultivated <em>Akebia trifoliata</em> assessed via phenotypes and SSR markers [Molecular Biology Reports <strong>2.3IF</strong>]</p><p>[6] : Genome survey sequencing of red swamp crayfish <em>Procambarus clarkii</em> [<strong>2.3IF</strong>] </p><p>[7] Genome survey sequencing and characterization of simple sequence repeat (SSR) markers in Platostoma palustre (Blume) A.J.Paton (Chinese mesona) [scientific reports <strong>4.3IF</strong>]</p><p>[8] Genome survey sequencing of *Dioscorea zingiberensis [genome <strong>2.1IF</strong>]</p><p>[9]Genome survey sequencing of Atractylodes lancea and identification of its SSR markers[Bioscience Reports, IF3.84]</p>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jellyfish &amp; Genomescope</title>
    <link href="/GeekFocus/2022/02/23/2022-02-23-jellyfish-genomescope/"/>
    <url>/GeekFocus/2022/02/23/2022-02-23-jellyfish-genomescope/</url>
    
    <content type="html"><![CDATA[<h1 id="A-fast-lock-free-approach-for-efficient-parallel-counting-of-occurrences-of-k-mers"><a href="#A-fast-lock-free-approach-for-efficient-parallel-counting-of-occurrences-of-k-mers" class="headerlink" title="A fast, lock-free approach for efficient parallel counting of occurrences of k-mers"></a>A fast, lock-free approach for efficient parallel counting of occurrences of k-mers</h1><span id="more"></span><h1 id="1-Paper-2011"><a href="#1-Paper-2011" class="headerlink" title="1. Paper-2011 :"></a><a href="https://pubmed.ncbi.nlm.nih.gov/21217122/">1. Paper-2011</a> :</h1><ul><li><p><font color="red">Counting the number of occurrences of every k-mer</font> </p></li><li><p><font color="green">genome assembly</font></p></li><li><p><font color="purple">error correction</font> of sequencing reads</p></li><li><p><font color="daekred">fast multiple sequence alignment</font> </p></li><li><p><font color="blue">repeat detection</font></p></li><li><p><strong>current</strong> k-mer counting tools <strong>too slow</strong> , <strong>memory intensive</strong></p></li><li><p>multicore computers facilities <strong>parallel computational paradigm</strong></p></li><li><p>multithreaded, <font color="red">lock-free hash table</font> </p></li><li><p><strong>k-mers up to 31</strong> </p></li><li><p><strong>suffix arrays</strong></p></li></ul><hr><h1 id="2-github-doc"><a href="#2-github-doc" class="headerlink" title="2. github-doc :"></a><font color="red"><a href="https://github.com/gmarcais/Jellyfish/tree/master/doc">2. github-doc</a></font> :</h1><h2 id="2-1-Counting-k-mers-in-sequencing-reads"><a href="#2-1-Counting-k-mers-in-sequencing-reads" class="headerlink" title="2.1 Counting k-mers in sequencing reads"></a>2.1 Counting k-mers in sequencing reads</h2><ul><li><p>The <code>-C</code> switch instructs to save in the hash only canonicalè§„èŒƒ k-mers, while the count is the number of occurrences of both a k-mer and it reverse complement.</p></li><li><p><font color="green"><strong>-s</strong></font> é¢„ä¼°å€¼è®¾ç½®ï¼šThe size parameter (given with <font color="red">-s</font>) is an indication of <font color="red">the number k-mers [N*(L-K+1)]</font> that will be <font color="red"><strong>stored in the hash</strong></font>. For sequencing reads, this size should be the size of <font color="red">the genome plus the k-mers generated by sequencing errors</font>. For example, if the error rate is <font color="red">e</font> (e.g.Illumina reads, usually e~<font color="red">1%</font>), with an estimated genome size of G and a coverage of <font color="red">c</font>, the number of expected k-mers is <font color="red"><strong>G+Gcek</strong></font>.</p></li></ul><blockquote><p>NOTE: unlike in Jellyfish 1, this <code>-s</code> parameter is <font color="red">only an estimation</font>. <font color="red">If the size given is too small to fit all the k-mers, the hash size will be increased automatically or partial results will be written to disk and finally merged automatically</font>. Running <code>jellyfish merge</code> should never be necessary, as now jellyfish now takes care of this task on its own. </p></blockquote><ul><li><font color="green"><strong>-s é¢„ä¼°kmerä»¥hashè¡¨å­˜å‚¨æ‰€éœ€å†…å­˜å¤§å°ï¼Œè®¾ç½®å°äº†ä¼šè‡ªåŠ¨æ‰©å¤§ï¼Œå¹¶è‡ªåŠ¨merge</strong></font>ã€‚</li><li>If the low frequency k-mers (k-mers occurring only once), which are mostly due to sequencing errors, are not of interest, one might consider counting only high-frequency k-mers (see section <a href="https://github.com/gmarcais/Jellyfish/tree/master/doc#Counting-high-frequency-k-mers">Counting high frequency k-mers</a>), which uses less memory and is potentially faster. <font color="green"><strong>ä½é¢‘k-mersç”±æµ‹åºé”™è¯¯å¯¼è‡´ï¼Œåªè€ƒè™‘é«˜é¢‘å‡å°‘å†…å­˜ä½¿ç”¨æé«˜é€Ÿåº¦</strong></font>ã€‚</li></ul><h2 id="2-2-Counting-k-mers-in-a-genome"><a href="#2-2-Counting-k-mers-in-a-genome" class="headerlink" title="2.2 Counting k-mers in a genome"></a>2.2 Counting k-mers in a genome</h2><ul><li>In an ã€actual genome or finished sequenceï¼Ÿã€‘, a k-mer and its reverse complement are not equivalent, hence using the <code>-C</code> switch does not make sense. In addition, the size for the hash can be set directly to the size of the genome.</li><li>-Cæ²¡æœ‰æ„ä¹‰ï¼Ÿå“ˆå¸Œè¡¨çš„sizeç›´æ¥è®¾ç½®ä¸ºåŸºå› ç»„å¤§å°ï¼Ÿä¸å¤Ÿè‡ªåŠ¨è°ƒæ•´ï¼Ÿ</li></ul><h2 id="2-3-Counting-high-frequency-k-mers"><a href="#2-3-Counting-high-frequency-k-mers" class="headerlink" title="2.3 Counting high-frequency k-mers"></a>2.3 Counting high-frequency k-mers</h2><p>Jellyfish offers <font color="red">two way</font> to count only high-frequency k-mers (<font color="red"><strong>count &gt;1</strong></font>), which reduces significantly the memory usage. Both methods are based on using <font color="red">Bloom filters</font>. The first method is a one pass method, which <font color="red">provides approximate count for some percentage of the k-mers</font>. The second method is a two pass method which <font color="red">provides exact count</font>. In both methods, most of the low-frequency k-mers are not reported.</p><h3 id="2-3-1-One-pass-method"><a href="#2-3-1-One-pass-method" class="headerlink" title="2.3.1 One pass method"></a>2.3.1 One pass method</h3><h3 id="2-3-2-Two-passes-method"><a href="#2-3-2-Two-passes-method" class="headerlink" title="2.3.2 Two passes method"></a>2.3.2 Two passes method</h3><h2 id="2-4-Counting-a-subset-of-k-mers"><a href="#2-4-Counting-a-subset-of-k-mers" class="headerlink" title="2.4 Counting a subset of k-mers"></a>2.4 Counting a subset of k-mers</h2><ul><li>It is possible to count the number of occurrences of <font color="red">only a subset of</font> predefined k-mers, using the <font color="red"><strong>â€“if</strong></font> switch. Only count the 20-mers of chromosome 20 in chromosome 1 of human</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">jellyfish count -m 20 -s 100M -C -t 10 -o 20and1.jf --<span class="hljs-keyword">if</span> chr20.fa chr1.fa<br></code></pre></td></tr></table></figure><ul><li><p>This <strong>reads all the canonical 20-mers from the file chr20.fa</strong> (<font color="green"><strong>but donâ€™t count them</strong></font>) and <font color="green"><strong>loads them in memory</strong></font>. Then it <strong>reads chr1.fa and counts the number of occurrences of the 20-mers</strong> <font color="green"><strong>only of the k-mers already loaded in memory</strong></font>.</p></li><li><p>æŠŠchr20çš„kmerï¼Œå­˜å‚¨ã€‚ç»Ÿè®¡chr1çš„20-meråœ¨ä¸Šä¸€æ­¥å­˜å‚¨ä¸­å·²å­˜åœ¨çš„éƒ¨åˆ†çš„æ•°ç›®ã€‚ï¼Ÿchr1å’Œ20çš„å…³è”ï¼Ÿ</p></li><li><p>Now, the histogram will also report k-mers with a <font color="green"><strong>0 count</strong></font> (<font color="green"><strong>the 20-mers of chr20</strong></font> which <font color="green"><strong>do not exists in chr1</strong></font>):</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ jellyfish histo 20and1.jf | <span class="hljs-built_in">head</span> <br>0 49401674<br>1 1116213<br>2 425471<br></code></pre></td></tr></table></figure><p>Note that the file given to <code>--if</code> is a fasta file. If a list of k-mers is available instead (say one per line in a text file), it can be transformed into a fasta file with one k-mer per line using the following one liner Perl command:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">perl -ne <span class="hljs-string">&#x27;print(&quot;&gt;\n$_&quot;)&#x27;</span><br><span class="hljs-comment">#kmer lineè½¬faï¼Œä¸€è¡Œ&gt;å·ï¼Œä¸€è¡Œkmer</span><br></code></pre></td></tr></table></figure><h2 id="2-5-å¦‚ä½•è¯»å–å‹ç¼©æ–‡ä»¶"><a href="#2-5-å¦‚ä½•è¯»å–å‹ç¼©æ–‡ä»¶" class="headerlink" title="2.5 å¦‚ä½•è¯»å–å‹ç¼©æ–‡ä»¶"></a>2.5 å¦‚ä½•è¯»å–å‹ç¼©æ–‡ä»¶</h2><p> jellyfishåªè¯»å…¥fqæˆ–fa</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">zcat *.fastq.gz | jellyfish count /dev/fd/0 ...<br><span class="hljs-comment">#using the &lt;() redirection provided by the shell (e.g. bash, zsh):</span><br><span class="hljs-comment">#!/usr/bin/bash</span><br>jellyfish count &lt;(zcat file1.fastq.gz) &lt;(zcat file2.fasta.gz) ...<br></code></pre></td></tr></table></figure><hr><h1 id="3-Jellyfishä»‹ç»"><a href="#3-Jellyfishä»‹ç»" class="headerlink" title="3. Jellyfishä»‹ç»"></a>3. Jellyfishä»‹ç»</h1><p><a href="http://www.cbcb.umd.edu/software/jellyfish/">JELLYFISH</a>æ˜¯<a href="http://www.cbcb.umd.edu/">CBCB(Center for Bioinformatics and Computational Biology)</a>çš„Guillaume MarÃ§ais å’Œ <a href="http://www.cs.cmu.edu/~ckingsf/">Carl Kingsford</a> ç ”å‘çš„ä¸€æ¬¾è®¡æ•° DNA çš„ k-mers çš„è½¯ä»¶ã€‚è¯¥è½¯ä»¶è¿ç”¨ Hash è¡¨æ¥å­˜å‚¨æ•°æ®ï¼ŒåŒæ—¶èƒ½å¤šçº¿ç¨‹è¿è¡Œï¼Œé€Ÿåº¦å¿«ï¼Œå†…å­˜æ¶ˆè€—å°ã€‚è¯¥è½¯ä»¶åªèƒ½è¿è¡Œåœ¨64ä½çš„Linuxç³»ç»Ÿä¸‹ã€‚å…¶<a href="http://bioinformatics.oxfordjournals.org/content/27/6/764">æ–‡ç« </a>äº2011å¹´å‘è¡¨åœ¨æ‚å¿— <a href="http://bioinformatics.oxfordjournals.org/">Bioinformatics</a> ä¸Šã€‚</p><h1 id="4-Jellyfishå®‰è£…"><a href="#4-Jellyfishå®‰è£…" class="headerlink" title="4. Jellyfishå®‰è£…"></a>4. Jellyfishå®‰è£…</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ wget æœ€æ–°targz<br>$ tar zxvf .tar.gz<br>$ <span class="hljs-built_in">mkdir</span> jellyfish<br>$ <span class="hljs-built_in">cd</span> jellyfish-2.3.0<br>$ ./configure --prefix=Your/Path/to/jellyfish<br>å¦‚æœå®‰è£…åœ¨å½“å‰ç›®å½•ä¸­ï¼Œä¼šæŠ¥é”™ã€‚<br>$ make -j 8<br>$ make install<br></code></pre></td></tr></table></figure><h1 id="5-Jellyfishä½¿ç”¨"><a href="#5-Jellyfishä½¿ç”¨" class="headerlink" title="5. Jellyfishä½¿ç”¨"></a>5. Jellyfishä½¿ç”¨</h1><h2 id="jellyfish-count-ã€count-kmers-to-estimate-genome-sizeã€‘"><a href="#jellyfish-count-ã€count-kmers-to-estimate-genome-sizeã€‘" class="headerlink" title="jellyfish count ã€count kmers to estimate genome sizeã€‘"></a>jellyfish count ã€count kmers to estimate genome sizeã€‘</h2><p>Theory:</p><ul><li>If k is large enough so that each kmer found is unique in the genome,</li><li>and if the genome length (e.g. 1,000,000) is much larger than the kmer length (e.g. 21),</li><li>and if no PCR or sequencing errors,</li><li>then the number of kmers will be approximately equal to the length of the genome.</li></ul><p>ï¼ï¼ï¼ï¼<font color="red">Kmer counting tutorial</font>: <a href="https://bioinformatics.uconn.edu/genome-size-estimation-tutorial/#">https://bioinformatics.uconn.edu/genome-size-estimation-tutorial/#</a></p><ul><li>Jellyfish: <a href="https://github.com/gmarcais/Jellyfish">https://github.com/gmarcais/Jellyfish</a></li><li>Further jellyfish steps : <a href="https://github.com/gmarcais/Jellyfish/tree/master/doc">https://github.com/gmarcais/Jellyfish/tree/master/doc</a></li></ul><p>Note: Aug 2019: conda install seems to work only with: conda install jellyfish&#x3D;2.2.3</p><p>Steps:</p><ul><li><font color="green">â€œ&gt;Go through</font> the sequencing reads</li><li>For each <font color="green">new kmer seen</font>, <font color="green">add to table with count</font>.</li><li>If kmer <font color="green">seen before</font>, <font color="green">increment count</font>.</li><li>Find the <font color="green">average kmer frequency</font> (sequencing depth), e.g. 50</li><li><font color="green">Exclude kmers with a count of ~ 1</font>, as these are likely from <font color="green">errors</font></li><li>Add all the other kmers, and <font color="green"><strong>divide by average kmer frequency</strong></font> &#x3D;&gt; This is the approx genome length</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">jellyfish</span> count -m <span class="hljs-number">21</span> -s <span class="hljs-number">100</span>M -t <span class="hljs-number">10</span> -C reads.fasta<br></code></pre></td></tr></table></figure><p>To use gzipped files: and <font color="green">paired-end reads</font>:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">jellyfish</span> count -m <span class="hljs-number">21</span> -s <span class="hljs-number">100</span>M -t <span class="hljs-number">10</span> -C &lt;zcat R1.fq.gz) &lt;(zcat R2.fq.gz)<br></code></pre></td></tr></table></figure><ul><li>-m: kmer length, 21 is commonly used, <strong>17</strong></li><li>-s: size of hash table: should be genome size + extra kmers from seq errors. <font color="green">However, it does say that hash size <strong>will be increased automatically if needed</strong>.</font></li><li>-C: canonical. <font color="green">Reverse complement kmers are considered to be identical and are counted as the same thing</font>. <font color="green"><strong>This is recommended</strong></font>.</li><li>-t: number of threads</li><li>output: mer_counts.jf</li></ul><p>Plot the histogram:</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">jellyfish </span>histo -t <span class="hljs-number">10</span> mer_counts.<span class="hljs-keyword">jf </span>&gt; reads.histo<br></code></pre></td></tr></table></figure><p><strong>???Plot the histogram with an x axis of one million instead of default 10,000</strong>:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">jellyfish</span> histo -t <span class="hljs-number">10</span> --high=<span class="hljs-number">1000000</span> mer_counts.jf &gt; reads.histo<br></code></pre></td></tr></table></figure><ul><li>Discussion on setting to 1 million: <a href="https://github.com/schatzlab/genomescope/issues/22">https://github.com/schatzlab/genomescope/issues/22</a></li><li>There may be very high counts of some kmers due to chloroplast sequences, spike-in sequences, etc.</li></ul><blockquote><p>ä½¿ç”¨fastqæ–‡ä»¶åœ¨é»˜è®¤å‚æ•°ä¸Šå’Œfastaæ–‡ä»¶æ²¡æœ‰åŒºåˆ«ã€‚ç”Ÿæˆçš„hashç»“æœä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs sh">-m | --mer-len=&lt;num&gt;<br> ä½¿ç”¨çš„k-merçš„é•¿åº¦ã€‚å¦‚æœåŸºå› ç»„å¤§å°ä¸ºGï¼Œåˆ™k-meré•¿åº¦é€‰æ‹©ä¸º: k ~= <span class="hljs-built_in">log</span>(200G)<br>/log(4)ã€‚<br>-s | --size=&lt;num&gt;<br> Hash çš„å¤§å°ã€‚æœ€å¥½è®¾ç½®çš„å€¼å¤§äºæ€»çš„ç‹¬ç‰¹çš„(distinct)k-meræ•°,è¿™æ ·ç”Ÿæˆçš„æ–‡ä»¶åª<br>æœ‰ä¸€ä¸ªã€‚è‹¥è¯¥å€¼ä¸å¤Ÿå¤§ï¼Œåˆ™ä¼šç”Ÿæˆå¤šä¸ª<span class="hljs-built_in">hash</span>æ–‡ä»¶ï¼Œä»¥æ•°å­—åŒºåˆ†æ–‡ä»¶åã€‚è¯¥å€¼è¯†åˆ« <br>M å’Œ Gã€‚<br>-t | --threads=&lt;num&gt;  default: 1<br> ä½¿ç”¨çš„CPUçº¿ç¨‹æ•°<br>-o | --output=&lt;string&gt;  default: mer_counts.jf<br> è¾“å‡ºçš„ç»“æœæ–‡ä»¶å‰ç¼€<br>-c | --counter-len=&lt;num&gt;  default:7<br> k-merçš„è®¡æ•°ç»“æœæ‰€å çš„æ¯”ç‰¹æ•°,é»˜è®¤æ”¯æŒçš„æœ€å¤§æ•°å­—æ˜¯2^7=128ã€‚å¯¹äºåŸºå› ç»„æµ‹åºè¦†ç›–<br>åº¦ä¸ºNï¼Œåˆ™è¦ä½¿è®¾ç½®çš„è¯¥å€¼è¦å¤§äºNã€‚è¯¥å€¼è¶Šå¤§ï¼Œæ¶ˆè€—å†…å­˜è¶Šå¤§ã€‚<br>-out-counter-len=&lt;num&gt;  default:4<br> è¾“å‡ºçš„äºŒè¿›åˆ¶<span class="hljs-built_in">hash</span>æ–‡ä»¶ä¸­çš„è®¡æ•°ç»“æœæ‰€å çš„å­—èŠ‚æ•°,ä¸€ä¸ªå­—èŠ‚æ˜¯8æ¯”ç‰¹ã€‚åˆ™é»˜è®¤æ”¯æŒçš„æœ€å¤§<br>æ•°å­—æ˜¯2^32=4.3G<br><span class="hljs-comment">#The count of k-mers which cannot be represented with the given number of bytes will have a value equal to the maximum value that can be represented. Meaning, if the counter field uses 1 byte, any k-mers with count greater or equal to 255 will be reported of having a count of 255.</span><br>-C | --both-strand  default: <span class="hljs-literal">false</span><br> ã€å¯¹æ­£ä¹‰é“¾å’Œåä¹‰é“¾éƒ½è¿›è¡Œè®¡æ•°ã€‘<br>-q | --quake  default: <span class="hljs-literal">false</span><br> quakeå…¼å®¹æ¨¡å¼<br>--quality-start=&lt;num&gt;  default: 64<br> èµ·å§‹ç¢±åŸºè´¨é‡çš„ASCIIå€¼ï¼Œé»˜è®¤ä¸ºPHRED64<br>--min-quality=&lt;num&gt;  default: 0<br> æ”¯æŒçš„æœ€å°çš„ç¢±åŸºè´¨é‡å€¼ï¼Œä½äºæ­¤å€¼çš„ç¢±åŸºå°†ç”±Nä»£æ›¿<br>-L | --lower-count=&lt;num&gt;<br> ã€ä¸è¾“å‡ºæ•°ç›®ä½äºæ­¤å€¼çš„k-merã€‘<br>-U | --upper-count=&lt;num&gt;<br> ã€ä¸è¾“å‡ºæ•°ç›®é«˜äºæ­¤å€¼çš„k-merã€‘<br><span class="hljs-comment">#low frequency and high frequency k-mers can be skipped using the --L and --U` switches respectively. Although it might be more appropriate to filter out the low frequency $k$-mers using Bloom filters, as shown in section Counting-high-frequency-k-mers.</span><br></code></pre></td></tr></table></figure></blockquote><h2 id="jellyfish-merge-åˆå¹¶"><a href="#jellyfish-merge-åˆå¹¶" class="headerlink" title="jellyfish merge åˆå¹¶"></a>jellyfish merge åˆå¹¶</h2><p>Countçš„è¾“å‡ºç»“æœä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½è¾“å‡ºå¤šä¸ªhashæ–‡ä»¶ï¼Œéœ€è¦hashæ–‡ä»¶åˆå¹¶ä¸€ä¸ªæ–‡ä»¶, merge å‘½ä»¤ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#The merge subcommand is of little direct use with version version 2 of Jellyfish</span><br><span class="hljs-comment">#The count subcommand will merge intermediary files automatically as needed.</span><br>jellyfish merge -o mer_counts_merged.jf hash1 hash2 ...<br></code></pre></td></tr></table></figure><blockquote><p>-o | â€“output&#x3D;<string>  default: mer_counts_merged.jf<br>    è¾“å‡ºçš„ç»“æœæ–‡ä»¶<br>â€“out-counter-len&#x3D;<num>  default: 4<br>è¾“å‡ºçš„äºŒè¿›åˆ¶hashæ–‡ä»¶ä¸­çš„è®¡æ•°ç»“æœæ‰€å çš„å­—èŠ‚æ•°,ä¸€ä¸ªå­—èŠ‚æ˜¯8æ¯”ç‰¹ã€‚åˆ™é»˜è®¤æ”¯æŒçš„æœ€å¤§æ•°å­—æ˜¯2^32&#x3D;4.3G</p></blockquote><h2 id="jellyfish-stats-ç»Ÿè®¡"><a href="#jellyfish-stats-ç»Ÿè®¡" class="headerlink" title="jellyfish stats ç»Ÿè®¡"></a>jellyfish stats ç»Ÿè®¡</h2><p>k-merçš„ç»“æœä»¥hashçš„äºŒè¿›åˆ¶æ–‡ä»¶ç»“æœç»™å‡ºï¼Œéœ€è¦ç»Ÿè®¡å‡ºk-meræ€»æ•°ï¼Œç‰¹å¼‚çš„k-meræ•°ç›®ï¼Œåªå‡ºç°è¿‡ä¸€æ¬¡çš„kmeræ•°ï¼Œå‡ºç°äº†æœ€å¤šçš„k-merçš„æ•°ç›®ç­‰ä¿¡æ¯ã€‚ä»¥statså‘½ä»¤æ¥è¿è¡Œã€‚ä½¿ç”¨æ–¹æ³•ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#Although these statistics could be computed from the histogram, it provides quick summary information</span><br>$ jellyfish stats <span class="hljs-built_in">hash</span><br>ç¤ºä¾‹ç»“æœä¸ºï¼š<br>Unique:    32355544    <span class="hljs-comment">#åªå‡ºç°è¿‡ä¸€æ¬¡çš„k-merçš„æ•°ç›®</span><br>Distinct:  88414020    <span class="hljs-comment">#ç‰¹å¼‚æ€§çš„k-meræ•°ç›®ï¼ŒåŒ…å«ä¸Šä¸€ä¸ªçš„æ•°æ®</span><br>Total:     432232807   <span class="hljs-comment">#æ€»çš„k-meræ•°ç›®</span><br>Max_count: 85348       <span class="hljs-comment">#åŒä¸€ä¸ªk-merå‡ºç°çš„æœ€å¤šçš„æ•°ç›®</span><br></code></pre></td></tr></table></figure><blockquote><p>-L | â€“lower-count&#x3D;<num><br>    ä¸ç»Ÿè®¡æ•°ç›®ä½äºæ­¤å€¼çš„k-mer<br>-U | â€“upper-count&#x3D;<num><br>    ä¸ç»Ÿè®¡æ•°ç›®é«˜äºæ­¤å€¼çš„k-mer</p></blockquote><h2 id="jellyfish-histo-ç»˜å›¾"><a href="#jellyfish-histo-ç»˜å›¾" class="headerlink" title="jellyfish histo ç»˜å›¾"></a>jellyfish histo ç»˜å›¾</h2><p>å¯¹k-merçš„è®¡æ•°ç»“æœæœ‰ä¸ªç›´è§‚çš„è®¤è¯†ï¼Œåˆ™éœ€è¦ç»Ÿè®¡å‡ºç°äº†x(x&#x3D;1,2,3â€¦)æ¬¡çš„kmerçš„æ•°ç›®y,ä»¥xï¼Œyä¸ºæ¨ªçºµåæ ‡ç”»å‡ºç›´æ–¹å›¾ã€‚ä½¿ç”¨ histo å‘½ä»¤èƒ½ç»™å‡º x å’Œ y å¯¹åº”çš„å€¼ï¼Œå°†ç»“æœé»˜è®¤è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚å…¶ä½¿ç”¨æ–¹æ³•ä¸º</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">jellyfish histo -l 1 -h 1000 <span class="hljs-built_in">hash</span><br></code></pre></td></tr></table></figure><blockquote><p>-l | â€“low&#x3D;<num>  default: 1<br>    æœ€ä½çš„ x è½´çš„å€¼ã€‚åŒæ—¶ç»“æœä¼šå°†ä½äºæ­¤å€¼çš„æ‰€æœ‰çš„k-merçš„æ•°ç›®ä½œä¸º (x-1) çš„å€¼ã€‚å› <br>æ­¤è¯¥å€¼ä¸º 2 å’Œ 1 çš„ç»“æœæ˜¯ä¸€è‡´çš„ã€‚<br>-h | â€“high&#x3D;<num>  ã€default: 10000ï¼Ÿï¼Ÿã€‘<br>    æœ€é«˜çš„ x è½´çš„å€¼ã€‚åŒæ—¶ç»“æœä¼šå°†é«˜äºæ­¤å€¼çš„æ‰€æœ‰çš„k-merçš„æ•°ç›®çš„å’Œä½œä¸º (x+1) çš„å€¼ã€‚<br>-i | â€“increment&#x3D;<num>  default: 1<br>    x è½´å–å€¼æ˜¯æ¯éš”è¯¥æ•°å€¼å–å€¼<br>-t | â€“threads&#x3D;<num>  default: 1<br>    ä½¿ç”¨çš„CPUçº¿ç¨‹æ•°<br>-f | â€“full  default: false<br>    å…¨éƒ¨çš„ç›´æ–¹å›¾</p></blockquote><h2 id="jellyfish-dump-ç»“æœæ–‡ä»¶æ ¼å¼è½¬æ¢"><a href="#jellyfish-dump-ç»“æœæ–‡ä»¶æ ¼å¼è½¬æ¢" class="headerlink" title="jellyfish dump ç»“æœæ–‡ä»¶æ ¼å¼è½¬æ¢"></a>jellyfish dump ç»“æœæ–‡ä»¶æ ¼å¼è½¬æ¢</h2><p>ç”±äºcountå‘½ä»¤ç”Ÿæˆçš„ç»“æœä¸ºäºŒè¿›åˆ¶çš„ï¼Œå¦‚æœ‰éœ€è¦ï¼Œåˆ™å¯ä»¥è½¬æ¢æˆå¯è¯»æ–‡æœ¬æ–‡ä»¶ã€‚ä½¿ç”¨ dump å‘½ä»¤ï¼Œä½¿ç”¨æ–¹æ³•ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">jellyfish dump -c -t -U 1000 <span class="hljs-built_in">hash</span><br><span class="hljs-comment">#To output all the counts for all the k-mers in the file</span><br><span class="hljs-comment">#By default, the output is in FASTA format</span><br>jellyfish dump mer_counts.jf &gt; mer_counts_dumps.fa<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh">-c | --colum  default: <span class="hljs-literal">false</span><br> ç”Ÿæˆç»“æœä¸º2åˆ—ï¼Œç¬¬ä¸€åˆ—ä¸ºk-meråºåˆ—ï¼Œç¬¬äºŒåˆ—ä¸ºå¯¹åº”çš„æ•°ç›®ã€‚é»˜è®¤æƒ…å†µä¸‹æ˜¯æ˜¯fastaæ ¼<br>å¼ï¼Œfastaçš„å¤´ä¸ºk-merçš„æ•°ç›®ï¼Œfastaçš„åºåˆ—ä¸ºk-merçš„åºåˆ—ã€‚<br>-t | --tab  default: <span class="hljs-literal">false</span><br> å½“ -c å‚æ•°å­˜åœ¨æ—¶ï¼Œä»¥tabæ¥è¿›è¡Œåˆ†éš”ä¸¤è¡Œã€‚é»˜è®¤æ˜¯ä»¥ç©ºæ ¼æ¥åˆ†å¼€çš„ã€‚<br><span class="hljs-comment"># Low frequency and high frequency k-mers can be skipped with the `-L` and `-U` switches respectively.</span><br>-L | --lower-count=&lt;num&gt;<br> ä¸è¾“å‡ºå°äºè¯¥å€¼çš„k-mer<br>-U | --upper-count=&lt;num&gt;<br> ä¸è¾“å‡ºé«˜äºè¯¥å€¼çš„k-mer<br>-o | --output=&lt;file&gt;<br> è¾“å‡ºæ–‡ä»¶çš„è·¯å¾„å’Œåç§°<br></code></pre></td></tr></table></figure><h2 id="jellyfish-query-æŸ¥è¯¢"><a href="#jellyfish-query-æŸ¥è¯¢" class="headerlink" title="jellyfish query æŸ¥è¯¢"></a>jellyfish query æŸ¥è¯¢</h2><p>å¦‚æœéœ€è¦ä»Hashç»“æœä¸­æŸ¥è¯¢æŒ‡å®šçš„k-merå‡ºç°çš„æ¬¡æ•°ï¼Œåˆ™è¦æ˜¯ç”¨ query å‘½ä»¤ã€‚ä»æ ‡å‡†è¾“å…¥è¯»å–k-merçš„åºåˆ—ï¼Œä»æ ‡å‡†è¾“å‡ºå¾—åˆ°k-merå¯¹åº”çš„æ•°ç›®ã€‚ä½¿ç”¨æ–¹æ³•</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">jellyfish query <span class="hljs-built_in">hash</span><br></code></pre></td></tr></table></figure><blockquote><p>-C | â€“both-strands  default: false<br>   åŒæ—¶æŸ¥è¯¢k-meråºåˆ—çš„æ­£è´Ÿé“¾<br>-i | â€“input&#x3D;<file><br>   è¾“å…¥çš„æ–‡ä»¶<br>-o | â€“output&#x3D;<file><br>   è¾“å‡ºçš„æ–‡ä»¶</p></blockquote><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">jellyfish </span>query mer_counts.<span class="hljs-keyword">jf </span>AACGTTG<br></code></pre></td></tr></table></figure><h2 id="jellyfish-info"><a href="#jellyfish-info" class="headerlink" title="jellyfish info"></a>jellyfish info</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#To get some information on ã€how, when and whereã€‘ this jellyfish file was ã€generatedã€‘, use the info subcommand</span><br><span class="hljs-comment">#outputs some information about the jellyfish file and the command used to generated it, in which directory and at what time the command was run</span><br>jellyfish info mer_counts.jf<br></code></pre></td></tr></table></figure><h2 id="jellyfish-mem"><a href="#jellyfish-mem" class="headerlink" title="jellyfish mem"></a>jellyfish mem</h2><p>The <code>mem</code> subcommand shows how much memory a count subcommand will need or conversely how large of a hash size will fit in a given amount of memory.</p><hr><p>refï¼š</p><p><a href="https://www.annasyme.com/docs/jellyfish.html">https://www.annasyme.com/docs/jellyfish.html</a></p><hr><h1 id="Genomescope"><a href="#Genomescope" class="headerlink" title="Genomescope"></a>Genomescope</h1><p>å®‰è£…githubæœ€æ–°</p><p><font color="red">githubdoc</font>  : <a href="https://github.com/schatzlab/genomescope">https://github.com/schatzlab/genomescope</a></p><p><font color="red">paperlink</font> : <a href="https://doi.org/10.1093/bioinformatics/btx153">https://doi.org/10.1093/bioinformatics/btx153</a></p><h2 id="æ•°æ®å‡†å¤‡"><a href="#æ•°æ®å‡†å¤‡" class="headerlink" title="æ•°æ®å‡†å¤‡"></a>æ•°æ®å‡†å¤‡</h2><p>å°†paired-endæ•°æ®æ•´åˆï¼Ÿå°†read2æ•°æ®çš„åºåˆ—åå‘é‡å¤åä¸read1æ–‡ä»¶åˆå¹¶ï¼Ÿä½¿ç”¨Trinityé™„å¸¦çš„fastoolç¨‹åºå®Œæˆè½¬æ¢ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ zcat read_1.clean.fq.gz | <span class="hljs-variable">$Trinity_Home</span>/trinity-plugins/fastool/fastool --illumina-trinity --to-fasta &gt; reads_1.fasta<br>$ zcat read_2.clean.fq.gz | <span class="hljs-variable">$Trinity_Home</span>/trinity-plugins/fastool/fastool --rev --illumina-trinity --to-fasta &gt; reads_2.fasta<br>$ <span class="hljs-built_in">cat</span> reads_1.fasta reads_2.fasta &gt; both.fasta<br></code></pre></td></tr></table></figure><h2 id="ç»Ÿè®¡kmer"><a href="#ç»Ÿè®¡kmer" class="headerlink" title="ç»Ÿè®¡kmer"></a>ç»Ÿè®¡kmer</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">jellyfish count -C -m [] -s [] -t [] s.fasta -o s.jf<br></code></pre></td></tr></table></figure><h2 id="ç»˜ç›´æ–¹å›¾"><a href="#ç»˜ç›´æ–¹å›¾" class="headerlink" title="ç»˜ç›´æ–¹å›¾"></a>ç»˜ç›´æ–¹å›¾</h2><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">jellyfish </span>histo -t <span class="hljs-number">10</span> s.<span class="hljs-keyword">jf </span>&gt; s.histo<br></code></pre></td></tr></table></figure><h2 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">-s é¢„ä¼°å“ˆå¸Œè¡¨çš„å¤§å°ï¼Œå³G+Gce*kã€‚Gæ˜¯Genome Sizeï¼›cæ˜¯coverageï¼ˆgenome surveyæµ‹åºé€šå¸¸ä½äº100xï¼‰ï¼›eæ˜¯æµ‹åºé”™è¯¯ç‡ï¼ˆilluminaä¸º1%ï¼‰ï¼›kæ˜¯kmerå¤§å°ã€‚<br>-C è¡¨ç¤ºè€ƒè™‘DNAæ­£ä¹‰ä¸åä¹‰é“¾ï¼Œé‡åˆ°åä¹‰kmeræ—¶ï¼Œè®¡å…¥æ­£ä¹‰kmeré¢‘æ•°ä¸­ã€‚<br></code></pre></td></tr></table></figure><h2 id="ç»˜å›¾"><a href="#ç»˜å›¾" class="headerlink" title="ç»˜å›¾"></a>ç»˜å›¾</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Rscript genomescope.R histogram_file k-mer_length read_length output_dir [kmer_max] [verbose]<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HiFi-2-SMRT Sequencing - HiFi Reads [High fidelity reads]</title>
    <link href="/GeekFocus/2022/02/20/2022-02-20-HiFi-2-SMRT/"/>
    <url>/GeekFocus/2022/02/20/2022-02-20-HiFi-2-SMRT/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸»æµä¸‰ä»£æµ‹åºå¹³å°Oxford-çš„-Nanoporeï¼ŒPacific-Biosciencesï¼ˆ-PacBioï¼‰çš„-Single-Molecule-Real-Timeï¼ˆSMRTï¼‰Sequencing"><a href="#ä¸»æµä¸‰ä»£æµ‹åºå¹³å°Oxford-çš„-Nanoporeï¼ŒPacific-Biosciencesï¼ˆ-PacBioï¼‰çš„-Single-Molecule-Real-Timeï¼ˆSMRTï¼‰Sequencing" class="headerlink" title="ä¸»æµä¸‰ä»£æµ‹åºå¹³å°Oxford çš„ Nanoporeï¼ŒPacific Biosciencesï¼ˆ PacBioï¼‰çš„ Single Molecule Real-Timeï¼ˆSMRTï¼‰Sequencing"></a>ä¸»æµä¸‰ä»£æµ‹åºå¹³å°Oxford çš„ Nanoporeï¼ŒPacific Biosciencesï¼ˆ PacBioï¼‰çš„ Single Molecule Real-Timeï¼ˆSMRTï¼‰Sequencing</h1><span id="more"></span><p>Ref:<a href="https://zhuanlan.zhihu.com/p/339875837">https://zhuanlan.zhihu.com/p/339875837</a></p><p><a href="http://pacbiofileformats.readthedocs.io/en/5.0/">http://pacbiofileformats.readthedocs.io/en/5.0/</a></p><p>PacBioä¼˜åŠ¿ï¼š</p><ul><li>åœ¨ä¸å½±å“ååé‡å’Œå‡†ç¡®æ€§å‰æä¸‹ï¼Œæä¾›ç›®å‰<font color="green">æœ€é•¿çš„è¯»å–é•¿åº¦</font></li></ul><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/1.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/1.png" alt="img"></p><ul><li>å¦‚æœä¸å«ç³»ç»Ÿè¯¯å·®ï¼Œå‡†ç¡®åº¦å¯è¾¾<font color="green"> 99.999ï¼…</font></li></ul><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/2.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/2.png" alt="img"></p><ul><li>å¯æµ‹å–å¯Œ<font color="green">å«ATæˆ–GCåŒºåŸŸ</font>ï¼Œ<font color="green">é«˜åº¦é‡å¤åºåˆ—</font>ï¼Œ<font color="green">å›æ–‡åºåˆ—</font>ç­‰ï¼Œä¸ä¼šäº§ç”ŸGCçš„è¾ƒå¤§åå·®</li><li>å¯ä»¥ç›´æ¥<font color="green">æµ‹å–åŒ–å­¦ä¿®é¥°</font>ï¼Œåœ¨<font color="green">è¡¨è§‚é—ä¼ å­¦</font>ä¸­æœ‰é‡è¦åº”ç”¨</li></ul><h1 id="æ–‡åº“æ„å»º"><a href="#æ–‡åº“æ„å»º" class="headerlink" title="æ–‡åº“æ„å»º"></a>æ–‡åº“æ„å»º</h1><p>å°†æ ·æœ¬ä¸­çš„DNAæˆ–RNAåˆ†å­æå–åï¼Œæ„å»º<font color="green">å“‘é“ƒçŠ¶åˆ†å­ç»“æ„<strong>SMRTbell</strong></font>ï¼š</p><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/3.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/3.png" alt="img"></p><p>é»„è‰²ï¼Œç´«è‰²ï¼šåŒé“¾DNAåˆ†å­; è“è‰²ï¼šæ¥å¤´ï¼ˆAdapterï¼‰</p><p>æ–‡åº“åˆ†å­å±•å¼€ï¼Œä¸€ä¸ªå®Œæ•´çš„<font color="green">åœ†ç¯</font>ï¼š</p><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/4.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/4.png" alt="img"></p><p>åœ†ç¯ç»“æ„æœ‰åˆ©äºå‘¨è€Œå¤å§‹çš„æ»šç¯å¤åˆ¶ï¼Œåˆ©äºçº é”™ã€‚</p><p>å°†æ ·æœ¬ä¸­æ‰€æœ‰çš„DNAç‰‡æ®µéƒ½æ„å»ºå“‘é“ƒçŠ¶åˆ†å­ç»“æ„ï¼Œç»„æˆçš„é›†åˆå«<font color="green">æ–‡åº“</font>ï¼ˆSMRTbell Libraryï¼‰ï¼Œéšåè¢«æ”¾åˆ°æµ‹åºèŠ¯ç‰‡ä¸­ã€‚</p><p>ä»¥åŸºå› ç»„HiFiæ–‡åº“ä¸ºä¾‹ï¼ˆ15-20Kæ–‡åº“ï¼‰ã€‚å½“å¾—åˆ°gDNAåï¼Œå…ˆåˆ©ç”¨G-tubeç®¡æˆ–Megaruptor Systemå°†åŸºå› ç»„<strong>ç‰‡æ®µåŒ–</strong>è‡³åˆé€‚å¤§å°ï¼Œè€Œåé€šè¿‡<strong>å»é™¤å•é“¾æ‚¬çª</strong>ã€<strong>æŸä¼¤ä¿®å¤</strong>å’Œ<strong>æœ«ç«¯ä¿®å¤</strong>ç­‰æ­¥éª¤ï¼Œå¾—åˆ°å®Œæ•´çš„åŒé“¾æ’å…¥ç‰‡æ®µã€‚æ¥ä¸‹æ¥ï¼Œé€šè¿‡å°†<strong>æ¥å¤´è¿æ¥</strong>è‡³åŒé“¾DNAæ¥åˆ›å»ºSMRTbellæ–‡åº“ï¼Œä»è€Œå¾—åˆ°ç¯çŠ¶æ¨¡æ¿ã€‚å®Œæˆæ¥å¤´è¿æ¥åï¼Œéœ€è¦å¯¹è¿æ¥äº§ç‰©è¿›è¡Œçº¯åŒ–ï¼Œåˆ©ç”¨<strong>é…¶å¤„ç†</strong>æ¥æ¶ˆåŒ–çº¿æ€§æˆ–å†…éƒ¨æŸä¼¤ç¯å½¢DNAåˆ†å­ï¼ˆæ¸¸ç¦»çš„Hairpin Adapterã€ä¸¤ç«¯æœªè¿æ¥Adapterçš„DNAæ¨¡æ¿ã€å·²æˆç¯ä½†å†…éƒ¨æœ‰æŸä¼¤çš„DNAæ¨¡æ¿ï¼‰ï¼Œé…¶å¤„ç†å®Œæ¯•åï¼Œä¸€èˆ¬ä¼šåˆ©ç”¨<strong>Bulepippin</strong>æˆ–Sage ELF Systemåˆ‡èƒ¶<strong>å›æ”¶ç›®æ ‡å¤§å°èŒƒå›´</strong>å†…çš„æ–‡åº“ã€‚æ–‡åº“è´¨æ£€</p><h1 id="æµ‹åºèŠ¯ç‰‡"><a href="#æµ‹åºèŠ¯ç‰‡" class="headerlink" title="æµ‹åºèŠ¯ç‰‡"></a>æµ‹åºèŠ¯ç‰‡</h1><p>ä»¥ RSII æµ‹åºå¹³å°ä¸ºä¾‹ï¼Œæµ‹åºä»ªèŠ¯ç‰‡ï¼ˆSMRT Cellï¼‰ï¼š</p><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/5.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/5.png" alt="img"></p><p>æ”¾å¤§ï¼šä¸Šé¢æ•´é½æ’åˆ—ç€<font color="green">15ä¸‡ä¸ª</font>ç›´å¾„ä¸º<font color="green">70çº³ç±³çš„æµ‹åºå¾®å­”</font>ï¼ˆ<font color="red">Zero-Model Waveguidesï¼ŒZMWs</font>ï¼‰ã€‚</p><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/6.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/6.png" alt="img"></p><h1 id="ä¸Šæœºæµ‹åº"><a href="#ä¸Šæœºæµ‹åº" class="headerlink" title="ä¸Šæœºæµ‹åº"></a>ä¸Šæœºæµ‹åº</h1><h2 id="1-æ„å»ºæµ‹åºå¤åˆç‰©"><a href="#1-æ„å»ºæµ‹åºå¤åˆç‰©" class="headerlink" title="1. æ„å»ºæµ‹åºå¤åˆç‰©"></a>1. <strong>æ„å»ºæµ‹åºå¤åˆç‰©</strong></h2><p>æµ‹åºå¤åˆç‰©ï¼šèšåˆé…¶ï¼Œæµ‹åºæ¨¡æ¿ï¼Œæµ‹åºå¼•ç‰©</p><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/7.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/7.png" alt="img"></p><h2 id="2-å¤åˆç‰©æ’’å…¥æµ‹åºå°å­”"><a href="#2-å¤åˆç‰©æ’’å…¥æµ‹åºå°å­”" class="headerlink" title="2. å¤åˆç‰©æ’’å…¥æµ‹åºå°å­”"></a>2. <strong>å¤åˆç‰©æ’’å…¥æµ‹åºå°å­”</strong></h2><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/8.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/8.png" alt="img"></p><h2 id="3-å›ºå®šæµ‹åºå¤åˆç‰©"><a href="#3-å›ºå®šæµ‹åºå¤åˆç‰©" class="headerlink" title="3. å›ºå®šæµ‹åºå¤åˆç‰©"></a>3. <strong>å›ºå®šæµ‹åºå¤åˆç‰©</strong></h2><p>ç”±äº<font color="green">èšåˆé…¶åŠ äº†<strong>ç”Ÿç‰©ç´ </strong></font>ï¼Œåœ¨<font color="green">èŠ¯ç‰‡ç»ç’ƒåº•æ¿æœ‰<strong>é“¾é…¶äº²å’Œç´ </strong></font>ã€‚åˆ©ç”¨ç”Ÿç‰©ç´ å’Œé“¾é…¶äº²å’Œç´ çš„äº²å’ŒåŠ›ï¼ŒåŒ…å«èšåˆé…¶çš„<strong>æµ‹åºå¤åˆç‰©ä¼šè¢«<font color="green">å›ºå®š</font>åœ¨ç»ç’ƒåº•æ¿ã€‚</strong></p><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/9.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/9.png" alt="img"></p><h2 id="4-æ„å»ºå¸¦æœ‰è§å…‰åŸºå›¢çš„dNTP"><a href="#4-æ„å»ºå¸¦æœ‰è§å…‰åŸºå›¢çš„dNTP" class="headerlink" title="4. æ„å»ºå¸¦æœ‰è§å…‰åŸºå›¢çš„dNTP"></a>4. <strong>æ„å»ºå¸¦æœ‰è§å…‰åŸºå›¢çš„dNTP</strong></h2><p>åœ¨èŠ¯ç‰‡æº¶æ¶²ä¸­å«æœ‰è®¸å¤šæ¸¸ç¦»dNTPï¼Œæ‰€è°“æ¸¸ç¦»dNTPå°±æ˜¯éšæœºé£˜åœ¨æº¶æ¶²ä¸­çš„dNTPã€‚</p><p>ATGCå››ç§ç¢±åŸºçš„dNTPï¼Œåœ¨ç£·é…¸åŸºå›¢ä¸Šåˆ†åˆ«å¸¦æœ‰<font color="green">å››ç§é¢œè‰²çš„è§å…‰åŸºå›¢</font>ã€‚</p><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/10.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/10.png" alt="img"></p><h2 id="5-è¾¹åˆæˆè¾¹æµ‹åº"><a href="#5-è¾¹åˆæˆè¾¹æµ‹åº" class="headerlink" title="5. è¾¹åˆæˆè¾¹æµ‹åº"></a>5. <strong>è¾¹åˆæˆè¾¹æµ‹åº</strong></h2><p>åœ¨åˆæˆæ—¶ï¼Œæ¸¸ç¦»çš„dNTPè¢«å›ºå®šåœ¨åº•æ¿ä¸Šçš„é…¶æ•è·ï¼Œ<font color="green">æ¿€å‘å…‰ä¼šä»ç»ç’ƒæ¿åº•éƒ¨å‘å‡º</font>ã€‚</p><p><video src="/img/2022-02-20-SMRT-sequencing/11.mp4"></video><br><video src="2022-02-20-SMRT-sequencing/11.mp4"></video><br><strong>æ€ä¹ˆä¿è¯æ¯æ¬¡æµ‹å–ä¸€ä¸ªç¢±åŸºï¼Ÿ</strong></p><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/12.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/12.png" alt="img"></p><p>ç”±äºæµ‹åºå°å­”ç›´å¾„å¾ˆå°ï¼Œæ¿€å‘å…‰çš„ç©¿é€èƒ½åŠ›ä¼šé€æ¸è¡°å‡ï¼Œåªèƒ½åœ¨å°å­”ä¸­ä¼ è¾“å¾ˆçŸ­çš„è·ç¦»ï¼Œæ‰€ä»¥<font color="green">åªæœ‰å½“dNTPè¶³å¤Ÿé è¿‘åº•éƒ¨ï¼Œè§å…‰åŸºå›¢æ‰ä¼šè¢«æ¿€å‘å…‰ç…§åˆ°ï¼Œå‘å‡ºè§å…‰</font>ã€‚å…¶ä»–æ¸¸ç¦»dNTPè™½ç„¶ä¹Ÿæœ‰å¯èƒ½é£˜åˆ°å°å­”åº•éƒ¨è¢«æ¿€å‘å…‰ç…§åˆ°ï¼Œä½†è¿™ç§æƒ…å†µæå°‘ã€‚<br>åœ¨ä¸€ä¸ªç¢±åŸºåˆæˆç»“æŸåï¼Œå¸¦æœ‰è§å…‰åŸºå›¢çš„ç£·é…¸åŸºå›¢ä¼šä»dNTPä¸Šæ‰è½ï¼Œå‘ç”ŸçŒç­ï¼Œä¸å½±å“å…¶ä»–ç¢±åŸºçš„ä¿¡å·æ£€æµ‹ã€‚ åœ¨å‘ç”Ÿæµ‹åºçš„å°å­”æœ‰å„è‡ªçš„DNAç‰‡æ®µå’Œæµ‹åºå¤åˆç‰©ï¼ŒåŒä¸€æ—¶é—´å‘å‡ºä¸åŒé¢œè‰²çš„æ¿€å‘å…‰ï¼Œæœºå™¨ä¼šæ£€æµ‹åˆ°å¦‚ä¸‹çš„å…‰ä¿¡å·ï¼Œå®é™…åŒæ—¶ä¼šå¾—åˆ°å¤šè¾¾å‡ ä¸‡ä¸ªå…‰ç‚¹ã€‚</p><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/13.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/13.png" alt="img"></p><p>é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œç»è¿‡è®¡ç®—æœºåˆ†æå…‰è°±ï¼Œæœ€ç»ˆæˆ‘ä»¬æ‹¿åˆ°æ ·æœ¬çš„æµ‹åºæ–‡ä»¶ã€‚SMRT Sequencing æµ‹åºè¿‡ç¨‹ä¸­ï¼Œ<font color="green">æ¯ç§’è¯»å–ä¸‰ä¸ªç¢±åŸº</font>ï¼Œä¸€ä¸ªå°æ—¶å¯æ£€æµ‹å¤§çº¦ä¸€ä¸‡å¤šç¢±åŸºã€‚</p><h2 id="6-æ£€æµ‹ç¢±åŸºç”²åŸºåŒ–"><a href="#6-æ£€æµ‹ç¢±åŸºç”²åŸºåŒ–" class="headerlink" title="6. æ£€æµ‹ç¢±åŸºç”²åŸºåŒ–"></a>6. <strong>æ£€æµ‹ç¢±åŸºç”²åŸºåŒ–</strong></h2><p>åœ¨SMRT Sequencingæµ‹åºè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥<font color="green">ç›´æ¥æµ‹åˆ°ç¢±åŸºè¢«ä¿®é¥°çŠ¶æ€</font>ï¼Œèšåˆé…¶é‡åˆ°ç¢±åŸºä¸Šå¸¦æœ‰ç”²åŸºåŒ–çš„ç¢±åŸºï¼Œ<font color="green">åˆæˆé€Ÿåº¦æ˜æ˜¾å˜æ…¢</font>ï¼Œè€Œä¸”<font color="green">å…‰è°±ä¹Ÿä¼šå‘ç”Ÿæ”¹å˜</font>ã€‚SMRT Sequencing å¯ä»¥æ£€æµ‹åˆ°ç¢±åŸºçš„ç”²åŸºåŒ–ä¿®é¥°ã€‚</p><h1 id="æµ‹åºæ¨¡å‹"><a href="#æµ‹åºæ¨¡å‹" class="headerlink" title="æµ‹åºæ¨¡å‹"></a>æµ‹åºæ¨¡å‹</h1><h2 id="1-Circular-Consensus-Sequencing-CCS-â€“-HiFi"><a href="#1-Circular-Consensus-Sequencing-CCS-â€“-HiFi" class="headerlink" title="1. Circular Consensus Sequencing (CCS) â€“ HiFi"></a>1. Circular Consensus Sequencing (CCS) â€“ HiFi</h2><p>è¯´è¿™ç§æµ‹åºæ¨¡å‹å‰ï¼Œå°±ä¸å¾—ä¸æä¸‰ä»£æµ‹åºæœ€å¤§çš„ç¼ºç‚¹ï¼š<font color="green">ç¢±åŸºè¯»å–ä¸å‡†ï¼Œé”™è¯¯ç‡åœ¨12.5%</font>ã€‚æ¯å…«ä¸ªç¢±åŸºè¯»é”™ä¸€ä¸ªã€‚</p><p>ç¢±åŸºè¯»å–<font color="green">é”™è¯¯éšæœº</font>ï¼Œé‡è¯»ä¸€éåŒæ ·ä½ç½®çš„ç¢±åŸºï¼Œä¸ä¸€å®šå‘ç”Ÿç›¸åŒé”™è¯¯ã€‚</p><p>å¯¹åŒä¸€ä¸ªåºåˆ—ï¼Œå¤šæµ‹å‡ éï¼Œ<font color="red">çŸ«æ­£</font>è¯»é”™ç¢±åŸºã€‚</p><p>æ»šç¯å¤åˆ¶çš„ä¼˜åŠ¿: åˆ©ç”¨æµ‹åºå¤åˆç‰©åœ¨<font color="red">ç¯çŠ¶æ–‡åº“åˆ†å­å¾ªç¯æµ‹åº</font><strong>åŒä¸€ä¸ªç‰‡æ®µ</strong>æ¥<font color="green">æ¶ˆé™¤é”™è¯¯ç‡</font>ã€‚</p><p>HiFi readsï¼ˆHigh Fidelity readsï¼‰æ˜¯2019å¹´ç”±PacBioæ¨å‡ºçš„åŸºäº<font color="red">ç¯åŒ–å…±æœ‰åºåˆ—ï¼ˆCircular Consensus Sequencingï¼ŒCCSï¼‰</font>æ¨¡å¼äº§ç”Ÿçš„æ—¢å…¼é¡¾é•¿è¯»é•¿ï¼ˆ<font color="red">10-20kb</font>é•¿åº¦ï¼‰åˆå…·æœ‰é«˜ç²¾åº¦ï¼ˆ&gt;99%å‡†ç¡®ç‡ï¼‰çš„æµ‹åºç»“æœã€‚</p><p>è¶…é•¿é…¶è¯»é•¿ä¸­ï¼Œå»æ‰æ¥å¤´åºåˆ—ï¼Œå³å¯è·å¾—å¤šæ¡subreadsã€‚å¤šæ¡subreadsåˆå¹¶ç”Ÿæˆé«˜åº¦ä¸€è‡´æ€§çš„hifi readsã€‚</p><p><video src="/img/2022-02-20-SMRT-sequencing/14.mp4"></video><br><video src="2022-02-20-SMRT-sequencing/14.mp4"></video><br>è¿™ç§æµ‹åºæ¨¡å‹ï¼Œå¤åˆ¶å‡ºçš„ Readså« <font color="red">HiFi Reads [High fidelity reads]</font>ï¼Œæµ‹åºå‡†ç¡®ç‡ &gt; 99%ã€‚</p><p>HiFi reads are a <strong>type of data produced using the circular consensus sequencing (CCS) mode on one of the PacBio Sequel Systems</strong>.</p><p>HiFi readsï¼ˆHigh fidelity readsï¼‰æ˜¯ <font color="red">Sequel II</font>ä¸‰ä»£æµ‹åºå¹³å°æ¨å‡ºçš„å…¼é¡¾é•¿è¯»é•¿å’Œé«˜å‡†ç¡®åº¦çš„æµ‹åºåºåˆ—ï¼Œä¸€èˆ¬é‡‡ç”¨CCSï¼ˆCircular Consensus Sequencingï¼‰æ¨¡å¼æµ‹åºã€‚</p><p>åœ¨å•æ¬¡æµ‹åºä¸­å¾—åˆ°æ›´å¤šçš„HiFi readså¾€å¾€éœ€è¦<strong>å¹³è¡¡</strong>æµ‹åºçš„ <font color="red">é…¶è¯»é•¿</font>å’Œ <font color="red">æ’å…¥ç‰‡æ®µçš„é•¿åº¦</font>ï¼Œæ’å…¥ç‰‡æ®µå¤ªé•¿ä¼šå¯¼è‡´é…¶æ— æ³•è¿›è¡Œæ»šç¯æµ‹åºï¼Œæ’å…¥ç‰‡æ®µå¤ªçŸ­åˆç‰ºç‰²äº†ä¸‰ä»£é•¿è¯»é•¿æµ‹åºçš„ä¼˜åŠ¿ã€‚</p><p>æ ¹æ®å‰æœŸçš„å®˜æ–¹ç»éªŒæ¨èï¼Œç›®å‰HiFiæ–‡åº“æ„å»ºçš„<font color="red">æ’å…¥ç‰‡æ®µä¸€èˆ¬ä¸º8-13 kb</font>å·¦å³ã€‚å®‰è¯ºä¼˜è¾¾æ„å»ºçº¦10 kbçš„HiFiæ–‡åº“åœ¨<font color="red">Sequel II</font>å¹³å°è¿›è¡Œæµ‹åºã€‚åŸå§‹ä¸‹æœºæ•°æ®å•celläº§å‡º268 Gbæ•°æ®ï¼Œå…¶ä¸­<font color="red">é…¶å¹³å‡è¯»é•¿51 kb</font>ï¼Œ<font color="red">é…¶è¯»é•¿N50 124 kb</font>ï¼Œ<font color="red">subreadså¹³å‡è¯»é•¿11 kb</font>ï¼Œ<font color="red">subreads N50 13 kb</font>ã€‚</p><ul><li>ä¸‹æœºæ•°æ®äº§å‡ºç»Ÿè®¡è¡¨</li></ul><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/15.png"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/15.png"></p><p>è¿›ä¸€æ­¥åˆ©ç”¨å®˜æ–¹è½¯ä»¶è°ƒå–CCSï¼Œè®¾ç½®æœ€å°passæ•°ä¸º3ï¼Œç»è¿‡è°ƒå–è·å¾—CCSæ€»æ•°æ®é‡ä¸º<strong>22.43 Gb</strong>ï¼ŒCCS åºåˆ—æ•°ç›®ä¸º<strong>172.5ä¸‡</strong>æ¡<strong>ï¼Œå¹³å‡é•¿åº¦</strong>13 kb<strong>ã€‚ä¸ä¸‹æœºæ€»æ•°æ®é‡ç›¸æ¯”ï¼Œ</strong>ç›®å‰CCS readsçš„å¾—ç‡çº¦ä¸º8%ï¼Œå¹¶ä¸”èƒ½å¤Ÿå…¼é¡¾readsçš„è¯»é•¿ï¼Œè¾¾åˆ°å¹³å‡13 kbå·¦å³ï¼Œæ•°æ®è´¨é‡ç›¸å½“ä¸é”™??</p><ul><li>CCSæ•°æ®äº§å‡ºç»Ÿè®¡è¡¨</li></ul><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/16.png"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/16.png"></p><p>å¯¹æ‹¿åˆ°çš„HiFi readsè¿›è¡Œè¿›ä¸€æ­¥çš„<font color="red">è´¨é‡è¯„ä¼°</font>ï¼Œæˆ‘ä»¬å‘ç°å¤§éƒ¨åˆ†HiFi readsçš„<font color="red">å‡†ç¡®åº¦?</font>éƒ½åœ¨0.95ä»¥ä¸Šï¼Œå…¶ä¸­çº¦35%çš„readsï¼ˆpassâ‰¥10ï¼‰è´¨é‡å€¼è¾¾åˆ°QV30ï¼ˆ99.9%ï¼‰ï¼Œè¿™æ ·é«˜è´¨é‡çš„readséå¸¸æœ‰åŠ©äºç ”ç©¶è€…å¼€å±•ä¸‹æ¸¸æ·±å…¥çš„ç ”ç©¶ã€‚</p><ul><li>CCSè´¨é‡åˆ†å¸ƒå›¾</li></ul><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/17.png"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/17.png"></p><p>åŒæ—¶å…¼é¡¾é•¿è¯»é•¿å’Œé«˜å‡†ç¡®åº¦çš„HiFi readsç©¶ç«Ÿæœ‰ä½•ç”¨å¤„å‘¢ï¼Ÿ2019å¹´<em>BioRxiv</em>é¢˜ä¸ºâ€œ<strong>Highly-accurate long-read sequencing improves variant detection and assembly of a human genome</strong>â€çš„æ–‡ç« ã€‚åœ¨è¿™ç¯‡æ–‡ç« é‡Œç ”ç©¶è€…åˆ©ç”¨çº¦30Xçš„CCS readsç»„è£…äººåŸºå› ç»„ï¼Œé€šè¿‡<font color="green">FALCONã€Canu3å’Œ wtdbg2</font>ç­‰ä¸åŒè½¯ä»¶è¿›è¡Œç»„è£…ï¼Œ<font color="red">contig N50è¾¾åˆ°15.43-28.95 Mb</font>ã€‚ä»ç»„è£…è¿ç»­æ€§æ¥çœ‹ï¼Œ<strong>CCS readsèƒ½å¤Ÿåšåˆ°ä¸<font color="red">ä¼ ç»Ÿçš„CLR reads</font>ç»„è£…ç›¸å½“çš„ç»“æœï¼Œé‡è¦çš„æ˜¯åŸºå› ç»„ç¢±åŸºå‡†ç¡®åº¦å¾—åˆ°äº†æ˜æ˜¾æå‡ï¼ŒåŸºå› ç»„ç»„è£…æ¶ˆè€—çš„è®¡ç®—èµ„æºå’Œæ—¶é—´å¤§å¹…ä¸‹é™</strong>ã€‚è¿›ä¸€æ­¥åˆ©ç”¨CCS readsè¿›è¡Œ<font color="red">SNPã€InDelç­‰å˜å¼‚æ£€æµ‹</font>ï¼Œå‘ç°CCS readsåœ¨å°çš„å˜å¼‚æ£€å‡ºç‡å’Œå‡†ç¡®åº¦ä¸Šéƒ½æœ‰æ˜¾è‘—æå‡ï¼Œæ•°æ®ç»“æœä¸30Xçš„Illuminaæ•°æ®åˆ†æç»“æœåŸºæœ¬æ¥è¿‘ã€‚</p><ul><li>æ–‡ç« ä¸­CCS readsè¿›è¡ŒSNVå’ŒInDel callingç»Ÿè®¡è¡¨</li></ul><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/31.png"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/31.png"></p><p>ç»¼ä¸Šï¼ŒHiFi readsæ— è®ºåœ¨<font color="red">åŸºå› ç»„å…¨å˜å¼‚æ£€æµ‹ï¼ˆSNVã€InDelã€SVï¼‰</font>è¿˜æ˜¯<font color="red">åŸºå› ç»„<em>de novo</em></font>é¢†åŸŸéƒ½é€‚ç”¨ã€‚ç›®å‰<font color="red">å”¯ä¸€çš„é™åˆ¶å› ç´ </font>æ˜¯è¦è·å¾—è¶³å¤Ÿçš„HiFi readsï¼Œæµ‹åºæˆæœ¬æŠ•å…¥æ¯”è¾ƒ<font color="red">æ˜‚è´µ</font>ï¼Œä»ç»„è£…<strong>è®¡ç®—èµ„æºèŠ‚çœ</strong>å’Œ<strong>é¡¹ç›®æ—¶é—´ç¼©çŸ­</strong>çš„è§’åº¦çœ‹ï¼ŒHiFi readsæœªå°ä¸æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚<strong>å¯¹äºåŸºå› ç»„<font color="red">é‡å¤åºåˆ—è¾ƒå¤šçš„å¤æ‚åŸºå› ç»„</font>ï¼Œç›®å‰å¸‚åœºä¸Š<font color="red">ä¼ ç»Ÿé•¿è¯»é•¿æµ‹åºå‡†ç¡®åº¦ä¸é«˜</font>çš„ç‰¹ç‚¹ç»™ç»„è£…é€ æˆäº†ä¸€å®šçš„å›°éš¾ï¼Œé«˜å‡†ç¡®åº¦çš„HiFi readsæœªæ¥å¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚</strong>è€Œå¯¹äºæ˜†è™«ã€ä¸­è‰è¯ã€è—»ç±»ç­‰é‡å¤åºåˆ—è¾ƒé«˜ã€åŸºå› ç»„è¾ƒå°çš„ç‰©ç§ï¼ˆï¼œ700 Mbï¼‰ï¼Œç›®å‰åˆ©ç”¨ä¸€ä¸ª8 M SMRT Cell äº§å‡ºçš„æ•°æ®é‡åŸºæœ¬è¶³ä»¥æ”¯æŒCCSç»„è£…ï¼Œæ€§ä»·æ¯”æ›´é«˜ã€‚éœ€è¦å®Œå–„çš„HiFiæ–‡åº“å»ºåº“æµç¨‹å’ŒåŸºäºCCS readsç»„è£…çš„ç”Ÿä¿¡æµç¨‹ï¼</p><h2 id="2-Continuous-Long-Read-CLR-Sequencing"><a href="#2-Continuous-Long-Read-CLR-Sequencing" class="headerlink" title="2. Continuous Long Read (CLR) Sequencing"></a>2. Continuous Long Read (CLR) Sequencing</h2><p>è¿™ç§æµ‹åºçš„ä¼˜åŠ¿åœ¨äºå¯ä»¥è¯»å–æ›´é•¿çš„ Readsã€‚<font color="red">ï¼Ÿä¸ºä»€ä¹ˆæ›´é•¿</font></p><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/19.gif" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/19.gif" alt="img"></p><h1 id="å…¶ä»–å½±å“å› ç´ "><a href="#å…¶ä»–å½±å“å› ç´ " class="headerlink" title="å…¶ä»–å½±å“å› ç´ "></a>å…¶ä»–å½±å“å› ç´ </h1><h2 id="1-GC-bias-å½±å“"><a href="#1-GC-bias-å½±å“" class="headerlink" title="1. GC bias å½±å“"></a>1. <font color="red">GC bias å½±å“</font></h2><blockquote><p>ä»€ä¹ˆæ˜¯ GC biasï¼Ÿ<br>PCR æ—¶ï¼Œå¦‚æœæ¨¡æ¿é‡Œçš„<font color="red">Gã€Cç¢±åŸºå«é‡é«˜ï¼ŒPCRæ•ˆç‡ä½</font>ï¼ŒAã€Tç¢±åŸºå«é‡é«˜ï¼ŒPCRæ•ˆç‡é«˜ã€‚ä¸€èˆ¬æµ‹åºè¿‡ç¨‹ï¼Œå¦‚äºŒä»£æµ‹åºï¼Œéƒ½ä¼šæœ‰å¤§é‡çš„PCRè¿‡ç¨‹ã€‚è¿™æ ·å°±ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œ<font color="red">Gã€Cå«é‡é«˜çš„ç‰‡æ®µï¼Œè¯»åˆ°çš„ Reads æ•°å°‘</font>ã€‚</p></blockquote><p>SMRT æ²¡æœ‰ PCR ï¼Œå› æ­¤GCå«é‡é«˜ä½çš„ Reads ç‰‡æ®µéƒ½ä¼šæœ‰ç›¸ä¼¼çš„æ¦‚ç‡è¢«æµ‹åºï¼Œ GC Bias å½±å“å°ã€‚</p><h2 id="2-è¯»é•¿çš„é™åˆ¶å› ç´ "><a href="#2-è¯»é•¿çš„é™åˆ¶å› ç´ " class="headerlink" title="2. è¯»é•¿çš„é™åˆ¶å› ç´ "></a>2. è¯»é•¿çš„é™åˆ¶å› ç´ </h2><ul><li><strong>DNAæ¨¡æ¿æ–­è£‚</strong>ï¼Œç”¨æ¿€å‘å…‰é•¿æ—¶é—´ç…§å°„DNAé“¾æ—¶ï¼Œä¼šå‘ç”Ÿæ–­è£‚ï¼ŒDNAé“¾ä¼šä»é…¶ä¸Šæ‰ä¸‹æ¥ï¼Œæµ‹åºç»ˆæ­¢ã€‚</li><li><strong>é…¶å˜æ€§</strong>ï¼Œé…¶è¢«é•¿æ—¶é—´ç…§å°„æ—¶ï¼Œé…¶ä¼šå˜æ€§ï¼Œå¤±å»èšåˆé…¶æ´»æ€§ï¼Œæµ‹åºç»ˆæ­¢ã€‚</li><li><strong>æ–‡åº“åºåˆ—çŸ­</strong>ï¼Œå¦‚æœåšæ–‡åº“åºåˆ—ç‰‡æ®µå¤§äº 20~30 K ï¼Œä¸”ä¿è¯è´¨é‡çš„æ–‡åº“æ˜¯æœ‰æŠ€æœ¯éš¾åº¦çš„</li></ul><h2 id="3-æµ‹åºé€šé‡"><a href="#3-æµ‹åºé€šé‡" class="headerlink" title="3. æµ‹åºé€šé‡"></a>3. æµ‹åºé€šé‡</h2><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/20.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/20.png" alt="img"></p><p>ç›®å‰ï¼Œä¸»æµçš„æµ‹åºå¹³å°æœ‰ä¸‰ç§ï¼Œå„æœ‰åˆ©å¼Šï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„è¯¾é¢˜æ¥é€‰æ‹©ã€‚</p><p>ä»¥RSIIä¸ºä¾‹ï¼Œå°†æµ‹åºå¤åˆç‰©ï¼Œéšæœºæ’’åˆ°15ä¸‡ä¸ªå°å­”ä¸­ï¼Œæ­£å¥½æœ‰ä¸€ä¸ª<font color="red">å¤åˆç‰©è¿›å…¥åˆ°å•ä¸ªå°å­”çš„æ¦‚ç‡ç¬¦åˆæ³Šæ¾åˆ†å¸ƒ</font>ã€‚ç†è®ºæƒ…å†µæ˜¯</p><ul><li>1&#x2F;3 çš„å°å­”ä¸­æœ‰<font color="red">ä¸€ä¸ª</font>æµ‹åºå¤åˆç‰©ï¼Œæ­£å¸¸ä¿¡å·</li><li>1&#x2F;3 çš„å°å­”ä»€ä¹ˆéƒ½<font color="red">æ²¡æœ‰</font>ï¼Œæ— ä¿¡å·</li><li>1&#x2F;3 çš„å°å­”ä¸­æœ‰<font color="red">ä¸¤ä¸ªä»¥ä¸Šçš„æµ‹åºå¤åˆç‰©</font>ï¼Œæ‚ä¹±ä¿¡å·</li></ul><p>äº”ä¸‡ä¸ªå°å­” * 10kbï¼Œæ‰€ä»¥ä¸€å¼ èŠ¯ç‰‡å¤§çº¦ä¼šäº§å‡º500Mçš„æ•°æ®ã€‚</p><hr><h1 id="ä¸‰ä»£ä¸‹æœºæ•°æ®ï¼ˆä»¥sequel-å¹³å°ä¸ºä¸»ï¼‰"><a href="#ä¸‰ä»£ä¸‹æœºæ•°æ®ï¼ˆä»¥sequel-å¹³å°ä¸ºä¸»ï¼‰" class="headerlink" title="ä¸‰ä»£ä¸‹æœºæ•°æ®ï¼ˆä»¥sequel å¹³å°ä¸ºä¸»ï¼‰"></a>ä¸‰ä»£ä¸‹æœºæ•°æ®ï¼ˆä»¥sequel å¹³å°ä¸ºä¸»ï¼‰</h1><h2 id="æµ‹åºè¿‡ç¨‹"><a href="#æµ‹åºè¿‡ç¨‹" class="headerlink" title="æµ‹åºè¿‡ç¨‹"></a>æµ‹åºè¿‡ç¨‹</h2><ul><li><font color="green">A adapter</font>é€šç”¨æ¥å¤´ï¼Œä¸¤ç«¯çš„æ¥å¤´å¯ä»¥ä¸€æ ·ä¹Ÿå¯ä»¥ä¸ä¸€æ ·</li><li><font color="green">B barcode</font>(å®¢æˆ·è‡ªå·±è®¾è®¡)</li><li><font color="green">I insert </font>æ’å…¥ç‰‡æ®µï¼Œå³æˆ‘ä»¬æµ‹åºçš„ç›®çš„ç‰‡æ®µ</li><li>ç”±äºSMRTbellæ˜¯ç¯çŠ¶çš„ï¼Œæµ‹åºè¿‡ç¨‹æ˜¯è¾¹åˆæˆè¾¹æµ‹åºï¼Œå› æ­¤å¯ä»¥æ²¿ç€æ–°é“¾åˆæˆçš„æ–¹å‘ä¸åœåœ°è¯»å–åºåˆ—ï¼Œè¯»å–ä¸€åœˆåˆä¸€åœˆ</li></ul><h2 id="æµ‹åºç»“æœ"><a href="#æµ‹åºç»“æœ" class="headerlink" title="æµ‹åºç»“æœ"></a>æµ‹åºç»“æœ</h2><ul><li>æ ¹æ®SMRTbellçš„å½¢çŠ¶ä»¥åŠæµ‹åºçš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬å®¹æ˜“çŸ¥é“ï¼Œæµ‹åºå‡ºæ¥çš„readså¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç”±æ¥å¤´åºåˆ—, æ¡ç åºåˆ—, æ’å…¥åºåˆ—é—´éš”çº¿æ€§åˆ†å¸ƒï¼Œå³ABIB-ABIBâ€”ABIB-ABIBâ€”â€¦ï¼ˆA: adapter, B: barcode, I: insertï¼‰</li><li><font color="green">ZMW read</font> æ˜¯æµ‹åºå‡ºæ¥çš„å®Œæ•´ç»“æœï¼Œä¹Ÿå³æ˜¯<font color="green">polymerase read</font>ï¼Œèšåˆé…¶åˆæˆè¿‡çš„æ‰€æœ‰çš„åºåˆ—ã€‚</li><li>PostPrimary åˆ†æåè¾“å‡º<font color="green">HQ region</font>ï¼Œç”±ZMW read <font color="green">å»é™¤ä¸¤ç«¯ä½è´¨é‡</font>åŒºåŸŸå¾—åˆ°ã€‚</li></ul><h2 id="æµ‹åºæ–‡ä»¶"><a href="#æµ‹åºæ–‡ä»¶" class="headerlink" title="æµ‹åºæ–‡ä»¶"></a>æµ‹åºæ–‡ä»¶</h2><ul><li><p>RS IIï¼š<a href="https://www.itdaan.com/blog/2017/05/26/6e59c682169d236cb41a2b6ba146125e.html">https://www.itdaan.com/blog/2017/05/26/6e59c682169d236cb41a2b6ba146125e.html</a></p></li><li><p>Sequel</p><ul><li>åœ¨ä¸‹æœºæ–‡ä»¶ä¸­ï¼Œä¸»è¦æœ‰ä¸‰ç±»æ–‡ä»¶ï¼Œ<font color="red">bam æ–‡ä»¶</font>ï¼Œ<font color="red">bam.pbi æ–‡ä»¶</font>ï¼Œä»¥åŠ<font color="red">xmlæ–‡ä»¶</font>ã€‚</li><li>æ— fastqæ–‡ä»¶ï¼Œsequelå¹³å°ä¸­bam æ–‡ä»¶æˆä¸ºäº†fqçš„æ›¿ä»£è€…ï¼Œæ›´èŠ‚çº¦å‚¨å­˜ç©ºé—´ã€‚è¿™æ˜¯æ–‡ä»¶æ ¼å¼çš„ä¸€ä¸ªé‡å¤§æ›´æ–°ã€‚</li><li>ç”¨äºåç»­åˆ†æçš„æ–‡ä»¶ä¸€èˆ¬æ˜¯<font color="red">.subreads.bam</font>ï¼Œè¿™ç­‰åŒäº<font color="red">RS II </font>ä¸­çš„<font color="red">.subreads.fastq</font></li><li>ä¸‹é¢ä»‹ç»ä¸‰ç±»ä¸»è¦æ–‡ä»¶çš„å…·ä½“æ ¼å¼</li></ul></li></ul><h3 id="BAM"><a href="#BAM" class="headerlink" title="BAM"></a>BAM</h3><ul><li><p><font color="green">æ™®é€šbam</font>æ–‡ä»¶å¤§å¤šæ˜¯<font color="green">æ¯”å¯¹ç»“æœæ–‡ä»¶</font>ï¼Œä¾‹å¦‚ç”¨é‡æµ‹åºåˆ†æä¸­BWAç”Ÿæˆçš„bamæ–‡ä»¶å°±æ˜¯readsä¸åŸºå› ç»„çš„æ¯”å¯¹æ–‡ä»¶ã€‚ä½†<font color="red">pacbioçš„ä¸‹æœºæ–‡ä»¶æ˜¯æ²¡æœ‰ä¸åŸºå› ç»„è¿›è¡Œè¿‡æ¯”å¯¹è¿‡</font>çš„ï¼Œå…¶ä¸»è¦ä½œç”¨æ˜¯<font color="red">å‚¨å­˜åºåˆ—</font>ã€‚</p></li><li><p>Bamæ–‡ä»¶ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œå¤´ä¸€éƒ¨åˆ†æ˜¯<font color="red">Header</font>ï¼Œå‚¨å­˜æµ‹åºçš„ç›¸å…³ä¿¡æ¯ï¼Œå¦ä¸€éƒ¨åˆ†ä¹Ÿå³æ˜¯æ–‡ä»¶çš„ä¸»è¦éƒ¨åˆ†æ˜¯recordsï¼Œä¿å­˜<font color="red">åºåˆ—ä¿¡æ¯</font>ã€‚å°±ä»¥subreads.bamæ–‡ä»¶ä¸ºä¾‹ï¼Œåˆ†æä¸‹bamæ–‡ä»¶çš„å…·ä½“æ ¼å¼ã€‚</p></li><li><p>å¯ä»¥ç”¨samtools view å‘½ä»¤æŸ¥çœ‹bamæ–‡ä»¶</p><blockquote><p>ç¬¬ä¸€åˆ—ï¼šreadsä¿¡æ¯</p><p>{movieName}&#x2F;{holeNumber}&#x2F;{qStart}_{qEnd}<br>[å¯¹äºCCSï¼š{movieName}&#x2F;{holeNumber}&#x2F;ccs]<br>MovieName æ˜¯cellçš„åå­—ï¼ŒholeNumeræ˜¯ZMWå­”çš„ç¼–å·ï¼ŒqStartå’ŒqEndæ˜¯subreadsç›¸å¯¹äºZMW readsçš„ä½ç½®ã€‚<br>ç¬¬äºŒåˆ— (sum of flags)ï¼šæ¯”å¯¹ä¿¡æ¯ å‡ä¸º4 ä»£è¡¨æ²¡æœ‰æ¯”å¯¹ä¸Šï¼Œä¹Ÿè¡¨æ˜äº†bamæ–‡ä»¶åªå‚¨å­˜äº†åºåˆ—ä¿¡æ¯ï¼Œè€Œæ²¡æœ‰æ¯”å¯¹ä¿¡æ¯ã€‚<br>ç¬¬ä¸‰åˆ— (RNAM)ï¼šå‚è€ƒåºåˆ— å€¼ä¸º ï¼Œä»£è¡¨æ— å‚è€ƒåºåˆ—<br>ç¬¬å››åˆ— (position) : æ¯”å¯¹ä¸Šçš„ç¬¬ä¸€ä¸ªç¢±åŸºä½ç½® 0<br>ç¬¬äº”åˆ— (Mapping quality) : æ¯”å¯¹è´¨é‡åˆ†æ•° 255<br>ç¬¬å…­åˆ— (CIGARå€¼) : æ¯”å¯¹çš„å…·ä½“æƒ…å†µ<br>ç¬¬ä¸ƒåˆ— (MRNM, ) : mate å¯¹åº”çš„æŸ“è‰²ä½“<br>ç¬¬å…«åˆ— (mate position) : mateå¯¹åº”çš„ä½ç½® 0<br>ç¬¬ä¹åˆ— (ISIZE, Inferred fragment size) : æ¨æ–­çš„æ’å…¥ç‰‡æ®µå¤§å° 0</p><p>ç¬¬ååˆ— (Sequence) : åºåˆ—ä¿¡æ¯ å…·ä½“çš„ATCG<br>ç¬¬åä¸€åˆ— (ASCIIç ) : ç¢±åŸºè´¨é‡åˆ†æ•° ASCII+33<br>ç¬¬åäºŒåˆ—: å¯é€‰åŒºåŸŸ è®°å½•Reads çš„æ€»ä½“å±æ€§åŒ…æ‹¬ä¿¡å·é•¿åº¦ï¼Œä¿¡å·å¼ºåº¦ç­‰ä¿¡æ¯ã€‚</p></blockquote></li></ul><ol><li>zmws.bam ä»¥åŠccs.bamä¼¼ä¹å…¬å¸å¹¶ä¸ä¸€å®šä¼šæä¾›</li><li>ç»è¿‡æ£€æŸ¥ï¼Œä¸€æ¡zmw reads å¯ä»¥äº§ç”Ÿå¤šæ¡ subreadsï¼Œä¹Ÿå°±æ˜¯è¯´subreads.bam ä¸­ï¼Œåºåˆ—åªæ˜¯è¢«å‰ªä¸‹æ¥äº†ã€‚</li><li>scraps.bam æ ¼å¼ä¿å­˜çš„æ˜¯è·å–subreadsæ—¶åºŸå¼ƒçš„åºåˆ—ï¼ŒåŒ…æ‹¬adapterï¼Œä»¥åŠä¸€äº›ä½è´¨é‡çš„åºåˆ—</li><li><strong>CCS.bamä¿å­˜çš„æ˜¯çŸ«æ­£åçš„ä¸€è‡´æ€§åºåˆ—</strong>ã€‚</li></ol><h3 id="BAM-pbi"><a href="#BAM-pbi" class="headerlink" title="BAM.pbi"></a>BAM.pbi</h3><ul><li><p>æ˜¯bamæ–‡ä»¶çš„<font color="red">ç´¢å¼•æ–‡ä»¶</font>(PacBio BAM index)ï¼Œä¸ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼ˆ<font color="red">RS II</font>ï¼‰çš„<font color="red">*cmp.h5</font>æ–‡ä»¶<font color="red">å…¼å®¹</font>ï¼Œå…¶æ ¼å¼ç±»ä¼¼äº<font color="red">HDF5</font>ï¼Œ é€šè¿‡<font color="red"><strong>BGZFæ ¼å¼å‹ç¼©</strong></font>ã€‚</p></li><li><p>å…¶å­˜åœ¨ä¸»è¦æœ‰ä¸¤ä¸ªä½œç”¨</p></li><li><h5 id="éšæœºè®¿é—®"><a href="#éšæœºè®¿é—®" class="headerlink" title="éšæœºè®¿é—®"></a><font color="red">éšæœº</font>è®¿é—®</h5><p>é€šè¿‡å‚è€ƒåºåˆ—ï¼ŒåŸºå› ç»„åŒºåŸŸï¼›é€šè¿‡read ç»„åˆ«ï¼›é€šè¿‡qurey nameï¼›é€šè¿‡ZMWï¼›é€šè¿‡barcodeï¼›å…¶ä»–</p></li><li><h5 id="åœ¨æ— éœ€å®Œå…¨è®¿é—®BAMæ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œè·å–ä¿¡æ¯"><a href="#åœ¨æ— éœ€å®Œå…¨è®¿é—®BAMæ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œè·å–ä¿¡æ¯" class="headerlink" title="åœ¨æ— éœ€å®Œå…¨è®¿é—®BAMæ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œè·å–ä¿¡æ¯"></a>åœ¨æ— éœ€å®Œå…¨è®¿é—®BAMæ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œè·å–ä¿¡æ¯</h5></li></ul><p>   è·å–<font color="red">ç»Ÿè®¡ä¿¡æ¯</font>ï¼›é€šè¿‡æä¾›indexè®¿é—®è®°å½•ä¿¡æ¯</p><h3 id="xml"><a href="#xml" class="headerlink" title="xml"></a>xml</h3><ul><li>MetaData, å‚¨å­˜æ•°æ®æè¿°ã€‚å¯ç”¨äº<strong>filter</strong> æˆ–è€…<strong>subset</strong>ç­‰åŠŸèƒ½ã€‚</li><li>sts.xml å‚¨å­˜æ•°æ®çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</li><li>SMRT Link CL tools in 5.0.0 datasetå‘½ä»¤å¯ä»¥è¿›è¡Œæ–¹ä¾¿çš„æ“ä½œã€‚</li></ul><hr><h1 id="Pacbio-Sequel-ä¸‹æœºæ•°æ®å®ä¾‹"><a href="#Pacbio-Sequel-ä¸‹æœºæ•°æ®å®ä¾‹" class="headerlink" title="Pacbio Sequel ä¸‹æœºæ•°æ®å®ä¾‹"></a>Pacbio Sequel ä¸‹æœºæ•°æ®å®ä¾‹</h1><blockquote><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&gt;m54134_180724_220656<span class="hljs-selector-class">.scraps</span><span class="hljs-selector-class">.bam</span><br>&gt;m54134_180724_220656<span class="hljs-selector-class">.subreads</span><span class="hljs-selector-class">.bam</span><br>&gt;m54134_180724_220656<span class="hljs-selector-class">.scraps</span><span class="hljs-selector-class">.bam</span><span class="hljs-selector-class">.pbi</span><br>&gt;m54134_180724_220656<span class="hljs-selector-class">.subreads</span><span class="hljs-selector-class">.bam</span><span class="hljs-selector-class">.pbi</span><br>&gt;m54134_180724_220656<span class="hljs-selector-class">.baz2bam_1</span><span class="hljs-selector-class">.log</span><br>&gt;m54134_180724_220656<span class="hljs-selector-class">.sts</span><span class="hljs-selector-class">.xml</span><br>&gt;m54134_180724_220656<span class="hljs-selector-class">.subreadset</span><span class="hljs-selector-class">.xml</span><br>&gt;m54134_180724_220656<span class="hljs-selector-class">.transferdone</span><br>&gt;m54134_180724_220656<span class="hljs-selector-class">.adapters</span>.fasta<br></code></pre></td></tr></table></figure></blockquote><p>m54134_180724_220656.subreads.bam</p><p><font color="red">m: æ˜¯movie çš„ç¼©å†™</font></p><p><font color="red">54134ï¼š æ˜¯è®¾å¤‡çš„ç¼–å·</font></p><p><font color="red">180724_220656ï¼š æ˜¯æµ‹åºè¿è¡Œçš„å¼€å§‹æ—¶é—´ï¼Œä¸º2018å¹´07æœˆ24æ—¥22æ—¶06åˆ†56ç§’</font></p><p><font color="red">subreads: è¿™éƒ¨åˆ†æ˜¯ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œä¸€èˆ¬æœ‰scrapsï¼Œ subreadsç­‰</font></p><p><font color="red">bam: è¿™æ˜¯æ•°æ®çš„æ ¼å¼ï¼Œä¸€èˆ¬æœ‰bamæ ¼å¼ï¼Œxmlï¼Œfastaæ ¼å¼ç­‰</font></p><p>BAMæ–‡ä»¶å®˜ç½‘ï¼š<a href="https://pacbiofileformats.readthedocs.io/en/3.0/BAM.html">https://pacbiofileformats.readthedocs.io/en/3.0/BAM.html</a></p><p><a href="https://github.com/PacificBiosciences/PacBioFileFormats/blob/3.0/BAM.rst">https://github.com/PacificBiosciences/PacBioFileFormats/blob/3.0/BAM.rst</a></p><h1 id="CLR-HiFi-é€‰æ‹©"><a href="#CLR-HiFi-é€‰æ‹©" class="headerlink" title="CLR HiFi é€‰æ‹©"></a>CLR HiFi é€‰æ‹©</h1><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/29.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/29.png" alt="img"></p><p><img src="/GeekFocus/2022-02-20-HiFi-2-SMRT/30.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-2-SMRT/30.png" alt="img"></p>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HiFi-1-three-generation-sequencing-techniqie</title>
    <link href="/GeekFocus/2022/02/20/2022-02-20-HiFi-1/"/>
    <url>/GeekFocus/2022/02/20/2022-02-20-HiFi-1/</url>
    
    <content type="html"><![CDATA[<h1 id="ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯æŒ‡å•åˆ†å­æµ‹åºæŠ€æœ¯ã€‚ä¸éœ€è¦PCRæ‰©å¢ï¼Œå®ç°å¯¹æ¯ä¸€æ¡DNAåˆ†å­å•ç‹¬æµ‹åºã€‚ä¹Ÿå«ä»å¤´æµ‹åºæŠ€æœ¯ï¼Œå³å•åˆ†å­å®æ—¶DNAæµ‹åºã€‚"><a href="#ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯æŒ‡å•åˆ†å­æµ‹åºæŠ€æœ¯ã€‚ä¸éœ€è¦PCRæ‰©å¢ï¼Œå®ç°å¯¹æ¯ä¸€æ¡DNAåˆ†å­å•ç‹¬æµ‹åºã€‚ä¹Ÿå«ä»å¤´æµ‹åºæŠ€æœ¯ï¼Œå³å•åˆ†å­å®æ—¶DNAæµ‹åºã€‚" class="headerlink" title="ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯æŒ‡å•åˆ†å­æµ‹åºæŠ€æœ¯ã€‚ä¸éœ€è¦PCRæ‰©å¢ï¼Œå®ç°å¯¹æ¯ä¸€æ¡DNAåˆ†å­å•ç‹¬æµ‹åºã€‚ä¹Ÿå«ä»å¤´æµ‹åºæŠ€æœ¯ï¼Œå³å•åˆ†å­å®æ—¶DNAæµ‹åºã€‚"></a>ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯æŒ‡å•åˆ†å­æµ‹åºæŠ€æœ¯ã€‚ä¸éœ€è¦PCRæ‰©å¢ï¼Œå®ç°å¯¹æ¯ä¸€æ¡DNAåˆ†å­å•ç‹¬æµ‹åºã€‚ä¹Ÿå«ä»å¤´æµ‹åºæŠ€æœ¯ï¼Œå³å•åˆ†å­å®æ—¶DNAæµ‹åºã€‚</h1><span id="more"></span><h1 id="æŠ€æœ¯åŸç†"><a href="#æŠ€æœ¯åŸç†" class="headerlink" title="æŠ€æœ¯åŸç†"></a>æŠ€æœ¯åŸç†</h1><h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p><font color="green">å•åˆ†å­è§å…‰æµ‹åº</font>ï¼Œä»£è¡¨æ€§æŠ€æœ¯ä¸º<font color="green">ç¾å›½èºæ—‹ç”Ÿç‰©(Helicos)</font>çš„<font color="green">SMSæŠ€æœ¯</font>å’Œ<font color="green">ç¾å›½å¤ªå¹³æ´‹ç”Ÿç‰©(Pacific Bioscience)</font>çš„<font color="green">SMRTæŠ€æœ¯</font>ã€‚è„±æ°§æ ¸è‹·é…¸è§å…‰æ ‡è®°ï¼Œæ˜¾å¾®é•œå®æ—¶è®°å½•è§å…‰å¼ºåº¦å˜åŒ–ã€‚å½“è§å…‰æ ‡è®°è„±æ°§æ ¸è‹·é…¸è¢«æºå…¥DNAé“¾æ—¶ï¼Œè§å…‰åŒæ—¶åœ¨DNAé“¾ä¸Šæµ‹åˆ°ã€‚å½“å®ƒä¸DNAé“¾å½¢æˆåŒ–å­¦é”®æ—¶ï¼Œè§å…‰åŸºå›¢è¢«DNAèšåˆé…¶åˆ‡é™¤ï¼Œè§å…‰æ¶ˆå¤±ã€‚è§å…‰æ ‡è®°è„±æ°§æ ¸è‹·é…¸ä¸å½±å“DNAèšåˆé…¶æ´»æ€§ï¼Œè§å…‰åŸºå›¢åˆ‡é™¤åï¼Œåˆæˆçš„DNAé“¾å’Œå¤©ç„¶DNAé“¾å®Œå…¨ä¸€æ ·ã€‚</p><p>PacBioé‡‡ç”¨<font color="green">è¾¹åˆæˆè¾¹æµ‹åº</font>æ–¹å¼ï¼Œä»¥å…¶ä¸­ä¸€æ¡DNAé“¾ä¸ºæ¨¡æ¿ï¼Œé€šè¿‡DNAèšåˆé…¶åˆæˆå¦å¤–ä¸€æ¡é“¾ï¼Œè¿›ä¸€æ­¥å°†è§å…‰ä¿¡å·è½¬å˜ä¸ºç¢±åŸºä¿¡å·ã€‚åŒæ—¶PacBioå·²å‡çº§<font color="green">CCSæµ‹åºæ¨¡å¼</font>ä»¥è·å¾—<font color="green">é•¿è¯»é•¿é«˜ä¿çœŸï¼ˆHiFiï¼‰15 kb reads</font>ï¼Œç”±æ­¤æå‡åŸºå› ç»„ç»„è£…å‡†ç¡®æ€§ã€‚</p><h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p><font color="green">çº³ç±³å­”æµ‹åº</font>ï¼Œ<font color="green">è‹±å›½ç‰›æ´¥çº³ç±³å­”å…¬å¸</font>ã€‚æ–°å‹çº³ç±³å­”æµ‹åºæ³•ï¼ˆnanopore sequencingï¼‰æ˜¯é‡‡ç”¨ç”µæ³³æŠ€æœ¯ï¼Œå€ŸåŠ©<font color="green">ç”µæ³³é©±åŠ¨å•ä¸ªåˆ†å­é€ä¸€é€šè¿‡çº³ç±³å­”</font>å®ç°æµ‹åºã€‚çº³ç±³å­”ç›´å¾„éå¸¸ç»†å°ï¼Œä»…å…è®¸å•ä¸ªæ ¸é…¸èšåˆç‰©é€šè¿‡ï¼Œè€ŒATCG<font color="green">å•ä¸ªç¢±åŸºå¸¦ç”µæ€§è´¨</font>ä¸ä¸€æ ·ï¼Œé€šè¿‡<font color="green">ç”µä¿¡å·å·®å¼‚</font>æ£€æµ‹å‡ºé€šè¿‡ç¢±åŸºç±»åˆ«ï¼Œå®ç°æµ‹åºã€‚</p><p>Nanoporeå½“å•é“¾DNAåˆ†å­ç©¿è¿‡çº³ç±³å­”ï¼Œç›¸å¯¹äºæ¯ä¸ªæ ¸è‹·é…¸ï¼Œè·å¾—ä¸åŒç”µæµä¿¡å·ã€‚è®°å½•æ¯ä¸ªå­”çš„ç¦»å­ç”µæµå˜åŒ–ï¼Œå¹¶åŸºäº<font color="red">é©¬å°”å¯å¤«æ¨¡å‹</font>æˆ–<font color="red">é€’å½’ç¥ç»ç½‘ç»œ</font>çš„æ–¹æ³•å°†å…¶è½¬æ¢ä¸ºç¢±åŸºåºåˆ—ã€‚æ­¤å¤–ï¼Œ<font color="green">Ultra-long reads (ULRs) </font>æ˜¯ONTå¹³å°çš„å¦ä¸€é‡è¦ç‰¹å¾ï¼Œå¹¶å…·æœ‰ä¿ƒè¿›<font color="green">å¤§å‹åŸºå› ç»„ç»„è£…</font>æ½œåŠ›ã€‚</p><table><thead><tr><th>De novoç ”ç©¶</th><th>ç ”ç©¶å†…å®¹</th><th></th></tr></thead><tbody><tr><td>åŸºå› ç»„ç»„è£…</td><td>å¤šè½¯ä»¶ç»„è£…ã€ç»„è£…ç»“æœè¯„ä¼°</td><td></td></tr><tr><td>åŸºå› é¢„æµ‹ä¸æ³¨é‡Š</td><td>ç¼–ç åŸºå› é¢„æµ‹ï¼›é‡å¤åºåˆ—æ³¨é‡Šå’Œè½¬åº§å…ƒä»¶åˆ†ç±»ï¼›éç¼–ç RNAæ³¨é‡Šï¼›å‡åŸºå› æ³¨é‡Šç­‰</td><td></td></tr><tr><td>Hi-Cè¾…åŠ©åŸºå› ç»„ç»„è£…</td><td>æœ‰æ•ˆæ•°æ®è¯„ä¼°ï¼›Contigèšç±»ã€æ’åºåŠå®šå‘åˆ†æï¼›æŒ‚è½½ç»“æœè¯„ä¼°</td><td></td></tr><tr><td>ç”Ÿç‰©å­¦é—®é¢˜è§£æ</td><td>æ¯”è¾ƒåŸºå› ç»„å­¦ç ”ç©¶</td><td>åŸºå› å®¶æ—èšç±»ï¼›</td></tr><tr><td></td><td></td><td>ç³»ç»Ÿå‘è‚²æ ‘çš„æ„å»ºï¼›</td></tr><tr><td></td><td></td><td>åŸºå› å®¶æ—æ‰©å¼ ä¸æ”¶ç¼©åˆ†æï¼›</td></tr><tr><td></td><td></td><td>ç‰©ç§åˆ†åŒ–æ—¶é—´æ¨ç®—ï¼›</td></tr><tr><td></td><td></td><td>LTRå½¢æˆæ—¶é—´ä¼°ç®—ï¼›</td></tr><tr><td></td><td></td><td>å…¨åŸºå› ç»„å¤åˆ¶äº‹ä»¶ï¼›</td></tr><tr><td></td><td></td><td>é€‰æ‹©å‹åŠ›åˆ†æ</td></tr><tr><td></td><td>ç‰¹å®šç”Ÿç‰©å­¦é—®é¢˜å‰–æ</td><td>ç»“åˆç»„å­¦ç ”ç©¶æ–¹æ³•ï¼Œæ·±å…¥å¯¹æŸç‰©ç§ç”Ÿç‰©å­¦é—®é¢˜è¿›è¡Œè§£æ</td></tr></tbody></table><p><img src="/GeekFocus/2022-02-20-HiFi-1/13.png"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/13.png"></p><p>è‰è“åŸºå› å®¶æ—èšç±»åˆ†æ</p><p><img src="/GeekFocus/2022-02-20-HiFi-1/14.png"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/14.png"></p><p>è–è‹¡å…¨åŸºå› ç»„å¤åˆ¶äº‹ä»¶åˆ†æ</p><p><img src="/GeekFocus/2022-02-20-HiFi-1/15.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/15.png" alt="img"></p><p>å¼€å¿ƒæœç³»ç»Ÿè¿›åŒ–æ ‘ä¸åŸºå› å®¶æ—æ”¶ç¼©æ‰©å¼ åˆ†æ</p><p><img src="/GeekFocus/2022-02-20-HiFi-1/16.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/16.png" alt="img"></p><p>é™†åœ°æ£‰äºšåŸºå› ç»„å…±çº¿æ€§åˆ†æ</p><h1 id="å…³é”®ç‚¹"><a href="#å…³é”®ç‚¹" class="headerlink" title="å…³é”®ç‚¹"></a>å…³é”®ç‚¹</h1><p>ç¬¬ä¸€ï¼š<font color="green">æ˜¾å¾®é•œ</font>å®æ—¶è®°å½•DNAé“¾è§å…‰æ—¶ï¼Œ<font color="green">DNAé“¾å‘¨å›´ä¼—å¤šè§å…‰æ ‡è®°è„±æ°§æ ¸è‹·é…¸</font>å½¢æˆéå¸¸å¼ºå¤§çš„<font color="green">è§å…‰èƒŒæ™¯</font>ã€‚å¼ºå¤§è§å…‰èƒŒæ™¯é˜»ç¢å•åˆ†å­è§å…‰æ¢æµ‹ã€‚Pacific Bioscienceså…¬å¸å‘æ˜äº†ä¸€ç§<font color="green">ç›´å¾„åªæœ‰å‡ åçº³ç±³çš„çº³ç±³å­”</font>[zero-mode waveguides (ZMWs)]ï¼Œå•åˆ†å­çš„<font color="green">DNAèšåˆé…¶</font>è¢«å›ºå®šåœ¨å­”å†…ã€‚åœ¨å°å­”å†…ï¼ŒDNAé“¾<font color="green">å‘¨å›´è§å…‰æ ‡è®°</font>çš„è„±æ°§æ ¸è‹·é…¸<font color="green">æœ‰é™</font>ï¼Œè€Œä¸”ç”±äºAï¼ŒTï¼ŒCï¼ŒGè¿™å››ç§è§å…‰æ ‡è®°çš„è„±æ°§æ ¸è‹·é…¸éå¸¸å¿«é€Ÿåœ°ä»å¤–é¢è¿›å…¥åˆ°å­”å†…åˆå‡ºå»ï¼Œå½¢æˆäº†éå¸¸<font color="green">ç¨³å®šçš„èƒŒæ™¯è§å…‰ä¿¡å·</font>ã€‚å½“æŸä¸€ç§è§å…‰æ ‡è®°çš„è„±æ°§æ ¸è‹·é…¸è¢«æºå…¥åˆ°DNAé“¾æ—¶ï¼Œç‰¹å®šé¢œè‰²çš„<font color="green">è§å…‰ä¼šæŒç»­ä¸€å°æ®µæ—¶é—´</font>ï¼Œç›´åˆ°æ–°çš„åŒ–å­¦é”®å½¢æˆï¼Œè§å…‰åŸºå›¢è¢«DNAèšåˆé…¶åˆ‡é™¤ä¸ºæ­¢ã€‚</p><p>ç¬¬äºŒï¼š<font color="green">å…±èšç„¦æ˜¾å¾®é•œ</font>å®æ—¶å¿«é€Ÿåœ°å¯¹é›†æˆåœ¨<font color="green">æ¿ä¸Šçš„æ— æ•°çº³ç±³å°å­”åŒæ—¶è®°å½•</font>ã€‚</p><h1 id="æŠ€æœ¯ç‰¹ç‚¹"><a href="#æŠ€æœ¯ç‰¹ç‚¹" class="headerlink" title="æŠ€æœ¯ç‰¹ç‚¹"></a>æŠ€æœ¯ç‰¹ç‚¹</h1><p>1ã€å®ç°DNAèšåˆé…¶å†…åœ¨è‡ªèº«çš„<font color="green">ååº”é€Ÿåº¦</font>ï¼Œä¸€ç§’æµ‹10ä¸ªç¢±åŸºï¼Œæµ‹åºé€Ÿåº¦æ˜¯<font color="green">åŒ–å­¦æ³•æµ‹åº2ä¸‡å€</font>ã€‚</p><p>2ã€å®ç°äº†DNAèšåˆé…¶å†…åœ¨è‡ªèº«çš„<font color="green">å»¶ç»­æ€§</font>ï¼Œä¸€ä¸ªååº”å¯æµ‹éå¸¸é•¿çš„åºåˆ—ã€‚äºŒä»£æµ‹åºå¯ä»¥æµ‹åˆ°ä¸Šç™¾ä¸ªç¢±åŸºï¼Œä½†æ˜¯ä¸‰ä»£æµ‹åºå¯æµ‹å‡ åƒä¸ªç¢±åŸºã€‚</p><p>3ã€<font color="green">ç²¾åº¦</font>éå¸¸é«˜ï¼Œè¾¾åˆ°<font color="green">99.9999%</font>ã€‚</p><p>4ã€ç›´æ¥æµ‹<font color="green">RNAåºåˆ—</font> (<strong>ISO</strong>)ã€‚æ—¢ç„¶<font color="green">DNAèšåˆé…¶</font>èƒ½å¤Ÿå®æ—¶è§‚æµ‹ï¼Œé‚£ä¹ˆä»¥RNAä¸ºæ¨¡æ¿å¤åˆ¶<font color="green">DNAçš„é€†è½¬å½•é…¶</font>ä¹ŸåŒæ ·å¯ä»¥ã€‚RNAç›´æ¥æµ‹åºï¼Œå°†å¤§å¤§é™ä½ä½“å¤–é€†è½¬å½•äº§ç”Ÿçš„ç³»ç»Ÿè¯¯å·®ã€‚</p><p>5ã€ç¬¬äºŒä¸ªæ˜¯ç›´æ¥æµ‹<font color="green">ç”²åŸºåŒ–DNAåºåˆ—</font>ã€‚å®é™…ä¸ŠDNAèšåˆé…¶<font color="red"><strong>å¤åˆ¶Aã€Tã€Cã€Gçš„é€Ÿåº¦ä¸ä¸€æ ·</strong></font>ã€‚<font color="red"><strong>æ­£å¸¸çš„Cæˆ–è€…ç”²åŸºåŒ–çš„Cä¸ºæ¨¡æ¿ï¼ŒDNAèšåˆé…¶åœé¡¿çš„æ—¶é—´ä¸åŒ</strong></font>ã€‚æ ¹æ®æ—¶é—´ä¸åŒï¼Œå¯ä»¥<font color="red"><strong>åˆ¤æ–­æ¨¡æ¿çš„Cæ˜¯å¦ç”²åŸºåŒ–</strong></font>ã€‚</p><h1 id="å¹³å°æ¯”è¾ƒ"><a href="#å¹³å°æ¯”è¾ƒ" class="headerlink" title="å¹³å°æ¯”è¾ƒ"></a>å¹³å°æ¯”è¾ƒ</h1><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>æµ‹åºæ–¹æ³•&#x2F;å¹³å°</td><td>å…¬å¸</td><td>æ–¹æ³•&#x2F;é…¶</td><td>æµ‹åºé•¿åº¦</td><td>æ¯ä¸ªå¾ªç¯çš„æ•°æ®äº§å‡ºé‡</td><td>æ¯ä¸ªå¾ªç¯è€—æ—¶</td><td>ä¸»è¦é”™è¯¯æ¥æº</td><td></td></tr><tr><td>ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯</td><td>Heliscope&#x2F;HelicosGenetic AnalysisSystem</td><td>Helicos</td><td>è¾¹åˆæˆè¾¹æµ‹åº&#x2F;DNAèšåˆé…¶</td><td>30-35 bp</td><td>21-28 Gb</td><td>8 d</td><td>æ›¿æ¢</td></tr><tr><td>SMRT</td><td>Pacific Biosciences</td><td>è¾¹åˆæˆè¾¹æµ‹åº&#x2F;DNAèšåˆé…¶</td><td>100000 bp</td><td></td><td></td><td></td><td></td></tr><tr><td>çº³ç±³å­”å•åˆ†å­</td><td>Oxford Nanopore</td><td>ç”µä¿¡å·æµ‹åº&#x2F;æ ¸é…¸å¤–åˆ‡é…¶</td><td>æ— é™é•¿</td><td></td><td></td><td></td><td></td></tr></tbody></table><h1 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h1><h2 id="åŸºå› ç»„æµ‹åº"><a href="#åŸºå› ç»„æµ‹åº" class="headerlink" title="åŸºå› ç»„æµ‹åº"></a>åŸºå› ç»„æµ‹åº</h2><p>ç”±äºå…·æœ‰è¯»é•¿é•¿çš„ç‰¹ç‚¹ï¼ŒSMRTæµ‹åºå¹³å°åœ¨åŸºå› ç»„æµ‹åºä¸­èƒ½<font color="green"><strong>é™ä½æµ‹åºåçš„Contigæ•°é‡</strong></font>ï¼Œæ˜æ˜¾<font color="green"><strong>å‡å°‘</strong></font>åç»­åŸºå› ç»„<font color="green"><strong>æ‹¼æ¥å’Œæ³¨é‡Šå·¥ä½œé‡</strong></font>ï¼ŒèŠ‚çœå¤§é‡æ—¶é—´ã€‚Christophernç­‰ä»…ä»…ç”¨0.5çš„Pacbio RSç³»ç»Ÿé•¿åº¦çš„æ•°æ®ä¸äºŒä»£æµ‹åº(NGS)çš„æµ‹åºæ•°æ®ï¼Œå¯¹<strong>é©¬è¾¾åŠ æ–¯åŠ æŒ‡çŒ´</strong>åŸºå› ç»„è¿›è¡Œæ‹¼è£…ï¼Œå¤§å¹…åº¦<font color="green">æé«˜</font>æ•°æ®çš„<font color="green">è´¨é‡å’Œå®Œæ•´åº¦</font>ï¼ŒåŒæ—¶å€ŸåŠ©Pacbio RSå°†åŸæœ‰<font color="green">Contigæ•°é‡å‡å°‘10å€</font>ã€‚DavidAï¼ç­‰åˆ©ç”¨Pachio RSå¹³å°C2è¯•å‰‚é€šè¿‡å…¨çƒåˆä½œå‡ å¤©å†…å°±å®Œæˆäº†ä»<font color="green"><strong>å¾·å›½å¤§è‚ æ†èŒç–«æƒ…</strong></font>ä¸­è·å¾—çš„<font color="green">å¤§è‚ æ†èŒæ ·å“</font>ä»¥åŠ<font color="green">è¿‘ä¼¼èŒæ ª</font>çš„æµ‹åºå’Œæ•°æ®åˆ†æï¼Œæœ€ç»ˆè·å¾—<font color="green">2900bpå¹³å‡è¯»é•¿</font>ä»¥åŠ<font color="green">99.998%ä¸€è‡´æ€§å‡†ç¡®åº¦</font>ã€‚åœ¨å¯¹<font color="green"><strong>éœä¹±ç—…èŒ</strong></font>çš„ç ”ç©¶ä¸­ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯å·²åˆç°é”‹èŠ’ã€‚ç ”ç©¶äººå‘˜å¯¹<font color="green">5æ ªéœä¹±èŒæ ª</font>çš„åŸºå› ç»„è¿›è¡Œäº†æµ‹åºç ”ç©¶ï¼Œå¹¶ä¸å…¶ä»–<font color="green">23æ ªéœä¹±å¼§èŒ</font>çš„<font color="green">åŸºå› ç»„è¿›è¡Œå¯¹æ¯”</font>ã€‚ç»“æœå‘ç°æµ·åœ°éœä¹±èŒæ ªä¸2002å¹´å’Œ2008å¹´å­ŸåŠ æ‹‰å›½å˜å¼‚éœä¹±å¼§èŒElTorO1èŒæ ªä¹‹é—´å…³ç³»å¯†åˆ‡ï¼Œè€Œä¸1991å¹´æ‹‰ä¸ç¾æ´²éœä¹±åˆ†ç¦»æ ªçš„å…³ç³»è¾ƒè¿œã€‚ç›¸å¯¹NGSçš„ä¼˜åŠ¿å°±æ˜¯èƒ½<font color="red">æ›´å¿«è·å¾—ç»“æœ</font>ï¼Œå› æ­¤è¯¥ç³»ç»Ÿåœ¨<font color="red">é‰´å®šæ–°çš„ç—…åŸä½“å’Œç»†èŒ</font>çš„åŸºå› ç»„æµ‹åºæ–¹é¢å¾—åˆ°å¹¿æ³›åº”ç”¨ã€‚</p><h2 id="ç”²åŸºåŒ–ç ”ç©¶"><a href="#ç”²åŸºåŒ–ç ”ç©¶" class="headerlink" title="ç”²åŸºåŒ–ç ”ç©¶"></a>ç”²åŸºåŒ–ç ”ç©¶</h2><p><strong>SMRTæŠ€æœ¯</strong>å¯¹DNA<strong>èšåˆé…¶</strong>çš„å·¥ä½œçŠ¶æ€<strong>å®æ—¶ç›‘æµ‹</strong>ï¼Œèšåˆé…¶<strong>åˆæˆæ¯ä¸€ä¸ªç¢±åŸº</strong>ï¼Œéƒ½æœ‰<strong>ä¸€ä¸ªæ—¶é—´æ®µ</strong>ï¼Œè€Œå½“æ¨¡æ¿ç¢±åŸº<strong>å¸¦æœ‰ä¿®é¥°æ—¶</strong>ï¼Œèšåˆé…¶ä¼š<strong>æ…¢ä¸‹æ¥</strong>ï¼Œä½¿<strong>å¸¦æœ‰ä¿®é¥°çš„ç¢±åŸºä¸¤ä¸ªç›¸é‚»çš„è„‰å†²å³°</strong>ä¹‹é—´çš„<strong>è·ç¦»</strong>å’Œ<strong>å‚è€ƒåºåˆ—çš„è·ç¦»ä¹‹é—´çš„æ¯”å€¼</strong>ç»“æœ<strong>å¤§äº1</strong>ï¼Œç”±æ­¤å°±å¯ä»¥æ¨æ–­è¿™ä¸ªä½ç½®æœ‰ä¿®é¥°ã€‚ç”²åŸºåŒ–ç ”ç©¶ä¸­å…³äº<strong>5mCå’Œ5hmC</strong>ï¼ˆ5mCçš„ç¾ŸåŸºåŒ–å½¢å¼ï¼‰æ˜¯ç”²åŸºåŒ–ç ”ç©¶ä¸­çš„çƒ­ç‚¹ã€‚ä½†<strong>ç°æœ‰æµ‹åºæ–¹æ³•æ— æ³•åŒºåˆ†</strong>5mCå’Œ5hmCã€‚<strong>ç¾å›½èŠåŠ å“¥å¤§å­¦</strong>åˆ©ç”¨<strong>SMRT</strong>æµ‹åºæŠ€æœ¯å’Œ<strong>5hmCçš„é€‰æ‹©æ€§åŒ–å­¦æ ‡è®°æ–¹æ³•</strong>æ¥é«˜é€šé‡æ£€æµ‹5hmCã€‚é€šè¿‡èšåˆé…¶åŠ¨åŠ›å­¦æä¾›çš„ä¿¡æ¯ï¼Œå¯ç›´æ¥æ£€æµ‹åˆ°<font color="green">DNAç”²åŸºåŒ–</font>ï¼ŒåŒ…æ‹¬<font color="red">N6ç”²åŸºè…ºå˜Œå‘¤ã€5mCå’Œ5hmC</font>ï¼Œä¸ºè¡¨è§‚é—ä¼ å­¦ç ”ç©¶æ‰“å¼€äº†ä¸€æ¡é€šè·¯ã€‚</p><h2 id="çªå˜é‰´å®šï¼ˆSNPæ£€æµ‹ï¼‰"><a href="#çªå˜é‰´å®šï¼ˆSNPæ£€æµ‹ï¼‰" class="headerlink" title="çªå˜é‰´å®šï¼ˆSNPæ£€æµ‹ï¼‰"></a>çªå˜é‰´å®šï¼ˆSNPæ£€æµ‹ï¼‰</h2><p>å•åˆ†å­æµ‹åºçš„åˆ†è¾¨ç‡å…·æœ‰ä¸å¯æ¯”æ‹Ÿçš„ä¼˜åŠ¿ï¼Œè€Œä¸”æ²¡æœ‰PCRæ‰©å¢ï¼Œå°±<font color="green">æ²¡æœ‰æ‰©å¢å¼•å…¥çš„ç¢±åŸºé”™è¯¯</font>ï¼Œè¯¥ä¼˜åŠ¿ä½¿å…¶åœ¨<font color="green">ç‰¹å®šåºåˆ—çš„SNPæ£€æµ‹</font>ï¼Œ<font color="green">ç¨€æœ‰çªå˜åŠå…¶é¢‘ç‡æµ‹å®š</font>ä¸­å¤§æ˜¾èº«æ‰‹ã€‚ä¾‹å¦‚åœ¨åŒ»å­¦ç ”ç©¶ä¸­ï¼Œå¯¹äºFLT3åŸºå› æ˜¯å¦æ˜¯æ€¥æ€§é«“ç»†èƒç™½è¡€ç—…ï¼ˆAMLï¼‰çš„æœ‰æ•ˆæ²»ç–—é¶æ ‡ä¸€ç›´å­˜åœ¨è´¨ç–‘ã€‚ç ”ç©¶äººå‘˜ç”¨å•åˆ†å­æµ‹åºåˆ†æè€è¯æ€§æ‚£è€…åŸºå› ï¼Œæ„å¤–å‘ç°è€è¯æ€§ä¸FLT3åŸºå› ä¸‹æ¸¸å‡ºç°çš„ç¨€æœ‰æ–°çªå˜æœ‰å…³ï¼Œé‡æ–°è¯æ˜äº†FLT3åŸºå› æ˜¯è¿™ç§æœ€å¸¸è§ç™½è¡€ç—…â€”æ€¥æ€§é«“ç»†èƒç™½è¡€ç—…ï¼ˆAMLï¼‰çš„æœ‰æ•ˆæ²»ç–—é¶æ ‡ï¼Œæ‰“ç ´äº†ä¸€ç›´ä»¥æ¥å¯¹äºè¿™ä¸€åŸºå› é¶æ ‡çš„ç–‘æƒ‘ã€‚å‡­å€ŸPacBioå¹³å‡3000bpçš„è¯»é•¿ï¼Œè·å¾—äº†æ›´å¤šåŸºå› ä¸‹æ¸¸çš„å®è´µä¿¡æ¯ï¼Œè€ŒåŸºäºå•æ ¸é…¸åˆ†å­çš„æµ‹åºèƒ½å¤Ÿ<font color="red"><strong>æ£€æµ‹åˆ°ä½é¢‘ç‡ï¼ˆä½è‡³1%ï¼‰ç½•è§çªå˜</strong></font>ï¼Œæ­£æ˜¯è¿™é¡¹æˆæœçš„å…³é”®æ‰€åœ¨ã€‚</p><hr><p><img src="/GeekFocus/2022-02-20-HiFi-1/1.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/1.png" alt="img"></p><h1 id="ç¬¬ä¸€ä»£æµ‹åº"><a href="#ç¬¬ä¸€ä»£æµ‹åº" class="headerlink" title="ç¬¬ä¸€ä»£æµ‹åº"></a>ç¬¬ä¸€ä»£æµ‹åº</h1><p>ç¬¬ä¸€ä»£DNAæµ‹åºæŠ€æœ¯ç”¨çš„æ˜¯1975å¹´ç”±æ¡‘æ ¼ï¼ˆSangerï¼‰å’Œè€ƒå°”æ£®ï¼ˆCoulsonï¼‰å¼€åˆ›çš„é“¾ç»ˆæ­¢æ³•æˆ–è€…æ˜¯1976-1977å¹´ç”±é©¬å…‹è¥¿å§†ï¼ˆMaxamï¼‰å’Œå‰å°”ä¼¯ç‰¹ï¼ˆGilbertï¼‰å‘æ˜çš„åŒ–å­¦æ³•ï¼ˆé“¾é™è§£ï¼‰. å¹¶åœ¨1977å¹´ï¼Œæ¡‘æ ¼æµ‹å®šäº†ç¬¬ä¸€ä¸ªåŸºå› ç»„åºåˆ—ï¼Œæ˜¯å™¬èŒä½“X174çš„ï¼Œå…¨é•¿5375ä¸ªç¢±åŸº1ã€‚è‡ªæ­¤ï¼Œäººç±»è·å¾—äº†çª¥æ¢ç”Ÿå‘½é—ä¼ å·®å¼‚æœ¬è´¨çš„èƒ½åŠ›ï¼Œå¹¶ä»¥æ­¤ä¸ºå¼€ç«¯æ­¥å…¥åŸºå› ç»„å­¦æ—¶ä»£ã€‚ç ”ç©¶äººå‘˜åœ¨Sangeræ³•çš„å¤šå¹´å®è·µä¹‹ä¸­ä¸æ–­å¯¹å…¶è¿›è¡Œæ”¹è¿›ã€‚åœ¨2001å¹´ï¼Œå®Œæˆçš„é¦–ä¸ªäººç±»åŸºå› ç»„å›¾è°±å°±æ˜¯ä»¥æ”¹è¿›äº†çš„Sangeræ³•ä¸ºå…¶æµ‹åºåŸºç¡€ï¼ŒSangeræ³•æ ¸å¿ƒåŸç†æ˜¯ï¼šç”±äºddNTPçš„2â€™å’Œ3â€™éƒ½ä¸å«ç¾ŸåŸºï¼Œå…¶åœ¨DNAçš„åˆæˆè¿‡ç¨‹ä¸­ä¸èƒ½å½¢æˆç£·é…¸äºŒé…¯é”®ï¼Œå› æ­¤å¯ä»¥ç”¨æ¥ä¸­æ–­DNAåˆæˆååº”ï¼Œåœ¨4ä¸ªDNAåˆæˆååº”ä½“ç³»ä¸­åˆ†åˆ«åŠ å…¥ä¸€å®šæ¯”ä¾‹å¸¦æœ‰æ”¾å°„æ€§åŒä½ç´ æ ‡è®°çš„ddNTPï¼ˆåˆ†ä¸ºï¼šddATP,ddCTP,ddGTPå’ŒddTTPï¼‰ï¼Œé€šè¿‡å‡èƒ¶ç”µæ³³å’Œæ”¾å°„è‡ªæ˜¾å½±åå¯ä»¥æ ¹æ®ç”µæ³³å¸¦çš„ä½ç½®ç¡®å®šå¾…æµ‹åˆ†å­çš„DNAåºåˆ—ï¼ˆå›¾2ï¼‰ã€‚è¿™ä¸ª<a href="http://smcg.cifn.unam.mx/enp-unam/03-EstructuraDelGenoma/animaciones/secuencia.swf">ç½‘å€</a>ä¸ºsangeræµ‹åºæ³•åˆ¶ä½œäº†ä¸€ä¸ªå°çŸ­ç‰‡ï¼Œå½¢è±¡è€Œç”ŸåŠ¨ã€‚</p><p>ã€€ã€€å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå°±åœ¨æµ‹åºæŠ€æœ¯èµ·æ­¥å‘å±•çš„è¿™ä¸€æ—¶æœŸä¸­ï¼Œé™¤äº†Sangeræ³•ä¹‹å¤–è¿˜å‡ºç°äº†ä¸€äº›å…¶ä»–çš„æµ‹åºæŠ€æœ¯ï¼Œå¦‚ç„¦ç£·é…¸æµ‹åºæ³•ã€é“¾æ¥é…¶æ³•ç­‰ã€‚å…¶ä¸­ï¼Œç„¦ç£·é…¸æµ‹åºæ³•æ˜¯åæ¥Rocheå…¬å¸454æŠ€æœ¯æ‰€ä½¿ç”¨çš„æµ‹åºæ–¹æ³•2â€“4ï¼Œè€Œè¿æ¥é…¶æµ‹åºæ³•æ˜¯åæ¥ABIå…¬å¸SOLIDæŠ€æœ¯ä½¿ç”¨çš„æµ‹åºæ–¹æ³•2,4ï¼Œä½†ä»–ä»¬çš„å…±åŒæ ¸å¿ƒæ‰‹æ®µéƒ½æ˜¯åˆ©ç”¨äº†Sanger1ä¸­çš„å¯ä¸­æ–­DNAåˆæˆååº”çš„dNTPã€‚</p><p><img src="/GeekFocus/2022-02-20-HiFi-1/2.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/2.png" alt="img"></p><h1 id="ç¬¬äºŒä»£æµ‹åº"><a href="#ç¬¬äºŒä»£æµ‹åº" class="headerlink" title="ç¬¬äºŒä»£æµ‹åº"></a>ç¬¬äºŒä»£æµ‹åº</h1><p>æ€»çš„è¯´æ¥ï¼Œç¬¬ä¸€ä»£æµ‹åºæŠ€æœ¯çš„ä¸»è¦ç‰¹ç‚¹æ˜¯æµ‹åºè¯»é•¿å¯è¾¾1000bpï¼Œå‡†ç¡®æ€§é«˜è¾¾99.999%ï¼Œä½†å…¶æµ‹åºæˆæœ¬é«˜ï¼Œé€šé‡ä½ç­‰æ–¹é¢çš„ç¼ºç‚¹ï¼Œä¸¥é‡å½±å“äº†å…¶çœŸæ­£å¤§è§„æ¨¡çš„åº”ç”¨ã€‚å› è€Œç¬¬ä¸€ä»£æµ‹åºæŠ€æœ¯å¹¶ä¸æ˜¯æœ€ç†æƒ³çš„æµ‹åºæ–¹æ³•ã€‚ç»è¿‡ä¸æ–­çš„æŠ€æœ¯å¼€å‘å’Œæ”¹è¿›ï¼Œä»¥Rocheå…¬å¸çš„454æŠ€æœ¯ã€illuminaå…¬å¸çš„Solexaï¼ŒHiseqæŠ€æœ¯å’ŒABIå…¬å¸çš„SolidæŠ€æœ¯ä¸ºæ ‡è®°çš„ç¬¬äºŒä»£æµ‹åºæŠ€æœ¯è¯ç”Ÿäº†ã€‚ç¬¬äºŒä»£æµ‹åºæŠ€æœ¯å¤§å¤§é™ä½äº†æµ‹åºæˆæœ¬çš„åŒæ—¶ï¼Œè¿˜å¤§å¹…æé«˜äº†æµ‹åºé€Ÿåº¦ï¼Œå¹¶ä¸”ä¿æŒäº†é«˜å‡†ç¡®æ€§ï¼Œä»¥å‰å®Œæˆä¸€ä¸ªäººç±»åŸºå› ç»„çš„æµ‹åºéœ€è¦3å¹´æ—¶é—´ï¼Œè€Œä½¿ç”¨äºŒä»£æµ‹åºæŠ€æœ¯åˆ™ä»…ä»…éœ€è¦1å‘¨ï¼Œä½†åœ¨åºåˆ—è¯»é•¿æ–¹é¢æ¯”èµ·ç¬¬ä¸€ä»£æµ‹åºæŠ€æœ¯åˆ™è¦çŸ­å¾ˆå¤šã€‚è¡¨1å’Œå›¾3å¯¹ç¬¬ä¸€ä»£å’Œç¬¬äºŒä»£æµ‹åºæŠ€æœ¯å„è‡ªçš„ç‰¹ç‚¹ä»¥åŠæµ‹åºæˆæœ¬ä½œäº†ä¸€ä¸ªç®€å•çš„æ¯”è¾ƒ5ï¼Œä»¥ä¸‹æˆ‘å°†å¯¹è¿™ä¸‰ç§ä¸»è¦çš„ç¬¬äºŒä»£æµ‹åºæŠ€æœ¯çš„ä¸»è¦åŸç†å’Œç‰¹ç‚¹ä½œä¸€ä¸ªç®€å•çš„ä»‹ç»ã€‚ </p><p><img src="/GeekFocus/2022-02-20-HiFi-1/3.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/3.png" alt="img"></p><h2 id="Illumina"><a href="#Illumina" class="headerlink" title="Illumina"></a>Illumina</h2><p>ã€€ã€€Illuminaå…¬å¸çš„Solexaå’ŒHiseqåº”è¯¥è¯´æ˜¯ç›®å‰å…¨çƒä½¿ç”¨é‡æœ€å¤§çš„ç¬¬äºŒä»£æµ‹åºæœºå™¨ï¼Œè¿™ä¸¤ä¸ªç³»åˆ—çš„æŠ€æœ¯æ ¸å¿ƒåŸç†æ˜¯ç›¸åŒçš„2,4ã€‚è¿™ä¸¤ä¸ªç³»åˆ—çš„æœºå™¨é‡‡ç”¨çš„éƒ½æ˜¯è¾¹åˆæˆè¾¹æµ‹åºçš„æ–¹æ³•ï¼Œå®ƒçš„æµ‹åºè¿‡ç¨‹ä¸»è¦åˆ†ä¸ºä»¥ä¸‹4æ­¥ï¼Œå¦‚å›¾4.</p><p>â€‹     ï¼ˆ1ï¼‰DNAå¾…æµ‹æ–‡åº“æ„å»º</p><p>ã€€ã€€åˆ©ç”¨è¶…å£°æ³¢æŠŠå¾…æµ‹çš„DNAæ ·æœ¬æ‰“æ–­æˆå°ç‰‡æ®µï¼Œç›®å‰é™¤äº†ç»„è£…ä¹‹å¤–å’Œä¸€äº›å…¶ä»–çš„ç‰¹æ®Šè¦æ±‚ä¹‹å¤–ï¼Œä¸»è¦æ˜¯æ‰“æ–­æˆ200-500bpé•¿çš„åºåˆ—ç‰‡æ®µï¼Œå¹¶åœ¨è¿™äº›å°ç‰‡æ®µçš„ä¸¤ç«¯æ·»åŠ ä¸Šä¸åŒçš„æ¥å¤´ï¼Œæ„å»ºå‡ºå•é“¾DNAæ–‡åº“ã€‚</p><p>â€‹     ï¼ˆ2ï¼‰Flowcell</p><p>ã€€ã€€Flowcellæ˜¯ç”¨äºå¸é™„æµåŠ¨DNAç‰‡æ®µçš„æ§½é“ï¼Œå½“æ–‡åº“å»ºå¥½åï¼Œè¿™äº›æ–‡åº“ä¸­çš„DNAåœ¨é€šè¿‡flowcellçš„æ—¶å€™ä¼šéšæœºé™„ç€åœ¨flowcellè¡¨é¢çš„channelä¸Šã€‚æ¯ä¸ªFlowcellæœ‰8ä¸ªchannelï¼Œæ¯ä¸ªchannelçš„è¡¨é¢éƒ½é™„æœ‰å¾ˆå¤šæ¥å¤´ï¼Œè¿™äº›æ¥å¤´èƒ½å’Œå»ºåº“è¿‡ç¨‹ä¸­åŠ åœ¨DNAç‰‡æ®µä¸¤ç«¯çš„æ¥å¤´ç›¸äº’é…å¯¹ï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆflowcellèƒ½å¸é™„å»ºåº“åçš„DNAçš„åŸå› ï¼‰ï¼Œå¹¶èƒ½æ”¯æŒDNAåœ¨å…¶è¡¨é¢è¿›è¡Œæ¡¥å¼PCRçš„æ‰©å¢ã€‚</p><p>â€‹     ï¼ˆ3ï¼‰æ¡¥å¼PCRæ‰©å¢ä¸å˜æ€§</p><p>ã€€ã€€æ¡¥å¼PCRä»¥Flowcellè¡¨é¢æ‰€å›ºå®šçš„æ¥å¤´ä¸ºæ¨¡æ¿ï¼Œè¿›è¡Œæ¡¥å½¢æ‰©å¢ï¼Œå¦‚å›¾4.aæ‰€ç¤ºã€‚ç»è¿‡ä¸æ–­çš„æ‰©å¢å’Œå˜æ€§å¾ªç¯ï¼Œæœ€ç»ˆæ¯ä¸ªDNAç‰‡æ®µéƒ½å°†åœ¨å„è‡ªçš„ä½ç½®ä¸Šé›†ä¸­æˆæŸï¼Œæ¯ä¸€ä¸ªæŸéƒ½å«æœ‰å•ä¸ªDNAæ¨¡æ¿çš„å¾ˆå¤šåˆ†æ‹·è´ï¼Œè¿›è¡Œè¿™ä¸€è¿‡ç¨‹çš„ç›®çš„åœ¨äºå®ç°å°†ç¢±åŸºçš„ä¿¡å·å¼ºåº¦æ”¾å¤§ï¼Œä»¥è¾¾åˆ°æµ‹åºæ‰€éœ€çš„ä¿¡å·è¦æ±‚ã€‚ </p><p>ï¼ˆ4ï¼‰æµ‹åº</p><p>ã€€ã€€æµ‹åºæ–¹æ³•é‡‡ç”¨è¾¹åˆæˆè¾¹æµ‹åºçš„æ–¹æ³•ã€‚å‘ååº”ä½“ç³»ä¸­åŒæ—¶æ·»åŠ DNAèšåˆé…¶ã€æ¥å¤´å¼•ç‰©å’Œå¸¦æœ‰ç¢±åŸºç‰¹å¼‚è§å…‰æ ‡è®°çš„4ä¸­dNTPï¼ˆå¦‚åŒSangeræµ‹åºæ³•ï¼‰ã€‚è¿™äº›dNTPçš„3â€™-OHè¢«åŒ–å­¦æ–¹æ³•æ‰€ä¿æŠ¤ï¼Œå› è€Œæ¯æ¬¡åªèƒ½æ·»åŠ ä¸€ä¸ªdNTPã€‚åœ¨dNTPè¢«æ·»åŠ åˆ°åˆæˆé“¾ä¸Šåï¼Œæ‰€æœ‰æœªä½¿ç”¨çš„æ¸¸ç¦»dNTPå’ŒDNAèšåˆé…¶ä¼šè¢«æ´—è„±æ‰ã€‚æ¥ç€ï¼Œå†åŠ å…¥æ¿€å‘è§å…‰æ‰€éœ€çš„ç¼“å†²æ¶²ï¼Œç”¨æ¿€å…‰æ¿€å‘è§å…‰ä¿¡å·ï¼Œå¹¶æœ‰å…‰å­¦è®¾å¤‡å®Œæˆè§å…‰ä¿¡å·çš„è®°å½•ï¼Œæœ€ååˆ©ç”¨è®¡ç®—æœºåˆ†æå°†å…‰å­¦ä¿¡å·è½¬åŒ–ä¸ºæµ‹åºç¢±åŸºã€‚è¿™æ ·è§å…‰ä¿¡å·è®°å½•å®Œæˆåï¼Œå†åŠ å…¥åŒ–å­¦è¯•å‰‚æ·¬ç­è§å…‰ä¿¡å·å¹¶å»é™¤dNTP 3â€™-OHä¿æŠ¤åŸºå›¢ï¼Œä»¥ä¾¿èƒ½è¿›è¡Œä¸‹ä¸€è½®çš„æµ‹åºååº”ã€‚Illuminaçš„è¿™ç§æµ‹åºæŠ€æœ¯æ¯æ¬¡åªæ·»åŠ ä¸€ä¸ªdNTPçš„ç‰¹ç‚¹èƒ½å¤Ÿå¾ˆå¥½çš„åœ°è§£å†³åŒèšç‰©é•¿åº¦çš„å‡†ç¡®æµ‹é‡é—®é¢˜ï¼Œå®ƒçš„ä¸»è¦æµ‹åºé”™è¯¯æ¥æºæ˜¯ç¢±åŸºçš„æ›¿æ¢ï¼Œç›®å‰å®ƒçš„æµ‹åºé”™è¯¯ç‡åœ¨1%-1.5%ä¹‹é—´ï¼Œæµ‹åºå‘¨æœŸä»¥äººç±»åŸºå› ç»„é‡æµ‹åºä¸ºä¾‹ï¼Œ30xæµ‹åºæ·±åº¦å¤§çº¦ä¸º1å‘¨ã€‚</p><p><img src="/GeekFocus/2022-02-20-HiFi-1/4.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/4.png" alt="img"></p><p><img src="/GeekFocus/2022-02-20-HiFi-1/5.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/5.png" alt="img"></p><h2 id="Roche-454"><a href="#Roche-454" class="headerlink" title="Roche 454"></a>Roche 454</h2><p>Roche 454æµ‹åºç³»ç»Ÿæ˜¯ç¬¬ä¸€ä¸ªå•†ä¸šåŒ–è¿è¥äºŒä»£æµ‹åºæŠ€æœ¯çš„å¹³å°ã€‚å®ƒçš„ä¸»è¦æµ‹åºåŸç†æ˜¯ï¼ˆå›¾5 abcï¼‰2ï¼š</p><p>ï¼ˆ1ï¼‰DNAæ–‡åº“åˆ¶å¤‡</p><p>ã€€ã€€454æµ‹åºç³»ç»Ÿçš„æ–‡ä»¶æ„å»ºæ–¹å¼å’Œilluminaçš„ä¸åŒï¼Œå®ƒæ˜¯åˆ©ç”¨å–·é›¾æ³•å°†å¾…æµ‹DNAæ‰“æ–­æˆ300-800bpé•¿çš„å°ç‰‡æ®µï¼Œå¹¶åœ¨ç‰‡æ®µä¸¤ç«¯åŠ ä¸Šä¸åŒçš„æ¥å¤´ï¼Œæˆ–å°†å¾…æµ‹DNAå˜æ€§åç”¨æ‚äº¤å¼•ç‰©è¿›è¡ŒPCRæ‰©å¢ï¼Œè¿æ¥è½½ä½“ï¼Œæ„å»ºå•é“¾DNAæ–‡åº“ï¼ˆå›¾5aï¼‰ã€‚</p><p>ï¼ˆ2ï¼‰Emulsion PCR ï¼ˆä¹³æ¶²PCRï¼Œå…¶å®æ˜¯ä¸€ä¸ªæ³¨æ°´åˆ°æ²¹çš„ç‹¬ç‰¹è¿‡ç¨‹ï¼‰</p><p>454å½“ç„¶DNAæ‰©å¢è¿‡ç¨‹ä¹Ÿå’Œilluminaçš„æˆªç„¶ä¸åŒï¼Œå®ƒå°†è¿™äº›å•é“¾DNAç»“åˆåœ¨æ°´æ²¹åŒ…è¢«çš„ç›´å¾„çº¦28umçš„ç£ç ä¸Šï¼Œå¹¶åœ¨å…¶ä¸Šé¢å­µè‚²ã€é€€ç«ã€‚</p><p>ã€€ã€€ä¹³æ¶²PCRæœ€å¤§çš„ç‰¹ç‚¹æ˜¯å¯ä»¥å½¢æˆæ•°ç›®åºå¤§çš„ç‹¬ç«‹ååº”ç©ºé—´ä»¥è¿›è¡ŒDNAæ‰©å¢ã€‚å…¶å…³é”®æŠ€æœ¯æ˜¯â€œæ³¨æ°´åˆ°æ²¹â€ï¼ˆæ°´åŒ…æ²¹ï¼‰ï¼ŒåŸºæœ¬è¿‡ç¨‹æ˜¯åœ¨PCRååº”å‰ï¼Œå°†åŒ…å«PCRæ‰€æœ‰ååº”æˆåˆ†çš„æ°´æº¶æ¶²æ³¨å…¥åˆ°é«˜é€Ÿæ—‹è½¬çš„çŸ¿ç‰©æ²¹è¡¨é¢ï¼Œæ°´æº¶æ¶²ç¬é—´å½¢æˆæ— æ•°ä¸ªè¢«çŸ¿ç‰©æ²¹åŒ…è£¹çš„å°æ°´æ»´ã€‚è¿™äº›å°æ°´æ»´å°±æ„æˆäº†ç‹¬ç«‹çš„PCRååº”ç©ºé—´ã€‚ç†æƒ³çŠ¶æ€ä¸‹ï¼Œæ¯ä¸ªå°æ°´æ»´åªå«ä¸€ä¸ªDNAæ¨¡æ¿å’Œä¸€ä¸ªç£ç ã€‚</p><p>ã€€ã€€è¿™äº›è¢«å°æ°´æ»´åŒ…è¢«çš„ç£ç è¡¨é¢å«æœ‰ä¸æ¥å¤´äº’è¡¥çš„DNAåºåˆ—ï¼Œå› æ­¤è¿™äº›å•é“¾DNAåºåˆ—èƒ½å¤Ÿç‰¹å¼‚åœ°ç»“åˆåœ¨ç£ç ä¸Šã€‚åŒæ—¶å­µè‚²ä½“ç³»ä¸­å«æœ‰PCRååº”è¯•å‰‚ï¼Œæ‰€ä»¥ä¿è¯äº†æ¯ä¸ªä¸ç£ç ç»“åˆçš„å°ç‰‡æ®µéƒ½èƒ½ç‹¬ç«‹è¿›è¡ŒPCRæ‰©å¢ï¼Œå¹¶ä¸”æ‰©å¢äº§ç‰©ä»å¯ä»¥ç»“åˆåˆ°ç£ç ä¸Šã€‚å½“ååº”å®Œæˆåï¼Œå¯ä»¥ç ´åå­µè‚²ä½“ç³»å¹¶å°†å¸¦æœ‰DNAçš„ç£ç å¯Œé›†ä¸‹æ¥ã€‚è¿›è¿‡æ‰©å¢ï¼Œæ¯ä¸ªå°ç‰‡æ®µéƒ½å°†è¢«æ‰©å¢çº¦100ä¸‡å€ï¼Œä»è€Œè¾¾åˆ°ä¸‹ä¸€æ­¥æµ‹åºæ‰€è¦æ±‚çš„DNAé‡ã€‚</p><p>ï¼ˆ3ï¼‰ç„¦ç£·é…¸æµ‹åº</p><p>ã€€ã€€æµ‹åºå‰éœ€è¦å…ˆç”¨ä¸€ç§èšåˆé…¶å’Œå•é“¾ç»“åˆè›‹ç™½å¤„ç†å¸¦æœ‰DNAçš„ç£ç ï¼Œæ¥ç€å°†ç£ç æ”¾åœ¨ä¸€ç§PTPå¹³æ¿ä¸Šã€‚è¿™ç§å¹³æ¿ä¸Šç‰¹åˆ¶æœ‰è®¸å¤šç›´å¾„çº¦ä¸º44umçš„å°å­”ï¼Œæ¯ä¸ªå°å­”ä»…èƒ½å®¹çº³ä¸€ä¸ªç£ç ï¼Œé€šè¿‡è¿™ç§æ–¹æ³•æ¥å›ºå®šæ¯ä¸ªç£ç çš„ä½ç½®ï¼Œä»¥ä¾¿æ£€æµ‹æ¥ä¸‹æ¥çš„æµ‹åºååº”è¿‡ç¨‹ã€‚ã€€ã€€</p><p>ã€€ã€€æµ‹åºæ–¹æ³•é‡‡ç”¨ç„¦ç£·é…¸æµ‹åºæ³•ï¼Œå°†ä¸€ç§æ¯”PTPæ¿ä¸Šå°å­”ç›´å¾„æ›´å°çš„ç£ç æ”¾å…¥å°å­”ä¸­ï¼Œå¯åŠ¨æµ‹åºååº”ã€‚æµ‹åºååº”ä»¥ç£ç ä¸Šå¤§é‡æ‰©å¢å‡ºçš„å•é“¾DNAä¸ºæ¨¡æ¿ï¼Œæ¯æ¬¡ååº”åŠ å…¥ä¸€ç§dNTPè¿›è¡Œåˆæˆååº”ã€‚å¦‚æœdNTPèƒ½ä¸å¾…æµ‹åºåˆ—é…å¯¹ï¼Œåˆ™ä¼šåœ¨åˆæˆåé‡Šæ”¾ç„¦ç£·é…¸åŸºå›¢ã€‚é‡Šæ”¾çš„ç„¦ç£·é…¸åŸºå›¢ä¼šä¸ååº”ä½“ç³»ä¸­çš„ATPç¡«é…¸åŒ–å­¦é…¶ååº”ç”ŸæˆATPã€‚ç”Ÿæˆçš„ATPå’Œè§å…‰ç´ é…¶å…±åŒæ°§åŒ–ä½¿æµ‹åºååº”ä¸­çš„è§å…‰ç´ åˆ†å­å¹¶å‘å‡ºè§å…‰ï¼ŒåŒæ—¶ç”±PTPæ¿å¦ä¸€ä¾§çš„CCDç…§ç›¸æœºè®°å½•ï¼Œæœ€åé€šè¿‡è®¡ç®—æœºè¿›è¡Œå…‰ä¿¡å·å¤„ç†è€Œè·å¾—æœ€ç»ˆçš„æµ‹åºç»“æœã€‚ç”±äºæ¯ä¸€ç§dNTPåœ¨ååº”ä¸­äº§ç”Ÿçš„è§å…‰é¢œè‰²ä¸åŒï¼Œå› æ­¤å¯ä»¥æ ¹æ®è§å…‰çš„é¢œè‰²æ¥åˆ¤æ–­è¢«æµ‹åˆ†å­çš„åºåˆ—ã€‚ååº”ç»“æŸåï¼Œæ¸¸ç¦»çš„dNTPä¼šåœ¨åŒç£·é…¸é…¶çš„ä½œç”¨ä¸‹é™è§£ATPï¼Œä»è€Œå¯¼è‡´è§å…‰æ·¬ç­ï¼Œä»¥ä¾¿ä½¿æµ‹åºååº”è¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯ã€‚ç”±äº454æµ‹åºæŠ€æœ¯ä¸­ï¼Œæ¯ä¸ªæµ‹åºååº”éƒ½åœ¨PTPæ¿ä¸Šç‹¬ç«‹çš„å°å­”ä¸­è¿›è¡Œï¼Œå› è€Œèƒ½å¤§å¤§é™ä½ç›¸äº’é—´çš„å¹²æ‰°å’Œæµ‹åºåå·®ã€‚454æŠ€æœ¯æœ€å¤§çš„ä¼˜åŠ¿åœ¨äºå…¶èƒ½è·å¾—è¾ƒé•¿çš„æµ‹åºè¯»é•¿ï¼Œå½“å‰454æŠ€æœ¯çš„å¹³å‡è¯»é•¿å¯è¾¾400bpï¼Œå¹¶ä¸”454æŠ€æœ¯å’Œilluminaçš„Solexaå’ŒHiseqæŠ€æœ¯ä¸åŒï¼Œå®ƒæœ€ä¸»è¦çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯æ— æ³•å‡†ç¡®æµ‹é‡åŒèšç‰©çš„é•¿åº¦ï¼Œå¦‚å½“åºåˆ—ä¸­å­˜åœ¨ç±»ä¼¼äºPolyAçš„æƒ…å†µæ—¶ï¼Œæµ‹åºååº”ä¼šä¸€æ¬¡åŠ å…¥å¤šä¸ªTï¼Œè€Œæ‰€åŠ å…¥çš„Tçš„ä¸ªæ•°åªèƒ½é€šè¿‡è§å…‰å¼ºåº¦æ¨æµ‹è·å¾—ï¼Œè¿™å°±æœ‰å¯èƒ½å¯¼è‡´ç»“æœä¸å‡†ç¡®ã€‚ä¹Ÿæ­£æ˜¯ç”±äºè¿™ä¸€åŸå› ï¼Œ454æŠ€æœ¯ä¼šåœ¨æµ‹åºè¿‡ç¨‹ä¸­å¼•å…¥æ’å…¥å’Œç¼ºå¤±çš„æµ‹åºé”™è¯¯ã€‚ </p><p><img src="/GeekFocus/2022-02-20-HiFi-1/6.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/6.png" alt="img"></p><p><img src="/GeekFocus/2022-02-20-HiFi-1/7.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/7.png" alt="img"></p><p><img src="/GeekFocus/2022-02-20-HiFi-1/8.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/8.png" alt="img"></p><h2 id="SolidæŠ€æœ¯"><a href="#SolidæŠ€æœ¯" class="headerlink" title="SolidæŠ€æœ¯"></a>SolidæŠ€æœ¯</h2><p>Solidæµ‹åºæŠ€æœ¯æ˜¯ABIå…¬å¸äº2007å¹´å¼€å§‹æŠ•å…¥ç”¨äºå•†ä¸šæµ‹åºåº”ç”¨çš„ä»ªå™¨ã€‚å®ƒåŸºäºè¿æ¥é…¶æ³•ï¼Œå³åˆ©ç”¨DNAè¿æ¥é…¶åœ¨è¿æ¥è¿‡ç¨‹ä¹‹ä¸­æµ‹åºï¼ˆå›¾6ï¼‰2,4ã€‚å®ƒçš„åŸç†æ˜¯ï¼š</p><p><img src="/GeekFocus/2022-02-20-HiFi-1/9.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/9.png" alt="img"></p><p>ã€€ï¼ˆ1ï¼‰DNAæ–‡åº“æ„å»º</p><p>â€‹              ã€€ã€€ç‰‡æ®µæ‰“æ–­å¹¶åœ¨ç‰‡æ®µä¸¤ç«¯åŠ ä¸Šæµ‹åºæ¥å¤´ï¼Œè¿æ¥è½½ä½“ï¼Œæ„å»ºå•é“¾DNAæ–‡åº“ã€‚</p><p>â€‹           ï¼ˆ2ï¼‰Emulsion PCR</p><p>ã€€ã€€Solidçš„PCRè¿‡ç¨‹ä¹Ÿå’Œ454çš„æ–¹æ³•ç±»ä¼¼ï¼ŒåŒæ ·é‡‡ç”¨å°æ°´æ»´emulsion PCRï¼Œä½†è¿™äº›å¾®ç æ¯”èµ·454ç³»ç»Ÿæ¥è¯´åˆ™è¦å°å¾—å¤šï¼Œåªæœ‰1umã€‚åœ¨æ‰©å¢çš„åŒæ—¶å¯¹æ‰©å¢äº§ç‰©çš„3â€™ç«¯è¿›è¡Œä¿®é¥°ï¼Œè¿™æ˜¯ä¸ºä¸‹ä¸€æ­¥çš„æµ‹åºè¿‡ç¨‹ä½œçš„å‡†å¤‡ã€‚3â€™ä¿®é¥°çš„å¾®ç ä¼šè¢«æ²‰ç§¯åœ¨ä¸€å—ç»ç‰‡ä¸Šã€‚åœ¨å¾®ç ä¸Šæ ·çš„è¿‡ç¨‹ä¸­ï¼Œæ²‰ç§¯å°å®¤å°†æ¯å¼ ç»ç‰‡åˆ†æˆ1ä¸ªã€4ä¸ªæˆ–8ä¸ªæµ‹åºåŒºåŸŸï¼ˆå›¾6-aï¼‰ã€‚Solidç³»ç»Ÿæœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯æ¯å¼ ç»ç‰‡èƒ½å®¹çº³æ¯”454æ›´é«˜å¯†åº¦çš„å¾®ç ï¼Œåœ¨åŒä¸€ç³»ç»Ÿä¸­è½»æ¾å®ç°æ›´é«˜çš„é€šé‡ã€‚</p><p>â€‹           ï¼ˆ3ï¼‰è¿æ¥é…¶æµ‹åº</p><p>ã€€ã€€è¿™ä¸€æ­¥æ˜¯Solidæµ‹åºçš„ç‹¬ç‰¹ä¹‹å¤„ã€‚å®ƒå¹¶æ²¡æœ‰é‡‡ç”¨ä»¥å‰æµ‹åºæ—¶æ‰€å¸¸ç”¨çš„DNAèšåˆé…¶ï¼Œè€Œæ˜¯é‡‡ç”¨äº†è¿æ¥é…¶ã€‚Solidè¿æ¥ååº”çš„åº•ç‰©æ˜¯8ç¢±åŸºå•é“¾è§å…‰æ¢é’ˆæ··åˆç‰©ï¼Œè¿™é‡Œå°†å…¶ç®€å•è¡¨ç¤ºä¸ºï¼š3â€™-XXnnnzzz-5â€™ã€‚è¿æ¥ååº”ä¸­ï¼Œè¿™äº›æ¢é’ˆæŒ‰ç…§ç¢±åŸºäº’è¡¥è§„åˆ™ä¸å•é“¾DNAæ¨¡æ¿é“¾é…å¯¹ã€‚æ¢é’ˆçš„5â€™æœ«ç«¯åˆ†åˆ«æ ‡è®°äº†CY5ã€Texas Redã€CY3ã€6-FAMè¿™4ç§é¢œè‰²çš„è§å…‰æŸ“æ–™ï¼ˆå›¾6-aï¼‰ã€‚è¿™ä¸ª8ç¢±åŸºå•é“¾è§å…‰æ¢é’ˆä¸­ï¼Œç¬¬1å’Œç¬¬2ä½ç¢±åŸºï¼ˆXXï¼‰ä¸Šçš„ç¢±åŸºæ˜¯ç¡®å®šçš„ï¼Œå¹¶æ ¹æ®ç§ç±»çš„ä¸åŒåœ¨6-8ä½ï¼ˆzzzï¼‰ä¸ŠåŠ ä¸Šäº†ä¸åŒçš„è§å…‰æ ‡è®°ã€‚è¿™æ˜¯Solidçš„ç‹¬ç‰¹æµ‹åºæ³•ï¼Œä¸¤ä¸ªç¢±åŸºç¡®å®šä¸€ä¸ªè§å…‰ä¿¡å·ï¼Œç›¸å½“äºä¸€æ¬¡èƒ½å†³å®šä¸¤ä¸ªç¢±åŸºã€‚è¿™ç§æµ‹åºæ–¹æ³•ä¹Ÿç§°ä¹‹ä¸ºä¸¤ç¢±åŸºæµ‹åºæ³•ã€‚å½“è§å…‰æ¢é’ˆèƒ½å¤Ÿä¸DNAæ¨¡æ¿é“¾é…å¯¹è€Œè¿æ¥ä¸Šæ—¶ï¼Œå°±ä¼šå‘å‡ºä»£è¡¨ç¬¬1ï¼Œ2ä½ç¢±åŸºçš„è§å…‰ä¿¡å·ï¼Œå›¾6-aå’Œå›¾6-bä¸­çš„æ¯”è‰²ç‰ˆæ‰€è¡¨ç¤ºçš„æ˜¯ç¬¬1ï¼Œ2ä½ç¢±åŸºçš„ä¸åŒç»„åˆä¸è§å…‰é¢œè‰²çš„å…³ç³»ã€‚åœ¨è®°å½•ä¸‹è§å…‰ä¿¡å·åï¼Œé€šè¿‡åŒ–å­¦æ–¹æ³•åœ¨ç¬¬5å’Œç¬¬6ä½ç¢±åŸºä¹‹é—´è¿›è¡Œåˆ‡å‰²ï¼Œè¿™æ ·å°±èƒ½ç§»é™¤è§å…‰ä¿¡å·ï¼Œä»¥ä¾¿è¿›è¡Œä¸‹ä¸€ä¸ªä½ç½®çš„æµ‹åºã€‚ä¸è¿‡å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé€šè¿‡è¿™ç§æµ‹åºæ–¹æ³•ï¼Œæ¯æ¬¡æµ‹åºçš„ä½ç½®éƒ½ç›¸å·®5ä½ã€‚å³ç¬¬ä¸€æ¬¡æ˜¯ç¬¬1ã€2ä½ï¼Œç¬¬äºŒæ¬¡æ˜¯ç¬¬6ã€7ä½â€¦â€¦åœ¨æµ‹åˆ°æœ«å°¾åï¼Œè¦å°†æ–°åˆæˆçš„é“¾å˜æ€§ï¼Œæ´—è„±ã€‚æ¥ç€ç”¨å¼•ç‰©n-1è¿›è¡Œç¬¬äºŒè½®æµ‹åºã€‚å¼•ç‰©n-1ä¸å¼•ç‰©nçš„åŒºåˆ«æ˜¯ï¼ŒäºŒè€…åœ¨ä¸æ¥å¤´é…å¯¹çš„ä½ç½®ä¸Šç›¸å·®ä¸€ä¸ªç¢±åŸºï¼ˆå›¾6-a. 8ï¼‰ã€‚ä¹Ÿå³æ˜¯ï¼Œé€šè¿‡å¼•ç‰©n-1åœ¨å¼•ç‰©nçš„åŸºç¡€ä¸Šå°†æµ‹åºä½ç½®å¾€3â€™ç«¯ç§»åŠ¨ä¸€ä¸ªç¢±åŸºä½ç½®ï¼Œå› è€Œå°±èƒ½æµ‹å®šç¬¬0ã€1ä½å’Œç¬¬5ã€6ä½â€¦â€¦ç¬¬äºŒè½®æµ‹åºå®Œæˆï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´è‡³ç¬¬äº”è½®æµ‹åºï¼Œæœ€ç»ˆå¯ä»¥å®Œæˆæ‰€æœ‰ä½ç½®çš„ç¢±åŸºæµ‹åºï¼Œå¹¶ä¸”æ¯ä¸ªä½ç½®çš„ç¢±åŸºå‡è¢«æ£€æµ‹äº†ä¸¤æ¬¡ã€‚è¯¥æŠ€æœ¯çš„è¯»é•¿åœ¨2Ã—50bpï¼Œåç»­åºåˆ—æ‹¼æ¥åŒæ ·æ¯”è¾ƒå¤æ‚ã€‚ç”±äºåŒæ¬¡æ£€æµ‹ï¼Œè¿™ä¸€æŠ€æœ¯çš„åŸå§‹æµ‹åºå‡†ç¡®æ€§é«˜è¾¾99.94%ï¼Œè€Œ15xè¦†ç›–ç‡æ—¶çš„å‡†ç¡®æ€§æ›´æ˜¯è¾¾åˆ°äº†99.999%ï¼Œåº”è¯¥è¯´æ˜¯ç›®å‰ç¬¬äºŒä»£æµ‹åºæŠ€æœ¯ä¸­å‡†ç¡®æ€§æœ€é«˜çš„äº†ã€‚ä½†åœ¨è§å…‰è§£ç é˜¶æ®µï¼Œé‰´äºå…¶æ˜¯åŒç¢±åŸºç¡®å®šä¸€ä¸ªè§å…‰ä¿¡å·ï¼Œå› è€Œä¸€æ—¦å‘ç”Ÿé”™è¯¯å°±å®¹æ˜“äº§ç”Ÿè¿é”çš„è§£ç é”™è¯¯ã€‚</p><p><img src="/GeekFocus/2022-02-20-HiFi-1/10.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/10.png" alt="img"></p><h1 id="ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯"><a href="#ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯" class="headerlink" title="ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯"></a>ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯</h1><p>ä»¥PacBioå…¬å¸çš„<font color="red">SMRT</font>å’Œ<font color="red">Oxford Nanopore Technologiesçº³ç±³å­”å•åˆ†å­æµ‹åºæŠ€æœ¯</font>ï¼Œè¢«ç§°ä¹‹ä¸ºç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯ã€‚ä¸å‰ä¸¤ä»£ç›¸æ¯”ï¼Œæœ€å¤§çš„ç‰¹ç‚¹æ˜¯å•åˆ†å­æµ‹åºï¼Œæµ‹åºè¿‡ç¨‹<font color="red">æ— éœ€PCR</font>æ‰©å¢ã€‚</p><p>ã€€ã€€PacBio SMRTæŠ€æœ¯ä¹Ÿåº”ç”¨äº†è¾¹åˆæˆè¾¹æµ‹åºæ€æƒ³ï¼Œå¹¶ä»¥SMRTèŠ¯ç‰‡ä¸ºæµ‹åºè½½ä½“ã€‚åŸºæœ¬åŸç†ï¼š DNAèšåˆé…¶å’Œæ¨¡æ¿ç»“åˆ,4è‰²è§å…‰æ ‡è®° 4 ç§ç¢±åŸºï¼ˆå³æ˜¯dNTPï¼‰,åœ¨ç¢±åŸºé…å¯¹é˜¶æ®µ,ä¸åŒç¢±åŸºåŠ å…¥,å‘ä¸åŒå…‰,æ ¹æ®<font color="green">å…‰çš„æ³¢é•¿ä¸å³°å€¼</font>åˆ¤æ–­è¿›å…¥ç¢±åŸºç±»å‹ã€‚ DNA èšåˆé…¶æ˜¯å®ç°è¶…é•¿è¯»é•¿çš„å…³é”®ä¹‹ä¸€,è¯»é•¿ä¸»è¦è·Ÿ<font color="red">é…¶çš„æ´»æ€§ä¿æŒ</font>æœ‰å…³,å®ƒä¸»è¦å—æ¿€å…‰å¯¹å…¶é€ æˆçš„æŸä¼¤æ‰€å½±å“ã€‚</p><p>â€‹PacBio SMRTæŠ€æœ¯çš„ä¸€ä¸ªå…³é”®æ˜¯æ€æ ·å°†ååº”ä¿¡å·ä¸å‘¨å›´æ¸¸ç¦»ç¢±åŸºçš„<font color="red">å¼ºå¤§è§å…‰èƒŒæ™¯</font>åŒºåˆ«ã€‚<font color="red"><strong>ZMWï¼ˆé›¶æ¨¡æ³¢å¯¼å­”ï¼‰åŸç†</strong></font>ï¼šå¦‚åŒå¾®æ³¢ç‚‰å£ä¸Šå¯çœ‹åˆ°çš„å¾ˆå¤šå¯†é›†å°å­”ã€‚å°å­”ç›´å¾„æœ‰è€ƒç©¶,å¦‚æœç›´å¾„å¤§äºå¾®æ³¢æ³¢é•¿,èƒ½é‡å°±ä¼šåœ¨è¡å°„æ•ˆåº”çš„ä½œç”¨ä¸‹ç©¿é€é¢æ¿è€Œæ³„éœ²å‡ºæ¥ï¼Œä»è€Œä¸å‘¨å›´å°å­”ç›¸äº’å¹²æ‰°ã€‚å¦‚æœå­”å¾„å°äºæ³¢é•¿,èƒ½é‡ä¸ä¼šè¾å°„åˆ°å‘¨å›´ï¼Œè€Œæ˜¯ä¿æŒç›´çº¿çŠ¶æ€ï¼ˆå…‰è¡å°„çš„åŸç†ï¼‰,ä»è€Œå¯èµ·ä¿æŠ¤ä½œç”¨ã€‚åŒç†,åœ¨ä¸€ä¸ªååº”ç®¡(SMRTCell:å•åˆ†å­å®æ—¶ååº”å­”)ä¸­æœ‰è®¸å¤šè¿™æ ·çš„åœ†å½¢çº³ç±³å°å­”, å³ ZMW(é›¶æ¨¡æ³¢å¯¼å­”),å¤–å¾„ 100å¤šçº³ç±³,æ¯”æ£€æµ‹æ¿€å…‰æ³¢é•¿å°(æ•°ç™¾çº³ç±³),æ¿€å…‰ä»åº•éƒ¨æ‰“ä¸Šå»åä¸èƒ½ç©¿é€å°å­”è¿›å…¥ä¸Šæ–¹æº¶æ¶²åŒº,èƒ½é‡è¢«é™åˆ¶åœ¨ä¸€ä¸ªå°èŒƒå›´(ä½“ç§¯20X 10-21 L)é‡Œ,æ­£å¥½è¶³å¤Ÿè¦†ç›–éœ€è¦æ£€æµ‹çš„éƒ¨åˆ†,ä½¿å¾—ä¿¡å·ä»…æ¥è‡ªè¿™ä¸ªå°ååº”åŒºåŸŸ,å­”å¤–è¿‡å¤šæ¸¸ç¦»æ ¸è‹·é…¸å•ä½“ä¾ç„¶ç•™åœ¨é»‘æš—ä¸­,ä»è€Œå®ç°å°†èƒŒæ™¯é™åˆ°æœ€ä½ã€‚å¦å¤–ï¼Œå¯ä»¥é€šè¿‡æ£€æµ‹ç›¸é‚»ä¸¤ä¸ªç¢±åŸºä¹‹é—´çš„æµ‹åºæ—¶é—´ï¼Œæ¥æ£€æµ‹ä¸€äº›ç¢±åŸºä¿®é¥°æƒ…å†µï¼Œæ—¢å¦‚æœç¢±åŸºå­˜åœ¨ä¿®é¥°ï¼Œåˆ™é€šè¿‡èšåˆé…¶æ—¶çš„é€Ÿåº¦ä¼šå‡æ…¢ï¼Œç›¸é‚»ä¸¤å³°ä¹‹é—´çš„è·ç¦»å¢å¤§ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæ¥ä¹‹é—´æ£€æµ‹ç”²åŸºåŒ–ç­‰ä¿¡æ¯ï¼ˆå›¾7ï¼‰ã€‚SMRTæŠ€æœ¯çš„æµ‹åºé€Ÿåº¦å¾ˆå¿«ï¼Œæ¯ç§’çº¦10ä¸ªdNTPã€‚ä½†æ˜¯ï¼ŒåŒæ—¶å…¶æµ‹åº<font color="red">é”™è¯¯ç‡æ¯”è¾ƒé«˜</font>ï¼ˆè¿™å‡ ä¹æ˜¯ç›®å‰å•åˆ†å­æµ‹åºæŠ€æœ¯çš„é€šç—…ï¼‰ï¼Œè¾¾åˆ°<font color="red">15%</font>,ä½†å¥½åœ¨å®ƒçš„å‡ºé”™æ˜¯éšæœºçš„ï¼Œå¹¶ä¸ä¼šåƒç¬¬äºŒä»£æµ‹åºæŠ€æœ¯é‚£æ ·å­˜åœ¨æµ‹åºé”™è¯¯çš„åå‘ï¼Œå› è€Œå¯ä»¥é€šè¿‡<font color="red">å¤šæ¬¡æµ‹åºæ¥è¿›è¡Œæœ‰æ•ˆçš„çº é”™</font>ã€‚</p><p><img src="/GeekFocus/2022-02-20-HiFi-1/11.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/11.png" alt="img"></p><p>Oxford Nanopore Technologieså…¬å¸æ‰€å¼€å‘çš„çº³ç±³å•åˆ†å­æµ‹åºæŠ€æœ¯ä¸ä»¥å¾€çš„æµ‹åºæŠ€æœ¯çš†ä¸åŒï¼Œå®ƒæ˜¯åŸºäºç”µä¿¡å·è€Œä¸æ˜¯å…‰ä¿¡å·çš„æµ‹åºæŠ€æœ¯ã€‚è¯¥æŠ€æœ¯çš„å…³é”®ä¹‹ä¸€æ˜¯ï¼Œä»–ä»¬è®¾è®¡äº†ä¸€ç§ç‰¹æ®Šçš„çº³ç±³å­”ï¼Œå­”å†…å…±ä»·ç»“åˆæœ‰åˆ†å­æ¥å¤´ã€‚å½“DNAç¢±åŸºé€šè¿‡çº³ç±³å­”æ—¶ï¼Œå®ƒä»¬ä½¿ç”µè·å‘ç”Ÿå˜åŒ–ï¼Œä»è€ŒçŸ­æš‚åœ°å½±å“æµè¿‡çº³ç±³å­”çš„ç”µæµå¼ºåº¦ï¼ˆæ¯ç§ç¢±åŸºæ‰€å½±å“çš„ç”µæµå˜åŒ–å¹…åº¦æ˜¯ä¸åŒçš„ï¼‰ï¼Œçµæ•çš„ç”µå­è®¾å¤‡æ£€æµ‹åˆ°è¿™äº›å˜åŒ–ä»è€Œé‰´å®šæ‰€é€šè¿‡çš„ç¢±åŸºã€‚</p><p>ã€€ã€€è¯¥å…¬å¸åœ¨å»å¹´åŸºå› ç»„ç”Ÿç‰©å­¦æŠ€æœ¯è¿›å±•å¹´ä¼š(AGBT)ä¸Šæ¨å‡ºç¬¬ä¸€æ¬¾å•†ä¸šåŒ–çš„çº³ç±³å­”æµ‹åºä»ªï¼Œå¼•èµ·äº†ç§‘å­¦ç•Œçš„æå¤§å…³æ³¨ã€‚çº³ç±³å­”æµ‹åºï¼ˆå’Œå…¶ä»–ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯ï¼‰æœ‰æœ›è§£å†³ç›®å‰æµ‹åºå¹³å°çš„ä¸è¶³ï¼Œçº³ç±³å­”æµ‹åºçš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼šè¯»é•¿å¾ˆé•¿ï¼Œå¤§çº¦åœ¨å‡ åkbï¼Œç”šè‡³100 kb;é”™è¯¯ç‡ç›®å‰ä»‹äº1%è‡³4%ï¼Œä¸”æ˜¯éšæœºé”™è¯¯ï¼Œè€Œä¸æ˜¯èšé›†åœ¨è¯»å–çš„ä¸¤ç«¯;æ•°æ®å¯å®æ—¶è¯»å–;é€šé‡å¾ˆé«˜(30xäººç±»åŸºå› ç»„æœ‰æœ›åœ¨ä¸€å¤©å†…å®Œæˆ);èµ·å§‹DNAåœ¨æµ‹åºè¿‡ç¨‹ä¸­ä¸è¢«ç ´å;ä»¥åŠæ ·å“åˆ¶å¤‡ç®€å•åˆä¾¿å®œã€‚ç†è®ºä¸Šï¼Œå®ƒä¹Ÿèƒ½ç›´æ¥æµ‹åºRNAã€‚</p><p>ã€€ã€€çº³ç±³å­”å•åˆ†å­æµ‹åºè®¡ç®—è¿˜æœ‰å¦ä¸€å¤§ç‰¹ç‚¹ï¼Œå®ƒèƒ½å¤Ÿç›´æ¥è¯»å–å‡ºç”²åŸºåŒ–çš„èƒå˜§å•¶ï¼Œè€Œä¸å¿…åƒä¼ ç»Ÿæ–¹æ³•é‚£æ ·å¯¹åŸºå› ç»„è¿›è¡Œbisulfiteå¤„ç†ã€‚è¿™å¯¹äºåœ¨åŸºå› ç»„æ°´å¹³ç›´æ¥ç ”ç©¶è¡¨è§‚é—ä¼ ç›¸å…³ç°è±¡æœ‰æå¤§çš„å¸®åŠ©ã€‚å¹¶ä¸”æ”¹æ–¹æ³•çš„æµ‹åºå‡†ç¡®æ€§å¯è¾¾99.8%ï¼Œè€Œä¸”ä¸€æ—¦å‘ç°æµ‹åºé”™è¯¯ä¹Ÿèƒ½è¾ƒå®¹æ˜“åœ°è¿›è¡Œçº æ­£ã€‚ä½†ç›®å‰ä¼¼ä¹è¿˜æ²¡æœ‰åº”ç”¨è¯¥æŠ€æœ¯çš„ç›¸å…³æŠ¥é“ã€‚</p><p><img src="/GeekFocus/2022-02-20-HiFi-1/12.png" alt="img"><br><img src="/GeekFocus/img/2022-02-20-HiFi-1/12.png" alt="img"></p><h1 id="å…¶ä»–æµ‹åºæŠ€æœ¯"><a href="#å…¶ä»–æµ‹åºæŠ€æœ¯" class="headerlink" title="å…¶ä»–æµ‹åºæŠ€æœ¯"></a>å…¶ä»–æµ‹åºæŠ€æœ¯</h1><p>ç›®å‰è¿˜æœ‰ä¸€ç§åŸºäºåŠå¯¼ä½“èŠ¯ç‰‡çš„æ–°ä¸€ä»£é©å‘½æ€§æµ‹åºæŠ€æœ¯â€”â€”Ion Torrent6ã€‚è¯¥æŠ€æœ¯ä½¿ç”¨äº†ä¸€ç§å¸ƒæ»¡å°å­”çš„é«˜å¯†åº¦åŠå¯¼ä½“èŠ¯ç‰‡ï¼Œ ä¸€ä¸ªå°å­”å°±æ˜¯ä¸€ä¸ªæµ‹åºååº”æ± ã€‚å½“DNAèšåˆé…¶æŠŠæ ¸è‹·é…¸èšåˆåˆ°å»¶ä¼¸ä¸­çš„DNAé“¾ä¸Šæ—¶ï¼Œä¼šé‡Šæ”¾å‡ºä¸€ä¸ªæ°¢ç¦»å­ï¼Œååº”æ± ä¸­çš„PHå‘ç”Ÿæ”¹å˜ï¼Œä½äºæ± ä¸‹çš„ç¦»å­æ„Ÿå—å™¨æ„Ÿå—åˆ°H+ç¦»å­ä¿¡å·ï¼ŒH+ç¦»å­ä¿¡å·å†ç›´æ¥è½¬åŒ–ä¸ºæ•°å­—ä¿¡å·ï¼Œä»è€Œè¯»å‡ºDNAåºåˆ—ï¼ˆå›¾9ï¼‰ã€‚è¿™ä¸€æŠ€æœ¯çš„å‘æ˜äººåŒæ—¶ä¹Ÿæ˜¯454æµ‹åºæŠ€æœ¯çš„å‘æ˜äººä¹‹ä¸€â€”â€”Jonathan Rothbergï¼Œå®ƒçš„æ–‡åº“å’Œæ ·æœ¬åˆ¶å¤‡è·Ÿ454æŠ€æœ¯å¾ˆåƒï¼Œç”šè‡³å¯ä»¥è¯´å°±æ˜¯454çš„ç¿»ç‰ˆï¼Œåªæ˜¯æµ‹åºè¿‡ç¨‹ä¸­ä¸æ˜¯é€šè¿‡æ£€æµ‹ç„¦ç£·é…¸è§å…‰æ˜¾è‰²ï¼Œè€Œæ˜¯é€šè¿‡æ£€æµ‹H+ä¿¡å·çš„å˜åŒ–æ¥è·å¾—åºåˆ—ç¢±åŸºä¿¡æ¯ã€‚Ion Torrentç›¸æ¯”äºå…¶ä»–æµ‹åºæŠ€æœ¯æ¥è¯´ï¼Œä¸éœ€è¦æ˜‚è´µçš„ç‰©ç†æˆåƒç­‰è®¾å¤‡ï¼Œå› æ­¤ï¼Œæˆæœ¬ç›¸å¯¹æ¥è¯´ä¼šä½ï¼Œä½“ç§¯ä¹Ÿä¼šæ¯”è¾ƒå°ï¼ŒåŒæ—¶æ“ä½œä¹Ÿè¦æ›´ä¸ºç®€å•ï¼Œé€Ÿåº¦ä¹Ÿç›¸å½“å¿«é€Ÿï¼Œé™¤äº†2å¤©æ–‡åº“åˆ¶ä½œæ—¶é—´ï¼Œæ•´ä¸ªä¸Šæœºæµ‹åºå¯åœ¨2-3.5å°æ—¶å†…å®Œæˆï¼Œä¸è¿‡æ•´ä¸ªèŠ¯ç‰‡çš„é€šé‡å¹¶ä¸é«˜ï¼Œç›®å‰æ˜¯10Gå·¦å³ï¼Œä½†éå¸¸é€‚åˆå°åŸºå› ç»„å’Œå¤–æ˜¾å­éªŒè¯çš„æµ‹åºã€‚    </p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ä»¥ä¸Šï¼Œå¯¹å„ä»£æµ‹åºæŠ€æœ¯çš„åŸç†åšäº†ç®€è¦çš„é˜è¿°ï¼Œè¿™ä¸‰ä»£æµ‹åºæŠ€æœ¯çš„ç‰¹ç‚¹æ¯”è¾ƒæ±‡æ€»åœ¨ä»¥ä¸‹è¡¨1å’Œè¡¨2ä¸­ã€‚å…¶ä¸­æµ‹åºæˆæœ¬ï¼Œè¯»é•¿å’Œé€šé‡æ˜¯è¯„ä¼°è¯¥æµ‹åºæŠ€æœ¯å…ˆè¿›ä¸å¦çš„ä¸‰ä¸ªé‡è¦æŒ‡æ ‡ã€‚ç¬¬ä¸€ä»£å’Œç¬¬äºŒä»£æµ‹åºæŠ€æœ¯é™¤äº†é€šé‡å’Œæˆæœ¬ä¸Šçš„å·®å¼‚ä¹‹å¤–ï¼Œå…¶æµ‹åºæ ¸å¿ƒåŸç†ï¼ˆé™¤Solidæ˜¯è¾¹è¿æ¥è¾¹æµ‹åºä¹‹å¤–ï¼‰éƒ½æ˜¯åŸºäºè¾¹åˆæˆè¾¹æµ‹åºçš„æ€æƒ³ã€‚ç¬¬äºŒä»£æµ‹åºæŠ€æœ¯çš„ä¼˜ç‚¹æ˜¯æˆæœ¬è¾ƒä¹‹ä¸€ä»£å¤§å¤§ä¸‹é™ï¼Œé€šé‡å¤§å¤§æå‡ï¼Œä½†ç¼ºç‚¹æ˜¯æ‰€å¼•å…¥PCRè¿‡ç¨‹ä¼šåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ æµ‹åºçš„é”™è¯¯ç‡ï¼Œå¹¶ä¸”å…·æœ‰ç³»ç»Ÿåå‘æ€§ï¼ŒåŒæ—¶è¯»é•¿ä¹Ÿæ¯”è¾ƒçŸ­ã€‚ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯æ˜¯ä¸ºäº†è§£å†³ç¬¬äºŒä»£æ‰€å­˜åœ¨çš„ç¼ºç‚¹è€Œå¼€å‘çš„ï¼Œå®ƒçš„æ ¹æœ¬ç‰¹ç‚¹æ˜¯å•åˆ†å­æµ‹åºï¼Œä¸éœ€è¦ä»»ä½•PCRçš„è¿‡ç¨‹ï¼Œè¿™æ˜¯ä¸ºäº†èƒ½æœ‰æ•ˆé¿å…å› PCRåå‘æ€§è€Œå¯¼è‡´çš„ç³»ç»Ÿé”™è¯¯ï¼ŒåŒæ—¶æé«˜è¯»é•¿ï¼Œå¹¶è¦ä¿æŒäºŒä»£æŠ€æœ¯çš„é«˜é€šé‡ï¼Œä½æˆæœ¬çš„ä¼˜ç‚¹ã€‚</p><table><thead><tr><th><strong>ç¬¬<strong><strong>X</strong></strong>ä»£</strong></th><th><strong>å…¬å¸</strong></th><th><strong>å¹³å°åç§°</strong></th><th><strong>æµ‹åºæ–¹æ³•</strong></th><th><strong>æ£€æµ‹æ–¹æ³•</strong></th><th><strong>å¤§çº¦è¯»é•¿</strong><strong>(<strong><strong>ç¢±åŸºæ•°</strong></strong>)</strong></th><th><strong>ä¼˜ç‚¹</strong></th><th><strong>ç›¸å¯¹å±€é™æ€§</strong></th></tr></thead><tbody><tr><td>ç¬¬ä¸€ä»£</td><td>ABI&#x2F;ç”Ÿå‘½æŠ€æœ¯å…¬å¸</td><td>3130xL-3730xL</td><td>æ¡‘æ ¼-æ¯›ç»†ç®¡ç”µæ³³æµ‹åºæ³•</td><td>è§å…‰&#x2F;å…‰å­¦</td><td>600-1000</td><td>é«˜è¯»é•¿ï¼Œå‡†ç¡®åº¦ä¸€æ¬¡æ€§è¾¾æ ‡ç‡é«˜ï¼Œèƒ½å¾ˆå¥½å¤„ç†é‡å¤åºåˆ—å’Œå¤šèšåºåˆ—</td><td>é€šé‡ä½ï¼›æ ·å“åˆ¶å¤‡æˆæœ¬é«˜ï¼Œä½¿ä¹‹éš¾ä»¥åšå¤§é‡çš„å¹³è¡Œæµ‹åº</td></tr><tr><td>ç¬¬ä¸€ä»£</td><td>è´å…‹æ›¼</td><td>GeXPé—ä¼ åˆ†æç³»ç»Ÿ</td><td>æ¡‘æ ¼-æ¯›ç»†ç®¡ç”µæ³³æµ‹åºæ³•</td><td>è§å…‰&#x2F;å…‰å­¦</td><td>600-1000</td><td>é«˜è¯»é•¿ï¼Œå‡†ç¡®åº¦ä¸€æ¬¡æ€§è¾¾æ ‡ç‡é«˜ï¼Œèƒ½å¾ˆå¥½å¤„ç†é‡å¤åºåˆ—å’Œå¤šèšåºåˆ—ï¼›æ˜“å°å‹åŒ–</td><td>é€šé‡ä½ï¼›å•ä¸ªæ ·å“çš„åˆ¶å¤‡æˆæœ¬ç›¸å¯¹è¾ƒé«˜</td></tr><tr><td>ç¬¬äºŒä»£</td><td>Roche&#x2F;454</td><td>åŸºå› ç»„æµ‹åºä»ªFLXç³»ç»Ÿ</td><td>ç„¦ç£·é…¸æµ‹åºæ³•</td><td>å…‰å­¦</td><td>230-400</td><td>åœ¨ç¬¬äºŒä»£ä¸­æœ€é«˜è¯»é•¿ï¼›æ¯”ç¬¬ä¸€ä»£çš„æµ‹åºé€šé‡å¤§</td><td>æ ·å“åˆ¶å¤‡è¾ƒéš¾ï¼›éš¾äºå¤„ç†é‡å¤å’ŒåŒç§ç¢±åŸºå¤šèšåŒºåŸŸï¼›è¯•å‰‚å†²æ´—å¸¦æ¥é”™è¯¯ç´¯ç§¯ï¼›ä»ªå™¨æ˜‚è´µ</td></tr><tr><td>ç¬¬äºŒä»£</td><td>Illumina</td><td>HiSeq2000,HiSeq2500&#x2F;MiSeq</td><td>å¯é€†é“¾ç»ˆæ­¢ç‰©å’Œåˆæˆæµ‹åºæ³•</td><td>è§å…‰&#x2F;å…‰å­¦</td><td><strong>2x150</strong></td><td>å¾ˆé«˜æµ‹åºé€šé‡</td><td>ä»ªå™¨æ˜‚è´µï¼›ç”¨äºæ•°æ®åˆ èŠ‚å’Œåˆ†æçš„è´¹ç”¨å¾ˆé«˜</td></tr><tr><td>ç¬¬äºŒä»£</td><td>ABI&#x2F;Solid</td><td>5500xlSolidç³»ç»Ÿ</td><td>è¿æ¥æµ‹åºæ³•</td><td>è§å…‰&#x2F;å…‰å­¦</td><td>25-35</td><td>å¾ˆé«˜æµ‹åºé€šé‡ï¼›åœ¨å¹¿ä¸ºæ¥å—çš„å‡ ç§ç¬¬äºŒä»£å¹³å°ä¸­ï¼Œæ‰€è¦æ‹¼æ¥å‡ºäººç±»åŸºå› ç»„çš„è¯•å‰‚æˆæœ¬æœ€ä½</td><td>æµ‹åºè¿è¡Œæ—¶é—´é•¿ï¼›è¯»é•¿çŸ­ï¼Œé€ æˆæˆæœ¬é«˜ï¼Œæ•°æ®åˆ†æå›°éš¾å’ŒåŸºå› ç»„æ‹¼æ¥å›°éš¾ï¼›ä»ªå™¨æ˜‚è´µ</td></tr><tr><td>ç¬¬äºŒä»£</td><td>èµ«åˆ©å…‹æ–¯</td><td>Heliscope</td><td>å•åˆ†å­åˆæˆæµ‹åºæ³•</td><td>è§å…‰&#x2F;å…‰å­¦</td><td>25-30</td><td>é«˜é€šé‡ï¼›åœ¨ç¬¬äºŒä»£ä¸­å±äºå•åˆ†å­æ€§è´¨çš„æµ‹åºæŠ€æœ¯</td><td>è¯»é•¿çŸ­ï¼Œæ¨é«˜äº†æµ‹åºæˆæœ¬ï¼Œé™ä½äº†åŸºå› ç»„æ‹¼æ¥çš„è´¨é‡ï¼›ä»ªå™¨éå¸¸æ˜‚è´µ</td></tr><tr><td>ç¬¬ä¸‰ä»£</td><td>å¤ªå¹³æ´‹ç”Ÿç‰©ç§‘å­¦å…¬å¸</td><td>PacBio RS</td><td>å®æ—¶å•åˆ†å­DNAæµ‹åº</td><td>è§å…‰&#x2F;å…‰å­¦</td><td>~1000</td><td>é«˜å¹³å‡è¯»é•¿ï¼Œæ¯”ç¬¬ä¸€ä»£çš„æµ‹åºæ—¶é—´é™ä½ï¼›ä¸éœ€è¦æ‰©å¢ï¼›æœ€é•¿å•ä¸ªè¯»é•¿æ¥è¿‘3000ç¢±åŸº</td><td>å¹¶ä¸èƒ½é«˜æ•ˆåœ°å°†DNAèšåˆé…¶åŠ åˆ°æµ‹åºé˜µåˆ—ä¸­ï¼›å‡†ç¡®æ€§ä¸€æ¬¡æ€§è¾¾æ ‡çš„æœºä¼šä½ï¼ˆ81-83%ï¼‰ï¼›DNAèšåˆé…¶åœ¨é˜µåˆ—ä¸­é™è§£ï¼›æ€»ä½“ä¸Šæ¯ä¸ªç¢±åŸºæµ‹åºæˆæœ¬é«˜ï¼ˆä»ªå™¨æ˜‚è´µï¼‰ï¼›</td></tr><tr><td>ç¬¬ä¸‰ä»£</td><td>å…¨åŸºå› ç»„å­¦å…¬å¸</td><td>GeXPé—ä¼ åˆ†æç³»ç»Ÿ</td><td>å¤åˆæ¢é’ˆé”šæ‚äº¤å’Œè¿æ¥æŠ€æœ¯</td><td>è§å…‰&#x2F;å…‰å­¦</td><td>10</td><td>åœ¨ç¬¬ä¸‰ä»£ä¸­é€šé‡æœ€é«˜ï¼›åœ¨æ‰€æœ‰æµ‹åºæŠ€æœ¯ä¸­ï¼Œç”¨äºæ‹¼æ¥ä¸€ä¸ªäººåŸºå› ç»„çš„è¯•å‰‚æˆæœ¬æœ€ä½ï¼›æ¯ä¸ªæµ‹åºæ­¥éª¤ç‹¬ç«‹ï¼Œä½¿é”™è¯¯çš„ç´¯ç§¯å˜å¾—æœ€ä½</td><td>ä½è¯»é•¿ï¼› æ¨¡æ¿åˆ¶å¤‡å¦¨ç¢é•¿é‡å¤åºåˆ—åŒºåŸŸæµ‹åºï¼›æ ·å“åˆ¶å¤‡è´¹äº‹ï¼›å°šæ— å•†ä¸šåŒ–ä¾›åº”çš„ä»ªå™¨</td></tr><tr><td>ç¬¬ä¸‰ä»£</td><td>Ion Torrent&#x2F;ç”Ÿå‘½æŠ€æœ¯å…¬å¸</td><td>ä¸ªäººåŸºå› ç»„æµ‹åºä»ªï¼ˆPGMï¼‰</td><td>åˆæˆæµ‹åºæ³•</td><td>ä»¥ç¦»å­æ•æ„Ÿåœºæ•ˆåº”æ™¶ä½“ç®¡æ£€æµ‹pHå€¼å˜åŒ–</td><td>100-200</td><td>å¯¹æ ¸é…¸ç¢±åŸºçš„æºå…¥å¯ç›´æ¥æµ‹å®šï¼›åœ¨è‡ªç„¶æ¡ä»¶ä¸‹è¿›è¡ŒDNAåˆæˆï¼ˆä¸éœ€è¦ä½¿ç”¨ä¿®é¥°è¿‡çš„ç¢±åŸºï¼‰</td><td>ä¸€æ­¥æ­¥çš„æ´—è„±è¿‡ç¨‹å¯å¯¼è‡´é”™è¯¯ç´¯ç§¯ï¼›é˜…è¯»é«˜é‡å¤å’ŒåŒç§å¤šèšåºåˆ—æ—¶æœ‰æ½œåœ¨å›°éš¾ï¼›</td></tr><tr><td>ç¬¬ä¸‰ä»£</td><td>ç‰›æ´¥çº³ç±³å­”å…¬å¸</td><td>gridION</td><td>çº³ç±³å­”å¤–åˆ‡é…¶æµ‹åº</td><td>ç”µæµ</td><td>å°šæœªå®šé‡</td><td>æœ‰æ½œåŠ›è¾¾åˆ°é«˜è¯»é•¿ï¼›å¯ä»¥æˆæœ¬ç”Ÿäº§çº³ç±³å­”ï¼›æ— éœ€è§å…‰æ ‡è®°æˆ–å…‰å­¦æ‰‹æ®µ</td><td>åˆ‡æ–­çš„æ ¸è‹·é…¸å¯èƒ½è¢«è¯»é”™æ–¹å‘ï¼›éš¾äºç”Ÿäº§å‡ºå¸¦å¤šé‡å¹³è¡Œå­”çš„è£…ç½®</td></tr></tbody></table><hr><p>ref</p><p><a href="https://www.cnblogs.com/huangshujia/p/3233693.html">https://www.cnblogs.com/huangshujia/p/3233693.html</a></p><p><a href="http://www.biomarker.com.cn/technology-services/denovo3">http://www.biomarker.com.cn/technology-services/denovo3</a></p><p><a href="https://zhuanlan.zhihu.com/p/339875837">https://zhuanlan.zhihu.com/p/339875837</a></p>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>assembly</title>
    <link href="/GeekFocus/2022/02/19/2022-02-19_assembly/"/>
    <url>/GeekFocus/2022/02/19/2022-02-19_assembly/</url>
    
    <content type="html"><![CDATA[<p>Pacbio</p><span id="more"></span><p><a href="https://www.bilibili.com/video/BV1pD4y1R7nK">https://www.bilibili.com/video/BV1pD4y1R7nK</a></p><h1 id="1ç›®æ ‡ï¼Œç°çŠ¶å’Œå½±å“å› ç´ "><a href="#1ç›®æ ‡ï¼Œç°çŠ¶å’Œå½±å“å› ç´ " class="headerlink" title="1ç›®æ ‡ï¼Œç°çŠ¶å’Œå½±å“å› ç´ "></a>1ç›®æ ‡ï¼Œç°çŠ¶å’Œå½±å“å› ç´ </h1><h2 id="è¿½æ±‚"><a href="#è¿½æ±‚" class="headerlink" title="è¿½æ±‚"></a>è¿½æ±‚</h2><p>åŸºå› ç»„ç»„è£…ï¼šè¿ç»­åº¦contigN50ï¼Œå‡†ç¡®åº¦ï¼Œé€Ÿåº¦ã€‚</p><p>ä»ªå™¨ï¼šPacbio</p><p>å®éªŒï¼šCLRï¼ŒCCSæ–‡åº“</p><p>è½¯ä»¶ï¼šCanuï¼ŒFalconï¼ŒSmartdenovoï¼ŒWTDBG</p><h2 id="æŒ‘æˆ˜"><a href="#æŒ‘æˆ˜" class="headerlink" title="æŒ‘æˆ˜"></a>æŒ‘æˆ˜</h2><p>å¤æ‚åº¦ï¼šåŸºå› ç»„é‡å¤åº¦ï¼Œæ‚åˆåº¦ã€‚<strong>Survey</strong></p><p>æ•°æ®é‡ï¼šCLRï¼š100Xå·¦å³ï¼›HIFIï¼š25Xï¼ˆçº é”™åï¼‰</p><p>ç®—æ³•æ˜¯å¦åˆé€‚ï¼šOLCï¼ŒDBG</p><p>æ•°æ®è´¨é‡ï¼šPacbioï¼šç¢±åŸºè´¨é‡ï¼ˆçº é”™CDSï¼ŸQ40ï¼Ÿï¼‰ï¼›ONTï¼šåºåˆ—é•¿åº¦</p><h1 id="2åŸºå› ç»„ç»„è£…çš„è½¯ä»¶ä½¿ç”¨æ–¹æ³•"><a href="#2åŸºå› ç»„ç»„è£…çš„è½¯ä»¶ä½¿ç”¨æ–¹æ³•" class="headerlink" title="2åŸºå› ç»„ç»„è£…çš„è½¯ä»¶ä½¿ç”¨æ–¹æ³•"></a>2åŸºå› ç»„ç»„è£…çš„è½¯ä»¶ä½¿ç”¨æ–¹æ³•</h1><h2 id="ç»„è£…è½¯ä»¶"><a href="#ç»„è£…è½¯ä»¶" class="headerlink" title="ç»„è£…è½¯ä»¶"></a>ç»„è£…è½¯ä»¶</h2><ul><li>Canuï¼šä¸‰ä»£æ•°æ®ä¸»æµè½¯ä»¶ï¼Œå…·æœ‰çº é”™ï¼Œä¿®æ­£å’Œç»„è£…åŠŸèƒ½</li></ul><p>æ¯”è¾ƒæ…¢ï¼Œå‡†ç¡®åº¦é«˜ï¼Œè¿ç»­åº¦è¡¨ç°ä¼˜ç§€çš„æ¦‚ç‡é«˜</p><ul><li>Falconï¼šPBå…¬å¸æ¨èï¼Œå¯ç”¨äºæ‚åˆåº¦è¾ƒé«˜æˆ–äº²ç¼˜å…³ç³»è¾ƒè¿œç‰©ç§ç»„è£…</li></ul><p>é€‚åˆä¸€å®šçš„æ‚åˆåŸºå› ç»„ï¼Œå¯ä»¥è£…å‡ºhaplotypeåŒºåŸŸï¼Œä¸€å®šæ‚åˆçš„åŸºå› å¯ä»¥åˆ©ç”¨hicæ•°æ®è¿›è¡ŒMbçº§åˆ«çš„phasing</p><ul><li>Smart Denovoé€‚ç”¨PBå’ŒONTï¼Œæ— çº é”™</li><li>WTDBGï¼šå†…å­˜åŠå­˜å‚¨å ç”¨å°‘ï¼Œé€Ÿåº¦å¿«</li></ul><p>é€Ÿåº¦å¿«ï¼Œå¯¹é‡å¤åºåˆ—æ•æ„Ÿï¼Œç®€å•åŸºå› ç»„ç»„è£…æ•ˆæœæ¯”è¾ƒå¥½</p><ul><li>Hifiasmï¼šé€‚ç”¨HiFiã€‚é€Ÿåº¦å¿«ï¼Œè¿ç»­åº¦é«˜ï¼Œå®Œæ•´æ€§é«˜</li><li>HiCanuï¼šé€‚ç”¨HiFi</li><li>æ ¹æ®åŸºå› ç»„ç‰¹å¾ï¼Œé€‰æ‹©åˆé€‚è½¯ä»¶è¿›è¡Œç»„è£…æˆ–è€…å¤šè½¯ä»¶é…åˆä½¿ç”¨ç»„è£…è·å¾—é«˜è´¨é‡ç‰©ç§åŸºå› ç»„</li></ul><h2 id="è¯„ä¼°è½¯ä»¶"><a href="#è¯„ä¼°è½¯ä»¶" class="headerlink" title="è¯„ä¼°è½¯ä»¶"></a>è¯„ä¼°è½¯ä»¶</h2><ul><li>BUSCO</li><li></li></ul><h1 id="3è¶…å¤§åŸºå› ç»„çš„ç»„è£…ç»éªŒ"><a href="#3è¶…å¤§åŸºå› ç»„çš„ç»„è£…ç»éªŒ" class="headerlink" title="3è¶…å¤§åŸºå› ç»„çš„ç»„è£…ç»éªŒ"></a>3è¶…å¤§åŸºå› ç»„çš„ç»„è£…ç»éªŒ</h1><p>æ•°æ®é‡å¤§ï¼šè¿ç®—é‡å¤§ï¼Œè½¯ä»¶é€‚åº”æ€§ï¼Œç»„è£…ç»“æœï¼Œå­˜å‚¨éœ€æ±‚</p><h1 id="4åŸºå› ç»„ç»„è£…å±•æœ›"><a href="#4åŸºå› ç»„ç»„è£…å±•æœ›" class="headerlink" title="4åŸºå› ç»„ç»„è£…å±•æœ›"></a>4åŸºå› ç»„ç»„è£…å±•æœ›</h1><p>CSSç»„è£…ï¼Œæœªæ¥è¶‹åŠ¿ã€‚</p><hr><h1 id="ä¸‰ä»£æ•°æ®é¢„å¤„ç†"><a href="#ä¸‰ä»£æ•°æ®é¢„å¤„ç†" class="headerlink" title="ä¸‰ä»£æ•°æ®é¢„å¤„ç†"></a>ä¸‰ä»£æ•°æ®é¢„å¤„ç†</h1><h2 id="äº†è§£ä¸‰ä»£æ•°æ®é¢„å¤„ç†ä¸­çš„è¾“å…¥å’Œè¾“å‡ºæ•°æ®"><a href="#äº†è§£ä¸‰ä»£æ•°æ®é¢„å¤„ç†ä¸­çš„è¾“å…¥å’Œè¾“å‡ºæ•°æ®" class="headerlink" title="äº†è§£ä¸‰ä»£æ•°æ®é¢„å¤„ç†ä¸­çš„è¾“å…¥å’Œè¾“å‡ºæ•°æ®"></a>äº†è§£ä¸‰ä»£æ•°æ®é¢„å¤„ç†ä¸­çš„è¾“å…¥å’Œè¾“å‡ºæ•°æ®</h2><h2 id="ä¸‰ä»£ä¸Šæœºæ–‡åº“ç®€ä»‹"><a href="#ä¸‰ä»£ä¸Šæœºæ–‡åº“ç®€ä»‹" class="headerlink" title="ä¸‰ä»£ä¸Šæœºæ–‡åº“ç®€ä»‹"></a>ä¸‰ä»£ä¸Šæœºæ–‡åº“ç®€ä»‹</h2><h2 id="äº†è§£æ•°æ®è´¨é‡çŸ«æ­£çš„æ–¹æ³•"><a href="#äº†è§£æ•°æ®è´¨é‡çŸ«æ­£çš„æ–¹æ³•" class="headerlink" title="äº†è§£æ•°æ®è´¨é‡çŸ«æ­£çš„æ–¹æ³•"></a>äº†è§£æ•°æ®è´¨é‡çŸ«æ­£çš„æ–¹æ³•</h2><h2 id="å¦‚ä½•è¯„ä»·æ•°æ®è´¨é‡å’Œæœ‰æ•ˆäº§å‡ºæ¯”"><a href="#å¦‚ä½•è¯„ä»·æ•°æ®è´¨é‡å’Œæœ‰æ•ˆäº§å‡ºæ¯”" class="headerlink" title="å¦‚ä½•è¯„ä»·æ•°æ®è´¨é‡å’Œæœ‰æ•ˆäº§å‡ºæ¯”"></a>å¦‚ä½•è¯„ä»·æ•°æ®è´¨é‡å’Œæœ‰æ•ˆäº§å‡ºæ¯”</h2>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ggplot2</title>
    <link href="/GeekFocus/2022/02/18/2022-02-18-ggplot2/"/>
    <url>/GeekFocus/2022/02/18/2022-02-18-ggplot2/</url>
    
    <content type="html"><![CDATA[<p>Ggplot2</p><span id="more"></span><p>reorderé™åºå®ç°(åŠ **<font color="red">-</font>**å·)ï¼š</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs R">ggplot<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">,</span>aes<span class="hljs-punctuation">(</span>x<span class="hljs-operator">=</span>reorder<span class="hljs-punctuation">(</span>v1<span class="hljs-punctuation">,</span>v2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>y<span class="hljs-operator">=</span>v2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span>genom_bar<span class="hljs-punctuation">(</span>stat <span class="hljs-operator">=</span> <span class="hljs-string">&quot;identity&quot;</span><span class="hljs-punctuation">)</span><br><br>ggplot<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">,</span>aes<span class="hljs-punctuation">(</span>x<span class="hljs-operator">=</span>reorder<span class="hljs-punctuation">(</span>v1<span class="hljs-punctuation">,</span><span class="hljs-operator">-</span>v2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>y<span class="hljs-operator">=</span>v2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span>genom_bar<span class="hljs-punctuation">(</span>stat <span class="hljs-operator">=</span> <span class="hljs-string">&quot;identity&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ggplot2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æŸ“è‰²è´¨ä¸‰ç»´ç»“æ„å›¾è°± Hi-C</title>
    <link href="/GeekFocus/2022/02/16/2022-02-16-chromosome-structure-Hi-C/"/>
    <url>/GeekFocus/2022/02/16/2022-02-16-chromosome-structure-Hi-C/</url>
    
    <content type="html"><![CDATA[<h1 id="Hi-CæŠ€æœ¯ï¼Œä»¥é«˜é€šé‡æµ‹åºä¸ºæ‰‹æ®µï¼Œä»¥3CæŠ€æœ¯ä¸ºåŸºç¡€çš„æŸ“è‰²è´¨æ„è±¡æ•æ‰æŠ€æœ¯ã€‚-ä¸‰ç»´åŸºå› ç»„ã€‚"><a href="#Hi-CæŠ€æœ¯ï¼Œä»¥é«˜é€šé‡æµ‹åºä¸ºæ‰‹æ®µï¼Œä»¥3CæŠ€æœ¯ä¸ºåŸºç¡€çš„æŸ“è‰²è´¨æ„è±¡æ•æ‰æŠ€æœ¯ã€‚-ä¸‰ç»´åŸºå› ç»„ã€‚" class="headerlink" title="Hi-CæŠ€æœ¯ï¼Œä»¥é«˜é€šé‡æµ‹åºä¸ºæ‰‹æ®µï¼Œä»¥3CæŠ€æœ¯ä¸ºåŸºç¡€çš„æŸ“è‰²è´¨æ„è±¡æ•æ‰æŠ€æœ¯ã€‚-ä¸‰ç»´åŸºå› ç»„ã€‚"></a>Hi-CæŠ€æœ¯ï¼Œä»¥é«˜é€šé‡æµ‹åºä¸ºæ‰‹æ®µï¼Œä»¥3CæŠ€æœ¯ä¸ºåŸºç¡€çš„æŸ“è‰²è´¨æ„è±¡æ•æ‰æŠ€æœ¯ã€‚-ä¸‰ç»´åŸºå› ç»„ã€‚</h1><span id="more"></span><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/0.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/0.png" alt="img"></p><h1 id="1-CæŠ€æœ¯"><a href="#1-CæŠ€æœ¯" class="headerlink" title="1. CæŠ€æœ¯"></a>1. CæŠ€æœ¯</h1><h2 id="1-1-3Cï¼ˆä¸€å¯¹ä¸€ï¼‰"><a href="#1-1-3Cï¼ˆä¸€å¯¹ä¸€ï¼‰" class="headerlink" title="1.1 3Cï¼ˆä¸€å¯¹ä¸€ï¼‰"></a>1.1 3Cï¼ˆä¸€å¯¹ä¸€ï¼‰</h2><ul><li><p>åŸºå› ç»„æ•è·æŠ€æœ¯ï¼ˆChromosome conformation captureï¼Œ3Cï¼‰æ˜¯æœ€æ—©ç ”ç©¶ä¸‰ç»´åŸºå› ç»„çš„æŠ€æœ¯ï¼Œéœ€è¦<font color="green">æå‰çŸ¥é“äº’ä½œåŒºåŸŸ</font>ï¼Œæ‰èƒ½<font color="green">é‡åŒ–ä¸€å¯¹åŸºå› ç»„åŸºå› åº§ä¹‹é—´çš„äº’ä½œ</font>ã€‚</p></li><li><p>3CæŠ€æœ¯2002å¹´Dekeræå‡ºï¼Œç›®çš„æ•è·æŸ“è‰²ä½“çš„interactionï¼Œå‡è®¾æŸ“è‰²ä½“ä¸­çš„interactionä»¥è›‹ç™½ä¸ºä»‹å¯¼ã€‚é€šè¿‡é™åˆ¶é…¶é…¶åˆ‡ï¼Œè¡¥å¹³ï¼Œè¿æ¥ï¼Œæ‰“æ–­ï¼ŒPCRåï¼Œè‹¥æŸ“è‰²ä½“Aï¼ŒBä¸¤ç‚¹ç›¸äº’ä½œç”¨ï¼Œæ ¹æ®è¿™ä¸¤ç‚¹ç‰¹å¼‚åºåˆ—çš„å¼•ç‰©èƒ½PCRå‡ºäº§ç‰©ï¼ŒéªŒè¯interactionã€‚æ¯<font color="green">ä¸€å¯¹ä½ç‚¹çš„éªŒè¯</font>éœ€è¦<font color="green">è®¾è®¡ä¸€å¯¹ç‰¹å¼‚æ€§å¼•ç‰©</font>ã€‚</p></li></ul><h2 id="1-2-4Cï¼ˆä¸€å¯¹å¤šï¼‰"><a href="#1-2-4Cï¼ˆä¸€å¯¹å¤šï¼‰" class="headerlink" title="1.2 4Cï¼ˆä¸€å¯¹å¤šï¼‰"></a>1.2 4Cï¼ˆä¸€å¯¹å¤šï¼‰</h2><ul><li><p>æŸ“è‰²ä½“æ„è±¡æ•è·èŠ¯ç‰‡ï¼ˆChromosome conformation capture-on-chipï¼Œ4C ï¼‰ï¼Œå¯ä»¥æ•è·<font color="green">ä¸€ä¸ªåŸºå› åŒºåŸŸ</font>å’Œå…¶ä»–åŒºåŸŸé—´çš„äº’ç›¸ä½œç”¨ã€‚è¯¥æŠ€æœ¯ä¸éœ€è¦çŸ¥é“ä½œç”¨åŒºåŸŸçš„å…ˆéªŒçŸ¥è¯†å°±å¯ä»¥ä½¿ç”¨ã€‚</p></li><li><p>3Cè¾ƒéº»çƒ¦ï¼Œåè®¾è®¡åŒé…¶åˆ‡ä½ç‚¹ï¼Œç„¶å<font color="green">æˆç¯</font>ï¼Œä¿è¯åªéœ€è¦è®¾è®¡ä¸€å¯¹å¼•ç‰©å°±å¯ä»¥æ£€æµ‹ä¸€ä¸ªä½ç‚¹å¯¹å¤šä¸ªä½ç‚¹çš„ç›¸äº’ä½œç”¨ï¼Œ4Cæœ‰circleçš„æ„æ€ã€‚</p></li></ul><h2 id="1-3-5Cï¼ˆå¤šå¯¹å¤šï¼‰"><a href="#1-3-5Cï¼ˆå¤šå¯¹å¤šï¼‰" class="headerlink" title="1.3 5Cï¼ˆå¤šå¯¹å¤šï¼‰"></a>1.3 5Cï¼ˆå¤šå¯¹å¤šï¼‰</h2><p>æŸ“è‰²ä½“æ„è±¡æ•è·ç¢³æ‹·è´ï¼ˆChromosome conformation capture carbon copyï¼Œ5Cï¼‰ ï¼Œå¯ä»¥æ£€æµ‹<font color="green">æŸæ®µåŒºåŸŸå†…æ‰€æœ‰çš„äº’ä½œ</font>ï¼Œä½†æ˜¯è¯¥<font color="red">åŒºåŸŸä¸€èˆ¬&lt;1 Mb</font>ã€‚è¦†ç›–åº¦é—®é¢˜é€ æˆè¯¥æŠ€æœ¯<font color="green">ä¸é€‚ç”¨äºå…¨åŸºå› ç»„æµ‹åº</font>ã€‚</p><h2 id="1-4-Hi-Cï¼ˆå…¨éƒ¨äº’ä½œï¼‰"><a href="#1-4-Hi-Cï¼ˆå…¨éƒ¨äº’ä½œï¼‰" class="headerlink" title="1.4 Hi-Cï¼ˆå…¨éƒ¨äº’ä½œï¼‰"></a>1.4 <font color="red">Hi-Cï¼ˆå…¨éƒ¨äº’ä½œï¼‰</font></h2><ul><li><p>é«˜é€šé‡åŸºå› ç»„æ•è·æŠ€æœ¯ï¼ˆHigh-throughput&#x2F;resolution chromosome conformation captureï¼‰ï¼ŒåŸºæœ¬è§£å†³äº†ä¸Šè¿°æŠ€æœ¯çš„ç¼ºç‚¹ï¼Œå¯ä»¥å®ç°<font color="green">å…¨åŸºå› ç»„è¦†ç›–</font>æ£€æµ‹<font color="green">å…¨éƒ¨æœªçŸ¥äº’ä½œåŒºåŸŸ</font>ã€‚</p></li><li><p>Hi-CåŸºæœ¬æ­¥éª¤ï¼Œç”²é†›äº¤è”ï¼Œé™åˆ¶é…¶åˆ‡ï¼Œæœ«ç«¯è¡¥å¹³åŠ biotinï¼Œå¹³æœ«ç«¯è¿æ¥ï¼Œè¶…å£°ç ´ç¢ï¼Œbiotinå¯Œé›†ï¼Œå»ºåº“æµ‹åºã€‚æ•´ä¸ªè¿‡ç¨‹æ²¡æœ‰ç‰¹å¼‚å¼•ç‰©å­˜åœ¨ã€‚</p></li><li><p>å°†çº¿æ€§è·ç¦»è¿œï¼Œç©ºé—´ç»“æ„è¿‘çš„DNAç‰‡æ®µè¿›è¡Œäº¤è”ï¼Œå¹¶å°†äº¤è”çš„DNAç‰‡æ®µå¯Œé›†ï¼Œé«˜é€šé‡æµ‹åºï¼Œå¯¹æµ‹åºæ•°æ®åˆ†æå¯ä»¥æ­ç¤ºæŸ“è‰²è´¨çš„è¿œç¨‹äº’ä½œï¼Œæ¨å¯¼å‡ºåŸºå› ç»„çš„ä¸‰ç»´ç©ºé—´ç»“æ„çš„å¯èƒ½çš„è®°å¿†ä¹‹é—´çš„è°ƒæ§å…³ç³»ã€‚</p></li><li><p>\1. é€šè¿‡Scaffoldé—´çš„äº¤äº’é¢‘ç‡å¤§å°ï¼Œå¯ä»¥å¯¹å·²ç»„è£…çš„åŸºå› ç»„åºåˆ—è¿›è¡Œçº é”™ï¼ˆåŸºå› ç»„æ›´å‡†ç¡®ï¼‰ã€‚</p><p>\2. åŸºå› ä¿¡æ¯ä¸å†ä»…ä»…æ˜¯contigç‰‡æ®µï¼Œè€Œæ˜¯è¢«åˆ’åˆ†è‡³æŸ“è‰²ä½“ä¸Šï¼Œæˆä¸ºæŸ“è‰²ä½“æ°´å¹³ã€‚</p><p>\3. æ— éœ€è¾›è‹¦çš„æ„å»ºç¾¤ä½“ï¼Œå•ä¸€ä¸€ä¸ªä½“å°±èƒ½å®ç°æŸ“è‰²ä½“å®šä½ã€‚</p><p>\4. ç›¸æ¯”é—ä¼ å›¾è°±ï¼Œæ ‡è®°å¯†åº¦æ›´å¤§ï¼Œåºåˆ—å®šä½æ›´å®Œæ•´ï¼ˆèƒ½æŠŠæ›´å¤šçš„contigæŒ‚è‡³æŸ“è‰²ä½“ä¸Š!ä¿¡æ¯æ›´å…¨é¢ï¼ï¼‰</p><p>\5. æŸ“è‰²ä½“é‡æ’ç­‰ç»“æ„å˜å¼‚ç ”ç©¶å¯ä»¥å¼€å±•å•¦~(ç ”ç©¶å¯ä»¥æ›´æ·±å…¥ï¼ï¼‰</p><p>\6. QTLã€GWASå¯ä»¥å®šä½åŒºé—´åˆ°æŸä¸ªæŸ“è‰²ä½“å•¦~ï¼ˆè¿½è¸ªå˜å¼‚ï¼ï¼‰</p><p>\7. è¯¥ç‰©ç§çš„ä¸‰ç»´åŸºå› ç»“æ„ã€æŸ“è‰²ä½“äº’ä½œåŠåŠ¨æ€å˜åŒ–å¯ä»¥è§£æå•¦~ï¼ˆä»åŸºå› åˆ°è¡¨è§‚ï¼å…¨æ–¹ä½è§£æï¼‰</p></li></ul><h2 id="1-5-ChIP-loop-åŸºäºå…ç–«æ²‰æ·€"><a href="#1-5-ChIP-loop-åŸºäºå…ç–«æ²‰æ·€" class="headerlink" title="1.5 ChIP-loop (åŸºäºå…ç–«æ²‰æ·€)"></a>1.5 ChIP-loop (åŸºäºå…ç–«æ²‰æ·€)</h2><p>è¯¥æŠ€æœ¯å°† 3C ä¸ ChIP-seq ç»“åˆï¼Œå¯ä»¥æ£€æµ‹<font color="red">ç›®çš„è›‹ç™½è´¨ä»‹å¯¼</font>çš„<font color="red">ä¸¤ä¸ªç›®çš„åŸºå› åŒºåŸŸäº’ä½œ</font>ã€‚</p><h2 id="1-6-ChIA-PET-åŸºäºå…ç–«æ²‰æ·€"><a href="#1-6-ChIA-PET-åŸºäºå…ç–«æ²‰æ·€" class="headerlink" title="1.6 ChIA-PET (åŸºäºå…ç–«æ²‰æ·€)"></a>1.6 ChIA-PET (åŸºäºå…ç–«æ²‰æ·€)</h2><p>è¯¥æŠ€æœ¯å°† HiC ä¸ ChIP-seq ç»“åˆï¼Œå¯ä»¥æ£€æµ‹<font color="red">ç›®çš„è›‹ç™½è´¨çš„æ‰€æœ‰äº’ç›¸ä½œç”¨</font>ã€‚ ç”¨ç‰¹å¼‚æ€§æŠ—ä½“å¯Œé›†interactionä¿¡æ¯ï¼Œæ¯”å¦‚CTCFï¼Œpol IIæŠ—ä½“ï¼Œç±»ä¼¼æ­¥éª¤å»ºåº“æµ‹åºã€‚<font color="red">ChIA-PETæ•°æ®æ˜¯Hi-Cæ•°æ®çš„å­é›†</font>ã€‚</p><hr><table><thead><tr><th></th><th>äº’ä½œ</th><th>è¦†ç›–</th><th>ä½œç”¨</th><th>ç ”ç©¶åº”ç”¨</th></tr></thead><tbody><tr><td>3C</td><td>å•å¯¹å•</td><td>&lt;1Mb</td><td>æ£€æµ‹å·²çŸ¥<font color="red">åŸºå› ç»„åŸºå› åŒºåŸŸä¹‹é—´</font>çš„äº’ä½œ</td><td>ç¡®å®šå·²çŸ¥å¯åŠ¨å­å’Œå¢å¼ºå­ä¹‹é—´çš„äº’ä½œ</td></tr><tr><td>4C</td><td>ä¸€å¯¹å¤š</td><td>å…¨åŸºå› ç»„</td><td>ç¡®å®š<font color="red">åŸºå› æŸç»„åŒºåŸŸ</font>ä¸<font color="red">å…¶ä»–åŒºåŸŸçš„äº’ä½œ</font></td><td>ä¸å·²çŸ¥LCR(locus control regions)åŒºäº’ä½œçš„å…¨éƒ¨åŸºå› å’Œå…ƒä»¶</td></tr><tr><td>5C</td><td>å¤šå¯¹å¤š</td><td>&lt;1Mb</td><td>ç¡®å®š<font color="red">æŸ“è‰²ä½“ç‰¹å®šåŒºåŸŸ</font>çš„å…¨éƒ¨é«˜çº§ç»“æ„</td><td>ç¡®å®šæŸ“è‰²ä½“ç‰¹å®šåŒºåŸŸçš„å…¨éƒ¨é«˜çº§ç»“æ„</td></tr><tr><td>Hi-C</td><td>å…¨éƒ¨äº’ä½œ</td><td>å…¨åŸºå› ç»„</td><td>æ£€æµ‹<font color="red">å…¨åŸºå› ç»„</font>èŒƒå›´çš„<font color="red">å…¨éƒ¨é«˜çº§ç»“æ„</font></td><td>å…¨åŸºå› ç»„èŒƒå›´æ‰€æœ‰æŸ“è‰²ä½“äº’ä½œ</td></tr><tr><td>ChIP-loop</td><td>ä¸€å¯¹ä¸€</td><td>&lt;1Mb</td><td>æ£€æµ‹ç›®çš„è›‹ç™½ä»‹å¯¼çš„<font color="red">ä¸¤ä¸ªç›®çš„åŸºå› åŒºåŸŸäº’ä½œ</font></td><td></td></tr><tr><td>ChIA-PET</td><td>å…¨éƒ¨äº’ä½œ</td><td>å…¨åŸºå› ç»„</td><td>æ£€æµ‹<font color="red">ç›®çš„è›‹ç™½è´¨çš„æ‰€æœ‰äº’ä½œ</font></td><td>æ„å»ºå·²çŸ¥è½¬å½•å› å­ä»‹å¯¼çš„æŸ“è‰²è´¨äº’ä½œ</td></tr></tbody></table><hr><h1 id="2-æŠ€æœ¯åŸç†"><a href="#2-æŠ€æœ¯åŸç†" class="headerlink" title="2. æŠ€æœ¯åŸç†"></a>2. æŠ€æœ¯åŸç†</h1><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/1.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/1.png" alt="img"></p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/8.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/8.png" alt="img"></p><h2 id="2-1-ç”²é†›å›ºå®š"><a href="#2-1-ç”²é†›å›ºå®š" class="headerlink" title="2.1 ç”²é†›å›ºå®š"></a>2.1 ç”²é†›å›ºå®š</h2><p>å…ˆåŠ å…¥ç”²é†›å°†åŸºå› ç»„ä¸­å‚ä¸<font color="red">æŸ“è‰²è´¨äº’ä½œçš„è›‹ç™½è´¨å‡å›º</font>ã€‚ä¸€èˆ¬å°†æ´»ä½“æ ·æœ¬åœ¨å®¤æ¸©ç”¨ 1-3%çš„ç”²é†›å¤„ç† 10-30minï¼Œä½†æ˜¯æ­¤æ­¥éª¤ä¼š<font color="green">å‡å°‘é™åˆ¶å†…åˆ‡é…¶</font>å¯¹DNAåºåˆ—çš„æ¶ˆåŒ–<font color="green">æ•ˆç‡</font>ï¼Œéœ€è¦ä¸¥æ ¼æ§åˆ¶ã€‚</p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/2.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/2.png" alt="img"></p><h2 id="2-2-é…¶åˆ‡åºåˆ—"><a href="#2-2-é…¶åˆ‡åºåˆ—" class="headerlink" title="2.2 é…¶åˆ‡åºåˆ—"></a>2.2 é…¶åˆ‡åºåˆ—</h2><p>ç”¨é™åˆ¶æ€§å†…åˆ‡é…¶åˆ‡å‰²åŸºå› ç»„ï¼Œæ‰“æ–­åçš„ç‰‡æ®µå¤§å°ä¼šå½±å“æµ‹åºåˆ†è¾¨ç‡ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§é…¶å¯ä¾›é€‰æ‹©ï¼š6bp çš„é™åˆ¶æ€§å†…åˆ‡é…¶ï¼Œ4bp çš„é™åˆ¶æ€§å†…åˆ‡é…¶ã€‚åè€…å…·æœ‰æ›´é«˜çš„åˆ†è¾¨ç‡ã€‚EcoR1 æˆ– HindIII ç”¨äºæ¯4000bpåˆ‡å‰²ä¸€æ¬¡åŸºå› ç»„ï¼Œåœ¨äººç±»åŸºå› ç»„ä¸­äº§ç”Ÿçº¦100ä¸‡ä¸ªç‰‡æ®µã€‚<br><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/3.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/3.png" alt="img"></p><h2 id="2-3-æœ«ç«¯ä¿®å¤"><a href="#2-3-æœ«ç«¯ä¿®å¤" class="headerlink" title="2.3 æœ«ç«¯ä¿®å¤"></a>2.3 æœ«ç«¯ä¿®å¤</h2><p>å¾—åˆ°çš„ç‰‡æ®µå…·æœ‰å¹³æœ«ç«¯æˆ–ç²˜æ€§æœ«ç«¯ï¼Œç„¶åå°†<font color="red">æœ«ç«¯è¡¥å¹³ä¿®å¤ï¼ŒåŠ å…¥ç”Ÿç‰©ç´ </font>ã€‚ã€ç”Ÿç‰©ç´ pull-downä¿è¯åªæœ‰è¿æ¥çš„éƒ¨åˆ†ç”¨äºåˆ†æã€‚è¯»é•¿readsè¢«å®šä½åˆ°åŸºå› ç»„ä¸Šï¼Œå½“è¿™ä¸€å¯¹è¯»é•¿å‘ç°åœ¨ä¸åŒç‰‡æ®µä¸Šçš„æ—¶å€™ï¼Œå¯¹<font color="red">äº’ä½œç‰‡æ®µè¿›è¡Œç›¸åº”è¯„åˆ†</font>ã€‚ä¸€ä¸ªåŒ…å«åŸºå› ç»„æ‰€æœ‰ç‰‡æ®µçš„<font color="red">è¿æ¥é¢‘ç‡çŸ©é˜µè¢«æ„å»º</font>ã€‚ã€‘</p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/4.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/4.png" alt="img"></p><h2 id="2-4-è¿æ¥åŠè§£äº¤è”"><a href="#2-4-è¿æ¥åŠè§£äº¤è”" class="headerlink" title="2.4 è¿æ¥åŠè§£äº¤è”"></a>2.4 è¿æ¥åŠè§£äº¤è”</h2><p>ä½¿ç”¨ <font color="red">T4 DNAè¿æ¥é…¶è¿æ¥äº’ä½œç‰‡æ®µå½¢æˆç¯çŠ¶</font>ã€‚å°†è¿æ¥DNAç‰‡æ®µçš„<font color="red">è›‹ç™½è´¨æ¶ˆåŒ–æ‰</font>ï¼Œå¾—åˆ°äº¤è”ç‰‡æ®µã€‚</p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/5.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/5.png" alt="img"></p><h2 id="2-5-åºåˆ—æ‰“æ–­"><a href="#2-5-åºåˆ—æ‰“æ–­" class="headerlink" title="2.5 åºåˆ—æ‰“æ–­"></a>2.5 åºåˆ—æ‰“æ–­</h2><p>ä½¿ç”¨è¶…å£°æ³¢æˆ–å…¶ä»–æ–¹å¼ï¼Œå†æ¬¡æ‰“æ–­ç‰‡æ®µã€‚</p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/6.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/6.png" alt="img"></p><h2 id="2-6-ä¸Šæœºæµ‹åº"><a href="#2-6-ä¸Šæœºæµ‹åº" class="headerlink" title="2.6 ä¸Šæœºæµ‹åº"></a>2.6 ä¸Šæœºæµ‹åº</h2><p>ç”¨<font color="red">ç£ç å°†å¸¦ç”Ÿç‰©ç´ çš„æ•è·</font>ï¼Œåˆ¶ä½œæ–‡åº“ï¼Œä¸Šæœºæµ‹åºã€‚</p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/7.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/7.png" alt="img"></p><h1 id="3-Hi-Cåº”ç”¨"><a href="#3-Hi-Cåº”ç”¨" class="headerlink" title="3. Hi-Cåº”ç”¨"></a>3. Hi-Cåº”ç”¨</h1><ul><li><font color="red">é‡åŒ–</font>åœ¨ä¸‰ç»´ç©ºé—´ä¸­åŸºå› ç»„çš„<font color="red">æŸ“è‰²è´¨é—´äº¤è”</font>ï¼ˆcross-linked chromatin ï¼‰</li><li>è§£æ<font color="red">å…¨åŸºå› ç»„äº’ä½œ<strong>æ¨¡å¼</strong></font>ï¼Œå¦‚<font color="red">å¯åŠ¨å­å’Œå¢å¼ºå­äº’ä½œ</font></li><li>æ„å»º<font color="red">ä¸‰ç»´ç©ºé—´ç»“æ„<strong>æ¨¡å‹</strong></font>ï¼Œå¦‚ç ”ç©¶åŸºå› ç»„ä¸‰ç»´ç»“æ„ç‰¹å¾ï¼š<strong>compartmentï¼ŒTADï¼Œloop</strong>ç­‰</li><li>æ„å»º<font color="red">å…¨åŸºå› ç»„äº’ä½œ<strong>å›¾è°±</strong></font></li><li><font color="red">è¾…åŠ©æå‡<strong>åŸºå› ç»„ç»„è£…</strong></font></li><li>æ„å»º<font color="red">åŸºå› ç»„<strong>å•ä½“å‹å›¾è°±</strong></font></li></ul><h1 id="4-åˆ†ææµç¨‹"><a href="#4-åˆ†ææµç¨‹" class="headerlink" title="4. åˆ†ææµç¨‹"></a>4. åˆ†ææµç¨‹</h1><h2 id="4-1-åŸºæœ¬åˆ†æ"><a href="#4-1-åŸºæœ¬åˆ†æ" class="headerlink" title="4.1 åŸºæœ¬åˆ†æ"></a>4.1 åŸºæœ¬åˆ†æ</h2><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/9.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/9.png" alt="img"></p><p>Ferhat Ay et al;2015</p><ul><li>(a)é¦–å…ˆæ˜¯<font color="green">è´¨æ§</font>ï¼Œè¿‡æ»¤åé«˜è´¨é‡çš„FASTQæ•°æ®ï¼ˆPEï¼Œ150bpï¼‰ï¼Œå¦‚æœæ¯”å¯¹è½¯ä»¶<font color="red">ä¸æ”¯æŒsplit mapping</font>ï¼Œä¸€èˆ¬é€‰ç”¨<font color="red">è¿­ä»£æ¯”å¯¹</font>ï¼Œå› ä¸ºè¿æ¥å¤„ç”±äºæ˜¯åŸºå› ç»„å¤–çš„ç¢±åŸºï¼Œå¯èƒ½æ¯”å¯¹ä¸ä¸Šã€‚<strong>ä»åºåˆ—å·¦ç«¯25bpå¼€å§‹æ¯”å¯¹ï¼Œå¦‚æœæœ‰å”¯ä¸€æ¯”å¯¹ï¼Œåˆ™åœæ­¢ï¼Œå¦‚æœå¤šä¸ªæ¯”å¯¹ä½ç½®ï¼Œåˆ™å†ç»§ç»­å»¶ä¼¸5bpï¼Œç›´åˆ°å‡ºç°å”¯ä¸€æ¯”å¯¹</strong>ã€‚æˆ–é€‰æ‹©<strong>æ”¯æŒsplit mappingçš„è½¯ä»¶è¿›è¡Œæ¯”å¯¹</strong>ï¼Œå¯ä»¥é€šè¿‡<strong>åˆ†æ®µæ¯”å¯¹å¤„ç†</strong>ã€‚</li><li>(b)é€‰æ‹©é«˜è´¨é‡çš„æ¯”å¯¹æ•°æ®</li><li>(c)HiCç‰¹å¼‚çš„<font color="green">æ¯”å¯¹æ ‡å‡†</font></li><li>(d)å¯¹Vaild pairsè¿›è¡Œ<font color="green">çŸ«æ­£</font>ã€‚çŸ«æ­£å®Œå¯ä»¥å¾—åˆ°<font color="green">äº’ä½œçŸ©é˜µ</font>ã€‚</li></ul><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/10.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/10.png" alt="img"></p><p>Bryan R. Lajoie et al;2014</p><h2 id="4-2-Hi-Cå¯è§†åŒ–"><a href="#4-2-Hi-Cå¯è§†åŒ–" class="headerlink" title="4.2 Hi-Cå¯è§†åŒ–"></a>4.2 Hi-Cå¯è§†åŒ–</h2><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/11.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/11.png" alt="img"></p><h2 id="4-3-åºåˆ—è¿‡æ»¤"><a href="#4-3-åºåˆ—è¿‡æ»¤" class="headerlink" title="4.3 åºåˆ—è¿‡æ»¤"></a>4.3 åºåˆ—è¿‡æ»¤</h2><p>â€‹ <img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/12.png" alt="img"><br>â€‹ <img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/12.png" alt="img"></p><h2 id="4-4-æ•°æ®çŸ«æ­£"><a href="#4-4-æ•°æ®çŸ«æ­£" class="headerlink" title="4.4 æ•°æ®çŸ«æ­£"></a>4.4 æ•°æ®çŸ«æ­£</h2><p>â€‹ <img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/13.png" alt="img"><br>â€‹ <img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/13.png" alt="img"></p><p>Eitan Yaffe &amp; Amos Tanayï¼›2011</p><p>â€‹ <img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/14.png" alt="img"><br>â€‹ <img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/14.png" alt="img"></p><h1 id="5-åˆ†æ"><a href="#5-åˆ†æ" class="headerlink" title="5. åˆ†æ"></a>5. åˆ†æ</h1><h2 id="5-1-cis-x2F-transäº’ä½œæ¯”ä¾‹"><a href="#5-1-cis-x2F-transäº’ä½œæ¯”ä¾‹" class="headerlink" title="5.1 cis&#x2F;transäº’ä½œæ¯”ä¾‹"></a>5.1 cis&#x2F;transäº’ä½œæ¯”ä¾‹</h2><p>â€‹ <img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/15.png" alt="img"><br>â€‹ <img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/15.png" alt="img"></p><h2 id="5-2-äº’ä½œé¢‘ç‡ä¸è·ç¦»æœ‰å…³"><a href="#5-2-äº’ä½œé¢‘ç‡ä¸è·ç¦»æœ‰å…³" class="headerlink" title="5.2 äº’ä½œé¢‘ç‡ä¸è·ç¦»æœ‰å…³"></a>5.2 äº’ä½œé¢‘ç‡ä¸è·ç¦»æœ‰å…³</h2><p>â€‹ <img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/16.png" alt="img"><br>â€‹ <img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/16.png" alt="img"></p><h2 id="5-3-compartmentåˆ†æ"><a href="#5-3-compartmentåˆ†æ" class="headerlink" title="5.3 compartmentåˆ†æ"></a>5.3 compartmentåˆ†æ</h2><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/17.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/17.png" alt="img"></p><h2 id="5-4-TADåˆ†æ"><a href="#5-4-TADåˆ†æ" class="headerlink" title="5.4 TADåˆ†æ"></a>5.4 TADåˆ†æ</h2><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/18.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/18.png" alt="img"></p><p>Hi-Cè¾…åŠ©TADç»“æ„ç ”ç©¶ï¼ˆ<em>Wang et al</em>., Nature Commuications 2018ï¼‰</p><h2 id="5-5-æ˜¾è‘—äº’ä½œåˆ†æ"><a href="#5-5-æ˜¾è‘—äº’ä½œåˆ†æ" class="headerlink" title="5.5 æ˜¾è‘—äº’ä½œåˆ†æ"></a>5.5 æ˜¾è‘—äº’ä½œåˆ†æ</h2><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/19.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/19.png" alt="img"></p><h1 id="6-åº”ç”¨"><a href="#6-åº”ç”¨" class="headerlink" title="6. åº”ç”¨"></a>6. åº”ç”¨</h1><h2 id="6-1-è§£æå…¨åŸºå› ç»„äº’ä½œæ¨¡å¼"><a href="#6-1-è§£æå…¨åŸºå› ç»„äº’ä½œæ¨¡å¼" class="headerlink" title="6.1 è§£æå…¨åŸºå› ç»„äº’ä½œæ¨¡å¼"></a>6.1 è§£æå…¨åŸºå› ç»„äº’ä½œæ¨¡å¼</h2><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/20.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/20.png" alt="img"></p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/21.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/21.png" alt="img"></p><h2 id="6-2-è¾…åŠ©æå‡åŸºå› ç»„ç»„è£…"><a href="#6-2-è¾…åŠ©æå‡åŸºå› ç»„ç»„è£…" class="headerlink" title="6.2 è¾…åŠ©æå‡åŸºå› ç»„ç»„è£…"></a>6.2 è¾…åŠ©æå‡åŸºå› ç»„ç»„è£…</h2><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/22.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/22.png" alt="img"></p><ul><li><p>Hi-Cè¾…åŠ©é™†åœ°æ£‰ä¸æµ·å²›æ£‰åŸºå› ç»„æŸ“è‰²ä½“æ°´å¹³ç»„è£…ï¼ˆ<em>Wang et al</em>.,Nature Genetics 2018ï¼‰</p></li><li><p>Hi-Cæ— éœ€ç¾¤ä½“ï¼Œå•ä¸€ä¸ªä½“å°±èƒ½å®ç°æŸ“è‰²ä½“å®šä½ã€‚å¾ˆå¤šç‰©ç§éƒ½æ— æ³•æ„å»ºé—ä¼ ç¾¤ä½“ï¼ŒåŒ…æ‹¬å¤§éƒ¨åˆ†é«˜ç­‰åŠ¨ç‰©ã€é‡ç”ŸåŠ¨æ¤ç‰©ã€æ—æœ¨ã€æœæ ‘ç­‰ç­‰ã€‚Hi-Cæ˜¯é€šè¿‡æŸ“è‰²ä½“ä¸Šç©ºé—´è·ç¦»ã€çº¿æ€§è·ç¦»çš„ä¸åŒè€Œå¯¼è‡´çš„äº¤äº’é¢‘ç‡çš„ä¸åŒæ¥å®ŒæˆæŸ“è‰²ä½“çš„å®šä½ï¼Œæ‰€ä»¥ä¸éœ€è¦æ„å»ºç¾¤ä½“ã€‚</p></li><li><p>æ ‡è®°å¯†åº¦æ›´å¤§ï¼Œåºåˆ—å®šä½æ›´å®Œæ•´ã€‚ç›¸æ¯”é—ä¼ å›¾è°±ï¼ŒæŸ“è‰²è´¨ä¹‹é—´çš„äº¤äº’é¢‘ç‡å…·æœ‰æ›´é«˜çš„æ ‡è®°å¯†åº¦ï¼Œå¦‚æ­¤é«˜å¯†åº¦çš„å›¾è°±ä¸ä»…å¯ä»¥æŒ‚è½½ä¸Šé•¿çš„Scaffoldï¼Œè¾ƒçŸ­çš„Scaffoldä¹Ÿå¯ä»¥è¢«å®šä½ï¼Œæ‰€ä»¥é€šè¿‡Hi-CæŠ€æœ¯ï¼Œä¸€èˆ¬å¯ä»¥å°†90%ä»¥ä¸ŠåŸºå› ç»„åºåˆ—å®šä½åˆ°æŸ“è‰²ä½“ã€‚</p></li><li><p>å¯ä»¥å¯¹å·²ç»„è£…çš„åŸºå› ç»„è¿›è¡Œçº é”™ã€‚é€šè¿‡Scaffoldé—´çš„äº¤äº’é¢‘ç‡å¤§å°ï¼Œå¯ä»¥å¯¹å·²ç»„è£…çš„åŸºå› ç»„åºåˆ—è¿›è¡Œçº é”™ã€‚</p></li></ul><h3 id="6-2-1-æ•°æ®ç»Ÿè®¡å’Œè¿‡æ»¤ï¼›"><a href="#6-2-1-æ•°æ®ç»Ÿè®¡å’Œè¿‡æ»¤ï¼›" class="headerlink" title="6.2.1 æ•°æ®ç»Ÿè®¡å’Œè¿‡æ»¤ï¼›"></a>6.2.1 æ•°æ®ç»Ÿè®¡å’Œè¿‡æ»¤ï¼›</h3><h3 id="6-2-2-Hi-Cæ–‡åº“è¯„ä¼°ï¼›"><a href="#6-2-2-Hi-Cæ–‡åº“è¯„ä¼°ï¼›" class="headerlink" title="6.2.2 Hi-Cæ–‡åº“è¯„ä¼°ï¼›"></a>6.2.2 Hi-Cæ–‡åº“è¯„ä¼°ï¼›</h3><h3 id="6-2-3Hi-CæŸ“è‰²ä½“å®šä½ï¼›"><a href="#6-2-3Hi-CæŸ“è‰²ä½“å®šä½ï¼›" class="headerlink" title="6.2.3Hi-CæŸ“è‰²ä½“å®šä½ï¼›"></a>6.2.3Hi-CæŸ“è‰²ä½“å®šä½ï¼›</h3><p>â€‹    âœ“ ç»„è£…åºåˆ—æŸ“è‰²ä½“ç¾¤ç»„åˆ’åˆ†ï¼›</p><p>   âœ“  ç»„è£…åºåˆ—å„ç¾¤ç»„å†…æ’åºï¼›</p><p>   âœ“  ç»„è£…åºåˆ—å„ç¾¤ç»„å†…å®šå‘ï¼›</p><h3 id="6-2-4-Hi-Cå®šä½åç»Ÿè®¡è¯„ä¼°ï¼›"><a href="#6-2-4-Hi-Cå®šä½åç»Ÿè®¡è¯„ä¼°ï¼›" class="headerlink" title="6.2.4 Hi-Cå®šä½åç»Ÿè®¡è¯„ä¼°ï¼›"></a>6.2.4 Hi-Cå®šä½åç»Ÿè®¡è¯„ä¼°ï¼›</h3><p>â€‹    âœ“  è¿‘ç¼˜ç‰©ç§å‚è€ƒåŸºå› ç»„è¯„ä¼°ï¼›</p><p>â€‹    âœ“  é—ä¼ æ ‡è®°è¯„ä¼°ï¼›</p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/24.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/24.png" alt="img"></p><h2 id="6-3-æ„å»ºåŸºå› ç»„å•ä½“å‹å›¾è°±"><a href="#6-3-æ„å»ºåŸºå› ç»„å•ä½“å‹å›¾è°±" class="headerlink" title="6.3 æ„å»ºåŸºå› ç»„å•ä½“å‹å›¾è°±"></a>6.3 æ„å»ºåŸºå› ç»„å•ä½“å‹å›¾è°±</h2><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/23.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/23.png" alt="img"></p><h1 id="7-æ–‡çŒ®æ¡ˆä¾‹"><a href="#7-æ–‡çŒ®æ¡ˆä¾‹" class="headerlink" title="7. æ–‡çŒ®æ¡ˆä¾‹"></a>7. æ–‡çŒ®æ¡ˆä¾‹</h1><h2 id="7-1"><a href="#7-1" class="headerlink" title="7.1"></a>7.1</h2><p><strong>ç‰©ç§ï¼šæ£‰èŠ±</strong></p><p><strong>é¢˜ç›®ï¼š</strong>Genome sequence of<em>Gossypium herbaceum</em>and genome updates of<em>Gossypium arboreum</em>and<em>Gossypium hirsutum</em>provide insights into cotton A-genome evolution</p><p><strong>æœŸåˆŠï¼š</strong>Nature genetics</p><p><strong>å½±å“å› å­ï¼š</strong>25.455</p><p><strong>ç ”ç©¶å•ä½ï¼š</strong>æ­¦æ±‰å¤§å­¦</p><p><strong>ä¸»è¦ç ”ç©¶å†…å®¹ï¼š</strong></p><p>2020å¹´4æœˆ13æ—¥ï¼Œæ­¦æ±‰å¤§å­¦æœ±ç‰è´¤é™¢å£«å›¢é˜Ÿå…³äºè‰æ£‰ã€äºšæ´²æ£‰å’Œé™†åœ°æ£‰åŸºå› ç»„ç ”ç©¶æˆæœå‘è¡¨åœ¨å›½é™…è‘—åæœŸåˆŠNature geneticsã€‚è¯¥ç ”ç©¶åˆ©ç”¨äº†PacBioä¸‰ä»£åˆ†å­æµ‹åºå’ŒåŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©æŠ€æœ¯æœ‰é™å…¬å¸çš„Hi-CæŠ€æœ¯ç»˜åˆ¶äº†ä¸‰ä¸ªé«˜è´¨é‡æ£‰èŠ±åŸºå› å›¾è°±ï¼Œå‘ç°äº†ä¸‰ç§æ£‰èŠ±ä¸­å¤šä¸ªæŸ“è‰²ä½“æ˜“ä½ä¸å€’ä½äº‹ä»¶ï¼Œè§£å†³äº†å›´ç»•AåŸºå› ç»„èµ·æºçš„ç°æœ‰äº‰è®®æ€§æ¦‚å¿µï¼Œç¡®å®šäº†ä¸æ£‰èŠ±çº¤ç»´é•¿åº¦è¿™ä¸€é‡è¦å†œè‰ºæ€§çŠ¶ç›¸å…³çš„ä¸°å¯Œçš„å€™é€‰åŸºå› ï¼Œå¹¶ä¸ºæ£‰èŠ±é—ä¼ æ”¹è‰¯æä¾›äº†å®è´µçš„åŸºå› ç»„èµ„æºã€‚</p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/25.png"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/25.png" alt="è‰æ£‰ä¸äºšæ´²æ£‰åŸºå› ç»„Hi-Cçƒ­å›¾"></p><h2 id="7-2"><a href="#7-2" class="headerlink" title="7.2"></a>7.2</h2><p><strong>ç‰©ç§ï¼šç™æ¡</strong></p><p><strong>é¢˜ç›®ï¼š</strong><a href="https://link.zhihu.com/?target=http://tour.biocloud.net/article/v1/into/articleDetail/31970919">Genomic analyses of a â€œliving fossilâ€: The endangered dove-tree</a></p><p><strong>æœŸåˆŠï¼š</strong>Molecular Ecology Resources</p><p><strong>å½±å“å› å­ï¼š</strong>7.049</p><p><strong>ç ”ç©¶å•ä½ï¼š</strong>å››å·å¤§å­¦</p><p><strong>ä¸»è¦ç ”ç©¶å†…å®¹ï¼š</strong>2020å¹´1æœˆå››å·å¤§å­¦åˆ˜å»ºå…¨å›¢é˜Ÿç ´è¯‘äº†ä¸­å›½ç‰¹æœ‰çš„æ¿’å±ç‰©ç§ç™æ¡ï¼ˆ<em>Davidia involucrata</em>ï¼‰åŸºå› ç»„ï¼Œç›¸å…³æˆæœå‘è¡¨åœ¨è‘—åæœŸåˆŠMolecular Ecology Resourcesä¸Šã€‚å››å·å¤§å­¦åˆ˜å»ºå…¨æ•™æˆå’Œæ¨å‹‡å¿—åšå£«ä¸ºè¯¥è®ºæ–‡çš„é€šè®¯ä½œè€…ï¼Œé™ˆé˜³å’Œé©¬æ¶›æ•™æˆä¸ºå¹¶åˆ—ä¸€ä½œã€‚è¯¥ç ”ç©¶åˆ©ç”¨å•åˆ†å­å®æ—¶æµ‹åºSMRTå’ŒåŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©æŠ€æœ¯æœ‰é™å…¬å¸çš„Hi-CæŠ€æœ¯ç»„è£…äº†ä¸€ä¸ªé«˜è´¨é‡ã€æŸ“è‰²ä½“ä½“æ°´å¹³çš„ç™æ¡åŸºå› ç»„ï¼Œç ”ç©¶å‘ç°è‹ç‰‡ä¸­å…‰åˆä½œç”¨ç›¸å…³åŸºå› å‡ ä¹ç¼ºå¤±æˆ–è¡¨è¾¾å‡å°‘ï¼Œè€ŒæŠ—èŒã€æŠ—å†·ã€æŠ—æ°´ç­‰æŠ—é€†ç›¸å…³åŸºå› åœ¨è‹ç‰‡ä¸­é«˜åº¦è¡¨è¾¾ï¼Œçªå‡ºäº†è‹ç‰‡åœ¨ä¿æŠ¤èŠ±å’Œå¸å¼•æˆç²‰è€…ä¸­çš„é‡è¦ä½œç”¨ã€‚æœ‰æ•ˆç¾¤ä½“å¤§å°ç­‰ç ”ç©¶åˆ†æäº†ç™æ¡çš„ç”Ÿå­˜æœºåˆ¶å’Œæ¿’å±åŸå› ã€‚åœ¨æœªæ¥æ°”å€™æŒç»­å˜æš–çš„èƒŒæ™¯ä¸‹ï¼Œç ”ç©¶ç»“æœä¸ºä¿æŠ¤è¿™ç‹¬ç‰¹çš„æ¿’å±ç‰©ç§æä¾›äº†ä¾æ®ã€‚</p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/26.png"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/26.png" alt="ç™æ¡åŸºå› ç»„Hi-Cçƒ­å›¾"></p><h2 id="7-3"><a href="#7-3" class="headerlink" title="7.3"></a>7.3</h2><p><strong>ç‰©ç§ï¼šäºŒå€ä½“è‰è“</strong></p><p><strong>é¢˜ç›®ï¼š</strong><a href="https://link.zhihu.com/?target=http://tour.biocloud.net/article/v1/into/articleDetail/32003918">The high-quality genome of diploid strawberry (Fragaria nilgerrensis) provides new insights into anthocyanin accumulation</a></p><p><strong>æœŸåˆŠï¼š</strong>Plant Biotechnology Journal</p><p><strong>å½±å“å› å­ï¼š</strong>6.84</p><p><strong>ç ”ç©¶å•ä½ï¼š</strong>æ²ˆé˜³å†œä¸šå¤§å­¦</p><p><strong>ä¸»è¦ç ”ç©¶å†…å®¹ï¼š</strong></p><p>2020å¹´1æœˆ31æ—¥æ²ˆé˜³å†œä¸šå¤§å­¦å¼ å¿—å®ç ”ç©¶å›¢é˜Ÿä¸åŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©ç§‘æŠ€æœ‰é™å…¬å¸åˆä½œï¼ŒåŸºäºå•åˆ†å­å®æ—¶æµ‹åºPacBioå’ŒæŸ“è‰²ä½“æ„è±¡æ•è·Hi-CæŠ€æœ¯ï¼ŒæˆåŠŸæ„å»ºäºšæ´²ä¸œéƒ¨å’Œä¸œå—éƒ¨åœ°åŒºç‰¹æœ‰çš„é‡ç”ŸäºŒå€ä½“è‰è“â€”â€”é»„æ¯›è‰è“ï¼ˆ<em>Fragaria nilgerrensis</em>ï¼‰é«˜è´¨é‡åŸºå› å›¾è°±ï¼Œç›¸å…³ç ”ç©¶æˆæœå‘è¡¨åœ¨çŸ¥åæœŸåˆŠPlant Biotechnology Journalä¸Šã€‚æ–‡ä¸­é€šè¿‡æ¯”è¾ƒåŸºå› ç»„å­¦ç­‰ç³»åˆ—åˆ†ææ‰¾å¯»åˆ°å¯èƒ½ä¸é»„æ¯›è‰è“ç‰¹å¼‚è¡¨å‹ä»¥åŠç¯å¢ƒé€‚åº”æ€§ç›¸å…³çš„æ‰©å¼ åŸºå› ï¼Œä»¥åŠå¯èƒ½ä¸å…¶ç™½è‰²æœå®ç›¸å…³çš„å˜å¼‚ã€‚è¯¥ç ”ç©¶ä¸ºè‰è“å±ç‰©ç§çš„ç”Ÿç‰©å­¦ä»¥åŠæ¯”è¾ƒåŸºå› ç»„å­¦ç ”ç©¶æä¾›äº†å®è´µçš„é—ä¼ èµ„æºã€‚</p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/27.png"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/27.png" alt="é»„æ¯›è‰è“åŸºå› ç»„Hi-Cçƒ­å›¾"></p><h2 id="7-4"><a href="#7-4" class="headerlink" title="7.4"></a>7.4</h2><p><strong>ç‰©ç§ï¼šæ²¹æ¡</strong></p><p><strong>é¢˜ç›®ï¼š</strong><a href="https://link.zhihu.com/?target=http://tour.biocloud.net/article/v1/into/articleDetail/32224189">Tung Tree (Vernicia fordii) Genome Provides A Resource for Understanding Genome Evolution and Improved Oil Production</a></p><p><strong>æœŸåˆŠï¼š</strong>Genomics Proteomics &amp; Bioinformatics</p><p><strong>å½±å“å› å­ï¼š</strong>6.597</p><p><strong>ç ”ç©¶å•ä½ï¼š</strong>ä¸­å—æ—ä¸šç§‘æŠ€å¤§å­¦</p><p><strong>ä¸»è¦ç ”ç©¶å†…å®¹ï¼š</strong></p><p>2020å¹´4æœˆ7æ—¥ï¼ŒGenomics Proteomics &amp; Bioinformatics åœ¨çº¿å‘è¡¨äº†ç”±ä¸­å—æ—ä¸šç§‘æŠ€å¤§å­¦è°­æ™“é£å›¢é˜Ÿç‰µå¤´å®Œæˆçš„æ²¹æ¡åŸºå› ç»„ç ”ç©¶è®ºæ–‡ã€‚è¯¥ç ”ç©¶åˆ©ç”¨Illumina+PacBioç»„è£…äº†1.12Gbæ²¹æ¡åŸºå› ç»„ï¼Œå¹¶é€šè¿‡åŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©æŠ€æœ¯æœ‰é™å…¬å¸çš„Hi-CæŠ€æœ¯å°†95.15%çš„åºåˆ—æŒ‚è½½åˆ°11æ¡æŸ“è‰²ä½“ä¸Šã€‚åŸºäºæ¯”è¾ƒåŸºå› ç»„ç­‰ç³»åˆ—ç›¸å…³ç ”ç©¶è§£æäº†æ²¹æ¡åŸºå› ç»„è¿›åŒ–å’Œæ¡æ²¹ç”Ÿç‰©åˆæˆçš„åˆ†å­æœºåˆ¶ã€‚è¯¥ç ”ç©¶ä¸ºç†è§£åŸºå› ç»„æ¼”åŒ–ã€ä»¥åŠæ²¹è„‚äº§é‡çš„åˆ†å­è‚²ç§ä¸é—ä¼ æ”¹è‰¯éƒ½æä¾›äº†å®è´µçš„é—ä¼ èµ„æºï¼Œä¸ºæ²¹æ¡ç§è´¨èµ„æºä¿æŠ¤ã€åˆ†å­é—ä¼ å­¦ç ”ç©¶ã€è‰¯ç§é€‰è‚²åŠåŠ å·¥åˆ©ç”¨ï¼Œå¥ å®šäº†é‡è¦çš„ç§‘å­¦åŸºç¡€ã€‚</p><p><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/28.png" alt="æ²¹æ¡åŸºå› ç»„circoså›¾"><br><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/28.png"></p><h2 id="7-5"><a href="#7-5" class="headerlink" title="7.5"></a>7.5</h2><p><strong>ç‰©ç§ï¼šäºšéº»</strong></p><p><strong>é¢˜ç›®ï¼š</strong><a href="https://link.zhihu.com/?target=http://tour.biocloud.net/article/v1/into/articleDetail/32240956">Genomic Comparison and Population Diversity Analysis Provide Insights into the Domestication and Improvement of Flax</a></p><p><strong>æœŸåˆŠï¼š</strong>iScience</p><p><strong>å½±å“å› å­ï¼š</strong>â€”â€”</p><p><strong>ç ”ç©¶å•ä½ï¼š</strong>ç”˜è‚ƒçœå†œä¸šç§‘å­¦é™¢</p><p><strong>ä¸»è¦ç ”ç©¶å†…å®¹ï¼š</strong></p><p>2020å¹´4æœˆ24æ—¥ï¼Œç”±ç”˜è‚ƒçœå†œç§‘é™¢å’ŒåŒ—äº¬ç™¾è¿ˆå®¢ç­‰å•ä½åˆä½œçš„äºšéº»åŸºå› ç»„ç ”ç©¶æˆæœè£ç™»iScience, å…¶ä¸­å¼ å»ºå¹³ç ”ç©¶å‘˜ï¼Œå…šå æµ·ç ”ç©¶å‘˜ï¼Œåˆ˜å¤´æ˜ç ”ç©¶å‘˜ï¼Œç™¾è¿ˆå®¢CEOéƒ‘æ´ªå¤ä¸ºæœ¬æ–‡é€šè®¯ä½œè€…ã€‚è¯¥ç ”ç©¶ä½¿ç”¨IlluminaæŠ€æœ¯å¯¹æ²¹ç”¨äºšéº»å“ç§Longya-10ã€çº¤ç»´äºšéº»å“ç§Heiya-14å’Œpale flaxåˆ†åˆ«è¿›è¡Œæµ‹åºä¸ç»„è£…ï¼ŒåæœŸåˆ©ç”¨HiCæŠ€æœ¯ä¸é—ä¼ å›¾è°±è¾…åŠ©Longya-10åŸºå› ç»„ç»„è£…ï¼Œå°†434 scaffoldsç»„è£…è‡³æŸ“è‰²ä½“æ°´å¹³ã€‚é€šè¿‡æ¯”è¾ƒåŸºå› ç»„åŠç¾¤ä½“è¿›åŒ–ç­‰ç ”ç©¶æ¢ç´¢æ²¹ç”¨åŠçº¤ç»´ç”¨äºšéº»åœ¨é©¯åŒ–ä¸­å—åˆ°çš„é€‰æ‹©ä½œç”¨ï¼Œä»¥åŠå¯èƒ½åœ¨é‡å¡‘äºšéº»å½¢æ€ç»“æ„ä¸­èµ·ç€è‡³å…³é‡è¦ä½œç”¨çš„ç›¸å…³åŸºå› ã€‚è¯¥ç ”ç©¶æ­ç¤ºäº†å¯¹äºšéº»é©¯åŒ–å’Œæ”¹è‰¯æœ‰é‡è¦å½±å“çš„åŸºå› ï¼Œè¿™å°†æœ‰åŠ©äºä»Šåçš„åˆ†å­è‚²ç§ã€‚</p><p><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/29.png" alt="äºšéº»åŸºå› ç»„Hi-Cçƒ­å›¾"><br><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/29.png"></p><h2 id="7-6"><a href="#7-6" class="headerlink" title="7.6"></a>7.6</h2><p><strong>ç‰©ç§ï¼šæ‡æ·</strong></p><p><strong>é¢˜ç›®ï¼š</strong><a href="https://link.zhihu.com/?target=http://tour.biocloud.net/article/v1/into/articleDetail/32141509">Chromosome-level genome assembly and annotation of the loquat (Eriobotrya japonica) genome</a></p><p><strong>æœŸåˆŠ</strong>ï¼šGigascience</p><p><strong>å½±å“å› å­ï¼š</strong>4.688</p><p><strong>ç ”ç©¶å•ä½ï¼š</strong>ä¸Šæµ·å¸‚å†œä¸šç§‘å­¦é™¢</p><p><strong>ä¸»è¦ç ”ç©¶å†…å®¹ï¼š</strong></p><p>2020å¹´2æœˆ6æ—¥ï¼Œä¸Šæµ·å¸‚å†œä¸šç§‘å­¦é™¢å¼ å­¦è‹±ç ”ç©¶å‘˜å›¢é˜ŸäºçŸ¥åæœŸåˆŠGigascienceä¸Šé¦–æ¬¡å‘è¡¨æ‡æ·åŸºå› ç»„ç›¸å…³ç ”ç©¶è®ºæ–‡ï¼Œè¯¥ç ”ç©¶ä¸­åŸºäºåŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©ç§‘æŠ€æœ‰é™å…¬å¸çš„Nanoporeæµ‹åºå’ŒHi-CæŸ“è‰²ä½“æ„è±¡æ•è·æŠ€æœ¯ï¼Œæ„å»ºäº†é«˜è´¨é‡çš„æ‡æ·åŸºå› ç»„ã€‚æ–‡ä¸­é€šè¿‡ä¸è‹¹æœã€æ°´èœœæ¡ƒã€æ¢¨ã€è¦†ç›†è“ã€æœˆå­£å’Œé‡è‰è“çš„è›‹ç™½è´¨åºåˆ—æ¯”è¾ƒï¼Œæ¢ç´¢äº†æ‡æ·çš„å…¨åŸºå› ç»„å¤åˆ¶ä¸è¿›åŒ–äº‹ä»¶ï¼Œå¹¶è¿›è¡Œäº†æŸ“è‰²ä½“é‡æ’åˆ†æã€‚è¯¥ç ”ç©¶æä¾›äº†å®è´µçš„æŸ“è‰²ä½“æ°´å¹³åŸºå› ç»„æ•°æ®ï¼Œä¸ºç ”ç©¶æ‡æ·æ€§çŠ¶æä¾›äº†é‡è¦çš„åŸºå› ç»„æ•°æ®ã€‚</p><p><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/30.png" alt="æ‡æ·åŸºå› ç»„circoså›¾"><br><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/30.png"></p><h2 id="7-7"><a href="#7-7" class="headerlink" title="7.7"></a>7.7</h2><p><strong>ç‰©ç§ï¼šæ¿è“æ ¹ï¼ˆè˜è“ï¼‰</strong></p><p><strong>é¢˜ç›®ï¼š</strong><a href="https://link.zhihu.com/?target=http://tour.biocloud.net/article/v1/into/articleDetail/32025321">A chromosome-scale genome assembly of Isatis indigotica, an important medicinal plant used in traditional Chinese medicine</a></p><p><strong>æœŸåˆŠï¼š</strong> Horticulture Research</p><p><strong>å½±å“å› å­ï¼š</strong>3.640</p><p><strong>ç ”ç©¶å•ä½ï¼š</strong>å››å·å¤§å­¦</p><p><strong>ä¸»è¦ç ”ç©¶å†…ï¼š</strong></p><p>2020å¹´2 æœˆ1æ—¥ï¼Œå››å·å¤§å­¦ç”Ÿå‘½ç§‘å­¦å­¦é™¢åˆ˜å»ºå…¨è¯¾é¢˜ç»„ä¸åä¸­å†œä¸šå¤§å­¦ä½œç‰©é—ä¼ æ”¹è‰¯å›½å®¶é‡ç‚¹å®éªŒå®¤æå†äº‘è¯¾é¢˜ç»„é¦–æ¬¡å®Œæˆäº†è˜è“ï¼ˆ<em>Isatis indigotica</em>ï¼Œ2n&#x3D;14ï¼‰æŸ“è‰²ä½“çº§åˆ«åŸºå› ç»„å›¾è°±ç»˜åˆ¶ã€‚è¯¥ç ”ç©¶åˆ©ç”¨Pacbioæµ‹åº(140X)ç»“åˆåŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©æŠ€æœ¯æœ‰é™å…¬å¸çš„Hi-CæŠ€æœ¯ï¼ˆ284Xï¼‰ç»„è£…å¾—åˆ°294Mbé«˜è´¨é‡åŸºå› ç»„ï¼ˆcontigN50&#x3D;1.2Mbï¼‰ã€‚åŸºäºåŒæºæœç´¢å’ŒåŠŸèƒ½æ³¨é‡Šï¼Œç¡®å®šäº†è¯¥ç‰©ç§ä¸»è¦åŒ–åˆç‰©ï¼ˆå¦‚å²å“šç±»ã€èœç±»ã€é»„é…®ã€æœ¨è„‚ç´ ç­‰ç‰©è´¨ï¼‰çš„å¯èƒ½ç”Ÿç‰©åˆæˆé€šè·¯å’Œç›¸å…³çš„å€™é€‰åŸºå› ã€‚è¯¥ç ”ç©¶å¼ºè°ƒäº†åŸºå› ç»„æµ‹åºåœ¨é‰´å®šè¯ç”¨æ¤ç‰©ä»£è°¢äº§ç‰©åˆæˆå€™é€‰åŸºå› ä¸­çš„é‡è¦æ€§ï¼Œä¸ºä»Šååå­—èŠ±ç§‘æ¤ç‰©æ¯”è¾ƒåŸºå› ç»„ç­‰ç ”ç©¶æä¾›äº†é‡è¦é—ä¼ ä¿¡æ¯ã€‚</p><p><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/31.png" alt="è˜è“åŸºå› ç»„Hi-Cçƒ­å›¾"><br><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/31.png"></p><h2 id="7-8"><a href="#7-8" class="headerlink" title="7.8"></a>7.8</h2><h6 id="ä»¥æ›´æ–°çš„äºšæ´²æ£‰AåŸºå› ç»„ä¸ºåŸºç¡€çš„243ä»½äºŒå€ä½“æ£‰çš„é‡è¦å†œè‰ºæ€§çŠ¶çš„ç ”ç©¶"><a href="#ä»¥æ›´æ–°çš„äºšæ´²æ£‰AåŸºå› ç»„ä¸ºåŸºç¡€çš„243ä»½äºŒå€ä½“æ£‰çš„é‡è¦å†œè‰ºæ€§çŠ¶çš„ç ”ç©¶" class="headerlink" title="ä»¥æ›´æ–°çš„äºšæ´²æ£‰AåŸºå› ç»„ä¸ºåŸºç¡€çš„243ä»½äºŒå€ä½“æ£‰çš„é‡è¦å†œè‰ºæ€§çŠ¶çš„ç ”ç©¶"></a>ä»¥æ›´æ–°çš„äºšæ´²æ£‰AåŸºå› ç»„ä¸ºåŸºç¡€çš„243ä»½äºŒå€ä½“æ£‰çš„é‡è¦å†œè‰ºæ€§çŠ¶çš„ç ”ç©¶</h6><h6 id="RESEQUENCING-OF-243-DIPLOID-COTTON-ACCESSIONS-BASED-ON-AN-UPDATED-A-GENOME-IDENTIFIES-THE-GENETIC-BASIS-OF-KEY-AGRONOMIC-TRAITS"><a href="#RESEQUENCING-OF-243-DIPLOID-COTTON-ACCESSIONS-BASED-ON-AN-UPDATED-A-GENOME-IDENTIFIES-THE-GENETIC-BASIS-OF-KEY-AGRONOMIC-TRAITS" class="headerlink" title="RESEQUENCING OF 243 DIPLOID COTTON ACCESSIONS BASED ON AN UPDATED A GENOME IDENTIFIES THE GENETIC BASIS OF KEY AGRONOMIC TRAITS"></a>RESEQUENCING OF 243 DIPLOID COTTON ACCESSIONS BASED ON AN UPDATED A GENOME IDENTIFIES THE GENETIC BASIS OF KEY AGRONOMIC TRAITS</h6><p>æœŸåˆŠï¼šNature Genetics</p><p>å½±å“å› å­ï¼š27.125</p><p>å‘è¡¨å•ä½ï¼šä¸­å›½å†œä¸šç§‘å­¦é™¢æ£‰èŠ±ç ”ç©¶æ‰€ã€åŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©ç§‘æŠ€æœ‰é™å…¬å¸ç­‰</p><p>å‘è¡¨å¹´ä»½ï¼š2018å¹´5æœˆ</p><p>ç ”ç©¶èƒŒæ™¯ï¼š</p><p>æ£‰èŠ±æ˜¯ç ”ç©¶æ¤ç‰©å¤šå€åŒ–çš„æœ‰ä»·å€¼çš„èµ„æºã€‚äºšæ´²æ£‰(<em>Gossypium arboreum</em>)å’Œè‰æ£‰(<em>Gossypium herbaceum</em>)çš„ç¥–å…ˆæ˜¯ç°ä»£æ ½åŸ¹å¼‚æºå››å€ä½“æ£‰èŠ±AäºšåŸºå› ç»„çš„ä¾›ä½“ã€‚ æœ¬ç ”ç©¶ä¸­ï¼Œåˆ©ç”¨äº†ä¸‰ä»£PacBioå’ŒHi-CæŠ€æœ¯ï¼Œé‡æ–°ç»„è£…äº†é«˜è´¨é‡çš„äºšæ´²æ£‰åŸºå› ç»„ï¼Œåˆ†æäº†243ä»½äºŒå€ä½“æ£‰èŠ±ç§è´¨çš„ç¾¤ä½“ç»“æ„å’ŒåŸºå› ç»„åˆ†åŒ–è¶‹åŠ¿ï¼ŒåŒæ—¶ç¡®å®šäº†ä¸€äº›æœ‰åŠ©äºæ£‰èŠ±çš®æ£‰äº§é‡é—ä¼ æ”¹è‰¯çš„å€™é€‰åŸºå› ä½ç‚¹ã€‚</p><p>ç ”ç©¶ç»“æœï¼š</p><p>1ã€äºšæ´²æ£‰ä¸‰ä»£åŸºå› ç»„ç»„è£…ï¼š</p><p>åˆ©ç”¨ä¸‰ä»£æµ‹åºå’ŒHi-Cç›¸ç»“åˆçš„æ–¹æ³•è¿›è¡Œäºšæ´²æ£‰åŸºå› ç»„ç»„è£…ã€‚å…±è®¡è·å¾—äº†142.54 Gb ï¼Œç»„è£…1.71 Gbäºšæ´²æ£‰åŸºå› ç»„ï¼ŒContig N50&#x3D;1.1 Mbï¼Œæœ€é•¿çš„Contigä¸º12.37 Mbã€‚åˆ©ç”¨Hi-CæŠ€æœ¯å°†ç»„è£…çš„1573 Mbçš„æ•°æ®å®šä½åˆ°13æ¡æŸ“è‰²ä½“ä¸Šï¼Œä¸å·²ç»å‘è¡¨çš„åŸºå› ç»„ç›¸æ¯”ï¼Œå½“Hi-Cæ•°æ®æ¯”å¯¹åˆ°æ›´æ–°çš„åŸºå› ç»„åï¼Œå¯¹è§’çº¿å¤–çš„ä¸ä¸€è‡´æ€§æ˜æ˜¾å‡å°‘ï¼ˆå›¾1 a-bï¼‰</p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/33.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/33.png" alt="img"></p><p>å›¾1 HI-Cæ•°æ®åœ¨ä¸¤ç‰ˆäºšæ´²æ£‰åŸºå› ç»„ä¸Šçš„æ¯”å¯¹</p><p>2ã€äºŒå€ä½“æ£‰èŠ±ç¾¤ä½“é—ä¼ è¿›åŒ–åˆ†æï¼š</p><p>å¯¹230ä»½äºšæ´²æ£‰å’Œ13ä»½è‰æ£‰é‡æµ‹åºï¼Œè¿›è¡ŒåŸºå› ç»„æ¯”å¯¹ã€ç³»ç»Ÿå‘è‚²æ ‘ã€ç¾¤ä½“ç»“æ„åˆ†æã€PCAã€LDå’Œé€‰æ‹©æ€§æ¸…é™¤åˆ†æå¾—å‡ºäºšæ´²æ£‰å’Œè‰æ£‰ï¼ˆAï¼‰ä¸é›·è’™å¾·æ°æ£‰åŒæ—¶è¿›è¡Œäº†åˆ†åŒ–ï¼›äºšæ´²æ£‰èµ·æºäºä¸­å›½å—éƒ¨ï¼Œéšåè¢«å¼•å…¥é•¿æ±Ÿå’Œé»„æ²³åœ°åŒºï¼Œå¤§å¤šæ•°å…·æœ‰é©¯åŒ–ç›¸å…³ç‰¹æ€§çš„ç§è´¨éƒ½ç»å†äº†åœ°ç†éš”ç¦»ï¼ˆå›¾2ï¼‰ã€‚</p><p><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/34.png" alt="img"><br><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/34.png" alt="img"></p><p>å›¾2 äºŒå€ä½“æ£‰ç¾¤ä½“è¿›åŒ–å’Œç¾¤ä½“ç»“æ„åˆ†æ</p><p>3ã€äºšæ´²æ£‰çš„å…¨åŸºå› ç»„å…³è”åˆ†æï¼ˆGWASï¼‰ï¼š</p><p>å¯¹æ¥è‡ªä¸åŒç¯å¢ƒä¸‹çš„11ä¸ªé‡è¦æ€§çŠ¶è¿›è¡Œå…¨åŸºå› ç»„å…³è”åˆ†æï¼Œé‰´å®šäº†äºšæ´²æ£‰11ä¸ªé‡è¦å†œè‰ºæ€§çŠ¶çš„98ä¸ªæ˜¾è‘—å…³è”ä½ç‚¹ï¼ŒGaKASIIIçš„éåŒä¹‰æ›¿æ¢ï¼ˆåŠèƒ±æ°¨é…¸&#x2F;ç²¾æ°¨é…¸æ›¿æ¢ï¼‰ä½¿å¾—æ£‰ç±½ä¸­çš„è„‚è‚ªé…¸ç»„æˆï¼ˆC16:0å’ŒC16:1ï¼‰å‘ç”Ÿäº†å˜åŒ–ï¼›å‘ç°æ£‰èŠ±æ¯èç—…æŠ—æ€§ä¸GaGSTF9åŸºå› çš„è¡¨è¾¾æ¿€æ´»ç›¸å…³ã€‚é€‰æ‹©äº†äºšæ´²æ£‰ç§è´¨ä¸­çš„158ä»½æœ‰ç»’æ¯›å’Œ57ä»½æ— ç»’æ¯›ææ–™è¿›è¡ŒGWASå…³è”åˆ†æï¼Œå‘ç°ä¸æ¯›çŠ¶ä½“å’Œçº¤ç»´å‘è‚²æœ‰å…³ä¿¡æ¯ï¼ˆå›¾3ï¼‰ã€‚</p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/35.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/35.png" alt="img"></p><p>å›¾3 äºŒå€ä½“æ£‰ç¾¤ä½“è¿›åŒ–å’Œç¾¤ä½“ç»“æ„åˆ†æ</p><p>ç ”ç©¶ç»“è®ºï¼š</p><p>åˆ©ç”¨ä¸‰ä»£æµ‹åº+Hi-CæŠ€æœ¯å®Œæˆäº†äºšæ´²æ£‰åŸºå› ç»„çš„é‡æ–°ç»„è£…ï¼Œå°†åŸºå› ç»„ç»„è£…æŒ‡æ ‡ä»72 Kbæå‡åˆ°1.1 Mbï¼Œä¸ºäºšæ´²æ£‰åç»­çš„ç¾¤ä½“é—ä¼ å­¦ç­‰ç›¸å…³ç ”ç©¶å¥ å®šäº†åŸºç¡€ï¼›é€šè¿‡ç¾¤ä½“é—ä¼ è¿›åŒ–ç­‰ç›¸å…³åˆ†æï¼Œå‘ç°äºšæ´²æ£‰å’Œè‰æ£‰(Aå‹)ä¸é›·è’™å¾·æ°æ£‰(Då‹)åŒæ—¶è¿›è¡Œäº†åˆ†åŒ–ï¼Œå¹¶è¯æ˜äº†äºšæ´²æ£‰èµ·æºäºä¸­å›½å—éƒ¨ï¼Œéšåè¢«å¼•å…¥é•¿æ±Ÿå’Œé»„æ²³åœ°åŒºï¼›æ•´åˆGWASä¸QTLç­‰åˆ†ææ–¹æ³•ï¼Œå¯¹äºšæ´²æ£‰è„‚è‚ªé…¸å«é‡ï¼ŒæŠ—ç—…æ€§åŠæ£‰ç»’ç”Ÿé•¿å‘è‚²ç›¸å…³åŸºå› è¿›è¡Œå®šä½ï¼Œå¹¶è¿›è¡Œç›¸å…³åŠŸèƒ½éªŒè¯ï¼Œä¿ƒè¿›äº†äºšæ´²æ£‰å¤æ‚å†œè‰ºæ€§çŠ¶çš„æ”¹è‰¯ã€‚</p><h2 id="7-9"><a href="#7-9" class="headerlink" title="7.9"></a>7.9</h2><h6 id="äºŒå€ä½“ã€é‡ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿæ¯”è¾ƒåŸºå› ç»„åˆ†ææ­ç¤ºäºšåŸºå› ç»„ä¸å¯¹ç§°è¿›åŒ–å’Œæ”¹è‰¯"><a href="#äºŒå€ä½“ã€é‡ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿæ¯”è¾ƒåŸºå› ç»„åˆ†ææ­ç¤ºäºšåŸºå› ç»„ä¸å¯¹ç§°è¿›åŒ–å’Œæ”¹è‰¯" class="headerlink" title="äºŒå€ä½“ã€é‡ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿæ¯”è¾ƒåŸºå› ç»„åˆ†ææ­ç¤ºäºšåŸºå› ç»„ä¸å¯¹ç§°è¿›åŒ–å’Œæ”¹è‰¯"></a>äºŒå€ä½“ã€é‡ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿæ¯”è¾ƒåŸºå› ç»„åˆ†ææ­ç¤ºäºšåŸºå› ç»„ä¸å¯¹ç§°è¿›åŒ–å’Œæ”¹è‰¯</h6><h6 id="COMPARISON-OF-ARACHIS-MONTICOLA-WITH-DIPLOID-AND-CULTIVATED-TETRAPLOID-GENOMES-REVEALS-ASYMMETRIC-SUBGENOME-EVOLUTION-AND-IMPROVEMENT-OF-PEANUT"><a href="#COMPARISON-OF-ARACHIS-MONTICOLA-WITH-DIPLOID-AND-CULTIVATED-TETRAPLOID-GENOMES-REVEALS-ASYMMETRIC-SUBGENOME-EVOLUTION-AND-IMPROVEMENT-OF-PEANUT" class="headerlink" title="COMPARISON OF ARACHIS MONTICOLA WITH DIPLOID AND CULTIVATED TETRAPLOID GENOMES REVEALS ASYMMETRIC SUBGENOME EVOLUTION AND IMPROVEMENT OF PEANUT"></a>COMPARISON OF <em>ARACHIS MONTICOLA</em> WITH DIPLOID AND CULTIVATED TETRAPLOID GENOMES REVEALS ASYMMETRIC SUBGENOME EVOLUTION AND IMPROVEMENT OF PEANUT</h6><p>æœŸåˆŠï¼šAdvanced Science</p><p>å½±å“å› å­ï¼š15.804</p><p>å‘è¡¨å•ä½ï¼šæ²³å—å†œä¸šå¤§å­¦ã€åŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©ç§‘æŠ€æœ‰é™å…¬å¸ç­‰</p><p>å‘è¡¨å¹´ä»½ï¼š2019å¹´11æœˆ</p><p>ç ”ç©¶èƒŒæ™¯ï¼š</p><p>èŠ±ç”Ÿä½œä¸ºæˆ‘å›½é‡è¦çš„ç»æµä½œç‰©ï¼Œæ˜¯æä¾›é‡è¦çš„è›‹ç™½å’Œæ²¹æ–™çš„åŸºç¡€ã€‚èŠ±ç”Ÿå±ä¸€å…±åŒ…æ‹¬30ä¸ªäºŒå€ä½“å“ç§ï¼Œ1ä¸ªå¼‚æºå››å€ä½“é‡ç”ŸèŠ±ç”Ÿ(<em>A. monticola</em>)å’Œ1ä¸ªæ ½åŸ¹èŠ±ç”Ÿ(<em>A. hypogaea</em>)ã€‚ä½œä¸ºæ ½åŸ¹èŠ±ç”Ÿå†œè‰ºæ€§çŠ¶æ”¹è‰¯çš„é‡è¦é‡ç”Ÿèµ„æºä¾›ä½“ï¼Œé‡ç”Ÿå››å€ä½“èŠ±ç”Ÿä¸€ç›´æ˜¯å›½å†…å¤–å­¦è€…çš„ç ”ç©¶çƒ­ç‚¹ã€‚ç ”ç©¶ä¸­å¯¹èŠ±ç”Ÿå±å”¯ä¸€çš„é‡ç”Ÿå¼‚æºå››å€ä½“èŠ±ç”Ÿ<em>Arachis monticola</em>åŸºå› ç»„è¿›è¡Œäº†ç ”ç©¶ï¼ŒåŒæ—¶å¯¹17ä¸ªé‡ç”ŸäºŒå€ä½“èŠ±ç”Ÿï¼ˆAA;BB;EE;KKå’ŒCCï¼‰ä¸30ä¸ªé‡ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿè¿›è¡Œäº†é‡æµ‹åºåˆ†æã€‚</p><p>ç ”ç©¶ç»“æœï¼š</p><p>1ã€é‡ç”Ÿå››å€ä½“èŠ±ç”ŸåŸºå› ç»„denovoåŠä¸æ ½åŸ¹å››å€ä½“èŠ±ç”Ÿçš„æ¯”è¾ƒåˆ†æï¼š</p><p>åŸºäº Illuminaã€PacBio ã€Hi-Cå’Œå…‰å­¦å›¾è°±æ•°æ®ï¼Œç»„è£…<em>Arachis monticola</em>(2n &#x3D; 4x &#x3D; 40)åŸºå› ç»„å¤§å°ä¸º2.62 Gb ï¼Œcontigs N50&#x3D;106.66 Kbï¼Œscaffolds N50&#x3D;124.92 Mbï¼›ä¸æ ½åŸ¹å››å€ä½“èŠ±ç”Ÿ<em>A. hypogaea</em>åŸºå› ç»„ç»“æ„å˜å¼‚é«˜åº¦ä¿å®ˆï¼Œä¸”æ¯”é‡ç”Ÿç¥–å…ˆäºŒå€ä½“æ›´åŠ ä¿å®ˆï¼›</p><p>2ã€Aã€BäºšåŸºå› ç»„çš„å•ç³»èµ·æºå’Œå¤šæ ·æ€§ï¼š</p><p>å¯¹17ä¸ªäºŒå€ä½“é‡ç”Ÿç§ï¼ˆAAã€BBã€EEã€KKå’ŒCCï¼‰å’Œ30ä¸ªé‡ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿè¿›è¡Œäº†è¿›åŒ–æ ‘å’ŒPCAåˆ†æã€‚ç»“æœè¡¨æ˜ï¼Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿä¸é‡ç”Ÿå››å€ä½“èŠ±ç”Ÿæœ€æ¥è¿‘ï¼Œ Aå’ŒBäºšåŸºå› ç»„çš„å•ç³»èµ·æºï¼ˆå›¾1ï¼‰ï¼›</p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/36.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/36.png" alt="img"></p><p>3ã€å››å€ä½“èŠ±ç”Ÿä¸å¯¹ç§°äºšåŸºå› ç»„è¿›åŒ–åŠè¡¨è¾¾å·®å¼‚ <strong>ï¼š</strong></p><p>æ ½åŸ¹èŠ±ç”Ÿå’Œé‡ç”ŸèŠ±ç”Ÿçš„äºšåŸºå› ç»„é—´çš„åŒæºåºåˆ—äº¤æ¢ç‡ï¼ˆHSEï¼‰åˆ†åˆ«ä¸º2.46%å’Œ2.54%ã€‚é‡ç”ŸèŠ±ç”Ÿä¸­Aåˆ°Bçš„HSEå¯Œé›†çš„åŸºå› ä¸ºç±»é»„é…®ç”Ÿç‰©åˆæˆå’Œæ˜¼å¤œèŠ‚å¾‹é€”å¾„çš„åŸºå› ï¼Œæš—ç¤ºä¸å¯¹ç§°HSEsåœ¨ç”Ÿç‰©å­¦åŠŸèƒ½ä¸­çš„ä½œç”¨ï¼›</p><p>4ã€SVå¯¹èšå‘è‚²å’Œé©¯åŒ–ç›¸å…³åŸºå› è¡¨è¾¾çš„å½±å“åŠæŠ—ç—…åŸºå› é‰´å®š <strong>ï¼š</strong></p><p>å¯¹é‡ç”Ÿå››å€ä½“èŠ±ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿä¸åŒå‘è‚²é˜¶æ®µèšæœçš„SVåˆ†æå‘ç°SVåœ¨èšæœå‘è‚²è¿‡ç¨‹ä¸­åŸºå› è¡¨è¾¾çš„å˜åŒ–ä¸Šå¯èƒ½èµ·ç€é‡è¦ä½œç”¨ï¼›åŒæ—¶åœ¨æ ½åŸ¹å››å€ä½“èŠ±ç”Ÿä¸­é‰´å®šåˆ°190ä¸ªSVæŠ—ç—…åŸºå› ï¼ˆSV-RGAsï¼‰ï¼Œå…¶ä¸­32ä¸ªåŸºå› åœ¨æ¥ç§åæ˜“æ„Ÿç»„æˆ–æŠ—æ€§ç»„ä¸­è¡¨ç°å‡ºæ˜¾è‘—çš„è¡¨è¾¾å˜åŒ–ï¼ˆå›¾2ï¼‰ã€‚</p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/37.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/37.png" alt="img"></p><p>ç ”ç©¶ç»“è®ºï¼š</p><p>å……åˆ†æ³¨é‡Šäº†é«˜è´¨é‡é‡ç”Ÿå››å€ä½“èŠ±ç”ŸåŸºå› ç»„ï¼Œæ­ç¤ºäº†èŠ±ç”ŸäºšåŸºå› ç»„å•ç³»èµ·æºå’Œé—ä¼ è¿›åŒ–æ¨¡å‹ï¼Œè¡¨æ˜äº†é‡ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”ŸäºšåŸºå› ç»„å‘ç”Ÿäº†ä¸å¯¹ç§°è¿›åŒ–ï¼›æ­¤å¤–ï¼Œé‡ç”ŸèŠ±ç”Ÿä¸­å­˜åœ¨çš„ç‹¬ç‰¹ç­‰ä½åŸºå› å¯ä»¥æ”¹å–„æ ½åŸ¹èŠ±ç”Ÿçš„æŠ—æ€§å’Œèšæœå¤§å°ç­‰å½¢çŠ¶ï¼Œä¸ºç ”ç©¶å¤šå€ä½“åŸºå› ç»„è¿›åŒ–ã€ä½œç‰©é©¯åŒ–å’ŒåŸºå› ç»„è¾…åŠ©èŠ±ç”Ÿç”Ÿäº§æ”¹è‰¯æä¾›ç‹¬ç‰¹çš„ä»·å€¼ã€‚</p><hr><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Hi-C/32.png" alt="å…¶ä»–"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Hi-C/32.png" alt="å…¶ä»–"></p><p>åŒ—äº¬ç™¾è¿ˆå®¢è‡ªå¯åŠ¨Hi-CæŠ€æœ¯ç ”ç©¶ä»¥æ¥ï¼Œè‡ªä¸»å¼€å‘Hi-Cæ’å›¾è½¯ä»¶ï¼Œå…·æœ‰å®éªŒ+ç”Ÿç‰©ä¿¡æ¯åˆ†æä¸“åˆ©åŒä¿æŠ¤ï¼Œä¹Ÿæ˜¯ä¸­å›½å¸‚åœºä¸Šèƒ½ç‹¬ç«‹å®ŒæˆHi-Cå®éªŒâ€”â€”æ•°æ®åˆ†æçš„æµ‹åºä¼ä¸šä¹‹ä¸€ï¼å¹¶å®Œæˆä¸Šåƒä¸ªç‰©ç§ï¼Œè¿‘ä¸‡ä¸ªæ–‡åº“æ„å»ºï¼›æ–‡åº“å«é…¶åˆ‡ä½ç‚¹æœ‰æ•ˆæ•°æ®æ¯”ä¾‹æœ€é«˜è¾¾93%ä»¥ä¸Šï¼Œé’ˆå¯¹ç‰©ç§æ¨å‡ºå®šåˆ¶åŒ–å†…åˆ‡é…¶æœåŠ¡ï¼›å®ç°å¤šå€ä½“ç‰©ç§çš„Hi-Cè¾…åŠ©åŸºå› ç»„ç»„è£…ï¼Œ<strong>æŒ‚è½½æ•ˆç‡æœ€é«˜è¾¾100%ã€‚</strong></p><p>å¦å¤–ä¸ºäº†è®©æ›´å¤šç§‘ç ”å·¥ä½œè€…ä½“éªŒHi-Cå»ºåº“ï¼Œç™¾è¿ˆå®¢åœ¨æˆåŠŸæ„å»ºå¤šç§ç‰©ç§Hi-Cå»ºåº“æµ‹åºçš„ç»éªŒä¸Šï¼Œæ­£å¼æ¨å‡ºäº†Biomarker Hi-C Library Prep Kit for Illuminaã€‚</p><p>Biomarker Hi-C Library Prep Kit for Illuminaæ¶µç›–äº†Hi-Cå®éªŒå…¨éƒ¨ç¯èŠ‚ï¼ŒåŒ…æ‹¬ç”²é†›äº¤è”ã€Hi-Cæå–å’ŒHi-Cæ–‡åº“æ„å»ºï¼Œé€‚ç”¨äºç»†èƒç³»ã€åŠ¨ç‰©å’Œæ¤ç‰©ç»„ç»‡æ ·æœ¬ã€‚1å¥—Hi-Cè¯•å‰‚ç›’åŒ…å«5ä¸ªååº”ï¼Œ1ä¸ªååº”æ„å»ºçš„æ–‡åº“å¯ç”¨äº200Gbæ•°æ®é‡çš„æµ‹åºï¼Œè¯•å‰‚ç›’æ„å»ºçš„æ–‡åº“é€‚ç”¨äºIlluminaæµ‹åºå¹³å°ã€‚</p><hr><p>Ref:<a href="https://www.zhihu.com/question/48308074">https://www.zhihu.com/question/48308074</a></p><p><a href="https://cloud.tencent.com/developer/article/1625366">https://cloud.tencent.com/developer/article/1625366</a></p><p><a href="http://www.biomarker.com.cn/technology-services/hi-c">http://www.biomarker.com.cn/technology-services/hi-c</a></p><p><a href="https://zhuanlan.zhihu.com/p/140795830">https://zhuanlan.zhihu.com/p/140795830</a></p>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hi-C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é€‰æ‹©åŸºå› </title>
    <link href="/GeekFocus/2022/02/16/2022-02-16-select-gene/"/>
    <url>/GeekFocus/2022/02/16/2022-02-16-select-gene/</url>
    
    <content type="html"><![CDATA[<h1 id="é€‰æ‹©åŸºå› -selector-genes-æ˜¯ä¸€ç±»å†³å®šä½“èŠ‚å‘è‚²çš„åŸºå› ã€‚"><a href="#é€‰æ‹©åŸºå› -selector-genes-æ˜¯ä¸€ç±»å†³å®šä½“èŠ‚å‘è‚²çš„åŸºå› ã€‚" class="headerlink" title="é€‰æ‹©åŸºå› (selector genes)æ˜¯ä¸€ç±»å†³å®šä½“èŠ‚å‘è‚²çš„åŸºå› ã€‚"></a>é€‰æ‹©åŸºå› (selector genes)æ˜¯ä¸€ç±»å†³å®šä½“èŠ‚å‘è‚²çš„åŸºå› ã€‚</h1><span id="more"></span><p>æœ‰<font color="green">ä¸¤ç°‡é€‰æ‹©åŸºå› </font>åœ¨æ§åˆ¶<font color="green">æœè‡å¤–éƒ¨ç»“æ„</font>çš„æ­£ç¡®å‘è‚²é€”å¾„ä¸­èµ·å…³é”®ä½œç”¨ï¼š<font color="green">åŒèƒ¸å¤åˆç‰©(bithorax complex,BX-C)</font>å’Œ<font color="green">è§¦è§’è¶³å¤åˆç‰©(antennapedia complex,ANT-C)</font>ã€‚BX-Cå«æœ‰ä¸‰ä¸ªç»“æ„åŸºå› ï¼Œåˆ†åˆ«æ˜¯ï¼š<font color="green">Ultrabithorax(Ubx)ã€Abdominal A(abdA)å’ŒAbdominal B(abdB)</font>ï¼Œå®ƒä»¬<font color="green">å„ç¼–ç ä¸€ç§å…·æœ‰åŒæºæ¡†çš„è½¬å½•å› å­ã€‚è¿™ä¸‰ä¸ªåŸºå› éƒ½å«æœ‰å¾ˆå¤šå†…å«å­</font>ï¼Œè¿™äº›å†…å«å­å¯¹äºè°ƒèŠ‚è¿™äº›åŸºå› åœ¨ä¸åŒ<a href="https://baike.baidu.com/item/%E5%89%AF%E8%8A%82">å‰¯èŠ‚</a>è¿›è¡Œä¸åŒçš„è¡¨è¾¾å…·æœ‰é‡è¦ä½œç”¨ã€‚ANT-C<a href="https://baike.baidu.com/item/%E5%9F%BA%E5%9B%A0%E7%B0%87">åŸºå› ç°‡</a>å«æœ‰5ä¸ªåŸºå› ï¼š<font color="green">labial(lab)ã€proboscipedia(pb)ã€Deformed(Dfd)ã€Sex combs reduced(Scr)å’Œantennapedia(Antp)</font>ã€‚è¿™ä¸¤ç°‡åŸºå› éƒ½å®šä½äº<font color="green">3å·æŸ“è‰²ä½“</font>ã€‚ANT-Cç°‡ç¼–ç çš„è›‹ç™½è´¨æ§åˆ¶<font color="green">0-5å‰¯èŠ‚</font>çš„å‘è‚²ï¼ŒBX-CåŸºå› ç°‡ç¼–ç çš„è›‹ç™½è´¨æ§åˆ¶<font color="green">5-14</font>å‰¯èŠ‚çš„å‘è‚²ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>note</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æŸ“è‰²è´¨ä¸‰ç»´ç»“æ„å›¾è°± Micro-C</title>
    <link href="/GeekFocus/2022/02/16/2022-02-16-chromosome-structure-Micro-C/"/>
    <url>/GeekFocus/2022/02/16/2022-02-16-chromosome-structure-Micro-C/</url>
    
    <content type="html"><![CDATA[<h1 id="Micro-C"><a href="#Micro-C" class="headerlink" title="Micro-C"></a>Micro-C</h1><span id="more"></span><h1 id="Micro-C-1"><a href="#Micro-C-1" class="headerlink" title="Micro-C"></a>Micro-C</h1><p>æŸ“è‰²è´¨ç»“æ„ä¸åŸºå› è¡¨è¾¾çš„è°ƒæ§å¯†åˆ‡ç›¸å…³ï¼ˆå¦‚<font color="green">å¸¸æŸ“è‰²è´¨&#x2F;å¼‚æŸ“è‰²è´¨</font>ï¼‰ã€‚éšç€è¿‘å¹´<font color="green">æŸ“è‰²è´¨æ„è±¡æ•æ‰æŠ€æœ¯</font>çš„å‘å±•ï¼Œäº†è§£åˆ°ç»†èƒæ ¸å†…çš„DNAå­˜åœ¨ç€<font color="green">å¤šé‡ç»“æ„è°ƒèŠ‚æœºåˆ¶</font>ï¼Œä¾‹å¦‚<font color="green">A&#x2F;BæŸ“è‰²è´¨åŒºå®¤ï¼ˆcompartmentï¼‰</font>å’Œ<font color="green">æ‹“æ‰‘ç»“æ„åŸŸï¼ˆTADï¼‰</font>ã€‚å¤§å°åˆ†åˆ«åœ¨<font color="green">ç™¾ä¸‡ç¢±åŸº</font>å’Œ<font color="green">åä¸‡ç¢±åŸº</font>å·¦å³ã€‚ç”±äºæµ‹åºæ·±åº¦å’ŒæŠ€æœ¯æ¡ä»¶é™åˆ¶ï¼Œ<font color="green">Hi-Cå¾ˆéš¾è¾¾åˆ°æ›´é«˜åˆ†è¾¨ç‡</font>ï¼Œ<strong>é™åˆ¶</strong>äº†åˆ†æå…³äºå•ä¸ªåŸºå› ï¼Œä»¥åŠå¯åŠ¨å­ï¼ˆPï¼‰ã€å¢å¼ºå­ï¼ˆEï¼‰ç­‰<font color="green">è°ƒæ§å…ƒä»¶ä¹‹é—´ç›¸äº’ä½œç”¨</font>ã€‚</p><p>Molecular Cellæ‚å¿—å‘è¡¨èƒŒé èƒŒæ–‡ç« Resolving the 3D Landscape of Transcription-Linked Mammalian Chromatin Foldingå’ŒUltrastructural Details of Mammalian Chromosome Architectureã€‚<font color="green">ä¸€ç§æ–°çš„æŸ“è‰²è´¨æ„è±¡æ•æ‰æŠ€æœ¯åä¸ºMicro-C</font>ã€‚Micro-Cè¾¾åˆ°<strong>å•æ ¸å°ä½“é•¿åº¦ï¼ˆï½200bpï¼‰</strong>å·¦å³çš„<strong>åˆ†è¾¨ç‡</strong>ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°æ›´ä¸ºç²¾ç»†çš„æŸ“è‰²è´¨ç»“æ„ã€‚</p><p>Micro-Cå’ŒHi-Cåœ¨å®éªŒæ­¥éª¤ä¸Šæœ€å¤§çš„ä¸åŒï¼Œåœ¨äºMicro-Cå…ˆå¯¹æ ¸å°ä½“ä¸Šç¼ ç»•çš„DNAåšäº¤è”ï¼Œè€Œåç”¨MNaseåˆ‡æ–­æ ¸å°ä½“ä¹‹é—´çš„è¿æ¥DNAã€‚ä»¥Tjianå’ŒDarzacqå®éªŒå®¤çš„æ–‡ç« ä¸ºä¾‹ï¼Œä»–ä»¬å¯¹38ä¸ªå°é¼ å¹²ç»†èƒè¿›è¡ŒMicro-Cæµ‹åºï¼Œæ€»å…±è·å¾—çº¦26äº¿ä¸ªreadsã€‚<strong>ç›¸ä¼¼æµ‹åºæ·±åº¦</strong>ä¸‹<strong>20kbç²¾åº¦</strong>çš„<strong>Micro-Cå›¾è°±ä¸Hi-Cç»“æœç›¸ä¼¼</strong>ï¼Œä½†åœ¨<strong>100è‡³20kbçš„ç²¾åº¦ä¹‹é—´</strong>ï¼Œ<strong>Micro-C</strong>å±•ç¤º<strong>Hi-Cä¸å…·å¤‡</strong>çš„<strong>ç²¾ç»†</strong>ç»“æ„ï¼Œä¾‹å¦‚å¾ˆå¤šæœ‰å…³åŸºå› å¯åŠ¨å­å’Œå¢å¼ºå­çš„ç»“æ„åŸŸã€æ¡å¸¦å’Œç‚¹åœˆã€‚ä»Hi-Cå¯ä»¥å¾—åˆ°çº¦6000ä¸ªDNAç¯ï¼ˆloopï¼‰ï¼Œå³é«˜åº¦ç›¸äº’ä½œç”¨çš„ä¸€å¯¹åŒºåŸŸã€‚è€ŒMicro-Cå¯ä»¥å¾—åˆ°çº¦30000ä¸ªã€‚</p><p>åœ¨è¯å®äº†Micro-Cå…·å¤‡å¯é‡å¤æ€§å’Œé«˜ç²¾åº¦ä¹‹åï¼Œè¿›ä¸€æ­¥åˆ†æï¼Œ<font color="green">ç›¸æ¯”Hi-Cï¼ŒMicro-Cç‹¬ç‰¹</font>çš„ä¸»è¦åœ¨äºå¯æ¢æŸ¥<font color="green">è°ƒæ§å…ƒä»¶ä¹‹é—´ç›¸äº’ä½œç”¨</font>ï¼Œå¦‚EPï¼ŒPPç­‰ã€‚å…¶ä¸­æœ‰äº›ç›¸äº’ä½œç”¨å½¢æˆäº†æ¯”ä¼ ç»ŸTADå°çš„ç»“æ„åŸŸã€‚ç ”ç©¶è€…é€šè¿‡éš”ç¦»åˆ†å€¼çš„åˆ†æå¾—åˆ°äº†å¤§çº¦13ä¸‡ä¸ªè¿™æ ·çš„ç»“æ„åŸŸè¾¹ç•Œã€‚è¿™äº›<font color="green">è¾¹ç•Œé€šå¸¸æœ‰ç€æ´»è·ƒè½¬å½•çš„åŸºå› å’ŒåŠ¨æ€çš„æ ¸å°ä½“ç»“æ„</font>ï¼Œè€Œä¸ä¹‹å‰æ‰€äº†è§£çš„ï¼Œ<font color="green">ä»¥CTCFå’ŒCohesinä¸ºæ ‡å¿—çš„TADè¾¹ç•Œ</font>æœ‰å¾ˆå¤§<font color="green">ä¸åŒ</font>ã€‚</p><p>åˆ©ç”¨<strong>å›å½’æ¨¡å‹</strong>åˆ†æäº†è¿™äº›<strong>ç»“æ„åŸŸè¾¹ç•Œ</strong>å’Œ<strong>è¡¨å…³é—ä¼ ç‰¹å¾</strong>çš„<strong>å…³è”æ€§</strong>ã€‚<font color="green">CTCF</font>å’Œ<font color="green">Cohesin</font>åœ¨<font color="green">å†³å®šè¾¹ç•Œä½ç½®</font>æœ€é‡è¦ï¼Œç„¶è€Œå†³å®š<font color="green">è¾¹ç•Œå¼ºåº¦</font>å´ä¸»è¦æ˜¯<font color="green">è½¬å½•æ´»è·ƒçš„æ ‡å¿—ç‰©</font>ï¼Œå¦‚<font color="green">H3K4me3ä¿®é¥°å’ŒæŸ“è‰²è´¨å¼€æ”¾åº¦</font>ç­‰ã€‚è¿›ä¸€æ­¥å‘ç°è¾¹ç•Œä¹Ÿå­˜åœ¨å¾ˆå¤§å·®åˆ«ï¼Œå°†å…¶åˆ†ä¸ºäº”ç±»ï¼š<font color="red">è½¬å½•ç›¸å…³</font>ï¼›<font color="red">å¹²ç»†èƒç‰¹å¼‚æ€§å¢å¼ºå­</font>ï¼›<font color="red">ä¸€èˆ¬å¢å¼ºå­</font>ï¼›<font color="red">æŠ‘åˆ¶å‹</font>ï¼›<font color="red">CTCF-Cohesinç›¸å…³å‹</font>ã€‚å„æœ‰ä¸åŒçš„åŒ–å­¦ä¿®é¥°ã€‚</p><p>é€‰å–äº†ä¸€äº›ä»£è¡¨æ€§çš„åŒºåŸŸå‘ç°ï¼Œä¸ä»…<strong>å¯åŠ¨å­ã€å¢å¼ºå­å’ŒCTCFä¹‹é—´ç›¸äº’ä½œç”¨</strong>ï¼Œåœ¨<strong>èšæ¢³æŠ‘åˆ¶åŒº</strong>è¿˜å¯ä»¥è§‚å¯Ÿåˆ°æ˜¾è‘—çš„<strong>â€œå·¢çŠ¶â€ç¯</strong>ã€‚<strong>CTCFç›¸äº’ä½œç”¨èŒƒå›´è¾ƒé•¿</strong>ï¼Œè€Œ<strong>Pol II</strong>ä»‹å¯¼çš„ç›¸äº’ä½œç”¨åˆ™<strong>è¾ƒçŸ­</strong>ã€‚åŸºå› é™„è¿‘çš„ç›¸äº’ä½œç”¨è¶Šç´§å¯†ï¼Œå…¶è½¬å½•æ´»æ€§ä¹Ÿå¸¸å¸¸è¶Šé«˜ã€‚è¿›ä¸€æ­¥<strong>è¯æ˜</strong><font color="green">è½¬å½•å¯¹æŸ“è‰²è´¨æŠ˜å </font>çš„å½±å“ï¼Œåˆ©ç”¨<font color="green">è¯ç‰©æŠ‘åˆ¶è½¬å½•</font>ã€‚å¯¹æ¯”è§‚å¯Ÿåˆ°ï¼Œ<font color="green">TADç­‰å¤§å°ºåº¦ç»“æ„æ— å˜åŒ–</font>ï¼Œç„¶è€Œ<font color="green">åŸºå› é™„è¿‘çš„ç›¸äº’ä½œç”¨</font>æ¡çº¹<font color="green">å¤§å¤§å‡å¼±</font>ï¼Œè¯æ˜äº†è¿™äº›æ¡çº¹å›¢ç¡®å®æ˜¯ç”±è½¬å½•è¿‡ç¨‹å¯¼è‡´çš„ã€‚</p><p>ä¸¤ç¯‡æ–‡ç« æ˜¾ç¤ºäº†<strong>å“ºä¹³åŠ¨ç‰©</strong>çš„<font color="green">æŸ“è‰²è´¨ç›¸äº’ä½œç”¨</font>è¿˜æœ‰<font color="green">æ›´å¤šçš„ç²¾ç»†ç»“æ„ç­‰å¾…å¼€å‘</font>ã€‚æ›´é«˜ç²¾åº¦çš„æ•°æ®èƒ½å¸®åŠ©äººä»¬ç†è§£è¿™äº›<strong>ç»“æ„çš„å½¢æˆå’Œå¯¹åŸºå› è½¬å½•çš„å½±å“</strong>ã€‚</p><p>åŸæ–‡é“¾æ¥ï¼š<a href="https://mp.weixin.qq.com/s?__biz=MzA3MzQyNjY1MQ==&amp;mid=2652482974&amp;idx=3&amp;sn=acc0381ecc6ab6779e335510b87de062&amp;chksm=84e23e2ab395b73">https://mp.weixin.qq.com/s?__biz=MzA3MzQyNjY1MQ==&amp;mid=2652482974&amp;idx=3&amp;sn=acc0381ecc6ab6779e335510b87de062&amp;chksm=84e23e2ab395b73</a></p><hr><p><font color="green">æŸ“è‰²è´¨é«˜çº§ç»“æ„</font>ç”±ä¸åŒå±‚æ¬¡çš„ç»“æ„å•å…ƒç»„æˆã€‚ä»<font color="green">åŒºå—ï¼ˆcompartmentï¼‰</font>ï¼Œ<font color="green">æ‹“æ‰‘ç»“æ„åŸŸï¼ˆTADï¼‰</font>ï¼Œåˆ°å•ä¸ªçš„<font color="green">ç¯ï¼ˆloopï¼‰</font>ï¼Œè¿™äº›å¤§å°ä¸åŒçš„å•å…ƒå„æœ‰ç‰¹å¾ï¼Œä¹Ÿå¯¹<strong>æŸ“è‰²è´¨åŠŸèƒ½</strong>å’Œ<strong>åŸºå› è¡¨è¾¾</strong>èµ·åˆ°å¤šç§å¤šæ ·çš„<strong>è°ƒæ§</strong>ã€‚CTCFè›‹ç™½æ‰®æ¼”äº†é‡è¦çš„è§’è‰²ã€‚</p><p><font color="red">CTCF</font>å¸¸å¸¸ä½äº<strong>TADå’Œloopçš„è¾¹ç•Œ</strong>ï¼Œèµ·åˆ°â€œ<font color="red">éš”ç¦»å­</font>â€çš„ä½œç”¨ã€‚è¿‘å¹´æ¥æå‡ºçš„loop extrusionæ¨¡å‹ä¹Ÿè®¤ä¸º<font color="green">CTCFå’Œcohesinçš„åè°ƒä½œç”¨æ˜¯loopå½¢æˆçš„æ™®éæœºç†</font>ã€‚è™½ç„¶æœ‰å‡è®¾ï¼Œå´ä¸€ç›´ä¸æ¸…æ¥šCTCF<font color="red">å¦‚ä½•ä½œç”¨</font>äºæŸ“è‰²è´¨ï¼Œå¹¶å¯¼è‡´å¤æ‚ç»“æ„å½¢æˆã€‚CTCFè›‹ç™½çš„å„ä¸ªç»“æ„åŸŸï¼Œé™¤äº†åŒDNAç»“åˆçš„11-ZFå¤–ï¼Œå…¶ä»–ç»“æ„åŸŸåŠŸèƒ½ï¼Ÿ</p><p>2019å¹´9æœˆ12æ—¥ï¼ŒMolecular Cellæ‚å¿—å‘è¡¨èƒŒé èƒŒæ–‡ç« â€œDistinct Classes of ChromatinLoops Revealed by Deletion of anRNA-Binding Region in CTCFâ€å’Œâ€œRNA Interactions Are Essentialfor CTCF-Mediated Genome Organizationâ€<strong>ï¼Œ</strong>å…±åŒæ­ç¤º<font color="green">CTCFä¸RNAçš„ç›¸äº’ä½œç”¨</font>å¯¹CTCFåŠŸèƒ½çš„é‡è¦æ„ä¹‰ã€‚</p><p>ä¹‹å‰ç ”ç©¶å‘ç°<font color="green">CTCFå¸¸åœ¨ç»†èƒä¸­æˆç°‡èšé›†</font>ã€‚ä¸ºç ”ç©¶èšé›†çš„<font color="green">æœºç†</font>ï¼Œåœ¨ç»†èƒä¸­åˆ†åˆ«åŠ å…¥<font color="green">DNaseå’ŒRNase</font>ã€‚ç»“æœåƒæƒŠï¼Œè¢«è®¤ä¸ºæ˜¯DNAç»“åˆè›‹ç™½çš„CTCFçš„èšåˆå¯¹<font color="green">DNaseå¹¶ä¸æ•æ„Ÿ</font>ï¼Œè€Œ<font color="green">RNaseå´æ˜¾è‘—å‡å°‘äº†CTCFçš„äº’ç›¸ç»“åˆ</font>ã€‚ ç»“åˆä¹‹å‰ç ”ç©¶ï¼ŒCTCFä¸Šçš„ZF10å’ŒZF11ç»“æ„åŸŸæœ‰ä¸€æ®µå…·æœ‰RNAç»“åˆåŠŸèƒ½ï¼ˆ<font color="red">RNA-binding region</font>ï¼Œ<strong>RBR</strong>ï¼‰ï¼Œå…¶ä¸­<strong>38ä¸ªæ°¨åŸºé…¸</strong>å¯¹å…¶ç»“åˆæ˜¯å¿…ä¸å¯å°‘ã€‚ç ”ç©¶è€…äºæ˜¯åœ¨<font color="red">å°é¼ å¹²ç»†èƒ</font>ä¸Šå°†è¿™æ®µè¢«ç§°ä¸º<font color="red">RBRiçš„ç‰‡æ®µæ›¿æ¢</font>ï¼Œå‘ç°<font color="green">ç¼ºé™·å‹ç»†èƒ</font>çš„<strong>CTCFè¡¨è¾¾æ°´å¹³</strong>è™½ç„¶<strong>æ— æ˜æ˜¾å˜åŒ–</strong>ï¼Œ<strong>ç”Ÿé•¿å´æ…¢äº†2å€</strong>ï¼Œæ˜¾ç¤º<strong>RBRi</strong>å¯èƒ½å…·æœ‰é‡è¦çš„<strong>ç”Ÿç†ä½œç”¨</strong>ã€‚RBRiç¼ºé™·çš„CTCFåœ¨ç»†èƒä¸­å’ŒRNAçš„<font color="green">ç»“åˆå‡å°‘ä½†å´æ²¡æœ‰å®Œå…¨æ¶ˆå¤±</font>ã€‚ç ”ç©¶è€…æ¥ç€å¯¹<strong>RBRiç¼ºé™·å’Œä¸ç¼ºé™·çš„CTCF</strong>åˆ†åˆ«åšäº†è§å…‰<strong>æ ‡è®°</strong>ã€‚ç»“æœ<strong>é‡ç”Ÿå‹CTCF</strong>å‘ˆç°äº†æ˜æ˜¾<strong>æ›´é«˜ç¨‹åº¦èšå›¢</strong>ã€‚ä¸è¿‡è¿™äº›ç»“æœå¹¶<strong>ä¸æ’é™¤RBRié—´æ¥ä½œç”¨</strong>äºå…¶ä»–å› å­çš„å¯èƒ½ã€‚</p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Micro-C/1.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Micro-C/1.png" alt="img"></p><p>ç ”ç©¶è€…æ¥ç€åˆ†æäº†**<font color="red">RBRiç‰‡æ®µåŠŸèƒ½å’ŒCompartmentï¼ŒTADï¼ŒLoopä¸‰å¤§ç»“æ„å•å…ƒçš„å…³ç³»</font><strong>ã€‚å¯¹</strong>RBRiç¼ºé™·<strong>å’Œ</strong>é‡ç”Ÿå‹<strong>ç»†èƒ</strong>Micro-Cæµ‹åº<strong>ã€‚Micro-Cæ˜¯ä¸€ç§æ¯”Hi-Cæ¸…æ™°åº¦æ›´é«˜çš„ç ”ç©¶åŸºå› ç»„èŒƒå›´æŸ“è‰²è´¨ç›¸äº’ä½œç”¨çš„æ–¹æ³•ã€‚RBRiçš„<font color="green">ç¼ºé™·å¹¶ä¸å½±å“compartmentå½¢æˆ</font>ï¼Œä½†å´</strong><font color="red">å¤§èŒƒå›´æ”¹å˜äº†TADå’Œloopçš„ç»“æ„</font>**ã€‚å°†RBRi<font color="green">æ›¿æ¢å</font>ï¼Œå°é¼ ç»†èƒå†…<font color="green">TADçš„æ•°ç›®å’Œå¼ºåº¦éƒ½æœ‰æ‰€å‡å°‘</font>ï¼Œå…¶ä¸­<font color="green">å¤§éƒ¨åˆ†åŒTADè¾¹ç¼˜CTCFå’ŒCohesinçš„ChIP-seqä¿¡å·å˜åŒ–ä¸€è‡´</font>ã€‚RBRiçš„æ›¿æ¢ä¹Ÿä½¿å¾—<font color="green"><strong>Micro-C</strong></font>çƒ­å›¾ä¸Šçš„<font color="green"><strong>æ¡å¸¦ï¼ˆstripï¼‰å˜é•¿</strong></font>ï¼Œè¿™ç¬¦åˆloop extrusionæ¨¡å‹çš„å‡è®¾ã€‚è€Œloopçš„æ”¹å˜æ›´ä¸ºæœ‰è¶£â€“æœ‰äº›loopå®Œå…¨æ˜æ˜¾å‰Šå¼±ï¼ˆ38%ï½57%ï¼‰ï¼Œè€Œæœ‰äº›loopå´å®Œå¥½æ— æŸç”šè‡³å¢å¼ºäº†ã€‚ç ”ç©¶è€…äºæ˜¯<font color="green"><strong>å°†loopåˆ†æˆRBRiä¾èµ–å’Œä¸ä¾èµ–ä¸¤ç±»</strong></font>ï¼Œå¹¶å‘ç°å®ƒä»¬å…·æœ‰ä¸åŒçš„è½¬å½•å› å­ç»“åˆç‰¹å¾ã€‚ä»–ä»¬è¿˜æ®æ­¤å‡è®¾ï¼Œè¿™ä¸¤ç±»loopåŒCTCFæœ‰ä¸åŒçš„ç»“åˆæ–¹å¼ï¼Œå› æ­¤ç¨³å®šæ€§ä¹Ÿä¸åŒã€‚è¿™ä¹Ÿè®¸å¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆä¸æ˜¯æ‰€æœ‰çš„CTCFä½ç‚¹éƒ½ä¼šå½¢æˆloopã€‚æœ€åï¼Œå‘ç°å¤§çº¦500ä¸ªåŸºå› ç”±äºRBRiçš„æ›¿æ¢äº§ç”Ÿäº†å·®å¼‚è¡¨è¾¾ã€‚</p><p><img src="/GeekFocus/2022-02-16-chromosome-structure-Micro-C/2.png" alt="img"><br><img src="/GeekFocus/img/2022-02-16-chromosome-structure-Micro-C/2.png" alt="img"></p><p>Danny Reinbergå®éªŒå®¤åˆ™å°†ç›®å…‰é›†ä¸­åœ¨<strong>CTCFçš„ZF1å’ŒZF10ç»“æ„åŸŸ</strong>ä¸Šã€‚ä»–ä»¬å‘ç°å¯¹å°é¼ ç»†èƒçš„è½¬å½•æŠ‘åˆ¶åœ¨æ²¡æœ‰é™ä½CTCFè¡¨è¾¾æ°´å¹³çš„å‰æä¸‹ï¼Œå‡å°‘äº†CTCFåœ¨å…¨åŸºå› ç»„èŒƒå›´çš„ç»“åˆç¨‹åº¦ã€‚<font color="red">ZF1æˆ–ZF10ç¼ºé™·çš„CTCFä¸RNAçš„ç»“åˆèƒ½åŠ›éƒ½å¤§å¤§å‡å°‘ï¼Œå¹¶ä¸”åœ¨ä¸€å®šç¨‹åº¦å¯¼è‡´CTCFç»“åˆä½ç‚¹å’ŒåŸºå› è¡¨è¾¾æ”¹å˜ã€‚è€Œä¸åŒçš„æ˜¯ï¼ŒZF1ç¼ºé™·ä½¿å¾—å¤§éƒ¨åˆ†CTCF loopæ¶ˆå¤±ï¼Œè€ŒZF10ç¼ºé™·å‹ç»†èƒçš„loopå´ä»ç„¶ä¿æŒå®Œå¥½ã€‚</font></p><p><strong>è¿™ä¸¤ç¯‡èƒŒé èƒŒæ–‡ç« å…±åŒæ­ç¤ºäº†CTCFçš„RNAç»“åˆåŸŸ</strong>ï¼ˆRBRï¼‰<strong>åœ¨CTCFå‘æŒ¥æ­£å¸¸åŠŸèƒ½ä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ã€‚</strong></p>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Micro-C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTCF</title>
    <link href="/GeekFocus/2022/02/15/2022-02-15-CTCF/"/>
    <url>/GeekFocus/2022/02/15/2022-02-15-CTCF/</url>
    
    <content type="html"><![CDATA[<h1 id="ã€paper1ã€‘CTCF-the-protein-the-binding-partners-the-binding-sites-and-their-chromatin-loops"><a href="#ã€paper1ã€‘CTCF-the-protein-the-binding-partners-the-binding-sites-and-their-chromatin-loops" class="headerlink" title="ã€paper1ã€‘CTCF: the protein, the binding partners, the binding sites and their chromatin loops"></a>ã€paper1ã€‘CTCF: the protein, the binding partners, the binding sites and their chromatin loops</h1><span id="more"></span><p>review: <a href="https://pubmed.ncbi.nlm.nih.gov/23650640/">https://pubmed.ncbi.nlm.nih.gov/23650640/</a></p><h1 id="CTCF-the-protein-the-binding-partners-the-binding-sites-and-their-chromatin-loops"><a href="#CTCF-the-protein-the-binding-partners-the-binding-sites-and-their-chromatin-loops" class="headerlink" title="CTCF: the protein, the binding partners, the binding sites and their chromatin loops"></a>CTCF: the protein, the binding partners, the binding sites and their chromatin loops</h1><p>CTCF:è›‹ç™½è´¨ï¼Œç»“åˆä¼™ä¼´ï¼Œç»“åˆä½ç‚¹å’ŒæŸ“è‰²è´¨ç¯</p><p>CTCFä»€ä¹ˆéƒ½æœ‰ã€‚è½¬å½•å› å­ä¸æˆåƒä¸Šä¸‡ä¸ªåŸºå› ç»„ä½ç‚¹ç»“åˆï¼Œæœ‰äº›æ˜¯ç»„ç»‡ç‰¹å¼‚æ€§çš„ï¼Œæœ‰äº›æ˜¯è¶…ä¿å®ˆçš„ã€‚å®ƒå¯ä»¥ä½œä¸º<strong>è½¬å½•æ¿€æ´»å› å­</strong>ã€<strong>æŠ‘åˆ¶å­</strong>å’Œ<strong>ç»ç¼˜å­</strong>ï¼Œå¹¶å¯ä»¥<strong>æš‚åœè½¬å½•</strong>ã€‚CTCF<strong>ç»“åˆ</strong>åœ¨<strong>æŸ“è‰²è´¨ç»“æ„åŸŸè¾¹ç•Œ</strong>ï¼Œ<strong>å¢å¼ºå­</strong>å’Œ<strong>å¯åŠ¨å­</strong>ï¼Œä»¥åŠ<strong>åŸºå› åŒº</strong>ã€‚å®ƒå¯ä»¥å¸å¼•è®¸å¤šå…¶ä»–è½¬å½•å› å­åˆ°æŸ“è‰²è´¨ï¼ŒåŒ…æ‹¬ç»„ç»‡ç‰¹å¼‚æ€§è½¬å½•æ¿€æ´»å› å­ã€æŠ‘åˆ¶å­ã€ç²˜è¿è›‹ç™½å’ŒRNAèšåˆé…¶IIï¼Œå¹¶å½¢æˆæŸ“è‰²è´¨ç¯ã€‚å› æ­¤ï¼ŒCTCFåœ¨ç‰¹å®šåŸºå› ç»„ä½ç‚¹çš„ç¡®åˆ‡åŠŸèƒ½æ˜¯ä¸å¯é¢„æµ‹çš„ã€‚å®ƒä¼¼ä¹æ˜¯ç”±ç›¸å…³çš„è½¬å½•å› å­ã€ç»“åˆä½ç‚¹ç›¸å¯¹äºåŸºå› è½¬å½•èµ·å§‹ä½ç‚¹çš„ä½ç½®ã€ä»¥åŠè¯¥ä½ç‚¹åœ¨æŸ“è‰²è´¨ç¯ä¸­ä¸å…¶ä»–ctcfä½ç‚¹çš„ç»“åˆã€ä¸å¢å¼ºå­æˆ–å¯åŠ¨å­çš„ç»“åˆå†³å®šçš„ã€‚è¯¥reviewå°†è®¨è®ºCTCFç»“åˆäº‹ä»¶çš„å…¨åŸºå› ç»„ç‰¹å¾ï¼Œä»¥åŠè¿™ä¸ªæ˜¾è‘—çš„è½¬å½•å› å­çš„ä½ç‚¹ç‰¹å¼‚æ€§åŠŸèƒ½ã€‚</p><ol><li>introduction</li></ol><p>CTCFæ˜¯ä¸€ç§æ™®éè¡¨è¾¾çš„å¿…éœ€è›‹ç™½ï¼Œåœ¨è®¸å¤šæ–¹é¢éƒ½æ˜¯ä¸€ç§ç‰¹æ®Šçš„è½¬å½•å› å­ã€‚å®ƒæœ€åˆè¢«æè¿°ä¸ºè½¬å½•<strong>æŠ‘åˆ¶</strong>å› å­ï¼Œä½†ä¹Ÿè¢«å‘ç°ä½œä¸ºè½¬å½•<strong>æ¿€æ´»</strong>å› å­ã€‚è¿˜å…·æœ‰<strong>ç»ç¼˜ä½“æ´»æ€§</strong>:å½“å®ƒä½äºå¢å¼ºå­å’ŒåŸºå› å¯åŠ¨å­ä¹‹é—´æ—¶ï¼Œå®ƒé˜»æ–­å®ƒä»¬çš„é€šä¿¡å¹¶é˜»æ­¢è½¬å½•æ¿€æ´»ã€‚é€šè¿‡<strong>ChIP-seq</strong>ç³»ç»Ÿç ”ç©¶ï¼Œåœ¨<strong>ä¸åŒç‰©ç§çš„è®¸å¤šç»„ç»‡</strong>ä¸­ç»˜åˆ¶CTCFåœ¨åŸºå› ç»„å°ºåº¦çš„ç»“åˆäº‹ä»¶ã€‚ç»“æœæ˜¾ç¤ºåŸºå› ç»„è¢«<strong>æ— æ•°çš„CTCFç»“åˆä½ç‚¹</strong>æ‰€è¦†ç›–ã€‚ä¸å¤§å¤šæ•°å…¶ä»–è½¬å½•å› å­ç›¸æ¯”ï¼ŒCTCFä¼¼ä¹<strong>æ›´å®¹æ˜“</strong>ä¸åŸºå› é—´åºåˆ—<strong>ç»“åˆ</strong>ï¼Œé€šå¸¸<strong>è·</strong>ç¦»è½¬å½•èµ·å§‹ä½ç‚¹(<strong>TSS</strong>)<strong>è¾ƒè¿œ</strong>ã€‚CTCFæ˜¯<strong>æœ€æ—©è¢«è¯å®ä»‹å¯¼æŸ“è‰²è´¨æˆç¯</strong>çš„è›‹ç™½ä¹‹ä¸€ã€‚è¿›ä¸€æ­¥è§‚å¯Ÿåˆ°ï¼Œå®ƒç»å¸¸ä¼š<strong>ç»“åˆ</strong>åˆ°ä½äºç»†èƒæ ¸ä¸­ä¸åŒä½ç½®çš„<strong>æŸ“è‰²ä½“åŒºåŸŸä¹‹é—´çš„è¾¹ç•Œ</strong>ï¼Œ<strong>ç»“åˆ</strong>å…·æœ‰<strong>ä¸åŒè¡¨è§‚é—ä¼ ç‰¹å¾</strong>å’Œ&#x2F;æˆ–<strong>ä¸åŒè½¬å½•æ´»æ€§</strong>çš„<strong>åŒºåŸŸè¾¹ç•Œ</strong>ï¼Œä»¥åŠæœ€è¿‘ç¡®å®šçš„<strong>æ‹“æ‰‘åŸŸä¹‹é—´çš„è¾¹ç•Œ</strong>ï¼Œè¿™æ˜¯ç©ºé—´ä¸Šç¡®å®šçš„<strong>æŸ“è‰²ä½“å•ä½</strong>ï¼Œåœ¨å…¶ä¸­<strong>åºåˆ—ä¼˜å…ˆç›¸äº’ä½œç”¨</strong>ã€‚æœ¬æ–‡è®¨è®ºCTCFçš„ç ”ç©¶ï¼Œå¹¶è¯„ä¼°å…¶åœ¨<strong>åŸºå› ç»„æŠ˜å </strong>å’Œ<strong>åŸºå› è¡¨è¾¾</strong>ä¸­çš„åŠŸèƒ½ã€‚</p><ol start="2"><li>CTCFåœ¨<strong>Î’-globin</strong>å’Œ<strong>h19-igf2</strong>ä½ç‚¹:ä¸€ä¸ªçŸ­æš‚çš„å†å²</li></ol><p>å¤šåŠŸèƒ½DNAç»“åˆè›‹ç™½CTCFçš„åŠŸèƒ½æœ€åˆæ˜¯åœ¨<strong>å•ä¸ªä½ç‚¹</strong>ä¸Šæ¢ç´¢çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨<strong>Î²-ç è›‹ç™½ä½ç‚¹</strong>å’Œ<strong>å°è¿¹H19-Igf2ä½ç‚¹</strong>ã€‚<strong>chicken Î²-ç è›‹ç™½ä½ç‚¹</strong>åœ¨å…¶5 â€˜ä¾§æºå¸¦ä¸€ä¸ªDNaseIè¶…æ•ä½ç‚¹(5 â€˜ hs4)ï¼Œè¯¥ä½ç‚¹å°†è¯¥ä½ç‚¹<strong>ä¸é‚»è¿‘çš„å¼‚æŸ“è‰²è´¨åˆ†ç¦»</strong>ï¼Œè¯¥ä½ç‚¹è¢«å‘ç°èƒ½å¤Ÿ<strong>é˜»æ–­å¢å¼ºå­æ´»æ€§</strong>ã€‚CTCFéšåè¢«è¯æ˜ä¸5 â€˜ hs4çš„ç»ç¼˜ä½“æ´»æ€§æœ‰å…³ã€‚äººå’Œå°é¼ çš„Î²-ç è›‹ç™½ä½ç‚¹ä¹Ÿä½äºä¸æ´»è·ƒæŸ“è‰²è´¨çš„å¤§æŸ“è‰²ä½“åŒºåŸŸå†…ï¼Œå¹¶ç±»ä¼¼åœ°è¢«ctcfç»“åˆä½ç‚¹åŒ…å›´ã€‚è¿™äº›è¢«æ€€ç–‘ä¼šå¯¹è¿›å…¥çš„å¼‚æŸ“è‰²è´¨å½¢æˆå±éšœï¼Œä½†å®ƒä»¬çš„ç¼ºå¤±ä¸ä¼šå¯¼è‡´Î²-ç è›‹ç™½ä½ç‚¹çš„å…³é—­æˆ–å¤±æ´»ã€‚<strong>æŸ“è‰²ä½“æ„è±¡æ•è·(3C)æŠ€æœ¯</strong>çš„åº”ç”¨ä½¿Î²-ç è›‹ç™½CTCFä½ç‚¹çš„ç‰©ç†ç›¸äº’ä½œç”¨æˆä¸ºå¯èƒ½ã€‚å®ƒä»¬å½¢æˆ<strong>å¤§æŸ“è‰²è´¨ç¯</strong>ï¼ŒåŒ…æ‹¬Î²-ç è›‹ç™½çš„ä¸»è¦è°ƒèŠ‚å…ƒä»¶ï¼Œ<strong>Locus control regionåŸºå› ä½ç‚¹æ§åˆ¶åŒº(LCR)<strong>åŠå…¶</strong>åŸºå› </strong>ã€‚è¿™äº›ç¯æ˜¯çº¢ç»†èƒç‰¹å¼‚æ€§çš„ï¼Œåœ¨lcrä»‹å¯¼çš„Î²-ç è›‹ç™½åŸºå› é«˜è¡¨è¾¾ä¹‹å‰ï¼Œåœ¨çº¢ç»†èƒç¥–ç»†èƒä¸­å½¢æˆ(å›¾1a;)ã€‚æ®æ¨æµ‹ï¼ŒCTCFç¯å¯ä»¥<strong>ä¿ƒè¿›LCRä¸å…¶é¶åŸºå› ä¹‹é—´çš„åç»­ç©ºé—´ç›¸äº’ä½œç”¨</strong>ï¼Œä½†è¿™æ–¹é¢çš„è¯æ®ä»ç„¶ç¼ºä¹ã€‚</p><p><img src="/GeekFocus/2022-02-15-CTCF/1.png"><br><img src="/GeekFocus/img/2022-02-15-CTCF/1.png"></p><p>Figure 1. CTCFï¼ŒæŸ“è‰²è´¨ç¯å’Œç‰¹å®šåŸºå› ä½ç‚¹çš„è½¬å½•è°ƒæ§ã€‚(a)<strong>ä½äºÎ²-ç è›‹ç™½ä½ç‚¹çš„åŸºå› </strong>å—<strong>åŸºå› ä½ç‚¹æ§åˆ¶åŒº(LCR)*<em><strong>æ§åˆ¶ã€‚</strong>ctcfç»“åˆä½ç‚¹ç›¸äº’ä½œç”¨</em>*ï¼Œå½¢æˆ</strong>æŸ“è‰²è´¨æ¢çº½<strong>ï¼Œå…¶ä¸­åŒ…å«</strong>LCRå’ŒÎ²-ç è›‹ç™½åŸºå› <strong>ã€‚åœ¨</strong>çº¢ç»†èƒåˆ†åŒ–<strong>æ—¶ï¼Œ</strong>çº¢ç»†èƒç‰¹å¼‚æ€§è½¬å½•å› å­å’Œå†…èšè›‹ç™½èƒ½å¤Ÿå½¢æˆä¸€ä¸ªæ´»è·ƒçš„æŸ“è‰²è´¨æ¢çº½<strong>ï¼Œå…¶ä¸­</strong>LCRä¸åŸºå› æ¥è§¦å¹¶å¢å¼ºå…¶è¡¨è¾¾<strong>ã€‚(b) H19å’ŒIgf2åŸºå› çš„å°è¿¹è¡¨è¾¾æ˜¯é€šè¿‡CTCFåœ¨å°è¿¹æ§åˆ¶åŒº(ICR)çš„ç”²åŸºåŒ–ä¾èµ–ç»“åˆä»‹å¯¼çš„ã€‚(i)åœ¨çˆ¶ç³»ç­‰ä½åŸºå› ä¸Šï¼ŒICRçš„ç”²åŸºåŒ–</strong>é˜»æ­¢CTCFç»“åˆ**ï¼Œå¹¶é€šè¿‡è¿œç«¯å¢å¼ºå­(E)ä¸Igf2å¯åŠ¨å­çš„æ¥è§¦ä»‹å¯¼Igf2åŸºå› çš„è¡¨è¾¾ã€‚(ii) <strong>CTCFç»“åˆåœ¨ICRä¸Šé˜»æ–­äº†Igf2åŸºå› å’Œè¿œç«¯å¢å¼ºå­ä¹‹é—´çš„é€šä¿¡</strong>ï¼Œä»è€Œå¯¼è‡´æ¯æºç­‰ä½åŸºå› H19åŸºå› çš„è¡¨è¾¾ã€‚</p><p>å°è¿¹H19&#x2F;Igf2ä½ç‚¹ã€‚è¯¥ä½ç‚¹åŒ…å«ä¸€ä¸ª<strong>å·®å¼‚ç”²åŸºåŒ–åŒºåŸŸ</strong>ï¼Œç§°ä¸º<strong>å°è¿¹æ§åˆ¶åŒº(ICR)<strong>ï¼Œä½äºH19å’ŒIgf2åŸºå› ä¹‹é—´ã€‚ICRå†³å®šäº†H19åœ¨</strong>æ¯ä½“ç­‰ä½åŸºå› </strong>ä¸Š<strong>æ´»è·ƒ</strong>ï¼Œè€Œ<strong>Igf2</strong>åˆ™æ˜¯ä»<strong>çˆ¶ç³»ç­‰ä½åŸºå› è½¬å½•</strong>è€Œæ¥çš„ã€‚å½“CTCFè¢«å‘ç°ä»¥<strong>ç”²åŸºåŒ–ä¾èµ–</strong>çš„æ–¹å¼ä¸<strong>ICRç»“åˆ</strong>æ—¶ï¼ŒCTCFè¿›å…¥äº†è¿™ä¸ªé˜¶æ®µ:<strong>CTCFä¸æœªç”²åŸºåŒ–çš„æ¯æºICRçš„ç»“åˆé˜»</strong>æ­¢äº†H19åŸºå› é™„è¿‘çš„å…±äº«å¢å¼ºå­<strong>è·¨è¶Šå¹¶æ¿€æ´»</strong>Igf2ã€‚åœ¨<strong>çˆ¶ç³»ç­‰ä½åŸºå› CTCFä¸èƒ½å‘æŒ¥å…¶ç»ç¼˜ä½“æ´»æ€§ï¼Œå› ä¸ºDNAç”²åŸºåŒ–é˜»æ­¢äº†å…¶ä¸ICRçš„ç»“åˆ</strong>(å›¾1b;)ã€‚æŸ“è‰²è´¨ç¯å†æ¬¡å½¢æˆï¼Œä¼¼ä¹å¯¹ICRçš„åŠŸèƒ½å¾ˆé‡è¦ã€‚å¸¦æœ‰å¢å¼ºå­å’Œå¯åŠ¨å­çš„ç­‰ä½åŸºå› ç‰¹å¼‚æ€§æŸ“è‰²è´¨ç¯æ˜¯ç”±æ¯ä½“çš„ã€ä¸ctcfç»“åˆçš„ICRå½¢æˆçš„ï¼Œè¿™è¡¨æ˜è¿™ç§æ¥è§¦å¯èƒ½æ˜¯ctcfä»‹å¯¼çš„ç»ç¼˜ä½“æ´»æ€§çš„åŸºç¡€ã€‚æ€»çš„æ¥è¯´ï¼Œæ—©æœŸå…³äºCTCFåœ¨Î²-ç è›‹ç™½å’ŒH19-Igf2ä½ç‚¹åŠŸèƒ½çš„ç ”ç©¶è¡¨æ˜ï¼Œè¯¥è›‹ç™½å¯ä»¥<strong>å¹²æ‰°å¯åŠ¨å­-å¢å¼ºå­é€šä¿¡</strong>ã€‚CTCFå¯ä»¥åœ¨å…¶ç»“åˆä½ç‚¹ä¹‹é—´å½¢æˆæŸ“è‰²è´¨ç¯ï¼Œä¹Ÿå¯èƒ½ä¸å…¶ä»–è°ƒæ§åºåˆ—å½¢æˆæŸ“è‰²è´¨ç¯ã€‚</p><ol start="3"><li>CTCFé€šè¿‡åŸºå› ç»„ä¸æŸ“è‰²è´¨è¾¹ç•Œã€å¢å¼ºå­å’ŒåŸºå› å¯åŠ¨å­ç»“åˆ</li></ol><p>é€šè¿‡ChIPå¯¹å…¨åŸºå› ç»„ç»“åˆä½ç‚¹çš„å®šä½å‘ç°ï¼ŒCTCFå¯ä¸æ•°ä¸‡ä¸ªåŸºå› ç»„ä½ç‚¹ç»“åˆã€‚åœ¨ä¸åŒçš„ç»†èƒç±»å‹ä¸­ï¼Œå¤§çº¦<strong>ä¸‰åˆ†ä¹‹ä¸€çš„ä½ç‚¹ç›¸å¯¹ä¿å®ˆ</strong>ã€‚ä¸€é¡¹å¯¹äº”ç§å“ºä¹³åŠ¨ç‰©è‚è„ä¸­CTCFç»“åˆè°±çš„ç‰©ç§é—´æ¯”è¾ƒå‘ç°ï¼Œç‰©ç§å’Œç»„ç»‡ä¹‹é—´å¤§çº¦æœ‰5000ä¸ªè¶…<strong>ä¿å®ˆä½ç‚¹</strong>ã€‚è¿™äº›ä¼¼ä¹æ˜¯<strong>é«˜äº²å’ŒåŠ›çš„ç»“åˆä½ç‚¹</strong>ï¼Œæç¤ºäº²å’ŒåŠ›çš„å·®å¼‚å¯èƒ½ä¸çš„ä¿å®ˆå¼ºåº¦æœ‰å…³ã€‚é€†è½¬å½•å› å­çš„æ¿€æ´»äº§ç”Ÿäº†ç‰©ç§ç‰¹å¼‚æ€§çš„CTCFç»“åˆä½ç‚¹çš„æ‰©å±•ï¼Œè¿™ç§å½¢å¼çš„åŸºå› ç»„è¿›åŒ–åœ¨å“ºä¹³åŠ¨ç‰©ä¸­ä»ç„¶é«˜åº¦æ´»è·ƒã€‚åŸºäºä¸€è‡´motifè¯„åˆ†å¯¹CTCFç»“åˆä½ç‚¹è¿›è¡Œåˆ†ç±»å¾—å‡ºäº†ç±»ä¼¼çš„ç»“è®º:<strong>é«˜å ç”¨ä½ç‚¹ä¼¼ä¹åœ¨æ‰€æœ‰ç»†èƒç±»å‹ä¸­éƒ½æ˜¯ä¿å®ˆçš„ï¼Œè€Œä½å ç”¨ä½ç‚¹åˆ™æ›´å—ç»„ç»‡é™åˆ¶</strong>ã€‚</p><p>CTCFä¸€è‡´ç»“åˆåºåˆ—åŒ…å«CpGï¼Œå› æ­¤å¯èƒ½å—åˆ°DNAç”²åŸºåŒ–çš„å½±å“ã€‚CTCFèƒ½å¤Ÿåœ¨<strong>ä½“å¤–ç»“åˆç”²åŸºåŒ–DNAåºåˆ—</strong>ï¼Œä½†<strong>ä¼˜å…ˆç»“åˆæœªç”²åŸºåŒ–çš„åºåˆ—</strong>ï¼Œåœ¨H19-Igf2ä½ç‚¹ä¹Ÿå¯ä»¥çœ‹åˆ°ã€‚äº‹å®ä¸Šï¼ŒDNAç”²åŸºåŒ–ä¼¼ä¹åœ¨CTCFçš„ä¸€äº›ç»„ç»‡ç‰¹å¼‚æ€§ç»“åˆäº‹ä»¶ä¸­å‘æŒ¥ä½œç”¨ã€‚æ­¤å¤–ï¼Œ<strong>CTCF</strong>å¯ä»¥é€šè¿‡ä¸ä¸¤ç§ä¸DNAç”²åŸºåŒ–ç›¸å…³çš„é…¶:å¤šèš(adp -æ ¸ç³–)èšåˆé…¶1 (<strong>PARP1</strong>)å’Œæ— å¤„ä¸åœ¨è¡¨è¾¾çš„DNA(èƒå˜§å•¶-5)ç”²åŸºè½¬ç§»é…¶1 (<strong>DNMT1</strong>)å½¢æˆ<strong>å¤åˆç‰©æ¥å½±å“DNAç”²åŸºåŒ–</strong>ã€‚<strong>CTCFæ¿€æ´»PARP1, PARP1åœ¨DNMT1ä¸Šæ·»åŠ adp -æ ¸ç³–åŸºå›¢ä½¿DNMT1å¤±æ´»ï¼Œä»è€Œç»´æŒæ— ç”²åŸºCpGsçš„å­˜åœ¨</strong>ã€‚</p><p><strong>éƒ¨åˆ†CTCFç»“åˆä½ç‚¹</strong>åœ¨<strong>æ´»æ€§æŸ“è‰²è´¨</strong>(<strong>é«˜H2K5Ac</strong>)å’Œ<strong>éæ´»æ€§</strong>æŸ“è‰²è´¨ç»“æ„åŸŸ(<strong>é«˜H3K27me3</strong>)ä¹‹<strong>é—´</strong>çš„è¿‡æ¸¡<strong>å¯Œé›†</strong>ã€‚å¯¹äºé€†è½¬å½•è½¬åº§çš„CTCFç»“åˆä½ç‚¹ä¼¼ä¹å°¤å…¶å¦‚æ­¤ã€‚CTCFä½ç‚¹ç»å¸¸ä½äºæ‰€è°“çš„<strong>è†œç›¸å…³åŸŸ</strong>(lad)æ—è¾¹ã€‚ladæ˜¯ä¸<strong>è¦†ç›–æ ¸è†œå†…ä¾§çš„å±‚çŠ¶è›‹ç™½ç½‘ç»œç›¸å…³çš„æŸ“è‰²ä½“åŒºåŸŸ</strong>;è¿™äº›æŸ“è‰²ä½“åŒºåŸŸå¾€å¾€æ˜¯<strong>è½¬å½•ä¸æ´»è·ƒ</strong>çš„ã€‚å®ƒçš„å­˜åœ¨æç¤º<strong>CTCFæœ‰åŠ©äºæŸ“è‰²è´¨çš„ä¸‰ç»´ç»“æ„çš„ç»„ç»‡</strong>ã€‚åœ¨æœè‡ä¸­ï¼ŒCTCFçš„æŠ‘åˆ¶å¯¼è‡´éæ´»æ€§åŸŸå†…H3K27me3æ°´å¹³çš„é™ä½ï¼Œè¡¨æ˜CTCFåœ¨è¾¹ç•Œä¸Šçš„ç»“åˆæ˜¯<strong>ç»´æŒæŠ‘åˆ¶</strong>æ‰€å¿…éœ€çš„ã€‚CTCFçš„å…³è”ä¼´éšç€ç»†èƒåˆ†åŒ–è¿‡ç¨‹ä¸­<strong>æ´»æ€§åŸŸå’Œéæ´»æ€§åŸŸçš„é‡ç½®</strong>ï¼Œè¿›ä¸€æ­¥è¡¨æ˜å®ƒçš„åŠŸèƒ½æ˜¯<strong>åˆ†ç¦»ä¸åŒçš„æŸ“è‰²è´¨çŠ¶æ€</strong>ã€‚ä¸€äº›ladåœ¨ç»†èƒåˆ†åŒ–è¿‡ç¨‹ä¸­ä¹Ÿä¼šå‘ç”ŸåŠ¨æ€å˜åŒ–[35]ï¼Œä½†CTCFæ˜¯å¦ä¸è¿™äº›å·®å¼‚ladçš„è¾¹ç•Œç»“åˆç›®å‰å°šä¸æ¸…æ¥šã€‚</p><p>å°½ç®¡CTCFç»“åˆå¸¸å‡ºç°åœ¨TSSsè¿œç«¯ï¼Œä½†å®ƒç¡®å®ä¸<strong>åŸºå› å¯†åº¦æœ‰å¾ˆå¼ºçš„ç›¸å…³æ€§</strong>(å›¾2a,b)ã€‚äº‹å®ä¸Šï¼ŒCTCFåœ¨è½¬å½•è°ƒæ§ä¸­<strong>ç›´æ¥ä½œç”¨çš„è¯æ®æ¥è‡ªäºæ—©æœŸå¯¹å•ä¸ªåŸºå› çš„ç ”ç©¶</strong>ã€‚åœ¨å…¨åŸºå› ç»„èŒƒå›´å†…ï¼Œéƒ¨åˆ†CTCFä½ç‚¹ä¸<strong>å¯åŠ¨å­ç‰¹å¼‚æ€§H3K4me3æ ‡è®°å…±å®šä½</strong>ï¼Œå¦ä¸€éƒ¨åˆ†ä¸<strong>å¢å¼ºå­æ ‡è®°H3K4me1é‡åˆ</strong>ã€‚å¯åŠ¨å­ä¸Šçš„CTCFç»“åˆäº‹ä»¶åœ¨ç»„ç»‡ä¸­è¶‹äº<strong>ä¿å®ˆ</strong>ï¼Œè€ŒCTCFä¸å¢å¼ºå­çš„ç»“åˆåˆ™æ›´å—<strong>ç»„ç»‡é™åˆ¶</strong>ã€‚</p><p><img src="/GeekFocus/2022-02-15-CTCF/2.png"><br><img src="/GeekFocus/img/2022-02-15-CTCF/2.png"></p><p>Figure2. CTCFåœ¨æŸ“è‰²è´¨ç”Ÿç‰©å­¦ä¸­çš„å¹¿æ³›ä½œç”¨ã€‚(a) CTCFç»“åˆä½ç‚¹çš„å…¨åŸºå› ç»„åŠŸèƒ½åˆ†ç±»ï¼Œé‡‡ç”¨Chen et al.[36]ã€‚(b) (i) CTCFç»“åˆä½ç‚¹ä½äº<strong>åˆ†ç¦»æ´»æ€§åŸŸå’Œéæ´»æ€§åŸŸçš„è¾¹ç•Œ</strong>ä¸Šã€‚CTCFç»“åˆåˆ°(ii)<strong>å¢å¼ºå­</strong>æ ·åºåˆ—å’Œ(iv)åŸºå› <strong>å¯åŠ¨å­</strong>ä¸Šå¯ä»¥ä¿ƒè¿›è¿™äº›åºåˆ—ä¹‹é—´çš„ç¯ç¯ç›¸æ‰£ã€‚(iii) CTCFç»“åˆåœ¨<strong>å¢å¼ºå­å’ŒåŸºå› å¯åŠ¨å­ä¹‹é—´</strong>ï¼Œå¯ä»¥<strong>é˜»æ–­</strong>å¢å¼ºå­ä¸å…¶ç›®æ ‡å¯åŠ¨å­ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚</p><ol start="4"><li>CTCFå’Œå†…èšè›‹ç™½å…±äº«DNAç»“åˆä½ç‚¹</li><li>5.ctcfå’Œå…¶ä»–ç»‘å®šä¼™ä¼´</li><li>CTCFåœ¨å•ä¸ªåŸºå› ä½ç‚¹çš„åŠŸèƒ½</li><li>CTCFä»‹å¯¼çš„å…¨åŸºå› ç»„æŸ“è‰²è´¨ç¯</li></ol><p>CTCFçš„åŸºå› ç»„ç»“åˆä½ç‚¹(é€šè¿‡å…¨åŸºå› ç»„<strong>ChIP</strong>)ä¸<strong>Hi-C</strong>ç”Ÿæˆçš„<strong>genome-wide DNA contact map</strong>çš„è®¡ç®—äº¤å‰è¡¨æ˜ï¼ŒCTCFå‚ä¸æŸ“è‰²ä½“ä¹‹é—´å’ŒåŸºå› ç»„å†…çš„æŸ“è‰²è´¨ç›¸äº’ä½œç”¨ã€‚æŸ“è‰²è´¨ç›¸äº’ä½œç”¨åˆ†æä¸é…å¯¹æœ«ç«¯æ ‡è®°æµ‹åº<strong>Chromatin interaction analysis with paired-end tag sequencing (ChIA-PET)</strong> ç»“åˆäº†ChIPå’Œ3Cæ–¹æ³•ï¼Œç”¨äºç ”ç©¶ç”±<strong>æ„Ÿå…´è¶£çš„è›‹ç™½è´¨ä»‹å¯¼çš„å…¨åŸºå› ç»„DNAç›¸äº’ä½œç”¨</strong>ã€‚å½“é¶å‘CTCFæ—¶ï¼ŒChIA-PETæ­ç¤ºäº†è›‹ç™½ä»‹å¯¼çš„å¤§çº¦<strong>1500ä¸ªæŸ“è‰²ä½“å†…</strong>å’Œ<strong>300ä¸ªæŸ“è‰²ä½“é—´</strong>çš„ç›¸äº’ä½œç”¨ã€‚éšåï¼Œæ ¹æ®<strong>ç»„è›‹ç™½æ ‡è®°</strong>çš„åˆ†å¸ƒï¼Œå¯¹<strong>æŸ“è‰²ä½“å†…ç¯</strong>æ‰€åŒ…å›´çš„<strong>åŒºåŸŸ(10-200 kb)è¿›è¡Œèšç±»</strong>ã€‚è¿™è¡¨æ˜CTCFç¯å¯ä»¥åŒ…å«ä»ç¯å¤–éæ´»æ€§æŸ“è‰²è´¨åˆ†ç¦»å‡ºæ¥çš„æ´»æ€§æŸ“è‰²è´¨ï¼Œåä¹‹äº¦ç„¶ã€‚CTCFè¿˜å¯ä»¥åŒæ—¶<strong>æ•è·æŸ“è‰²è´¨ç¯ä¸­çš„å¢å¼ºå­å’Œå¯åŠ¨å­</strong>ã€‚åœ¨å¤§çº¦<strong>40000ä¸ªCTCFç»“åˆä½ç‚¹</strong>ä¸­ï¼Œåªæœ‰<strong>ä¸€å°éƒ¨åˆ†</strong>å‚ä¸äº†å¤§çº¦1500ä¸ªCTCFä»‹å¯¼çš„<strong>ç¯</strong>ã€‚è¿™æ„å‘³ç€ä¸æ˜¯æ‰€æœ‰CTCFä»‹å¯¼çš„ç›¸äº’ä½œç”¨éƒ½è¢«è¯†åˆ«å‡ºæ¥äº†ï¼Œæˆ–è€…<strong>å¤§å¤šæ•°CTCFä½ç‚¹æ²¡æœ‰å‚ä¸ç¯çš„å½¢æˆ</strong>ã€‚</p><p>åè€…å¾ˆå¯èƒ½æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸º5C(<strong>chromosome conformation capture carbon copy</strong>æŸ“è‰²ä½“æ„è±¡æ•è·ç¢³å¤åˆ¶)æŠ€æœ¯è¡¨æ˜ï¼Œåœ¨1%çš„åŸºå› ç»„ä¸­ï¼Œå¤§å¤šæ•°CTCFä½ç‚¹ä¸å‚ä¸æŸ“è‰²è´¨ç¯ï¼Œæ— è®ºå®ƒä»¬æ˜¯å¦è¢«å†…èšè›‹ç™½å…±åŒå æ®ã€‚<strong>CTCFç»“åˆåºåˆ—å¸¸è¢«åŸºå› å¯åŠ¨å­è·³è¿‡ï¼Œä¸å¢å¼ºå­æˆ–æ›´è¿œçš„CTCFä½ç‚¹è¿›è¡Œæ¥è§¦</strong>ã€‚</p><p>æœ€è¿‘å¤§é‡çš„å…¨åŸºå› ç»„DNAç›¸äº’ä½œç”¨æ•°æ®é›†æœ‰åŠ©äº<strong>è¯„ä¼°CTCFå¯¹æŸ“è‰²ä½“æ‹“æ‰‘çš„å½±å“</strong>ã€‚æŸ“è‰²ä½“ä¸Šé è¿‘<strong>CTCFç»“åˆä½ç‚¹çš„åºåˆ—</strong>æ˜¾ç¤ºåœ¨å®ƒä»¬çš„DNAæ¥è§¦ä¸­å­˜åœ¨åå€š:å®ƒä»¬ä¸<strong>CTCFä½ç‚¹åŒä¾§</strong>çš„å…¶ä»–<strong>åºåˆ—çš„ç›¸äº’ä½œç”¨</strong>å¤§äºä¸<strong>CTCFä½ç‚¹è·¨ä¾§</strong>çš„åºåˆ—çš„ç›¸äº’ä½œç”¨(å›¾3a;)ã€‚åŒæ ·çš„ç»“æœä¹Ÿå‡ºç°åœ¨æœè‡ä¸­å¦ä¸€ç§ä¸åŒçš„ç»ç¼˜ä½“è›‹ç™½ä¸Š:å®ƒä¸ä¸€ä¸ªä½ç‚¹çš„ç»“åˆé˜»æ­¢äº†ä¾§ç¿¼åºåˆ—åœ¨è¿™ä¸ªä½ç‚¹ä¸Šç›¸äº’æ¥è§¦ã€‚æœ‰è¶£çš„æ˜¯ï¼Œè¿™å¯èƒ½ä¸ºç»ç¼˜ä½“çš„åŠŸèƒ½æä¾›äº†ä¸€ç§è§£é‡Š:å®ƒä»¬å¯ä»¥é˜»æ­¢DNAåœ¨ç»ç¼˜åºåˆ—ä¸Šçš„ç©ºé—´æ¥è§¦ã€‚åœ¨ä¸€ä¸ªç‰¹åˆ«è¯¦ç»†çš„å…¨åŸºå› ç»„DNAæ¥è§¦ç ”ç©¶ä¸­ï¼Œ<strong>æ‹“æ‰‘åŸŸ</strong>è¢«å®šä¹‰;å®ƒä»¬æ˜¯<strong>å¹³å‡å¤§å°ä¸º1mbçš„æŸ“è‰²ä½“åŒºåŸŸ</strong>ï¼Œå…¶ä¸­<strong>åºåˆ—ä¼˜å…ˆç›¸äº’ä½œç”¨</strong>ã€‚åœ¨ç»„ç»‡ä¹‹é—´ï¼Œç”šè‡³åœ¨ç‰©ç§ä¹‹é—´ï¼Œæ‹“æ‰‘ç»“æ„åŸŸå…·æœ‰å¾ˆå¼ºçš„<strong>ä¿æŒæ€§</strong>ï¼Œè¿™è¡¨æ˜è¿™äº›ç»“æ„åŸŸå¯¹<strong>ç»†èƒçš„ç‰¹å¼‚æ€§èº«ä»½æ²¡æœ‰è´¡çŒ®</strong>ã€‚æœ‰è¶£çš„æ˜¯ï¼ŒCTCFç»“åˆä½ç‚¹åœ¨è¿™äº›<strong>åŒºåŸŸè¾¹ç•Œå‘¨å›´çš„20kbçª—å£ä¸­å¯Œé›†</strong>(å›¾3b)ï¼Œå†æ¬¡å¼ºè°ƒäº†å…¶ä½œä¸º<strong>æŸ“è‰²è´¨ç»„ç»‡è€…</strong>çš„ä½œç”¨ã€‚å…¶ä¸­ä¸€é¡¹ç ”ç©¶è¡¨æ˜ï¼Œè¾¹ç•Œçš„ç ´åä¼šå¯¼è‡´æ‹“æ‰‘åŸŸçš„æ··åˆï¼Œå¹¶å¯¼è‡´ç›¸å…³åŸºå› çš„è¡¨è¾¾å¤±è°ƒ[79]ã€‚ä¸åŒäºæ‹“æ‰‘åŸŸæœ¬èº«ï¼ŒåŸŸå†…çš„æ¥è§¦åœ¨åˆ†åŒ–è¿‡ç¨‹ä¸­æ˜¯å˜åŒ–çš„ã€‚åœ¨è¿™é‡Œï¼ŒCTCFä¼¼ä¹å‘æŒ¥äº†ä½œç”¨ï¼Œå¯èƒ½é€‚åº”åŸºå› è¡¨è¾¾çš„å‘è‚²å˜åŒ–ã€‚</p><p><img src="/GeekFocus/2022-02-15-CTCF/3.png"><br><img src="/GeekFocus/img/2022-02-15-CTCF/3.png"></p><p>Fig 3. CTCFé€šè¿‡é˜»ç¢DNAåœ¨å…¶ç»“åˆä½ç‚¹ä¸Šçš„æ¥è§¦è€Œèµ·åˆ°ç»ç¼˜ä½“çš„ä½œç”¨ã€‚(a) CTCF<strong>é˜»ç¢å…¶ç»“åˆä½ç‚¹åœ¨10kbä»¥å†…çš„åºåˆ—è·¨è¶Š</strong>ã€‚<strong>çº¿çš„åšåº¦å‡å°è¡¨æ˜äº¤äº’ä½œç”¨çš„æ¦‚ç‡å‡å°</strong>ã€‚(b) CTCFç»“åˆä½ç‚¹å¸¸å‡ºç°åœ¨æ‹“æ‰‘åŸŸçš„è¾¹ç•Œå¤„ã€‚(i) ESCså’Œçš®è´¨çš„Hi-cæ•°æ®ï¼Œç”¨å°é¼ ç¬¬12å·æŸ“è‰²ä½“åºåˆ—ä¹‹é—´çš„é¢œè‰²ç¼–ç æ¥è§¦é¢‘ç‡ã€‚<strong>ä¸‰è§’å½¢</strong>æ˜¾ç¤ºå’Œçªå‡º<strong>æ‹“æ‰‘åŸŸ</strong>ï¼Œæ˜¯<strong>æŸ“è‰²ä½“åºåˆ—ä¼˜å…ˆç›¸äº’ä½œç”¨çš„åŒºåŸŸ</strong>ã€‚(ii)å±‚å…³è”åŸŸ(LAD)æ•°æ®ï¼ŒLADè¾¹ç•Œä¸æ‹“æ‰‘åŸŸè¾¹ç•Œé‡åˆã€‚(iii) CTCF ChIP-seq profilesï¼Œæ˜¾ç¤ºåœ¨è¾¹ç•Œçš„CTCFç»“åˆä½ç‚¹ç°‡ã€‚è¯·æ³¨æ„ï¼Œè¿™ç§CTCFé›†ç¾¤åœ¨å…¶ä»–åœ°æ–¹ä¹Ÿå­˜åœ¨ï¼Œç‰¹åˆ«æ˜¯åœ¨éladåœ°åŒºã€‚æ˜¾ç¤ºåŒºåŸŸ:chr12: 112.3-119.3 Mb (mm9)ã€‚</p><ol start="8"><li>ç»“è®º</li></ol><p>å°½ç®¡CTCFä¸€ç›´æ˜¯ç ”ç©¶çš„çƒ­ç‚¹ï¼Œä½†å®ƒä»ç„¶æ˜¯ä¸€ç§<strong>ç¥ç§˜çš„è½¬å½•å› å­</strong>ã€‚å®ƒä¸åŸºå› ç»„ä¸­æˆåƒä¸Šä¸‡ä¸ªä½ç‚¹ç»“åˆï¼Œä¸å¤§é‡å…¶ä»–è½¬å½•å› å­ç›¸äº’ä½œç”¨ã€‚å®ƒå¸¸è¢«å‘ç°å‚ä¸æŸ“è‰²è´¨<strong>ç¯</strong>ï¼Œæœ‰æ—¶æœ‰ï¼Œæœ‰æ—¶æ²¡æœ‰<strong>å†…èšè›‹ç™½</strong>çš„å‚ä¸ã€‚å®ƒå¯ä»¥<strong>ä¸å…¶ä»–CTCFç»“åˆä½ç‚¹</strong>å½¢<strong>æˆ</strong>æŸ“è‰²è´¨<strong>ç¯</strong>ï¼Œä¹Ÿå¯ä»¥ä¸<strong>å¢å¼ºå­</strong>å’Œ<strong>å¯åŠ¨å­</strong>åºåˆ—å½¢<strong>æˆ</strong>æŸ“è‰²è´¨<strong>ç¯</strong>ã€‚CTCFä¸ä»…ä¸åŸºå› å†…å¤–çš„åºåˆ—ç»“åˆï¼Œä¹Ÿä¸<strong>åŸºå› ä½“å†…</strong>çš„<strong>åºåˆ—ç»“åˆ</strong>ï¼Œåœ¨åŸºå› ä½“å†…å®ƒä¼¼ä¹èƒ½å¤Ÿ<strong>æš‚åœæ»‘åŠ¨èšåˆé…¶åˆ†å­</strong>ã€‚æœ€åï¼ŒCTCFç»“åˆä½ç‚¹ä»ç„¶ä½œä¸º<strong>åè½¬å½•è½¬åº§åºåˆ—</strong>æ´»è·ƒåœ°è·³è·ƒï¼Œä½¿CTCFç»“åˆæ™¯è§‚åœ¨ä¸åŒå“ºä¹³åŠ¨ç‰©ç‰©ç§ä¹‹é—´å…·æœ‰å¤šæ ·æ€§ã€‚</p><p>å¯ä»¥è§£é‡ŠCTCFä¸æŸ“è‰²è´¨å…³è”çš„è®¸å¤šï¼Œ<strong>æœ‰æ—¶æ˜¯ç›¸åçš„åŠŸèƒ½</strong>åæœçš„ç»Ÿä¸€ä¸»é¢˜å¯èƒ½æ˜¯å…¶<strong>æˆç¯èƒ½åŠ›</strong>ã€‚æ ¹æ®ç¯ä¸­åŒ…å«çš„åºåˆ—å’Œç¯å¤–çš„åºåˆ—ï¼Œç”±CTCFå½¢æˆçš„æŸ“è‰²è´¨å¯èƒ½ä¼š<strong>ä¿ƒè¿›æˆ–é˜»ç¢å¢å¼ºå­å’Œé¶åŸºå› ä¹‹é—´çš„ä¸‰ç»´æ¥è§¦</strong>ï¼Œä»è€Œäº§ç”Ÿä¸åŒçš„è½¬å½•ç»“æœã€‚è®¸å¤šé—®é¢˜ä»ç„¶å­˜åœ¨:ä¸ºä»€ä¹ˆä¸€äº›CTCFä½ç‚¹å½¢æˆæŸ“è‰²è´¨ç¯è€Œå¦ä¸€äº›åˆ™æ²¡æœ‰?è¿™åœ¨å¤šå¤§ç¨‹åº¦ä¸Šä¾èµ–äºç›¸å…³çš„è›‹ç™½è´¨å› å­?å½“è›‹ç™½è´¨ä¸æŸ“è‰²è´¨ç»“åˆæ—¶ï¼Œå®ƒæ˜¯å¦‚ä½•è®¾æ³•ä¸è¿™ä¹ˆå¤šå…¶ä»–è½¬å½•å› å­ç›¸äº’ä½œç”¨çš„?ä¸€ç§å¯èƒ½æ˜¯CTCFä½œä¸ºæŸ“è‰²è´¨æ‰«æè½¬å½•å› å­çš„è·¯éšœï¼Œå½“é‡åˆ°ç»“åˆè›‹ç™½æ—¶ï¼Œè¿™äº›è½¬å½•å› å­ä»¥æŸç§æ–¹å¼è¢«å›°ä½ã€‚ctcfä»‹å¯¼çš„æŸ“è‰²ä½“é—´æ¥è§¦æœ‰ä½•ç›¸å…³æ€§?CTCFæ˜¯å¦é€šè¿‡é˜»æ­¢3D DNAæ¥è§¦æ¥é˜»æ–­å¢å¼ºå­-å¯åŠ¨å­é€šä¿¡?æˆ–è€…ç»ç¼˜æ˜¯å¦æ¶‰åŠç»ç¼˜ä½“åºåˆ—ä¸å¢å¼ºå‰‚å’Œå¯åŠ¨å‰‚çš„ç‰©ç†ç›¸äº’ä½œç”¨?è¿™äº›é—®é¢˜çš„ç­”æ¡ˆéœ€è¦èƒ½å¤Ÿé¢„æµ‹ç»™å®šçš„CTCFç»“åˆäº‹ä»¶æ˜¯å¦åœ¨åŠŸèƒ½ä¸Šä¸ç›¸å…³ï¼Œæ˜¯å¦ä¼šå¼•èµ·è½¬å½•æ¿€æ´»æˆ–æŠ‘åˆ¶ï¼Œæ˜¯å¦ä¼šå¹²æ‰°è½¬å½•æ¿€æ´»æˆ–ä¼šäº§ç”ŸæŸ“è‰²è´¨è¾¹ç•Œã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>paper</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€GOã€‘ã€KEGGã€‘</title>
    <link href="/GeekFocus/2021/12/20/2021-12-20-GO_KEGG_post/"/>
    <url>/GeekFocus/2021/12/20/2021-12-20-GO_KEGG_post/</url>
    
    <content type="html"><![CDATA[<h2 id="Oryza-Sativa-ã€Gene-IDã€‘ã€GOã€‘ã€KEGGã€‘"><a href="#Oryza-Sativa-ã€Gene-IDã€‘ã€GOã€‘ã€KEGGã€‘" class="headerlink" title="Oryza Sativa ã€Gene IDã€‘ã€GOã€‘ã€KEGGã€‘"></a>Oryza Sativa ã€Gene IDã€‘ã€GOã€‘ã€KEGGã€‘</h2><span id="more"></span><p><strong>GOåˆ†æ</strong>ï¼šåŸºå› -&gt;åŠŸèƒ½ç±»ç¾¤</p><p>**KEGG(Pathway)**ï¼šåŸºå› -&gt;ä»£è°¢ç½‘ç»œ</p><p><strong>GO&#x2F;KEGGé€‰å–ç›®æ ‡åŸºå› </strong></p><ul><li><p>æŒ‡æ ‡ï¼šEnrichment scoreï¼Œpå€¼ï¼ŒFDR</p></li><li><p>pathwayï¼špå’ŒFDRè¶Šå°è¶Šå¥½ï¼Œé—®é¢˜æ˜¯æœ‰æ—¶æœ¬å°±ä¸æ˜“å¯Œé›†å‡ºï¼Œå¦‚ä½•å–èˆ</p></li><li><p>GOï¼špï¼ŒFDRï¼ŒEnrichmentscoreï¼ˆè¶Šå¤§è¶Šå®¹æ˜“å—åˆ°å½±å“ï¼‰</p></li><li><p><font color="green">fold changeè¾ƒå¤§çš„åŸºå› </font>ï¼ˆupï¼Œdownï¼‰</p></li><li><p>å¯èƒ½æœ‰ç”¨çš„è›‹ç™½ï¼ŒPPIï¼Ÿ</p></li></ul><p>GO: ç ”ç©¶çš„åŸºå› å“ªäº›é€šè·¯ï¼Ÿæ˜¯å¦å˜åŒ–</p><p><strong>KEGGç­›é€‰æ–¹æ³•ï¼š</strong></p><ul><li>å…ˆçœ‹KEGGçš„èšç±»åˆ†æç»“æœï¼ˆæ„Ÿå…´è¶£ç ”ç©¶æ–¹å‘æœ‰å…³çš„åŸºå› æ˜¯ä¸æ˜¯æœ‰å·®å¼‚ï¼‰â†’ GOåˆ†ä¸ºä¸‰ä¸ªåˆ†æï¼Œå…ˆçœ‹BPåˆ†æï¼ˆæ„Ÿå…´è¶£ç ”ç©¶æ–¹å‘æœ‰å…³çš„åŸºå› æ˜¯ä¸æ˜¯æœ‰å·®å¼‚ï¼‰â†’æŒ‘é€‰å’Œæˆ‘ä»¬ç ”ç©¶æ¯”è¾ƒç›¸å…³çš„â†’åæœŸéªŒè¯ï¼šé€‰FCæ¯”è¾ƒå¤§ï¼ŒéªŒè¯æˆåŠŸç‡ä¼šé«˜ä¸€äº›</li><li>æ ¹æ®Rich factorå€¼ã€Qvalueå€¼æˆ–<font color="green">å¯Œé›†åˆ°æ­¤é€šè·¯ä¸Šçš„åŸºå› ä¸ªæ•°æ¥è¡¡é‡KEGGçš„å¯Œé›†ç¨‹åº¦</font>ï¼Œæ‰¾åˆ°å¯Œé›†æœ€æ˜¾è‘—çš„é€šè·¯</li><li>æ‰¾è‡ªå·±æ„Ÿå…´è¶£çš„ï¼šé«˜åŸååº”-&gt;å‘¼å¸åŠŸèƒ½ç›¸å…³é€šè·¯ï¼Œå…ç–«ç³»ç»Ÿ-&gt;ç‚ç—‡å› å­ã€TNFç›¸å…³é€šè·¯</li><li>ä»é€šè·¯ä¸­å»æ‰¾åˆ°<font color="green">è¡¨è¾¾å€æ•°æ˜¾è‘—çš„åŸºå› è¿›è¡ŒéªŒè¯</font>ï¼Œè¿›ä¸€æ­¥è§£é‡Šç›¸å…³åˆ†å­è¡¨è¾¾æœºåˆ¶</li></ul><p><strong>ç›®æ ‡è¡¨ç¤º</strong></p><p>HOTAIRå‡ºæ²¡äºèƒæ ¸ï¼ˆCCï¼‰ï¼Œå‚ä¸äº†ç»„è›‹ç™½ç”²åŸºåŒ–è°ƒæ§å¼•å‘ç™ŒåŸºå› æ²‰é»˜ï¼ˆBPï¼‰ï¼Œå…·ä½“æ˜¯ç»“åˆPRC2å¤åˆç‰©ä»¥åŠLSD1ï¼ˆMFï¼‰</p><hr><p><strong>è½¬å½•ç»„æ•°æ®ä¸­ç­›é€‰å…³é”®åŸºå› </strong></p><p>ç­›é€‰å…³é”®åŸºå› çš„æ–¹æ³•æœ‰3ç±»ï¼š</p><p>1.è¡¨è¾¾é‡ï¹¢åŠŸèƒ½å¯Œé›†</p><p>2.è¡¨è¾¾é‡ï¹¢å®éªŒ</p><p>3.è¡¨è¾¾é‡ï¹¢åºåˆ—</p><p>ä¸Šé¢çš„ä¸‰ç§æ–¹æ³•ä¸éš¾çœ‹å‡ºï¼Œç­›é€‰å…³é”®åŸºå› çš„<font color="green">æ ¸å¿ƒ</font>æ˜¯<font color="green">è¡¨è¾¾é‡</font>ï¼Œå…¶å®è½¬å½•ç»„çš„æ ¸å¿ƒå°±æ˜¯ä»¥è¡¨è¾¾é‡ä¸ºæ ¸å¿ƒå±•å¼€å…¶ä»–åˆ†æçš„ï¼Œç„¶åå†é™„åŠ å…¶ä»–ä¸€äº›ä¿¡æ¯ï¼Œæ‰¾å‡ºç›®æ ‡åŸºå› ï¼›æœ€åå°†åˆ†æç»“æœä¸ç ”ç©¶ç›®çš„å·§å¦™èåˆï¼Œå¦‚æœå†åšä¸€äº›åŸºå› åŠŸèƒ½å®éªŒéªŒè¯ï¼ˆé«˜åˆ†å¿…å¤‡ï¼Œå¯ä¸åšï¼‰ï¼Œä¸€ç¯‡é«˜è´¨é‡çš„æ–‡ç« å°±okäº†ã€‚</p><p><strong>1.è¡¨è¾¾é‡ï¹¢åŠŸèƒ½å¯Œé›†</strong></p><p>Zhu T, Wang X, Xu Z, Xu J, Li R, et al. (2020) Screening of key genes responsible for Pennisetum setaceum â€˜Rubrumâ€™ leaf color using tranome sequencing. PLOS ONE 15(11): e0242618.</p><p>è¯¥æ–‡ç ”ç©¶å¯¹è±¡ç‹¼å°¾è‰è§‚èµè‰æ¤ç‰©ï¼Œ<font color="green">é«˜å…‰</font>ç¯äº§ç´«è‰²å¶å­ï¼Œ<font color="green">ä½å…‰</font>äº§æµ…ç´«è‰²æˆ–ç»¿è‰²å¶å­ã€‚è¯¥æ–‡é‰´å®šä¸<font color="green">å¶ç‰‡ç€è‰²ç›¸å…³çš„å…³é”®åŸºå› </font>ï¼Œå¹¶é˜æ˜å‚ä¸ç‹¼å°¾è‰å¶å­çš„é¢œè‰²å˜åŒ–çš„åˆ†å­æœºåˆ¶ã€‚</p><p>å·®å¼‚è¡¨è¾¾åŸºå› åˆ†ææ€»å…±é‰´å®šäº†19043ä¸ªDEGsï¼Œä¸T0ï¼ˆæœªå¤„ç†é˜¶æ®µçš„å¶å­ï¼‰é˜¶æ®µçš„è¡¨è¾¾ç›¸æ¯”ï¼Œåœ¨T1ï¼ˆé®é˜´12å¤©åæ–°å¶å­å®Œå…¨å˜ç»¿çš„é˜¶æ®µï¼‰é˜¶æ®µä¸Šè°ƒå’Œä¸‹è°ƒçš„åŸºå› åˆ†åˆ«ä¸º10761å’Œ8642ã€‚<font color="green">KEGGå¯Œé›†åˆ†æå‘ç°ï¼Œæ˜¾è‘—å¯Œé›†çš„é€šè·¯ä¸»è¦æœ‰ç±»é»„é…®çš„ç”Ÿç‰©åˆæˆï¼Œé»„é…®å’Œé»„é…®é†‡çš„ç”Ÿç‰©åˆæˆä»¥åŠç±»èƒ¡èåœç´ çš„ç”Ÿç‰©åˆæˆ</font>ã€‚<font color="red">åŸºå› ç­›é€‰(æ˜¾è‘—KEGGå†…çš„åŸºå› ç­›é€‰ï¼Ÿ)</font>å‘ç°å­˜åœ¨ä¸<strong>å¶ç»¿ç´ ä»£è°¢</strong>æœ‰å…³çš„31ä¸ªå·®å¼‚è¡¨è¾¾åŸºå› ï¼Œå…¶ä¸­21ä¸ªä¸å¶ç»¿ç´ çš„ç”Ÿç‰©<strong>åˆæˆ</strong>æœ‰å…³ï¼Œæœ‰10ä¸ªä¸å¶ç»¿ç´ çš„<strong>é™è§£</strong>æœ‰å…³ï¼Œä»¥åŠ3ä¸ªä¸å¶ç»¿ç´ <strong>é™è§£è°ƒæ§</strong>æœ‰å…³çš„è½¬å½•å› å­ï¼Œ<strong>èŠ±é’ç´ çš„åˆæˆå’Œç§¯</strong>ç´¯æœ‰31ä¸ªå…³é”®é…¶åŸºå› ï¼Œ4ä¸ªå¯èƒ½å‚ä¸<strong>èŠ±è‰²è‹·ä»£è°¢è°ƒæ§</strong>çš„è½¬å½•å› å­ï¼ˆå›¾1æ‰€ç¤ºï¼‰ ã€‚</p><p><img src="/GeekFocus/2021-12-20-GO_KEGG_post/selectDEG.png"><br><img src="/GeekFocus/img/2021-12-20-GO_KEGG_post/selectDEG.png" alt="selectDEG"></p><p>å¿«é€Ÿç­›é€‰å‡ºæ„Ÿå…´è¶£çš„åŸºå› ï¼šåŸºå› é•¿åº¦ã€åŸºå› åœ¨æ ·å“ä¸­çš„è¡¨è¾¾é‡ã€<strong>å·®å¼‚å€æ•°</strong>ã€<strong>æ³¨é‡Šä¿¡æ¯</strong>ç­‰ã€‚</p><p><font color="green">æ‰¾æ˜¾è‘—é€šè·¯é‡Œçš„åŸºå› ã€‚åšä¸€ä¸ªä¿¡æ¯è¡¨ã€‚</font></p><p><strong>2.è¡¨è¾¾é‡ï¹¢å®éªŒ</strong></p><p>Wang A, Chao T, Ji Z, Xuan R, Liu S, Guo M, Wang G, Wang J. 2020. Tranome analysis reveals potential immune function-related regulatory genes&#x2F;pathways of female Lubo goat submandibular glands at different developmental stages. PeerJ 8:e9947.</p><p>è¯¾é¢˜ç»„å‰æœŸçš„åŸºå› åŠŸèƒ½å®éªŒæˆ–æ–‡çŒ®æŸ¥é˜…æ¥å€ŸåŠ©åˆ«äººçš„å·²ç»éªŒè¯è¿‡çš„åŸºå› åŠŸèƒ½ç»“æœï¼Œä¹‹åå†æ ¹æ®è¡¨è¾¾é‡ç­›é€‰å…³é”®åŸºå› ã€‚</p><p>è½¬å½•ç»„ç ”ç©¶çš„ç›®çš„å°±æ˜¯å¯»æ‰¾ä¸å®éªŒè®¾è®¡ç›¸å…³çš„å…³é”®åŸºå› ï¼Œä¸€èˆ¬æ¥è¯´ç ”ç©¶æŸç”Ÿç†ç°è±¡éƒ½å…ˆè¦é˜…è¯»å¤§é‡æ–‡çŒ®æ¥åˆ¤æ–­è¯¥å®éªŒçš„å¯è¡Œæ€§ã€‚å¦‚è½¬å½•ç»„åˆ†ææ­ç¤ºäº†é›Œæ€§é²æ³¢<strong>å±±ç¾Šä¸‹é¢Œè…º</strong>åœ¨<strong>ä¸åŒå‘è‚²é˜¶æ®µ</strong>çš„æ½œåœ¨<strong>å…ç–«åŠŸèƒ½ç›¸å…³è°ƒèŠ‚åŸºå› </strong>æˆ–é€”å¾„</p><p>è¯¥æ–‡ç ”ç©¶çš„ç›®çš„æ˜¯é€šè¿‡<strong>è½¬å½•ç»„æµ‹åº</strong>æ¥<strong>å®šä½</strong>å·®å¼‚è¡¨è¾¾åŸºå› ï¼ˆDEGï¼‰åœ¨<strong>ä¸‰ä¸ªä¸åŒé˜¶æ®µçš„è¡¨è¾¾è°±</strong>ï¼Œé¢„æµ‹åœ¨<strong>ä¸åŒå‘è‚²é˜¶æ®µ</strong>çš„<strong>ä¸‹é¢Œä¸‹è…ºçš„å…ç–«åŠŸèƒ½</strong>ã€‚ç”±äº<strong>äººã€å°é¼ ã€å¤§é¼ ã€ç‰›</strong>çš„ä¸‹é¢Œè…ºéƒ½æ£€æµ‹åˆ°äº†<strong>ç›¸å…³æŠ—ä½“</strong>ï¼Œå¹¶ä¸”ç ”ç©¶å‘ç°äº†ä¸‹é¢Œè…ºä¸­çš„<strong>ç±»çº¢ç»†èƒåˆ†åŒ–å› å­ã€å†…çš®ç´ ã€è‚ç»†èƒç”Ÿé•¿å› å­ï¼ˆHGFï¼‰ã€è½¬ç§»æ€§ç”Ÿé•¿å› å­ï¼ˆMGFï¼‰ã€è½¬åŒ–ç”Ÿé•¿å› å­-Î±ï¼ˆTGF-Î±ï¼‰å’Œå…¶ä»–å› å­</strong>ã€‚æ‰€ä»¥åœ¨<strong>åç»­çš„åŸºå› ç­›é€‰ä¸­ä¼šé‡ç‚¹å…³æ³¨ç›¸å…³å› å­çš„è¡¨è¾¾åŸºå› </strong>ã€‚</p><p>ä»ä¸Šé¢ä¾‹å­ä¸­å¯ä»¥å‘ç°ä¸€ä¸ª<strong>å¥—è·¯</strong>ï¼Œå…ˆæŸ¥é˜…æ¨¡å¼ç”Ÿç‰©ä¸­è¯¥æ–¹é¢çš„ç ”ç©¶ç»“æœï¼Œç„¶åå†ç»“åˆè‡ªå·±çš„ç ”ç©¶é¡¹ç›®ç­›é€‰å‡ºåŸºå› ï¼Œå¹¶ä¸”<strong>é‡ç‚¹å…³æ³¨æ¨¡å¼ç”Ÿç‰©ä¸­å·²çŸ¥çš„åŠŸèƒ½åŸºå› æœ‰æ²¡æœ‰è¾ƒå¤§çš„å·®å¼‚å€æ•°</strong>ã€‚</p><hr><p>refï¼š</p><p><a href="https://zhuanlan.zhihu.com/p/78093534">https://zhuanlan.zhihu.com/p/78093534</a></p><p><a href="https://www.sohu.com/a/437865907_278730">https://www.sohu.com/a/437865907_278730</a></p><hr><h1 id="è½¬å½•ç»„å›¾å½¢ä¸“é¢˜ä¹‹å·®å¼‚åŸºå› ç›¸å…³å›¾å½¢"><a href="#è½¬å½•ç»„å›¾å½¢ä¸“é¢˜ä¹‹å·®å¼‚åŸºå› ç›¸å…³å›¾å½¢" class="headerlink" title="è½¬å½•ç»„å›¾å½¢ä¸“é¢˜ä¹‹å·®å¼‚åŸºå› ç›¸å…³å›¾å½¢"></a>è½¬å½•ç»„å›¾å½¢ä¸“é¢˜ä¹‹å·®å¼‚åŸºå› ç›¸å…³å›¾å½¢</h1><p>é›·è¾¾å›¾ã€çƒ­å›¾ã€æŸ±çŠ¶å›¾ã€éŸ¦æ©å›¾ã€ç«å±±å›¾</p><p><a href="https://www.sohu.com/a/428207189_278730">https://www.sohu.com/a/428207189_278730</a></p><h1 id="å…¨å¥—çš„å¯Œé›†åˆ†æç›¸å…³å›¾å½¢è¯¦è§£"><a href="#å…¨å¥—çš„å¯Œé›†åˆ†æç›¸å…³å›¾å½¢è¯¦è§£" class="headerlink" title="å…¨å¥—çš„å¯Œé›†åˆ†æç›¸å…³å›¾å½¢è¯¦è§£"></a>å…¨å¥—çš„å¯Œé›†åˆ†æç›¸å…³å›¾å½¢è¯¦è§£</h1><p>æŸ±å½¢å›¾ï¼Œæ°”æ³¡å›¾ï¼Œåœˆå›¾ï¼Œz-scoreå›¾ï¼Œç½‘ç»œå›¾</p><p><a href="https://www.sohu.com/a/436470973_278730">https://www.sohu.com/a/436470973_278730</a></p>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>O_Sativa</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux command awk</title>
    <link href="/GeekFocus/2021/12/17/2021-12-17-Linux_awk_command/"/>
    <url>/GeekFocus/2021/12/17/2021-12-17-Linux_awk_command/</url>
    
    <content type="html"><![CDATA[<h2 id="Linux-command-ã€awkã€‘"><a href="#Linux-command-ã€awkã€‘" class="headerlink" title="Linux command ã€awkã€‘"></a>Linux command ã€awkã€‘</h2><span id="more"></span><h1 id="Linux-awk-å‘½ä»¤"><a href="#Linux-awk-å‘½ä»¤" class="headerlink" title="Linux awk å‘½ä»¤"></a>Linux awk å‘½ä»¤</h1><p><a href="https://www.runoob.com/linux/linux-command-manual.html"><img src="https://www.runoob.com/images/up.gif" alt="Linux å‘½ä»¤å¤§å…¨"> Linux å‘½ä»¤å¤§å…¨</a></p><p>AWK æ˜¯ä¸€ç§<font color='green'>å¤„ç†æ–‡æœ¬æ–‡ä»¶</font>çš„è¯­è¨€ï¼Œæ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ–‡æœ¬åˆ†æå·¥å…·ã€‚</p><p>ä¹‹æ‰€ä»¥å« AWK æ˜¯å› ä¸ºå…¶å–äº†ä¸‰ä½åˆ›å§‹äºº Alfred <strong>A</strong>hoï¼ŒPeter <strong>W</strong>einberger, å’Œ Brian <strong>K</strong>ernighan çš„ Family Name çš„é¦–å­—ç¬¦ã€‚</p><h3 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">awk [é€‰é¡¹å‚æ•°] <span class="hljs-string">&#x27;script&#x27;</span> var=value file(s)<br>æˆ–<br>awk [é€‰é¡¹å‚æ•°] -f scriptfile var=value file(s)<br></code></pre></td></tr></table></figure><p><strong>é€‰é¡¹å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li>-F fs or â€“field-separator fs<br>æŒ‡å®šè¾“å…¥æ–‡ä»¶æŠ˜åˆ†éš”ç¬¦ï¼Œfsæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¦‚<font color='green'>-F:</font>ã€‚</li><li>-v var&#x3D;value or â€“asign var&#x3D;value<br>èµ‹å€¼ä¸€ä¸ªç”¨æˆ·å®šä¹‰å˜é‡ã€‚</li><li>-f scripfile or â€“file scriptfile<br>ä»è„šæœ¬æ–‡ä»¶ä¸­è¯»å–awkå‘½ä»¤ã€‚</li><li>-W posix<br>æ‰“å¼€å…¼å®¹æ¨¡å¼ã€‚ä½†æœ‰ä»¥ä¸‹é™åˆ¶ï¼Œä¸è¯†åˆ«ï¼š&#x2F;xã€å‡½æ•°å…³é”®å­—ã€funcã€æ¢ç åºåˆ—ä»¥åŠå½“fsæ˜¯ä¸€ä¸ªç©ºæ ¼æ—¶ï¼Œå°†æ–°è¡Œä½œä¸ºä¸€ä¸ªåŸŸåˆ†éš”ç¬¦ï¼›æ“ä½œç¬¦<strong>å’Œ</strong>&#x3D;ä¸èƒ½ä»£æ›¿^å’Œ^&#x3D;ï¼›fflushæ— æ•ˆ?</li><li>-W version or â€“version<br>æ‰“å°<font color='green'>bugæŠ¥å‘Šä¿¡æ¯</font>çš„ç‰ˆæœ¬ã€‚</li></ul><hr><h2 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h2><p>log.txtæ–‡æœ¬å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">2 this is a <span class="hljs-built_in">test</span><br>3 Are you like awk<br>This<span class="hljs-string">&#x27;s a test</span><br><span class="hljs-string">10 There are orange,apple,mongo</span><br></code></pre></td></tr></table></figure><p>ç”¨æ³•ä¸€ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">awk <span class="hljs-string">&#x27;&#123;[pattern] action&#125;&#x27;</span> &#123;filenames&#125;   <span class="hljs-comment"># è¡ŒåŒ¹é…è¯­å¥ awk &#x27;&#x27; åªèƒ½ç”¨å•å¼•å·</span><br></code></pre></td></tr></table></figure><p>å®ä¾‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># æ¯è¡ŒæŒ‰ç©ºæ ¼æˆ–TABåˆ†å‰²ï¼Œè¾“å‡ºæ–‡æœ¬ä¸­çš„1ã€4é¡¹</span><br> $ awk <span class="hljs-string">&#x27;&#123;print $1,$4&#125;&#x27;</span> log.txt<br> ---------------------------------------------<br> 2 a<br> 3 like<br> This<span class="hljs-string">&#x27;s</span><br><span class="hljs-string"> 10 orange,apple,mongo</span><br><span class="hljs-string"> # æ ¼å¼åŒ–è¾“å‡º</span><br><span class="hljs-string"> $ awk &#x27;</span>&#123;<span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%-8s %-10s\n&quot;</span>,<span class="hljs-variable">$1</span>,<span class="hljs-variable">$4</span>&#125;<span class="hljs-string">&#x27; log.txt</span><br><span class="hljs-string"> ---------------------------------------------</span><br><span class="hljs-string"> 2        a</span><br><span class="hljs-string"> 3        like</span><br><span class="hljs-string"> This&#x27;</span>s<br> 10       orange,apple,mongo<br> <br></code></pre></td></tr></table></figure><p><font color='green'>ç”¨æ³•äºŒï¼š</font></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">awk -F  <span class="hljs-comment">#-Fç›¸å½“äºå†…ç½®å˜é‡FS, æŒ‡å®šåˆ†å‰²å­—ç¬¦</span><br></code></pre></td></tr></table></figure><p>å®ä¾‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># ä½¿ç”¨&quot;,&quot;åˆ†å‰²</span><br> $  awk -F, <span class="hljs-string">&#x27;&#123;print $1,$2&#125;&#x27;</span>   log.txt<br> ---------------------------------------------<br> 2 this is a <span class="hljs-built_in">test</span><br> 3 Are you like awk<br> This<span class="hljs-string">&#x27;s a test</span><br><span class="hljs-string"> 10 There are orange apple</span><br><span class="hljs-string"> # æˆ–è€…ä½¿ç”¨å†…å»ºå˜é‡</span><br><span class="hljs-string"> $ awk &#x27;</span>BEGIN&#123;FS=<span class="hljs-string">&quot;,&quot;</span>&#125; &#123;<span class="hljs-built_in">print</span> <span class="hljs-variable">$1</span>,<span class="hljs-variable">$2</span>&#125;<span class="hljs-string">&#x27;     log.txt</span><br><span class="hljs-string"> ---------------------------------------------</span><br><span class="hljs-string"> 2 this is a test</span><br><span class="hljs-string"> 3 Are you like awk</span><br><span class="hljs-string"> This&#x27;</span>s a <span class="hljs-built_in">test</span><br> 10 There are orange apple<br> <span class="hljs-comment">#! ä½¿ç”¨å¤šä¸ªåˆ†éš”ç¬¦.å…ˆä½¿ç”¨ç©ºæ ¼åˆ†å‰²ï¼Œç„¶åå¯¹åˆ†å‰²ç»“æœå†ä½¿ç”¨&quot;,&quot;åˆ†å‰²</span><br> $ awk -F <span class="hljs-string">&#x27;[ ,]&#x27;</span>  <span class="hljs-string">&#x27;&#123;print $1,$2,$5&#125;&#x27;</span>   log.txt<br> ---------------------------------------------<br> 2 this <span class="hljs-built_in">test</span><br> 3 Are awk<br> This<span class="hljs-string">&#x27;s a</span><br><span class="hljs-string"> 10 There apple</span><br></code></pre></td></tr></table></figure><p><font color='green'>ç”¨æ³•ä¸‰ï¼š</font>-va -vb</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">awk</span> -v  <span class="hljs-comment"># è®¾ç½®å˜é‡</span><br></code></pre></td></tr></table></figure><p>å®ä¾‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ awk -va=1 <span class="hljs-string">&#x27;&#123;print $1,$1+a&#125;&#x27;</span> log.txt<br>---------------------------------------------<br>2 3<br>3 4<br>This<span class="hljs-string">&#x27;s 1</span><br><span class="hljs-string">10 11</span><br><span class="hljs-string">$ awk -va=1 -vb=s &#x27;</span>&#123;<span class="hljs-built_in">print</span> <span class="hljs-variable">$1</span>,<span class="hljs-variable">$1</span>+a,<span class="hljs-variable">$1b</span>&#125;<span class="hljs-string">&#x27; log.txt</span><br><span class="hljs-string">---------------------------------------------</span><br><span class="hljs-string">2 3 2s</span><br><span class="hljs-string">3 4 3s</span><br><span class="hljs-string">This&#x27;</span>s 1 This<span class="hljs-string">&#x27;ss</span><br><span class="hljs-string">10 11 10s</span><br></code></pre></td></tr></table></figure><p>ç”¨æ³•å››ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">awk -f &#123;awkè„šæœ¬&#125; &#123;æ–‡ä»¶å&#125;<br></code></pre></td></tr></table></figure><p>å®ä¾‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ awk -f cal.awk log.txt<br></code></pre></td></tr></table></figure><hr><h2 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h2><table><thead><tr><th align="left">è¿ç®—ç¬¦</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">&#x3D; +&#x3D; -&#x3D; *&#x3D; &#x2F;&#x3D; %&#x3D; ^&#x3D; **&#x3D;</td><td align="left">èµ‹å€¼</td></tr><tr><td align="left">?:</td><td align="left">Cæ¡ä»¶è¡¨è¾¾å¼</td></tr><tr><td align="left">||</td><td align="left">é€»è¾‘æˆ–</td></tr><tr><td align="left">&amp;&amp;</td><td align="left">é€»è¾‘ä¸</td></tr><tr><td align="left">~ å’Œ !~</td><td align="left">åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼å’Œä¸åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼</td></tr><tr><td align="left">&lt; &lt;&#x3D; &gt; &gt;&#x3D; !&#x3D; &#x3D;&#x3D;</td><td align="left">å…³ç³»è¿ç®—ç¬¦</td></tr><tr><td align="left">ç©ºæ ¼</td><td align="left">è¿æ¥</td></tr><tr><td align="left">+ -</td><td align="left">åŠ ï¼Œå‡</td></tr><tr><td align="left">* &#x2F; %</td><td align="left">ä¹˜ï¼Œé™¤ä¸æ±‚ä½™</td></tr><tr><td align="left">+ - !</td><td align="left">ä¸€å…ƒåŠ ï¼Œå‡å’Œé€»è¾‘é</td></tr><tr><td align="left">^ ***</td><td align="left">æ±‚å¹‚</td></tr><tr><td align="left">++ â€“</td><td align="left">å¢åŠ æˆ–å‡å°‘ï¼Œä½œä¸ºå‰ç¼€æˆ–åç¼€</td></tr><tr><td align="left">$</td><td align="left">å­—æ®µå¼•ç”¨</td></tr><tr><td align="left">in</td><td align="left">æ•°ç»„æˆå‘˜</td></tr></tbody></table><p>è¿‡æ»¤ç¬¬ä¸€åˆ—å¤§äº2çš„è¡Œ</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs 1c">$ awk &#x27;$1&gt;2&#x27; <span class="hljs-built_in">log</span>.txt    <span class="hljs-meta">#å‘½ä»¤</span><br><span class="hljs-meta">#è¾“å‡º</span><br><span class="hljs-number">3</span> Are you like awk<br>This&#x27;s a test<br>10 There are orange,apple,mongo<br></code></pre></td></tr></table></figure><p>è¿‡æ»¤ç¬¬ä¸€åˆ—ç­‰äº2çš„è¡Œ</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nsis">$ awk <span class="hljs-string">&#x27;<span class="hljs-variable">$1</span>==2 &#123;print <span class="hljs-variable">$1</span>,<span class="hljs-variable">$3</span>&#125;&#x27;</span> log.txt    <span class="hljs-comment">#å‘½ä»¤</span><br><span class="hljs-comment">#è¾“å‡º</span><br><span class="hljs-number">2</span> is<br></code></pre></td></tr></table></figure><p><font color='green'>è¿‡æ»¤ç¬¬ä¸€åˆ—å¤§äº2å¹¶ä¸”ç¬¬äºŒåˆ—ç­‰äºâ€™Areâ€™çš„è¡Œ</font></p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nsis">$ awk <span class="hljs-string">&#x27;<span class="hljs-variable">$1</span>&gt;2 &amp;&amp; <span class="hljs-variable">$2</span>==&quot;Are&quot; &#123;print <span class="hljs-variable">$1</span>,<span class="hljs-variable">$2</span>,<span class="hljs-variable">$3</span>&#125;&#x27;</span> log.txt    <span class="hljs-comment">#å‘½ä»¤</span><br><span class="hljs-comment">#è¾“å‡º</span><br><span class="hljs-number">3</span> Are you<br></code></pre></td></tr></table></figure><hr><h2 id="å†…å»ºå˜é‡"><a href="#å†…å»ºå˜é‡" class="headerlink" title="å†…å»ºå˜é‡"></a>å†…å»ºå˜é‡</h2><table><thead><tr><th align="left">å˜é‡</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">$n</td><td align="left">å½“å‰è®°å½•çš„<font color='green'>ç¬¬nä¸ªå­—æ®µ</font>ï¼Œå­—æ®µé—´ç”±FSåˆ†éš”</td></tr><tr><td align="left"><font color='red'>$0</font></td><td align="left"><font color='green'>å®Œæ•´çš„è¾“å…¥è®°å½•</font></td></tr><tr><td align="left">ARGC</td><td align="left">å‘½ä»¤è¡Œå‚æ•°çš„æ•°ç›®</td></tr><tr><td align="left">ARGIND</td><td align="left">å‘½ä»¤è¡Œä¸­å½“å‰æ–‡ä»¶çš„ä½ç½®(ä»0å¼€å§‹ç®—)</td></tr><tr><td align="left">ARGV</td><td align="left">åŒ…å«å‘½ä»¤è¡Œå‚æ•°çš„æ•°ç»„</td></tr><tr><td align="left">CONVFMT</td><td align="left">æ•°å­—è½¬æ¢æ ¼å¼(é»˜è®¤å€¼ä¸º%.6g)ENVIRONç¯å¢ƒå˜é‡å…³è”æ•°ç»„</td></tr><tr><td align="left">ERRNO</td><td align="left">æœ€åä¸€ä¸ªç³»ç»Ÿé”™è¯¯çš„æè¿°</td></tr><tr><td align="left">FIELDWIDTHS</td><td align="left">å­—æ®µå®½åº¦åˆ—è¡¨(ç”¨ç©ºæ ¼é”®åˆ†éš”)</td></tr><tr><td align="left">FILENAME</td><td align="left">å½“å‰æ–‡ä»¶å</td></tr><tr><td align="left"><strong>FNR</strong></td><td align="left">å„æ–‡ä»¶åˆ†åˆ«è®¡æ•°çš„è¡Œå·</td></tr><tr><td align="left"><strong>FS</strong></td><td align="left">å­—æ®µåˆ†éš”ç¬¦(é»˜è®¤æ˜¯ä»»ä½•ç©ºæ ¼)</td></tr><tr><td align="left">IGNORECASE</td><td align="left">å¦‚æœä¸ºçœŸï¼Œåˆ™è¿›è¡Œå¿½ç•¥å¤§å°å†™çš„åŒ¹é…</td></tr><tr><td align="left"><strong>NF</strong></td><td align="left">ä¸€æ¡è®°å½•çš„å­—æ®µçš„æ•°ç›®</td></tr><tr><td align="left"><strong>NR</strong></td><td align="left">å·²ç»è¯»å‡ºçš„è®°å½•æ•°ï¼Œå°±æ˜¯è¡Œå·ï¼Œä»1å¼€å§‹</td></tr><tr><td align="left">OFMT</td><td align="left">æ•°å­—çš„è¾“å‡ºæ ¼å¼(é»˜è®¤å€¼æ˜¯%.6g)</td></tr><tr><td align="left"><strong>OFS</strong></td><td align="left">è¾“å‡ºå­—æ®µåˆ†éš”ç¬¦ï¼Œé»˜è®¤å€¼ä¸è¾“å…¥å­—æ®µåˆ†éš”ç¬¦ä¸€è‡´ã€‚</td></tr><tr><td align="left"><strong>ORS</strong></td><td align="left">è¾“å‡ºè®°å½•åˆ†éš”ç¬¦(é»˜è®¤å€¼æ˜¯ä¸€ä¸ªæ¢è¡Œç¬¦)</td></tr><tr><td align="left">RLENGTH</td><td align="left">ç”±matchå‡½æ•°æ‰€åŒ¹é…çš„å­—ç¬¦ä¸²çš„é•¿åº¦</td></tr><tr><td align="left">RS</td><td align="left">è®°å½•åˆ†éš”ç¬¦(é»˜è®¤æ˜¯ä¸€ä¸ªæ¢è¡Œç¬¦)</td></tr><tr><td align="left">RSTART</td><td align="left">ç”±matchå‡½æ•°æ‰€åŒ¹é…çš„å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªä½ç½®</td></tr><tr><td align="left">SUBSEP</td><td align="left">æ•°ç»„ä¸‹æ ‡åˆ†éš”ç¬¦(é»˜è®¤å€¼æ˜¯&#x2F;034)</td></tr></tbody></table><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#çœ‹å„å˜é‡å€¼</span><br>$ awk <span class="hljs-string">&#x27;BEGIN&#123;printf &quot;%4s %4s %4s %4s %4s %4s %4s %4s %4s\n&quot;,&quot;FILENAME&quot;,&quot;ARGC&quot;,&quot;FNR&quot;,&quot;FS&quot;,&quot;NF&quot;,&quot;NR&quot;,&quot;OFS&quot;,&quot;ORS&quot;,&quot;RS&quot;;printf &quot;---------------------------------------------\n&quot;&#125; &#123;printf &quot;%4s %4s %4s %4s %4s %4s %4s %4s %4s\n&quot;,FILENAME,ARGC,FNR,FS,NF,NR,OFS,ORS,RS&#125;&#x27;</span>  log.txt<br>FILENAME ARGC  FNR   FS   NF   NR  OFS  ORS   RS<br>---------------------------------------------<br>log.txt    2    1         5    1<br>log.txt    2    2         5    2<br>log.txt    2    3         3    3<br>log.txt    2    4         4    4<br><br><span class="hljs-comment"># è¾“å‡ºé¡ºåºå· NR, åŒ¹é…æ–‡æœ¬è¡Œå·</span><br>$ awk <span class="hljs-string">&#x27;&#123;print NR,FNR,$1,$2,$3&#125;&#x27;</span> log.txt<br>---------------------------------------------<br>1 1 2 this is<br>2 2 3 Are you<br>3 3 This<span class="hljs-string">&#x27;s a test</span><br><span class="hljs-string">4 4 10 There are</span><br><span class="hljs-string"># æŒ‡å®šè¾“å‡ºåˆ†å‰²ç¬¦</span><br><span class="hljs-string">$  awk &#x27;</span>&#123;<span class="hljs-built_in">print</span> <span class="hljs-variable">$1</span>,<span class="hljs-variable">$2</span>,<span class="hljs-variable">$5</span>&#125;<span class="hljs-string">&#x27; OFS=&quot; $ &quot;  log.txt</span><br><span class="hljs-string">---------------------------------------------</span><br><span class="hljs-string">2 $ this $ test</span><br><span class="hljs-string">3 $ Are $ awk</span><br><span class="hljs-string">This&#x27;</span>s $ a $<br>10 $ There $<br></code></pre></td></tr></table></figure><hr><h2 id="ä½¿ç”¨æ­£åˆ™ï¼Œå­—ç¬¦ä¸²åŒ¹é…"><a href="#ä½¿ç”¨æ­£åˆ™ï¼Œå­—ç¬¦ä¸²åŒ¹é…" class="headerlink" title="ä½¿ç”¨æ­£åˆ™ï¼Œå­—ç¬¦ä¸²åŒ¹é…"></a><font color='green'>ä½¿ç”¨æ­£åˆ™ï¼Œå­—ç¬¦ä¸²åŒ¹é…</font></h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># è¾“å‡ºç¬¬äºŒåˆ—åŒ…å« &quot;th&quot;ï¼Œå¹¶æ‰“å°ç¬¬äºŒåˆ—ä¸ç¬¬å››åˆ—</span><br>$ awk <span class="hljs-string">&#x27;$2 ~ /th/ &#123;print $2,$4&#125;&#x27;</span> log.txt<br>---------------------------------------------<br>this a<br><span class="hljs-comment">#$0æ˜¯b.txtæ¯ä¸€è¡Œå…¨éƒ¨å­—æ®µï¼Œ-i &#123;&#125; a.txt ä¸€è¡Œä¸€è¡Œèµ‹å€¼ç»™ &#123;&#125;</span><br><span class="hljs-built_in">cat</span> a.txt | xargs -i awk <span class="hljs-string">&#x27;BEGIN&#123;FS=&quot;\t&quot;&#125; $0 ~/&#123;&#125;/ &#123; print &#125;&#x27;</span> b.txt &gt; c.txt<br></code></pre></td></tr></table></figure><p><strong>~ è¡¨ç¤ºæ¨¡å¼å¼€å§‹ã€‚&#x2F;&#x2F; ä¸­æ˜¯æ¨¡å¼ã€‚</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># è¾“å‡ºåŒ…å« &quot;re&quot; çš„è¡Œ</span><br>$ awk <span class="hljs-string">&#x27;/re/ &#x27;</span> log.txt<br>---------------------------------------------<br>3 Are you like awk<br>10 There are orange,apple,mongo<br></code></pre></td></tr></table></figure><hr><h2 id="å¿½ç•¥å¤§å°å†™"><a href="#å¿½ç•¥å¤§å°å†™" class="headerlink" title="å¿½ç•¥å¤§å°å†™"></a>å¿½ç•¥å¤§å°å†™</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ awk <span class="hljs-string">&#x27;BEGIN&#123;IGNORECASE=1&#125; /this/&#x27;</span> log.txt<br>---------------------------------------------<br>2 this is a <span class="hljs-built_in">test</span><br>This<span class="hljs-string">&#x27;s a test</span><br></code></pre></td></tr></table></figure><hr><h2 id="æ¨¡å¼å–å"><a href="#æ¨¡å¼å–å" class="headerlink" title="æ¨¡å¼å–å"></a>æ¨¡å¼å–å</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sh">this is<br>Are you<br>This<span class="hljs-string">&#x27;s a test</span><br><span class="hljs-string">There are</span><br><span class="hljs-string"></span><br><span class="hljs-string">$ awk &#x27;</span><span class="hljs-variable">$2</span> !~ /th/ &#123;<span class="hljs-built_in">print</span> <span class="hljs-variable">$2</span>,<span class="hljs-variable">$4</span>&#125;<span class="hljs-string">&#x27; log.txt</span><br><span class="hljs-string">---------------------------------------------</span><br><span class="hljs-string">Are like</span><br><span class="hljs-string">a</span><br><span class="hljs-string">There orange,apple,mongo</span><br><span class="hljs-string">$ awk &#x27;</span>!/th/ &#123;<span class="hljs-built_in">print</span> <span class="hljs-variable">$2</span>,<span class="hljs-variable">$4</span>&#125;<span class="hljs-string">&#x27; log.txt</span><br><span class="hljs-string">---------------------------------------------</span><br><span class="hljs-string">Are like</span><br><span class="hljs-string">a</span><br><span class="hljs-string">There orange,apple,mongo</span><br></code></pre></td></tr></table></figure><hr><h2 id="awkè„šæœ¬"><a href="#awkè„šæœ¬" class="headerlink" title="awkè„šæœ¬"></a>awkè„šæœ¬</h2><p>å…³äº awk è„šæœ¬ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ä¸¤ä¸ªå…³é”®è¯ BEGIN å’Œ ENDã€‚</p><ul><li>BEGIN{ è¿™é‡Œé¢æ”¾çš„æ˜¯<font color='green'>æ‰§è¡Œå‰</font>çš„è¯­å¥ }</li><li>END {è¿™é‡Œé¢æ”¾çš„æ˜¯å¤„ç†å®Œ<font color='green'>æ‰€æœ‰çš„è¡Œåè¦æ‰§è¡Œ</font>çš„è¯­å¥ }</li><li>{è¿™é‡Œé¢æ”¾çš„æ˜¯å¤„ç†<font color='green'>æ¯ä¸€è¡Œæ—¶</font>è¦æ‰§è¡Œçš„è¯­å¥}</li></ul><p>å‡è®¾æœ‰è¿™ä¹ˆä¸€ä¸ªæ–‡ä»¶ï¼ˆå­¦ç”Ÿæˆç»©è¡¨ï¼‰ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ <span class="hljs-built_in">cat</span> score.txt<br>Marry   2143 78 84 77<br>Jack    2321 66 78 45<br>Tom     2122 48 77 71<br>Mike    2537 87 97 95<br>Bob     2415 40 57 62<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬çš„ awk è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ <span class="hljs-built_in">cat</span> cal.awk<br><span class="hljs-comment">#!/bin/awk -f</span><br><span class="hljs-comment">#è¿è¡Œå‰</span><br>BEGIN &#123;<br>    math = 0<br>    english = 0<br>    computer = 0<br> <br>    <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;NAME    NO.   MATH  ENGLISH  COMPUTER   TOTAL\n&quot;</span><br>    <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;---------------------------------------------\n&quot;</span><br>&#125;<br><span class="hljs-comment">#è¿è¡Œä¸­</span><br>&#123;<br>    math+=<span class="hljs-variable">$3</span><br>    english+=<span class="hljs-variable">$4</span><br>    computer+=<span class="hljs-variable">$5</span><br>    <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%-6s %-6s %4d %8d %8d %8d\n&quot;</span>, <span class="hljs-variable">$1</span>, <span class="hljs-variable">$2</span>, <span class="hljs-variable">$3</span>,<span class="hljs-variable">$4</span>,<span class="hljs-variable">$5</span>, <span class="hljs-variable">$3</span>+<span class="hljs-variable">$4</span>+<span class="hljs-variable">$5</span><br>&#125;<br><span class="hljs-comment">#è¿è¡Œå</span><br>END &#123;<br>    <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;---------------------------------------------\n&quot;</span><br>    <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;  TOTAL:%10d %8d %8d \n&quot;</span>, math, english, computer<br>    <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;AVERAGE:%10.2f %8.2f %8.2f\n&quot;</span>, math/NR, english/NR, computer/NR<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ‰§è¡Œç»“æœï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ awk -f cal.awk score.txt<br>NAME    NO.   MATH  ENGLISH  COMPUTER   TOTAL<br>---------------------------------------------<br>Marry  2143     78       84       77      239<br>Jack   2321     66       78       45      189<br>Tom    2122     48       77       71      196<br>Mike   2537     87       97       95      279<br>Bob    2415     40       57       62      159<br>---------------------------------------------<br>  TOTAL:       319      393      350<br>AVERAGE:     63.80    78.60    70.00<br></code></pre></td></tr></table></figure><hr><h2 id="å¦å¤–ä¸€äº›å®ä¾‹"><a href="#å¦å¤–ä¸€äº›å®ä¾‹" class="headerlink" title="å¦å¤–ä¸€äº›å®ä¾‹"></a>å¦å¤–ä¸€äº›å®ä¾‹</h2><p>AWK çš„ hello world ç¨‹åºä¸ºï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">BEGIN &#123; <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Hello, world!&quot;</span> &#125;<br></code></pre></td></tr></table></figure><p>è®¡ç®—æ–‡ä»¶å¤§å°</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ <span class="hljs-built_in">ls</span> -l *.txt | awk <span class="hljs-string">&#x27;&#123;sum+=$5&#125; END &#123;print sum&#125;&#x27;</span><br>--------------------------------------------------<br>666581<br></code></pre></td></tr></table></figure><p>ä»æ–‡ä»¶ä¸­æ‰¾å‡º<font color='green'>é•¿åº¦å¤§äº 80 çš„è¡Œ</font>ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">awk <span class="hljs-string">&#x27;length&gt;80&#x27;</span> log.txt<br></code></pre></td></tr></table></figure><p>æ‰“å°ä¹ä¹ä¹˜æ³•è¡¨</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">seq</span> 9 | sed <span class="hljs-string">&#x27;H;g&#x27;</span> | awk -v RS=<span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-string">&#x27;&#123;for(i=1;i&lt;=NF;i++)printf(&quot;%dx%d=%d%s&quot;, i, NR, i*NR, i==NR?&quot;\n&quot;:&quot;\t&quot;)&#125;&#x27;</span><br></code></pre></td></tr></table></figure><blockquote><p>æ›´å¤šå†…å®¹ï¼š</p><ul><li><a href="https://www.runoob.com/w3cnote/awk-work-principle.html">AWK å·¥ä½œåŸç†</a></li><li><a href="https://www.runoob.com/w3cnote/awk-arrays.html">AWK æ•°ç»„</a></li><li><a href="https://www.runoob.com/w3cnote/awk-if-loop.html">AWK æ¡ä»¶è¯­å¥ä¸å¾ªç¯</a></li><li><a href="https://www.runoob.com/w3cnote/awk-user-defined-functions.html">AWK ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°</a></li><li><a href="https://www.runoob.com/w3cnote/awk-built-in-functions.html">AWK å†…ç½®å‡½æ•°</a></li><li><a href="https://www.runoob.com/w3cnote/8-awesome-awk-built-in-variables.html">8 ä¸ªæœ‰åŠ›çš„ Awk å†…å»ºå˜é‡</a></li><li><a href="http://www.gnu.org/software/gawk/manual/gawk.html">AWK å®˜æ–¹æ‰‹å†Œ</a></li></ul></blockquote><p><strong>awkã€sedã€grepæ›´é€‚åˆçš„æ–¹å‘ï¼š</strong></p><ul><li>grep æ›´é€‚åˆå•çº¯çš„æŸ¥æ‰¾æˆ–åŒ¹é…æ–‡æœ¬</li><li>sed æ›´é€‚åˆç¼–è¾‘åŒ¹é…åˆ°çš„æ–‡æœ¬</li><li>awk æ›´é€‚åˆæ ¼å¼åŒ–æ–‡æœ¬ï¼Œå¯¹æ–‡æœ¬è¿›è¡Œè¾ƒå¤æ‚æ ¼å¼å¤„ç†</li></ul><p>å…³äºawkå†…å»ºå˜é‡ä¸ªäººè§è§£ï¼Œç®€å•æ˜“æ‡‚</p><p>è§£é‡Šä¸€ä¸‹å˜é‡ï¼š</p><p>å˜é‡ï¼šåˆ†ä¸ºå†…ç½®å˜é‡å’Œè‡ªå®šä¹‰å˜é‡;è¾“å…¥åˆ†éš”ç¬¦FSå’Œè¾“å‡ºåˆ†éš”ç¬¦OFSéƒ½å±äºå†…ç½®å˜é‡ã€‚</p><p>å†…ç½®å˜é‡å°±æ˜¯awké¢„å®šä¹‰å¥½çš„ã€å†…ç½®åœ¨awkå†…éƒ¨çš„å˜é‡ï¼Œè€Œè‡ªå®šä¹‰å˜é‡å°±æ˜¯ç”¨æˆ·å®šä¹‰çš„å˜é‡ã€‚</p><ul><li>FS(Field Separator)ï¼šè¾“å…¥å­—æ®µåˆ†éš”ç¬¦ï¼Œ é»˜è®¤ä¸ºç©ºç™½å­—ç¬¦</li><li>OFS(Out of Field Separator)ï¼šè¾“å‡ºå­—æ®µåˆ†éš”ç¬¦ï¼Œ é»˜è®¤ä¸ºç©ºç™½å­—ç¬¦</li><li>RS(Record Separator)ï¼šè¾“å…¥è®°å½•åˆ†éš”ç¬¦(è¾“å…¥æ¢è¡Œç¬¦)ï¼Œ æŒ‡å®šè¾“å…¥æ—¶çš„æ¢è¡Œç¬¦</li><li>ORS(Output Record Separate)ï¼šè¾“å‡ºè®°å½•åˆ†éš”ç¬¦ï¼ˆè¾“å‡ºæ¢è¡Œç¬¦ï¼‰ï¼Œè¾“å‡ºæ—¶ç”¨æŒ‡å®šç¬¦å·ä»£æ›¿æ¢è¡Œç¬¦</li><li>NF(Number for Field)ï¼šå½“å‰è¡Œçš„å­—æ®µçš„ä¸ªæ•°(å³å½“å‰è¡Œè¢«åˆ†å‰²æˆäº†å‡ åˆ—)</li><li>NR(Number of Record)ï¼šè¡Œå·ï¼Œå½“å‰å¤„ç†çš„æ–‡æœ¬è¡Œçš„è¡Œå·ã€‚</li><li>FNRï¼šå„æ–‡ä»¶åˆ†åˆ«è®¡æ•°çš„è¡Œå·</li><li>ARGCï¼šå‘½ä»¤è¡Œå‚æ•°çš„ä¸ªæ•°</li><li>ARGVï¼šæ•°ç»„ï¼Œä¿å­˜çš„æ˜¯å‘½ä»¤è¡Œæ‰€ç»™å®šçš„å„å‚æ•°</li></ul><p><strong>è‡ªå®šä¹‰å˜é‡çš„æ–¹æ³•</strong></p><ul><li>æ–¹æ³•ä¸€ï¼š-v varname&#x3D;value ï¼Œå˜é‡ååŒºåˆ†å­—ç¬¦å¤§å°å†™ã€‚</li><li>æ–¹æ³•äºŒï¼šåœ¨programä¸­ç›´æ¥å®šä¹‰ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>awk</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux command xargs</title>
    <link href="/GeekFocus/2021/12/17/2021-12-17-Linux_xargs_command/"/>
    <url>/GeekFocus/2021/12/17/2021-12-17-Linux_xargs_command/</url>
    
    <content type="html"><![CDATA[<h2 id="Linux-command-ã€xargsã€‘"><a href="#Linux-command-ã€xargsã€‘" class="headerlink" title="Linux command ã€xargsã€‘"></a>Linux command ã€xargsã€‘</h2><span id="more"></span><h1 id="Linux-xargs-å‘½ä»¤"><a href="#Linux-xargs-å‘½ä»¤" class="headerlink" title="Linux xargs å‘½ä»¤"></a>Linux xargs å‘½ä»¤</h1><p>xargsï¼ˆè‹±æ–‡å…¨æ‹¼ï¼š eXtended ARGumentsï¼‰æ˜¯ç»™<font color='green'>å‘½ä»¤ä¼ é€’å‚æ•°</font>çš„ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œä¹Ÿæ˜¯<font color='green'>ç»„åˆå¤šä¸ªå‘½ä»¤</font>çš„ä¸€ä¸ªå·¥å…·ã€‚</p><p>xargs å¯ä»¥å°†ç®¡é“æˆ–æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰æ•°æ®è½¬æ¢æˆå‘½ä»¤è¡Œå‚æ•°ï¼Œä¹Ÿèƒ½å¤Ÿä»æ–‡ä»¶çš„è¾“å‡ºä¸­è¯»å–æ•°æ®ã€‚</p><p>xargs ä¹Ÿå¯ä»¥å°†å•è¡Œæˆ–å¤šè¡Œæ–‡æœ¬è¾“å…¥è½¬æ¢ä¸ºå…¶ä»–æ ¼å¼ï¼Œä¾‹å¦‚<font color='green'>å¤šè¡Œå˜å•è¡Œï¼Œå•è¡Œå˜å¤šè¡Œ</font>ã€‚</p><p>xargs é»˜è®¤å‘½ä»¤æ˜¯ echoï¼Œè¿™æ„å‘³ç€é€šè¿‡<font color='green'>ç®¡é“ä¼ é€’ç»™ xargs çš„è¾“å…¥åŒ…å«æ¢è¡Œå’Œç©ºç™½</font>ï¼Œé€šè¿‡ xargs çš„å¤„ç†ï¼Œ<font color='green'>æ¢è¡Œå’Œç©ºç™½å°†è¢«ç©ºæ ¼å–ä»£</font>ã€‚</p><p>xargs æ˜¯ä¸€ä¸ªå¼ºæœ‰åŠ›çš„å‘½ä»¤ï¼Œå®ƒèƒ½å¤Ÿæ•è·ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºï¼Œç„¶åä¼ é€’ç»™å¦å¤–ä¸€ä¸ªå‘½ä»¤ã€‚</p><p>ä¹‹æ‰€ä»¥èƒ½ç”¨åˆ°è¿™ä¸ªå‘½ä»¤ï¼Œå…³é”®æ˜¯ç”±äºå¾ˆå¤šå‘½ä»¤ä¸æ”¯æŒ|ç®¡é“æ¥ä¼ é€’å‚æ•°ï¼Œè€Œæ—¥å¸¸å·¥ä½œä¸­æœ‰æœ‰è¿™ä¸ªå¿…è¦ï¼Œæ‰€ä»¥å°±æœ‰äº† xargs å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">find /sbin -perm +700 |<span class="hljs-built_in">ls</span> -l       <span class="hljs-comment">#è¿™ä¸ªå‘½ä»¤æ˜¯é”™è¯¯çš„</span><br>find /sbin -perm +700 |xargs <span class="hljs-built_in">ls</span> -l   <span class="hljs-comment">#è¿™æ ·æ‰æ˜¯æ­£ç¡®çš„</span><br></code></pre></td></tr></table></figure><p>xargs ä¸€èˆ¬æ˜¯å’Œç®¡é“ä¸€èµ·ä½¿ç”¨ã€‚</p><p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">somecommand |xargs -item  <span class="hljs-built_in">command</span><br></code></pre></td></tr></table></figure><p><strong>å‚æ•°ï¼š</strong></p><ul><li>-a file ä»æ–‡ä»¶ä¸­è¯»å…¥ä½œä¸º stdin</li><li>-e flag ï¼Œæ³¨æ„æœ‰çš„æ—¶å€™å¯èƒ½ä¼šæ˜¯-Eï¼Œflagå¿…é¡»æ˜¯ä¸€ä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„æ ‡å¿—ï¼Œå½“xargsåˆ†æåˆ°å«æœ‰flagè¿™ä¸ªæ ‡å¿—çš„æ—¶å€™å°±åœæ­¢ã€‚</li><li>-p å½“æ¯æ¬¡æ‰§è¡Œä¸€ä¸ªargumentçš„æ—¶å€™è¯¢é—®ä¸€æ¬¡ç”¨æˆ·ã€‚</li><li>-n num åé¢åŠ æ¬¡æ•°ï¼Œè¡¨ç¤ºå‘½ä»¤åœ¨æ‰§è¡Œçš„æ—¶å€™ä¸€æ¬¡ç”¨çš„argumentçš„ä¸ªæ•°ï¼Œé»˜è®¤æ˜¯ç”¨æ‰€æœ‰çš„ã€‚</li><li>-t è¡¨ç¤ºå…ˆæ‰“å°å‘½ä»¤ï¼Œç„¶åå†æ‰§è¡Œã€‚</li><li><font color='green'>-i æˆ–æ˜¯-I</font>ï¼Œè¿™å¾—çœ‹linuxæ”¯æŒäº†ï¼Œå°†xargsçš„æ¯é¡¹åç§°ï¼Œä¸€èˆ¬æ˜¯<font color='green'>ä¸€è¡Œä¸€è¡Œèµ‹å€¼ç»™ {}ï¼Œå¯ä»¥ç”¨ {} ä»£æ›¿</font>ã€‚</li><li>-r no-run-if-empty å½“xargsçš„è¾“å…¥ä¸ºç©ºçš„æ—¶å€™åˆ™åœæ­¢xargsï¼Œä¸ç”¨å†å»æ‰§è¡Œäº†ã€‚</li><li>-s num å‘½ä»¤è¡Œçš„æœ€å¤§å­—ç¬¦æ•°ï¼ŒæŒ‡çš„æ˜¯ xargs åé¢é‚£ä¸ªå‘½ä»¤çš„æœ€å¤§å‘½ä»¤è¡Œå­—ç¬¦æ•°ã€‚</li><li><font color='green'>-L num ä»æ ‡å‡†è¾“å…¥ä¸€æ¬¡è¯»å– num è¡Œé€ç»™ command å‘½ä»¤</font>ã€‚</li><li>-l åŒ -Lã€‚</li><li>-d delim åˆ†éš”ç¬¦ï¼Œé»˜è®¤çš„xargsåˆ†éš”ç¬¦æ˜¯å›è½¦ï¼Œargumentçš„åˆ†éš”ç¬¦æ˜¯ç©ºæ ¼ï¼Œè¿™é‡Œä¿®æ”¹çš„æ˜¯xargsçš„åˆ†éš”ç¬¦ã€‚</li><li>-x exitçš„æ„æ€ï¼Œä¸»è¦æ˜¯é…åˆ-sä½¿ç”¨ã€‚ã€‚</li><li>-P ä¿®æ”¹æœ€å¤§çš„è¿›ç¨‹æ•°ï¼Œé»˜è®¤æ˜¯1ï¼Œä¸º0æ—¶å€™ä¸ºas many as it can ï¼Œè¿™ä¸ªä¾‹å­æˆ‘æ²¡æœ‰æƒ³åˆ°ï¼Œåº”è¯¥å¹³æ—¶éƒ½ç”¨ä¸åˆ°çš„å§ã€‚</li></ul><h3 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p>xargs ç”¨ä½œæ›¿æ¢å·¥å…·ï¼Œè¯»å–è¾“å…¥æ•°æ®é‡æ–°æ ¼å¼åŒ–åè¾“å‡ºã€‚</p><p>å®šä¹‰ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œå†…æœ‰å¤šè¡Œæ–‡æœ¬æ•°æ®ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># cat test.txt</span><br><br>a b c d e f g<br>h i j k l m n<br>o p q<br>r s t<br>u v w x y z<br></code></pre></td></tr></table></figure><p><font color='green'>å¤šè¡Œè¾“å…¥å•è¡Œè¾“å‡ºï¼š</font></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># cat test.txt | xargs</span><br>a b c d e f g h i j k l m n o p q r s t u v w x y z<br></code></pre></td></tr></table></figure><p><font color='green'>-n é€‰é¡¹å¤šè¡Œè¾“å‡ºï¼š</font></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># cat test.txt | xargs -n3</span><br><br>a b c<br>d e f<br>g h i<br>j k l<br>m n o<br>p q r<br>s t u<br>v w x<br>y z<br></code></pre></td></tr></table></figure><p>-d é€‰é¡¹å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªå®šç•Œç¬¦ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># echo &quot;nameXnameXnameXname&quot; | xargs -dX</span><br><br>name name name name<br></code></pre></td></tr></table></figure><p>ç»“åˆ -n é€‰é¡¹ä½¿ç”¨ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># echo &quot;nameXnameXnameXname&quot; | xargs -dX -n2</span><br><br>name name<br>name name<br></code></pre></td></tr></table></figure><p>è¯»å– stdinï¼Œå°†æ ¼å¼åŒ–åçš„å‚æ•°ä¼ é€’ç»™å‘½ä»¤</p><p>å‡è®¾ä¸€ä¸ªå‘½ä»¤ä¸º sk.sh å’Œä¸€ä¸ªä¿å­˜å‚æ•°çš„æ–‡ä»¶ arg.txtï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment">#sk.shå‘½ä»¤å†…å®¹ï¼Œæ‰“å°å‡ºæ‰€æœ‰å‚æ•°ã€‚</span><br><br><span class="hljs-built_in">echo</span> $*<br></code></pre></td></tr></table></figure><p>arg.txtæ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># cat arg.txt</span><br><br>aaa<br>bbb<br>ccc<br></code></pre></td></tr></table></figure><p>xargs çš„ä¸€ä¸ªé€‰é¡¹ -Iï¼Œä½¿ç”¨ -I æŒ‡å®šä¸€ä¸ªæ›¿æ¢å­—ç¬¦ä¸² {}ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²åœ¨ xargs æ‰©å±•æ—¶ä¼šè¢«æ›¿æ¢æ‰ï¼Œå½“ -I ä¸ xargs ç»“åˆä½¿ç”¨ï¼Œæ¯ä¸€ä¸ªå‚æ•°å‘½ä»¤éƒ½ä¼šè¢«æ‰§è¡Œä¸€æ¬¡ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># cat arg.txt | xargs -I &#123;&#125; ./sk.sh -p &#123;&#125; -l</span><br><br>-p aaa -l<br>-p bbb -l<br>-p ccc -l<br></code></pre></td></tr></table></figure><p>å¤åˆ¶æ‰€æœ‰å›¾ç‰‡æ–‡ä»¶åˆ° &#x2F;data&#x2F;images ç›®å½•ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">ls</span> *.jpg | xargs -n1 -I &#123;&#125; <span class="hljs-built_in">cp</span> &#123;&#125; /data/images<br></code></pre></td></tr></table></figure><p>xargs ç»“åˆ find ä½¿ç”¨</p><p>ç”¨ rm åˆ é™¤å¤ªå¤šçš„æ–‡ä»¶æ—¶å€™ï¼Œå¯èƒ½å¾—åˆ°ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼š**&#x2F;bin&#x2F;rm Argument list too long.** ç”¨ xargs å»é¿å…è¿™ä¸ªé—®é¢˜ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">find . -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*.log&quot;</span> -print0 | xargs -0 <span class="hljs-built_in">rm</span> -f<br></code></pre></td></tr></table></figure><p>xargs -0 å°† \0 ä½œä¸ºå®šç•Œç¬¦ã€‚</p><p>ç»Ÿè®¡ä¸€ä¸ªæºä»£ç ç›®å½•ä¸­æ‰€æœ‰ php æ–‡ä»¶çš„è¡Œæ•°ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">find . -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*.php&quot;</span> -print0 | xargs -0 <span class="hljs-built_in">wc</span> -l<br></code></pre></td></tr></table></figure><p>æŸ¥æ‰¾æ‰€æœ‰çš„ jpg æ–‡ä»¶ï¼Œå¹¶ä¸”å‹ç¼©å®ƒä»¬ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">find . -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*.jpg&quot;</span> -<span class="hljs-built_in">print</span> | xargs tar -czvf images.tar.gz<br></code></pre></td></tr></table></figure><p>xargs å…¶ä»–åº”ç”¨</p><p>å‡å¦‚æœ‰<font color='green'>ä¸€ä¸ªæ–‡ä»¶åŒ…å«äº†å¾ˆå¤šå¸Œæœ›ä¸‹è½½çš„ URL</font>ï¼Œä½ èƒ½å¤Ÿä½¿ç”¨ xargsä¸‹è½½æ‰€æœ‰é“¾æ¥ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># cat url-list.txt | xargs wget -c</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xargs</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Oryza Sativa ã€Gene IDã€‘ã€GOã€‘ã€KEGGã€‘</title>
    <link href="/GeekFocus/2021/12/16/2021-12-16-osa_GO_KEGG/"/>
    <url>/GeekFocus/2021/12/16/2021-12-16-osa_GO_KEGG/</url>
    
    <content type="html"><![CDATA[<h2 id="Oryza-Sativa-ã€Gene-IDã€‘ã€GOã€‘ã€KEGGã€‘"><a href="#Oryza-Sativa-ã€Gene-IDã€‘ã€GOã€‘ã€KEGGã€‘" class="headerlink" title="Oryza Sativa ã€Gene IDã€‘ã€GOã€‘ã€KEGGã€‘"></a>Oryza Sativa ã€Gene IDã€‘ã€GOã€‘ã€KEGGã€‘</h2><span id="more"></span><h1 id="O-sativa-ID-åŒºåˆ†"><a href="#O-sativa-ID-åŒºåˆ†" class="headerlink" title="O_sativa ID åŒºåˆ†"></a>O_sativa ID åŒºåˆ†</h1><ul><li><p>MSU, <font color='red'>RGAP7.0</font>(rice genome annotation project)ï¼š<strong>LOC_Os01g01010.1</strong>,  LOC_Osp#g#####ï¼Œ<strong>LOC_Os-Chr-g-number</strong></p></li><li><p><font color='red'>RAP</font>(the rice annotation project), IRGSP-1.0: <strong>Os06t0664200</strong>ï¼Œ<strong>Os-Chr-g-number</strong></p></li><li><p><font color='red'>KEGGæ”¯æŒ</font>ï¼šosaï¼šRefSeq IDï¼ˆGene IDï¼š<strong>4334374</strong>ï¼‰ï¼›dosaï¼šRAP-DB IDï¼ˆ<strong>Os06t0664200-01</strong>ï¼‰</p></li><li><p>ç–‘é—®ï¼šRAP-DB IDä¸ºä»€ä¹ˆå’ŒIRGSP-1.0 IDå¤šäº†ä¸ª-01ï¼šRAP-Locusä¸RAP IDä¸åŒ</p></li><li><p>clusterProfilerå¯èƒ½æ˜¯ç›®å‰KEGGå¯Œé›†åˆ†ææœ€å¥½çš„è½¯ä»¶ï¼Œå› ä¸ºèƒ½<strong>çˆ¬å–æœ€æ–°çš„KEGGåœ¨çº¿ç‰ˆæ•°æ®åº“</strong>ï¼Œè€Œä¸æ˜¯ç”¨ä¸å†æ›´æ–°çš„KEGG.dbã€‚</p></li><li><p>å¯¹äºRGAPæ°´ç¨»çš„åŸºå› ç¼–å·ï¼Œå¦‚LOC_Os01g01010.1 æˆ‘ä»¬è¦æŠŠå®ƒå˜æˆ<code>Os06t0664200-01</code> RAP-IDçš„å‘½åæ–¹å¼ï¼Œç¬¦åˆ<code>dosa</code>çš„è¦æ±‚ã€‚</p></li></ul><h2 id="è½¬åŒ–id"><a href="#è½¬åŒ–id" class="headerlink" title="è½¬åŒ–id"></a>è½¬åŒ–id</h2><ul><li><p>ä¸‹è½½ä¸€ä¸ªå„ä¸ªIDå¯¹åº”çš„æ–‡ä»¶ï¼š<a href="https://shigen.nig.ac.jp/rice/oryzabase/download/riceId%E3%80%82%E5%AF%B9%E4%BA%8ERGAP%E6%B0%B4%E7%A8%BB%E7%9A%84%E5%9F%BA%E5%9B%A0%E7%BC%96%E5%8F%B7%EF%BC%8C%E5%A6%82LOC_Os01g01010.1">https://shigen.nig.ac.jp/rice/oryzabase/download/riceIdã€‚å¯¹äºRGAPæ°´ç¨»çš„åŸºå› ç¼–å·ï¼Œå¦‚LOC_Os01g01010.1</a> æŠŠå®ƒå˜æˆ<code>Os06t0664200-01</code> RAP-IDçš„å‘½åæ–¹å¼ï¼Œç¬¦åˆ<code>dosa</code>çš„è¦æ±‚ã€‚</p></li><li><p>æ—¥æœ¬æ™´æ•°æ®åº“ï¼š<a href="https://shigen.nig.ac.jp/rice/oryzabase">https://shigen.nig.ac.jp/rice/oryzabase</a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ grep LOC_Os01g01010.1  rice_id_20140620174522.txt<br>Os01g0100100    Os01t0100100-01 J075199P03      301700  J075199P03              LOC_Os01g01010.1        AK242339<br><span class="hljs-built_in">cat</span> LOC.txt | xargs -i awk <span class="hljs-string">&#x27;BEGIN&#123;FS=&quot;\t&quot;&#125;  $0 ~/&#123;&#125;/ &#123; print $2&#125;&#x27;</span> rice_id_20140620174522.txt &gt; RAP_id.txt<br></code></pre></td></tr></table></figure><hr><h1 id="è¶…å‡ ä½•åˆ†å¸ƒ"><a href="#è¶…å‡ ä½•åˆ†å¸ƒ" class="headerlink" title="è¶…å‡ ä½•åˆ†å¸ƒ"></a>è¶…å‡ ä½•åˆ†å¸ƒ</h1><p>å®ƒæè¿°äº†ä»æœ‰é™Nä¸ªç‰©ä»¶ï¼ˆå…¶ä¸­åŒ…å«Mä¸ªæŒ‡å®šç§ç±»çš„ç‰©ä»¶ï¼‰ä¸­æŠ½å‡ºnä¸ªç‰©ä»¶ï¼ŒæˆåŠŸæŠ½å‡ºè¯¥æŒ‡å®šç§ç±»çš„ç‰©ä»¶çš„æ¬¡æ•°ï¼ˆä¸æ”¾å›ï¼‰ã€‚ç§°ä¸ºè¶…å‡ ä½•åˆ†å¸ƒã€‚</p><p><a href="https://baike.baidu.com/item/%E8%B6%85%E5%87%A0%E4%BD%95%E5%88%86%E5%B8%83/4782968">https://baike.baidu.com/item/è¶…å‡ ä½•åˆ†å¸ƒ/4782968</a></p><hr><h1 id="GO-enrichmentï¼šweb"><a href="#GO-enrichmentï¼šweb" class="headerlink" title="GO enrichmentï¼šweb"></a>GO enrichmentï¼šweb</h1><blockquote><p>ç½‘ç«™ï¼š<a href="http://systemsbiology.cau.edu.cn/agriGOv2">http://systemsbiology.cau.edu.cn/agriGOv2</a>  åå¤§</p></blockquote><h1 id="GO-enrichmentï¼šR-clusterProfiler"><a href="#GO-enrichmentï¼šR-clusterProfiler" class="headerlink" title="GO enrichmentï¼šR clusterProfiler"></a>GO enrichmentï¼šR clusterProfiler</h1><p><strong>X</strong> clusterprofilerä¸èƒ½ç”¨æ¥åšGOçš„å¯Œé›†åˆ†æï¼Œå› ä¸ºå…¶20ä¸ªç‰©ç§ä¸­ä¸åŒ…æ‹¬æ°´ç¨»ï¼›</p><h2 id="è·å–Orgdbï¼Œ"><a href="#è·å–Orgdbï¼Œ" class="headerlink" title="è·å–Orgdbï¼Œ"></a>è·å–Orgdbï¼Œ</h2><p>AnnotationHubåœ¨çº¿æ£€ç´¢å¹¶æŠ“å–OrgDb</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-operator">&gt;</span> require<span class="hljs-punctuation">(</span>AnnotationHub<span class="hljs-punctuation">)</span><br><span class="hljs-operator">&gt;</span> hub <span class="hljs-operator">&lt;-</span> AnnotationHub<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-operator">&gt;</span> query<span class="hljs-punctuation">(</span>hub<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;oryza sativa&quot;</span><span class="hljs-punctuation">)</span><br>title<br>  AH10561 <span class="hljs-operator">|</span> hom.Oryza_sativa.inp8.sqlite<br>  AH55775 <span class="hljs-operator">|</span> org.Oryza_sativa_Japonica_Group.eg.sqlite<br><span class="hljs-operator">&gt;</span> rice <span class="hljs-operator">&lt;-</span> hub<span class="hljs-punctuation">[[</span><span class="hljs-string">&#x27;AH55775&#x27;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-operator">&gt;</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>keys<span class="hljs-punctuation">(</span>rice<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br><span class="hljs-comment">#é€šè¿‡æ£€ç´¢ï¼Œorg.Oryza_sativa_Japonica_Group.eg.sqliteå°±æ˜¯æˆ‘ä»¬æ‰€è¦çš„OrgDbï¼Œå¯ä»¥é€šè¿‡ç›¸åº”çš„accession number, AH55775 æŠ“å–æ–‡ä»¶ï¼Œå¹¶å­˜å…¥äº†riceå¯¹è±¡ä¸­ï¼Œå®ƒåŒ…å«äº†32639ä¸ªåŸºå› çš„æ³¨é‡Š</span><br></code></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">#è¿™ä¸ªOrgDbï¼ŒåŒ…å«æœ‰ä»¥ä¸‹ä¸€äº›æ³¨é‡Šä¿¡æ¯:</span><br><span class="hljs-operator">&gt;</span> columns<span class="hljs-punctuation">(</span>rice<span class="hljs-punctuation">)</span><br> <span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-string">&quot;ACCNUM&quot;</span>      <span class="hljs-string">&quot;ALIAS&quot;</span>       <span class="hljs-string">&quot;CHR&quot;</span>         <span class="hljs-string">&quot;ENTREZID&quot;</span>    <span class="hljs-string">&quot;EVIDENCE&quot;</span><br> <span class="hljs-punctuation">[</span><span class="hljs-number">6</span><span class="hljs-punctuation">]</span> <span class="hljs-string">&quot;EVIDENCEALL&quot;</span> <span class="hljs-string">&quot;GENENAME&quot;</span>    <span class="hljs-string">&quot;GID&quot;</span>         <span class="hljs-string">&quot;GO&quot;</span>          <span class="hljs-string">&quot;GOALL&quot;</span><br><span class="hljs-punctuation">[</span><span class="hljs-number">11</span><span class="hljs-punctuation">]</span> <span class="hljs-string">&quot;ONTOLOGY&quot;</span>    <span class="hljs-string">&quot;ONTOLOGYALL&quot;</span> <span class="hljs-string">&quot;PMID&quot;</span>        <span class="hljs-string">&quot;REFSEQ&quot;</span>      <span class="hljs-string">&quot;SYMBOL&quot;</span><br>  <span class="hljs-punctuation">[</span><span class="hljs-number">16</span><span class="hljs-punctuation">]</span> <span class="hljs-string">&quot;UNIGENE&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">##æˆ‘ä»¬å¯ä»¥ä½¿ç”¨bitræ¥è½¬æ¢IDï¼Œç”šè‡³äºç›´æ¥æ£€ç´¢GOæ³¨é‡Šï¼š</span><br><span class="hljs-operator">&gt;</span> require<span class="hljs-punctuation">(</span>clusterProfiler<span class="hljs-punctuation">)</span><br><span class="hljs-operator">&gt;</span> bitr<span class="hljs-punctuation">(</span>keys<span class="hljs-punctuation">(</span>rice<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&#x27;ENTREZID&#x27;</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;REFSEQ&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;GO&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;ONTOLOGY&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> rice<span class="hljs-punctuation">)</span><br><span class="hljs-string">&#x27;select()&#x27;</span> returned <span class="hljs-number">1</span><span class="hljs-operator">:</span>many mapping between keys and columns<br>  ENTREZID      REFSEQ         GO ONTOLOGY<br><span class="hljs-number">1</span>  <span class="hljs-number">3131385</span> NP_039457.2 GO<span class="hljs-operator">:</span><span class="hljs-number">0005739</span>       CC<br><span class="hljs-number">2</span>  <span class="hljs-number">3131385</span> NP_039457.2 GO<span class="hljs-operator">:</span><span class="hljs-number">0005763</span>       CC<br><span class="hljs-comment">##GOå¯Œé›†åˆ†æ</span><br><span class="hljs-operator">&gt;</span> sample_genes <span class="hljs-operator">&lt;-</span> keys<span class="hljs-punctuation">(</span>rice<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">100</span><span class="hljs-punctuation">]</span><br><span class="hljs-operator">&gt;</span> head<span class="hljs-punctuation">(</span>sample_genes<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-string">&quot;3131385&quot;</span> <span class="hljs-string">&quot;3131390&quot;</span> <span class="hljs-string">&quot;3131391&quot;</span> <span class="hljs-string">&quot;3131392&quot;</span> <span class="hljs-string">&quot;3131393&quot;</span> <span class="hljs-string">&quot;3131394&quot;</span><br><span class="hljs-comment">##è¿™é‡Œåªæ˜¯ç®€å•åœ°ä½¿ç”¨IDåˆ—è¡¨ä¸­å‰100ä¸ªENTREZåŸºå› IDï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶å®ƒçš„IDï¼Œé€šè¿‡å€ŸåŠ©äºbitrè¿›è¡Œè½¬æ¢ï¼Œæˆ–è€…é€šè¿‡ç»™enrichGOæŒ‡å®šIDç±»å‹(keyTypeå‚æ•°ï¼‰ã€‚</span><br><span class="hljs-operator">&gt;</span> æœ‰äº†OrgDbï¼Œä½¿ç”¨èµ·æ¥ï¼Œå°±è·Ÿæ–‡æ¡£ä¸­ä½¿ç”¨äººç±»åŸºå› åšä¸ºä¾‹å­ä¸€æ ·ï¼Œç”¨æ³•ä¸€è‡´ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥é€šè¿‡clusterProfileræ‰€æä¾›çš„å„ç§å¯è§†åŒ–å‡½æ•°å¯¹ç»“æœè¿›è¡Œå±•ç¤ºï¼š<br><br><span class="hljs-operator">&gt;</span> require<span class="hljs-punctuation">(</span>clusterProfiler<span class="hljs-punctuation">)</span><br><span class="hljs-operator">&gt;</span> res <span class="hljs-operator">=</span> enrichGO<span class="hljs-punctuation">(</span>sample_genes<span class="hljs-punctuation">,</span> OrgDb<span class="hljs-operator">=</span>rice<span class="hljs-punctuation">,</span> pvalueCutoff<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> qvalueCutoff<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><br><span class="hljs-operator">&gt;</span> res<br><span class="hljs-comment">#</span><br><span class="hljs-comment"># over-representation test</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment">#...@organism    Oryza sativa_Japonica_Group</span><br><span class="hljs-comment">#...@ontology    MF</span><br><span class="hljs-comment">#...@keytype     ENTREZID</span><br><span class="hljs-comment">#...@gene        chr [1:100] &quot;3131385&quot; &quot;3131390&quot; &quot;3131391&quot; &quot;3131392&quot; &quot;3131393&quot; &quot;3131394&quot; ...</span><br><span class="hljs-comment">#...pvalues adjusted by &#x27;BH&#x27; with cutoff &lt;1</span><br><span class="hljs-comment">#...28 enriched terms found</span><br><span class="hljs-string">&#x27;data.frame&#x27;</span><span class="hljs-operator">:</span>   <span class="hljs-number">28</span> obs. of  <span class="hljs-number">9</span> variables<span class="hljs-operator">:</span><br> <span class="hljs-operator">$</span> ID         <span class="hljs-operator">:</span> chr  <span class="hljs-string">&quot;GO:0003735&quot;</span> <span class="hljs-string">&quot;GO:0005198&quot;</span> <span class="hljs-string">&quot;GO:0003723&quot;</span> <span class="hljs-string">&quot;GO:0016830&quot;</span> ...<br> <span class="hljs-operator">$</span> Description<span class="hljs-operator">:</span> chr  <span class="hljs-string">&quot;structural constituent of ribosome&quot;</span> <span class="hljs-string">&quot;structural molecule activity&quot;</span> <span class="hljs-string">&quot;RNA binding&quot;</span> <span class="hljs-string">&quot;carbon-carbon lyase activity&quot;</span> ...<br> <span class="hljs-operator">$</span> GeneRatio  <span class="hljs-operator">:</span> chr  <span class="hljs-string">&quot;7/12&quot;</span> <span class="hljs-string">&quot;7/12&quot;</span> <span class="hljs-string">&quot;2/12&quot;</span> <span class="hljs-string">&quot;1/12&quot;</span> ...<br> <span class="hljs-operator">$</span> BgRatio    <span class="hljs-operator">:</span> chr  <span class="hljs-string">&quot;22/478&quot;</span> <span class="hljs-string">&quot;22/478&quot;</span> <span class="hljs-string">&quot;14/478&quot;</span> <span class="hljs-string">&quot;10/478&quot;</span> ...<br> <span class="hljs-operator">$</span> pvalue     <span class="hljs-operator">:</span> num  <span class="hljs-number">1.08e-07</span> <span class="hljs-number">1.08e-07</span> <span class="hljs-number">4.45e-02</span> <span class="hljs-number">2.26e-01</span> <span class="hljs-number">3.24e-01</span> ...<br> <span class="hljs-operator">$</span> p.adjust   <span class="hljs-operator">:</span> num  <span class="hljs-number">1.52e-06</span> <span class="hljs-number">1.52e-06</span> <span class="hljs-number">4.15e-01</span> <span class="hljs-number">1.00</span> <span class="hljs-number">1.00</span> ...<br> <span class="hljs-operator">$</span> qvalue     <span class="hljs-operator">:</span> num  <span class="hljs-number">1.42e-06</span> <span class="hljs-number">1.42e-06</span> <span class="hljs-number">3.90e-01</span> <span class="hljs-number">9.40e-01</span> <span class="hljs-number">9.40e-01</span> ...<br> <span class="hljs-operator">$</span> geneID     <span class="hljs-operator">:</span> chr  <span class="hljs-string">&quot;3131425/3131435/3131436/3131439/3131441/3131442/3131457&quot;</span> <span class="hljs-string">&quot;3131425/3131435/3131436/3131439/3131441/3131442/3131457&quot;</span> <span class="hljs-string">&quot;3131425/3131457&quot;</span> <span class="hljs-string">&quot;3131463&quot;</span> ...<br> <span class="hljs-operator">$</span> Count      <span class="hljs-operator">:</span> int  <span class="hljs-number">7</span> <span class="hljs-number">7</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">1</span> ...<br></code></pre></td></tr></table></figure><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs objectivec">sly &lt;- ah[[<span class="hljs-string">&quot;AH61992&quot;</span>]]<br>sly<br>saveDb(sly,file=<span class="hljs-string">&quot;sly.orgdb&quot;</span>)<br>laodDb(file=<span class="hljs-string">&quot;sly.orgdb&quot;</span>)<br></code></pre></td></tr></table></figure><p>plant_GSEA: MSU-&gt;Uniprot</p><p>david:Uniprot-&gt;Entrez_id</p><hr><h1 id="KEGG-enrichmentï¼šR-clusterProfiler"><a href="#KEGG-enrichmentï¼šR-clusterProfiler" class="headerlink" title="KEGG enrichmentï¼šR clusterProfiler"></a>KEGG enrichmentï¼šR clusterProfiler</h1><ol><li><p>enrichKEGG</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs r">enrichKEGG<span class="hljs-punctuation">(</span>gene<span class="hljs-punctuation">,</span> organism <span class="hljs-operator">=</span> <span class="hljs-string">&quot;hsa&quot;</span><span class="hljs-punctuation">,</span> keyType <span class="hljs-operator">=</span> <span class="hljs-string">&quot;kegg&quot;</span><span class="hljs-punctuation">,</span> pvalueCutoff <span class="hljs-operator">=</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><br>  pAdjustMethod <span class="hljs-operator">=</span> <span class="hljs-string">&quot;BH&quot;</span><span class="hljs-punctuation">,</span> universe<span class="hljs-punctuation">,</span> minGSSize <span class="hljs-operator">=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span> maxGSSize <span class="hljs-operator">=</span> <span class="hljs-number">500</span><span class="hljs-punctuation">,</span><br>  qvalueCutoff <span class="hljs-operator">=</span> <span class="hljs-number">0.2</span><span class="hljs-punctuation">,</span> use_internal_data <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment">#geneï¼š åŸºå› åï¼Œè¦å’ŒkeyTypeå¯¹åº”</span><br><span class="hljs-comment">#organism: éœ€è¦å‚è€ƒ http://www.genome.jp/kegg/catalog/org_list.html</span><br><span class="hljs-comment">#keyType: åŸºå› çš„å‘½åæ–¹å¼ï¼Œ â€œkeggâ€, â€˜ncbi-geneidâ€™, â€˜ncib-proteinidâ€™ and â€˜uniprotâ€™é€‰æ‹©å…¶ä¸€</span><br><span class="hljs-comment">#enrichKEGGçš„ä¸€ä¸ªå…³é”®åœ¨äºç†è§£å®ƒæ˜¯å¦‚ä½•è·å–æ•°æ®çš„ã€‚åœ¨çº¿çˆ¬å–æ•°æ®åº“ï¼Œç›¸å½“äºåœ¨KEGGä¸Šæ‰‹åŠ¨è¾“å…¥åŸºå› åæŸ¥è¯¢ã€‚</span><br><span class="hljs-comment">#æ‰€ä»¥ï¼ŒæŠŠenrichKEGGå½“åšæµè§ˆå™¨ï¼Œè¯•å‡ºåˆé€‚çš„keytypesã€‚</span><br></code></pre></td></tr></table></figure></li><li></li></ol><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs R">library<span class="hljs-punctuation">(</span>clusterProfiler<span class="hljs-punctuation">)</span><br><span class="hljs-comment"># å¯¹äºGID</span><br>kk <span class="hljs-operator">&lt;-</span> enrichkegg<span class="hljs-punctuation">(</span>gid_list<span class="hljs-punctuation">,</span>organism<span class="hljs-operator">=</span><span class="hljs-string">&#x27;osa&#x27;</span><span class="hljs-punctuation">,</span>keyType <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;kegg&#x27;</span><span class="hljs-punctuation">,</span>pvalueCutoff<span class="hljs-operator">=</span><span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span> pAdjustMethod<span class="hljs-operator">=</span><span class="hljs-string">&#x27;BH&#x27;</span><span class="hljs-punctuation">,</span>qvalueCutoff<span class="hljs-operator">=</span><span class="hljs-number">0.1</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># å¯¹äºRAP_ID</span><br>kk <span class="hljs-operator">&lt;-</span> enrichkegg<span class="hljs-punctuation">(</span>rap_list<span class="hljs-punctuation">,</span>organism<span class="hljs-operator">=</span><span class="hljs-string">&#x27;dosa&#x27;</span><span class="hljs-punctuation">,</span>keyType <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;kegg&#x27;</span><span class="hljs-punctuation">,</span>pvalueCutoff<span class="hljs-operator">=</span><span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span> pAdjustMethod<span class="hljs-operator">=</span><span class="hljs-string">&#x27;BH&#x27;</span><span class="hljs-punctuation">,</span>qvalueCutoff<span class="hljs-operator">=</span><span class="hljs-number">0.1</span><span class="hljs-punctuation">)</span><br><br>write.table<span class="hljs-punctuation">(</span>ekk<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;kegg.txt&quot;</span><span class="hljs-punctuation">,</span>sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;\t&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">quote</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">,</span>row.names <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>barplot<span class="hljs-punctuation">(</span>ekk<span class="hljs-punctuation">,</span>showCategory <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>title <span class="hljs-operator">=</span> <span class="hljs-string">&quot;EnrichmentKEGG&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><ol start="3"><li>è‹¥å·®å¼‚åŸºå› é›†ï¼ˆå¦‚500ä¸ªï¼‰æœ¬èº«ç¡®å®æ²¡æœ‰ç”Ÿç‰©å­¦åŠŸèƒ½åå¥½æ€§ï¼Œéå¸¸æœ‰å¯èƒ½æ— æ˜¾è‘—å¯Œé›†çš„keggé€šè·¯ã€‚</li></ol><p>ä¿®æ”¹ä»£ç ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs r">kk.down <span class="hljs-operator">&lt;-</span> enrichKEGG<span class="hljs-punctuation">(</span>gene <span class="hljs-operator">=</span> gene_down<span class="hljs-punctuation">,</span><br>                        organism <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;hsa&#x27;</span><span class="hljs-punctuation">,</span> <br>                        pvalueCutoff <span class="hljs-operator">=</span> <span class="hljs-number">0.9</span><span class="hljs-punctuation">,</span><br>                        qvalueCutoff <span class="hljs-operator">=</span><span class="hljs-number">0.9</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment"># éœ€è¦è‡ªå·±å·®å¼‚åˆ†æç­›é€‰å¾—åˆ° gene_down åŸºå› é›† ï¼Œç„¶åè¿›è¡Œè¶…å‡ ä½•åˆ†å¸ƒæ£€éªŒ</span><br><span class="hljs-comment">#å†è°ƒæ•´é˜ˆå€¼</span><br></code></pre></td></tr></table></figure><ol start="4"><li><p>æˆ–å¯å»MSigDBï¼ˆMolecular Signatures Database<a href="https://www.gsea-msigdb.org/gsea/msigdb%EF%BC%89%E7%9C%8B%E5%85%B6%E5%AE%83%E5%8A%9F%E8%83%BD%E5%9F%BA%E5%9B%A0%E9%9B%86%E6%98%AF%E5%90%A6%E5%8F%AF%E4%BB%A5%E5%AF%8C%E9%9B%86%EF%BC%8CMSigDB%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E5%AE%9A%E4%B9%89%E4%BA%86%E5%B7%B2%E7%9F%A5%E7%9A%84%E5%9F%BA%E5%9B%A0%E9%9B%86%E5%90%88%EF%BC%9A%E5%8C%85%E6%8B%ACH%E5%92%8CC1-C7%E5%85%AB%E4%B8%AA%E7%B3%BB%E5%88%97%EF%BC%88Collection%EF%BC%89%EF%BC%8C%E6%A4%8D%E7%89%A9%E9%80%82%E7%94%A8%EF%BC%9F">https://www.gsea-msigdb.org/gsea/msigdbï¼‰çœ‹å…¶å®ƒåŠŸèƒ½åŸºå› é›†æ˜¯å¦å¯ä»¥å¯Œé›†ï¼ŒMSigDBæ•°æ®åº“ä¸­å®šä¹‰äº†å·²çŸ¥çš„åŸºå› é›†åˆï¼šåŒ…æ‹¬Hå’ŒC1-C7å…«ä¸ªç³»åˆ—ï¼ˆCollectionï¼‰ï¼Œæ¤ç‰©é€‚ç”¨ï¼Ÿ</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/150744437">GSEAåˆ†æ</a>ï¼Œä¸ä¾èµ–äºå·®å¼‚åˆ†ææœ¬èº«,æ¤ç‰©é€‚ç”¨ï¼Ÿ</p></li></ol><hr><h1 id="KEGGæ•°æ®åº“ä¸ä¼šä¸‹è½½ï¼Ÿäº†è§£ä¸‹APIï¼"><a href="#KEGGæ•°æ®åº“ä¸ä¼šä¸‹è½½ï¼Ÿäº†è§£ä¸‹APIï¼" class="headerlink" title="KEGGæ•°æ®åº“ä¸ä¼šä¸‹è½½ï¼Ÿäº†è§£ä¸‹APIï¼"></a>KEGGæ•°æ®åº“ä¸ä¼šä¸‹è½½ï¼Ÿäº†è§£ä¸‹APIï¼</h1><ol><li><p>KEGGæ•°æ®åº“å¹¶ä¸æä¾›å…è´¹ã€æ‰¹é‡è›‹ç™½åºåˆ—ä¸‹è½½ï¼Œå…¶å®˜æ–¹æä¾›åœ¨çº¿åˆ†æå·¥å…·BlastKOALAï¼ˆ<a href="https://link.zhihu.com/?target=https://www.kegg.jp/blastkoala/">https://www.kegg.jp/blastkoala/</a>ï¼‰ç­‰å¯ç”¨äºKEGGæ•°æ®åº“çš„æ³¨é‡Šåˆ†æã€‚æ­¤å¤–è¿˜æœ‰å…¶ä»–ä¸€äº›åœ¨çº¿åˆ†æå·¥å…·ä¾‹å¦‚å¾ˆå¸¸ç”¨çš„KAASï¼ˆ<a href="https://link.zhihu.com/?target=https://www.genome.jp/tools/kaas/">https://www.genome.jp/tools/kaas/</a>ï¼‰ç­‰ã€‚åœ¨çº¿å·¥å…·å†…éƒ¨å‚æ•°æœªçŸ¥ã€‚</p></li><li><p>KEGG APIï¼ˆ<a href="https://www.kegg.jp/kegg/rest/keggapi.html%EF%BC%89%E6%98%AF%E5%92%8CKEGG%E5%86%85%E6%A0%B8%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9B%E8%A1%8C%E4%BA%A4%E4%BA%92%E7%9A%84%E7%A8%8B%E5%BA%8F%E7%95%8C%E9%9D%A2%EF%BC%8C%E5%85%81%E8%AE%B8%E7%94%A8%E6%88%B7%E5%9F%BA%E4%BA%8E%E8%AF%A5%E7%95%8C%E9%9D%A2%E6%A3%80%E7%B4%A2KEGG%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8C[%E4%B8%8B%E8%BD%BD](https://zhuanlan.zhihu.com/p/76195765)">https://www.kegg.jp/kegg/rest/keggapi.htmlï¼‰æ˜¯å’ŒKEGGå†…æ ¸æ•°æ®åº“è¿›è¡Œäº¤äº’çš„ç¨‹åºç•Œé¢ï¼Œå…è®¸ç”¨æˆ·åŸºäºè¯¥ç•Œé¢æ£€ç´¢KEGGæ•°æ®åº“ï¼Œ[ä¸‹è½½](https://zhuanlan.zhihu.com/p/76195765)</a></p><p>(1)<a href="https://mp.weixin.qq.com/s/YlJbkIg9It9On5HWRPPgmQ">https://mp.weixin.qq.com/s/YlJbkIg9It9On5HWRPPgmQ</a></p><p>(2)<a href="https://mp.weixin.qq.com/s/F3dRgHBI4a2atvz0O_pukA">https://mp.weixin.qq.com/s/F3dRgHBI4a2atvz0O_pukA</a></p><p>(3)<a href="https://mp.weixin.qq.com/s/oDDIlWXsLyTCh18bEEysmQ">https://mp.weixin.qq.com/s/oDDIlWXsLyTCh18bEEysmQ</a></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>Biology</category>
      
    </categories>
    
    
    <tags>
      
      <tag>geneID</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>KMeans</title>
    <link href="/GeekFocus/2021/11/15/2021-11-15-kmeans/"/>
    <url>/GeekFocus/2021/11/15/2021-11-15-kmeans/</url>
    
    <content type="html"><![CDATA[<p>ç›‘ç£å­¦ä¹ </p><p>æ— ç›‘ç£å­¦ä¹ ï¼šæ•°æ®æ— æ ‡æ³¨ç”šè‡³éç»“æ„åŒ–ã€‚KMeansâ€¦</p><span id="more"></span><h1 id="KMeans"><a href="#KMeans" class="headerlink" title="KMeans"></a>KMeans</h1><h2 id="ç®€ä»‹-èšç±»ä¸KMeans"><a href="#ç®€ä»‹-èšç±»ä¸KMeans" class="headerlink" title="ç®€ä»‹-èšç±»ä¸KMeans"></a>ç®€ä»‹-èšç±»ä¸KMeans</h2><blockquote><ul><li><strong>èšç±»ï¼ˆClusteringï¼‰</strong>ï¼šå°†æ•°æ®å¯¹è±¡åˆ†ä¸ºå¤šä¸ªç±»æˆ–è€…ç°‡ (Cluster)ï¼Œä½¿åŒä¸€ç°‡å¯¹è±¡é—´è¾ƒé«˜ç›¸ä¼¼åº¦ï¼Œä¸åŒç°‡å¯¹è±¡å·®åˆ«è¾ƒå¤§ã€‚</li><li><strong>åˆ’åˆ†ï¼ˆPartitioningï¼‰</strong>ï¼šèšç±»å¯åŸºäºåˆ’åˆ†ï¼Œä¹Ÿå¯åŸºäºåˆ†å±‚ã€‚åˆ’åˆ†å³å°†å¯¹è±¡åˆ’åˆ†æˆä¸åŒç°‡ï¼Œè€Œåˆ†å±‚å°†å¯¹è±¡åˆ†ç­‰çº§ã€‚</li><li><strong>æ’ä»–ï¼ˆExclusiveï¼‰</strong>ï¼šä¸€ä¸ªæ•°æ®å¯¹è±¡ï¼Œåªèƒ½è¢«åˆ’åˆ†åˆ°ä¸€ä¸ªç°‡ã€‚å¦‚æœä¸€ä¸ªæ•°æ®å¯¹è±¡å¯è¢«åˆ’åˆ†åˆ°å¤šä¸ªç°‡ï¼Œåˆ™ç§°ä¸ºå¯é‡å ï¼ˆOverlappingï¼‰ã€‚</li><li><strong>è·ç¦»ï¼ˆDistanceï¼‰</strong>ï¼šåŸºäºè·ç¦»çš„èšç±»å°†è·ç¦»è¿‘çš„ç›¸ä¼¼å¯¹è±¡èšåœ¨ä¸€èµ·ã€‚åŸºäº<font color="red">æ¦‚ç‡åˆ†å¸ƒæ¨¡å‹çš„èšç±»ï¼Ÿ</font>åœ¨ä¸€ç»„å¯¹è±¡ä¸­ï¼Œæ‰¾åˆ°ç¬¦åˆç‰¹å®šåˆ†å¸ƒæ¨¡å‹çš„å¯¹è±¡çš„é›†åˆï¼Œä¸ä¸€å®šæ˜¯è·ç¦»æœ€è¿‘çš„æˆ–è€…æœ€ç›¸ä¼¼çš„ï¼Œè€Œæ˜¯èƒ½å®Œç¾çš„å‘ˆç°å‡ºæ¦‚ç‡åˆ†å¸ƒæ¨¡å‹æ‰€æè¿°çš„æ¨¡å‹ã€‚</li><li>æ¬§æ°è·ç¦»ï¼šæ¬§å‡ é‡Œå¾—åº¦é‡äºŒç»´å’Œä¸‰ç»´ç©ºé—´ä¸­çš„æ¬§æ°è·ç¦»å°±æ˜¯ä¸¤ç‚¹ä¹‹é—´çš„å®é™…è·ç¦»</li></ul></blockquote><ul><li><p>ä¸åˆ†ç±»ã€åºåˆ—æ ‡æ³¨ä¸åŒï¼Œèšç±»äº‹å…ˆå¹¶ä¸çŸ¥é“ä»»ä½•æ ·æœ¬æ ‡ç­¾ï¼Œé€šè¿‡æ•°æ®ä¹‹é—´å†…åœ¨å…³ç³»æŠŠæ ·æœ¬åˆ’åˆ†ä¸ºè‹¥å¹²ç±»åˆ«ï¼Œä½¿å¾—åŒç±»åˆ«æ ·æœ¬ä¹‹é—´çš„ç›¸ä¼¼åº¦é«˜ï¼Œä¸åŒç±»åˆ«ç›¸ä¼¼åº¦ä½ï¼ˆå¢å¤§ç±»å†…èšï¼Œå‡å°‘ç±»é—´è·ï¼‰ã€‚</p></li><li><p>èšç±»å±äºéç›‘ç£å­¦ä¹ ï¼ŒKå‡å€¼èšç±»æœ€åŸºç¡€å¸¸ç”¨ã€‚åŸºæœ¬æ€æƒ³ï¼Œ<font color='green'>é€šè¿‡è¿­ä»£å¯»æ‰¾Kä¸ªç°‡ï¼ˆClusterï¼‰ï¼Œä½¿èšç±»ç»“æœå¯¹åº”çš„æŸå¤±å‡½æ•°æœ€å°</font>ã€‚ç»ˆæ­¢æ¡ä»¶æ˜¯æ²¡æœ‰ï¼ˆæˆ–æœ€å°æ•°ç›®ï¼‰å¯¹è±¡è¢«é‡æ–°åˆ†é…ç»™ä¸åŒçš„èšç±»ï¼Œæ²¡æœ‰ï¼ˆæˆ–æœ€å°æ•°ç›®ï¼‰èšç±»ä¸­å¿ƒå†å‘ç”Ÿå˜åŒ–ï¼Œè¯¯å·®å¹³æ–¹å’Œå±€éƒ¨æœ€å°ã€‚<font color='red'>æŸå¤±å‡½æ•°å®šä¹‰ä¸ºå„ä¸ªæ ·æœ¬è·ç¦»æ‰€å±ç°‡ä¸­å¿ƒç‚¹çš„è¯¯å·®å¹³æ–¹å’Œ</font>ï¼š</p></li></ul><p><img src="/GeekFocus/2021-11-15-kmeans/1.png"><br><img src="/GeekFocus/img/2021-11-15-kmeans/1.png"></p><p>xiä»£è¡¨ç¬¬iä¸ªæ ·æœ¬ï¼Œciæ˜¯xiæ‰€å±çš„ç°‡ï¼Œuciä»£è¡¨ç°‡å¯¹åº”ä¸­å¿ƒç‚¹ï¼ŒMæ˜¯æ ·æœ¬æ€»æ•°ã€‚</p><ul><li><p>ï¼ŸæŸå¤±å‡½æ•°æœ¬è´¨æ˜¯è¡¡é‡æ¨¡å‹çš„æ‹Ÿåˆæ•ˆæœï¼Œæœ‰æ±‚è§£å‚æ•°éœ€æ±‚çš„ç®—æ³•ï¼Œæ‰ä¼šæœ‰æŸå¤±å‡½æ•°ã€‚Kmeans ä¸æ±‚è§£ä»€ä¹ˆå‚æ•°ï¼Œå®ƒçš„æ¨¡å‹æœ¬è´¨ä¹Ÿæ²¡æœ‰åœ¨æ‹Ÿåˆæ•°æ®ï¼Œè€Œæ˜¯åœ¨å¯¹æ•°æ®è¿›è¡Œä¸€ ç§æ¢ç´¢ã€‚åœ¨å†³ç­–æ ‘ä¸­æœ‰è¡¡é‡åˆ†ç±»æ•ˆæœçš„æŒ‡æ ‡å‡†ç¡®åº¦<code>accuracy</code>ï¼Œå‡†ç¡®åº¦æ‰€å¯¹åº”çš„æŸå¤±å«åšæ³›åŒ–è¯¯å·®ï¼Œä½†ä¸èƒ½é€šè¿‡æœ€å°åŒ–æ³›åŒ–è¯¯å·®æ¥æ±‚è§£æŸä¸ªæ¨¡å‹ä¸­éœ€è¦çš„ä¿¡æ¯ï¼Œåªæ˜¯å¸Œæœ›æ¨¡å‹çš„æ•ˆæœä¸Šè¡¨ç°å‡ºæ¥çš„æ³›åŒ–è¯¯å·® å¾ˆå°ã€‚å› æ­¤å†³ç­–æ ‘ï¼ŒKNN ç­‰ç®—æ³•ï¼Œæ˜¯ç»å¯¹æ²¡æœ‰æŸå¤±å‡½æ•°çš„ã€‚</p></li><li><table><thead><tr><th>è·ç¦»åº¦é‡å¯¹æ¯”</th><th>è´¨å¿ƒ</th><th>Inertia</th></tr></thead><tbody><tr><td>æ¬§å‡ é‡Œå¾—è·ç¦»</td><td>å‡å€¼</td><td>æœ€å°åŒ–æ¯ä¸ªæ ·æœ¬ç‚¹åˆ°è´¨å¿ƒçš„æ¬§å¼è·ç¦»ä¹‹å’Œ</td></tr><tr><td>æ›¼å“ˆé¡¿è·ç¦»</td><td>ä¸­ä½æ•°</td><td>æœ€å°åŒ–æ¯ä¸ªæ ·æœ¬ç‚¹åˆ°è´¨å¿ƒçš„æ›¼å“ˆé¡¿è·ç¦»ä¹‹å’Œ</td></tr><tr><td>ä½™å¼¦è·ç¦»</td><td>å‡å€¼</td><td>æœ€å°åŒ–æ¯ä¸ªæ ·æœ¬ç‚¹åˆ°è´¨å¿ƒçš„ä½™å¼¦è·ç¦»ä¹‹å’Œ</td></tr></tbody></table></li><li><p>ä¸Šè¿°é—®é¢˜æ˜¯<font color='green'>NP-Hard</font>é—®é¢˜ã€‚ä¸€èˆ¬æ˜¯é‡‡ç”¨åæ ‡ä¸‹é™ï¼ˆCoordinate Decendetï¼‰æ–¹æ³•æ±‚è§£ã€‚åæ ‡ä¸‹é™æ³•å±äºéæ¢¯åº¦ä¼˜åŒ–æ–¹æ³•ï¼Œæ¯ä¸€æ­¥è¿­ä»£ä¸­æ²¿ç€ä¸€ä¸ªåæ ‡è½´æ–¹å‘æ¢ç´¢ï¼Œé€šè¿‡å¾ªç¯ä½¿ç”¨ä¸åŒçš„åæ ‡è¾¾åˆ°æ±‚è§£ç›®æ ‡å‡½æ•°çš„å±€éƒ¨æœ€å°å€¼ã€‚</p></li></ul><p><img src="/GeekFocus/2021-11-15-kmeans/4.png"><br><img src="/GeekFocus/img/2021-11-15-kmeans/4.png"></p><p>å¦‚ä¸Šå›¾ï¼Œå‡è®¾ä¸¤ç»´åº¦xï¼Œyï¼š</p><ol><li>é¦–å…ˆé€‰æ‹©åˆå§‹ä½ç½®(x,y)ï¼Œå‡è®¾xæœªçŸ¥å°†yçš„å€¼ä»£å…¥ç›®æ ‡å‡½æ•°ä¸­ï¼Œä»¤ç›®æ ‡å‡½æ•°å¯¼æ•°0ï¼Œæ±‚å¾—æ­¤æ—¶æœ€ä½³xå€¼ã€‚</li><li>åˆå‡è®¾yæœªçŸ¥å°†åˆšæ±‚å¾—xçš„å€¼ä»£å…¥ç›®æ ‡å‡½æ•°ï¼Œä»¤ç›®æ ‡å‡½æ•°å¯¼æ•°0ï¼Œæ±‚å¾—æ­¤æ—¶æœ€ä½³yã€‚</li><li>é‡å¤æ‰§è¡Œç¬¬1æ­¥ç¬¬2æ­¥ï¼Œç›®æ ‡å‡½æ•°é€æ¸æ¥è¿‘æå°å€¼ç‚¹ï¼Œç›´åˆ°è¾¾åˆ°äº†æå°å€¼ç‚¹åœæ­¢ã€‚</li></ol><p>æ”¶æ•›çš„è¿‡ç¨‹å¦‚çº¢è‰²ç®­å¤´æ‰€ç¤ºã€‚æ›´å¤šç»´åº¦æ—¶ï¼ŒåŒç†ï¼Œä¸€æ¬¡åªå¯¹ä¸€ä¸ªç»´åº¦æœ€ä¼˜åŒ–ã€‚</p><p>åæ ‡ä¸‹é™æ³•ä¸€èˆ¬è¦æ±‚ç›®æ ‡å‡½æ•°æ˜¯å¯å¾®çš„å‡¸å‡½æ•°(å±€éƒ¨æœ€å°å€¼å³å…¨å±€æœ€å°å€¼?)ï¼Œæ­¤æ—¶æ±‚å¾—çš„æå°å€¼æ‰èƒ½æ˜¯å…¨å±€æœ€å°å€¼ã€‚</p><p>ä½¿ç”¨K-Meanså‰ï¼Œå¯å…ˆç”¨PCAä½¿å„ä¸ªå˜é‡é—´å°½å¯èƒ½ç‹¬ç«‹ã€‚å¦åˆ™å¦‚ä¸¤å˜é‡é—´æœ‰è¾ƒå¼ºå…³è”æ€§ï¼Œå‡½æ•°æ”¶æ•›é€Ÿåº¦ä¼šéå¸¸æ…¢ã€‚</p><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><p>KMeansçš„æ ¸å¿ƒç›®æ ‡æ˜¯å°†ç»™å®šçš„æ•°æ®é›†åˆ’åˆ†æˆKä¸ªç°‡ï¼ˆKæ˜¯è¶…å‚ï¼‰ï¼Œå¹¶ç»™å‡ºæ¯ä¸ªæ ·æœ¬æ•°æ®å¯¹åº”çš„ä¸­å¿ƒç‚¹ã€‚å…·ä½“æ­¥éª¤éå¸¸ç®€å•ï¼Œå¯ä»¥åˆ†ä¸º4æ­¥ï¼š</p><p><img src="/GeekFocus/2021-11-15-kmeans/2.png"><br><img src="/GeekFocus/img/2021-11-15-kmeans/2.png"></p><p><strong>KMeansæœ€æ ¸å¿ƒçš„éƒ¨åˆ†å°±æ˜¯å…ˆå›ºå®šä¸­å¿ƒç‚¹ï¼Œè°ƒæ•´æ¯ä¸ªæ ·æœ¬æ‰€å±çš„ç±»åˆ«æ¥å‡å°‘Jï¼›å†å›ºå®šæ¯ä¸ªæ ·æœ¬çš„ç±»åˆ«ï¼Œè°ƒæ•´ä¸­å¿ƒç‚¹ç»§ç»­å‡å°J ã€‚ä¸¤ä¸ªè¿‡ç¨‹äº¤æ›¿å¾ªç¯ï¼Œ J å•è°ƒé€’å‡ç›´åˆ°æœ€ï¼ˆæï¼‰å°å€¼ï¼Œä¸­å¿ƒç‚¹å’Œæ ·æœ¬åˆ’åˆ†çš„ç±»åˆ«åŒæ—¶æ”¶æ•›ã€‚</strong></p><p><img src="/GeekFocus/2021-11-15-kmeans/3.png"><br><img src="/GeekFocus/img/2021-11-15-kmeans/3.png"></p><p><img src="/GeekFocus/2021-11-15-kmeans/5.png"><br><img src="/GeekFocus/img/2021-11-15-kmeans/5.png"></p><h1 id="ä¼˜ç¼ºç‚¹ä¼˜åŒ–ç­–ç•¥"><a href="#ä¼˜ç¼ºç‚¹ä¼˜åŒ–ç­–ç•¥" class="headerlink" title="ä¼˜ç¼ºç‚¹ä¼˜åŒ–ç­–ç•¥"></a>ä¼˜ç¼ºç‚¹ä¼˜åŒ–ç­–ç•¥</h1><p>KMenasä¼˜ç‚¹ï¼š</p><ul><li>é«˜æ•ˆå¯ä¼¸ç¼©ï¼Œè®¡ç®—å¤æ‚åº¦ ä¸º<font color='green'>O(NKt)</font>æ¥è¿‘äºçº¿æ€§ï¼ˆNæ˜¯æ•°æ®é‡ï¼ŒKæ˜¯èšç±»æ€»æ•°ï¼Œtæ˜¯è¿­ä»£è½®æ•°ï¼‰ã€‚</li><li><font color='green'>æ”¶æ•›é€Ÿåº¦å¿«</font>ï¼ŒåŸç†é€šä¿—æ˜“æ‡‚ï¼Œå¯è§£é‡Šæ€§å¼ºã€‚</li></ul><p>KMeansæ˜æ˜¾ç¼ºç‚¹ï¼š</p><ul><li>å—<font color='green'>åˆå§‹å€¼</font>å’Œ<font color='green'>å¼‚å¸¸</font>å½±å“ï¼Œèšç±»ç»“æœå¯èƒ½ä¸æ˜¯å…¨å±€æœ€ä¼˜è€Œæ˜¯<font color='green'>å±€éƒ¨æœ€ä¼˜</font>ã€‚</li><li><font color='green'>K</font>æ˜¯è¶…å‚æ•°ï¼ŒæŒ‰<font color='green'>ç»éªŒé€‰æ‹©</font></li><li><font color='green'>æ ·æœ¬ç‚¹åªèƒ½åˆ’åˆ†åˆ°å•ä¸€çš„ç±»ä¸­</font></li><li>åªèƒ½å‘ç°çƒçŠ¶çš„ç°‡ã€‚</li><li>åˆå§‹å€¼å¯¹ç»“æœå½±å“è¾ƒå¤§ï¼Œå¯èƒ½æ¯æ¬¡èšç±»ç»“æœéƒ½ä¸ä¸€æ ·ã€‚</li></ul><p>æ ¹æ®ä»¥ä¸Šç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸‹é¢å‡ ä¸ªè§’åº¦å¯¹ç®—æ³•åšè°ƒä¼˜</p><ol><li><strong>æ•°æ®é¢„å¤„ç†ï¼šå½’ä¸€åŒ–å’Œå¼‚å¸¸ç‚¹è¿‡æ»¤</strong></li></ol><p><strong>KMeansæœ¬è´¨æ˜¯åŸºäºæ¬§å¼è·ç¦»åº¦é‡çš„æ•°æ®åˆ’åˆ†æ–¹æ³•ï¼Œå‡å€¼å’Œæ–¹å·®å¤§çš„ç»´åº¦å°†å¯¹æ•°æ®èšç±»ç»“æœäº§ç”Ÿå†³å®šæ€§å½±å“ã€‚</strong>èšç±»å‰å¯¹æ•°æ®ï¼ˆ<strong>å…·ä½“çš„è¯´æ˜¯æ¯ä¸€ä¸ªç»´åº¦çš„ç‰¹å¾</strong>ï¼‰åš<font color='green'>å½’ä¸€åŒ–</font>å’Œ<font color='green'>å•ä½ç»Ÿä¸€</font>è‡³å…³é‡è¦ã€‚<font color='green'>å¼‚å¸¸å€¼</font>ä¼šå¯¹å‡å€¼è®¡ç®—äº§ç”Ÿè¾ƒå¤§å½±å“ï¼Œå¯¼è‡´<strong>ä¸­å¿ƒåç§»</strong>ï¼Œ<font color='green'>å™ªå£°ç‚¹æœ€å¥½èƒ½æå‰è¿‡æ»¤</font>ã€‚</p><p><strong>2.åˆç†é€‰æ‹©Kå€¼</strong></p><p>Kå€¼çš„é€‰æ‹©ä¸€èˆ¬åŸºäºå®éªŒå’Œå¤šæ¬¡å®éªŒç»“æœã€‚ä¾‹å¦‚é‡‡ç”¨<strong>æ‰‹è‚˜æ³•</strong>ï¼Œå°è¯•ä¸åŒKå€¼å¹¶å°†å¯¹åº”çš„æŸå¤±å‡½æ•°ç”»æˆæŠ˜çº¿ã€‚æ‰‹è‚˜æ³•è®¤ä¸ºå›¾ä¸Šçš„<strong>æ‹ç‚¹å°±æ˜¯Kçš„æœ€ä½³å€¼</strong>ï¼ˆä¸Šå›¾å¯¹åº”K&#x3D;3ï¼‰ã€‚</p><p><strong>Gap Statisticæ–¹æ³•</strong>ã€‚åªéœ€è¦æ‰¾åˆ°æœ€å¤§çš„Gap Statisticå¯¹åº”çš„K(è‡ªåŠ¨)ã€‚</p><p>æ²¿ç”¨ç¬¬ä¸€èŠ‚ä¸­<font color='green'>æŸå¤±å‡½æ•°</font>è®°ä¸º Dkï¼Œå½“åˆ†ä¸ºKç±»æ—¶ï¼ŒGap Statisticå®šä¹‰ä¸ºï¼š Gap(k)&#x3D;E(logDk)-logDk ã€‚ E(logDk)æ˜¯logDkçš„æœŸæœ›ï¼Œä¸€èˆ¬ç”±<font color='green'>è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿ</font>äº§ç”Ÿã€‚åœ¨<font color='green'>æ ·æœ¬æ‰€åœ¨çš„åŒºåŸŸå†…æŒ‰ç…§å‡åŒ€åˆ†å¸ƒéšæœºåœ°äº§ç”Ÿå’ŒåŸå§‹æ ·æœ¬æ•°ä¸€æ ·å¤šçš„éšæœºæ ·æœ¬</font>ï¼Œå¯¹è¿™ä¸ª<font color='green'>éšæœºæ ·æœ¬åšKMeans</font>ï¼Œå¾—åˆ°ä¸€ä¸ª<font color='green'>Dk</font>ï¼Œ<font color='green'>é‡å¤å¤šæ¬¡</font>è®¡ç®—å‡º E(logDk)çš„è¿‘ä¼¼å€¼ã€‚</p><p><strong>Gap(K) çš„ç‰©ç†å«ä¹‰æ˜¯<font color='green'>éšæœºæ ·æœ¬çš„æŸå¤±ä¸å®é™…æ ·æœ¬çš„æŸå¤±ä¹‹å·®</font>ã€‚Gapè¶Š<font color='green'>å¤§</font>è¯´æ˜èšç±»çš„æ•ˆæœè¶Šå¥½</strong>ã€‚éšç€Kçš„å˜åŒ–Gap(K)å‡ ä¹ç»´æŒä¸€æ¡ç›´çº¿ä¿æŒä¸å˜ã€‚è¯´æ˜è¿™äº›æ ·æœ¬é—´æ²¡æœ‰æ˜æ˜¾çš„ç±»åˆ«å…³ç³»ï¼Œ<font color='green'>æ•°æ®åˆ†å¸ƒå‡ ä¹å’Œå‡åŒ€åˆ†å¸ƒä¸€è‡´</font>ï¼Œè¿‘ä¼¼éšæœºã€‚æ­¤æ—¶èšç±»æ²¡æœ‰æ„ä¹‰ã€‚</p><p><strong>3.æ”¹è¿›åˆå§‹å€¼çš„é€‰æ‹©</strong></p><p>é‡‡å–éšæœºé€‰æ‹©Kä¸ªä¸­å¿ƒï¼Œ<font color='green'>å¯èƒ½å¯¼è‡´ä¸åŒä¸­å¿ƒç‚¹è·ç¦»å¾ˆè¿‘</font>ï¼Œéœ€<font color='green'>æ›´å¤šçš„è¿­ä»£æ¬¡æ•°æ‰èƒ½æ”¶æ•›</font>ã€‚å¦‚åœ¨é€‰æ‹©åˆå§‹ä¸­å¿ƒç‚¹æ—¶<strong>ä¸åŒçš„ä¸­å¿ƒå°½å¯èƒ½è¿œç¦»</strong>ï¼Œæ•ˆæœæ›´å¥½ã€‚è¿™ç±»ç®—æ³•ä¸­ï¼Œä»¥K-Means++ç®—æ³•æœ€å…·å½±å“åŠ›ã€‚</p><p><strong>4.é‡‡ç”¨æ ¸å‡½æ•°?</strong></p><p>ä¸»è¦æ€æƒ³æ˜¯é€šè¿‡ä¸€ä¸ªéçº¿æ€§æ˜ å°„ï¼Œå°†è¾“å…¥ç©ºé—´ä¸­çš„æ•°æ®ç‚¹æ˜ å°„åˆ°é«˜ä½çš„ç‰¹å¾ç©ºé—´ä¸­ï¼Œå¹¶åœ¨æ–°çš„ç©ºé—´è¿›è¡Œèšç±»ã€‚éçº¿æ€§æ˜ å°„å¢åŠ äº†æ•°æ®ç‚¹çº¿æ€§å¯åˆ†çš„æ¦‚ç‡ï¼ˆä¸SVMä¸­ä½¿ç”¨æ ¸å‡½æ•°æ€æƒ³ç±»ä¼¼ï¼‰å¯¹äºéå‡¸çš„æ•°æ®åˆ†å¸ƒå¯ä»¥è¾¾åˆ°æ›´ä¸ºå‡†ç¡®çš„èšç±»ç»“æœã€‚</p><ol start="5"><li>ä»EMç®—æ³•è§£é‡ŠKMeans</li></ol><p>EMï¼ˆExpectation-Maximumï¼‰ç®—æ³•å³æœŸæœ›æœ€å¤§åŒ–ç®—æ³•ï¼Œæ˜¯æœ€å¸¸è§çš„éšå˜é‡ä¼°è®¡æ–¹æ³•ã€‚EMç®—æ³•æ˜¯ä¸€ç§è¿­ä»£ä¼˜åŒ–ç­–ç•¥ï¼Œæ¯ä¸€æ¬¡è¿­ä»£éƒ½åˆ†ä¸ºä¸¤æ­¥ï¼šæœŸæœ›æ­¥ï¼ˆEï¼‰ã€æå¤§æ­¥ï¼ˆMï¼‰ã€‚<strong>EMç®—æ³•çš„æå‡ºæœ€åˆæ˜¯ä¸ºäº†è§£å†³æ•°æ®ç¼ºå¤±æƒ…å†µä¸‹çš„å‚æ•°ä¼°è®¡é—®é¢˜</strong>ï¼ŒåŸºæœ¬æ€æƒ³æ˜¯é¦–å…ˆæ ¹æ®å·²æœ‰çš„è§‚æµ‹æ•°æ®ï¼Œé€šè¿‡æå¤§ä¼¼ç„¶ä¼°è®¡ä¼°è®¡å‡ºæ¨¡å‹çš„å‚æ•°ï¼›å†æ ¹æ®ä¸Šä¸€æ­¥ä¼°è®¡å‡ºçš„å‚æ•°å€¼ä¼°è®¡ç¼ºå¤±æ•°æ®çš„å€¼ï¼›æœ€åæ ¹æ®ä¼°è®¡å‡ºçš„ç¼ºå¤±æ•°æ®å’ŒåŸæœ‰çš„è§‚æµ‹æ•°æ®é‡æ–°å¯¹å‚æ•°å€¼è¿›è¡Œä¼°è®¡ï¼Œåå¤è¿­ä»£ç›´åˆ°æ”¶æ•›ã€‚</p><hr><p>Kå‡å€¼èšç±»æ˜¯ä½¿ç”¨<a href="https://baike.baidu.com/item/%E6%9C%80%E5%A4%A7%E6%9C%9F%E6%9C%9B%E7%AE%97%E6%B3%95/10180861">æœ€å¤§æœŸæœ›ç®—æ³•</a>ï¼ˆExpectation-Maximization algorithmï¼‰æ±‚è§£çš„<a href="https://baike.baidu.com/item/%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B/8878468">é«˜æ–¯æ··åˆæ¨¡å‹</a>ï¼ˆGaussian Mixture Model, GMMï¼‰åœ¨<a href="https://baike.baidu.com/item/%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83/829892">æ­£æ€åˆ†å¸ƒ</a>çš„åæ–¹å·®ä¸ºå•ä½çŸ©é˜µï¼Œä¸”éšå˜é‡çš„åéªŒåˆ†å¸ƒä¸ºä¸€ç»„<a href="https://baike.baidu.com/item/%E7%8B%84%E6%8B%89%E5%85%8B%CE%B4%E5%87%BD%E6%95%B0/5760582">ç‹„æ‹‰å…‹Î´å‡½æ•°</a>æ—¶æ‰€å¾—åˆ°çš„ç‰¹ä¾‹?</p><p>Python</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">KMeansClusterer</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,ndarray,cluster_num</span>):<br>        self.ndarray = ndarray<br>        self.cluster_num = cluster_num<br>        self.points=self.__pick_start_point(ndarray,cluster_num)<br>         <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">cluster</span>(<span class="hljs-params">self</span>):<br>        result = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.cluster_num):<br>            result.append([])<br>        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> self.ndarray:<br>            distance_min = sys.maxsize<br>            index=-<span class="hljs-number">1</span><br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(self.points)):                <br>                distance = self.__distance(item,self.points[i])<br>                <span class="hljs-keyword">if</span> distance &lt; distance_min:<br>                    distance_min = distance<br>                    index = i<br>            result[index] = result[index] + [item.tolist()]<br>        new_center=[]<br>        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> result:<br>            new_center.append(self.__center(item).tolist())<br>        <span class="hljs-comment"># ä¸­å¿ƒç‚¹æœªæ”¹å˜ï¼Œè¯´æ˜è¾¾åˆ°ç¨³æ€ï¼Œç»“æŸé€’å½’</span><br>        <span class="hljs-keyword">if</span> (self.points==new_center).<span class="hljs-built_in">all</span>():<br>            <span class="hljs-keyword">return</span> result<br>         <br>        self.points=np.array(new_center)<br>        <span class="hljs-keyword">return</span> self.cluster()<br>             <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__center</span>(<span class="hljs-params">self,<span class="hljs-built_in">list</span></span>):<br>        <span class="hljs-string">&#x27;&#x27;&#x27;è®¡ç®—ä¸€ç»„åæ ‡çš„ä¸­å¿ƒç‚¹</span><br><span class="hljs-string">        &#x27;&#x27;&#x27;</span><br>        <span class="hljs-comment"># è®¡ç®—æ¯ä¸€åˆ—çš„å¹³å‡å€¼</span><br>        <span class="hljs-keyword">return</span> np.array(<span class="hljs-built_in">list</span>).mean(axis=<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__distance</span>(<span class="hljs-params">self,p1,p2</span>):<br>        <span class="hljs-string">&#x27;&#x27;&#x27;è®¡ç®—ä¸¤ç‚¹é—´è·</span><br><span class="hljs-string">        &#x27;&#x27;&#x27;</span><br>        tmp=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(p1)):<br>            tmp += <span class="hljs-built_in">pow</span>(p1[i]-p2[i],<span class="hljs-number">2</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(tmp,<span class="hljs-number">0.5</span>)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__pick_start_point</span>(<span class="hljs-params">self,ndarray,cluster_num</span>):<br>        <br>        <span class="hljs-keyword">if</span> cluster_num &lt;<span class="hljs-number">0</span> <span class="hljs-keyword">or</span> cluster_num &gt; ndarray.shape[<span class="hljs-number">0</span>]:<br>            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;ç°‡æ•°è®¾ç½®æœ‰è¯¯&quot;</span>)<br>      <br>        <span class="hljs-comment"># éšæœºç‚¹çš„ä¸‹æ ‡</span><br>        indexes=random.sample(np.arange(<span class="hljs-number">0</span>,ndarray.shape[<span class="hljs-number">0</span>],step=<span class="hljs-number">1</span>).tolist(),cluster_num)<br>        points=[]<br>        <span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> indexes:<br>            points.append(ndarray[index].tolist())<br>        <span class="hljs-keyword">return</span> np.array(points)<br></code></pre></td></tr></table></figure><hr><h2 id="KMeans-and-gaussian-mixture-model"><a href="#KMeans-and-gaussian-mixture-model" class="headerlink" title="KMeans and gaussian mixture model"></a>KMeans and gaussian mixture model</h2><p>æ•°æ®è¡¨ç¤ºï¼škmeanså•ä¸ªç‚¹å¯¹clusterå»ºæ¨¡ï¼ˆå‡è®¾å„clusæ•°æ®æ˜¯åœ†å½¢æˆ–é«˜ä½çƒå½¢ï¼‰ã€‚GMMï¼Œä½¿ç”¨é«˜æ–¯åˆ†å¸ƒè¡¨ç¤º</p><p>æ•°æ®å…ˆéªŒï¼škmeansï¼Œå‡è®¾å„cluså…ˆéªŒæ¦‚ç‡ä¸€æ ·ï¼Œå®é™…clusæ•°æ®é‡å¯èƒ½ä¸å‡åŒ€ã€‚clusA10000ï¼ŒB100ï¼Œæ–°æ ·æœ¬ä¸è€ƒè™‘ä¸ABç›¸ä¼¼åº¦ï¼Œå±äºAæ¦‚ç‡å¤§ã€‚GMMå¯¹æ•°æ®å…ˆéªŒè¿›è¡Œå»ºæ¨¡ã€‚</p><p>ç›¸ä¼¼åº¦è¡¡é‡ï¼šKmeansçš„æ¬§å¼è·ç¦»å‡è®¾å„ä¸ªç»´åº¦å¯¹ç›¸ä¼¼åº¦è¡¡é‡ä½œç”¨ä¸€æ ·ã€‚GMMç›¸ä¼¼åº¦è¡¡é‡ä½¿ç”¨åéªŒæ¦‚ç‡é€šè¿‡å¼•å…¥åæ–¹å·®çŸ©é˜µï¼Œå¯¹å„ä¸ªç»´åº¦æ•°æ®çš„ä¸åŒé‡è¦æ€§å»ºæ¨¡ã€‚</p><p>æ•°æ®åˆ†é…ï¼škmeanså„æ ·æœ¬åªå±äºç›¸ä¼¼åº¦æœ€é«˜clusï¼ˆhard clustingï¼‰ï¼ŒGMMä½¿ç”¨åéªŒæ¦‚ç‡å¯¹å„ä¸ªclusæŒ‰æ¯”ä¾‹åˆ†é…ï¼ˆfuzzy clusteringï¼Ÿï¼‰ã€‚</p><hr><h2 id="k-means-èšç±»ç®—æ³•"><a href="#k-means-èšç±»ç®—æ³•" class="headerlink" title="k-means++èšç±»ç®—æ³•"></a>k-means++èšç±»ç®—æ³•</h2><p><code>KMeans</code>ç®—æ³•ï¼Œ<code>KMeans</code>åœ¨èšç±»ä¹‹å‰é¦–å…ˆéœ€åˆå§‹åŒ–kä¸ªç°‡ä¸­å¿ƒï¼Œå› æ­¤ <code>KMeans</code> ç®—æ³•å¯¹åˆå€¼æ•æ„Ÿï¼Œå¯¹äºä¸åŒçš„åˆå§‹å€¼ï¼Œä¼šå¯¼è‡´ä¸åŒèšç±»ç»“æœã€‚è‹¥åˆå§‹åŒ–éšæœºï¼Œå¾ˆæœ‰å¯èƒ½ kç°‡ä¸­å¿ƒéƒ½åœ¨åŒä¸€ä¸ªç°‡ï¼Œè¿™ç§æƒ…å†µ <code>KMeans</code> å¾ˆå¤§ç¨‹åº¦ä¸Šéƒ½ä¸ä¼šæ”¶æ•›åˆ°å…¨å±€æœ€å°ã€‚</p><p>ä¸ºä¼˜åŒ–é€‰æ‹©åˆå§‹è´¨å¿ƒçš„æ–¹æ³•ï¼Œ2007 å¹´ Arthur,ç­‰ ä¸‰äººå‘è¡¨äº†è®ºæ–‡â€œk-means++: <code>The advantages of careful seeding</code>ï¼Œ<code>sklearn.cluster.KMeans</code> ä¸­é»˜è®¤å‚æ•°ä¸º <code>init=&#39;k-means++&#39;</code> ï¼Œå…¶ç®—æ³•åŸç†ä¸ºåœ¨åˆå§‹åŒ–ç°‡ä¸­å¿ƒæ—¶ï¼Œé€ä¸ªé€‰å– kä¸ªç°‡ä¸­å¿ƒï¼Œä¸”ç¦»å…¶ä»–ç°‡ä¸­å¿ƒè¶Šè¿œçš„æ ·æœ¬è¶Šæœ‰å¯èƒ½è¢«é€‰ä¸ºä¸‹ä¸ªç°‡ä¸­å¿ƒã€‚</p><p>ç®—æ³•æ­¥éª¤ï¼š</p><p><img src="/GeekFocus/2021-11-15-kmeans/6.png"><br><img src="/GeekFocus/img/2021-11-15-kmeans/6.png"></p><hr><p>refï¼š</p><p><a href="https://zhuanlan.zhihu.com/p/184686598">https://zhuanlan.zhihu.com/p/184686598</a></p><p><a href="https://www.cnblogs.com/gaochundong/p/kmeans_clustering.html">https://www.cnblogs.com/gaochundong/p/kmeans_clustering.html</a></p><p><a href="https://www.zhihu.com/question/31296149">https://www.zhihu.com/question/31296149</a></p><p><a href="https://zhuanlan.zhihu.com/p/342052190#:~:text=KMeans%20">https://zhuanlan.zhihu.com/p/342052190#:~:text=KMeans%20</a></p>]]></content>
    
    
    <categories>
      
      <category>algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>algorithm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ATAC-seq-4ã€Macs2/3 Installationã€‘</title>
    <link href="/GeekFocus/2021/10/29/2021-10-30-ATAC-seq-4-macs3-install/"/>
    <url>/GeekFocus/2021/10/29/2021-10-30-ATAC-seq-4-macs3-install/</url>
    
    <content type="html"><![CDATA[<h3 id="Macs2-x2F-3-installation-Debug-Record"><a href="#Macs2-x2F-3-installation-Debug-Record" class="headerlink" title="Macs2&#x2F;3 installation Debug Record"></a>Macs2&#x2F;3 installation Debug Record</h3><span id="more"></span><p>macs2 installation record<br>install conda<br>creat work environment<br>install numpy1.17<br>python setup.py install â€“prefix â€¦.&#x2F;software&#x2F;MACS</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs clean">####################################ERROR1#############################################<br>#MACS3/fermi-lite/ksw.c:<span class="hljs-number">31</span>:<span class="hljs-number">26</span>: fatal error: lib/x86/sse2.h: No such file or directory<br># #include <span class="hljs-string">&quot;lib/x86/sse2.h&quot;</span>                      ^<br>#compilation terminated.<br>#error: command <span class="hljs-string">&#x27;gcc&#x27;</span> failed <span class="hljs-keyword">with</span> exit status <span class="hljs-number">1</span><br>######################################################################################<br></code></pre></td></tr></table></figure><p><a href="https://github.com/macs3-project/MACS/issues/473">https://github.com/macs3-project/MACS/issues/473</a><br>zip downloaded from github zip is not complete in the deep dir<br>git clone <a href="https://github.com/macs3-project/MACS.git">https://github.com/macs3-project/MACS.git</a> â€“recursive<br>or download absent files</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs clean">####################################ERROR2#############################################<br>Checking .pth file support <span class="hljs-keyword">in</span> ..../software/MACS2/lib/python3<span class="hljs-number">.8</span>/site-packages/<br>..../.conda/envs/atacseq/bin/python -E -c pass<br>TEST FAILED: ..../software/MACS2/lib/python3<span class="hljs-number">.8</span>/site-packages/ does NOT support .pth files<br>bad install directory or PYTHONPATH<br><br>You are attempting to install a package to a directory that is not<br>on PYTHONPATH and which Python does not read <span class="hljs-string">&quot;.pth&quot;</span> files <span class="hljs-keyword">from</span>.  The<br>installation directory you specified (via --install-dir, --prefix, or<br>the distutils default setting) was:<br><br>    ..../software/MACS2/lib/python3<span class="hljs-number">.8</span>/site-packages/<br><br>and your PYTHONPATH environment variable currently contains:<br><br>    <span class="hljs-string">&#x27;&#x27;</span><br><br>Here are some <span class="hljs-keyword">of</span> your options for correcting the problem:<br><br>* You can choose a different installation directory, i.e., one that is<br>  on PYTHONPATH or supports .pth files<br><br>* You can add the installation directory to the PYTHONPATH environment<br>  variable.  (It must then also be on PYTHONPATH whenever you run<br>  Python and want to use the package(s) you are installing.)<br><br>* You can set up the installation directory to support <span class="hljs-string">&quot;.pth&quot;</span> files by<br>  using one <span class="hljs-keyword">of</span> the approaches described here:<br><br>  https:<span class="hljs-comment">//setuptools.readthedocs.io/en/latest/deprecated/easy_install.html#custom-installation-locations</span><br></code></pre></td></tr></table></figure><p>[ok]export PYTHONPATH&#x3D;${PYTHONPATH}:â€¦.&#x2F;software&#x2F;MACS2&#x2F;lib&#x2F;python3.9&#x2F;site-packages&#x2F;</p><p>directly set PYTHONPATH&#x3D;â€¦.&#x2F;software&#x2F;MACS2&#x2F;lib&#x2F;python3.9&#x2F;site-packages&#x2F; in ~&#x2F;.bashrc was failed.</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs clean">####################################ERROR3#############################################<br>error: package directory <span class="hljs-string">&#x27;MACS2&#x27;</span> does not exist<br>#######################################################################################<br></code></pre></td></tr></table></figure><p>zip Dir was not complete, tried .tar.gz </p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs clean">####################################ERROR4#############################################<br>Traceback (most recent call last):<br>  File <span class="hljs-string">&quot;..../software/MACS3/bin/macs3&quot;</span>, line <span class="hljs-number">4</span>, <span class="hljs-keyword">in</span> &lt;<span class="hljs-keyword">module</span>&gt;<br>    __import__(<span class="hljs-string">&#x27;pkg_resources&#x27;</span>).run_script(<span class="hljs-string">&#x27;MACS3==3.0.0a6&#x27;</span>, <span class="hljs-string">&#x27;macs3&#x27;</span>)<br>  File <span class="hljs-string">&quot;..../miniconda3/lib/python3.9/site-packages/pkg_resources/__init__.py&quot;</span>, line <span class="hljs-number">3243</span>, <span class="hljs-keyword">in</span> &lt;<span class="hljs-keyword">module</span>&gt;<br>    def _initialize_master_working_set():<br>  File <span class="hljs-string">&quot;..../miniconda3/lib/python3.9/site-packages/pkg_resources/__init__.py&quot;</span>, line <span class="hljs-number">3226</span>, <span class="hljs-keyword">in</span> _call_aside<br>    f(*args, **kwargs)<br>  File <span class="hljs-string">&quot;..../miniconda3/lib/python3.9/site-packages/pkg_resources/__init__.py&quot;</span>, line <span class="hljs-number">3255</span>, <span class="hljs-keyword">in</span> _initialize_master_working_set<br>    working_set = WorkingSet._build_master()<br>  File <span class="hljs-string">&quot;..../miniconda3/lib/python3.9/site-packages/pkg_resources/__init__.py&quot;</span>, line <span class="hljs-number">568</span>, <span class="hljs-keyword">in</span> _build_master<br>    ws.require(__requires__)<br>  File <span class="hljs-string">&quot;..../miniconda3/lib/python3.9/site-packages/pkg_resources/__init__.py&quot;</span>, line <span class="hljs-number">886</span>, <span class="hljs-keyword">in</span> require<br>    needed = self.resolve(parse_requirements(requirements))<br>  File <span class="hljs-string">&quot;..../miniconda3/lib/python3.9/site-packages/pkg_resources/__init__.py&quot;</span>, line <span class="hljs-number">772</span>, <span class="hljs-keyword">in</span> resolve<br>    raise DistributionNotFound(req, requirers)<br>pkg_resources.DistributionNotFound: The <span class="hljs-string">&#x27;Cython&gt;=0.29&#x27;</span> distribution was not found and is required by MACS3``<br></code></pre></td></tr></table></figure><p><code>conda install Cython=0.29</code></p><p><a href="https://pypi.org/project/cykhash/">https://pypi.org/project/cykhash/</a><br><code>pip install cykhash</code><br>Collecting cykhash<br>  Using cached cykhash-1.0.2-cp39-cp39-linux_x86_64.whl<br>Installing collected packages: cykhash<br>Successfully installed cykhash-1.0.2</p><p>python setup.py install â€“prefix â€¦.&#x2F;software&#x2F;MACS2</p><p>success</p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>debug</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ATAC-seq-5ã€PeakCalling-MACS2ã€‘</title>
    <link href="/GeekFocus/2021/10/29/2021-10-30-ATAC-seq-5-macs2-info/"/>
    <url>/GeekFocus/2021/10/29/2021-10-30-ATAC-seq-5-macs2-info/</url>
    
    <content type="html"><![CDATA[<h2 id="MACS2-detail"><a href="#MACS2-detail" class="headerlink" title="MACS2 detail"></a>MACS2 detail</h2><span id="more"></span><h3 id="ç²—ç•¥ä»‹ç»MACSåŸºæœ¬åŸç†ã€‚"><a href="#ç²—ç•¥ä»‹ç»MACSåŸºæœ¬åŸç†ã€‚" class="headerlink" title="ç²—ç•¥ä»‹ç»MACSåŸºæœ¬åŸç†ã€‚"></a>ç²—ç•¥ä»‹ç»MACSåŸºæœ¬åŸç†ã€‚</h3><p>TFåœ¨åŸºå› ç»„ä¸Šçš„ç»“åˆæ˜¯éšæœºè¿‡ç¨‹ï¼ŒåŸºå› ç»„çš„æ¯ä¸ªä½ç½®éƒ½æœ‰æœºä¼šç»“åˆæŸä¸ªTFï¼Œåªæ˜¯æ¦‚ç‡ä¸ä¸€æ ·ï¼Œpeakå‡ºç°çš„ä½ç½®ï¼Œæ˜¯TFç»“åˆçƒ­ç‚¹ï¼Œè€Œpeak-callingå°±ä¸ºäº†æ‰¾è¿™äº›çƒ­ç‚¹ã€‚</p><p>å¦‚ä½•å®šä¹‰çƒ­ç‚¹ï¼Ÿé€šä¿—è®²ï¼Œçƒ­ç‚¹æ˜¯è¿™æ ·ä¸€äº›ä½ç½®ï¼Œè¿™äº›ä½ç½®å¤šæ¬¡è¢«æµ‹å¾—çš„readæ‰€è¦†ç›–ï¼ˆæˆ‘ä»¬æµ‹çš„æ˜¯ä¸€ä¸ªç»†èƒç¾¤ä½“ï¼Œreadå‡ºç°æ¬¡æ•°å¤šï¼Œè¯´æ˜è¯¥ä½ç½®è¢«TFç»“åˆçš„å‡ ç‡å¤§ï¼‰ã€‚readæ•°è¾¾åˆ°å¤šå°‘æ‰å«å¤šï¼Ÿå°±è¦ç”¨åˆ°ç»Ÿè®¡æ£€éªŒã€‚å‡è®¾TFåœ¨åŸºå› ç»„ä¸Šçš„åˆ†å¸ƒæ²¡æœ‰ä»»ä½•è§„å¾‹ï¼Œé‚£ä¹ˆæµ‹åºå¾—åˆ°çš„readåœ¨åŸºå› ç»„ä¸Šçš„åˆ†å¸ƒä¹Ÿå¿…ç„¶æ˜¯éšæœºçš„ï¼ŒæŸä¸ªç¢±åŸºä¸Šè¦†ç›–çš„readçš„æ•°ç›®åº”æœä»äºŒé¡¹åˆ†å¸ƒã€‚å’ŒæŠ½å°çƒçš„è¿‡ç¨‹ç±»ä¼¼ã€‚å½“nå¾ˆå¤§ï¼Œpå¾ˆå°æ—¶ï¼ŒäºŒé¡¹åˆ†å¸ƒè¿‘ä¼¼ç”¨æ³Šæ¾åˆ†å¸ƒæ›¿ä»£ï¼Œåœ¨è¿™é‡Œï¼š<br><img src="/GeekFocus/img/2021-10-30-ATAC-seq-5-macs2-info/1.png" alt="formula"></p><p><img src="/GeekFocus/2021-10-30-ATAC-seq-5-macs2-info/2-4666628.png" alt="formula"></p><p>æ‹‰å§†è¾¾æ˜¯æ³Šæ¾åˆ†å¸ƒå”¯ä¸€å‚æ•°ï¼Œnæ˜¯æµ‹åºreadæ€»æ•°ç›®ï¼Œlæ˜¯å•ä¸ªreadé•¿åº¦ï¼Œsæ˜¯åŸºå› ç»„å¤§å°ã€‚æœ‰äº†åˆ†å¸ƒï¼Œå¯ä»¥ç®—å‡ºåœ¨æŸä¸ªç½®ä¿¡æ¦‚ç‡ï¼ˆå¦‚0.00001ï¼‰ä¸‹ï¼Œéšæœºæƒ…å†µä¸‹ï¼ŒæŸä¸ªç¢±åŸºä¸Šå¯ä»¥è¦†ç›–çš„readæ•°ç›®çš„æœ€å°å€¼ï¼Œå½“å®é™…è§‚å¯Ÿåˆ°çš„readæ•°ç›®è¶…è¿‡è¿™ä¸ªå€¼ï¼ˆå•ä¾§æ£€éªŒï¼‰æ—¶ï¼Œè®¤ä¸ºè¯¥ç¢±åŸºæ˜¯TFçš„ä¸€ä¸ªç»“åˆçƒ­ç‚¹ã€‚åè¿‡æ¥ï¼Œé’ˆå¯¹æ¯ä¸€ä¸ªreadæ•°ç›®ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç®—å‡ºå¯¹åº”çš„ç½®ä¿¡æ¦‚ç‡Pã€‚</p><p>ä½†è¿™åªæ˜¯ç®€åŒ–æ¨¡å‹ï¼Œå®é™…æƒ…å†µå¤æ‚å¥½å¤šã€‚ç”±äºæµ‹åºã€mappingè¿‡ç¨‹å†…åœ¨<font color=red>åå¥½æ€§</font>ï¼Œä»¥åŠä¸åŒæŸ“è‰²è´¨é—´çš„å·®å¼‚æ€§ï¼Œç›¸æ¯”å…¨åŸºå› ç»„ï¼ŒæŸäº›ç¢±åŸºå¯èƒ½å†…åœ¨åœ°ä¼šè¢«æ›´å¤šçš„readæ‰€è¦†ç›–ï¼Œè¿™ç§æƒ…å†µå¾—åˆ°çš„å¾ˆå¤špeakå¯èƒ½éƒ½æ˜¯å‡çš„ã€‚MACSè€ƒè™‘åˆ°è¿™ç‚¹ï¼Œ<font color=red>å½“å¯¹æŸä¸ªç¢±åŸºè¿›è¡Œå‡è®¾æ£€éªŒï¼ŒMACSåªè€ƒè™‘è¯¥ç¢±åŸºé™„è¿‘æŸ“è‰²è´¨åŒºæ®µï¼ˆå¦‚10kï¼‰ï¼Œæ­¤æ—¶ä¸Šè¿°å…¬å¼ä¸­nè¡¨ç¤ºé™„è¿‘10kåŒºé—´å†…çš„readæ•°ç›®ï¼Œsè¢«ç½®ä¸º10k</font>ã€‚å½“æœ‰å¯¹ç…§ç»„ï¼ˆControlï¼Œç›¸æ¯”å®éªŒç»„æ²¡æœ‰ç”¨æŠ—ä½“æ•è·TFæˆ–ç”¨äº†ä¸€ä¸ªé€šç”¨æŠ—ä½“ï¼‰å­˜åœ¨ï¼Œåˆ©ç”¨Controlç»„çš„æ•°æ®æ„å»ºæ³Šæ¾åˆ†å¸ƒï¼Œ<font color=red>æ²¡æœ‰Controlæ—¶ï¼Œåˆ©ç”¨å®éªŒç»„ï¼Œç¨å¤§ä¸€ç‚¹çš„å±€éƒ¨åŒºé—´ï¼ˆæ¯”å¦‚50kï¼‰</font>çš„æ•°æ®æ„å»ºæ³Šæ¾åˆ†å¸ƒã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œreadåªæ˜¯è·Ÿéšç€TFä¸€èµ·æ²‰æ·€ä¸‹æ¥çš„DNA fragmentçš„æœ«ç«¯ï¼Œreadçš„ä½ç½®å¹¶ä¸æ˜¯çœŸå®çš„TFç»“åˆä½ç½®ã€‚æ‰€ä»¥åœ¨peak-callingä¹‹å‰ï¼Œå»¶ä¼¸readæ˜¯å¿…é¡»çš„ã€‚ä¸åŒTFå¤§å°ä¸ä¸€æ ·ï¼Œå¯¹readå»¶ä¼¸çš„é•¿åº¦ä¹Ÿç†åº”ä¸åŒ.æµ‹å¾—çš„<font color=red>readæœ€ç»ˆå…¶å®ä¼šè¿‘ä¼¼åœ°å¹³å‡åˆ†é…åˆ°æ­£è´Ÿé“¾</font>ï¼Œå¯¹äºä¸€ä¸ªTFç»“åˆçƒ­ç‚¹ï¼Œreadåœ¨é™„è¿‘æ­£è´Ÿé“¾ä¸Šä¼šè¿‘ä¼¼åœ°å½¢æˆ<font color=red>â€œåŒå³°â€</font>ã€‚MACSä¼šä»¥<font color=red>æŸä¸ªwindow sizeæ‰«æåŸºå› ç»„ï¼Œç»Ÿè®¡æ¯ä¸ªwindowé‡Œé¢readçš„å¯Œé›†ç¨‹åº¦ï¼Œç„¶åæŠ½å–ï¼ˆæ¯”å¦‚1000ä¸ªï¼‰åˆé€‚çš„ï¼ˆreadå¯Œé›†ç¨‹åº¦é€‚ä¸­ï¼Œè¿‡å°‘ï¼Œæ— æ³•å»ºç«‹æ¨¡å‹ï¼Œè¿‡å¤§ï¼Œå¯èƒ½åæ˜ çš„åªæ˜¯æŸç§åå¥½æ€§ï¼‰windowä½œæ ·æœ¬ï¼Œå»ºç«‹â€œåŒå³°æ¨¡å‹â€</font>ã€‚æœ€åï¼Œä¸¤ä¸ªå³°ä¹‹é—´çš„è·ç¦»å°±è¢«è®¤ä¸ºæ˜¯<font color=red>TFçš„é•¿åº¦Dï¼Œæ¯ä¸ªreadå°†å»¶ä¼¸D&#x2F;2</font>ã€‚è§ä¸‹å›¾ï¼š</p><p><img src="/GeekFocus/img/2021-10-30-ATAC-seq-5-macs2-info/2.png" alt="formula"></p><p><img src="/GeekFocus/2021-10-30-ATAC-seq-5-macs2-info/2-4666536.png" alt="formula"></p><p>å½“æœ‰å¯¹ç…§ç»„ï¼ŒMACSä¼šè¿›è¡Œä¸¤æ¬¡peak callingã€‚ç¬¬ä¸€æ¬¡ä»¥å®éªŒç»„ï¼ˆTreatmentï¼‰ä¸ºå®éªŒç»„ï¼Œå¯¹ç…§ç»„ä¸ºå¯¹ç…§ç»„ï¼Œç¬¬äºŒæ¬¡é¢ å€’ï¼Œä»¥å®éªŒç»„ä¸ºå¯¹ç…§ç»„ï¼Œå¯¹ç…§ç»„ä¸ºå®éªŒç»„ã€‚ä¹‹åï¼ŒMACSå¯¹æ¯ä¸€ä¸ªPè®¡ç®—äº†ç›¸åº”çš„FDRï¼ˆFalse Discovery Rateï¼‰å€¼ï¼š</p><p><img src="/GeekFocus/2021-10-30-ATAC-seq-5-macs2-info/3.png"><br><img src="/GeekFocus/img/2021-10-30-ATAC-seq-5-macs2-info/3.png"></p><p>è¡¨ç¤ºç¬¬äºŒæ¬¡peak callingï¼ˆé¢ å€’çš„ï¼‰å¾—åˆ°çš„ç½®ä¿¡æ¦‚ç‡å°äºPçš„peakçš„ä¸ªæ•°ã€‚è¡¨ç¤ºç¬¬ä¸€æ¬¡peak callingå¾—åˆ°çš„ç½®ä¿¡æ¦‚ç‡å°äºPçš„peakçš„ä¸ªæ•°ã€‚FDRç»¼åˆåˆ©ç”¨äº†å®éªŒç»„å’Œå¯¹ç…§ç»„çš„ä¿¡æ¯ï¼Œæ˜¾ç„¶ï¼ŒFDRè¶Šå°è¶Šå¥½ã€‚</p><h3 id="MACS-peak-calling-pipelineï¼š"><a href="#MACS-peak-calling-pipelineï¼š" class="headerlink" title="MACS peak-calling pipelineï¼š"></a>MACS peak-calling pipelineï¼š</h3><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚å¯¹ç»„è›‹ç™½ä¿®é¥°çš„ChIP-seqæ•°æ®peak-callingæ—¶ï¼Œâ€œåŒå³°æ¨¡å‹â€ä¼šå»ºç«‹å¤±è´¥ï¼Œ<font color=red>å› ä¸ºç»„è›‹ç™½ä¿®é¥°å¾€å¾€å¹¶ä¸æ˜¯å­¤ç«‹å­˜åœ¨çš„ï¼Œå¯èƒ½å¾ˆé•¿ä¸€æ®µæŸ“è‰²è´¨åŒºé—´éƒ½è¢«åŒä¸€ä¸ªç»„è›‹ç™½ä¿®é¥°å æ®ï¼Œç»„è›‹ç™½ä¿®é¥°çš„peakå¹¶ä¸å…¸å‹ã€‚</font>è¿™æ—¶ï¼Œåªè¦å¤šåŠ ä¸€ä¸ªå‚æ•°ï¼š</p><p><font color=red>â€“nomodel â€“shiftsize&#x3D;number</font></p><p>â€“nomodelå°†<font color=red>ç•¥è¿‡â€œåŒå³°æ¨¡å‹â€å»ºç«‹çš„è¿‡ç¨‹</font>ï¼Œè€Œ<font color=red>â€“shiftsizeå°†äººä¸ºæŒ‡å®šreadså»¶ä¼¸çš„é•¿åº¦</font>ã€‚<font color=red>ä¸€ä¸ªæ ¸å°ä½“ä¸Šå¤§æ¦‚ç¼ ç»•ç€147bpDNA</font>ï¼Œåœ¨å¯¹ç»„è›‹ç™½ä¿®é¥°åšpeak-callingæ—¶å¯ä»¥æŒ‡å®šï¼š</p><p><font color=red>â€“nomodel â€“shiftsize&#x3D;73</font></p><p>CTCF_peaks.bedè¯¦ç»†åˆ—å‡ºäº†æ¯ä¸€ä¸ªpeakçš„ä½ç½®ä¿¡æ¯å’Œå¯ä¿¡åº¦ï¼ˆæœ€åä¸€åˆ—ï¼š)ï¼ŒBEDæ–‡ä»¶æ ¼å¼è¯¦è§ï¼š<a href="http://genome.ucsc.edu/FAQ/FAQformat.html#format1">http://genome.ucsc.edu/FAQ/FAQformat.html#format1</a></p><p>å…¶ä»–å¸¸ç”¨å‚æ•°ï¼š-bw number å»ºç«‹â€œåŒå³°æ¨¡å‹â€è¿‡ç¨‹ä¸­window sizeçš„ä¸€åŠï¼Œé»˜è®¤300bp.<br><font color=red>-p Pvalue</font>è®¾å®špeakç½®ä¿¡æ¦‚ç‡çš„ä¸´ç•Œå€¼ï¼ˆthresholdï¼‰ï¼Œé»˜è®¤0.00001?(macs2 callpeak -h: pvalue not set, dont use p and q value at the same time)ï¼Œå¯¹äºH3k36me3ã€H3k27me3ã€H3k9me3ç­‰å…·æœ‰â€œéå¸¸è§„â€ç‰¹å¾çš„peakï¼ˆbroad peakï¼‰è€Œè¨€ï¼Œæ­¤å‚æ•°å¯ä»¥ç¨å¾®è®¾å¤§ä¸€ç‚¹ï¼Œæ¯”å¦‚0.001ã€‚</p><p>-m number1,number2 å»ºç«‹â€œåŒå³°æ¨¡å‹â€ç”¨åˆ°ï¼Œè®¾å®šæŒ‘é€‰çš„windowä¸Šreadsçš„å¯Œé›†ç¨‹åº¦ï¼ˆ<font color=red>fold enrichment</font>ï¼Œç›¸å¯¹å…¨åŸºå› ç»„è€Œè¨€ï¼‰ï¼Œé»˜è®¤10,30ã€‚</p><p>-slocal&#x3D;number -llocal&#x3D;number å…±åŒç¡®å®šMACSåŠ¨æ€è®¡ç®—æ—¶æ‰€è€ƒå¯Ÿçš„å±€éƒ¨åŒºé—´çš„é•¿åº¦ã€‚é»˜è®¤å‚æ•°ï¼Œ-slocal&#x3D;1000 -llocal&#x3D;10000ã€‚é™¤äº†å»ºç«‹â€œåŒå³°æ¨¡å‹â€ï¼Œåœ¨å¯»æ‰¾peakè¿‡ç¨‹ä¸­ï¼ŒMACSä¾ç„¶ä¼šä»¥2å€äº-bwçš„windowæ‰«æåŸºå› ç»„ï¼Œå¯¹äºå½“å‰windowè€Œè¨€ï¼ˆ-slocal,-llocalå–é»˜è®¤å‚æ•°ï¼‰ï¼š</p><p>-w&#x2F;-B å»ºç«‹wigæˆ–BEDæ ¼å¼çš„raw signalï¼ˆæœ€é«˜ç²¾ç¡®åˆ°æ¯ä¸ªç¢±åŸºä¸Šreadsçš„è¦†ç›–æƒ…å†µï¼‰æ–‡ä»¶ï¼Œé»˜è®¤æ¯æ¡æŸ“è‰²ä½“å»ºä¸€ä¸ªã€‚</p><p>-S åªå»ºç«‹ä¸€ä¸ªraw signalæ–‡ä»¶ã€‚</p><p>-space ä¸-wæ­é…ä½¿ç”¨ï¼Œç¡®å®šwigæ–‡ä»¶çš„åˆ†è¾¨ç‡ï¼Œé»˜è®¤10bpã€‚</p><hr><p>linkï¼š<a href="https://www.plob.org/article/7227.html">https://www.plob.org/article/7227.html</a></p><hr><p><a href="https://github.com/macs3-project/MACS/blob/master/docs/callpeak.md">https://github.com/macs3-project/MACS/blob/master/docs/callpeak.md</a></p><p>Pay attention to BAMPE(pair end) and BED(shift extend) mode</p><h1 id="f-x2F-format-FORMAT"><a href="#f-x2F-format-FORMAT" class="headerlink" title="-f&#x2F;--format FORMAT"></a><code>-f</code>&#x2F;<code>--format FORMAT</code></h1><p>Format of tag file can be <code>ELAND</code>, <code>BED</code>, <code>ELANDMULTI</code>, <code>ELANDEXPORT</code>, <code>SAM</code>, <code>BAM</code>, <code>BOWTIE</code>, <code>BAMPE</code>, or <code>BEDPE</code>. Default is <code>AUTO</code> which will allow MACS to decide the format automatically. <code>AUTO</code> is also useful when you combine different formats of files. Note that MACS <font color="red"><strong>canâ€™t detect</strong></font> <code>BAMPE</code> or <code>BEDPE</code> format with <code>AUTO</code>, and you have to implicitly specify the format for <code>BAMPE</code> and <code>BEDPE</code>.</p><p>Nowadays, the most common formats are <code>BED</code> or <code>BAM</code> (including <code>BEDPE</code> and <code>BAMPE</code>). Our recommendation is to convert your data to<code>BED</code> or <code>BAM</code> first.</p><p>Also, MACS3 can detect and read gzipped file. For example, <code>.bed.gz</code> file can be directly used without being uncompressed with <code>--format BED</code>.</p><h1 id="BAM-SAM-not-use"><a href="#BAM-SAM-not-use" class="headerlink" title="BAM/SAM(not use)"></a>BAM<code>/</code>SAM(not use)</h1><p>If the format is <code>BAM</code>&#x2F;<code>SAM</code>, please check the definition in (<a href="http://samtools.sourceforge.net/samtools.shtml">http://samtools.sourceforge.net/samtools.shtml</a>). If the <code>BAM</code> file is generated for paired-end data, MACS will <font color="red"><strong>only keep the left mate</strong></font>(5â€™ end) tag. However, when format <code>BAMPE</code> is specified, MACS will use the <font color="red"><strong>real fragments[BAMPE]</strong></font> inferred from alignment results for reads pileup.</p><h1 id="BAMPE-pair-end"><a href="#BAMPE-pair-end" class="headerlink" title="BAMPE(pair end)"></a>BAMPE(pair end)</h1><p>A <font color="red"><strong>special mode</strong> will be triggered</font> while the format is specified as <code>BAMPE</code> or <code>BEDPE</code>. In this way, MACS3 will process the <code>BAM</code> or <code>BED</code> files as paired-end data. Instead of building a bimodal distribution of plus and minus strand reads to predict fragment size, MACS3 will <font color="red">use <strong>actual insert sizes of pairs of reads</strong></font> to build fragment pileup.</p><p>The <code>BAMPE</code> format is just a <code>BAM</code> format containing paired-end alignment information, such as those from <code>BWA</code> or <code>BOWTIE</code>.</p><p>The <code>BEDPE</code> format is a simplified and more flexible <code>BED</code> format, which <font color="red">only contains the first three columns(then, how to get pair info??)</font> defining the chromosome name, left and right position of the fragment from Paired-end sequencing. Please note, this is NOT the same format used by <code>BEDTOOLS</code>, and the <code>BEDTOOLS</code> version of <code>BEDPE</code> is actually not in a standard <code>BED</code> format. You can use MACS3 subcommand <code>randsample</code> to convert a <code>BAM</code> file containing paired-end information to a <code>BEDPE</code> format file:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">macs3 randsample -<span class="hljs-selector-tag">i</span> the_BAMPE_file<span class="hljs-selector-class">.bam</span> -f BAMPE -<span class="hljs-selector-tag">p</span> <span class="hljs-number">100</span> -o the_BEDPE_file.bed<br></code></pre></td></tr></table></figure><h1 id="BED-shift-extend-mode"><a href="#BED-shift-extend-mode" class="headerlink" title="BED(shift extend) mode"></a>BED(shift extend) mode</h1><p>The BED format can be found at <a href="http://genome.ucsc.edu/FAQ/FAQformat#format1">UCSC genome browser website</a>.</p><p>The essential columns in BED format input are the 1st column <code>chromosome name</code>, the 2nd <code>start position</code>, the 3rd <code>end position</code>, and the<font color="red"> <strong>6th, strand</strong></font>.(<font color="red"><strong>usage for extending to 5â€™</strong>) keep the <strong>Tn5 break point in the middle of the peak</strong></font></p><p>Note that, for <code>BED</code> format, the <font color="red"><strong>6th</strong></font> column of strand information is required by MACS. And please pay attention that the coordinates in BED format are zero-based and half-open. See more detail at <a href="http://genome.ucsc.edu/FAQ/FAQtracks#tracks1">UCSC site</a>.</p><h1 id="slocal-llocal"><a href="#slocal-llocal" class="headerlink" title="--slocal, --llocal"></a><code>--slocal</code>, <code>--llocal</code></h1><p>These two parameters control which two levels of regions will be checked around the peak regions to calculate the maximum lambda as local lambda. <font color="red"><strong>By default</strong></font>, MACS considers <strong>1000bp</strong> for small local region(<code>--slocal</code>), and <strong>10000bps</strong> for large local region(<code>--llocal</code>) which captures the bias from a long-range effect like an open chromatin domain. You can tweak these according to your project. Remember that if the region is set too small, a sharp spike in the input data may kill a significant peak.</p><h1 id="nomodel"><a href="#nomodel" class="headerlink" title="--nomodel"></a><code>--nomodel</code></h1><p>While on, MACS will bypass building the shifting model.</p><h1 id="extsize"><a href="#extsize" class="headerlink" title="--extsize"></a><code>--extsize</code></h1><p>While <code>--nomodel</code> is set, MACS uses this parameter to extend reads in 5â€™-&gt;3â€™ direction to fix-sized fragments. For example, if the size of the binding region for your transcription factor is 200 bp, and you want to bypass the model building by MACS, this parameter can be set as 200. This option is only valid when <code>--nomodel</code> is set or when MACS fails to build model and <code>--fix-bimodal</code> is on.</p><h3 id="shift"><a href="#shift" class="headerlink" title="--shift"></a><code>--shift</code></h3><p>Note, this is NOT the legacy <code>--shiftsize</code> option which is replaced by <code>--extsize</code>! You can set an arbitrary shift in bp here. Please Use discretion while setting it other than the default value (0). When <code>--nomodel</code> is set, MACS will use this value to move cutting ends (5â€™) then apply <code>--extsize</code> from 5â€™ to 3â€™ direction to extend them to fragments. <font color="red">When this value is <strong>negative</strong>, ends will be moved toward 3â€™-&gt;5â€™ direction</font>, otherwise 5â€™-&gt;3â€™ direction. <font color="red"><strong>Recommended</strong> to keep it as <strong>default 0 for ChIP-Seq</strong> datasets</font>, or -1 * half of <em>EXTSIZE</em> together with <code>--extsize</code> option for detecting enriched cutting loci such as certain DNAseI-Seq datasets. Note, you canâ€™t set values other than 0 if the format is <strong>BAMPE or BEDPE</strong>(<strong>nouse in setting nomodel</strong>) for paired-end data. The default is 0.</p><p>Here are some examples for combining <code>--shift</code> and <code>--extsize</code>:</p><ol><li>To find enriched cutting sites such as some DNAse-Seq datasets. In this case, all 5â€™ ends of sequenced reads should be extended in both directions to smooth the pileup signals. If the wanted smoothing window is 200bps, then use <code>--nomodel --shift -100 --extsize 200</code>.</li><li>For certain nucleosome-seq data, we need to pile up the centers of nucleosomes using a half-nucleosome size for wavelet analysis (e.g. NPS algorithm). Since the DNA wrapped on nucleosome is about 147bps, this option can be used: <code>--nomodel --shift 37 --extsize 73</code>.</li></ol><h3 id="keep-dup"><a href="#keep-dup" class="headerlink" title="--keep-dup"></a><code>--keep-dup</code></h3><p>It controls the MACS behavior towards duplicate tags at the exact same location â€“ the same coordination and the same strand. The default<code>auto</code> option makes MACS calculate the maximum tags at the exact same location based on binomial distribution using 1e-5 as p-value cutoff; and the <code>all</code> option keeps every tag. If an integer is given, at most this number of tags will be kept at the same location. The default is to keep one tag at the same location. Default: 1</p><h3 id="broad"><a href="#broad" class="headerlink" title="--broad"></a><code>--broad</code></h3><p>When this flag is on, MACS will try to composite broad regions in BED12 ( a gene-model-like format ) by putting nearby highly enriched regions into a broad region with loose cutoff. The broad region is controlled by another cutoff through <code>--broad-cutoff</code>. Please note that, the <code>max-gap</code> value for merging nearby weaker&#x2F;broad peaks is 4 times of <code>max-gap</code> for merging nearby stronger peaks. The later one can be controlled by <code>--max-gap</code> option, and by default it is the average fragment&#x2F;insertion length in the PE data. DEFAULT: False</p><h3 id="broad-cutoff"><a href="#broad-cutoff" class="headerlink" title="--broad-cutoff"></a><code>--broad-cutoff</code></h3><p>Cutoff for the broad region. This option is not available unless <code>--broad</code> is set. If <code>-p</code> is set, this is a p-value cutoff, otherwise, itâ€™s a q-value cutoff. DEFAULT: 0.1</p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>atac-seq</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ATAC-seq-3ã€‘ã€hbctraining_pipelineã€‘</title>
    <link href="/GeekFocus/2021/10/26/2021-10-30-ATAC-seq-3-hbctraining/"/>
    <url>/GeekFocus/2021/10/26/2021-10-30-ATAC-seq-3-hbctraining/</url>
    
    <content type="html"><![CDATA[<p>ATAC-seq &amp;ChIP-seq</p><span id="more"></span><hr><h2 id="https-github-com-hbctraining-In-depth-NGS-Data-Analysis-Course-tree-master-sessionV-lessons"><a href="#https-github-com-hbctraining-In-depth-NGS-Data-Analysis-Course-tree-master-sessionV-lessons" class="headerlink" title="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons"></a><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons">https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons</a></h2><!-- more --><p>ç®—æ³•ï¼Œå‚æ•°ï¼Œè¾“å‡ºã€‚</p><h2 id="Peak-calling"><a href="#Peak-calling" class="headerlink" title="Peak calling"></a>Peak calling</h2><p><img src="https://img-blog.csdnimg.cn/f2741798d4f04f708412c97b2e6ef045.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ChIP-seqå®éªŒï¼Œä»æ¯”å¯¹æ–‡ä»¶ä¸­è§‚å¯Ÿåˆ°<code>æ­£/è´Ÿé“¾</code>ä¸Šä»¥<code>ç»“åˆä½ç‚¹ä¸ºä¸­å¿ƒ</code>çš„éå¯¹ç§°reads<br>å¯†åº¦ã€‚<br>For ChIP-seq experiments, what we observe from the alignment files is a strand asymmetry with read densities on the +&#x2F;- strand, centered around the binding site. <code>The 5â€™ ends of the selected fragments</code> will form <code>groups</code> on the positive- and negative-strand. The <code>distributions</code> of these groups are then assessed using <code>statistical measures</code> and <code>compared against background</code> (input or mock IP samples) to determine if the site of enrichment is likely to be a real binding site.</p><p><img src="https://img-blog.csdnimg.cn/a5f4429afb3348be91f68d90d4011065.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åŠ ç²—æ ·å¼"><br><code>ChIP-seq analysis algorithms</code> are specialized in identifying one of <code>two types of enrichment</code> (or have specific methods for each): <code>broad peaks or broad domains</code> (i.e. <code>histone modifications that cover entire gene bodies</code>) or <code>narrow peaks</code> ( <code>transcription factor binding</code>). <code>Narrow peaks are easier to detect</code> as we are looking for regions that have higher amplitude and are easier to distinguish from the background, compared to broad or dispersed marks. There are also <code>â€˜mixedâ€™ binding profiles</code> which can be hard for algorithms to discern. An example of this is the binding properties of <code>PolII</code>, which binds at promotor and across the length of the gene resulting in mixed signals (<code>narrow and broad</code>).</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">NOTEï¼šChIP-seqçš„åˆ†ææ–¹æ³•å¯ä»¥é‰´å®šä¸¤ç§ç±»å‹çš„å¯Œé›†æ¨¡å¼ï¼š<span class="hljs-keyword">broad </span>domainså’Œnarrow peaksã€‚<span class="hljs-keyword">broad </span>domainsï¼Œå¦‚ç»„è›‹ç™½ä¿®é¥°åœ¨æ•´ä¸ªåŸºå› <span class="hljs-keyword">bodyåŒºåŸŸçš„åˆ†å¸ƒï¼›narrow </span>peakï¼Œå¦‚è½¬å½•å› å­çš„ç»“åˆã€‚narrow peakç›¸å¯¹äº<span class="hljs-keyword">broad </span>æˆ–è€…åˆ†æ•£çš„marksæ›´æ˜“è¢«æ£€æµ‹åˆ°ã€‚ä¹Ÿæœ‰ä¸€äº›æ··åˆçš„ç»“åˆå›¾è°±ï¼Œå¦‚PolIIåŒ…æ‹¬narrowå’Œ<span class="hljs-keyword">broadä¿¡å·ã€‚</span><br></code></pre></td></tr></table></figure><h2 id="MACS2"><a href="#MACS2" class="headerlink" title="MACS2"></a>MACS2</h2><p>MACS2æ˜¯æœ€å¸¸ç”¨çš„call peakså·¥å…·ã€‚ The MACS algorithm captures the influence of <code>genome complexity</code> to evaluate the significance of enriched ChIP regionsã€‚å…¨ç§°<code>Model-based Analysis of ChIP-Seq</code>ï¼Œæœ€åˆè®¾è®¡ç”¨æ¥<code>é‰´å®šè½¬å½•å› å­ç»“åˆä½ç‚¹</code>ï¼ˆalso suited for <code>larger</code> regionsï¼‰ï¼Œä¹Ÿå¯ç”¨äº<code>å…¶ä»–ç±»å‹</code>çš„å¯Œé›†æ–¹å¼æµ‹åºã€‚<br>MACSé€šè¿‡æ•´åˆ<code>åºåˆ—æ ‡ç­¾ä½ç½®ä¿¡æ¯</code>å’Œ<code>æ–¹å‘</code>ä¿¡æ¯æé«˜<code>ç»“åˆä½ç‚¹</code>çš„<code>ç©ºé—´åˆ†è¾¨ç‡</code>ï¼ˆ <code>improves</code> the <code>spatial resolution of binding sites</code> through <code>combining the information of both sequencing tag position and orientation</code>ï¼‰ã€‚å•ç‹¬ä½¿ç”¨æˆ–åŠ å¯¹ç…§ï¼ˆ <code>increases specificity</code> of the peak callsï¼‰ã€‚<br><img src="https://img-blog.csdnimg.cn/3929b0f60a01477ea09402760205f200.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_17,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="1-Remove-redundancy"><a href="#1-Remove-redundancy" class="headerlink" title="1. Remove redundancy"></a>1. Remove redundancy</h3><p><code>Why worry about duplicates?</code> <code>Reads with the same start position</code> are <code>considered duplicates</code>. These duplicates can arise from experimental artifacts, but can also contribute to genuine ChIP-signal. (ç›¸åŒèµ·ç‚¹çš„readsè¢«è®¤ä¸ºæ˜¯duplicatesï¼Œå¯èƒ½ç”±äºå®éªŒè¯¯å·®é€ æˆï¼Œ<code>ä¹Ÿå¯èƒ½æ˜¯ChIPä¿¡å·</code>)</p><ul><li><code>å duplicates</code>: If initial starting <code>material is low</code> this can lead to <code>overamplification</code> of this material before sequencing. Any <code>biases in PCR</code> will compound this problem and can lead to <code>artificially enriched regions</code>. Also <code>blacklisted (repeat) regions</code> with ultra high signal will also be high in duplicates. <code>Masking these regions</code> prior to analysis can help remove this problemã€‚ å®éªŒææ–™é‡å°‘ï¼Œè¿‡åº¦æ‰©å¢ï¼ŒPCRåå·®ï¼Œäººä¸ºå¯Œé›†åŒºåŸŸã€‚<code>blacklistï¼ˆé‡å¤ï¼‰åŒºåŸŸï¼Ÿæ€ä¹ˆè·å¾—</code>ï¼Œå±è”½è¯¥åŒºåŸŸã€‚</li><li><code>å¥½ duplicates</code>: You can expect some <code>biological duplicates with ChIP-seq</code> since you are only sequencing a small <code>part of the genome</code>. This number can increase if your depth of coverage is excessive or if your protein only binds to few sites. If there are a good proportion of biological dupicates, <code>removal</code> can lead to an <code>underestimation of the ChIP signal</code>. æœ‰ChIP-seqæ„ä¹‰çš„ç”Ÿç‰©å­¦æ„ä¹‰duplicates ï¼Œæµ‹åºåŸºå› ç»„å°éƒ¨åˆ†ã€‚è¦†ç›–æ·±åº¦è¿‡å¤šï¼Œè›‹ç™½è´¨ä¸å°‘æ•°ä½ç‚¹ç»“åˆï¼Œduplicatesä¼šå¢åŠ ã€‚å»é™¤æ­¤ç±»ä¼šå¯¼è‡´å¯¹ChIPä¿¡å·çš„ä½ä¼°ã€‚</li><li>Consider your <code>enrichment efficiency</code> and <code>sequencing depth</code>. Try to <code>discriminate</code> via genome browser of your non-deduplicated data. Bona fide peaks will have <code>multiple overlapping</code> reads with <code>offsets</code>, while samples with only PCR duplicates will stack up perfectly without offsets. A possible solution to distinguishing biological duplicate from PCR artifact would be to include UMIs into your experimental setup. è€ƒè™‘<code>å¯Œé›†æ•ˆç‡</code>å’Œ<code>æµ‹åºæ·±åº¦</code>ã€‚é€šè¿‡<code>åŸºå› ç»„æµè§ˆå™¨åŒºåˆ«</code>ã€‚<code>çœŸæ­£çš„å³°</code>ä¼šæœ‰å¤šä¸ª<code>é‡å readså’Œåç§»é‡</code>ï¼Œ<code>PCRé‡å¤æ²¡æœ‰åç§»é‡</code>ã€‚å¦‚ä½•åŒºåˆ†ï¼šå®éªŒè®¾è®¡è€ƒè™‘<a href="https://www.sohu.com/a/471483238_120055884">UMIs</a>ï¼ˆ<code>UMIå°†è¢«ç”¨äºåˆå¹¶PCRå¤åˆ¶ç‰©</code>ï¼‰ã€‚</li><li>Retain duplicates for differential binding analysis. ä¿ç•™duplicates ç”¨äºå·®å¼‚ç»“åˆåˆ†æ <code>why</code>ï¼Ÿretainå’ŒkeepåŒºåˆ«ï¼Ÿ</li><li>If you are expecting binding in repetitive regions, use paired-end sequencing and keep duplicates. ç ”ç©¶é‡å¤åŒºåŸŸï¼Œä½¿ç”¨pariedendæµ‹åºå¹¶<code>ä¿æŒé‡å¤ï¼Ÿ</code></li><li>call peakä¹‹å‰å°±remove dup<h3 id="2-0-Shift-size-d"><a href="#2-0-Shift-size-d" class="headerlink" title="2.0 Shift size d"></a>2.0 <code>Shift size d</code></h3></li><li>çœŸå®ç»“åˆä½ç‚¹å‘¨å›´çš„tag densityåº”æ˜¾ç¤º<code>åŒå³°å¯Œé›†</code>(<code>æˆå¯¹å³°</code>)ã€‚MACSåˆ©ç”¨è¿™ç§åŒå³°æ¨¡å¼ <code>empirically model the shifting size</code>ï¼Œç²¾ç¡®å®šä½ç»“åˆä½ç‚¹ã€‚</li><li>ä¸ºäº†æ‰¾åˆ°<code>æˆå¯¹å³°</code>æ¥<code>æ„å»ºæ¨¡å‹</code>ï¼ŒMACSé¦–å…ˆ<code>æ‰«ææ•´ä¸ªæ•°æ®é›†</code>ï¼Œå¯»æ‰¾<code>é«˜åº¦æ˜¾è‘—å¯Œé›†åŒºåŸŸ</code>ã€‚åªåˆ©ç”¨ChIPæ ·æœ¬ï¼Œç»™å®šè¶…å£°å¤§å°sonication size(<code>bandwidth</code>)å’Œhigh-confidence fold-enrichment(<code>mfold</code>)ï¼Œ MACS <code>slides two bandwidth windows</code> across the genome to find <code>regions with tags more than mfold enriched</code> relative to a <code>random tag genome distribution</code>.</li><li>MACS<code>éšæœºæŠ½å–1000ä¸ªé«˜è´¨é‡å³°</code>ï¼Œ<code>åˆ†ç¦»æ­£é“¾å’Œè´Ÿé“¾æ ‡ç­¾</code>ï¼Œaligns them by the midpoint between their centersã€‚The <code>distance between the modes of the two peaks in the alignment is defined as â€˜dâ€™</code> and represents the estimated fragment length. MACS shifts all the tags by d&#x2F;2 toward the 3â€™ ends to the most likely protein-DNA interaction sites.<br><img src="https://img-blog.csdnimg.cn/eeefe600965542478444f761de31db17.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_10,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li></ul><h3 id="2-Select-1000-regions-with-a-10-to-30-fold-enrichment-relative-to-the-genome-background"><a href="#2-Select-1000-regions-with-a-10-to-30-fold-enrichment-relative-to-the-genome-background" class="headerlink" title="2. Select 1000 regions with a 10- to 30-fold enrichment relative to the genome background"></a>2. Select 1000 regions with a 10- to 30-fold enrichment relative to the genome background</h3><h3 id="3-Build-model-and-estimate-DNA-fragment-size-d"><a href="#3-Build-model-and-estimate-DNA-fragment-size-d" class="headerlink" title="3. Build model and estimate DNA fragment size d"></a>3. Build model and estimate DNA fragment size d</h3><h3 id="4-Shift-reads-toward-3â€™end-by-d"><a href="#4-Shift-reads-toward-3â€™end-by-d" class="headerlink" title="4. Shift reads toward 3â€™end by d"></a>4. Shift reads toward 3â€™end by d</h3><h3 id="5-Scale-two-libraries-if-have-control"><a href="#5-Scale-two-libraries-if-have-control" class="headerlink" title="5. Scale two libraries(if have control)"></a>5. Scale two libraries(if have control)</h3><p>For experiments in which <code>sequence depth differs</code> between input and treatment samples, MACS linearly scales the total control tag count to be the same as the total ChIP tag count. The default behaviour is for the <code>larger sample to be scaled down</code>. </p><h3 id="6-0-Effective-genome-length"><a href="#6-0-Effective-genome-length" class="headerlink" title="6.0 Effective genome length"></a>6.0 Effective genome length</h3><p>To calculate Î»BG from tag count, MAC2 requires the <code>effective genome size or the size of the genome that is mappable</code>. Mappability is related to the <code>uniqueness of the k-mers</code> at a particular position the genome. <code>Low-complexity</code> and <code>repetitive regions</code> have <code>low uniqueness</code>, which means <code>low mappability</code>. Therefore we need to provide the effective genome length to correct for the loss of true signals in low-mappable regions. æä¾›<code>æœ‰æ•ˆåŸºå› ç»„é•¿åº¦</code>ï¼Œä»¥<code>çº æ­£ä½å®šä½åŒºåŸŸçœŸå®ä¿¡å·ä¸¢å¤±</code>ã€‚<br><img src="https://img-blog.csdnimg.cn/5571c4b228cb4706805ba0853c546c3c.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><code>å¦‚ä½•è·å¾—ï¼Ÿ</code>The MACS2 software has some <code>pre-computed values</code> for <code>commonly used</code> organisms (human, mouse, worm and flyï¼Œ<code>riceï¼Ÿ</code>). more accurate values? The <code>deepTools</code> docs has additional pre-computed values for more recent builds but also has some good materials on <code>how to go about computing</code> it.</p><h3 id="6-Call-candidate-peaks-relative-to-genome-background"><a href="#6-Call-candidate-peaks-relative-to-genome-background" class="headerlink" title="6. Call candidate peaks relative to genome background"></a>6. Call candidate peaks relative to genome background</h3><p>After MACS <code>shifts every tag by d/2</code>, it then <code>slides across the genome</code> using a window size of <code>2d</code> to <code>find candidate peaks</code>.  The <code>tag distribution</code> along the genome can be modeled by a <code>Poisson distribution</code>.  The Poisson is a one parameter model, where the parameter <code>Î» is the expected number of reads in that window</code>.</p><h3 id="7-Calculate-dynamic-Î»-for-candidate-peaks"><a href="#7-Calculate-dynamic-Î»-for-candidate-peaks" class="headerlink" title="7. Calculate dynamic Î» for candidate peaks"></a>7. Calculate dynamic Î» for candidate peaks</h3><p><img src="https://img-blog.csdnimg.cn/eaac9c4b4c294be3b8b3b3caf7c35a21.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ³Šæ¾åˆ†å¸ƒçš„å‚æ•°Î»æ˜¯å•ä½æ—¶é—´(æˆ–å•ä½é¢ç§¯)å†…éšæœºäº‹ä»¶çš„å¹³å‡å‘ç”Ÿæ¬¡æ•°ã€‚ æ³Šæ¾åˆ†å¸ƒçš„æœŸæœ›å’Œæ–¹å·®å‡ä¸ºÎ».<br>Instead of using a uniform Î» estimated from the whole genome, MACS uses a <code>dynamic parameter, Î»local</code>, defined for <code>each candidate peak</code>. The lambda parameter is estimated from the control sample and is deduced by taking the maximum value across <code>various window sizes</code>:</p><blockquote><p>Î»local &#x3D; max(Î»BG, Î»1k, Î»5k, Î»10k).</p></blockquote><p>In this way lambda <code>captures the influence of local biases</code>, and is robust against occasional low tag counts at small local regions. Possible sources for these biases include local chromatin structure, DNA amplification and sequencing bias, and genome copy number variation. é€šè¿‡ä½¿ç”¨åŠ¨æ€lambdaæ•è·å±€éƒ¨åå·®çš„å½±å“ï¼Œå¹¶ä¸”å¯¹å°å±€éƒ¨åŒºåŸŸä¸­<code>å¶å°”å‡ºç°çš„low tag counts</code>è¡¨ç°è¾ƒå¥½ã€‚<code>åå·®å¯èƒ½æ¥æº</code>åŒ…æ‹¬å±€éƒ¨æŸ“è‰²è´¨ç»“æ„ã€DNAæ‰©å¢å’Œæµ‹åºåå·®ä»¥åŠåŸºå› ç»„æ‹·è´æ•°å˜åŒ–ã€‚<br><img src="https://img-blog.csdnimg.cn/3c7c645b299e45b2b7975d6327d421bc.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>A region is considered to have a <code>significant tag enrichment</code> if the <code>p-value &lt; 10e-5</code> (å¯è®¾ç½®). This is a Poisson distribution p-value based on Î».</p><p>Overlapping enriched peaks are merged, and each tag position is <code>extended â€˜dâ€™ basesï¼Ÿ</code> from its center. The location in the <code>peak with the highest fragment pileupå †ç§¯</code>, hereafter referred to as the summitå³°é¡¶, is <code>predicted as the precise binding location</code>. The <code>ratio between the ChIP-seq tag count and Î»localï¼Ÿ</code> is reported as the fold enrichment.</p><h3 id="8-Calculate-P-value-and-filter-candidate-peaks"><a href="#8-Calculate-P-value-and-filter-candidate-peaks" class="headerlink" title="8. Calculate P value and filter candidate peaks"></a>8. Calculate P value and filter candidate peaks</h3><h3 id="9-Calculate-FDR-by-exchanging-treatment-and-control"><a href="#9-Calculate-FDR-by-exchanging-treatment-and-control" class="headerlink" title="9. Calculate FDR by exchanging treatment and control"></a>9. Calculate FDR by exchanging treatment and control</h3><p>Each peak is considered an independent test and thus, when we encounter thousands of significant peaks detected in a sample we have a multiple testing problem. In <code>MACSv1.4</code>, the FDR was determined <code>empirically by exchanging the ChIP and control samples</code>. However, in <code>MACS2</code>, p-values are now corrected for multiple comparison using the <code>Benjamini-Hochberg correction</code>.</p><h2 id="MACS2-å‚æ•°"><a href="#MACS2-å‚æ•°" class="headerlink" title="MACS2 å‚æ•°"></a>MACS2 å‚æ•°</h2><h3 id="1-Input-file-options"><a href="#1-Input-file-options" class="headerlink" title="1. Input file options"></a>1. Input file options</h3><ul><li><code>-t</code> : The IP data file (this is the only REQUIRED parameter for MACS) å®éªŒç»„</li><li><code>-c</code> : Control or mock data å¯¹ç…§</li><li><code>-f</code> : è¾“å…¥æ–‡ä»¶æ ¼å¼ï¼Œé»˜è®¤å€¼â€œAUTOâ€ ï¼Œbam sam bed</li><li><code>-g</code> :  <code>mappable genome size</code> which is defined as the genome size which can be sequenced; some precompiled values provided.</li><li>hs: 2.7e9äººç±»åŸºå› ç»„æœ‰æ•ˆå¤§å°(UCSC human hg18 assembly)<h3 id="2-Output-arguments"><a href="#2-Output-arguments" class="headerlink" title="2. Output arguments"></a>2. Output arguments</h3></li><li><code>-outdir</code> : è¾“å‡ºæ–‡ä»¶å¤¹</li><li><code>-n</code> : æ–‡ä»¶å‰ç¼€</li><li><code>-B/--bdg</code> : store the fragment pileup, control lambda, -log10pvalue and -log10qvalue scores in bedGraph files è¾“å‡ºbedgraphæ ¼å¼çš„æ–‡ä»¶<h3 id="3-Shifting-model-arguments"><a href="#3-Shifting-model-arguments" class="headerlink" title="3. Shifting model arguments"></a>3. Shifting model arguments</h3></li><li><code>-s</code> : <code>size of sequencing tags</code>. Default, MACS will use the <code>first 10 sequences</code> from your input treatment file to determine it</li><li><code>--bw</code> : The bandwidth which is used to <code>scan the genome</code> ONLY for model building. Can be set to the expected sonication fragment size.</li><li><code>--mfold</code> : <code>upper and lower limit</code> for model building</li><li><code>--nomodel</code>ï¼š<code>å’Œextsizeã€shiftæ˜¯é…å¥—ä½¿ç”¨</code>ï¼Œæœ‰è¿™ä¸ªå‚æ•°æ‰å¯è®¾ç½®extsizeå’Œshiftã€‚</li><li><code>--extsize</code>ï¼šå½“è®¾ç½®äº†nomodelæ—¶ï¼ŒMACSä¼šç”¨â€“extsizeè¿™ä¸ªå‚æ•°ä»<code>5&#39;-&gt;3&#39;æ–¹å‘æ‰©å±•readsä¿®å¤fragments</code>ã€‚å¦‚è½¬å½•å› å­ç»“åˆèŒƒå›´200bpï¼Œè®¾ç½®è¿™ä¸ªå‚æ•°æ˜¯200ã€‚</li><li><code>--shift</code>ï¼šå½“è®¾ç½®äº†â€“nomodelï¼ŒMACSç”¨è¿™ä¸ªå‚æ•°ä»<code>5&#39; ç«¯ç§»åŠ¨å‰ªåˆ‡</code>ï¼Œç„¶åç”¨â€“extsizeå»¶ä¼¸ï¼Œå¦‚æœâ€“shiftæ˜¯è´Ÿå€¼è¡¨ç¤ºä»3â€™ç«¯æ–¹å‘ç§»åŠ¨ã€‚å»ºè®®ChIP-seqæ•°æ®é›†è¿™ä¸ªå€¼ä¿æŒé»˜è®¤å€¼ä¸º0ï¼Ÿï¼Œå¯¹äºæ£€æµ‹å¯Œé›†å‰ªåˆ‡ä½ç‚¹å¦‚DNAseqæ•°æ®é›†è®¾ç½®ä¸ºEXTSIZEçš„ä¸€åŠã€‚</li></ul><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-comment">æƒ³æ‰¾å¯Œé›†å‰ªåˆ‡ä½ç‚¹ï¼Œå¦‚DNAse</span><span class="hljs-literal">-</span><span class="hljs-comment">seqï¼Œæ‰€æœ‰5&#x27;ç«¯çš„åºåˆ—readsåº”è¯¥ä»ä¸¤ä¸ªæ–¹å‘å»¶ä¼¸ï¼Œå¦‚æœæƒ³è®¾ç½®ç§»åŠ¨çš„çª—å£æ˜¯200bpï¼Œå‚æ•°è®¾ç½®å¦‚ä¸‹ï¼š</span><br><span class="hljs-literal">--</span><span class="hljs-comment">nomodel</span> <span class="hljs-literal">--</span><span class="hljs-comment">shift</span> <span class="hljs-literal">-</span><span class="hljs-comment">100</span> <span class="hljs-literal">--</span><span class="hljs-comment">extsize 200</span><br><span class="hljs-comment">å¯¹nucleosome</span><span class="hljs-literal">-</span><span class="hljs-comment">seqæ•°æ®ï¼Œç”¨æ ¸å°ä½“å¤§å°çš„ä¸€åŠè¿›è¡Œextsize</span><span class="hljs-string">,</span><span class="hljs-comment">æ‰€ä»¥å‚æ•°è®¾ç½®å¦‚ä¸‹ï¼š</span><br><span class="hljs-literal">--</span><span class="hljs-comment">nomodel</span> <span class="hljs-literal">--</span><span class="hljs-comment">shift 37</span> <span class="hljs-literal">--</span><span class="hljs-comment">extsize 73</span><br></code></pre></td></tr></table></figure><p><code>ATAC-seq</code>å…³å¿ƒçš„æ˜¯åœ¨å“ªåˆ‡æ–­ï¼Œæ–­ç‚¹æ‰æ˜¯peakçš„ä¸­å¿ƒï¼Œæ‰€ä»¥ä½¿ç”¨shiftæ¨¡å‹ï¼Œâ€“shift -75æˆ–-100<br>å¯¹äººç»†èƒç³»ATAC-seq æ•°æ®call peakçš„å‚æ•°è®¾ç½®ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">macs2 callpeak -t H1hesc<span class="hljs-selector-class">.final</span><span class="hljs-selector-class">.bam</span> -n sample <span class="hljs-attr">--shift</span> -<span class="hljs-number">100</span> <span class="hljs-attr">--extsize</span> <span class="hljs-number">200</span> <span class="hljs-attr">--nomodel</span> -B <span class="hljs-attr">--SPMR</span> -g hs <span class="hljs-attr">--outdir</span> Macs2_out <span class="hljs-number">2</span>&gt; sample<span class="hljs-selector-class">.macs2</span>.log<br></code></pre></td></tr></table></figure><h3 id="4-Peak-calling-arguments"><a href="#4-Peak-calling-arguments" class="headerlink" title="4. Peak calling arguments"></a>4. Peak calling arguments</h3><ul><li><code>-q</code> : q-value (minimum FDR) cutoff <code>q valueé»˜è®¤å€¼æ˜¯0.05ï¼Œä¸pvalueä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚</code></li><li><code>-p</code> : p-value cutoff (instead of q-value cutoff)</li><li><code>--nolambda</code> : do not consider the local bias&#x2F;lambda at peak candidate regionsã€‚ä¸è¦è€ƒè™‘åœ¨å³°å€¼å€™é€‰åŒºåŸŸçš„å±€éƒ¨åå·®&#x2F;Î»</li><li><code>--broad</code> : broad peak callingï¼Œnarrow peakå’Œbroad peak</li></ul><p> Relaxing the <code>q-value</code> does not behave as expected in this case since it is partially tied to peak widths. Ideally, if you <code>relaxed the thresholds</code>, you would simply get <code>more peaks</code> but with MACS2 relaxing thresholds also results in <code>wider peaks</code>. qå€¼ä¸å³°å®½æœ‰ä¸€å®šçš„è”ç³»ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œå¦‚æœæ”¾å®½é˜ˆå€¼ï¼Œæ‚¨å°†ç®€å•åœ°è·å¾—æ›´å¤šçš„å³°å€¼ï¼Œä½†æ˜¯ä½¿ç”¨MACS2æ”¾æ¾é˜ˆå€¼ä¹Ÿä¼šå¯¼è‡´æ›´å®½çš„å³°å€¼ã€‚</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs livescript">macs2 callpeak -t bowtie2/H1hesc_Nanog_Rep1_aln.bam <span class="hljs-string">\</span><br>-c bowtie2/H1hesc_Input_Rep1_aln.bam <span class="hljs-string">\</span><br> -f BAM -g <span class="hljs-number">1.3e+8</span> <span class="hljs-string">\</span><br>-n Nanog-rep1 <span class="hljs-string">\</span><br>--outdir macs2 <span class="hljs-number">2</span>&gt; macs2/Nanog-rep1-macs2.log<br></code></pre></td></tr></table></figure><h2 id="MACS2-Output-files"><a href="#MACS2-Output-files" class="headerlink" title="MACS2 Output files"></a>MACS2 Output files</h2><h3 id="narrowPeak"><a href="#narrowPeak" class="headerlink" title="narrowPeak"></a>narrowPeak</h3><p>A narrowPeak (<code>.narrowPeak</code>) file is used by the ENCODE project to provide <code>called peaks of signal enrichment</code> based on pooled, normalized (interpreted) data. It is a <code>BED 6+4 format</code>, which means the <code>first 6 columns of a standard BED file</code> with <code>4 additional</code> fields:<br><img src="https://img-blog.csdnimg.cn/7bd1ca4fcb3847daacc450a91989b5cd.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="WIG-format"><a href="#WIG-format" class="headerlink" title="WIG format"></a>WIG format</h3><p>Wiggle format (WIG) allows the <code>display</code> of continuous-valued data in a track format. Wiggle format is <code>line-oriented</code>. It is composed of declaration lines and data lines, and require a separate wiggle track definition line. There are two options for formatting wiggle data: variableStep and fixedStep. These formats were developed to allow the file to be written as compactly as possible.</p><h3 id="BedGraph-format"><a href="#BedGraph-format" class="headerlink" title="BedGraph format"></a>BedGraph format</h3><p>The BedGraph format also allows display of continuous-valued data in track format. This display type is useful for probability scores and transcriptome data. This track type is similar to the wiggle (WIG) format, but unlike the wiggle format, data exported in the bedGraph format are preserved in their original state. For the purposes of visualization, these can be interchangeable.</p><ul><li><p><code>_peaks.narrowPeak</code>: BED6+4 format file which contains the peak locations together with peak summit, pvalue and qvalueã€‚<code>BED6+4æ ¼å¼ï¼Œå¯ä»¥ä¸Šä¼ åˆ°UCSCæµè§ˆã€‚</code></p><ul><li>1ï¼šæŸ“è‰²ä½“å·</li><li>2ï¼špeakèµ·å§‹ä½ç‚¹</li><li>3ï¼šç»“æŸä½ç‚¹</li><li>4ï¼špeak name</li><li>5ï¼šint(-10*log10qvalue)</li><li>6 ï¼šæ­£è´Ÿé“¾</li><li>7ï¼šfold change</li><li>8ï¼š-log10pvalue</li><li>9ï¼š-log10qvalue</li><li>10ï¼šrelative summit position to peak startï¼ˆï¼Ÿï¼‰</li></ul></li><li><p><code>_peaks.xls</code>: a tabular file which contains information about called peaks. Additional information includes pileup and fold enrichmentã€‚<code>å«peakä¿¡æ¯çš„tabåˆ†å‰²çš„æ–‡ä»¶ï¼Œå‰å‡ è¡Œæ˜¾ç¤ºcallpeakå‘½ä»¤</code>ã€‚</p><ul><li>æŸ“è‰²ä½“å·</li><li>peakèµ·å§‹ä½ç‚¹</li><li>peakç»“æŸä½ç‚¹</li><li>peakåŒºåŸŸé•¿åº¦</li><li>peakçš„å³°å€¼ä½ç‚¹ï¼ˆsummit positionï¼‰</li><li>peak å³°å€¼çš„é«˜åº¦ï¼ˆpileup height at peak summit, -log10(pvalue) for the peak summitï¼‰</li><li>peakçš„å¯Œé›†å€æ•°ï¼ˆç›¸å¯¹äºrandom Poisson distribution with local lambdaï¼‰</li><li>XLSé‡Œçš„åæ ‡å’Œbedæ ¼å¼çš„åæ ‡è¿˜ä¸ä¸€æ ·ï¼Œèµ·å§‹åæ ‡éœ€è¦å‡1æ‰ä¸narrowPeakçš„èµ·å§‹åæ ‡ä¸€æ ·ã€‚</li></ul></li><li><p><code>_summits.bed</code>: peak summits locations for every peak. To find the motifs at the binding sites, this file is recommendedã€‚BEDæ ¼å¼çš„æ–‡ä»¶ï¼ŒåŒ…å«peakçš„summitsä½ç½®ï¼Œç¬¬5åˆ—æ˜¯-log10pvalueã€‚å¦‚æœæƒ³æ‰¾motifï¼Œæ¨èä½¿ç”¨æ­¤æ–‡ä»¶ã€‚</p></li><li><p><code>_model.R</code>: an R script which you can use to produce a PDF image about the model based on your data and cross-correlation plot</p></li><li><p><code>_control_lambda.bdg</code>: bedGraph format for input sample</p></li><li><p><code>_treat_pileup.bdg</code>: bedGraph format for treatment sampleã€‚bedGraphæ ¼å¼ï¼Œå¯ä»¥å¯¼å…¥UCSCæˆ–è€…è½¬æ¢ä¸ºbigwigæ ¼å¼ã€‚ä¸¤ç§bfgæ–‡ä»¶ï¼štreat_pileup, and control_lambda.</p></li><li><p><code>NAME_peaks.broadPeak</code>ï¼š BED6+3æ ¼å¼ä¸narrowPeakç±»ä¼¼ï¼Œåªæ˜¯æ²¡æœ‰ç¬¬10åˆ—ã€‚</p></li></ul><p>Rä½œå›¾the first plot illustrates the distance between the modes from which the shift size was determinedï¼Ÿ<br><img src="https://img-blog.csdnimg.cn/3d941b11b37c4b7687b11e6766a9daff.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_13,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>The second plot is the cross-correlation plot. This is a graphical representation of the Pearson correlation of positive- and negative- strand tag densities, shifting the strands relative to each other by increasing distanceï¼Ÿ</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">xlsæ–‡ä»¶<br>æ–‡ä»¶åŒ…å«ä¿¡æ¯è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œå’ŒnarrowPeakå”¯ä¸€ä¸åŒçš„æ˜¯peakçš„èµ·å§‹ä½ç½®éœ€è¦å‡<span class="hljs-number">1</span>æ‰æ˜¯<span class="hljs-keyword">bedæ ¼å¼çš„æ–‡ä»¶ï¼Œå¦å¤–è¿˜åŒ…å«fold_enrichment </span>å’ŒnarrowPeakçš„fold change å¯¹åº”ï¼Œ-log10pvalue,-log10qvalue,peaké•¿åº¦ï¼Œpeak å³°å€¼ä½ç½®ç­‰ã€‚<br>narrowPeakæ–‡ä»¶<br>å’Œxlsæ–‡ä»¶ä¿¡æ¯ç±»ä¼¼<br>summits.<span class="hljs-keyword">bedæ–‡ä»¶</span><br><span class="hljs-keyword"></span>åŒ…å«å³°çš„ä½ç½®ä¿¡æ¯å’Œ-log10pvalue<br><span class="hljs-keyword">bdgæ–‡ä»¶</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">bdgæ–‡ä»¶é€‚åˆå¯¼å…¥UCSCæˆ–IGVè¿›è¡Œè°±å›¾å¯è§†åŒ–ï¼Œæˆ–è€…è½¬æ¢ä¸ºbigwigæ ¼å¼å†è¿›è¡Œå¯è§†åŒ–ã€‚</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>NGS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>pipeline</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Assemblyã€‘ã€hifiasmã€‘</title>
    <link href="/GeekFocus/2021/10/20/2022-02-02-hifiasm/"/>
    <url>/GeekFocus/2021/10/20/2022-02-02-hifiasm/</url>
    
    <content type="html"><![CDATA[<p>Nat. Methods hifiasm</p><span id="more"></span><hr><h2 id="Nat-Methods-ç­‰ä½åŸºå› ç»„ç»„è£…ç®—æ³•hifiasmï¼ˆ20210202ï¼‰"><a href="#Nat-Methods-ç­‰ä½åŸºå› ç»„ç»„è£…ç®—æ³•hifiasmï¼ˆ20210202ï¼‰" class="headerlink" title="Nat. Methods|ç­‰ä½åŸºå› ç»„ç»„è£…ç®—æ³•hifiasmï¼ˆ20210202ï¼‰"></a>Nat. Methods|ç­‰ä½åŸºå› ç»„ç»„è£…ç®—æ³•hifiasmï¼ˆ20210202ï¼‰</h2><p>paperï¼š<a href="https://pubmed.ncbi.nlm.nih.gov/33526886/">Haplotype-resolved de novo assembly using phased assembly graphs with hifiasm</a><br>è¯¥ç ”ç©¶æå‡ºä¸€ç§å…¨æ–°çš„å•å€å‹åŸºå› ç»„ç»„è£…ç®—æ³•hifiasmï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°å¯¹<font color=red>å¤§å‹å¤æ‚åŸºå› ç»„ç”Ÿæˆé«˜è´¨é‡çš„å•å€å‹ç»„è£…ç»“æœ</font>ã€‚</p><!-- more --><h3 id="å•å€å‹ç»„è£…éš¾ç‚¹"><a href="#å•å€å‹ç»„è£…éš¾ç‚¹" class="headerlink" title="å•å€å‹ç»„è£…éš¾ç‚¹"></a>å•å€å‹ç»„è£…éš¾ç‚¹</h3><p>å•å€å‹åŸºå› ç»„ç»„è£…æ˜¯ç ”ç©¶åŸºå› ç»„ç»“æ„ä¸å˜å¼‚çš„æœ€ç†æƒ³æ–¹å¼ã€‚ç”±äºæŠ€æœ¯çš„å±€é™ï¼Œå¤§å¤šæ•°ç»„è£…ç®—æ³•å€¾å‘äºå°†ä¸åŒå•å€å‹æœ‰æŸçš„å‹ç¼©æˆä¸€æ¡æ··åˆçš„ä»£è¡¨æ€§åºåˆ—ã€‚å¯¹äºè‡ªç„¶ç•Œä¸­ä¸»æµçš„äºŒå€ä½“å’Œå¤šå€ä½“æ ·æœ¬è€Œè¨€ï¼Œè¿™ç±»æ–¹æ³•æŸå¤±äº†å¤§é‡çš„å•å€å‹ä¿¡æ¯ã€‚è¿™ä½¿å¾—é•¿ä¹…ä»¥æ¥ï¼Œç ”ç©¶äººå‘˜éš¾ä»¥å¯¹é«˜æ‚åˆã€é«˜é‡å¤çš„åŸºå› ç»„è¿›è¡Œæ·±å…¥çš„åˆ†æã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªéš¾é¢˜ï¼Œä¸€äº›ç»„è£…ç®—æ³•é¦–å…ˆç”Ÿæˆæ··åˆçš„ä»£è¡¨æ€§åºåˆ—ï¼Œæ¥ç€ä»ä»£è¡¨æ€§åºåˆ—ä¸­æ¢å¤å‡ºä¸åŒçš„å•å€å‹ä¿¡æ¯ã€‚ä½†æ˜¯ï¼Œç”±äºä»£è¡¨æ€§åºåˆ—æœ¬èº«å·²ç»ä¸¢å¤±äº†å¤§é‡çš„ä¿¡æ¯ï¼Œè¿™ç±»æ–¹æ³•éš¾ä»¥è·å¾—é«˜è´¨é‡çš„å•å€å‹ç»„è£…ç»“æœã€‚</p><p>è¿‘æœŸçš„ç»„è£…ç®—æ³•é€šè¿‡é¢å¤–çš„ä¿¡æ¯ï¼Œå¦‚å®¶ç³»(Trio binning)æˆ–è€…Hi-Cç­‰æ•°æ®ï¼Œé¢„å…ˆå…¨å±€æ€§çš„å°†å¾…ç»„è£…çš„æµ‹åºè¯»æ®µåˆ’åˆ†åˆ°ä¸åŒå•å€å‹ï¼Œå†è¿›è¡Œåˆ†åˆ«ç»„è£…ï¼Œä»è€Œè¯•å›¾è·å¾—é«˜è´¨é‡çš„å•å€å‹ç»„è£…ç»“æœã€‚ä½†æ˜¯å¯¹äºä½æ‚åˆçš„æ ·æœ¬è€Œè¨€ï¼Œè¿™ç§æ–¹æ³•éš¾ä»¥åšåˆ°å®Œç¾çš„é¢„å…ˆåˆ’åˆ†ï¼Œå› æ­¤å®¹æ˜“äº§ç”Ÿç»„è£…é”™è¯¯ã€‚</p><h3 id="Hifiasm-ç®—æ³•"><a href="#Hifiasm-ç®—æ³•" class="headerlink" title="Hifiasm ç®—æ³•"></a>Hifiasm ç®—æ³•</h3><p>åœ¨æœ¬ç ”ç©¶ä¸­ï¼Œç ”ç©¶äººå‘˜æå‡ºäº†ä¸€ç§å…¨æ–°çš„é’ˆå¯¹PacBio HiFi (High-Fidelity reads) æ•°æ®çš„å•å€å‹ç»„è£…ç®—æ³•hifiasmã€‚è¯¥ç®—æ³•æœ‰ä¸¤é¡¹é‡è¦åˆ›æ–°ã€‚</p><p>ç¬¬ä¸€ï¼Œæå‡ºäº†å•å€å‹æ•æ„Ÿçš„ç»„è£…æ€è·¯ï¼Œä½¿å¾—åœ¨ç»„è£…çš„å…¨è¿‡ç¨‹ä¸­èƒ½å¤Ÿæ— æŸçš„ä¿ç•™å•å€å‹ä¿¡æ¯ï¼ŒåŒæ—¶ä¹Ÿæå¤§çš„æå‡äº†å¯¹åŸºå› ç»„é«˜é‡å¤å’Œå¤æ‚åŒºåŸŸçš„è§£æèƒ½åŠ›ã€‚</p><p>ç¬¬äºŒï¼Œæå‡ºäº†Graph-binningçš„åˆ†å‹ç­–ç•¥ï¼Œå…¶åˆ©ç”¨ç»„è£…å›¾çš„ç»“æ„ä¿¡æ¯å¯¹å…¨å±€åˆ†å‹ç»“æœè¿›è¡Œæ ¡æ­£ï¼Œä»è€Œæå¤§åœ°æé«˜äº†å•å€å‹ç»„è£…çš„è´¨é‡ã€‚Graph-binningä¸å¯¹å¾…ç»„è£…çš„æµ‹åºè¯»æ®µè¿›è¡Œé¢„å…ˆå…¨å±€åˆ’åˆ†ï¼Œå› æ­¤èƒ½å¤Ÿå…‹æœåˆ’åˆ†é”™è¯¯å¸¦æ¥ç»„è£…é—®é¢˜ã€‚</p><h3 id="ç»„è£…ç»“æœ"><a href="#ç»„è£…ç»“æœ" class="headerlink" title="ç»„è£…ç»“æœ"></a>ç»„è£…ç»“æœ</h3><p>ç ”ç©¶äººå‘˜åœ¨ä¸åŒçš„æ•°æ®é›†ä¸Šæµ‹è¯•äº†hifiasmç®—æ³•ã€‚å¯¹äºä¸åŒå¤§å°ï¼Œä¸åŒæ‚åˆåº¦å’Œä¸åŒå•å€å‹æ•°é‡çš„åŠ¨ç‰©å’Œæ¤ç‰©åŸºå› ç»„ï¼Œhifiasmèƒ½å¤Ÿäº§ç”Ÿè´¨é‡æœ€é«˜çš„ç»„è£…ç»“æœã€‚å°¤å…¶å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œhifiasmä»…ç”¨ä¸‰å¤©æ—¶é—´ï¼Œå°±å®Œæˆ27Gbè¶…å¤§åŠ å·çº¢æ‰åŸºå› ç»„çš„ç»„è£…ï¼Œå¹¶ä¸”ç»„è£…ç»“æœçš„è¿ç»­æ€§7å€äºå…¶ä»–ç®—æ³•ã€‚</p><p>å¯¹äºäººç±»åŸºå› ç»„ï¼Œhifiasmä¹Ÿèƒ½å–å¾—æœ€å¥½çš„æ•ˆæœã€‚ç›¸æ¯”äºç°æœ‰ç®—æ³•ï¼Œhifiasmæ‰€äº§ç”Ÿçš„ç»„è£…ç»“æœè¿ç»­æ€§æœ€é«˜ï¼ŒåŒæ—¶ä¹Ÿæ­£ç¡®è§£æäº†æœ€å¤šçš„å¤æ‚å’Œé«˜é‡å¤åŒºåŸŸï¼Œå¦‚MHC (ä¸»è¦ç»„ç»‡ç›¸å®¹æ€§å¤åˆä½“)å’Œcentromere (ç€ä¸ç«¯ç²’)ã€‚å°¤å…¶å¯¹äºäººç±»äºŒå€ä½“æ ·æœ¬HG002å’ŒHG00733ï¼Œhifiasmäº§ç”Ÿçš„ç»„è£…ç»“æœçš„è¿ç»­æ€§3å€äºå…¶ä»–ç®—æ³•ï¼Œå¹¶æˆåŠŸä¿ç•™äº†æœ€å¤šçš„å˜å¼‚ä¿¡æ¯ã€‚</p><p><a href="http://www.evolution.ynu.edu.cn/info/1016/1208.htm">http://www.evolution.ynu.edu.cn/info/1016/1208.htm</a></p>]]></content>
    
    
    <categories>
      
      <category>Software</category>
      
    </categories>
    
    
    <tags>
      
      <tag>assembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ATAC-seq-2ã€‘ã€Harvard FAS Informaticsã€‘</title>
    <link href="/GeekFocus/2021/10/14/2021-10-30-ATAC-seq-2-harvard/"/>
    <url>/GeekFocus/2021/10/14/2021-10-30-ATAC-seq-2-harvard/</url>
    
    <content type="html"><![CDATA[<h2 id="ATAC-seqæ•°æ®è´¨é‡è¯„ä¼°æ³¨æ„"><a href="#ATAC-seqæ•°æ®è´¨é‡è¯„ä¼°æ³¨æ„" class="headerlink" title="ATAC-seqæ•°æ®è´¨é‡è¯„ä¼°æ³¨æ„"></a>ATAC-seqæ•°æ®è´¨é‡è¯„ä¼°æ³¨æ„</h2><span id="more"></span><p><code>ENCODE</code>çš„ATACseq<a href="https://www.encodeproject.org/atac-seq/">æ•°æ®æ ‡å‡†</a>ã€‚</p><h3 id="Uniform-Processing-Pipeline-Restrictions"><a href="#Uniform-Processing-Pipeline-Restrictions" class="headerlink" title="Uniform Processing Pipeline Restrictions"></a>Uniform Processing Pipeline Restrictions</h3><ul><li>The <code>read length</code> prior to any trimming should be a minimum of <code>45 base pairs</code>.</li><li>Sequencing may be <code>paired</code>- or <code>single</code>-ended, <code>sequencing type</code> is specified and <code>paired sequences</code> are indicated.</li><li>All <code>Illumina platforms</code> are supported for use in the uniform pipeline, though <code>data from different platforms should be processed separately</code>; colorspace (<code>SOLiD</code>) reads are <code>not</code> supported. </li><li><code>Barcodes</code>, if present in the fastq, must be <code>indicated</code>.</li><li><code>Library insert size</code> range must be <code>indicated</code>. <h3 id="Current-Standards"><a href="#Current-Standards" class="headerlink" title="Current Standards"></a>Current Standards</h3></li></ul><ol><li>å¿…é¡»æœ‰ä¸¤æ¬¡æˆ–æ›´å¤šæ¬¡<code>ç”Ÿç‰©å­¦é‡å¤</code>ï¼ˆç¨€æœ‰æ ·æœ¬ä¹Ÿå¿…é¡»åšä¸¤æ¬¡<code>æŠ€æœ¯é‡å¤</code>ï¼‰</li><li>æ¯æ¬¡é‡å¤è¦æœ‰25millionéå†—ä½™ï¼Œéçº¿ç²’ä½“ï¼Œèƒ½å¤Ÿå›å¸–çš„fragmentï¼ˆå•ç«¯25 million readsï¼Œ<code>åŒç«¯50 million reads</code>&#x3D;25 million fragmentï¼‰</li><li>å›å¸–ç‡&gt;95%, &gt;80%å¯æ¥å—ã€‚</li><li>ç”¨<code>IDR(Irreproducible Discovery Rate)</code>è®¡ç®—é‡å¤ä¸€è‡´æ€§ï¼Œrescueå’Œself consisty ratios éƒ½&gt;2</li><li>ç”¨ä»¥ä¸‹æŒ‡æ ‡æ§åˆ¶PCRæ‰©å¢å¯¹æ–‡åº“å¤æ‚æ€§çš„å½±å“ï¼š <code>Non-Redundant Fraction (NRF)</code> and PCR Bottlenecking Coefficients 1 and 2, or PBC1 and PBC2ï¼šNRF&gt;0.9, PBC1&gt;0.9, PBC2&gt;3</li><li>peakæ–‡ä»¶å¿…é¡»æ»¡è¶³å¦‚ä¸‹è¦æ±‚ï¼š<blockquote><p>æ¯ä¸ªé‡å¤peakæ•°&gt;150000ï¼Œ&gt;100000å¯æ¥å—ï¼ˆENCODEçš„ATAC-seqçš„peak fileæ²¡æ³•ç”¨ï¼‰<br>IDR peak&gt;70000,&gt;50000å¯æ¥å—<br>è¦å­˜åœ¨æ— æ ¸å°ä½“åŒºNFR<br>å­˜åœ¨å•æ ¸å°ä½“å³°ï¼Œå¥½çš„ATACseqæ•°æ®åº”åŒ…å«æ ¸å°ä½“ï¼Œæ—¢èƒ½çœ‹å¼€æ”¾æŸ“è‰²è´¨ï¼Œåˆèƒ½çœ‹æ ¸å°ä½“</p></blockquote></li><li>The fraction of reads in called peak regions(FRip score)&gt;0.3,&gt;0.2 å¯ä»¥æ¥å—ã€‚å¯¹äºç¨€æœ‰æ ·æœ¬ä¸è¦æ±‚FRiPä½†TSSå¯Œé›†è¿˜æ˜¯è¦ä½œä¸ºå…³é”®çš„è¡¡é‡ä¿¡å™ªæ¯”çš„æŒ‡æ ‡ã€‚</li><li>TSSå¯Œé›†åˆ†æ•°é˜ˆå€¼ä¸å‚è€ƒåŸºå› ç»„ç›¸å…³ã€‚</li></ol><h2 id="ATACseq-ä¸»å¹²åˆ†ææµç¨‹"><a href="#ATACseq-ä¸»å¹²åˆ†ææµç¨‹" class="headerlink" title="ATACseq ä¸»å¹²åˆ†ææµç¨‹"></a>ATACseq ä¸»å¹²åˆ†ææµç¨‹</h2><p>referenceï¼š<br><strong>1.æ–‡ç« </strong>ï¼š<a href="https://peerj.com/articles/4040/">https://peerj.com/articles/4040/</a><br><strong>2.CHIPseqè¯¾ç¨‹</strong>ï¼š<a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons">https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons</a><br><strong>3.Harvard FAS Informatics - ATAC-seq Guidelines</strong>ï¼š<a href="https://informatics.fas.harvard.edu/atac-seq-guidelines.html">https://informatics.fas.harvard.edu/atac-seq-guidelines.html</a></p><h2 id="Harvard-FAS-Informatics-ATAC-seq-Guidelines"><a href="#Harvard-FAS-Informatics-ATAC-seq-Guidelines" class="headerlink" title="Harvard FAS Informatics - ATAC-seq Guidelines"></a><a href="https://informatics.fas.harvard.edu/atac-seq-guidelines.html">Harvard FAS Informatics - ATAC-seq Guidelines</a></h2><h3 id="Experimental-design"><a href="#Experimental-design" class="headerlink" title="Experimental design"></a>Experimental design</h3><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4374986/">Detailed protocol</a></p><ul><li>Replicates</li><li>Controlsï¼šä¸€èˆ¬<code>ä¸è®¾ç½®å¯¹ç…§</code>ã€‚ä½œç”¨æœ‰é™ï¼Œè´¹ç”¨ã€‚æ²¡æœ‰è½¬åº§é…¶å¤„ç†çš„æ ·æœ¬æµ‹åº</li><li>PCR amplificationï¼š<code>å°½å¯èƒ½å°‘</code>åœ°ä½¿ç”¨<code>PCRå¾ªç¯</code>æ¥æ‰©å¢æ ·æœ¬ï¼Œå‡å°‘å¹²æ‰°</li><li>Sequencing depthï¼šæœ€ä½³æµ‹åºæ·±åº¦å–å†³äº<code>å‚è€ƒåŸºå› ç»„çš„å¤§å°</code>å’Œ<code>é¢„æœŸæŸ“è‰²è´¨çš„å¼€æ”¾ç¨‹åº¦</code>ã€‚äººç±»æ ·æœ¬çš„ç ”ç©¶æ¨èæ¯ä¸ªæ ·æœ¬è¶…è¿‡5000ä¸‡ä¸ªreadsã€‚</li><li>Sequencing modeï¼š(1) ATACseqæ¨èä½¿ç”¨paired-endã€‚paired-end sequencing, helps to <code>reduce these alignment ambiguities</code>. (2) we are interested in <code>knowing both ends of the DNA fragments generated by the assay</code>, since the ends indicate where the transposase inserted. (3) <strong><code>PCR duplicates are identified more accurately</code></strong>.  PCR duplicates are <code>artifacts of the procedure</code>, and they should be removed as part of the analysis pipeline . <code>Computational programs that remove PCR duplicates typically identify duplicates based on comparing ends of aligned reads</code>. With <strong><code>single-end reads</code></strong>, there is <code>only one position to compare</code>, and so any <code>reads whose 5&#39; ends match are considered duplicates</code>. Thus, <code>many false positives</code> may result, and perfectly <code>good reads are removed</code> from further analysis. <strong><code>Paired-end sequencing</code></strong>, <code>both ends of the original DNA fragments are defined</code>. <code>To be declared a duplicate, both ends of one fragment need to match both ends of another fragment</code>, which is far <code>less likely to occur by chance</code>. Therefore, paired-end sequencing leads to <code>fewer false positives</code>.</li><li>Mitochondria: ä¼—æ‰€å‘¨çŸ¥ATAC-seqæ•°æ®é€šå¸¸åŒ…å«å¾ˆå¤§æ¯”ä¾‹çš„<code>æ¥è‡ªçº¿ç²’ä½“DNAçš„reads</code>ï¼ˆ<em>çº¿ç²’ä½“DNAæ˜¯è£¸éœ²çš„ï¼Œä¹Ÿå¯ä»¥è¢«Tn5é…¶è¯†åˆ«åˆ‡å‰²ï¼Œæ¤ç‰©å¶ç»¿ä½“</em>ï¼‰ã€‚çº¿ç²’ä½“åŸºå› ç»„ä¸­æ²¡æœ‰ATAC-seqæ„Ÿå…´è¶£çš„å³°ï¼Œè¿™äº›readsåœ¨è®¡ç®—ä¸­è¢«ä¸¢å¼ƒï¼Œæµªè´¹æµ‹åºèµ„æºã€‚å¯åœ¨æµ‹åºå‰ä½¿ç”¨æ´—æ¶¤å‰‚<a href="https://www.nature.com/articles/nmeth.4396">å»é™¤æ ·æœ¬ä¸­çš„çº¿ç²’ä½“</a>ã€‚</li></ul><h3 id="Quality-control"><a href="#Quality-control" class="headerlink" title="Quality control"></a>Quality control</h3><h4 id="FastQC"><a href="#FastQC" class="headerlink" title="FastQC"></a>FastQC</h4><p>Process a file of <code>20 million reads</code> in about <code>5 minutes</code> with less than <code>250MB memory</code> used. Quality scores, GC levels, PCR duplicates, and adapter content.</p><h4 id="Adapter-removal"><a href="#Adapter-removal" class="headerlink" title="Adapter removal"></a>Adapter removal</h4><p>For reads derived from <code>short DNA fragments</code>, the <code>3&#39; ends may contain portions of the Illumina sequencing adapter</code>.  </p><h5 id="Cutadapt"><a href="#Cutadapt" class="headerlink" title="Cutadapt"></a><a href="https://cutadapt.readthedocs.io/en/stable/guide.html">Cutadapt</a></h5><h5 id="NGmerge"><a href="#NGmerge" class="headerlink" title="NGmerge"></a><a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-018-2579-2">NGmerge</a></h5><p>Unlike cutadapt, NGmerge <code>does not require</code> that the <code>adapter sequences</code> be provided, <code>nor</code> does it <code>require a parameter for the minimum length of adapter to match</code> (in fact, it <code>does not perform adapter matching</code> at all).For input files of <code>20 million paired reads</code>, NGmerge should run in <code>less than one hour on a single core</code>, with minimal memory usage.<br><img src="https://img-blog.csdnimg.cn/e2669cfa1a184ec2b7026fe528f9c97a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p><h5 id="Just-adapter-removal"><a href="#Just-adapter-removal" class="headerlink" title="Just adapter removal"></a>Just adapter removal</h5><p>Other than adapter removal, we <code>do not recommend any trimming of the reads.</code> Such adjustments can complicate later steps, such as the identification of PCR duplicates.</p><h3 id="Alignment"><a href="#Alignment" class="headerlink" title="Alignment"></a>Alignment</h3><p>Two of the most popular alignment program are BWA and <code>Bowtie2</code>.</p><h4 id="Genome-indexing"><a href="#Genome-indexing" class="headerlink" title="Genome indexing"></a>Genome indexing</h4><p>For many model organisms, the genome and pre-built reference indexes are available from <a href="https://support.illumina.com/sequencing/sequencing_software/igenome.html">iGenomes</a>.<br>Otherwise, Bowtie2 indexes are made from a FASTA genome file using the program <code>bowtie2-build</code>:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">bowtie2-build  <span class="hljs-tag">&lt;<span class="hljs-name">genome.fa</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">genomeIndexName</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="Alignment-1"><a href="#Alignment-1" class="headerlink" title="Alignment"></a>Alignment</h4><p><a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml">Bowtie2 parameters</a>. Here are a few that <code>may benefit the alignment of an ATAC-seq dataset</code> :</p><p><code>-X &lt;int&gt;</code> : Maximum DNA fragment length (<code>default 500bp</code>). If you anticipate that you may have DNA fragments <code>longer than</code> the default value, you should <code>increase</code> this parameter accordingly; otherwise, alignments from such fragments are considered not properly paired (see Fig. 3B below).<br><code>--very-sensitive</code> : Bowtie2 has a number of alignment and effort parameters that interact in complex (and sometimes unexpected) ways. Preset collections of these parameters are provided for convenience; the default is â€“sensitive, but <code>better alignment results</code> are frequently achieved with â€“very-sensitive.<br><code>-k &lt;int&gt;</code> : Maximum number of alignments to report per read. By default, Bowtie2 reports at most one alignment per read, and if multiple equivalent alignments exist, it chooses one randomly.<br><code>-p &lt;int&gt;</code> : Number of <code>cores</code> on which to run</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vim">bowtie2  --very-sensitive  -<span class="hljs-keyword">k</span> <span class="hljs-number">10</span>  -<span class="hljs-keyword">x</span> <span class="hljs-symbol">&lt;genomeIndexName&gt;</span>  -<span class="hljs-number">1</span> <span class="hljs-symbol">&lt;name&gt;</span>_1.fastq.gz  -<span class="hljs-number">2</span> <span class="hljs-symbol">&lt;name&gt;</span>_2.fastq.gz  \<br>  |  samtools <span class="hljs-keyword">view</span>  -<span class="hljs-keyword">u</span>  -  \<br>  |  samtools <span class="hljs-keyword">sort</span>  -n  -<span class="hljs-keyword">o</span> <span class="hljs-symbol">&lt;BAM&gt;</span>  -<br></code></pre></td></tr></table></figure><ul><li>For input files of <code>20 million</code> paired reads, this command takes around <code>five hours</code> on Cannon(1 core too slow). One could specify eight cores for Bowtie2 with <code>-p 8</code> and adjust the request in the <code>SLURM script</code> to <code>#SBATCH -n 10</code> (that is, <code>eight</code> cores for <code>Bowtie2</code> and <code>one each</code> for <code>SAMtools view</code> and <code>sort</code>). </li><li>Bowtie2 also provides (via stderr) a summary of the mapping results, separated according to uniqueness and alignment type.</li></ul><p><img src="https://img-blog.csdnimg.cn/9f961cf3106f4c99b6e85bd1c3f6e373.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"><br> Alignment types for paired-end reads. <strong>A</strong>: Properly paired alignments (â€œ<code>concordant</code>â€œ) have the reads <code>aligned in opposite orientations</code> on the <code>same reference</code> sequence (chromosome). The reads <code>may overlap</code> to some extent (bottom). <strong>B</strong>: A read alignment (for <code>R1</code>) can be <code>unpaired</code> for several reasons: if the readâ€™s mate (<code>R2</code>) is <code>unaligned</code> (<code>upper left</code>), <code>aligns to a different chromosome</code> (<code>upper right</code>), aligns in the <code>incorrect orientation</code> (<code>middle</code> cases), or aligns in the correct orientation but at an <code>invalid distance</code> (<code>bottom</code>). In all cases except the upper left, the R2 read alignment is also unpaired, and the read pair align discordantly (though Bowtie2 also requires uniqueness for such alignments to be counted as discordant).</p><p>Generich ç‰ˆæœ¬</p><h3 id="Peak-calling"><a href="#Peak-calling" class="headerlink" title="Peak calling"></a>Peak calling</h3><h4 id="æ¨èæ–°çš„Generich"><a href="#æ¨èæ–°çš„Generich" class="headerlink" title="æ¨èæ–°çš„Generich???"></a>æ¨èæ–°çš„<a href="https://github.com/jsh58/Genrich"><code>Generich</code></a>???</h4><p>Genrich was designed to be able to <code>run all of the post-alignment steps</code> through <code>peak-calling with one command</code>. It also possesses a few <code>novel features</code>. Consider the following attributes:</p><ul><li><strong>Removal of mitochondrial reads</strong>. Genrich <code>disregards all alignments to the mitochondrial</code> chromosome with <code>-e chrM</code>.</li><li><strong>Removal of PCR duplicates</strong>. Genrich follows a <code>systematic procedure</code> to <code>remove PCR duplicates</code> with <code>-r</code>. Note that this evaluation <code>takes into account multimapping reads</code> (see next), which is <code>not provided by other alignment-based duplicate-removal programs</code>, such as <code>Picard&#39;s MarkDuplicates</code>.<br><strong>Analysis of multimapping reads</strong>. é‡å¤åŒºåŸŸå¤šçš„åŸºå› ç»„å¯èƒ½å¯¼è‡´éå”¯ä¸€mappingã€‚ Non-uniquely aligned reads can be removed by filtering based on MAPQ scores with <code>samtools</code>, but this effectively renders certain genomic regions inaccessible to the assay. With Genrich, <code>reads with multiple alignments are analyzed</code> by adding a fractional count to each location. Genrichâ€™s <code>statistical model</code> accommodates these values.<br>Along these same lines, Genrich considers the entire reference genome to be part of the assay. If there are chromosomes or genomic regions that should be excluded from analysis, these can be specified by <code>-e or -E</code>, and Genrich will adjust the <code>genome length calculation</code> accordingly. There is no need to <code>guesstimate an &quot;effective&quot; genome size</code> like with MACS2.<br><strong>Analysis of multiple replicates</strong>. When alignment files for multiple replicates are provided to Genrich, it <code>calls peaks for the replicates collectively</code>. <code>No more IDR</code>. Done.<br><strong>Interpretation of alignments suitable for ATAC-seq</strong>. Genrich provides an ATAC-seq analysis mode (-j) in which, rather than inferring the full fragments from the alignments, intervals are interpreted that are centered on transposase cut sites (the ends of each DNA fragment). Only properly paired alignments are analyzed by default, but there is an option to consider unpaired alignments as well (-y) (Fig. 4).</li></ul><p><img src="https://img-blog.csdnimg.cn/abb30e7406834c91b7e456ff14e23742.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p><ul><li>Our previous recommendation was to run <code>MACS2</code> with <code>-f BAMPE</code>, which is similar to the <code>default analysis mode of Genrich</code> (<strong>inferring full fragments, rather than cut site intervals</strong>). Others have attempted to interpret cut site intervals with MACS2 by using the <code>--shif</code>t and <code>--extsize</code> arguments, but these arguments are ignored in <code>BAMPE</code> mode. They do work in the default (<code>BAM</code>) mode, but then, with paired-end reads, <code>most of the alignments are automatically discarded</code> (half of the properly paired alignments and all of the unpaired alignments; secondary alignments are never considered). Is it worse to interpret full fragments that may be less informative biologically, or to disregard more than half of the sequence data? A complicated question. The correct answer is: <strong>use Genrich.</strong><h4 id="Genrich"><a href="#Genrich" class="headerlink" title="Genrich"></a>Genrich</h4><strong>most important parameters and options of Genrich for analyzing ATAC-seqï¼š</strong></li></ul><p><code>-j</code> : ATAC-seq mode (<strong>must</strong> be specified)<br><code>-d &lt;int&gt;</code> : Expand cut sites to the given length (default 100bp)<br><code>-y</code> : Analyze <strong>unpaired</strong> alignments<br><code>-r</code> : Remove PCR duplicates<br><code>-e &lt;arg&gt;</code> : Chromosomes (reference sequences) to exclude. Can be a comma-separated list, e.g. <code>-e chrM,chrY</code>.<br><code>-E &lt;file&gt;</code> : Input BED file(s) of genomic regions to exclude, such as â€˜Nâ€™ homopolymers or high mappability regions<br><code>-q &lt;float&gt;</code> : Maximum q-value (FDR-adjusted p-value) for peak calling (default 0.05). An unadjusted p-value threshold can be used instead with <code>-p &lt;float&gt;</code>.<br><code>-a &lt;float&gt;</code> : Minimum area under the curve (total significance) for a peak (default 20.0). <code>Increasing</code> this value results in <code>fewer</code> but <code>higher confidence</code> peaks.<br><code>-v</code> : Verbose mode</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">Genrich  -t <span class="hljs-tag">&lt;<span class="hljs-name">BAM</span>&gt;</span>  -o <span class="hljs-tag">&lt;<span class="hljs-name">OUT</span>&gt;</span>  -j  -y  -r  -e chrM  -v<br></code></pre></td></tr></table></figure><ul><li>å¯¹äºé‡å¤data,  <code>-t &lt;BAM1&gt;,&lt;BAM2&gt;</code>.</li><li>The output file produced by Genrich is in <a href="https://genome.ucsc.edu/FAQ/FAQformat.html#format12"><code>ENCODE narrowPeak format</code></a>, listing the genomic coordinates of each peak called and various statistics.</li><li>Speedï¼š a single BAM containing <code>146.3 million alignments</code> was analyzed by Genrich in <code>10.5min</code> with <code>17.1GB of memory</code> . In general, input BAM(s) of more alignments take longer to analyze, but the memory usage should not increase greatly. Note that <code>Genrich is not multithreaded</code>, so it runs on a single core only.</li><li>Those who wish to explore the results of varying the <code>peak-calling parameters (-q/-p, -a, -l, -g)</code> should consider having Genrich produce a log file when it parses the SAM&#x2F;BAM files (for example, with <code>-f &lt;LOG&gt;</code> added to the above command). Then, Genrich can call peaks directly from the log file with the <code>-P</code> optionï¼ˆè°ƒå‚æ•°ä½¿ç”¨æ­¤æ³•èŠ‚çœå†…å­˜å’Œæ—¶é—´ï¼‰:</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Genrich</span>  -P  -f &lt;LOG&gt;  -o &lt;OUT2&gt;  -p <span class="hljs-number">0</span>.<span class="hljs-number">01</span>  -a <span class="hljs-number">200</span>  -v<br></code></pre></td></tr></table></figure><h3 id="NEXT-Steps"><a href="#NEXT-Steps" class="headerlink" title="NEXT Steps"></a>NEXT Steps</h3><h4 id="Visualization"><a href="#Visualization" class="headerlink" title="Visualization"></a>Visualization</h4><p>For ATAC-seq in model organisms, the <code>peak file produced by Genrich</code> can be <code>uploaded</code> directly to the <a href="https://genome.ucsc.edu/cgi-bin/hgCustom">UCSC genome browser</a>. Add header.</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elm"><span class="hljs-title">track</span> <span class="hljs-keyword">type</span>=narrowPeak<br></code></pre></td></tr></table></figure><p>An alternative visualization tool is the <a href="http://software.broadinstitute.org/software/igv/">Integrative Genomics Viewer (IGV)</a>. Peak files can be loaded directly (File â†’ Load from File). <strong>Viewing BAM files with IGV requires that they be sorted by coordinate and indexed</strong> using <a href="http://www.htslib.org/doc/samtools.html">SAMtools</a>. However, the BAMs show the read alignments, <code>not the full fragments generated by the ATAC</code> <code>nor the cut site intervals</code> analyzed by Genrich. To view the intervals, one can use the optional output <code>BED file</code> produced by Genrich with <code>-b</code>.</p><h4 id="Comparing-peak-files"><a href="#Comparing-peak-files" class="headerlink" title="Comparing peak files"></a>Comparing peak files</h4><p>Determining genomic regions that are <code>common or different to a set of peak files</code> is best accomplished with <a href="http://bedtools.readthedocs.io/en/latest/index.html">BEDTools</a>, a suite of software tools that enables â€œgenome arithmetic.â€<br>For example, <a href="http://bedtools.readthedocs.io/en/latest/content/tools/intersect.html">bedtools intersect</a> determines regions that are <strong><code>common</code></strong> to two peak files. Finding <strong><code>differences</code></strong> between two peak files, such as control vs. experimental groups, is accomplished via <a href="http://bedtools.readthedocs.io/en/latest/content/tools/subtract.html">bedtools subtract</a>.</p><h4 id="Annotation"><a href="#Annotation" class="headerlink" title="Annotation"></a>Annotation</h4><p>It is helpful to know <code>what genomic features are near the peaks</code> called by Genrich. One program that is commonly used to annotate peaks is <a href="https://bioconductor.org/packages/release/bioc/html/ChIPseeker.html">ChIPseeker</a>. ChIPseeker was originally designed to be used in the analysis of ChIP-seq, but it works just <code>as well with ATAC-seq.</code><br>ChIPseeker <strong>requires</strong> that the <code>genome of interest be annotated with locations of genes and other features</code>. The <a href="https://bioconductor.org/packages/release/bioc/vignettes/ChIPseeker/inst/doc/ChIPseeker.html">ChIPseeker user guide</a> is extremely helpful in using this R&#x2F;Bioconductor package.</p><h4 id="Motif-finding"><a href="#Motif-finding" class="headerlink" title="Motif finding"></a>Motif finding</h4><p><a href="http://homer.ucsd.edu/homer/introduction/basics.html">HOMER</a> is a suite of software designed for <a href="http://homer.ucsd.edu/homer/ngs/peakMotifs.html">motif discovery</a>. It takes a <code>peak file as input</code> and <code>checks for the enrichment</code> of both <code>known sequence motifs</code> and <code>de novo motifs</code>.</p><p>MACS2ç‰ˆæœ¬</p><h4 id="Alignmentï¼ˆsameï¼‰"><a href="#Alignmentï¼ˆsameï¼‰" class="headerlink" title="Alignmentï¼ˆsameï¼‰"></a>Alignmentï¼ˆsameï¼‰</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vim">bowtie2  --very-sensitive  -<span class="hljs-keyword">x</span> <span class="hljs-symbol">&lt;genomeIndexName&gt;</span>  -<span class="hljs-number">1</span> <span class="hljs-symbol">&lt;name&gt;</span>_1.fastq.gz  -<span class="hljs-number">2</span> <span class="hljs-symbol">&lt;name&gt;</span>_2.fastq.gz \<br> |  samtools <span class="hljs-keyword">view</span> -<span class="hljs-keyword">u</span> -  \<br> |  samtools <span class="hljs-keyword">sort</span> -  &gt;  <span class="hljs-symbol">&lt;BAM&gt;</span><br></code></pre></td></tr></table></figure><h4 id="Alignment-adjustments"><a href="#Alignment-adjustments" class="headerlink" title="Alignment adjustments"></a>Alignment adjustments</h4><h5 id="Mitochondrial-reads"><a href="#Mitochondrial-reads" class="headerlink" title="Mitochondrial reads"></a>Mitochondrial reads</h5><ul><li>ATAC-seq datasets usually contain a large percentage of reads that are derived from mitochondrial DNA (<a href="http://seqanswers.com/forums/showthread.php?t=35318">discussion</a>). Using <a href="https://www.nature.com/articles/s41598-017-02547-w">CRISPR to reduce mitochondrial contamination</a>. Or recently <a href="https://www.nature.com/articles/nmeth.4396">Omni-ATAC method</a> uses detergents[æ´—æ¶¤å‰‚] to remove mitochondria and is likely to be more accessible for most researchers ( <a href="https://www.biorxiv.org/content/10.1101/496521v1">bad computational workflow</a>).</li><li>Method 1 : <strong>Remove the mitochondrial genome from the reference genome before aligning the reads</strong>. In human&#x2F;mouse genome builds, the mitochondrial genome is labeled â€˜<code>chrM</code>â€˜. That sequence can be deleted from the reference prior to building the genome indexes. The downside of this approach is that the alignment numbers will look much worse; all of the mitochondrial reads will count as unaligned. [æ¤ç‰©ï¼Ÿ]</li><li>Method 2 : <strong>Remove the mitochondrial reads after alignment</strong>. A python script, creatively named removeChrom, is available in the ATAC-seq module to accomplish this. For example, to remove all â€˜chrMâ€™ reads from a BAM file, one would run this:</li></ul><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">samtools <span class="hljs-keyword">view</span> -h  <span class="hljs-symbol">&lt;inBAM&gt;</span>  |  removeChrom - - chrM  |  samtools <span class="hljs-keyword">view</span> -<span class="hljs-keyword">b</span> -  &gt;  <span class="hljs-symbol">&lt;outBAM&gt;</span><br></code></pre></td></tr></table></figure><h5 id="PCR-duplicates"><a href="#PCR-duplicates" class="headerlink" title="PCR duplicates"></a>PCR duplicates</h5><p> Picardâ€™s <a href="http://broadinstitute.github.io/picard/command-line-overview.html#MarkDuplicates">MarkDuplicates</a>. The output file specified by <code>M=</code> lists counts of alignments analyzed and duplicates identified.</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">java -jar <span class="hljs-variable">$PICARD_TOOLS_HOME</span>/picard.jar MarkDuplicates <span class="hljs-attribute">I</span>=&lt;inBAM&gt; <span class="hljs-attribute">O</span>=&lt;outBAM&gt; <span class="hljs-attribute">M</span>=dups.txt <span class="hljs-attribute">REMOVE_DUPLICATES</span>=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><h5 id="Non-unique-alignments"><a href="#Non-unique-alignments" class="headerlink" title="Non-unique alignments"></a>Non-unique alignments</h5><p>é‡å¤åŒºåŸŸå¤šçš„å‚è€ƒåºåˆ—å¯èƒ½å¯¼è‡´readså¤šå¤„mapping. ç”¨samtools viewçš„-q <code>å»é™¤éå”¯ä¸€æ¯”å¯¹</code>. For reads with multiple alignments, <code>Bowtie2</code> (or <code>BWA</code>) will <code>report only one alignment</code> (by <code>default</code>) and will assign it a low mapping quality (MAPQ) score, which is defined as -10 * log10Pr{mapping position is wrong}. To eliminate alignments with <code>MAPQ &lt; 10</code> (i.e., where <code>Bowtie2</code> has determined <code>Pr&#123;mapping position is wrong&#125; &gt; 0.1</code>), one would run the following:</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">samtools <span class="hljs-keyword">view</span> -<span class="hljs-keyword">b</span>  -q <span class="hljs-number">10</span>  <span class="hljs-symbol">&lt;inBAM&gt;</span>  &gt;  <span class="hljs-symbol">&lt;outBAM&gt;</span><br></code></pre></td></tr></table></figure><h4 id="Peak-calling-1"><a href="#Peak-calling-1" class="headerlink" title="Peak calling"></a>Peak calling</h4><ul><li>Model-based Analysis of ChIP-Seq (<a href="https://github.com/taoliu/MACS">MACS2</a>) is a program for detecting regions of <code>genomic enrichment</code>. Though designed for ChIP-seq, it works just <code>as well on ATAC-seq and other genome-wide enrichment assays that have narrow peaks</code>. The main program in MACS2 is <code>callpeak</code>, and its options are described below. (Note that the latest version of MACS2 on Odyssey (v2.1.2_dev) is different from the updated official MACS2 release (v2.1.2), although the latter does incorporate many of the bug fixes made in the Odyssey <code>versionï¼Ÿ</code>.)</li><li>It is important to remember that the <code>read alignments indicate only a portion of the DNA fragments generated by the ATACï¼Ÿ</code>. Therefore, one must consider how one wants MACS2 to interpret the alignments.<h5 id="Alignments-to-analyze"><a href="#Alignments-to-analyze" class="headerlink" title="Alignments to analyze"></a>Alignments to analyze</h5></li><li>alignmentsåˆ†ä¸ºä¸¤ç±»ï¼šâ€<strong>properly paired</strong>â€œ and â€œ<strong>singletons</strong>â€œ ã€‚<code>-f</code> é€‰æ‹©å…¶ç±»å‹ã€‚</li><li><strong>Analyze only properly paired alignments, but ignore R2 reads and treat R1 reads as singletons</strong>. This is the default option (<code>-f AUTO</code>). MACS2 creates a model of the fragment lengths and extends the 3â€™ ends of the R1 reads to the calculated average length. An alternative is to skip this model building and instead extend each read to a specified length (e.g., <code>--nomodel --extsize 300</code> for 300bp fragments). The value of the length parameter is usually determined from the average size during library preparation (the default value is 200bp if no value is specified). However, <code>neither of these approaches utilizes the value of paired-end sequencing</code>, which defines both fragment ends.</li><li><strong>Analyze only properly paired alignments with <code>-f BAMPE</code></strong>. Here, the fragments are defined by the paired alignmentsâ€™ ends, and there is <code>no modeling or artificial extension</code>. Singleton alignments are ignored. This is the <code>preferred option</code> for using only properly paired alignments.</li><li><strong>Analyze all alignments</strong>. For this approach, a python script, SAMtoBED, is available in the ATAC-seq module. This script converts the read alignments to BED intervals, treating the properly paired alignments as such and extending the singleton alignments as specified. There are <code>four options for the singletons</code>: ignore them, keep them as is, extend them to an arbitrary length (similar to the <code>--extsize</code> option of MACS2), or extend them to the average length calculated from the properly paired alignments. </li><li>Here is an example command, using the â€œextend to average lengthâ€ option (<code>-x</code>):</li></ul><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pf">samtools view -h  <span class="hljs-variable">&lt;BAM&gt;</span>  |  SAM<span class="hljs-keyword">to</span>BED  -i -  -o <span class="hljs-variable">&lt;BED&gt;</span>  -x  -v<br></code></pre></td></tr></table></figure><p>The output from SAMtoBED is a <a href="https://genome.ucsc.edu/FAQ/FAQformat.html#format1">BED file</a> that should be analyzed by MACS2 with <code>-f BEDPE</code>.<br>(Note that the BEDTools program <a href="http://bedtools.readthedocs.io/en/latest/content/tools/bamtobed.html"></a> cannot be used here, since its output is in a nonstandard BED format that MACS2 cannot analyze.)</p><ul><li>In deciding among these analysis options, it may help to consider the counts produced by Bowtie2, which indicate <code>how many alignments fall into each category</code>. For example, if most of the reads are aligned in proper pairs, it may be sufficient to use <code>option #2</code>. On the other hand, <code>option #3</code> is preferred if a substantial fraction of the reads consists of singletons.<h5 id="Other-arguments"><a href="#Other-arguments" class="headerlink" title="Other arguments"></a>Other arguments</h5></li><li>MACS2 is <code>not multithreaded</code></li></ul><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">macs2 callpeak  -t <span class="hljs-symbol">&lt;BED&gt;</span>  -<span class="hljs-keyword">f</span> BEDPE  -n NAME  -g <span class="hljs-keyword">ce</span>  --keep-dup <span class="hljs-keyword">all</span><br></code></pre></td></tr></table></figure><blockquote><p><code>-n &lt;str&gt;</code>Name of the sample. The output files  name prefix.<br><code>-g &lt;int&gt;</code>Effective genome size, the size of the organismâ€™s genome that can be analyzed (not including Ns, repetitive sequences, etc.). This will be less than the actual genome size. Parameters are provided for some model organisms, and the <code>default value is hs</code> (for Homo sapiens), which corresponds to a value of 2.7e9.<br><code>-q &lt;float&gt;</code><code>Maximum q-value</code> (FDR-adjusted p-value) for peak calling (default <code>0.05</code>). Reducing this threshold will decrease the number of peaks identified by MACS2 but increase the confidence in the called peaks.<br><code>--keep-dup &lt;arg&gt;</code>How to handle PCR duplicates (default: â€“keep-dup 1, i.e. remove all potential duplicates). If PCR duplicates have been removed by another program, such as Picardâ€™s MarkDuplicates, then specify <code>--keep-dup all</code>.<br><code>--max-gap &lt;int&gt;</code>Maximum gap between significant sites to cluster them together (default 50bp). (v2.1.2_dev only)<br><code>--min-length &lt;int&gt;</code>Minimum length of a peak (default 100bp). (v2.1.2_dev only)</p></blockquote><h5 id="Output-files"><a href="#Output-files" class="headerlink" title="Output files"></a>Output files</h5><ul><li>NAME_peaks.xls</li><li>NAME_peaks.narrowPeak</li><li>NAME_summits.bed</li><li>The most useful file is <code>NAME_peaks.narrowPeak</code>, a plain-text <code>BED</code> file that lists the <code>genomic coordinates of each peak called</code>, along with various <code>statistics</code> (fold-change, p- and q-values, etc.).</li></ul>]]></content>
    
    
    <categories>
      
      <category>NGS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>atac-seq</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ATAC-seq-1ã€‘ã€Backgroundã€‘</title>
    <link href="/GeekFocus/2021/10/11/2021-10-30-ATAC-seq-1-background/"/>
    <url>/GeekFocus/2021/10/11/2021-10-30-ATAC-seq-1-background/</url>
    
    <content type="html"><![CDATA[<h3 id="ATAC-seqæ„ä¹‰"><a href="#ATAC-seqæ„ä¹‰" class="headerlink" title="ATAC-seqæ„ä¹‰"></a>ATAC-seqæ„ä¹‰</h3><span id="more"></span><p><img src="https://img-blog.csdnimg.cn/2eb44c70d00b45bab31b0eb915e91cac.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>ä¸ºä½•åŒæ ·DNAåºåˆ—çš„ç»†èƒçš„è¡¨å‹ä¼šä¸åŒï¼Œä¸ºä½•è‚ç»†èƒæ˜¯è‚ç»†èƒï¼Œç¥ç»ç»†èƒæ˜¯ç¥ç»ç»†èƒï¼Ÿæ˜¯ä»€ä¹ˆé€ æˆäº†ä»–ä»¬ç”Ÿäº§è›‹ç™½ä¸åŒï¼Œå†³å®šè›‹ç™½ç”Ÿæˆçš„RNAä¸åŒå‘¢ï¼ŸåŸå› å¯ä»¥ç”¨<code>è¡¨è§‚é—ä¼ </code>æ¥è§£é‡Šã€‚<br><img src="https://img-blog.csdnimg.cn/9bf2e2d5d25a4e2eab27321b99b0b0b8.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_15,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>DNAè½¬å½•æˆRNAè¿‡ç¨‹å¤æ‚ï¼ŒåŒ…æ‹¬ï¼š<code>æŸ“è‰²è´¨å¯åŠæ€§</code>ï¼Œ<code>DNAä¿®é¥°</code>ï¼Œ<code>ç»„è›‹ç™½ä¿®é¥°</code>ç­‰ç­‰ï¼ˆé€‰æ‹©æ€§è¡¨è¾¾ï¼‰ã€‚</li><li><code>æŸ“è‰²è´¨å¯åŠæ€§å³DNAå¼€æ”¾åŒºåŸŸ</code>ï¼Œå°¤ä¸ºé‡è¦ã€‚<code>æ ¸å°ä½“</code>ç”±<code>8ä¸ªç»„è›‹ç™½</code>ç»„æˆå¤åˆç‰©ï¼Œæ¯ä¸ªæ ¸å°ä½“çº¦<code>147bpDNA</code>ã€‚è½¬å½•æ—¶DNAå°†ä»æ ¸å°ä½“å¤åˆç‰©æ¾å¼€ã€‚è®¸å¤šå› ç´ ï¼Œå¦‚<code>æŸ“è‰²è´¨ç»“æ„</code>ã€<code>æ ¸å°ä½“ä½ç½®</code>å’Œ<code>ç»„è›‹ç™½ä¿®é¥°</code>ï¼Œåœ¨æŸ“è‰²è´¨çš„ç»„ç»‡å’Œå¯åŠæ€§èµ·é‡è¦ä½œç”¨ã€‚è‡´å¯†æ ¸å°ä½“ç»“æ„è¢«ç ´ååï¼Œ<code>å¯åŠ¨å­ã€å¢å¼ºå­ã€ç»ç¼˜å­ã€æ²‰é»˜å­</code>ç­‰<code>é¡ºå¼è°ƒæ§å…ƒä»¶å’Œåå¼ä½œç”¨å› å­å¯ä»¥æ¥è¿‘</code>çš„ç‰¹æ€§ï¼Œå«<code>æŸ“è‰²è´¨çš„å¯åŠæ€§</code>ï¼Œä¹Ÿå«<code>æŸ“è‰²è´¨å¼€æ”¾æ€§</code>(chromatin accessibility ï¼‰ï¼Œè¿™æ®µåŒºåŸŸå«å¼€æ”¾æŸ“è‰²è´¨ï¼ˆopen chromatinï¼‰ ã€‚</li><li>ä»€ä¹ˆæ˜¯ç»„è›‹ç™½ä¿®é¥°<ul><li>å®šä¹‰ï¼šç»„è›‹ç™½åŒ…å«5ä¸ªéƒ¨åˆ†ï¼ŒæŒ‰åˆ†å­é‡å¤§å°åˆ†åˆ«ç§°ä¸º<code>H1ï¼ŒH3ï¼ŒH2Aï¼ŒH2Bå’ŒH4</code>ã€‚ç»„è›‹ç™½åœ¨ç›¸å…³é…¶ä½œç”¨ä¸‹å‘ç”Ÿ<code>ç”²åŸºåŒ–ï¼Œä¹™é…°åŒ–ï¼Œç£·é…¸åŒ–ï¼Œè…ºè‹·é…¸åŒ–ï¼Œæ³›ç´ åŒ–ï¼ŒADPæ ¸ç³–åŸºåŒ–</code>ç­‰ä¿®é¥°</li><li><code>H3Â·H4ä¹™é…°åŒ–</code>å½¢æˆ<code>å¼€æ”¾æŸ“è‰²è´¨ç»“æ„</code>ï¼Œ<code>å¢åŠ åŸºå› è¡¨è¾¾</code></li><li>ç»„è›‹ç™½<code>ç”²åŸºåŒ–</code>ä¿®é¥°å¤šå‘ç”Ÿåœ¨<code>H3H4</code>ï¼Œä¸åŸºå› <code>æŠ‘åˆ¶åŠæ¿€æ´»</code>ç›¸å…³ï¼Œå–å†³äºè¢«<code>ä¿®é¥°ä½ç½®å’Œç¨‹åº¦</code></li><li>ç»„è›‹ç™½<code>ç£·é…¸åŒ–</code>ä¿®é¥°ä¸€èˆ¬ä¸åŸºå› <code>æ´»åŒ–</code>æœ‰å…³</li><li>ç»„è›‹ç™½<code>æ³›ç´ åŒ–</code>åˆ™æ˜¯<code>å¯åŠ¨åŸºå› è¡¨è¾¾</code></li></ul></li><li>2013å¹´ç”±æ–¯å¦ç¦å¤§å­¦William J. Greenleafå’ŒHoward Y. Changå®éªŒå®¤å¼€å‘çš„ATAC-seqï¼ˆ<code>Assay</code> for <code>Transposase</code>-<code>Accessible</code> <code>Chromatin</code> with high throughput sequencingï¼‰ï¼Œä¸€ç§æ•è·æŸ“è‰²è´¨å¯åŠæ€§ï¼ˆæŸ“è‰²è´¨å¼€æ”¾æ€§ï¼‰çš„æµ‹åºæ–¹æ³•ã€‚</li><li>ATAC-seq<code>æ£€æµ‹æŸ“è‰²è´¨å¯åŠæ€§</code>ï¼Œ<code>ç¡®å®šåŸºå› è¡¨è¾¾è°ƒæ§æœºåˆ¶</code>ã€‚è¯†åˆ«<code>å¯åŠ¨å­åŒºåŸŸ</code>ã€<code>æ½œåœ¨çš„å¢å¼ºå­æˆ–æŠ‘åˆ¶å­</code>ã€‚<code>å¯åŠ¨å­</code>æ˜¯é è¿‘è½¬å½•èµ·å§‹ç‚¹(TSS)çš„DNAåŒºåŸŸã€‚åŒ…å«<code>è½¬å½•å› å­çš„ç»“åˆä½ç‚¹</code>ï¼Œè½¬å½•å› å­æ‹›å‹ŸRNAèšåˆé…¶ã€‚<code>å¢å¼ºå­</code>æ˜¯ä½äº<code>å¯åŠ¨å­ä¸‹æ¸¸æˆ–ä¸Šæ¸¸1Mb</code>çš„DNAåŒºåŸŸã€‚<code>å½“è½¬å½•å› å­ä¸å¢å¼ºå­ç»“åˆï¼Œå¹¶ä¸å¯åŠ¨å­åŒºåŸŸæ¥è§¦æ—¶ï¼Œè¯¥åŸºå› çš„è½¬å½•å¢åŠ </code>ã€‚ç›¸å<code>æŠ‘åˆ¶å­</code>ä¼š<code>å‡å°‘æˆ–æŠ‘åˆ¶åŸºå› è¡¨è¾¾</code>ã€‚</li><li>ATAC-seqçš„<code>å³°</code>å¾€å¾€æ˜¯<code>å¯åŠ¨å­</code>ï¼Œ<code>å¢å¼ºå­åºåˆ—</code>ä»¥åŠä¸€äº›<code>åå¼è°ƒæ§å› å­</code>ç»“åˆä½ç‚¹ã€‚</li><li>ä¸ºæ‰¾åˆ°å¼€æ”¾æŸ“è‰²è´¨åŒºï¼ŒåŸºå› ç»„è¢«<code>TN5è½¬åº§é…¶</code>å¤„ç†ã€‚åœ¨ATAC-Seqä¸­ï¼Œ<code>ä¿®é¥°åçš„TN5å°†ä¸NextEraæ¥å¤´ç›¸å¯¹åº”çš„DNAåºåˆ—æ’å…¥åˆ°åŸºå› ç»„çš„å¼€æ”¾åŒºåŸŸ</code>ï¼ŒåŒæ—¶ï¼ŒDNAè¢«è½¬åº§é…¶æ´»æ€§å‰ªåˆ‡ã€‚</li><li>å¼€æ”¾æŸ“è‰²è´¨çš„ç ”ç©¶æ–¹æ³•é™¤äº†ATAC-seqï¼Œè¿˜æœ‰DNase-Seqï¼ŒFAIRE-seqï¼ŒMNase-seq ç­‰ã€‚ATAC-Seq<code>æ‰€éœ€æ ·æœ¬å°‘ï¼Œå»ºåº“å¿«ï¼Œé‡å¤æ€§æ›´é«˜</code></li><li>æŠ€æœ¯ï¼šåˆ¶å¤‡ç»†èƒæ‚¬æ¶²-&gt;è£‚è§£ç»†èƒè†œï¼Œè·å–ç»†èƒæ ¸-&gt;é‡‡ç”¨Tn5è¿›è¡Œé…¶åˆ‡-&gt;å›æ”¶DNAç‰‡æ®µï¼ŒPCRæ‰©å¢å»ºåº“-&gt;é«˜é€šé‡æµ‹åº-&gt;ç”Ÿä¿¡åˆ†æ</li><li><img src="https://img-blog.csdnimg.cn/00f06cb4758b44c7a35b8c5c3ff74eda.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li><code>ATAC-seq</code>ä¸<code>Chip-seq</code> callå‡ºæ¥çš„<code>peak</code>ä»£è¡¨çš„<code>æ„ä¹‰ä¸åŒ</code>ã€‚<code>Chip-seq</code> peakæ˜¯è¢«<code>ç›®çš„è›‹ç™½ç»“åˆæ‹‰ä¸‹æ¥çš„DNA</code>ï¼Œä¸€èˆ¬åªæœ‰<code>ä¸€ä¸ªå³°</code>ï¼Œè€Œ<code>ATAC-seq</code>æ˜¯è¢«<code>Tn5è½¬åº§é…¶åˆ‡å¼€</code>ã€æ²¡æœ‰è¢«ç»„è›‹ç™½ç»“åˆã€æŸ“è‰²è´¨å¼€æ”¾çš„DNAä½ç‚¹ï¼Œ<code>å¦‚æœæ˜¯TFç»“åˆçš„åŒºåŸŸï¼Œä¸€èˆ¬ä¼šæœ‰ä¸€ä¸ªå±±è°·èˆ¬çš„å­˜åœ¨</code>ã€‚ChIP-seqå’ŒATAC-seqåœ¨TFæˆ–è€…Tn5ç»“åˆåŒºåŸŸ<code>éƒ½ä¼šå½¢æˆä¸€ä¸ªåŒå³°çš„readsç»“åˆæ¨¡å¼</code>ï¼Œä½†<code>åˆ¤æ–­peakçš„æ—¶ä¼šæœ‰ä¸åŒçš„æ ‡å‡†</code>ã€‚chip-seqæ˜¯ç”±äº<code>TFä¸€èµ·æ²‰æ·€ä¸‹æ¥çš„DNA fragmentä¸€èˆ¬ä¼šå¤§äºTFçš„ç»“åˆåŒºåŸŸ</code>ï¼Œ<code>readçš„ä½ç½®å¹¶ä¸æ˜¯çœŸå®TFç»“åˆä½ç½®</code>ï¼Œéœ€è¦<code>å‘å†…shift</code>ï¼›è€Œ<code>ATAC-seqä¸€èˆ¬æ˜¯å¾€ä¸¤è¾¹shift</code>ã€‚<br><img src="https://img-blog.csdnimg.cn/e501e5a398b34d0e8fd514fba8333cdb.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li><code>ATAC-seq</code>ä¸<code>Chip-seq</code>åº”ç”¨ä¸Šçš„åŒºåˆ«:</li><li>ATAC-Seqå¯<code>æ£€æµ‹å…¨åŸºå› ç»„DNAç»“åˆè›‹ç™½</code>ï¼Œ<code>è½¬å½•ç»“åˆä½ç‚¹</code> ï¼Œä¸€èˆ¬ç”¨äº<code>ä¸çŸ¥é“ç‰¹å®šçš„è½¬å½•å› å­</code>ï¼Œç”¨æ­¤æ–¹æ³•ä¸å…¶ä»–æ–¹æ³•ç»“åˆ<code>ç­›æŸ¥æ„Ÿå…´è¶£çš„ç‰¹å®šè°ƒæ§å› å­</code>ï¼›</li><li>ChIP-Seqæ˜¯å·²çŸ¥è½¬å½•å› å­ï¼Œæ ¹æ®<code>æ„Ÿå…´è¶£çš„è½¬å½•å› å­è®¾è®¡æŠ—ä½“</code>å»åšChIPå®éªŒ<code>å¯Œé›†ç»“åˆçš„DNAç‰‡æ®µ</code>ã€‚åœ¨æµ‹å®šè½¬å½•å› å­çš„ ChIP-seq ä¸­<code>ç‹¬æœ‰çš„å³°å¯èƒ½æ˜¯å…ˆé©±è½¬å½•å› å­</code>ï¼Œå…¶<code>å…ˆç»“åˆåˆ°å°é—­æŸ“è‰²è´¨</code>ï¼Œç„¶å<code>æ‹›å‹ŸæŸ“è‰²è´¨é‡å¡‘å› å­æˆ–å…¶ä»–è½¬å½•å› å­èµ·å§‹è½¬å½•</code>ã€‚è¿™äº›è½¬å½•å› å­ <code>ATAC-seqæ£€æµ‹ä¸åˆ°</code>ã€‚</li><li>å¾—åˆ°DNAç‰‡æ®µåï¼Œä¸ºæµ‹åºå‡†å¤‡å»ºåº“ï¼ŒåŒ…æ‹¬<code>ç”¨å®Œæ•´çš„NextEraæ¥å¤´</code>å’Œ<code>çº¯åŒ–</code>ã€<code>PCRæ‰©å¢</code>ç­‰ã€‚åŸºäºä¸Šè¿°åŸå› ï¼Œ<code>ATAC-Seqæ¨èä½¿ç”¨åŒç«¯é…å¯¹</code>çš„æ–¹æ³•ã€‚</li></ul><h3 id="ATACseqåº”ç”¨"><a href="#ATACseqåº”ç”¨" class="headerlink" title="ATACseqåº”ç”¨"></a>ATACseqåº”ç”¨</h3><ul><li><p>æŸ“è‰²è´¨<code>å¼€æ”¾æ€§å›¾è°±ç»˜åˆ¶</code>ï¼Œè¡¨è§‚åŸºå› ç»„å›¾è°±</p></li><li><p>æ‰¾<code>è°ƒæ§</code>ç”Ÿç‰©å­¦è¿‡ç¨‹çš„<code>å…³é”®è½¬å½•å› å­</code></p></li><li><p>æ‰¾<code>å“ªä¸ªè½¬å½•å› å­</code>è°ƒæ§äº†ç ”ç©¶çš„åŸºå› </p></li><li><p>æ‰¾è½¬å½•å› å­è°ƒæ§çš„<code>é¶åŸºå› </code></p></li><li><p>å¾—åˆ°<code>ä¸åŒç»„ç»‡æˆ–ä¸åŒæ¡ä»¶ä¸‹å¯¹åº”å¯åŠæ€§åŒºåŸŸ</code>ã€‚</p></li><li><p>å¾—åˆ°æ ¸å°ä½“ä½ç½®</p></li><li><p>ç”Ÿæˆè½¬å½•å› å­ç»“åˆåŒºåŸŸçš„ç‰¹å¾(footprinting)</p><h3 id="æŠ€æœ¯é™åˆ¶"><a href="#æŠ€æœ¯é™åˆ¶" class="headerlink" title="æŠ€æœ¯é™åˆ¶"></a>æŠ€æœ¯é™åˆ¶</h3></li><li><p>Tn5é€šè¿‡<code>æ’å…¥å‰ªæ–­DNA å¹¶å°†æµ‹åºæ¥å¤´è¿æ¥åˆ°å‰ªæ–­çš„ä¸¤ä¸ªDNA ç‰‡æ®µçš„æœ«ç«¯</code>ï¼Œå› æ­¤å¯¹äºä¸€ä¸ªDNA ç‰‡æ®µè€Œè¨€ï¼Œå…¶ä¸¤ç«¯çš„æ¥å¤´è¿æ¥æ˜¯éšæœºçš„ï¼Œå¯¼è‡´<code>åŒä¸€ç‰‡æ®µä¸¤ç«¯çš„æ¥å¤´æœ‰50%çš„æ¦‚ç‡æ˜¯åŒä¸€æ¥å¤´</code>ã€‚è€Œ<code>åªæœ‰è¿æ¥ä¸åŒæ¥å¤´çš„ç‰‡æ®µæ‰å¯ç”¨äºå¯Œé›†æ‰©å¢åŠæµ‹åº</code>ï¼Œå› æ­¤<code>ä¸€åŠçš„ç‰‡æ®µæ— æ³•åˆ©ç”¨</code>ï¼› </p></li><li><p><code>å¤§é‡å‰ªæ–­çš„DNA ç”±äºç‰‡æ®µè¿‡å¤§ï¼Œæ— æ³•è¿›è¡ŒPCRå¯Œé›†</code>; </p></li><li><p>Tn5 çš„<code>æ´»æ€§</code>å—ååº”æº¶æ¶²çš„ç»„æˆåŠååº”æ¡ä»¶<code>å½±å“</code>ï¼Œä»ç„¶éœ€è¦ä¼˜åŒ–ä»¥ä¾¿æé«˜å‰ªåˆ‡æ•ˆæœï¼› </p></li><li><p>ATAC-seqåœ¨<code>æ¤ç‰©ç»†èƒå­˜åœ¨ä»¥ä¸‹éš¾ç‚¹</code>ï¼š<code>ç»†èƒå£</code>ï¼Œ<code>å¶ç»¿ä½“çº¿ç²’ä½“ç­‰ç»†èƒå™¨æ±¡æŸ“</code>ï¼Œ<code>ç¼ºå°‘ç¨³å®šé—ä¼ çš„ç»†èƒç³»</code>;</p></li></ul><h3 id="ATAC-Seqã€Dnase-Seqã€MNase-Seqã€FAIRE-Seq"><a href="#ATAC-Seqã€Dnase-Seqã€MNase-Seqã€FAIRE-Seq" class="headerlink" title="ATAC-Seqã€Dnase-Seqã€MNase-Seqã€FAIRE-Seq"></a>ATAC-Seqã€Dnase-Seqã€MNase-Seqã€FAIRE-Seq</h3><ul><li>æ•´ä½“çš„åˆ†ææ€è·¯ä¸€è‡´ï¼Œ<code>æ‰¾å¯Œé›†åŒºåŸŸ</code>ï¼Œå¯¹å¯Œé›†åŒºåŸŸè¿›è¡ŒåŠŸèƒ½åˆ†æã€‚</li><li>ChIP-Seqæ˜¯<code>æ­ç¤ºç‰¹å®šè½¬å½•å› å­</code>æˆ–<code>è›‹ç™½å¤åˆç‰©</code>çš„ç»“åˆåŒºåŸŸï¼Œå®é™…æ˜¯<code>ç ”ç©¶DNAå’Œè›‹ç™½è´¨çš„ç›¸äº’ä½œç”¨</code>ï¼Œåˆ©ç”¨<code>æŠ—ä½“å°†è›‹ç™½è´¨å’ŒDNAä¸€èµ·å¯Œé›†</code>ï¼Œå¹¶å¯¹<code>å¯Œé›†çš„DNAæµ‹åº</code>ã€‚</li><li>DNase-Seqã€ATAC-Seqã€FAIRE-Seqéƒ½<code>ç ”ç©¶å¼€æ”¾æŸ“è‰²è´¨åŒºåŸŸ</code>ï¼š</li><li>DNase-Seqç”¨<code>DNase Iå†…åˆ‡é…¶è¯†åˆ«</code>å¼€æ”¾æŸ“è‰²è´¨åŒºåŸŸï¼Œ</li><li>ATAC-seqç”¨<code>Tn5è½¬åº§é…¶</code>ï¼Œéšåè¿›è¡Œ<code>å¯Œé›†æ‰©å¢</code>ï¼›</li><li>FAIRE-Seqå…ˆè¶…å£°è£‚è§£ï¼Œåç”¨é…š-æ°¯ä»¿å¯Œé›†ï¼›</li><li>MNase-Seqé‰´å®šæ ¸å°ä½“åŒºåŸŸã€‚</li></ul><p>ä¸‹å›¾æ˜¯ä¸åŒæµ‹åºæ–¹æ³•è·å–çš„å³°å½¢ï¼š</p><p><img src="https://img-blog.csdnimg.cn/aea5161044eb40e1a1cc4c1a65d63cbb.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_18,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ£€æµ‹æŸ“è‰²è´¨å¯åŠæ€§çš„æ–¹æ³•ä¸­ï¼ŒATAC-seqå°¤å…¶å—æ¬¢è¿ã€‚<br><img src="https://img-blog.csdnimg.cn/96808dfcce9446298f1d0d4cc0db6eee.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_10,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>ATAC-seqçš„ä¼˜ç‚¹ï¼š<code>Tn5è½¬åº§é…¶çš„é«˜æ´»æ€§</code>ä½¿ATAC-seqç®€å•ï¼Œçœæ—¶ï¼Œè€Œä¸”åªéœ€500-50,000ä¸ªç»†èƒã€‚çµæ•åº¦ç‰¹å¼‚æ€§ä¸DNase-seqç›¸å½“ï¼Œä¼˜äºFAIRE-seqã€‚</li></ul><h3 id="æ•´åˆåˆ†æ"><a href="#æ•´åˆåˆ†æ" class="headerlink" title="æ•´åˆåˆ†æ"></a>æ•´åˆåˆ†æ</h3><ul><li><p>ç”±äºå¼€æ”¾æŸ“è‰²è´¨æ˜¯å¤§å¤šæ•°TFç»“åˆçš„å…ˆå†³æ¡ä»¶ï¼Œå› æ­¤<code>ATAC-seqå³°é€šå¸¸ä¸TF ChIP-seqå³°é‡å ï¼Œä½†é€šå¸¸æ›´å®½</code>ã€‚å› æ­¤ï¼Œ<code>TF ChIP-seqå’ŒATAC-seqå¯ä»¥åœ¨åŒä¸€å®éªŒç³»ç»Ÿä¸­ç›¸äº’éªŒè¯</code>å½¼æ­¤çš„è´¨é‡å’Œå¯é æ€§ã€‚ </p></li><li><p>ATAC-seqä¸ histone marker ChIP-seqé›†æˆï¼Œå‘ç°ä¸æ´»è·ƒæŸ“è‰²è´¨æ ‡ H3K4me3ï¼ŒH3K4me1ï¼ŒH3K27acç­‰æ­£ç›¸å…³ï¼Œä¸ä¸æ´»è·ƒçš„æŸ“è‰²è´¨æ ‡è®° H3K27me3 è´Ÿç›¸å…³ã€‚ <code>ï¼Ÿ</code></p></li><li><p><code>ATAC-seq+RNA-seq</code>ï¼š ä¸€èˆ¬RNA-seqä¼šä¼˜å…ˆäºATAC-seqå…ˆæµ‹ï¼Œä½†<code>å·®å¼‚åŸºå› å¯Œé›†çš„åŸºå› é€šè·¯åªæ˜¯ä¸€ç§ç›¸å…³æ€§</code>ã€‚è¦åˆ†æå‡ºå…¶ä¸­è°è°ƒæ§ç›®çš„åŸºå› ï¼Œå¯é€šè¿‡<code>ATAC-seqåšmotifåˆ†æ</code>ï¼Œ<code>å¯»æ‰¾æ½œåœ¨çš„è°ƒæ§å› å­</code>ï¼Œç„¶åå†åç»­çš„<code>å®éªŒéªŒè¯</code>æˆ–è€…<code>chip-seqéªŒè¯</code>ã€‚&#x2F; çœ‹ATACä¸Šä¸°åº¦é«˜çš„DNAåºåˆ—åŒºåŸŸæ˜¯å¦å¯¹åº”è½¬å½•æœ¬è¡¨è¾¾é‡å¢åŠ ï¼Œæ‰¾åˆ°å¯¹åº”è½¬å½•æœ¬ç›¸å…³åŸºå› çš„ä¸Šæ¸¸è°ƒæ§åºåˆ—ï¼Œæ•´ä½“åˆ†æè½¬å½•ã€‚å¯¹åŸºå› åŠŸèƒ½åˆ†æï¼Œç»“åˆå®éªŒè¡¨å‹ï¼Œæ¨æµ‹è¡¨è¾¾è°ƒæ§-è¡¨è¾¾-åŠŸèƒ½-è¡¨å‹ã€‚<br><img src="https://img-blog.csdnimg.cn/4a3016bfa5c74598a5b7d660fe1cfe84.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p><code>ATAC-seq+HiC</code>ï¼š å¯¹äºä¸€äº›æƒ³äº†è§£<code>æŸ“è‰²è´¨é«˜çº§ç»“æ„å¯¹ç”Ÿå‘½è¡Œä¸ºçš„ä½œç”¨</code>çš„æ—¶å€™ï¼Œé€šå¸¸ä¼šéœ€è¦ç”¨åˆ°ATAC-seqç­‰æŠ€æœ¯ï¼Œå› ä¸º<code>Hi-Cåˆ†æ</code>å¾—åˆ°é«˜çº§ç»“æ„compartmentA&#x2F;Bã€TADsã€Loopsç­‰ä¿¡æ¯ï¼Œé€šå¸¸åªæ˜¯ç›¸å…³æ€§ï¼Œä½†é€šè¿‡ATAC-seqï¼Œå¯ä»¥<code>è·å¾—promoterã€enhancerç­‰ä¿¡æ¯</code>ï¼Œæ›´èƒ½çŸ¥é“é«˜çº§ç»“æ„æ˜¯å¦‚ä½•å½±å“å¯åŠ¨å­ã€å¢å¼ºå­ä»è€Œå½±å“åŸºå› è¡¨è¾¾çš„ã€‚<br><img src="https://img-blog.csdnimg.cn/e38ba32597a14ca7a5d4d6b2f36c1b73.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p><code>ATAC-seq+ç»„è›‹ç™½ä¿®é¥°</code>ï¼š ATAC-seqé¢„æµ‹ä¸€ä¸ªä½ç‚¹çš„å¼€æ”¾ç¨‹åº¦ä»¥åŠå¯èƒ½æœ‰æŸç§è½¬å½•å› å­çš„ç»“åˆï¼Œä½†<code>ä¸çŸ¥é“</code>è¯¥å› å­æ˜¯<code>ä¿ƒè¿›</code>åŸºå› è¡¨è¾¾ï¼Œè¿˜æ˜¯<code>æŠ‘åˆ¶</code>ï¼Œåªé€šè¿‡<code>åŸºå› å±‚é¢é‰´å®š</code>æ¥åˆ¤æ–­è½¬å½•å› å­å¯¹åŸºå› çš„ä¿ƒè¿›æˆ–è€…æ˜¯ä¸å¤Ÿçš„ï¼Œå®ƒåªæ˜¯ä¸€ç§<code>ç›¸å…³æ€§</code>ã€‚è€Œè¿™æ—¶å€™å¦‚æœèƒ½æä¾›åƒ<code>H3K27acè¿™ç±»æ¿€æ´»å‹ç»„è›‹ç™½</code>ã€<code>H3K27me3è¿™ç±»æŠ‘åˆ¶å‹ç»„è›‹ç™½</code>å°†èƒ½ä½¿æ•°æ®ç»“æœå¯ä¿¡ã€‚å›½å†…è¾ƒæ—©ç ”ç©¶iPSCsçš„å­¦è€…å¦‚è£´ç«¯å¿çš„å·¥ä½œå¯ä»¥çœ‹åˆ°ï¼Œåœ¨è§£æiPSCsé‡ç¼–ç¨‹ä¸­çš„æŸ“è‰²è´¨å¯åŠæ€§çš„æ—¶å€™ï¼Œä¸ä»…ç”¨åˆ°ATAC-seqæ¥æè¿°ç»†èƒçš„èº«ä»½è½¬å˜ï¼Œè¿˜<code>é€šè¿‡H3K27acæŒ‡å¾è¯¥åŒºåŸŸçš„æ¿€æ´»</code>ã€‚å…¶ä¸­ä¸€ç¯‡è¿˜é€šè¿‡<code>è°ƒæ§æˆçº¤ç»´ç»†èƒå…³é”®åŸºå› å¯åŠ¨å­åŒºå»ä¹™é…°åŒ–ä¿®é¥°</code>ï¼Œè¾¾åˆ°äº†ä¿ƒè¿›é‡ç¼–ç¨‹çš„è¿›ç¨‹ã€‚<br><img src="https://img-blog.csdnimg.cn/abb3dc6c3bb0476985a9f1b2e77c4fcc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p><code>scATAC-seq+scRNA-seq</code>ï¼š æ›´å‰æ²¿çš„æŠ€æœ¯ä¸€ä¸ªç»†èƒé‡ŒåŒæ—¶è¿›è¡ŒRNA-seqå’ŒATAC-seqï¼Œå¹¶ä¸”æ˜¯å•ç»†èƒæ°´å¹³çš„æ£€æµ‹ã€‚SHARE-seqï¼Œèƒ½å¤Ÿå®ç°åœ¨å•ç»†èƒä¸­åŒæ—¶é«˜è´¨é‡ï¼Œé«˜é€šé‡çš„æ£€æµ‹åŸºå› è¡¨è¾¾å’ŒæŸ“è‰²è´¨å¯åŠæ€§ã€‚è¯¥æŠ€æœ¯å¯ä»¥ä½¿ç”¨<code>æŸ“è‰²è´¨æ½œåŠ›ç®—æ³•</code>ï¼ˆchromatin potentialï¼‰ï¼Œ<code>ç”¨ATACå’ŒRNAçš„å·®å¼‚æ¥é¢„æµ‹ç»†èƒçš„å˜åŒ–æ–¹å‘</code>ã€‚<code>ç›¸å¯¹äºä»¥å¾€ä»…ä¾èµ–äºRNAçš„é¢„æµ‹æ‰‹æ®µï¼ŒæŸ“è‰²è´¨æ½œåŠ›èƒ½å¤Ÿå¤§å¤§æå‰é¢„æµ‹çš„æ—¶é—´</code>ã€‚<br><img src="https://img-blog.csdnimg.cn/df76c6e5f3184d58a00a1fa53a398cd5.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_19,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p><a href="https://pubmed.ncbi.nlm.nih.gov/27374332/">ATAC-seqä¸ChIPè”åˆåˆ†æ</a><br>ç ”ç©¶è¯¾é¢˜ä¸ºäººå°ç»†èƒè‚ºç™Œä¿ƒè¿›ç™Œç—‡æ‰©æ•£è½¬ç§»çš„èƒŒæ™¯æœºåˆ¶ã€‚ä¸»è¦æ¯”è¾ƒåŸå‘æ€§å’Œè‚è½¬ç§»æ€§çš„å°ç»†èƒè‚ºç™Œç»†èƒä¹‹é—´çš„å·®å¼‚ã€‚åˆ©ç”¨ATAC-seqï¼Œå‘ç°NFIå®¶æ—è½¬å½•å› å­å¯Œé›†åœ¨å…·æœ‰å·®å¼‚çš„æŸ“è‰²è´¨å¼€æ”¾ä½ç‚¹ä¸­ï¼Œé¢„ç¤ºç€NFIå®¶æ—è½¬å½•å› å­åœ¨è°ƒæ§è‚¿ç˜¤ç»†èƒè½¬ç§»ä¸­æ‰®æ¼”ç€é‡è¦è§’è‰²ã€‚åœ¨æŸ“è‰²è´¨é«˜å¼€æ”¾æ€§ä½ç‚¹åŒºåŸŸä¼´éšç€Nfibæ‹·è´æ•°é‡å¢å¤šï¼Œä¸”Nfibåœ¨ä¾µè¢­æ€§åŸå‘æ€§è‚¿ç˜¤å’Œè½¬ç§»æ€§è‚¿ç˜¤å†…é«˜è¡¨è¾¾ï¼ŒNfibè¡¨ç°å‡ºç»´æŒæŸ“è‰²è´¨åŠè¿œç«¯è°ƒæ§åŒºåŸŸå¼€æ”¾å’Œä¿ƒè¿›ç¥ç»åŸºå› è¡¨è¾¾çš„åŠŸèƒ½ï¼Œè¯´æ˜äº†Nfibå¯¹ä¿ƒè¿›ç™Œç»†èƒå¢æ®–å’Œè¿ç§»å…·æœ‰é‡è¦çš„ä½œç”¨ã€‚</p></li><li><p><a href="https://pubmed.ncbi.nlm.nih.gov/25679813/">motifåˆ†æè½¬å½•å› å­ç»“åˆè›‹ç™½</a>ã€‚å¯¹å¤„äºå‘è‚²è¿‡ç¨‹ä¸­çš„é»‘è…¹æœè‡çœ¼ç›åŠå…¶é€šè¿‡é—ä¼ è¯±å¯¼çš„è‚¿ç˜¤æ¨¡å‹ï¼Œåˆ©ç”¨ATAC-seqæŠ€æœ¯åˆ†ææŸ“è‰²è´¨å¼€æ”¾åŒºåŸŸå·²åœ¨æ´»ä½“ä¸­å‘ç°é©±åŠ¨è‚¿ç˜¤å‘è‚²çš„è½¬å½•å› å­åŠè°ƒæ§åŒºåŸŸã€‚ç„¶åå¯¹æ‰¾åˆ°çš„æŸ“è‰²è´¨æ´»æ€§å¼€æ”¾åŒºåŸŸè¿›è¡Œè½¬å½•å› å­é¢„æµ‹åˆ†æï¼Œå‘ç°äº†ä¸¤ä¸ªå…³é”®çš„è½¬å½•å› å­ï¼ŒçŒœæµ‹å®ƒä»¬å¯èƒ½ä¸æŸ“è‰²è´¨å›¾è°±çš„å˜åŒ–æœ‰å…³ã€‚é€šè¿‡å¯¹å€™é€‰çš„ä¸€ä¸ªè½¬å½•å› å­è¿›è¡ŒåŠŸèƒ½éªŒè¯å’Œé¶æ ‡åˆ†æï¼Œå‘ç°å…¶ä¸ºè‚¿ç˜¤è½¬å½•ç»„ä¸­çš„ä¸€ä¸ªå…³é”®çš„è½¬å½•è°ƒæ§å› å­ã€‚</p></li></ul><hr><ul><li><strong>æ€è€ƒ</strong>ï¼š</li><li>ATAC-Seqä¸ChIP-Seqçš„å¼‚åŒåœ¨å“ªé‡Œï¼Ÿ</li><li>ç”¨å’ŒChIP-Seqä¸€æ ·çš„å‚æ•°Call peaksæ­£ç¡®å—ï¼Ÿ</li><li>å¾—åˆ°peaksåæ€ä¹ˆè¿›è¡Œè´¨é‡è¯„ä¼°ï¼Ÿ</li><li>æ ·æœ¬å†…çš„é‡å¤æ€ä¹ˆå¤„ç†ï¼Ÿ</li><li>æ ·æœ¬é—´çš„å·®å¼‚æ€ä¹ˆåˆ†æï¼Ÿ</li><li>æ€ä¹ˆå¯¹peaksè¿›è¡ŒåŠŸèƒ½æ³¨é‡Šåˆ†æï¼Ÿ</li><li>å¦‚ä½•æ‰¾motif?</li><li>ATAC-Seqå’ŒChIP-Seqå’ŒRNA-Seqçš„æ•´åˆåˆ†ææ€ä¹ˆåšï¼Ÿ<br><img src="https://img-blog.csdnimg.cn/0920f7a6c41148b2825b189e709a5fbc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="ATAC-seq/CHIP-seqæµç¨‹"></li></ul><p>å¾…å­¦ä¹ å†…å®¹ï¼š</p><ol><li><p>ATAC-seq data analysis: from FASTQ to peaks</p></li><li><p>ATAC-seq Data Standards and Processing Pipeline in ENCODE</p></li><li><p>ATAC-seqæ•°æ®åˆ†æå®æˆ˜</p></li><li><p>Harvard FAS Informatics - ATAC-seq Guidelines</p></li><li><p>Harvard Chan Bioinformatics Core (HBC)æ·±åº¦NGSæ•°æ®åˆ†æè¯¾ç¨‹ï¼Œç¬¬5éƒ¨åˆ†å…³äºChIP-Seqï¼Œæ•´ä½“æ€è·¯å’Œç»å¤§éƒ¨åˆ†åˆ†ææ–¹æ³•é€‚åˆATAC-seqã€‚</p><p>HBCæ·±åº¦NGSæ•°æ®åˆ†æè¯¾ç¨‹ï¼š<br><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course">https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course</a><br>ç¬¬äº”éƒ¨åˆ†ChIP-Seqè¯¾ç¨‹ï¼š</p><p><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons">https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons</a></p></li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">å‚è€ƒæ–‡çŒ®ï¼š<br>https:<span class="hljs-regexp">//m</span>p.weixin.qq.com/s?src=<span class="hljs-number">11</span>&amp;timestamp=<span class="hljs-number">1633159169</span>&amp;ver=<span class="hljs-number">3349</span>&amp;signature=*MwqLr1J-qdZoNiKVxF32vEKh5-<span class="hljs-number">6</span>TRystOXAJ3UOZ3Pl8XTBIB8Ly95IJM0L2EzGFVWOM-TdKnuhnb0gfMfsUTfahWJ5i3hcM2TcR9UDFSVWuyYw7CONzMjsMaYQG2Ca&amp;new=<span class="hljs-number">1</span><br>https:<span class="hljs-regexp">//m</span>p.weixin.qq.com/s?src=<span class="hljs-number">11</span>&amp;timestamp=<span class="hljs-number">1633159169</span>&amp;ver=<span class="hljs-number">3349</span>&amp;signature=rtYw5NsC62rUZvctQsUg3*w*NFFDdOHgSMu0pcp0HTQdCyqxpgril8yx7GWlJaID*lfd2HRLUWs59zuszSEFeean0jEwdRs4PzYy*T5b7nSpZRWqCs4SHcEQ2jyjDtwQ&amp;new=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><hr><blockquote><p>1ï¼šATAC-seqçš„èƒŒæ™¯ä»‹ç»ä»¥åŠä¸ChIP-Seqçš„å¼‚åŒ<br>2ï¼šåŸå§‹æ•°æ®çš„è´¨æ§ã€æ¯”å¯¹å’Œè¿‡æ»¤<br>3ï¼šç”¨MACS2è½¯ä»¶call peaks<br>4ï¼šå¯¹ATAC-Seq&#x2F;ChIP-seqçš„è´¨é‡è¯„ä¼°ï¼ˆä¸€ï¼‰â€”â€”phantompeakqualtools<br>5ï¼šå¯¹ATAC-Seq&#x2F;ChIP-seqçš„è´¨é‡è¯„ä¼°ï¼ˆäºŒï¼‰â€”â€”ChIPQC<br>6ï¼šé‡å¤æ ·æœ¬çš„å¤„ç†â€”â€”IDR<br>7ï¼šç”¨Yå”çš„ChIPseekeråšåŠŸèƒ½æ³¨é‡Š<br>8ï¼šç”¨ç½‘é¡µç‰ˆå·¥å…·è¿›è¡Œmotifåˆ†æ<br>9ï¼šå·®å¼‚peaksåˆ†æâ€”â€”DiffBind<br>10ï¼šATAC-Seqã€ChIP-Seqã€RNA-Seqæ•´åˆåˆ†æ</p></blockquote><h3 id="ç®€æ´ç‰ˆATACseqåˆ†ææµç¨‹"><a href="#ç®€æ´ç‰ˆATACseqåˆ†ææµç¨‹" class="headerlink" title="ç®€æ´ç‰ˆATACseqåˆ†ææµç¨‹"></a>ç®€æ´ç‰ˆATACseqåˆ†ææµç¨‹</h3><ul><li>æ•°æ®é¢„å¤„ç†<ul><li>ï¼ˆ1ï¼‰æ¯”å¯¹å‰è´¨é‡æ§åˆ¶FastQC</li><li>ï¼ˆ2ï¼‰åŸå§‹åºåˆ—æ¯”å¯¹ </li><li>ï¼ˆ3ï¼‰æ¯”å¯¹åå¤„ç†å’Œè´¨é‡æ§åˆ¶ï¼šå»é™¤é‡å¤åºåˆ—ï¼Œç»†èƒå™¨åºåˆ—<ul><li>åºåˆ—æ¯”å¯¹åï¼ŒPicard&#x2F;SAMtoolsæ”¶é›†unique mapping reads&#x2F;rateï¼Œduplicated rateç™¾åˆ†æ¯”å’Œç‰‡æ®µå¤§å°åˆ†å¸ƒ</li><li>æˆåŠŸçš„ATACseqå®éªŒåº”ç”Ÿæˆ<code>ç‰‡æ®µå¤§å°åˆ†å¸ƒå›¾</code>ï¼ˆä»<code>bamæ–‡ä»¶</code>å¾—åˆ°ï¼‰ï¼Œå…·æœ‰é€’å‡æ€§å’Œå‘¨æœŸæ€§çš„å³°ï¼Œå¯¹åº”äº<code>æ— æ ¸å°ä½“åŒºåŸŸ</code>ï¼ˆNFRï¼‰ï¼ˆ&lt;100bpï¼‰å’Œ<code>å•æ ¸åŒæ ¸å’Œä¸‰æ ¸</code>å°ä½“ï¼ˆ200ï¼Œ400ï¼Œ600bpï¼‰ã€‚å¤§å¤šæ•°Linker DNAå¤§å°ä»‹äº10-80bpé—´ï¼Œæ•…å¤§å¤šæ•°ç‰‡æ®µéƒ½ä¼šæ˜¯<code>å°äº100bp</code>ã€‚æ¯ä¸ªNucleosomeçš„DNAå¤§å°ä¸º180bpï¼ŒåŠ ä¸Šä¸¤è¾¹æ’å…¥çš„å†—ä½™ï¼Œä¼šå¾—åˆ°å¤§çº¦<code>200bp</code>é•¿åº¦çš„mono-nucleosomeçš„DNAã€‚</li><li><code>æ— æ ¸å°ä½“åŒºåŸŸçš„ç‰‡æ®µåº”è¯¥åœ¨åŸºå› çš„è½¬å½•èµ·å§‹ä½ç‚¹ï¼ˆTSSï¼‰å‘¨å›´å¯Œé›†</code>ï¼Œè€Œ<code>æ ¸å°ä½“ç»“åˆåŒºåŸŸç‰‡æ®µTSSå¤„å½¢æˆä½è°·</code>ï¼ŒTSSå‘¨å›´<code>ä¾§ç¿¼åŒºåŸŸç¨å¾®å¯Œé›†</code>ã€‚<code>ATACseqQCè¯„ä¼°</code>ã€‚</li></ul></li></ul></li><li>Peak-callingï¼šä»æ¯”å¯¹å¾—åˆ°çš„bamæ–‡ä»¶æ‰¾å‡ºreadsè¦†ç›–åŒºï¼Œå°±æ˜¯å³°å‡ºç°çš„ä½ç½®ã€‚</li><li>é«˜çº§åˆ†æ<ul><li>ï¼ˆ1ï¼‰peak å·®å¼‚åˆ†æï¼šå¯»æ‰¾ä¸åŒåˆ†ç»„å·®å¼‚peaks</li><li>ï¼ˆ2ï¼‰peakæ³¨é‡Šï¼šå³°çš„æ³¨é‡Šå¯å°†æŸ“è‰²è´¨çš„å¯åŠæ€§ä¸åŸºå› è°ƒæ§è”ç³»ã€‚é€šå¸¸å³°ä¼šè¢«æ³¨é‡Šåˆ°æœ€æ¥è¿‘çš„åŸºå› æˆ–è°ƒæ§åŸä»¶ã€‚è·å¾—æœ€æ¥è¿‘çš„åŸºå› åˆ—è¡¨åï¼Œä½¿ç”¨GOKEGGReactomeç­‰æ•°æ®åº“åŠŸèƒ½å¯Œé›†åˆ†æ</li><li>ï¼ˆ3ï¼‰motifå¯Œé›†åˆ†æï¼šå¾—åˆ°æ¯ä¸ªpeak regioné‡Œmotifçš„ä½ç½®å’Œé¢‘ç‡ï¼Œå†å’ŒéšæœºèƒŒæ™¯æˆ–å…¶ä»–æ¡ä»¶æ¯”è¾ƒï¼Œå¯åšmotifå¯Œé›†åˆ†æ</li><li>ï¼ˆ4ï¼‰footprintåˆ†æ ï¼šATACseqä¸­footprintæŒ‡ä¸€ä¸ªTFç»“åˆåœ¨DNAä¸Šï¼Œç»„ç»‡Tn5åˆ‡å‰²ï¼Œåœ¨æŸ“è‰²è´¨å¼€æ”¾åŒºåŸŸç•™ä¸‹ä¸€ä¸ªç›¸å¯¹ç¼ºå¤±çš„ä½ç½®ã€‚è€ŒTFå‘¨å›´çš„ç»„è›‹ç™½å› ä¸ºTFé€ æˆç©ºé—´çš„æ¨æŒ¤åè€Œå½¢æˆå¼€æ”¾åº¦è¾ƒé«˜åŒºåŸŸã€‚</li></ul></li></ul><hr>]]></content>
    
    
    <categories>
      
      <category>NGS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>atac-seq</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
