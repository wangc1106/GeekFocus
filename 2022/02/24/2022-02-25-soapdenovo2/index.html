

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/GeekFocus/img/fluid.png">
  <link rel="icon" href="/GeekFocus/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="banner">
  <meta name="keywords" content="Bioinformatics">
  
    <meta name="description" content="soapdenovo2:">
<meta property="og:type" content="article">
<meta property="og:title" content="Soapdenovo2">
<meta property="og:url" content="https://wangc1106.github.io/GeekFocus/2022/02/24/2022-02-25-soapdenovo2/index.html">
<meta property="og:site_name" content="DrBanner">
<meta property="og:description" content="soapdenovo2:">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/1.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/2.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/3.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/4.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/5.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/6.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/7.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/8.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/9.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/10.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/11.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/12.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/13.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/14.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/15.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/16.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/17.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/18.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/19.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/20.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/21.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/22.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/23.png">
<meta property="og:image" content="https://wangc1106.github.io/GeekFocus/24.png">
<meta property="article:published_time" content="2022-02-24T13:58:19.224Z">
<meta property="article:modified_time" content="2022-06-05T12:08:13.851Z">
<meta property="article:author" content="banner">
<meta property="article:tag" content="assembly">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://wangc1106.github.io/GeekFocus/1.png">
  
  
  
  <title>Soapdenovo2 - DrBanner</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/GeekFocus/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/GeekFocus/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/GeekFocus/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"wangc1106.github.io","root":"/GeekFocus/","version":"1.9.1","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"UqIYufmNk2sE8MiBKKWc4Kja-gzGzoHsz","app_key":"iYpeWQcmNqpHwr2uVlnJYVji","server_url":"https://wangc1106.github.io/GeekFocus","path":"window.location.pathname","ignore_local":false}},"search_path":"/GeekFocus/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/GeekFocus/js/utils.js" ></script>
  <script  src="/GeekFocus/js/color-schema.js" ></script>

  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/GeekFocus/">
      <strong>DrBanner</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/GeekFocus/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/GeekFocus/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/GeekFocus/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/GeekFocus/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/GeekFocus/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/GeekFocus/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Soapdenovo2"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        banner
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-02-24 21:58" pubdate>
          February 24, 2022 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          33k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          275 mins
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> views
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Soapdenovo2</h1>
            
              <p class="note note-info">
                
                  
                    Last updated on June 5, 2022 pm
                  
                
              </p>
            
            <div class="markdown-body">
              
              <h1 id="soapdenovo2"><a href="#soapdenovo2" class="headerlink" title="soapdenovo2:"></a>soapdenovo2:</h1><span id="more"></span>

<p>SOAPdenovo使用说明，内容包括程序<font color="green"><strong>使用</strong></font>、<font color="green"><strong>参数说明</strong></font>、<font color="green"><strong>参数调整</strong></font>、主要<font color="green"><strong>输出文件</strong></font>的格式说明等。</p>
<p><img src="/GeekFocus/./1.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<h1 id="contiging"><a href="#contiging" class="headerlink" title="contiging"></a>contiging</h1><p><em><strong>a.</strong></em>  基因组DNA随机打断，使用paired-end测序。长度在150-500bp的short clones扩增直接测序。在2-10kb的长paired-end libraries 通过DNA环化、fragmentation破碎，然后净化400-600bp的碎片为了cluster 结构。</p>
<p><em><strong>b.</strong></em>  raw reads 或预修正reads被存储，de Bruijn graph data structure 被用于表示reads间overlap。</p>
<p>Kmer-graph构建：所有reads被切割成某一固定Kmer长度的序列（21bp&#x3D;&lt;kmer&lt;&#x3D;127bp），形成等长的Kmers。将Kmers连成图。<font color="green"><strong>相邻的kmers是通过K-1 overlaping连接</strong></font>，所以它不需要成对序列比对（The neighboring kmers are K-1 overlaping which generated from read sequences, so it doesn’t need pair-wise reads alignment.）。重复序列在图中被压缩。</p>
<p><img src="/GeekFocus/./2.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p><em><strong>c.</strong></em>  产生<font color="red"><strong>tips翼尖、bubbles气泡、low coverage links低覆盖率链接、tiny repeat微小重复</strong></font>等问题。</p>
<p><font color="blue"><strong>tips翼尖（a）</strong></font>和<font color="blue"><strong>bubbles气泡（c）</strong></font>：由于<strong>测序错误</strong>或<strong>杂合</strong>或<strong>高重复序列</strong>相似性，将会导致翼尖和气泡出现。</p>
<p><font color="blue"><strong>low coverage links低覆盖率链接：（b）（d）</strong></font>。</p>
<p><font color="blue"><strong>tiny repeat微小重复(e)</strong></font>：重复在graph中被压缩，并作为不同路径的共享边缘，但是能够通过reads 穿过来解决。</p>
<p><img src="/GeekFocus/./3.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p><img src="/GeekFocus/./4.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p><img src="/GeekFocus/./5.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p>移除错误链接和graph simplification图形简化，得到contigs or contig  graphs：tips翼尖移除；删除低覆盖链接；bubbles合并气泡；解决微小重复；</p>
<p><img src="/GeekFocus/./6.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p><img src="/GeekFocus/./7.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p><img src="/GeekFocus/./8.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p><img src="/GeekFocus/./9.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p> <em><strong>d.</strong></em>  contig  graphs,在重复的节点处剪断?，输出contigs</p>
<h1 id="scaffolding"><a href="#scaffolding" class="headerlink" title="scaffolding"></a>scaffolding</h1><p><em><strong>e.</strong></em>  重新用reads和contigs进行比对，使用<font color="red"><strong>paired-end信息</strong></font>把单一的contigs连接成scaffolds。reads 比对到contigs上，临近的contig建立连接；repeat将会引来冲突矛盾信息；<font color="red"><strong>在组装成scaffold时，repeat contigs将会被屏蔽</strong></font>；paired-end信息的不同插入片段被用来一步步从短到长的建立scaffold graph(Scaffolding iteratively from short to long insert PEs.&#x2F;Various insert size of paired-end information is used to build contig graph step by step from short to long)。</p>
<p><img src="/GeekFocus/./10.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p><img src="/GeekFocus/./11.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p><img src="/GeekFocus/./12.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<h1 id="Gap-Filling"><a href="#Gap-Filling" class="headerlink" title="Gap Filling:"></a>Gap Filling:</h1><p><em><strong>f.</strong></em>  使用paired-end reads来填补scaffolds内部可能是由重复序列所造成的Gap。contig N50 通常比较小（&lt;3KB）,但是，gap filling之后能够显著提高N50值（i.e.,&gt;20KB）;Most of the gaps are repeat relative sequences.;Reads locate at gaps can collected by their paired-end which uniquely map to the contig.</p>
<p><img src="/GeekFocus/./13.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>SOAPdenovo（目前最新版是SOAPdenovo2）是利用一种新的组装短read的方法，它以kerm为节点单位，利用<font color="green"><strong>de Bruijn图</strong></font>的方法实现全基因组的组装，和其他短序列组装软件相比，它可以进行大型基因组比如人类基因组的组装，组装结果更加准确可靠，可以通过组装的结果非常准确地鉴别出基因组上的序列结构性变异，为构建全基因组参考序列和以低测序成本对未知基因组实施精确分析创造了可能。</p>
<p>SOAPdenovo aims for large plant and animal genomes, although it also works well on bacteria and fungi genomes. It runs on 64-bit Linux system with a minimum of 5G physical memory. For <strong>big genomes</strong> like human, about <strong>150 GB memory</strong> would be required.</p>
<p>程序的下载及安装：<br>下载地址：<a target="_blank" rel="noopener" href="http://soap.genomics.org.cn/soapdenovo.html">http://soap.genomics.org.cn/soapdenovo.html</a><br>安装：<br>(a) 下载SOAPdenovo的压缩包   </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">git <span class="hljs-built_in">clone</span> https://github.com/aquaskyline/SOAPdenovo2.git<br><span class="hljs-built_in">cd</span> SOAPdenovo2<br>make<br></code></pre></td></tr></table></figure>

<p>(b) 解压缩<br>(c)将得到可执行文件SOAPdenovo和一个配置文件的模板example.contig</p>
<p><strong>3个可执行文件</strong></p>
<ol>
<li><font color="green"><strong>SOAPdenovo-63mer</strong></font></li>
<li><font color="green"><strong>SOAPdenovo-127mer</strong></font></li>
<li><font color="green"><strong>SOAPdenovo-fusion</strong></font></li>
</ol>
<p>第一个支持最大k-mer为63，第二个最大kmer为127，第三个文件用于单细胞测序和宏基因组测序数据。</p>
<h1 id="使用程序及参数"><a href="#使用程序及参数" class="headerlink" title="使用程序及参数"></a>使用程序及参数</h1><p>SOAPdenovo可以一步跑完，也可以分成四步单独跑<br><font color="green"><strong>一步跑完脚本:</strong></font><br>.&#x2F; SOAPdenovo <font color="red"><strong>all</strong></font> <strong>-s</strong> lib.cfg <strong>-K</strong> 29 <strong>-D</strong> 1 <strong>-o</strong> ant &gt;&gt;ass.log<br><font color="green"><strong>四步单独跑的脚本</strong></font><br>.&#x2F; SOAPdenovo <font color="red"><strong>pregraph</strong></font> <strong>-s</strong> lib.cfg <strong>-d</strong> 1  <strong>-K</strong> 29 <strong>-o</strong> ant &gt;pregraph.log<br>.&#x2F; SOAPdenovo <font color="red"><strong>contig</strong></font> <strong>-g</strong> ant <strong>-D</strong> 1 <strong>-M</strong> 3 &gt;contig.log<br>.&#x2F; SOAPdenovo <font color="red"><strong>map</strong></font> <strong>-s</strong> lib23.cfg <strong>-g</strong> ant &gt;map.log<br>.&#x2F; SOAPdenovo <font color="red"><strong>scaff</strong></font> <strong>-g</strong> ant <strong>-F</strong> &gt;scaff.log</p>
<h1 id="参数说明"><a href="#参数说明" class="headerlink" title="参数说明"></a>参数说明</h1><p>用法：&#x2F;PathToProgram&#x2F;SOAPdenovo all -s configFile [-K kmer -d KmerFreqCutOff -D EdgeCovCutoff -M mergeLevel -R -u -G gapLenDiff -L minContigLen -p n_cpu] -o Output</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh">-s    STR     配置文件√<br>-o    STR     图形输出的文件名前缀 √<br>-g    STR     输入文件的文件名前缀<br>-K    INT     输入的K-mer值大小，默认值23，取值范围 13-63 √<br>-p    INT     程序运行时设定的cpu线程数，默认值8<br>-R            <span class="hljs-string">&quot;利用read鉴别短的重复序列，默认值不进行此操作&quot;</span> √<br>-d    INT     去除频数不大于该值的k-mer，默认值为0;<span class="hljs-string">&quot;最小化错误测序带来的影响&quot;</span> √<br>-D    INT     去除频数不大于该值的由k-mer连接的边，默认值为1，即该边上每个点的频数都小于等于1时才去除,最小化错误测序带来的影响 ?<br>-M    INT     连接contig时合并相似序列的等级(强度)，默认值为1，最大值3。<br>-F            利用<span class="hljs-built_in">read</span>对scaffold中的gap进行填补，默认不执行<br>-u            构建scaffold前不屏蔽高覆盖度的contig，这里高频率覆盖度指平均contig覆盖深度的2倍。默认屏蔽<br>-G    INT     估计gap的大小和实际补gap的大小的差异，默认值为50bp。<br>-L            用于构建scaffold的contig的最短长度，默认为：Kmer参数值 ×2<br></code></pre></td></tr></table></figure>

<p><font color="blue"><strong>全局配置</strong></font></p>
<p><code>max_rd_len</code></p>
<p><font color="blue"><strong>文库配置</strong></font></p>
<p>每个文库的配置以<code>[LIB]</code>开头，主要指定输入文件的路径，支持多种格式的输入文件，用不同的前缀表示， <code>q</code>代表输入序列为fastq格式；<code>f</code>代笔输入序列为fasta格式，<code>b</code>代表输入文件为bam格式，对于双端数据，分别用后缀<code>1</code>和<code>2</code>表示R1端和R2端的reads。</p>
<p><font color="blue"><strong>主要参数</strong></font></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh">-avg_ins    This value indicates the average insert size of this library or the peak value position <span class="hljs-keyword">in</span> the <span class="hljs-string">&quot;insert size distribution figure?&quot;</span>. <span class="hljs-comment">#文库平均插入长度(或取插入大小分布图中的峰值位置)，根据建库情况设置。 </span><br><br>-reverse_seq    This option takes value 0 or 1. It tells the assembler <span class="hljs-keyword">if</span> the <span class="hljs-built_in">read</span> sequences need to be complementarily reversed. Illumima GA produces two types of paired-end libraries: a) <span class="hljs-string">&quot;forward-reverse&quot;</span>, generated from fragmented DNA ends with typical <span class="hljs-string">&quot;insert size less than 500 bp&quot;</span>; b) <span class="hljs-string">&quot;reverse-forward&quot;</span>, generated from <span class="hljs-string">&quot;circularizing libraries&quot;</span> with typical <span class="hljs-string">&quot;insert size greater than 2 Kb&quot;</span>. The parameter <span class="hljs-string">&quot;reverse_seq&quot;</span> should be <span class="hljs-built_in">set</span> to indicate this: 0, forward-reverse; 1, reverse-forward. <br><br>-asm_flags    This indicator decides <span class="hljs-keyword">in</span> <span class="hljs-built_in">which</span> part(s) the reads are used. It takes value 1(only contig assembly), 2 (only scaffold assembly), <span class="hljs-string">&quot;3(both contig and scaffold assembly)&quot;</span><span class="hljs-string">&quot;, or 4 (only gap closure). </span><br><span class="hljs-string"></span><br><span class="hljs-string">-rd_len_cutof    The assembler will &quot;</span><span class="hljs-built_in">cut</span> the reads from the current library to this length<span class="hljs-string">&quot;.</span><br><span class="hljs-string"></span><br><span class="hljs-string">-rank    It takes integer values and decides in which &quot;</span>order the reads are used <span class="hljs-keyword">for</span> scaffold assembly<span class="hljs-string">&quot;. Libraries with the same &quot;</span>rank<span class="hljs-string">&quot; are used at the same time during scaffold assembly.</span><br><span class="hljs-string"></span><br><span class="hljs-string">-pair_num_cutoff    This parameter is the cutoff value of pair number for a &quot;</span>reliable connection<span class="hljs-string">&quot; between two contigs or pre-scaffolds. The minimum number for &quot;</span>paired-end reads and mate-pair reads is 3 and 5 respectively<span class="hljs-string">&quot;. </span><br><span class="hljs-string"></span><br><span class="hljs-string">-map_len    This takes effect in the &quot;</span>map<span class="hljs-string">&quot; step and is the minimun alignment length between a read and a contig required for a reliable read location. The minimum length for &quot;</span>paired-end reads and mate-pair reads is 32 and 35 respectively<span class="hljs-string">&quot;.</span><br></code></pre></td></tr></table></figure>

<p><font color="blue"><strong>实例</strong></font></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs sh">max_rd_len=100<br>[LIB]<br><span class="hljs-comment">#avg_ins 文库插入片段的平均长度，在实际设置时，可以参考文库size分布图，取峰值即可???</span><br>avg_ins=200<br><span class="hljs-comment">#reverse_seq 是否需要将序列反向互补，pair-end数据，不需反向互补，设置为0；mate-pair需要设置为1</span><br>reverse_seq=0<br><span class="hljs-comment">#asm_flags 1只组装contig. 2只组装scaffold,3同时组装contig和scaffold,4只补gap</span><br>asm_flags=3<br><span class="hljs-comment">#序列长度阈值，作用和max_rd_len相同，大于该长度的序列会被切除到该长度</span><br>rd_len_cutoff=100<br><span class="hljs-comment">#设置不同文库数据的优先级顺序，取值范围为整数，rank值相同的多个文库，在组装scaffold时，会同时使用。</span><br>rank=1<br>q1=fastq1_read_1.fq<br>q2=fastq1_read_2.fq<br>-pair_num_cutoff<br><span class="hljs-comment">#contig或者scaffold之前的最小overlap个数，pair-end数据默认为3；mate-paird数据默认为5</span><br>-map_len<br><span class="hljs-comment">#比对长度的最小阈值，pair-end数据默认为32；mate-pair数据默认为35</span><br></code></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">SOAPdenovo-63mer all -s config_file -K 63 -R -o graph_prefix<br></code></pre></td></tr></table></figure>



<h1 id="使用方法及示例"><a href="#使用方法及示例" class="headerlink" title="使用方法及示例"></a>使用方法及示例</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#（1）示例</span><br>SOAPdenovo all -s HCB.lib -K 25 -d -o <span class="hljs-built_in">test</span><br><span class="hljs-comment">#（2）配置文件 configFile</span><br><span class="hljs-comment">#maximal read length （read的最大长度），该值【一般设置的比实际read读长稍微短一些？】，截去测序最后的部分，具体长度看测序质量</span><br>max_rd_len=50    <br><br><span class="hljs-comment">#[LIB]文库信息以此开头</span><br><br>avg_ins=200<span class="hljs-comment">#?</span><br><br>reverse_seq=0<br><span class="hljs-comment">#序列是否需反转，目前测序技术，插入片段大于等于2k的采用了环化，对于插入长度大于等于2k文库，序列需要反转，reverse_seq＝1，小片段设为0</span><br><br>asm_flags=3<br><span class="hljs-comment">#该文库中的read序列在组装的哪些过程（contig/scaff/fill）中用到</span><br><span class="hljs-comment">#短插入片段(&lt;2K)的设为3，同时构建contig和scaffold，长插入片段(&gt;=2k)设为2，不构建contig，只构建scaffold，454single 长reads只用于补洞。</span><br><br>rank=1<br><span class="hljs-comment">#该值取整数，决定了reads用于构建scaffold的次序，值越低数据越优先用于构建scaffold。【相同rank的文库数据会同时用于组装scaffold】。一般将短插入片段设为1；2k设为2；5k设为3；10k设为4；当【某个档的数据量较大】时可以将其分为多个档，同样当【某档数据量不足够】时，可以将多个档的数据合在一起构建scaffold?。这里说的数据量够与不够是从该档的测序覆盖度和物理覆盖度两个方面考虑。</span><br><br>pair_num_cutoff=3<br><span class="hljs-comment">#【可选参数】，该参数规定连接两个contig 或者是pre-scaffold 的可信连接的阈值，当连接数大于该值，连接才算有效。短插入片段(&lt;2k)默认值为3，长插入长度序列默认值为5</span><br><br>map_len=32<br><span class="hljs-comment">#map_len该参数规定在map过程中 reads和contig的比对长度必须达到该值（比对不容mismacth和gap），该比对才能作为一个可信的比对。可选参数，短插入片段(&lt;2k)一般设置为32，长插入片段设置为35，默认值是K＋2。</span><br><br>q1=/path/LIBNAMEA/fastq_read_1.fq<span class="hljs-comment">#read 1的fastq</span><br>q2=/path/LIBNAMEA/fastq_read_2.fq<span class="hljs-comment">#read 2的fastq【注意顺序】</span><br>f1=/path/LIBNAMEA/fasta_read_1.fa<span class="hljs-comment">#read 1的fa</span><br>f2=/path/LIBNAMEA/fasta_read_2.fa<br>q=/path/LIBNAMEA/fastq_read_single.fq<span class="hljs-comment">#单向测序fastq</span><br>f=/path/LIBNAMEA/fasta_read_single.fa<span class="hljs-comment">#单向测序fa</span><br>p=/path/LIBNAMEA/pairs_in_one_file.fa<span class="hljs-comment">#双向测序一个fasta</span><br></code></pre></td></tr></table></figure>





<h1 id="输出文件及说明"><a href="#输出文件及说明" class="headerlink" title="输出文件及说明"></a>输出文件及说明</h1><p>SOAPdenovo 分四部分别对应的输出文件：<br>  ● pregraph  生成7个文件 *.kmerFreq  *.edge  *.preArc  *.markOnEdge  *.path  *.vertex  *.preGraphBasic<br>  ● contig       生成4个文件 <font color="red"> ***.contig**</font>  *.ContigIndex  *.updated.edge  *.Arc<br>  ● map          生成3个文件 *.readOnContig  *.peGrads  *.readInGap<br>  ● scaff          生成6个文件 *.newContigIndex  *.links  *.scaf  *.scaf_gap  <font color="red"> ***.scafSeq**</font>  *.gapSeq</p>
<p>*.kmerFreq             #每行显示一个数，这个数是kmer值出现的频率等于行号的kmer个数。</p>
<p><font color="red"><em><strong>.contig</strong></font>：没有使用mate pair 信息的contig sequences<br><font color="red"></em><strong>.scafSeq</strong></font>：fasta格式scaffold序列文件，contig之间的gap用N填充；<br><strong>对于得到的.scafSeq文件还需要用<font color="red">GapCloser</font>去合并其中的gap，最后的contig文件则是对补洞之后的scaffold文件通过打断N区的方法得到?</strong><br>以上两个文件是组装结果中最主要的输出。</p>
<p><font color="red"><em><strong>.scaf</strong></font>：包括scaffold中contig的详细信息；<br>在</em>*scaffold行<strong>中包括scaffold名字、contig长度和该scaffold长度。<br>在</strong>contig行**包括contig名字、contig在scaffold上的起始位置、正反链、长度和contig间的链接信息<br><font color="red"> *.links</font>：contig间的pair-end连接信息<br><font color="red"> *.readOnContig</font>：reads在contig上的位置<br><font color="red"> *.peGrads</font>： 通过调整本文件中参数来显示构建scaffold所用到的插入片段库的个数，总共用到的read数，最长read，每个库对应的哪些reads，rank设置，pair_num_cutoff设置。例如：</p>
<blockquote>
<p>grads&amp;num: 10   522083934       70<br>323     104577616       1       3<br>334     180770522       1       3<br>345     226070520       1       3<br>486     361955834       2       3<br>2200    392088076       3       5<br>2290    422272580       3       5<br>2400    445522690       3       5<br>4870    475666064       4       5<br>9000    511030930       5       8<br>9110    522083934       5       5</p>
<p>该文件中共分成4列。<strong>组装的配置文件中有n个文库，该文件则有n+1行，且按照文库大小顺序排列。</strong><br><strong>第1行</strong>，二三四列分别是所用文库数目，reads总数和<font color="red">组装中用到的最长的reads长度？</font>。<br><strong>第2行</strong>，四列分别是文库大小，文库reads数目，文库reads的rank等级和pair_num_cutoff。<br><strong>第3～n+1行</strong>，四列分别是文库大小，文库reads数目加上前面文库中的reads总数，文库reads的rank等级pair_num_cutoff。#contig或者scaffold之前的最小overlap个数，pair-end数据默认为3；mate-paird数据默认为5,若配置文件没设置pair_num_cutoff，即使用默认参数0。</p>
</blockquote>
<p><strong>对于SOAPdenovo的每个步骤都有日志文件输出，要保存好日志文件，日志文件中包含有很多有用的信息。</strong></p>
<p>SOAPdenovo日志输出说明：</p>
<p>1）<font color="red">pregraph.log</font>:  其中有很多的统计信息，包括构建debruijn-graph所用reads数目，构图产生多少uniq的kmer以及设置-d参数后去除了多少kmer。</p>
<blockquote>
<p>-R            利用read鉴别短的重复序列，默认值不进行此操作</p>
<p>-d    INT     去除频数不大于该值的k-mer，默认值为0</p>
</blockquote>
<p>在pregraph中，可选参数有 –R –K –d  结果如：<br>5467781332 <strong>nodes</strong> allocated, 70662750348 <strong>kmer</strong> <strong>in reads</strong>, 70662750348 <strong>kmer processed</strong><br>3283081670 <strong>kmer removed</strong><br>其中Kmer 数取决于k值和数据量，nodes数即特异性kmer数，当nodes数目过高<strong>（一般和基因组大小差不多大小），可能是数据的错误率比较高，也可能是存在杂合</strong>。若nodes数目偏小，且kmer数目多，则基因组重复度较高。</p>
<p>k值的选取，当数据量充足（&gt;&#x3D;40X），<strong>植物基因组一般采用大kmer效果较好</strong>，而<strong>动物基因组k值一般取27和29足够</strong>。kmer removed表示的 <strong>–d 参数所去除的低频的kmer</strong>。</p>
<p>2）<font color="red">contig.log</font>: contig 中，可选参数 –R –D –M，注，-R 参数的选定，必须pregraph和contig中同时选择才有效。</p>
<blockquote>
<p>-R            利用read鉴别短的重复序列，默认值不进行此操作</p>
</blockquote>
<p>结果例子：<br>16430183 pairs found, 2334584 pairs of paths compared, 1674493 pairs merged<br><strong>merged的数量可作为估计杂合以及测序错误的程度</strong>。<br>sum up 1932549703bp, with average length 1170<br>the longest is 36165bp, contig N50 is 2871 bp,contig N90 is 553 bp<br>相关统计信息，通常<strong>植物基因组的contig N90在200bp左右</strong>，若<strong>N90高于200bp则该基因组scaffold构建不会有太大问题</strong>。动物基因组scaffold构建很少有出问题的。</p>
<p>3）<font color="red">map.log</font>:<br>Output 415219610 out of 1956217742 (21.2)% reads in gaps<br><strong>1661094582 out of 1956217742 (84.9)% reads mapped to contigs</strong><br>一般情况下，reads in gap比例和map to contig 比例<strong>总和大于1（21.2%+84.9%）</strong>。因为reads map到多个地方都被统计。当map to contig的比例很高（80%左右时），但组装效果不好可能是重复序列较多。reads in gap比例较高（大于40%）是因为基因组组装的较碎gap区域较多。<br>map_len 默认值&#x3D;K+5，短插入片段(&lt;2k)一般设置为32，长插入片段为35。取值为max{K+5,map_len}</p>
<p>4）<font color="red">scaff.log</font>:<br>average contig coverage is 23, 5832270 contig masked<br>构建scaffold是对高频覆盖的contig进行屏蔽（即<strong>频率高于average contig coverage的两倍的contig不用于构建scaffold(average-dep 2倍以上repeat sequences)?<strong>），从这里可以看出组装的基因组一定的重复情况。<br><strong>estimated PE size 162</strong>, by 40034765 pairs<br>on contigs longer than 173, 38257479 pairs found,SD&#x3D;8, insert_size estimated: 163<br><font color="green"><strong>173 是配置文件文库insertsize</strong></font>，<font color="green"><strong>163 是reads  map到contig上的距离的估计值</strong></font>，8是分布标准偏差。一般考虑比对上去的pair数目和SD值。若pair对数很多且SD值很小？（小片段文库数据不超过三位数，大片段文库数据不超过500），<font color="green">一般可将配置文件中</strong>文库插入片段值修改</strong>为对短插入片段文库（&lt;1k）的大小<strong>估计值<strong>，下次</strong>组装<strong>以及</strong>补洞<strong>时应根据估计值对原配置文件中的</strong>insertsize修正**</font>。对于大片段文库（&gt;&#x3D;2K），因为是把reads map到contig上，若最长contig较短，可能找不到成pair比对上去的reads，无法估计文库大小，需要自己将大片段一级一级的map到前一级的组装结果上，然后再分析大片段文库的插入片段大小。注，</strong>需要调整insertsize时，只需修改* .peGrads文件中第一列，后删除*.links文件，重跑scaff即可*<em>。即构建scaffold时，主要是根据</em>.links文件的信息进行连接。<br>Cutoff for number of pairs to make a reliable connection: 3<br>1124104 weak connects removed (there were 4773564 active cnnects))<br>Cutoff for number是在配置文件中设的pair_num_cutoff值，weak connects是低于这个值被认定为无效的连接数，active connects是满足cutoff的连接数，根据这个数值可对pair_num_cutoff做调整<br>Picked  25241 subgraphs,4 have conflicting connections<br>conflicting connections 是表示构建scaffold时的矛盾数，矛盾数比较高（&gt;100）时，可根据前面的有效连接数，适当提高pair_num_cutoff值，即提高scaffold连接要求的最少关系数<br>182483 scaffolds&amp;singleton sum up 1990259817bp, with average length 10906<br>the longest is 6561520bp,scaffold N50 is 836795 bp, scaffold N90 is 157667 bp<br>scaffold 统计信息，将是根据rank分梯度的统计<br>Done with 13301 scaffolds, 2161915 gaps finished, 2527441 gaps overall<br><strong>-F 参数补洞的统计信息。</strong></p>
<blockquote>
<p>发现scafstatistics 文件中的sca N50是整个scafSeq文件中的N50（包括不存在于scaf内的contig）。log文件中的sca N50只包括scaf 中的N50.</p>
<p>sacf.seq中可能有N，也可能无N。大部分有</p>
<p>gap finish？</p>
</blockquote>
<h1 id="参数调整"><a href="#参数调整" class="headerlink" title="参数调整"></a>参数调整</h1><p>组装时需调整的参数，主要分两种：</p>
<p>一种是脚本中参数改动：如调整  -K  -R  -d  -D  -M<br>-K 值一般与基因组的特性和数据量相关，目前用到的SOAPdenovo软件主要有两个版本，SOAPdenovo-63mer是可使用大kmer组装，K值范围13-63。<br>【<strong>经验</strong>】：植物基因组组装采用大kmer效果会比较好（要求短片段reads长度75bp），动物基因组很少有用到大kmer后有明显改进效果的，且<strong>动物基因组组装K值一般设置为27和29较多</strong>。</p>
<p><font color="red"><strong>组装杂合子基因组的K-mer值应该小一点；组装含有高repeats基因组且要求其有高的测序深度和长的reads,的K-mer应该大一点。</strong></font></p>
<p>-R参数，对于<font color="green">动物基因组R参数一般不设置</font>，<font color="red"><strong>植物基因组</strong>由于<strong>较多的repeat区</strong>则<strong>设置R参数</strong>后效果更好</font>。注意<strong>设置-R时，一般使用-M 的默认值</strong>。（熊猫基因组组装时得出的结论）</p>
<p>-M 参数，0-3,<strong>默认值1</strong>。一般杂合率为千分之几就设为几。熊猫基因组组装时-M 2 。</p>
<p>-d 参数，对于没有纠错，没有处理的质量又较差的原始数据，kmer频数为1数据较多的组装，<font color="red"><strong>设置为-d 1 足够</strong></font>。对于处理过或是测序质量较好数据可不设置。数据量较多时，也可设置-d 去除部分质量稍差数据。</p>
<p>-D 参数，默认为1，一般不用另行设置。</p>
<p>第二种，从<strong>map</strong>过程去调节参数。可以<font color="red"> 调整配置文件map_len的值和调整文件 * .peGrads  </font>。<br>当<strong>文库插入片段分布图</strong>中文库大小与<strong>实验给出的文库大小</strong><font color="red">差异很大</font>，<font color="red"><em><em>调整</em>.peGrad</em>*s</font>文件中的插入片段大小。</p>
<p>根据每一档数据的数据量去调整文库的<strong>rank等级</strong>。</p>
<p>当该文库的数据量很多或者是在构建scaffold的过程中的冲突数很多时，可是适当的调大第四列的<strong>pair_num_cutoff</strong>，把条件设置的更严。</p>
<h1 id="内存估计"><a href="#内存估计" class="headerlink" title="内存估计"></a>内存估计</h1><p>SOAPdenovo四个步骤消耗的内存不一样</p>
<p>第一步消耗内存最多，使用没有纠错的的reads，(<font color="blue"> <strong>K&lt;&#x3D;31**</font>)第一步消耗的内存在<font color="blue"><strong>基因组大小80－100倍</strong>左右</font>，<font color="blue">纠过错在</strong>40－50倍**左右</font></p>
<p>第二步相对消耗内存会少很多</p>
<p>第三步消耗内存仅次于第一步，在第一步的一半左右</p>
<p>第四步消耗的内存也会比较少</p>
<p>对于CPU的使用，默认是8个，如果申请内存时申请一个计算节点的所有内存, CPU就设置为该计算节点的CPU个数充分利用计算资源，如果仅申请一个节点的部分内存则根据实际情况考虑。</p>
<p>对于<font color="blue"><strong>大kemr(K&gt;31)</strong></font>其内存使用是<font color="blue">**(k&lt;&#x3D;31)**</font>的<font color="blue"><strong>1.5倍</strong></font>左右，有时甚至更多，要充分估计内存使用，在第一次运行时考虑不能太保守。</p>
<h1 id="常见错误"><a href="#常见错误" class="headerlink" title="常见错误"></a>常见错误</h1><p>1）配置文件reads存储路径错误<br>只输出日志文件。<br>pregraph.log中的错误信息：“Cannot open &#x2F;path&#x2F;LIBNAMEA&#x2F;fastq_read_1.fq. Now exit to system…”<br>2）-g 后所跟参数与pregraph（第一步） -o  后所跟参数名不一致【**-o对应后面的-g**】<br>contig  map  scaff 这三个步骤都只是输出日志文件。<br><font color="green">contig.log</font>错误信息：“Cannot open *.preGraphBasic. Now exit to system…”<br><font color="green">map.log</font>错误信息：“Cannot open *.contig. Now exit to system…”<br><font color="green">scaff.log</font>错误信息：“Cannot open *.preGraphBasic. Now exit to system…”<br>3）<font color="blue">从map开始重新跑时，需要删除 *.links文件</font>，否则会生成core文件，程序退出。</p>
<hr>
<h1 id="Github-Readme-md"><a href="#Github-Readme-md" class="headerlink" title="Github-Readme.md"></a>Github-Readme.md</h1><h2 id="Configuration-file"><a href="#Configuration-file" class="headerlink" title="Configuration file"></a>Configuration file</h2><p>For big genome projects with deep sequencing, <font color="red">the data is usually organized as <strong>multiple read sequence files</strong> generated from <strong>multiple libraries</strong></font>. The configuration file: where? information? example.config</p>
<p>The configuration file has a section for <font color="red"><strong>global information</strong></font>, and then <font color="red"><strong>multiple library sections</strong></font>. Right now only “max_rd_len” is included in the global information section. Any read longer than max_rd_len will be cut to this length.</p>
<p>The library information and the information of sequencing data generated from the library should be organized in the corresponding library section. <font color="red"><strong>Each library section starts with tag [LIB]</strong></font> and includes the following items:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">-avg_ins<br>-reverse_seq<br>-asm_flags<br>-rd_len_cutof<br>-rank<br>-pair_num_cutoff<br>-map_len<br></code></pre></td></tr></table></figure>



<p>The assembler accepts read file in three kinds of formats: <font color="green">FASTA, FASTQ and BAM</font>. Mate-pair relationship could be indicated in two ways: two sequence files with reads in the same order belonging to a pair, or two adjacent reads in a single file (FASTA only) belonging to a pair. If a read in <strong>bam</strong> file <strong>fails</strong> platform&#x2F;vendor <strong>quality checks</strong>(the flag field 0x0200 is set), itself and it’s <strong>paired read</strong> would be <strong>ignored</strong>.</p>
<p>All the above items in each library section are optional. The assembler assigns default values for most of them. <strong>If you are not sure how to set a parameter, you can remove it from your configuration file</strong>.</p>
<h2 id="Get-started"><a href="#Get-started" class="headerlink" title="Get started"></a>Get started</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-string">&quot;one step&quot;</span><br>SOAPdenvo all -s config_file -K 63 -R -o graph_prefix 1&gt;ass.log 2&gt;ass.err<br><span class="hljs-comment">#-R            利用read鉴别短的重复序列，默认值不进行此操作</span><br><br><span class="hljs-comment">#step by step </span><br><span class="hljs-string">&quot;step1:&quot;</span><br>SOAPdenvo pregraph -s config_file -K 63 -R -o graph_prefix 1&gt;pregraph.log 2&gt;pregraph.err<br><span class="hljs-string">&quot;OR&quot;</span><br>SOAPdenvo sparse_pregraph -s config_file -K 63 -z 5000000000 -R -o graph_prefix 1&gt;pregraph.log 2&gt;pregraph.err<br><span class="hljs-comment">#-z genomize(required):estimated genome size</span><br><br><span class="hljs-string">&quot;step2:&quot;</span><br>SOAPdenvo contig -g graph_prefix -R 1&gt;contig.log 2&gt;contig.err<br><span class="hljs-comment">#-g    STR     输入文件的文件名前缀</span><br><br><span class="hljs-string">&quot;step3:&quot;</span><br>SOAPdenvo map -s config_file -g graph_prefix 1&gt;map.log 2&gt;map.err<br><br><span class="hljs-string">&quot;step4:&quot;</span><br>SOAPdenvo scaff -g graph_prefix -F 1&gt;scaff.log 2&gt;scaff.err<br><span class="hljs-comment">#-F            利用read对scaffold中的gap进行填补，默认不执行       </span><br></code></pre></td></tr></table></figure>



<h2 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h2><h3 id="Options-for-all-pregraph-contig-map-scaff"><a href="#Options-for-all-pregraph-contig-map-scaff" class="headerlink" title="Options for all (pregraph-contig-map-scaff)"></a>Options for all (<font color="red">pregraph-contig-map-scaff</font>)</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-string">&quot;-s&quot;</span>    configFile: the config file of solexa reads<br><span class="hljs-string">&quot;-o&quot;</span>     outputGraph: prefix of <span class="hljs-string">&quot;output graph file name&quot;</span><br><span class="hljs-string">&quot;-K&quot;</span>        kmer(min 13, max 63/127): kmer size, [23]<br><span class="hljs-string">&quot;-p&quot;</span>        n_cpu: number of cpu <span class="hljs-keyword">for</span> use, [8]<br><span class="hljs-string">&quot;-a?&quot;</span>        initMemoryAssumption: memory assumption initialized to avoid further reallocation, unit G, [0]<br><span class="hljs-string">&quot;-d&quot;</span>        KmerFreqCutoff: kmers with frequency no larger than KmerFreqCutoff will be deleted, [0]	INT     去除频数不大于该值的k-mer，默认值为0<br><span class="hljs-string">&quot;-R&quot;</span> (optional)  resolve repeats by reads, [NO]<br><span class="hljs-string">&quot;-D&quot;</span>        EdgeCovCutoff: edges with coverage no larger than EdgeCovCutoff will be deleted, [1]	INT     去除频数不大于该值的由k-mer连接的边，默认值为1，即该边上每个点的频数都小于等于1时才去除<br><span class="hljs-string">&quot;-M&quot;</span>        mergeLevel(min 0, max 3): the strength of merging similar sequences during contiging, [1]	INT     连接contig时合并相似序列的等级，默认值为1，最大值3。<br>-m        max k when using multi kmer<br>-e        weight to filter arc when linearize two edges(default 0)<br>-r (optional)  keep available <span class="hljs-built_in">read</span>(*.<span class="hljs-built_in">read</span>)<br>-E (optional)  merge clean bubble before iterate<br>-f (optional)  output gap related reads <span class="hljs-keyword">in</span> map step <span class="hljs-keyword">for</span> using SRkgf to fill gap, [NO]<br>-k        kmer_R2C(min 13, max 63): kmer size used <span class="hljs-keyword">for</span> mapping <span class="hljs-built_in">read</span> to contig, [K]<br>-F (optional)  fill gaps <span class="hljs-keyword">in</span> scaffold, [NO]利用<span class="hljs-built_in">read</span>对scaffold中的gap进行填补，默认不执行<br>-u (optional)  un-mask contigs with high/low coverage before scaffolding, [mask]构建scaffold前不屏蔽高覆盖度的contig，这里高频率覆盖度指平均contig覆盖深度的2倍。默认屏蔽<br>-w (optional)  keep contigs weakly connected to other contigs <span class="hljs-keyword">in</span> scaffold, [NO]<br>-G        gapLenDiff: allowed length difference between estimated and filled gap, [50]INT     估计gap的大小和实际补gap的大小的差异，默认值为50bp。<br>-L        minContigLen: shortest contig <span class="hljs-keyword">for</span> scaffolding, [K+2]用于构建scaffold的contig的最短长度，默认为：Kmer参数值 ×2<br>-c      minContigCvg: <span class="hljs-string">&quot;minimum contig coverage&quot;</span> (c*avgCvg), contigs shorter than 100bp with coverage smaller than c*avgCvg will be masked before scaffolding unless -u is <span class="hljs-built_in">set</span>, [0.1]<br>-C      maxContigCvg: <span class="hljs-string">&quot;maximum contig coverage&quot;</span> (C*avgCvg), contigs with coverage larger than C*avgCvg or contigs shorter than 100bp with coverage larger than 0.8*C*avgCvg will be masked before scaffolding unless -u is <span class="hljs-built_in">set</span>, [2]<br>-b      insertSizeUpperBound: (b*avg_ins) will be used as upper bound of insert size <span class="hljs-keyword">for</span> large insert size ( &gt; 1000) when handling pair-end connections between contigs <span class="hljs-keyword">if</span> b is <span class="hljs-built_in">set</span> to larger than 1, [1.5]<br>-B      bubbleCoverage: remove contig with lower cvoerage <span class="hljs-keyword">in</span> bubble structure <span class="hljs-keyword">if</span> both contigs<span class="hljs-string">&#x27; coverage are smaller than bubbleCoverage*avgCvg, [0.6]</span><br><span class="hljs-string">-N        genomeSize: genome size for statistics, [0]</span><br><span class="hljs-string">-V (optional)  output visualization information of assembly, [NO]</span><br></code></pre></td></tr></table></figure>

<h3 id="Options-for-sparse-pregraph"><a href="#Options-for-sparse-pregraph" class="headerlink" title="Options for sparse_pregraph"></a>Options for sparse_pregraph</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh">Usage: ./SOAPdenovo2 sparse_pregraph -s configFile -K kmer -z genomeSize -o outputGraph [-g maxKmerEdgeLength -d kmerFreqCutoff -e kmerEdgeFreqCutoff -R -r runMode -p n_cpu]<br>  -s      configFile: the config file of solexa reads<br>  -K         kmer(min 13, max 63/127): kmer size, [23]<br>  -g         maxKmerEdgeLength(min 1, max 25): number of skipped intermediate kmers, [15]<br>  <span class="hljs-string">&quot;-z&quot;</span>         genomeSize(mandatory): estimated genome size<br>  <span class="hljs-string">&quot;-d&quot;</span>         kmerFreqCutoff: delete kmers with frequency no larger than,[1]<br>  -e         kmerEdgeFreqCutoff: delete kmers<span class="hljs-string">&#x27; related edge with frequency no larger than [1]</span><br><span class="hljs-string">  -R (optional)   output extra information for resolving repeats in contig step, [NO]</span><br><span class="hljs-string">  -r         runMode: 0 build graph &amp; build edge and preArc, 1 load graph by prefix &amp; build edge and preArc, 2 build graph only, 3 build edges only, 4 build preArcs only [0]</span><br><span class="hljs-string">  &quot;-p&quot;         n_cpu: number of cpu for use,[8]</span><br><span class="hljs-string">  -o         outputGraph: prefix of output graph file name</span><br></code></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs sh">contigs：<br>      -g  &lt;string&gt;      输入graph file文件名前缀 <br>    -R  (optional)    移除repeats，使用pregraph步骤中产生的结果，如果参数-R在pregraph步骤中被设置的话，默认[NO]<br>    -D  &lt;int&gt;         去除频数不大于该值（edgeCovCutoff）的由k-mer连接的边，默认值[1]，即该边上每个点的频数都小于等于1时才去除。edges with coverage no larger than EdgeCovCutoff will be deleted, [1] <span class="hljs-comment">#最小化错误测序带来的影响</span><br>    -M  &lt;int&gt;         在contiging操作时，合并相似序列的强度，默认值为[1]，最小值0，最大值3。<span class="hljs-comment">#deal with heterozygosis</span><br>    -e  &lt;int&gt;         两边缘之间的弧的权重大于该值（arcWeight），将被线性化，默认值[0]<br>    -m  &lt;int&gt;         最大的kmer size（max 127）用于multi-kmer，默认[NO]<br>    -E  (optional)    在iterate迭代之前，合并clean bubble功能，仅在当使用multi-kmer时且设置-M参数，默认[NO]<br> <br>map：<br>    -g  &lt;string&gt;      输入graph file文件名前缀 <br>    -k  &lt;int&gt;         该值（kmer_R2C）是kmer size用于mapping reads到contigs上时的值，默认值[K]<br>    -f  (optional)    在map那一步中，对于使用SRkgf去填充gap，输出与gap相关的reads,默认[NO]<br> <br>scaffold：<br>      -F  (optional)    利用<span class="hljs-built_in">read</span>对scaffold中的gap进行填补，默认[NO]<br>    -u  (optional)    构建scaffolding前不屏蔽高/低覆盖度的contigs，这里高频率覆盖度指平均contig覆盖深度的2倍。默认[mask]屏蔽<br>    -w  (optional)    在scaffold中，保持contigs弱连接于其他contigs，默认[NO]<br>    -G  &lt;int&gt;         估计gap的大小和实际补gap的大小的差异值，默认值[50]bp。<br>    -L  &lt;int&gt;         用于构建scaffold的contig的最短长度(minContigLen)，默认为：[Kmer参数值+2]<br>    -c  &lt;<span class="hljs-built_in">float</span>&gt;       在scaffolding之前，contigs小于100bp，且覆盖率小于该最小contig覆盖率（c*avgCvg），将被屏蔽，除非参数-u已设定，默认值[0.1]<br>    -C  &lt;<span class="hljs-built_in">float</span>&gt;       在scaffolding之前，contigs覆盖率大于该最大contigs覆盖率（C*avgCvg），或者contigs小于100bp且覆盖率大于0.8*（C*avgCvg），将被屏蔽，除非参数-u已设定，默认值[2]<br>    -b  &lt;<span class="hljs-built_in">float</span>&gt;       当处理contigs间的pair-end连接时，如果参数-b&gt;1，该插入片段的上限值（b*avg_ins）将被用来作为大的插入片段（&gt;1000）的上限，默认值[1.5]<br>    -B  &lt;<span class="hljs-built_in">float</span>&gt;       如果两个contigs的覆盖率都小于bubble覆盖率（bubbleCoverage）乘以contigs平均覆盖率（bubbleCoverage*avgCvg），则去除在bubble结构中的低覆盖率contig，默认值[0.6]<br>    -N  &lt;int&gt;         统计基因组大小，默认值[0]<br>    -V  (optional)    输出相关信息为了可视化组装，默认[NO]<br></code></pre></td></tr></table></figure>



<h2 id="Output-files"><a href="#Output-files" class="headerlink" title="Output files"></a>Output files</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">a. <span class="hljs-string">&quot;*.contig&quot;</span><br>  contig sequences without using mate pair information.<br>b. <span class="hljs-string">&quot;*.scafSeq&quot;</span><br>  scaffold sequences (final contig sequences can be extracted by breaking down scaffold sequences at gap regions).<br></code></pre></td></tr></table></figure>



<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="How-to-set-K-mer-size"><a href="#How-to-set-K-mer-size" class="headerlink" title="How to set K-mer size?"></a>How to set K-mer size?</h3><p>The program accepts odd numbers between 13 and 31? <strong>Larger K-mers would have higher rate of uniqueness in the genome and would make the graph simpler, but it requires deep sequencing depth and longer read length to guarantee the overlap at any genomic location.</strong> <font color="red"><strong>Balance?</strong></font></p>
<p>The <strong>sparse_pregraph</strong> module usually needs <strong>2-10bp smaller kmer</strong> length to achieve the same performance as the original <strong>pregraph</strong> module. <font color="red"><strong>Difference?</strong></font></p>
<h3 id="How-to-set-genome-size-z-for-sparse-pregraph-module"><a href="#How-to-set-genome-size-z-for-sparse-pregraph-module" class="headerlink" title="How to set genome size(-z) for sparse_pregraph module?"></a>How to set genome size(-z) for sparse_pregraph module?</h3><p>The -z parameter for sparse pregraph should be set <font color="red"><strong>a litter larger than the real genome size</strong></font>, it is used to allocate memory.</p>
<h3 id="How-to-set-library-rank"><a href="#How-to-set-library-rank" class="headerlink" title="How to set library rank?"></a>How to set library rank?</h3><p>SOAPdenovo will <font color="red">use the <strong>pair-end libraries</strong> with <strong>insert size</strong> from <strong>smaller to larger</strong> to <strong>construct</strong> scaffolds</font>. Libraries with the same rank would be used at the same time. For example, in a dataset of a human genome, we set <strong><font color="red">five ranks</font> for five libraries with insert size 200-bp, 500-bp, 2-Kb, 5-Kb and 10-Kb</strong>, separately. It is desired that the pairs in each rank provide adequate physical coverage of the genome.</p>
<h2 id="APPENDIX-A-an-example-config"><a href="#APPENDIX-A-an-example-config" class="headerlink" title="APPENDIX A: an example.config"></a>APPENDIX A: an example.config</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#maximal read length</span><br>max_rd_len=100<br><span class="hljs-string">&quot;[LIB]&quot;</span><br><span class="hljs-comment">#average insert size</span><br>avg_ins=200<br><span class="hljs-comment">#if sequence needs to be reversed</span><br>reverse_seq=0<br><span class="hljs-comment">#in which part(s) the reads are used</span><br>asm_flags=3<br><span class="hljs-comment">#use only first 100 bps of each read</span><br>rd_len_cutoff=100<br><span class="hljs-comment">#in which order the reads are used while scaffolding</span><br>rank=1<br><span class="hljs-comment"># cutoff of pair number for a reliable connection (at least 3 for short insert size)</span><br>pair_num_cutoff=3<br><span class="hljs-comment">#minimum aligned length to contigs for a reliable read location (at least 32 for short insert size)</span><br>map_len=32<br><span class="hljs-comment">#a pair of fastq file, read 1 file should always be followed by read 2 file</span><br>q1=/path/**LIBNAMEA**/fastq1_read_1.fq<br>q2=/path/**LIBNAMEA**/fastq1_read_2.fq<br><span class="hljs-comment">#another pair of fastq file, read 1 file should always be followed by read 2 file</span><br>q1=/path/**LIBNAMEA**/fastq2_read_1.fq<br>q2=/path/**LIBNAMEA**/fastq2_read_2.fq<br><span class="hljs-comment">#a pair of fasta file, read 1 file should always be followed by read 2 file</span><br>f1=/path/**LIBNAMEA**/fasta1_read_1.fa<br>f2=/path/**LIBNAMEA**/fasta1_read_2.fa<br><span class="hljs-comment">#another pair of fasta file, read 1 file should always be followed by read 2 file</span><br>f1=/path/**LIBNAMEA**/fasta2_read_1.fa<br>f2=/path/**LIBNAMEA**/fasta2_read_2.fa<br><span class="hljs-comment">#fastq file for single reads</span><br>q=/path/**LIBNAMEA**/fastq1_read_single.fq<br><span class="hljs-comment">#another fastq file for single reads</span><br>q=/path/**LIBNAMEA**/fastq2_read_single.fq<br><span class="hljs-comment">#fasta file for single reads</span><br>f=/path/**LIBNAMEA**/fasta1_read_single.fa<br><span class="hljs-comment">#another fasta file for single reads</span><br>f=/path/**LIBNAMEA**/fasta2_read_single.fa<br><span class="hljs-comment">#a single fasta file for paired reads</span><br>p=/path/**LIBNAMEA**/pairs1_in_one_file.fa<br><span class="hljs-comment">#another single fasta file for paired reads</span><br>p=/path/**LIBNAMEA**/pairs2_in_one_file.fa<br><span class="hljs-comment">#bam file for single or paired reads, reads 1 in paired reads file should always be followed by reads 2</span><br><span class="hljs-comment">#	<span class="hljs-doctag">NOTE:</span> If a read in bam file fails platform/vendor quality checks(the flag field 0x0200 is set), itself and it&#x27;s paired read would be ignored.</span><br>b=/path/**LIBNAMEA**/reads1_in_file.bam<br><span class="hljs-comment">#another bam file for single or paired reads</span><br>b=/path/**LIBNAMEA**/reads2_in_file.bam<br><span class="hljs-string">&quot;[LIB]&quot;</span><br>avg_ins=2000<br>reverse_seq=1<br>asm_flags=2<br>rank=2<br><span class="hljs-comment"># cutoff of pair number for a reliable connection (at least 5 for large insert size)</span><br>pair_num_cutoff=5<br><span class="hljs-comment">#minimum aligned length to contigs for a reliable read location (at least 35 for large insert size)</span><br>map_len=35<br>q1=/path/**LIBNAMEB**/fastq_read_1.fq<br>q2=/path/**LIBNAMEB**/fastq_read_2.fq<br>f1=/path/**LIBNAMEA**/fasta_read_1.fa<br>f2=/path/**LIBNAMEA**/fasta_read_2.fa<br>p=/path/**LIBNAMEA**/pairs_in_one_file.fa<br>b=/path/**LIBNAMEA**/reads_in_file.bam<br></code></pre></td></tr></table></figure>

<h2 id="Appendix-B-output-files"><a href="#Appendix-B-output-files" class="headerlink" title="Appendix B: output files"></a>Appendix B: output files</h2><h3 id="1-Output-files-from-the-command-“pregraph”"><a href="#1-Output-files-from-the-command-“pregraph”" class="headerlink" title="1. Output files from the command “pregraph”"></a>1. Output files from the command “pregraph”</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh">a. *.kmerFreq<br>   Each row shows the number of Kmers with a frequency equals the row number. Note that those peaks of frequencies <span class="hljs-built_in">which</span> are the integral multiple of 63 are due to the data structure.<br>b. *.edge<br>   Each record gives the information of an edge <span class="hljs-keyword">in</span> the pre-graph: length, Kmers on both ends, average kmer coverage, whether it<span class="hljs-string">&#x27;s reverse-complementarily identical and the sequence.</span><br><span class="hljs-string">c. *.markOnEdge &amp; *.path</span><br><span class="hljs-string">   These two files are for using reads to solve small repeats.</span><br><span class="hljs-string">e. *.preArc</span><br><span class="hljs-string">   Connections between edges which are established by the read paths.</span><br><span class="hljs-string">f. *.vertex</span><br><span class="hljs-string">   Kmers at the ends of edges.</span><br><span class="hljs-string">g. *.preGraphBasic</span><br><span class="hljs-string">   Some basic information about the pre-graph: number of vertex, K value, number of edges, maximum read length etc.</span><br></code></pre></td></tr></table></figure>

<h3 id="2-Output-files-from-the-command-“contig”"><a href="#2-Output-files-from-the-command-“contig”" class="headerlink" title="2. Output files from the command “contig”"></a>2. Output files from the command “contig”</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">a. *.contig<br>      Contig information: corresponding edge index, length, kmer coverage, whether it<span class="hljs-string">&#x27;s tip and the sequence. Either a contig or its reverse complementry counterpart is included. Each reverse complementary contig index is indicated in the *.ContigIndex file.</span><br><span class="hljs-string">   b. *.Arc</span><br><span class="hljs-string">      Arcs coming out of each edge and their corresponding coverage by reads</span><br><span class="hljs-string">   c. *.updated.edge</span><br><span class="hljs-string">      Some information for each edge in graph: length, Kmers at both ends, index difference between the reverse-complementary edge and this one.</span><br><span class="hljs-string">   d. *.ContigIndex</span><br><span class="hljs-string">      Each record gives information about each contig in the *.contig: it&#x27;</span>s edge index, length, the index difference between its reverse-complementary counterpart and itself.<br></code></pre></td></tr></table></figure>

<h3 id="3-Output-files-from-the-command-“map”"><a href="#3-Output-files-from-the-command-“map”" class="headerlink" title="3. Output files from the command “map”"></a>3. Output files from the command “map”</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">a. *.peGrads<br>      Information <span class="hljs-keyword">for</span> each <span class="hljs-built_in">clone</span> library: insert-size, <span class="hljs-built_in">read</span> index upper bound, rank and pair number cutoff <span class="hljs-keyword">for</span> a reliable <span class="hljs-built_in">link</span>. This file can be revised manually <span class="hljs-keyword">for</span> scaffolding tuning.<br>   b. *.readOnContig<br>      Reads<span class="hljs-string">&#x27; locations on contigs. Here contigs are referred by their edge index. Howerver about half of them are not listed in the *.contig file for their reverse-complementary counterparts are included already.</span><br><span class="hljs-string">   c. *.readInGap</span><br><span class="hljs-string">      This file includes reads that could be located in gaps between contigs. This information will be used to close gaps in scaffolds if &quot;-F&quot; is set.</span><br></code></pre></td></tr></table></figure>

<h3 id="4-Output-files-from-the-command-“scaff”"><a href="#4-Output-files-from-the-command-“scaff”" class="headerlink" title="4. Output files from the command “scaff”"></a>4. Output files from the command “scaff”</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs sh">a. *.newContigIndex<br>      Contigs are sorted according their length before scaffolding. Their new index are listed <span class="hljs-keyword">in</span> this file.  This is useful <span class="hljs-keyword">if</span> one wants to corresponds contigs <span class="hljs-keyword">in</span> *.contig with those <span class="hljs-keyword">in</span> *.links.<br>   b. *.links<br>      Links between contigs <span class="hljs-built_in">which</span> are established by <span class="hljs-built_in">read</span> pairs. New index are used.<br>   c. *.scaf_gap<br>      Contigs <span class="hljs-keyword">in</span> gaps found by contig graph outputted by the contiging procedure. Here new index are used.<br>   d. *.scaf<br>      Contigs <span class="hljs-keyword">for</span> each scaffold: contig index (concordant to index <span class="hljs-keyword">in</span> *.contig),  approximate start position on scaffold, orientation, contig length, and its links to others contigs.<br>   e. *.gapSeq<br>      Gap sequences between contigs.<br>   f. *.scafSeq<br>      Sequences of each scaffolds.<br>   g. *.contigPosInscaff<br>      Contigs<span class="hljs-string">&#x27; positions in each scaffold.</span><br><span class="hljs-string">   h. *.bubbleInScaff</span><br><span class="hljs-string">      Contigs that form bubble structures in scaffolds. Every two contigs form a bubble and the contig with higher coverage will be kept in scaffold.</span><br><span class="hljs-string">   i. *.scafStatistics</span><br><span class="hljs-string">      Statistic information of final scaffold and contig.</span><br></code></pre></td></tr></table></figure>

<hr>
<h1 id="小记1"><a href="#小记1" class="headerlink" title="小记1"></a>小记1</h1><p> ref：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Formulate0303/p/6879841.html">https://www.cnblogs.com/Formulate0303/p/6879841.html</a></p>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>确定基因组缺失什么；确定难以生化研究的基因和pathways；研究感兴趣pathway通路中每一个基因；研究基因组非编码区（introns、promoters、telomeres端粒等）的调控机理和结构特征；基因组提供可进行各种统计的大型数据库（provide large databases that are amenable to statistical methods）;识别不同可能有细微表型的序列；研究物种和基因组的进化过程。一般都是用不同梯度的插入片段来测序，小片段（200,500,800）和大片段（1k, 2kb 5kb 10kb 20kb 40kb）。</p>
<h2 id="测序前准备"><a href="#测序前准备" class="headerlink" title="测序前准备"></a>测序前准备</h2><p>搜集物种相关信息（染色体的倍型、基因组大小、杂合度、重复序列比例、是否有可用的遗传图谱、GC含量 和 GC分布）。提供已经发表的近源物种。根据近源物种分析以上信息，尤其是GC含量以及对应的GC分布，重复程度。</p>
<h3 id="1-获取基因组大小"><a href="#1-获取基因组大小" class="headerlink" title="1 获取基因组大小"></a>1 获取基因组大小</h3><ul>
<li><p>基因组太大（&gt;10Gb）超出了目前denovo组装基因组软件对机器内存的要求，则无法实现组装；对组装结果的大小的进行正确性与否判断。</p>
</li>
<li><p>动物基因组大小数据库（ANIMAL GENOME SIZE DATABASE）: <a target="_blank" rel="noopener" href="http://www.genomesize.com/%EF%BC%9B%E5%AF%B9%E4%BA%8E%E6%9F%A5%E4%B8%8D%E5%88%B0%E7%9A%84%E7%89%A9%E7%A7%8D%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%A4%A7%E5%B0%8F%E7%9A%84%EF%BC%8C%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E4%B8%80%E4%BA%9B%E6%96%B9%E6%B3%95%E5%8E%BB%E4%BC%B0%E8%AE%A1%E3%80%82">http://www.genomesize.com/；对于查不到的物种基因组大小的，可以通过一些方法去估计。</a></p>
</li>
<li><p>实验（流式细胞仪）估计基因组大小的例子： “A full-length enriched cDNA library and expressed sequence tag analysis of the parasitic weed, Striga hermonthica.” BMC Plant Biol (2010)</p>
</li>
<li><p>基于福尔摩根染色估计基因组大小：书The evolution of the genome《基因组进化》, Gregory, T. (2005).</p>
</li>
<li><p>定量PCR估计基因组大小: “Real-time PCR-based method for the estimation of genome sizes.” Nucleic Acids Res (2003); “The nuclear genome of the phytoseiid Metaseiulus occidentalis (Acari: Phytoseiidae) is among the smallest known in arthropods.” Exp Appl Acarol (2009)</p>
</li>
<li><p>通过Kmer估计基因组大小：Kim, E. B., X. Fang, et al. (2011). “<a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3319411/"><strong>Genome sequencing reveals insights into physiology and longevity of the naked mole rat</strong></a>.” Nature 479(7372): 223-227. [Obtained 2.5 G contig sequences with N50 19.3 kbp and N90 4.7 kbp, and 2.7 G scaffold sequences with N50 1.6 Mbp and N90 0.3 Mbp.]</p>
</li>
</ul>
<h3 id="2-杂合度评估"><a href="#2-杂合度评估" class="headerlink" title="2 杂合度评估"></a>2 杂合度评估</h3><ul>
<li><p>主要体现在<font color="green">不能合并姊妹染色体</font>，杂合度高的区域，会把两条姊妹染色单体都组装出来，造成组装的基因组<font color="green">偏大</font>。</p>
</li>
<li><p><font color="red"><strong>杂合度&gt;0.5%则组装有一定难度</strong></font>。杂合度&gt;1%则很难组装出来。</p>
</li>
<li><p>杂合度高则组装的序列不适合用于后续生物学分析（eg:拷贝数、基因完整结构等）。</p>
</li>
</ul>
<h3 id="3-是否有遗传图谱可用"><a href="#3-是否有遗传图谱可用" class="headerlink" title="3 是否有遗传图谱可用"></a>3 是否有遗传图谱可用</h3><p>随着测序对质量提高和相关技术成熟，<font color="red"><strong>遗传图谱？</strong></font>也快成了denovo基因组的必须组成。</p>
<p><a target="_blank" rel="noopener" href="https://cdmd.cnki.com.cn/Article/CDMD-10504-1019065822.htm">矮牵牛遗传图谱构建及重瓣分子标记筛选</a></p>
<p>遗传图谱是某一物种的染色体图，显示所知的基因和&#x2F;或遗传标记的相对位置，而不是在每条染色体上特殊的物理位置。由<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%81%97%E4%BC%A0%E9%87%8D%E7%BB%84/6391485">遗传重组</a>测验结果推算出来的、在一条染色体上可以发生的突变座位的直线排列（<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%9F%BA%E5%9B%A0%E4%BD%8D%E7%82%B9/3613206">基因位点</a>的排列）图。</p>
<p>Genetic map，<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%81%97%E4%BC%A0%E5%9B%BE/2951032">遗传图</a>或遗传<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%BF%9E%E9%94%81%E5%9B%BE/1586423">连锁图</a>是以<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%9F%BA%E5%9B%A0%E8%BF%9E%E9%94%81/7740242">基因连锁</a>、重组<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%BA%A4%E6%8D%A2%E5%80%BC/5106108">交换值</a>构建的图谱，图距为cM（<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%8E%98%E6%91%A9/1586351">厘摩</a>），1%交换值为1cM，约相当于1000kb。人基因组全长约3300cM，如两个标记之间相距1cM，则需3300个标记，如相距2～5cM，则需660～l650个标记。标记可以是体质性状，也可以是可检出的DNA序列，例如基因、<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%99%90%E5%88%B6%E7%89%87%E6%AE%B5%E9%95%BF%E5%BA%A6%E5%A4%9A%E6%80%81%E6%80%A7/3841692">限制片段长度多态性</a>（<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/RFLP/5060944">RFLP</a>）和特定的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%8D%95%E4%B8%80%E5%BA%8F%E5%88%97/1851974">单一序列</a>等。每一个标记都要用专一序列位点（STS）作鉴定。STS是指其位置及核苷酸序列均已知的、人基因组中只有一份拷贝的DNA短片段（一般长200～500碱基对），它很容易用多聚酶链反应（PCR）加以验证。当各个实验室报道定位和测序的数据时，可用STS来确定这些DNA片段的定位与取向。人类基因组计划的研究目标是，完成一个完全连接的人类遗传图，标记之间平均相距2～5cM。</p>
<p>遗传图谱构建相关概念推荐参考书：<strong>The handbook of plant genome mapping: genetic and physical mapping</strong> </p>
<h3 id="4-生物学问题的调研"><a href="#4-生物学问题的调研" class="headerlink" title="4 生物学问题的调研"></a>4 生物学问题的调研</h3><h2 id="组装"><a href="#组装" class="headerlink" title="组装"></a>组装</h2><ul>
<li><p>BAC-by-BAC:测序和组装每一个BAC, 合并BAC和移除BAC冗余部分，获得参考基因组序列。</p>
</li>
<li><p>whole genome shotgun：全基因组鸟枪法，染色体DNA被随机打断成片段，依次测序和组装。</p>
</li>
</ul>
<h3 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h3><p>二代测序数据从头组装的解决overlap的三种算法</p>
<ul>
<li><p>overlap-layout-consensus：重叠布局一致OLC法，【软件：PHRAP.NEWBLER.CABOG.CELERA.SHORTY.EDENA,popular for long reads】，1. Overlap discovery involves all-against-all, pair-wise read comparison. 2. Construction an approximate read layout according to the pair-wise alignment 3. Multiple sequence alignment determines the precise layout and the consensus.</p>
</li>
<li><p>De bruijn graph:DBG法，【软件：SOAPdenovo2.Velvet.EULER,popular for illumina ，for short reads】,1.所有的测序reads都被切割成某一固定Kmer长度的序列（21bp&#x3D;&lt;kmer&lt;&#x3D;127bp）.2.相邻kmers链接是来自read序列，所以它不需要成对序列比对(The links between neighboring Kmers are derived from read sequences,so it doesn’t need pair-wise reads alignment.）3.冗余的数据自动被压缩。</p>
</li>
<li><p>greedy method：贪婪法(use OLC or DBG)，【软件：SSAKE.SHARCGS.VCAKE】，从给定的reads和contigs开始，使用下一个得分最高的overlap去做下一个连接，这样一直做下去，直到不能进行下去为止。</p>
</li>
</ul>
<h3 id="评估"><a href="#评估" class="headerlink" title="评估"></a>评估</h3><p>组装short reads的挑战</p>
<p>1.基因组的复杂性，<strong>重复序列</strong>、<strong>杂合</strong>的<strong>二倍体</strong>基因组heterozygous diploid genome、<strong>多倍性</strong>polyploidy.</p>
<p>2.illumina reads 的数据特征，<strong>测序错误</strong>率<del>1%、short read 长度</del>100bp、<del>100X的高测序深度、不同级别的文库插入片段（200bp</del>40Kbp）。</p>
<p>3.Complexity of computation</p>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><hr>
<h1 id="小记2"><a href="#小记2" class="headerlink" title="小记2"></a>小记2</h1><p>ref <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/e02ecd537c83">https://www.jianshu.com/p/e02ecd537c83</a></p>
<h2 id="reads质量控制"><a href="#reads质量控制" class="headerlink" title="reads质量控制"></a>reads质量控制</h2><ul>
<li>认识数据。(read类型，read数量，其GC含量，可能的污染和其他问题)</li>
<li>数据清理。(组装前清理原始数据可以使组装结果更好,因为移除了低质量和污染的reads)</li>
<li>为组装软件提供一些组装的参数</li>
</ul>
<h2 id="检查原始read数据的质量"><a href="#检查原始read数据的质量" class="headerlink" title="检查原始read数据的质量"></a>检查原始read数据的质量</h2><p>(1)read长度:在设置组装的最大k-mer值时将很重要。</p>
<p>(2)质量编码类型:对于quality trimming软件很重要。(Phred33、64)</p>
<p>(3)GC含量:<strong>高GC的生物体往往组装得不好，并且read覆盖率分布可能不均匀</strong></p>
<p>(4)总的reads数:<strong>了解coverage范围</strong></p>
<p>(4)在read的开始、中间或结尾附近质量下降:确定可能的修整&#x2F;清除方法和参数。</p>
<p>(5)出现<strong>高度重复的k-mers</strong>:说明序列可能存在污染。</p>
<p>(6)reads中存在<strong>大量N</strong>:可能表明测序质量较差。你需要修剪这些read，以删除N.</p>
<h2 id="genome-survey"><a href="#genome-survey" class="headerlink" title="genome survey"></a>genome survey</h2><p>正式组装前进行kmer分析，以了解以下信息。</p>
<p>(1)基因组杂合度。</p>
<p>(2)重复序列比例。</p>
<p>(3)预估基因组大小。</p>
<p>(4)测序深度。</p>
<p>所用软件为kmergenie，<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=http://kmergenie.bx.psu.edu/">http://kmergenie.bx.psu.edu/</a> </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#安装(使用时，确保服务器装有Pthon与R)</span><br>tar -xzvf kmergenie-1.7051.tar.gz &amp;&amp; <span class="hljs-built_in">cd</span> kmergenie-1.7051<br>python setup.py install<br> <br><span class="hljs-comment">#添加可执行权限</span><br><span class="hljs-built_in">chmod</span> -R 755 *<br></code></pre></td></tr></table></figure>

<p>接下来介绍怎么用，参考：<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=http://wap.sciencenet.cn/blog-3406804-1159967.html">http://wap.sciencenet.cn/blog-3406804-1159967.html</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">touch</span> fq_501.txt                                 <span class="hljs-comment">#存储fastq文件的路径。</span><br>vim fq_501.txt                                   <span class="hljs-comment">#编辑fq.txt，输入fastq文件路径。</span><br><span class="hljs-built_in">mkdir</span> kmergenie_result     <br>./tools/kmergenie-1.7051/kmergenie fq_501.list -o ./kmergenie_result/PB_501 -k 105 -<br>l 15 -s 10 -t 12                               <br><span class="hljs-comment">#-o:输出文件存放的地址。</span><br><span class="hljs-comment">#-k:最大的k值</span><br><span class="hljs-comment">#-l:最小的k值</span><br><span class="hljs-comment">#-s:从最小的k----最大的k，每次增加的k。</span><br><span class="hljs-comment">#-t:线程数。</span><br><span class="hljs-comment">#注:刚开始s可以设大点，可以根据判断出的最佳k值，缩小s再进行判断((第一次:I:15,k:105,s:10 第二次I:85,k:140,s:6)。</span><br></code></pre></td></tr></table></figure>

<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">usage:<br><br>    ./kmergenie reads_file<br><br>reads_file is either <span class="hljs-keyword">a</span> single FASTA, FASTQ, FASTA.gz, FASTQ.gz <span class="hljs-built_in">file</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">a</span> list <span class="hljs-keyword">of</span> <span class="hljs-built_in">file</span> names, <span class="hljs-literal">one</span> per <span class="hljs-built_in">line</span>. For example:<br>    <br>    ls <span class="hljs-number">-1</span> *.fastq.gz &gt; list_files<br>    ./kmergenie list_files<br><br>    type ./kmergenie <span class="hljs-built_in">to</span> see extra options<br><br>input:<br><br>    Input reads should be exactly those <span class="hljs-keyword">the</span> de novo assembler will use <span class="hljs-built_in">to</span> <span class="hljs-built_in">create</span> contigs, i.e. <span class="hljs-keyword">the</span> list <span class="hljs-keyword">of</span> all single <span class="hljs-keyword">and</span> paired-<span class="hljs-function"><span class="hljs-keyword">end</span> <span class="hljs-title">reads</span>.</span><br><br>    The order does <span class="hljs-keyword">not</span> matter, KmerGenie treats <span class="hljs-keyword">the</span> reads <span class="hljs-keyword">as</span> <span class="hljs-keyword">an</span> unordered <span class="hljs-built_in">set</span> <span class="hljs-keyword">of</span> k-mers. Orientation <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> reads also does <span class="hljs-keyword">not</span> matter.<br>    With Velvet, <span class="hljs-keyword">if</span> you have mate-pairs, Velvet uses them <span class="hljs-built_in">to</span> <span class="hljs-built_in">create</span> contigs, so <span class="hljs-built_in">do</span> <span class="hljs-built_in">include</span> them <span class="hljs-keyword">in</span> KmerGenie.<br>    Otherwise, <span class="hljs-keyword">if</span> <span class="hljs-keyword">the</span> mate-pairs are used only <span class="hljs-keyword">for</span> scaffolding (i.e. asm_flag=<span class="hljs-number">2</span> <span class="hljs-keyword">in</span> SOAPdenovo), <span class="hljs-built_in">do</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">include</span> them.<br><br>tips:<br><br>    * Take <span class="hljs-keyword">a</span> look <span class="hljs-keyword">at</span> <span class="hljs-keyword">the</span> generated HTML report. It provides <span class="hljs-keyword">a</span> summary <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> results, <span class="hljs-keyword">and</span> <span class="hljs-keyword">contains</span> <span class="hljs-keyword">an</span> Advanced Help section <span class="hljs-built_in">to</span> help analysis.<br><br>    * There is no need <span class="hljs-built_in">to</span> use Kmergenie <span class="hljs-keyword">for</span> <span class="hljs-keyword">a</span> multi-k assembler, like SPAdes. Default parameters <span class="hljs-keyword">of</span> multi-k assemblers are generally better than <span class="hljs-keyword">a</span> single best k.<br><br>    * By default, KmerGenie will perform another pass <span class="hljs-built_in">to</span> estimate k more precisely. You may skip <span class="hljs-keyword">it</span> <span class="hljs-keyword">by</span> <span class="hljs-keyword">using</span> <span class="hljs-keyword">the</span> <span class="hljs-string">&quot;--one-pass&quot;</span> option (roughly <span class="hljs-number">2</span>x faster).<br><br>    * To run multiple instances <span class="hljs-keyword">of</span> KmerGenie <span class="hljs-keyword">on</span> <span class="hljs-title">the</span> <span class="hljs-title">same</span> <span class="hljs-title">folder</span>, <span class="hljs-title">specify</span> <span class="hljs-title">the</span> <span class="hljs-string">&quot;-o&quot;</span> <span class="hljs-title">and</span> <span class="hljs-string">&quot;-t&quot;</span> <span class="hljs-title">parameters</span> (<span class="hljs-title">output</span> <span class="hljs-title">prefix</span>, <span class="hljs-title">number</span> <span class="hljs-title">of</span> <span class="hljs-title">threads</span> <span class="hljs-title">per</span> <span class="hljs-title">instance</span>).<br><br>    * The sampling <span class="hljs-built_in">value</span> e (<span class="hljs-string">&quot;-e&quot;</span> parameter) makes sure that roughly n/e k-mers are sampled out <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> n distinct kmers <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> dataset. The datasets are fully analyzed, though. Kmergenie samples <span class="hljs-built_in">from</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">set</span> <span class="hljs-keyword">of</span> distinct kmers, <span class="hljs-keyword">not</span> <span class="hljs-built_in">from</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">set</span> <span class="hljs-keyword">of</span> reads.<br><br>    * The diploid model should only be used <span class="hljs-keyword">for</span> moderate-high heterozygosity rates. The haploid model works better when only <span class="hljs-literal">one</span> peak is visible <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> histograms (indicating low heterozygosity).<br><br>outputs:<br><br>    histograms_report.html<br>        html report <span class="hljs-keyword">of</span> all <span class="hljs-keyword">the</span> results<br>    histograms.dat<br>        <span class="hljs-built_in">file</span> containing <span class="hljs-keyword">the</span> raw data <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> genomic kmers <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span> k <span class="hljs-built_in">value</span><br>    histograms-k*.histo<br>        <span class="hljs-built_in">files</span> containing raw sampled histograms <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span> k <span class="hljs-built_in">value</span><br>    histograms-k*.histo.pdf<br>        plots <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> histograms <span class="hljs-keyword">and</span> <span class="hljs-keyword">the</span> fits. Colors: red is <span class="hljs-keyword">the</span> fit <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> complete statistical model <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> histogram (erroneous k-mers + genomic k-mers). With <span class="hljs-keyword">the</span> diploid model, green are only <span class="hljs-keyword">the</span> heterozygous k-mers, blue are only <span class="hljs-keyword">the</span> homozygous k-mers.<br>    &lt;<span class="hljs-keyword">stdout</span>&gt;<br>        <span class="hljs-keyword">last</span> <span class="hljs-built_in">line</span> is <span class="hljs-keyword">the</span> best k <span class="hljs-built_in">value</span><br>    &lt;<span class="hljs-literal">return</span> code / error code&gt;<br>        <span class="hljs-number">0</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">and</span> only <span class="hljs-keyword">if</span> <span class="hljs-keyword">a</span> best k was found (note: no longer returns <span class="hljs-keyword">the</span> best k <span class="hljs-keyword">as</span> error code)<br></code></pre></td></tr></table></figure>



<p>结果文件生成report。报告以折线图形式给出每种长度的kmer下，估计的基因组大小，同时给出了最佳的kmer(评估基因组总大小最高)</p>
<p><img src="/GeekFocus/./14.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p>理想条件该图应该为一条平滑的曲线，有明确最大值。然而在一些情况下有多个局部最大值。</p>
<p>这些情况表明，对于某些k值，Kmergenie中的统计模型并不总是正确地拟合输入数据。因此由Kmergenie预测的最佳k值可能不是最佳的。在随后的分析中，还尝试使用比Kmergenie预测的k大的k(其他峰值)</p>
<p>若基因组k-mers的数量不会随着k值的升高而下降，则是一个高覆盖率(high coverage)数据集的迹象？<br>什么是覆盖率呢？<br>覆盖率(coverage)：指的是测序过程中读取单个碱基的平均次数。如果覆盖度为100×，说明平均每个碱基测序了100次。对碱基测序的频率越高，数据的质量越高。</p>
<p><img src="/GeekFocus/./15.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<h2 id="soapdevovo2"><a href="#soapdevovo2" class="headerlink" title="soapdevovo2"></a>soapdevovo2</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#正式组装(kmer选103,113,123,127分别跑)</span><br><span class="hljs-comment">#SOAPdenovo2既可以一步组装也可以分四步，如果基因组大且复杂建议分四步。</span><br> <span class="hljs-built_in">nohup</span> ./tools/SOAPdenovo2-master/SOAPdenovo-127mer all -s config_file -d 1 -R -F -K 113 -p 60 -o PB_501_113 &gt; PB_501_113.<span class="hljs-built_in">log</span> &amp;  <span class="hljs-comment">#注:加nohup和&amp;是为了让它在后台运行(防止远程连接断开程序停止)</span><br></code></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#分四步(在k=103、113、123、及127(支持的最大kmer)跑了后发现127在同样参数下contig N50最大)，下面是为了优化结果跑的。</span><br><span class="hljs-comment">#pregraph(d=1,2,3,4)</span><br><span class="hljs-built_in">nohup</span> ./tools/SOAPdenovo2-master/SOAPdenovo-127mer pregraph -s config_file -o PB_501_127_d_3 -R -K 127 -p 60 -d 2 &gt;PB_501_127_d_3_pre.<span class="hljs-built_in">log</span> &amp;<br><span class="hljs-built_in">nohup</span> ./tools/SOAPdenovo2-master/SOAPdenovo-127mer contig -g PB_501_127_d_3 -R -p 60 &gt;PB_501_127_d_3_con.<span class="hljs-built_in">log</span> &amp;<br><span class="hljs-built_in">nohup</span> ./tools/SOAPdenovo2-master/SOAPdenovo-127mer map -s config_file -g PB_501_127_d_3 -p 60 -k 127 &gt;PB_501_127_d_3_map.<span class="hljs-built_in">log</span> &amp;  <br><span class="hljs-built_in">nohup</span> ./tools/SOAPdenovo2-master/SOAPdenovo-127mer scaff -g PB_501_127_d_3 -F -p 60 &gt;PB_501_127_d_3_scaf.<span class="hljs-built_in">log</span> &amp;<br></code></pre></td></tr></table></figure>

<h2 id="统计"><a href="#统计" class="headerlink" title="统计"></a>统计</h2><p><img src="/GeekFocus/./16.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<h2 id="组装评估"><a href="#组装评估" class="headerlink" title="组装评估"></a>组装评估</h2><p>QUAST软件下载:<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://sourceforge.net/projects/quast/files/quast-5.0.2.tar.gz/download">https://sourceforge.net/projects/quast/files/quast-5.0.2.tar.gz/download</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#解压安装</span><br>tar -zxvf quast-5.0.2.tar.gz &amp;&amp; <span class="hljs-built_in">cd</span> quast-5.0.2<br>python  setup.py install_full<br></code></pre></td></tr></table></figure>

<h3 id="参考基因组下载"><a href="#参考基因组下载" class="headerlink" title="参考基因组下载"></a>参考基因组下载</h3><h3 id="QUAST使用"><a href="#QUAST使用" class="headerlink" title="QUAST使用"></a>QUAST使用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">./tools/quast-5.0.2/quast.py -o ./quast_results -R ./reference/IRGSP-1.0_genome.fasta.gz -t 70 ./PB_501_results/PB_501_127_d_1/PB_501_127_d_1.scafSeq ./PB_501_results/PB_501_127_d_2/PB_501_127_d_2.scafSeq ./PB_501_results/PB_501_127_d_3/PB_501_127_d_3.scafSeq ./PB_501_results/PB_501_127_d_6/PB_501_127_d_6.scafSeq<br><span class="hljs-comment">#-o输出目录</span><br><span class="hljs-comment">#-R参考基因组序列</span><br><span class="hljs-comment">#-t线程数</span><br><span class="hljs-comment">#后面为要比较的contig/scaffold所在目录。</span><br></code></pre></td></tr></table></figure>

<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><h3 id="统计结果"><a href="#统计结果" class="headerlink" title="统计结果"></a>统计结果</h3><p>将contig&#x2F;scaffold比对到参考基因组上，下面是比对得到的结果。</p>
<p><img src="/GeekFocus/./17.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p><img src="/GeekFocus/./18.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p>累计长度:若与灰色线重合越好，组装结果越好。</p>
<p><img src="/GeekFocus/./19.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p>错误组装情况：</p>
<p><img src="/GeekFocus/./20.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p>GC含量:</p>
<p><img src="/GeekFocus/./21.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<h3 id="contig-x2F-scaffold大小可视化"><a href="#contig-x2F-scaffold大小可视化" class="headerlink" title="contig&#x2F;scaffold大小可视化"></a>contig&#x2F;scaffold大小可视化</h3><p><img src="/GeekFocus/./22.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<h3 id="比对到每条染色体情况"><a href="#比对到每条染色体情况" class="headerlink" title="比对到每条染色体情况"></a>比对到每条染色体情况</h3><p><img src="/GeekFocus/./23.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>
<p>比对到每条染色体可视化情况:</p>
<p><img src="/GeekFocus/./24.png" srcset="/GeekFocus/img/loading.gif" lazyload alt="img"></p>

              
            </div>
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/GeekFocus/categories/Software/" class="category-chain-item">Software</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/GeekFocus/tags/assembly/">#assembly</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Soapdenovo2</div>
      <div>https://wangc1106.github.io/GeekFocus/2022/02/24/2022-02-25-soapdenovo2/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>banner</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>February 24, 2022</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>Licensed under</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/GeekFocus/2022/02/28/2022-02-28-genome-assemble/" title="Genome assemble pipeline">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Genome assemble pipeline</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/GeekFocus/2022/02/24/2022-02-24-Seqkit/" title="seqkit">
                        <span class="hidden-mobile">seqkit</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;Table of Contents</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <span>banner</span> <i class="iconfont icon-love"></i> <span>2021-2022©</span> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>

  
  
  
</div>

    <div style="height: 200px">
      <script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=5knf34gs07t&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=33" async="async"></script>
    </div>
  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/GeekFocus/js/events.js" ></script>
<script  src="/GeekFocus/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>






  
    <script  src="/GeekFocus/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script>
  (function() {
    var enableLang = CONFIG.code_language.enable && CONFIG.code_language.default;
    var enableCopy = CONFIG.copy_btn;
    if (!enableLang && !enableCopy) {
      return;
    }

    function getBgClass(ele) {
      return Fluid.utils.getBackgroundLightness(ele) >= 0 ? 'code-widget-light' : 'code-widget-dark';
    }

    var copyTmpl = '';
    copyTmpl += '<div class="code-widget">';
    copyTmpl += 'LANG';
    copyTmpl += '</div>';
    jQuery('.markdown-body pre').each(function() {
      var $pre = jQuery(this);
      if ($pre.find('code.mermaid').length > 0) {
        return;
      }
      if ($pre.find('span.line').length > 0) {
        return;
      }

      var lang = '';

      if (enableLang) {
        lang = CONFIG.code_language.default;
        if ($pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2 && $pre.children().hasClass('hljs')) {
          lang = $pre[0].children[0].classList[1];
        } else if ($pre[0].getAttribute('data-language')) {
          lang = $pre[0].getAttribute('data-language');
        } else if ($pre.parent().hasClass('sourceCode') && $pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2) {
          lang = $pre[0].children[0].classList[1];
          $pre.parent().addClass('code-wrapper');
        } else if ($pre.parent().hasClass('markdown-body') && $pre[0].classList.length === 0) {
          $pre.wrap('<div class="code-wrapper"></div>');
        }
        lang = lang.toUpperCase().replace('NONE', CONFIG.code_language.default);
      }
      $pre.append(copyTmpl.replace('LANG', lang).replace('code-widget">',
        getBgClass($pre[0]) + (enableCopy ? ' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>' : ' code-widget">')));

      if (enableCopy) {
        Fluid.utils.createScript('https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js', function() {
          var clipboard = new window.ClipboardJS('.copy-btn', {
            target: function(trigger) {
              var nodes = trigger.parentNode.childNodes;
              for (var i = 0; i < nodes.length; i++) {
                if (nodes[i].tagName === 'CODE') {
                  return nodes[i];
                }
              }
            }
          });
          clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-copy', 'icon-success');
            setTimeout(function() {
              e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-success', 'icon-copy');
            }, 2000);
          });
        });
      }
    });
  })();
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/GeekFocus/js/local-search.js" ></script>

  <script defer src="/GeekFocus/js/leancloud.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/GeekFocus/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
